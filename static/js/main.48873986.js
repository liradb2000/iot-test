/*! For license information please see main.48873986.js.LICENSE.txt */
(function(){var __webpack_modules__={9361:function(e,t,r){"use strict";var n=r(7061).default,i=r(8416).default,a=r(7156).default,s=-8,o=-4,u=0,c=1,l=1,h=2,f=5,d=1024,p=2048,v=8192,g=0,y=4,m=8,b=12,_=12,w=16,k="undefined"!==typeof BigUint64Array,x=Symbol(),E=1024;function S(e,t){var r=new Uint32Array(e),n=new Uint16Array(e),i=r[t+o>>>2]>>>1,a=t>>>1;if(i<=E)return String.fromCharCode.apply(String,n.subarray(a,a+i));var s=[];do{var u=n[a+E-1],c=u>=55296&&u<56320?E-1:E;s.push(String.fromCharCode.apply(String,n.subarray(a,a+=c))),i-=c}while(i>E);return s.join("")+String.fromCharCode.apply(String,n.subarray(a,a+i))}function C(e){var t={};function r(e,t){return e?S(e.buffer,t):"<yet unknown>"}var n=e.env=e.env||{};return n.abort=n.abort||function(e,i,a,s){var o=t.memory||n.memory;throw Error("abort: "+r(o,e)+" at "+r(o,i)+":"+a+":"+s)},n.trace=n.trace||function(e,i){var a=t.memory||n.memory;console.log("trace: "+r(a,e)+(i?" ":"")+Array.prototype.slice.call(arguments,2,2+i).join(", "))},e.Math=e.Math||Math,e.Date=e.Date||Date,t}function A(e,t){var r=t.exports,n=r.memory,i=r.table,a=r.__alloc,x=r.__retain,E=r.__rtti_base||-1;function C(e){var t=new Uint32Array(n.buffer);if((e>>>=0)>=t[E>>>2])throw Error("invalid id: "+e);return t[(E+4>>>2)+2*e]}function A(e){var t=new Uint32Array(n.buffer);if((e>>>=0)>=t[E>>>2])throw Error("invalid id: "+e);return t[(E+4>>>2)+2*e+1]}function D(e){return 31-Math.clz32(e>>>f&31)}function R(e,t,r){var i=n.buffer;if(r)switch(e){case 2:return new Float32Array(i);case 3:return new Float64Array(i)}else switch(e){case 0:return new(t?Int8Array:Uint8Array)(i);case 1:return new(t?Int16Array:Uint16Array)(i);case 2:return new(t?Int32Array:Uint32Array)(i);case 3:return new(t?BigInt64Array:BigUint64Array)(i)}throw Error("unsupported align: "+e)}function T(e){var t=new Uint32Array(n.buffer),r=t[e+s>>>2],i=C(r);if(!(i&l))throw Error("not an array: "+r);var a=D(i),u=t[e+y>>>2],c=i&h?t[e+_>>>2]:t[u+o>>>2]>>>a;return R(a,i&d,i&p).subarray(u>>>=a,u+c)}function Z(e,t,r){return new e(I(e,t,r))}function I(e,t,r){var i=n.buffer,a=new Uint32Array(i),s=a[r+y>>>2];return new e(i,s,a[s+o>>>2]>>>t)}return e.__allocString=function(e){for(var t=e.length,r=a(t<<1,c),i=new Uint16Array(n.buffer),s=0,o=r>>>1;s<t;++s)i[o+s]=e.charCodeAt(s);return r},e.__getString=function(e){var t=n.buffer;if(new Uint32Array(t)[e+s>>>2]!==c)throw Error("not a string: "+e);return S(t,e)},e.__allocArray=function(e,t){var r=C(e);if(!(r&(l|h)))throw Error("not an array: "+e+" @ "+r);var i=D(r),s=t.length,o=a(s<<i,u),c=a(r&h?w:b,e),f=new Uint32Array(n.buffer);f[c+g>>>2]=x(o),f[c+y>>>2]=o,f[c+m>>>2]=s<<i,r&h&&(f[c+_>>>2]=s);var k=R(i,r&d,r&p);if(r&v)for(var E=0;E<s;++E)k[(o>>>i)+E]=x(t[E]);else k.set(t,o>>>i);return c},e.__getArrayView=T,e.__getArray=function(e){for(var t=T(e),r=t.length,n=new Array(r),i=0;i<r;i++)n[i]=t[i];return n},e.__getArrayBuffer=function(e){var t=n.buffer,r=new Uint32Array(t)[e+o>>>2];return t.slice(e,e+r)},e.__getInt8Array=Z.bind(null,Int8Array,0),e.__getInt8ArrayView=I.bind(null,Int8Array,0),e.__getUint8Array=Z.bind(null,Uint8Array,0),e.__getUint8ArrayView=I.bind(null,Uint8Array,0),e.__getUint8ClampedArray=Z.bind(null,Uint8ClampedArray,0),e.__getUint8ClampedArrayView=I.bind(null,Uint8ClampedArray,0),e.__getInt16Array=Z.bind(null,Int16Array,1),e.__getInt16ArrayView=I.bind(null,Int16Array,1),e.__getUint16Array=Z.bind(null,Uint16Array,1),e.__getUint16ArrayView=I.bind(null,Uint16Array,1),e.__getInt32Array=Z.bind(null,Int32Array,2),e.__getInt32ArrayView=I.bind(null,Int32Array,2),e.__getUint32Array=Z.bind(null,Uint32Array,2),e.__getUint32ArrayView=I.bind(null,Uint32Array,2),k&&(e.__getInt64Array=Z.bind(null,BigInt64Array,3),e.__getInt64ArrayView=I.bind(null,BigInt64Array,3),e.__getUint64Array=Z.bind(null,BigUint64Array,3),e.__getUint64ArrayView=I.bind(null,BigUint64Array,3)),e.__getFloat32Array=Z.bind(null,Float32Array,2),e.__getFloat32ArrayView=I.bind(null,Float32Array,2),e.__getFloat64Array=Z.bind(null,Float64Array,3),e.__getFloat64ArrayView=I.bind(null,Float64Array,3),e.__instanceof=function(e,t){var r=new Uint32Array(n.buffer),i=r[e+s>>>2];if(i<=r[E>>>2])do{if(i==t)return!0}while(i=A(i));return!1},e.memory=e.memory||n,e.table=e.table||i,P(r,e)}function D(e){return"undefined"!==typeof Response&&e instanceof Response}function R(e,t){return T.apply(this,arguments)}function T(){return(T=a(n().mark((function e(t,r){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=D,e.next=3,t;case 3:if(e.t1=t=e.sent,!(0,e.t0)(e.t1)){e.next=6;break}return e.abrupt("return",Z(t,r));case 6:if(e.t2=A,e.t3=C(r||(r={})),e.t4=WebAssembly,!(t instanceof WebAssembly.Module)){e.next=13;break}e.t5=t,e.next=16;break;case 13:return e.next=15,WebAssembly.compile(t);case 15:e.t5=e.sent;case 16:return e.t6=e.t5,e.t7=r,e.next=20,e.t4.instantiate.call(e.t4,e.t6,e.t7);case 20:return e.t8=e.sent,e.abrupt("return",(0,e.t2)(e.t3,e.t8));case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e,t){return I.apply(this,arguments)}function I(){return(I=a(n().mark((function e(t,r){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(WebAssembly.instantiateStreaming){e.next=14;break}return e.t0=R,e.t1=D,e.next=5,t;case 5:if(e.t2=t=e.sent,!(0,e.t1)(e.t2)){e.next=10;break}e.t3=t.arrayBuffer(),e.next=11;break;case 10:e.t3=t;case 11:return e.t4=e.t3,e.t5=r,e.abrupt("return",(0,e.t0)(e.t4,e.t5));case 14:return e.t6=A,e.t7=C(r||(r={})),e.next=18,WebAssembly.instantiateStreaming(t,r);case 18:return e.t8=e.sent.instance,e.abrupt("return",(0,e.t6)(e.t7,e.t8));case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e,t){var r=t?Object.create(t):{},n=e.__argumentsLength?function(t){e.__argumentsLength.value=t}:e.__setArgumentsLength||e.__setargc||function(){},a=function(){if(!Object.prototype.hasOwnProperty.call(e,s))return 1;for(var t=e[s],a=s.split("."),o=r;a.length>1;){var u=a.shift();Object.prototype.hasOwnProperty.call(o,u)||(o[u]={}),o=o[u]}var c=a[0],l=c.indexOf("#");if(l>=0){var h=c.substring(0,l),f=o[h];if("undefined"===typeof f||!f.prototype){var d=function e(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.wrap((t=e.prototype).constructor.apply(t,[0].concat(n)))};d.prototype={valueOf:function(){return this[x]}},d.wrap=function(e){return Object.create(d.prototype,i({},x,{value:e,writable:!1}))},f&&Object.getOwnPropertyNames(f).forEach((function(e){return Object.defineProperty(d,e,Object.getOwnPropertyDescriptor(f,e))})),o[h]=d}if(c=c.substring(l+1),o=o[h].prototype,/^(get|set):/.test(c)){if(!Object.prototype.hasOwnProperty.call(o,c=c.substring(4))){var p=e[s.replace("set:","get:")],v=e[s.replace("get:","set:")];Object.defineProperty(o,c,{get:function(){return p(this[x])},set:function(e){v(this[x],e)},enumerable:!0})}}else"constructor"===c?(o[c]=function(){return n(arguments.length),t.apply(void 0,arguments)}).original=t:(o[c]=function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return n(r.length),t.apply(void 0,[this[x]].concat(r))}).original=t}else/^(get|set):/.test(c)?Object.prototype.hasOwnProperty.call(o,c=c.substring(4))||Object.defineProperty(o,c,{get:e[s.replace("set:","get:")],set:e[s.replace("get:","set:")],enumerable:!0}):"function"===typeof t&&t!==n?(o[c]=function(){return n(arguments.length),t.apply(void 0,arguments)}).original=t:o[c]=t};for(var s in e)a();return r}t.instantiate=R,t.instantiateSync=function(e,t){return A(C(t||(t={})),new WebAssembly.Instance(e instanceof WebAssembly.Module?e:new WebAssembly.Module(e),t))},t.instantiateStreaming=Z,t.demangle=P},8584:function(e,t,r){"use strict";var n=r(2122).default,i=function(){var e=new Error("Delay aborted");return e.name="AbortError",e},a=function(e){var t=e.clearTimeout,r=e.setTimeout,n=e.willResolve;return function(e){var a,s,o,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=u.value,l=u.signal;if(l&&l.aborted)return Promise.reject(i());var h=t||clearTimeout,f=function(){h(a),o(i())},d=new Promise((function(t,i){s=function(){l&&l.removeEventListener("abort",f),n?t(c):i(c)},o=i,a=(r||setTimeout)(s,e)}));return l&&l.addEventListener("abort",f,{once:!0}),d.clear=function(){h(a),a=null,s()},d}},s=function(e){var t=a(n(n({},e),{},{willResolve:!0}));return t.reject=a(n(n({},e),{},{willResolve:!1})),t.range=function(e,r,n){return t(function(e,t){return Math.floor(Math.random()*(t-e+1)+e)}(e,r),n)},t},o=s();o.createWithTimers=s,e.exports=o,e.exports.default=o},9814:function(e){"use strict";e.exports=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var n=0;n<e.length;n++){var i=e.charAt(n),a=i.charCodeAt(0);if(255!==t[a])throw new TypeError(i+" is ambiguous");t[a]=n}var s=e.length,o=e.charAt(0),u=Math.log(s)/Math.log(256),c=Math.log(256)/Math.log(s);function l(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var r=0;if(" "!==e[r]){for(var n=0,i=0;e[r]===o;)n++,r++;for(var a=(e.length-r)*u+1>>>0,c=new Uint8Array(a);e[r];){var l=t[e.charCodeAt(r)];if(255===l)return;for(var h=0,f=a-1;(0!==l||h<i)&&-1!==f;f--,h++)l+=s*c[f]>>>0,c[f]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=h,r++}if(" "!==e[r]){for(var d=a-i;d!==a&&0===c[d];)d++;for(var p=new Uint8Array(n+(a-d)),v=n;d!==a;)p[v++]=c[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,a=t.length;i!==a&&0===t[i];)i++,r++;for(var u=(a-i)*c+1>>>0,l=new Uint8Array(u);i!==a;){for(var h=t[i],f=0,d=u-1;(0!==h||f<n)&&-1!==d;d--,f++)h+=256*l[d]>>>0,l[d]=h%s>>>0,h=h/s>>>0;if(0!==h)throw new Error("Non-zero carry");n=f,i++}for(var p=u-n;p!==u&&0===l[p];)p++;for(var v=o.repeat(r);p<u;++p)v+=e.charAt(l[p]);return v},decodeUnsafe:l,decode:function(e){var t=l(e);if(t)return t;throw new Error("Non-base"+s+" character")}}}},7206:function(e){"use strict";e.exports=function(e,t){var r=new Array(arguments.length-1),n=0,i=2,a=!0;for(;i<arguments.length;)r[n++]=arguments[i++];return new Promise((function(i,s){r[n]=function(e){if(a)if(a=!1,e)s(e);else{for(var t=new Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];i.apply(null,t)}};try{e.apply(t||null,r)}catch(o){a&&(a=!1,s(o))}}))}},1:function(e,t){"use strict";var r=t;r.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};for(var n=new Array(64),i=new Array(123),a=0;a<64;)i[n[a]=a<26?a+65:a<52?a+71:a<62?a-4:a-59|43]=a++;r.encode=function(e,t,r){for(var i,a=null,s=[],o=0,u=0;t<r;){var c=e[t++];switch(u){case 0:s[o++]=n[c>>2],i=(3&c)<<4,u=1;break;case 1:s[o++]=n[i|c>>4],i=(15&c)<<2,u=2;break;case 2:s[o++]=n[i|c>>6],s[o++]=n[63&c],u=0}o>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,s)),o=0)}return u&&(s[o++]=n[i],s[o++]=61,1===u&&(s[o++]=61)),a?(o&&a.push(String.fromCharCode.apply(String,s.slice(0,o))),a.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var s="invalid encoding";r.decode=function(e,t,r){for(var n,a=r,o=0,u=0;u<e.length;){var c=e.charCodeAt(u++);if(61===c&&o>1)break;if(void 0===(c=i[c]))throw Error(s);switch(o){case 0:n=c,o=1;break;case 1:t[r++]=n<<2|(48&c)>>4,n=c,o=2;break;case 2:t[r++]=(15&n)<<4|(60&c)>>2,n=c,o=3;break;case 3:t[r++]=(3&n)<<6|c,o=0}}if(1===o)throw Error(s);return r-a},r.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},7111:function(e){"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],n=0;n<r.length;)r[n].fn===t?r.splice(n,1):++n;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,r)}return this}},802:function(e){"use strict";function t(e){return"undefined"!==typeof Float32Array?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=128===r[3];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3]}function a(e,n,i){t[0]=e,n[i]=r[3],n[i+1]=r[2],n[i+2]=r[1],n[i+3]=r[0]}function s(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],t[0]}function o(e,n){return r[3]=e[n],r[2]=e[n+1],r[1]=e[n+2],r[0]=e[n+3],t[0]}e.writeFloatLE=n?i:a,e.writeFloatBE=n?a:i,e.readFloatLE=n?s:o,e.readFloatBE=n?o:s}():function(){function t(e,t,r,n){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,r,n);else if(isNaN(t))e(2143289344,r,n);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,r,n);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,r,n);else{var a=Math.floor(Math.log(t)/Math.LN2);e((i<<31|a+127<<23|8388607&Math.round(t*Math.pow(2,-a)*8388608))>>>0,r,n)}}function s(e,t,r){var n=e(t,r),i=2*(n>>31)+1,a=n>>>23&255,s=8388607&n;return 255===a?s?NaN:i*(1/0):0===a?1401298464324817e-60*i*s:i*Math.pow(2,a-150)*(s+8388608)}e.writeFloatLE=t.bind(null,r),e.writeFloatBE=t.bind(null,n),e.readFloatLE=s.bind(null,i),e.readFloatBE=s.bind(null,a)}(),"undefined"!==typeof Float64Array?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=128===r[7];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3],n[i+4]=r[4],n[i+5]=r[5],n[i+6]=r[6],n[i+7]=r[7]}function a(e,n,i){t[0]=e,n[i]=r[7],n[i+1]=r[6],n[i+2]=r[5],n[i+3]=r[4],n[i+4]=r[3],n[i+5]=r[2],n[i+6]=r[1],n[i+7]=r[0]}function s(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],r[4]=e[n+4],r[5]=e[n+5],r[6]=e[n+6],r[7]=e[n+7],t[0]}function o(e,n){return r[7]=e[n],r[6]=e[n+1],r[5]=e[n+2],r[4]=e[n+3],r[3]=e[n+4],r[2]=e[n+5],r[1]=e[n+6],r[0]=e[n+7],t[0]}e.writeDoubleLE=n?i:a,e.writeDoubleBE=n?a:i,e.readDoubleLE=n?s:o,e.readDoubleBE=n?o:s}():function(){function t(e,t,r,n,i,a){var s=n<0?1:0;if(s&&(n=-n),0===n)e(0,i,a+t),e(1/n>0?0:2147483648,i,a+r);else if(isNaN(n))e(0,i,a+t),e(2146959360,i,a+r);else if(n>17976931348623157e292)e(0,i,a+t),e((s<<31|2146435072)>>>0,i,a+r);else{var o;if(n<22250738585072014e-324)e((o=n/5e-324)>>>0,i,a+t),e((s<<31|o/4294967296)>>>0,i,a+r);else{var u=Math.floor(Math.log(n)/Math.LN2);1024===u&&(u=1023),e(4503599627370496*(o=n*Math.pow(2,-u))>>>0,i,a+t),e((s<<31|u+1023<<20|1048576*o&1048575)>>>0,i,a+r)}}}function s(e,t,r,n,i){var a=e(n,i+t),s=e(n,i+r),o=2*(s>>31)+1,u=s>>>20&2047,c=4294967296*(1048575&s)+a;return 2047===u?c?NaN:o*(1/0):0===u?5e-324*o*c:o*Math.pow(2,u-1075)*(c+4503599627370496)}e.writeDoubleLE=t.bind(null,r,0,4),e.writeDoubleBE=t.bind(null,n,4,0),e.readDoubleLE=s.bind(null,i,0,4),e.readDoubleBE=s.bind(null,a,4,0)}(),e}function r(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function n(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function i(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function a(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},7172:function(module){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},8236:function(e){"use strict";e.exports=function(e,t,r){var n=r||8192,i=n>>>1,a=null,s=n;return function(r){if(r<1||r>i)return e(r);s+r>n&&(a=e(n),s=0);var o=t.call(a,s,s+=r);return 7&s&&(s=1+(7|s)),o}}},3861:function(e,t){"use strict";var r=t;r.length=function(e){for(var t=0,r=0,n=0;n<e.length;++n)(r=e.charCodeAt(n))<128?t+=1:r<2048?t+=2:55296===(64512&r)&&56320===(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},r.read=function(e,t,r){if(r-t<1)return"";for(var n,i=null,a=[],s=0;t<r;)(n=e[t++])<128?a[s++]=n:n>191&&n<224?a[s++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,a[s++]=55296+(n>>10),a[s++]=56320+(1023&n)):a[s++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,a)),s=0);return i?(s&&i.push(String.fromCharCode.apply(String,a.slice(0,s))),i.join("")):String.fromCharCode.apply(String,a.slice(0,s))},r.write=function(e,t,r){for(var n,i,a=r,s=0;s<e.length;++s)(n=e.charCodeAt(s))<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=63&n|128):55296===(64512&n)&&56320===(64512&(i=e.charCodeAt(s+1)))?(n=65536+((1023&n)<<10)+(1023&i),++s,t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=63&n|128):(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=63&n|128);return r-a}},6755:function(e,t){"use strict";var r=Math.exp;e.exports=function(e){if("number"!==typeof e)throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");var t,n,i=0,a=0,s=0,o={};return o.push=function(o,u){if(n){var c=1-r(-(o-n)/e),l=u-t;t=c*u+(1-c)*t,i=(1-c)*(i+l*(c*l)),a=Math.sqrt(i),s=t+c*l}else t=u;n=o},o.movingAverage=function(){return t},o.variance=function(){return i},o.deviation=function(){return a},o.forecast=function(){return s},o}},2009:function(e,t){"use strict";t.byteLength=function(e){var t=o(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,a=o(e),s=a[0],u=a[1],c=new i(function(e,t,r){return 3*(t+r)/4-r}(0,s,u)),l=0,h=u>0?s-4:s;for(r=0;r<h;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],c[l++]=t>>16&255,c[l++]=t>>8&255,c[l++]=255&t;2===u&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,c[l++]=255&t);1===u&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,c[l++]=t>>8&255,c[l++]=255&t);return c},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,a=[],s=16383,o=0,c=n-i;o<c;o+=s)a.push(u(e,o,o+s>c?c:o+s));1===i?(t=e[n-1],a.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],a.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return a.join("")};for(var r=[],n=[],i="undefined"!==typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)r[s]=a[s],n[a.charCodeAt(s)]=s;function o(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function u(e,t,n){for(var i,a,s=[],o=t;o<n;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),s.push(r[(a=i)>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return s.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},9778:function(e,t,r){"use strict";var n=r(6690).default,i=r(9728).default,a=r(6115).default,s=r(1655).default,o=r(6389).default,u=r(2009),c=r(4038),l="function"===typeof Symbol&&"function"===typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.lW=d,t.h2=50;var h=2147483647;function f(e){if(e>h)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,d.prototype),t}function d(e,t,r){if("number"===typeof e){if("string"===typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return g(e)}return p(e,t,r)}function p(e,t,r){if("string"===typeof e)return function(e,t){"string"===typeof t&&""!==t||(t="utf8");if(!d.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|_(e,t),n=f(r),i=n.write(e,t);i!==r&&(n=n.slice(0,i));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(ee(e,Uint8Array)){var t=new Uint8Array(e);return m(t.buffer,t.byteOffset,t.byteLength)}return y(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(ee(e,ArrayBuffer)||e&&ee(e.buffer,ArrayBuffer))return m(e,t,r);if("undefined"!==typeof SharedArrayBuffer&&(ee(e,SharedArrayBuffer)||e&&ee(e.buffer,SharedArrayBuffer)))return m(e,t,r);if("number"===typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return d.from(n,t,r);var i=function(e){if(d.isBuffer(e)){var t=0|b(e.length),r=f(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!==typeof e.length||te(e.length)?f(0):y(e);if("Buffer"===e.type&&Array.isArray(e.data))return y(e.data)}(e);if(i)return i;if("undefined"!==typeof Symbol&&null!=Symbol.toPrimitive&&"function"===typeof e[Symbol.toPrimitive])return d.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function v(e){if("number"!==typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function g(e){return v(e),f(e<0?0:0|b(e))}function y(e){for(var t=e.length<0?0:0|b(e.length),r=f(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function m(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,d.prototype),n}function b(e){if(e>=h)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+h.toString(16)+" bytes");return 0|e}function _(e,t){if(d.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||ee(e,ArrayBuffer))return e.byteLength;if("string"!==typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return X(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return J(e).length;default:if(i)return n?-1:X(e).length;t=(""+t).toLowerCase(),i=!0}}function w(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return M(this,t,r);case"utf8":case"utf-8":return Z(this,t,r);case"ascii":return P(this,t,r);case"latin1":case"binary":return L(this,t,r);case"base64":return T(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function k(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function x(e,t,r,n,i){if(0===e.length)return-1;if("string"===typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),te(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"===typeof t&&(t=d.from(t,n)),d.isBuffer(t))return 0===t.length?-1:E(e,t,r,n,i);if("number"===typeof t)return t&=255,"function"===typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):E(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function E(e,t,r,n,i){var a,s=1,o=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,o/=2,u/=2,r/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var l=-1;for(a=r;a<o;a++)if(c(e,a)===c(t,-1===l?0:a-l)){if(-1===l&&(l=a),a-l+1===u)return l*s}else-1!==l&&(a-=a-l),l=-1}else for(r+u>o&&(r=o-u),a=r;a>=0;a--){for(var h=!0,f=0;f<u;f++)if(c(e,a+f)!==c(t,f)){h=!1;break}if(h)return a}return-1}function S(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var a,s=t.length;for(n>s/2&&(n=s/2),a=0;a<n;++a){var o=parseInt(t.substr(2*a,2),16);if(te(o))return a;e[r+a]=o}return a}function C(e,t,r,n){return $(X(t,e.length-r),e,r,n)}function A(e,t,r,n){return $(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function D(e,t,r,n){return $(J(t),e,r,n)}function R(e,t,r,n){return $(function(e,t){for(var r,n,i,a=[],s=0;s<e.length&&!((t-=2)<0);++s)n=(r=e.charCodeAt(s))>>8,i=r%256,a.push(i),a.push(n);return a}(t,e.length-r),e,r,n)}function T(e,t,r){return 0===t&&r===e.length?u.fromByteArray(e):u.fromByteArray(e.slice(t,r))}function Z(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var a=e[i],s=null,o=a>239?4:a>223?3:a>191?2:1;if(i+o<=r){var u=void 0,c=void 0,l=void 0,h=void 0;switch(o){case 1:a<128&&(s=a);break;case 2:128===(192&(u=e[i+1]))&&(h=(31&a)<<6|63&u)>127&&(s=h);break;case 3:u=e[i+1],c=e[i+2],128===(192&u)&&128===(192&c)&&(h=(15&a)<<12|(63&u)<<6|63&c)>2047&&(h<55296||h>57343)&&(s=h);break;case 4:u=e[i+1],c=e[i+2],l=e[i+3],128===(192&u)&&128===(192&c)&&128===(192&l)&&(h=(15&a)<<18|(63&u)<<12|(63&c)<<6|63&l)>65535&&h<1114112&&(s=h)}}null===s?(s=65533,o=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),i+=o}return function(e){var t=e.length;if(t<=I)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=I));return r}(n)}d.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(r){return!1}}(),d.TYPED_ARRAY_SUPPORT||"undefined"===typeof console||"function"!==typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(d.prototype,"parent",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.buffer}}),Object.defineProperty(d.prototype,"offset",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.byteOffset}}),d.poolSize=8192,d.from=function(e,t,r){return p(e,t,r)},Object.setPrototypeOf(d.prototype,Uint8Array.prototype),Object.setPrototypeOf(d,Uint8Array),d.alloc=function(e,t,r){return function(e,t,r){return v(e),e<=0?f(e):void 0!==t?"string"===typeof r?f(e).fill(t,r):f(e).fill(t):f(e)}(e,t,r)},d.allocUnsafe=function(e){return g(e)},d.allocUnsafeSlow=function(e){return g(e)},d.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==d.prototype},d.compare=function(e,t){if(ee(e,Uint8Array)&&(e=d.from(e,e.offset,e.byteLength)),ee(t,Uint8Array)&&(t=d.from(t,t.offset,t.byteLength)),!d.isBuffer(e)||!d.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,a=Math.min(r,n);i<a;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},d.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return d.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=d.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var a=e[r];if(ee(a,Uint8Array))i+a.length>n.length?(d.isBuffer(a)||(a=d.from(a)),a.copy(n,i)):Uint8Array.prototype.set.call(n,a,i);else{if(!d.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,i)}i+=a.length}return n},d.byteLength=_,d.prototype._isBuffer=!0,d.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)k(this,t,t+1);return this},d.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)k(this,t,t+3),k(this,t+1,t+2);return this},d.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)k(this,t,t+7),k(this,t+1,t+6),k(this,t+2,t+5),k(this,t+3,t+4);return this},d.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?Z(this,0,e):w.apply(this,arguments)},d.prototype.toLocaleString=d.prototype.toString,d.prototype.equals=function(e){if(!d.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===d.compare(this,e)},d.prototype.inspect=function(){var e="",r=t.h2;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},l&&(d.prototype[l]=d.prototype.inspect),d.prototype.compare=function(e,t,r,n,i){if(ee(e,Uint8Array)&&(e=d.from(e,e.offset,e.byteLength)),!d.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var a=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0),o=Math.min(a,s),u=this.slice(n,i),c=e.slice(t,r),l=0;l<o;++l)if(u[l]!==c[l]){a=u[l],s=c[l];break}return a<s?-1:s<a?1:0},d.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},d.prototype.indexOf=function(e,t,r){return x(this,e,t,r,!0)},d.prototype.lastIndexOf=function(e,t,r){return x(this,e,t,r,!1)},d.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"===typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var a=!1;;)switch(n){case"hex":return S(this,e,t,r);case"utf8":case"utf-8":return C(this,e,t,r);case"ascii":case"latin1":case"binary":return A(this,e,t,r);case"base64":return D(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,t,r);default:if(a)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),a=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function P(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function L(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function M(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",a=t;a<r;++a)i+=re[e[a]];return i}function B(e,t,r){for(var n=e.slice(t,r),i="",a=0;a<n.length-1;a+=2)i+=String.fromCharCode(n[a]+256*n[a+1]);return i}function O(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function N(e,t,r,n,i,a){if(!d.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function F(e,t,r,n,i){K(t,n,i,e,r,7);var a=Number(t&BigInt(4294967295));e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a;var s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,r}function U(e,t,r,n,i){K(t,n,i,e,r,7);var a=Number(t&BigInt(4294967295));e[r+7]=a,a>>=8,e[r+6]=a,a>>=8,e[r+5]=a,a>>=8,e[r+4]=a;var s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=s,s>>=8,e[r+2]=s,s>>=8,e[r+1]=s,s>>=8,e[r]=s,r+8}function z(e,t,r,n,i,a){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function j(e,t,r,n,i){return t=+t,r>>>=0,i||z(e,0,r,4),c.write(e,t,r,n,23,4),r+4}function H(e,t,r,n,i){return t=+t,r>>>=0,i||z(e,0,r,8),c.write(e,t,r,n,52,8),r+8}d.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,d.prototype),n},d.prototype.readUintLE=d.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||O(e,t,this.length);for(var n=this[e],i=1,a=0;++a<t&&(i*=256);)n+=this[e+a]*i;return n},d.prototype.readUintBE=d.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||O(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},d.prototype.readUint8=d.prototype.readUInt8=function(e,t){return e>>>=0,t||O(e,1,this.length),this[e]},d.prototype.readUint16LE=d.prototype.readUInt16LE=function(e,t){return e>>>=0,t||O(e,2,this.length),this[e]|this[e+1]<<8},d.prototype.readUint16BE=d.prototype.readUInt16BE=function(e,t){return e>>>=0,t||O(e,2,this.length),this[e]<<8|this[e+1]},d.prototype.readUint32LE=d.prototype.readUInt32LE=function(e,t){return e>>>=0,t||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},d.prototype.readUint32BE=d.prototype.readUInt32BE=function(e,t){return e>>>=0,t||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},d.prototype.readBigUInt64LE=ne((function(e){Y(e>>>=0,"offset");var t=this[e],r=this[e+7];void 0!==t&&void 0!==r||G(e,this.length-8);var n=t+this[++e]*Math.pow(2,8)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,24),i=this[++e]+this[++e]*Math.pow(2,8)+this[++e]*Math.pow(2,16)+r*Math.pow(2,24);return BigInt(n)+(BigInt(i)<<BigInt(32))})),d.prototype.readBigUInt64BE=ne((function(e){Y(e>>>=0,"offset");var t=this[e],r=this[e+7];void 0!==t&&void 0!==r||G(e,this.length-8);var n=t*Math.pow(2,24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+this[++e],i=this[++e]*Math.pow(2,24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),d.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||O(e,t,this.length);for(var n=this[e],i=1,a=0;++a<t&&(i*=256);)n+=this[e+a]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},d.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||O(e,t,this.length);for(var n=t,i=1,a=this[e+--n];n>0&&(i*=256);)a+=this[e+--n]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*t)),a},d.prototype.readInt8=function(e,t){return e>>>=0,t||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},d.prototype.readInt16LE=function(e,t){e>>>=0,t||O(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},d.prototype.readInt16BE=function(e,t){e>>>=0,t||O(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},d.prototype.readInt32LE=function(e,t){return e>>>=0,t||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},d.prototype.readInt32BE=function(e,t){return e>>>=0,t||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},d.prototype.readBigInt64LE=ne((function(e){Y(e>>>=0,"offset");var t=this[e],r=this[e+7];void 0!==t&&void 0!==r||G(e,this.length-8);var n=this[e+4]+this[e+5]*Math.pow(2,8)+this[e+6]*Math.pow(2,16)+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+this[++e]*Math.pow(2,8)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,24))})),d.prototype.readBigInt64BE=ne((function(e){Y(e>>>=0,"offset");var t=this[e],r=this[e+7];void 0!==t&&void 0!==r||G(e,this.length-8);var n=(t<<24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*Math.pow(2,24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+r)})),d.prototype.readFloatLE=function(e,t){return e>>>=0,t||O(e,4,this.length),c.read(this,e,!0,23,4)},d.prototype.readFloatBE=function(e,t){return e>>>=0,t||O(e,4,this.length),c.read(this,e,!1,23,4)},d.prototype.readDoubleLE=function(e,t){return e>>>=0,t||O(e,8,this.length),c.read(this,e,!0,52,8)},d.prototype.readDoubleBE=function(e,t){return e>>>=0,t||O(e,8,this.length),c.read(this,e,!1,52,8)},d.prototype.writeUintLE=d.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||N(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,a=0;for(this[t]=255&e;++a<r&&(i*=256);)this[t+a]=e/i&255;return t+r},d.prototype.writeUintBE=d.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||N(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+r},d.prototype.writeUint8=d.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,1,255,0),this[t]=255&e,t+1},d.prototype.writeUint16LE=d.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},d.prototype.writeUint16BE=d.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},d.prototype.writeUint32LE=d.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},d.prototype.writeUint32BE=d.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},d.prototype.writeBigUInt64LE=ne((function(e){return F(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,BigInt(0),BigInt("0xffffffffffffffff"))})),d.prototype.writeBigUInt64BE=ne((function(e){return U(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,BigInt(0),BigInt("0xffffffffffffffff"))})),d.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);N(this,e,t,r,i-1,-i)}var a=0,s=1,o=0;for(this[t]=255&e;++a<r&&(s*=256);)e<0&&0===o&&0!==this[t+a-1]&&(o=1),this[t+a]=(e/s>>0)-o&255;return t+r},d.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);N(this,e,t,r,i-1,-i)}var a=r-1,s=1,o=0;for(this[t+a]=255&e;--a>=0&&(s*=256);)e<0&&0===o&&0!==this[t+a+1]&&(o=1),this[t+a]=(e/s>>0)-o&255;return t+r},d.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},d.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},d.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},d.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},d.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},d.prototype.writeBigInt64LE=ne((function(e){return F(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),d.prototype.writeBigInt64BE=ne((function(e){return U(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),d.prototype.writeFloatLE=function(e,t,r){return j(this,e,t,!0,r)},d.prototype.writeFloatBE=function(e,t,r){return j(this,e,t,!1,r)},d.prototype.writeDoubleLE=function(e,t,r){return H(this,e,t,!0,r)},d.prototype.writeDoubleBE=function(e,t,r){return H(this,e,t,!1,r)},d.prototype.copy=function(e,t,r,n){if(!d.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i=n-r;return this===e&&"function"===typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},d.prototype.fill=function(e,t,r,n){if("string"===typeof e){if("string"===typeof t?(n=t,t=0,r=this.length):"string"===typeof r&&(n=r,r=this.length),void 0!==n&&"string"!==typeof n)throw new TypeError("encoding must be a string");if("string"===typeof n&&!d.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var i=e.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(e=i)}}else"number"===typeof e?e&=255:"boolean"===typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var a;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"===typeof e)for(a=t;a<r;++a)this[a]=e;else{var s=d.isBuffer(e)?e:d.from(e,n),o=s.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<r-t;++a)this[a+t]=s[a%o]}return this};var W={};function q(e,t,r){W[e]=function(r){s(c,r);var u=o(c);function c(){var r;return n(this,c),r=u.call(this),Object.defineProperty(a(r),"message",{value:t.apply(a(r),arguments),writable:!0,configurable:!0}),r.name="".concat(r.name," [").concat(e,"]"),r.stack,delete r.name,r}return i(c,[{key:"code",get:function(){return e},set:function(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}},{key:"toString",value:function(){return"".concat(this.name," [").concat(e,"]: ").concat(this.message)}}]),c}(r)}function V(e){for(var t="",r=e.length,n="-"===e[0]?1:0;r>=n+4;r-=3)t="_".concat(e.slice(r-3,r)).concat(t);return"".concat(e.slice(0,r)).concat(t)}function K(e,t,r,n,i,a){if(e>r||e<t){var s,o="bigint"===typeof t?"n":"";throw s=a>3?0===t||t===BigInt(0)?">= 0".concat(o," and < 2").concat(o," ** ").concat(8*(a+1)).concat(o):">= -(2".concat(o," ** ").concat(8*(a+1)-1).concat(o,") and < 2 ** ")+"".concat(8*(a+1)-1).concat(o):">= ".concat(t).concat(o," and <= ").concat(r).concat(o),new W.ERR_OUT_OF_RANGE("value",s,e)}!function(e,t,r){Y(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||G(t,e.length-(r+1))}(n,i,a)}function Y(e,t){if("number"!==typeof e)throw new W.ERR_INVALID_ARG_TYPE(t,"number",e)}function G(e,t,r){if(Math.floor(e)!==e)throw Y(e,r),new W.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new W.ERR_BUFFER_OUT_OF_BOUNDS;throw new W.ERR_OUT_OF_RANGE(r||"offset",">= ".concat(r?1:0," and <= ").concat(t),e)}q("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?"".concat(e," is outside of buffer bounds"):"Attempt to access memory outside buffer bounds"}),RangeError),q("ERR_INVALID_ARG_TYPE",(function(e,t){return'The "'.concat(e,'" argument must be of type number. Received type ').concat(typeof t)}),TypeError),q("ERR_OUT_OF_RANGE",(function(e,t,r){var n='The value of "'.concat(e,'" is out of range.'),i=r;return Number.isInteger(r)&&Math.abs(r)>Math.pow(2,32)?i=V(String(r)):"bigint"===typeof r&&(i=String(r),(r>Math.pow(BigInt(2),BigInt(32))||r<-Math.pow(BigInt(2),BigInt(32)))&&(i=V(i)),i+="n"),n+=" It must be ".concat(t,". Received ").concat(i)}),RangeError);var Q=/[^+/0-9A-Za-z-_]/g;function X(e,t){var r;t=t||1/0;for(var n=e.length,i=null,a=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&a.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&a.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;a.push(r)}else if(r<2048){if((t-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return a}function J(e){return u.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(Q,"")).length<2)return"";for(;e.length%4!==0;)e+="=";return e}(e))}function $(e,t,r,n){var i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function ee(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function te(e){return e!==e}var re=function(){for(var e="0123456789abcdef",t=new Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)t[n+i]=e[r]+e[i];return t}();function ne(e){return"undefined"===typeof BigInt?ie:e}function ie(){throw new Error("BigInt not supported")}},8392:function(e,t,r){var n=r(1426);t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(n++,"%c"===e&&(i=n))})),t.splice(i,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(r){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(r){}!e&&"undefined"!==typeof n&&"env"in n&&(e={NODE_ENV:"production",PUBLIC_URL:"/iot-test",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.DEBUG);return e},t.useColors=function(){if("undefined"!==typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=function(){var e=!1;return function(){e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||function(){},e.exports=r(8472)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},8472:function(e,t,r){var n=r(861).default;e.exports=function(e){function t(e){var r,n,a,s=null;function o(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];if(o.enabled){var a=o,s=Number(new Date),u=s-(r||s);a.diff=u,a.prev=r,a.curr=s,r=s,n[0]=t.coerce(n[0]),"string"!==typeof n[0]&&n.unshift("%O");var c=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,(function(e,r){if("%%"===e)return"%";c++;var i=t.formatters[r];if("function"===typeof i){var s=n[c];e=i.call(a,s),n.splice(c,1),c--}return e})),t.formatArgs.call(a,n),(a.log||t.log).apply(a,n)}}return o.namespace=e,o.useColors=t.useColors(),o.color=t.selectColor(e),o.extend=i,o.destroy=t.destroy,Object.defineProperty(o,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==s?s:(n!==t.namespaces&&(n=t.namespaces,a=t.enabled(e)),a)},set:function(e){s=e}}),"function"===typeof t.init&&t.init(o),o}function i(e,r){var n=t(this.namespace+("undefined"===typeof r?":":r)+e);return n.log=this.log,n}function a(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){var e=[].concat(n(t.names.map(a)),n(t.skips.map(a).map((function(e){return"-"+e})))).join(",");return t.enable(""),e},t.enable=function(e){var r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];var n=("string"===typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(8193),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((function(r){t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){for(var r=0,n=0;n<e.length;n++)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},8718:function(e){"use strict";function t(e,t){t=t||{};this._capacity=t.capacity,this._head=0,this._tail=0,Array.isArray(e)?this._fromArray(e):(this._capacityMask=3,this._list=new Array(4))}t.prototype.peekAt=function(e){var t=e;if(t===(0|t)){var r=this.size();if(!(t>=r||t<-r))return t<0&&(t+=r),t=this._head+t&this._capacityMask,this._list[t]}},t.prototype.get=function(e){return this.peekAt(e)},t.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]},t.prototype.peekFront=function(){return this.peek()},t.prototype.peekBack=function(){return this.peekAt(-1)},Object.defineProperty(t.prototype,"length",{get:function(){return this.size()}}),t.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},t.prototype.unshift=function(e){if(0===arguments.length)return this.size();var t=this._list.length;return this._head=this._head-1+t&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},t.prototype.shift=function(){var e=this._head;if(e!==this._tail){var t=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),t}},t.prototype.push=function(e){if(0===arguments.length)return this.size();var t=this._tail;return this._list[t]=e,this._tail=t+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},t.prototype.pop=function(){var e=this._tail;if(e!==this._head){var t=this._list.length;this._tail=e-1+t&this._capacityMask;var r=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=t>>>2&&this._shrinkArray(),r}},t.prototype.removeOne=function(e){var t=e;if(t===(0|t)&&this._head!==this._tail){var r=this.size(),n=this._list.length;if(!(t>=r||t<-r)){t<0&&(t+=r),t=this._head+t&this._capacityMask;var i,a=this._list[t];if(e<r/2){for(i=e;i>0;i--)this._list[t]=this._list[t=t-1+n&this._capacityMask];this._list[t]=void 0,this._head=this._head+1+n&this._capacityMask}else{for(i=r-1-e;i>0;i--)this._list[t]=this._list[t=t+1+n&this._capacityMask];this._list[t]=void 0,this._tail=this._tail-1+n&this._capacityMask}return a}}},t.prototype.remove=function(e,t){var r,n=e,i=t;if(n===(0|n)&&this._head!==this._tail){var a=this.size(),s=this._list.length;if(!(n>=a||n<-a||t<1)){if(n<0&&(n+=a),1===t||!t)return(r=new Array(1))[0]=this.removeOne(n),r;if(0===n&&n+t>=a)return r=this.toArray(),this.clear(),r;var o;for(n+t>a&&(t=a-n),r=new Array(t),o=0;o<t;o++)r[o]=this._list[this._head+n+o&this._capacityMask];if(n=this._head+n&this._capacityMask,e+t===a){for(this._tail=this._tail-t+s&this._capacityMask,o=t;o>0;o--)this._list[n=n+1+s&this._capacityMask]=void 0;return r}if(0===e){for(this._head=this._head+t+s&this._capacityMask,o=t-1;o>0;o--)this._list[n=n+1+s&this._capacityMask]=void 0;return r}if(n<a/2){for(this._head=this._head+e+t+s&this._capacityMask,o=e;o>0;o--)this.unshift(this._list[n=n-1+s&this._capacityMask]);for(n=this._head-1+s&this._capacityMask;i>0;)this._list[n=n-1+s&this._capacityMask]=void 0,i--;e<0&&(this._tail=n)}else{for(this._tail=n,n=n+t+s&this._capacityMask,o=a-(t+e);o>0;o--)this.push(this._list[n++]);for(n=this._tail;i>0;)this._list[n=n+1+s&this._capacityMask]=void 0,i--}return this._head<2&&this._tail>1e4&&this._tail<=s>>>2&&this._shrinkArray(),r}}},t.prototype.splice=function(e,t){var r=e;if(r===(0|r)){var n=this.size();if(r<0&&(r+=n),!(r>n)){if(arguments.length>2){var i,a,s,o=arguments.length,u=this._list.length,c=2;if(!n||r<n/2){for(a=new Array(r),i=0;i<r;i++)a[i]=this._list[this._head+i&this._capacityMask];for(0===t?(s=[],r>0&&(this._head=this._head+r+u&this._capacityMask)):(s=this.remove(r,t),this._head=this._head+r+u&this._capacityMask);o>c;)this.unshift(arguments[--o]);for(i=r;i>0;i--)this.unshift(a[i-1])}else{var l=(a=new Array(n-(r+t))).length;for(i=0;i<l;i++)a[i]=this._list[this._head+r+t+i&this._capacityMask];for(0===t?(s=[],r!=n&&(this._tail=this._head+r+u&this._capacityMask)):(s=this.remove(r,t),this._tail=this._tail-l+u&this._capacityMask);c<o;)this.push(arguments[c++]);for(i=0;i<l;i++)this.push(a[i])}return s}return this.remove(r,t)}}},t.prototype.clear=function(){this._list=new Array(this._list.length),this._head=0,this._tail=0},t.prototype.isEmpty=function(){return this._head===this._tail},t.prototype.toArray=function(){return this._copyArray(!1)},t.prototype._fromArray=function(e){var t=e.length,r=this._nextPowerOf2(t);this._list=new Array(r),this._capacityMask=r-1,this._tail=t;for(var n=0;n<t;n++)this._list[n]=e[n]},t.prototype._copyArray=function(e,t){var r=this._list,n=r.length,i=this.length;if((t|=i)==i&&this._head<this._tail)return this._list.slice(this._head,this._tail);var a,s=new Array(t),o=0;if(e||this._head>this._tail){for(a=this._head;a<n;a++)s[o++]=r[a];for(a=0;a<this._tail;a++)s[o++]=r[a]}else for(a=this._head;a<this._tail;a++)s[o++]=r[a];return s},t.prototype._growArray=function(){if(0!=this._head){var e=this._copyArray(!0,this._list.length<<1);this._tail=this._list.length,this._head=0,this._list=e}else this._tail=this._list.length,this._list.length<<=1;this._capacityMask=this._capacityMask<<1|1},t.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1},t.prototype._nextPowerOf2=function(e){var t=1<<Math.log(e)/Math.log(2)+1;return Math.max(t,4)},e.exports=t},7963:function(e){"use strict";function t(e,t){for(var r in t)Object.defineProperty(e,r,{value:t[r],enumerable:!0,configurable:!0});return e}e.exports=function(e,r,n){if(!e||"string"===typeof e)throw new TypeError("Please pass an Error to err-code");n||(n={}),"object"===typeof r&&(n=r,r=""),r&&(n.code=r);try{return t(e,n)}catch(a){n.message=e.message,n.stack=e.stack;var i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(e)),t(new i,n)}}},3634:function(e,t,r){"use strict";var n=r(5413);t.zN=n.EventIterator,n.EventIterator},5413:function(e,t,r){"use strict";var n=r(4704).default,i=r(6690).default,a=r(9728).default;Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){i(this,t),this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}return a(t,[{key:"push",value:function(e){if(!this.isStopped){var t={value:e,done:!1};if(this.pullQueue.length){var r=this.pullQueue.shift();r&&r.resolve(t)}else this.pushQueue.push(Promise.resolve(t)),void 0!==this.highWaterMark&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():console&&console.warn("EventIterator queue reached ".concat(this.pushQueue.length," items")))}}},{key:"stop",value:function(){if(!this.isStopped){this.isStopped=!0,this.remove();var e,t=n(this.pullQueue);try{for(t.s();!(e=t.n()).done;){e.value.resolve({value:void 0,done:!0})}}catch(r){t.e(r)}finally{t.f()}this.pullQueue.length=0}}},{key:"fail",value:function(e){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){var t,r=n(this.pullQueue);try{for(r.s();!(t=r.n()).done;){t.value.reject(e)}}catch(a){r.e(a)}finally{r.f()}this.pullQueue.length=0}else{var i=Promise.reject(e);i.catch((function(){})),this.pushQueue.push(i)}}},{key:"remove",value:function(){var e=this;Promise.resolve().then((function(){e.removeCallback&&e.removeCallback()}))}},{key:e,value:function(){var e=this;return{next:function(t){var r=e.pushQueue.shift();return r?(void 0!==e.lowWaterMark&&e.pushQueue.length<=e.lowWaterMark&&e.isPaused&&(e.isPaused=!1,e.eventHandlers.lowWater&&e.eventHandlers.lowWater()),r):e.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise((function(t,r){e.pullQueue.push({resolve:t,reject:r})}))},return:function(){return e.isStopped=!0,e.pushQueue.length=0,e.remove(),Promise.resolve({value:void 0,done:!0})}}}}]),t}(Symbol.asyncIterator),o=a((function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.highWaterMark,a=void 0===n?100:n,o=r.lowWaterMark,u=void 0===o?1:o;i(this,e);var c=new s;c.highWaterMark=a,c.lowWaterMark=u,c.removeCallback=t({push:function(e){return c.push(e)},stop:function(){return c.stop()},fail:function(e){return c.fail(e)},on:function(e,t){c.eventHandlers[e]=t}})||function(){},this[Symbol.asyncIterator]=function(){return c[Symbol.asyncIterator]()},Object.freeze(this)}));t.EventIterator=o,t.default=o},7143:function(e){"use strict";var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function a(e,t,n,a,s){if("function"!==typeof n)throw new TypeError("The listener must be a function");var o=new i(n,a||e,s),u=r?r+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],o]:e._events[u].push(o):(e._events[u]=o,e._eventsCount++),e}function s(e,t){0===--e._eventsCount?e._events=new n:delete e._events[t]}function o(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),o.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},o.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,a=n.length,s=new Array(a);i<a;i++)s[i]=n[i].fn;return s},o.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},o.prototype.emit=function(e,t,n,i,a,s){var o=r?r+e:e;if(!this._events[o])return!1;var u,c,l=this._events[o],h=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),h){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,i),!0;case 5:return l.fn.call(l.context,t,n,i,a),!0;case 6:return l.fn.call(l.context,t,n,i,a,s),!0}for(c=1,u=new Array(h-1);c<h;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var f,d=l.length;for(c=0;c<d;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),h){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,n);break;case 4:l[c].fn.call(l[c].context,t,n,i);break;default:if(!u)for(f=1,u=new Array(h-1);f<h;f++)u[f-1]=arguments[f];l[c].fn.apply(l[c].context,u)}}return!0},o.prototype.on=function(e,t,r){return a(this,e,t,r,!1)},o.prototype.once=function(e,t,r){return a(this,e,t,r,!0)},o.prototype.removeListener=function(e,t,n,i){var a=r?r+e:e;if(!this._events[a])return this;if(!t)return s(this,a),this;var o=this._events[a];if(o.fn)o.fn!==t||i&&!o.once||n&&o.context!==n||s(this,a);else{for(var u=0,c=[],l=o.length;u<l;u++)(o[u].fn!==t||i&&!o[u].once||n&&o[u].context!==n)&&c.push(o[u]);c.length?this._events[a]=1===c.length?c[0]:c:s(this,a)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o},7465:function(e){"use strict";var t,r="object"===typeof Reflect?Reflect:null,n=r&&"function"===typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"===typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!==e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,a),n(r)}function a(){"function"===typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}v(e,t,a,{once:!0}),"error"!==t&&function(e,t,r){"function"===typeof e.on&&v(e,"error",t,r)}(e,i,{once:!0})}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var s=10;function o(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function c(e,t,r,n){var i,a,s,c;if(o(r),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),a=e._events),s=a[t]),void 0===s)s=a[t]=r,++e._eventsCount;else if("function"===typeof s?s=a[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=u(e))>0&&s.length>i&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,c=l,console&&console.warn&&console.warn(c)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=l.bind(n);return i.listener=r,n.wrapFn=i,i}function f(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"===typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):p(i,i.length)}function d(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"===typeof r)return 1;if(void 0!==r)return r.length}return 0}function p(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function v(e,t,r,n){if("function"===typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(a){n.once&&e.removeEventListener(t,i),r(a)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!==typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return u(this)},a.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,a=this._events;if(void 0!==a)i=i&&void 0===a.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var u=a[e];if(void 0===u)return!1;if("function"===typeof u)n(u,this,t);else{var c=u.length,l=p(u,c);for(r=0;r<c;++r)n(l[r],this,t)}return!0},a.prototype.addListener=function(e,t){return c(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return c(this,e,t,!0)},a.prototype.once=function(e,t){return o(t),this.on(e,h(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return o(t),this.prependListener(e,h(this,e,t)),this},a.prototype.removeListener=function(e,t){var r,n,i,a,s;if(o(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!==typeof r){for(i=-1,a=r.length-1;a>=0;a--)if(r[a]===t||r[a].listener===t){s=r[a].listener,i=a;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,a=Object.keys(r);for(n=0;n<a.length;++n)"removeListener"!==(i=a[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},a.prototype.listeners=function(e){return f(this,e,!0)},a.prototype.rawListeners=function(e){return f(this,e,!1)},a.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},a.prototype.listenerCount=d,a.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},4737:function(e){e.exports=function(e){if(!e)throw Error("hashlru must have a max value, of type number, greater than 0");var t=0,r=Object.create(null),n=Object.create(null);function i(i,a){r[i]=a,++t>=e&&(t=0,n=r,r=Object.create(null))}return{has:function(e){return void 0!==r[e]||void 0!==n[e]},remove:function(e){void 0!==r[e]&&(r[e]=void 0),void 0!==n[e]&&(n[e]=void 0)},get:function(e){var t=r[e];return void 0!==t?t:void 0!==(t=n[e])?(i(e,t),t):void 0},set:function(e,t){void 0!==r[e]?r[e]=t:i(e,t)},clear:function(){r=Object.create(null),n=Object.create(null)}}}},4038:function(e,t){t.read=function(e,t,r,n,i){var a,s,o=8*i-n-1,u=(1<<o)-1,c=u>>1,l=-7,h=r?i-1:0,f=r?-1:1,d=e[t+h];for(h+=f,a=d&(1<<-l)-1,d>>=-l,l+=o;l>0;a=256*a+e[t+h],h+=f,l-=8);for(s=a&(1<<-l)-1,a>>=-l,l+=n;l>0;s=256*s+e[t+h],h+=f,l-=8);if(0===a)a=1-c;else{if(a===u)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,n),a-=c}return(d?-1:1)*s*Math.pow(2,a-n)},t.write=function(e,t,r,n,i,a){var s,o,u,c=8*a-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:a-1,p=n?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),(t+=s+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(s++,u/=2),s+h>=l?(o=0,s=l):s+h>=1?(o=(t*u-1)*Math.pow(2,i),s+=h):(o=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[r+d]=255&o,d+=p,o/=256,i-=8);for(s=s<<i|o,c+=i;c>0;e[r+d]=255&s,d+=p,s/=256,c-=8);e[r+d-p]|=128*v}},7201:function(e){!function(t){"use strict";var r="(0?\\d+|0x[a-f0-9]+)",n={fourOctet:new RegExp("^".concat(r,"\\.").concat(r,"\\.").concat(r,"\\.").concat(r,"$"),"i"),threeOctet:new RegExp("^".concat(r,"\\.").concat(r,"\\.").concat(r,"$"),"i"),twoOctet:new RegExp("^".concat(r,"\\.").concat(r,"$"),"i"),longValue:new RegExp("^".concat(r,"$"),"i")},i=new RegExp("^0[0-7]+$","i"),a=new RegExp("^0x[a-f0-9]+$","i"),s="%[0-9a-z]{1,}",o="(?:[0-9a-f]+::?)+",u={zoneIndex:new RegExp(s,"i"),native:new RegExp("^(::)?(".concat(o,")?([0-9a-f]+)?(::)?(").concat(s,")?$"),"i"),deprecatedTransitional:new RegExp("^(?:::)(".concat(r,"\\.").concat(r,"\\.").concat(r,"\\.").concat(r,"(").concat(s,")?)$"),"i"),transitional:new RegExp("^((?:".concat(o,")|(?:::)(?:").concat(o,")?)").concat(r,"\\.").concat(r,"\\.").concat(r,"\\.").concat(r,"(").concat(s,")?$"),"i")};function c(e,t){if(e.indexOf("::")!==e.lastIndexOf("::"))return null;var r,n,i=0,a=-1,s=(e.match(u.zoneIndex)||[])[0];for(s&&(s=s.substring(1),e=e.replace(/%.+$/,""));(a=e.indexOf(":",a+1))>=0;)i++;if("::"===e.substr(0,2)&&i--,"::"===e.substr(-2,2)&&i--,i>t)return null;for(n=t-i,r=":";n--;)r+="0:";return":"===(e=e.replace("::",r))[0]&&(e=e.slice(1)),":"===e[e.length-1]&&(e=e.slice(0,-1)),{parts:t=function(){for(var t=e.split(":"),r=[],n=0;n<t.length;n++)r.push(parseInt(t[n],16));return r}(),zoneId:s}}function l(e,t,r,n){if(e.length!==t.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");for(var i,a=0;n>0;){if((i=r-n)<0&&(i=0),e[a]>>i!==t[a]>>i)return!1;n-=r,a+=1}return!0}function h(e){if(a.test(e))return parseInt(e,16);if("0"===e[0]&&!isNaN(parseInt(e[1],10))){if(i.test(e))return parseInt(e,8);throw new Error("ipaddr: cannot parse ".concat(e," as octal"))}return parseInt(e,10)}function f(e,t){for(;e.length<t;)e="0".concat(e);return e}var d={};d.IPv4=function(){function e(e){if(4!==e.length)throw new Error("ipaddr: ipv4 octet count should be 4");var t,r;for(t=0;t<e.length;t++)if(!(0<=(r=e[t])&&r<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=e}return e.prototype.SpecialRanges={unspecified:[[new e([0,0,0,0]),8]],broadcast:[[new e([255,255,255,255]),32]],multicast:[[new e([224,0,0,0]),4]],linkLocal:[[new e([169,254,0,0]),16]],loopback:[[new e([127,0,0,0]),8]],carrierGradeNat:[[new e([100,64,0,0]),10]],private:[[new e([10,0,0,0]),8],[new e([172,16,0,0]),12],[new e([192,168,0,0]),16]],reserved:[[new e([192,0,0,0]),24],[new e([192,0,2,0]),24],[new e([192,88,99,0]),24],[new e([198,18,0,0]),15],[new e([198,51,100,0]),24],[new e([203,0,113,0]),24],[new e([240,0,0,0]),4]]},e.prototype.kind=function(){return"ipv4"},e.prototype.match=function(e,t){var r;if(void 0===t&&(e=(r=e)[0],t=r[1]),"ipv4"!==e.kind())throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return l(this.octets,e.octets,8,t)},e.prototype.prefixLengthFromSubnetMask=function(){var e,t,r,n=0,i=!1,a={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};for(e=3;e>=0;e-=1){if(!((t=this.octets[e])in a))return null;if(r=a[t],i&&0!==r)return null;8!==r&&(i=!0),n+=r}return 32-n},e.prototype.range=function(){return d.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){return this.octets.slice(0)},e.prototype.toIPv4MappedAddress=function(){return d.IPv6.parse("::ffff:".concat(this.toString()))},e.prototype.toNormalizedString=function(){return this.toString()},e.prototype.toString=function(){return this.octets.join(".")},e}(),d.IPv4.broadcastAddressFromCIDR=function(e){try{for(var t=this.parseCIDR(e),r=t[0].toByteArray(),n=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[],a=0;a<4;)i.push(parseInt(r[a],10)|255^parseInt(n[a],10)),a++;return new this(i)}catch(s){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},d.IPv4.isIPv4=function(e){return null!==this.parser(e)},d.IPv4.isValid=function(e){try{return new this(this.parser(e)),!0}catch(t){return!1}},d.IPv4.isValidFourPartDecimal=function(e){return!(!d.IPv4.isValid(e)||!e.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},d.IPv4.networkAddressFromCIDR=function(e){var t,r,n,i,a;try{for(n=(t=this.parseCIDR(e))[0].toByteArray(),a=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[],r=0;r<4;)i.push(parseInt(n[r],10)&parseInt(a[r],10)),r++;return new this(i)}catch(s){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},d.IPv4.parse=function(e){var t=this.parser(e);if(null===t)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(t)},d.IPv4.parseCIDR=function(e){var t;if(t=e.match(/^(.+)\/(\d+)$/)){var r=parseInt(t[2]);if(r>=0&&r<=32){var n=[this.parse(t[1]),r];return Object.defineProperty(n,"toString",{value:function(){return this.join("/")}}),n}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},d.IPv4.parser=function(e){var t,r,i;if(t=e.match(n.fourOctet))return function(){for(var e=t.slice(1,6),n=[],i=0;i<e.length;i++)r=e[i],n.push(h(r));return n}();if(t=e.match(n.longValue)){if((i=h(t[1]))>4294967295||i<0)throw new Error("ipaddr: address outside defined range");return function(){var e,t=[];for(e=0;e<=24;e+=8)t.push(i>>e&255);return t}().reverse()}return(t=e.match(n.twoOctet))?function(){var e=t.slice(1,4),r=[];if((i=h(e[1]))>16777215||i<0)throw new Error("ipaddr: address outside defined range");return r.push(h(e[0])),r.push(i>>16&255),r.push(i>>8&255),r.push(255&i),r}():(t=e.match(n.threeOctet))?function(){var e=t.slice(1,5),r=[];if((i=h(e[2]))>65535||i<0)throw new Error("ipaddr: address outside defined range");return r.push(h(e[0])),r.push(h(e[1])),r.push(i>>8&255),r.push(255&i),r}():null},d.IPv4.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>32)throw new Error("ipaddr: invalid IPv4 prefix length");for(var t=[0,0,0,0],r=0,n=Math.floor(e/8);r<n;)t[r]=255,r++;return n<4&&(t[n]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},d.IPv6=function(){function e(e,t){var r,n;if(16===e.length)for(this.parts=[],r=0;r<=14;r+=2)this.parts.push(e[r]<<8|e[r+1]);else{if(8!==e.length)throw new Error("ipaddr: ipv6 part count should be 8 or 16");this.parts=e}for(r=0;r<this.parts.length;r++)if(!(0<=(n=this.parts[r])&&n<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");t&&(this.zoneId=t)}return e.prototype.SpecialRanges={unspecified:[new e([0,0,0,0,0,0,0,0]),128],linkLocal:[new e([65152,0,0,0,0,0,0,0]),10],multicast:[new e([65280,0,0,0,0,0,0,0]),8],loopback:[new e([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new e([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new e([0,0,0,0,0,65535,0,0]),96],rfc6145:[new e([0,0,0,0,65535,0,0,0]),96],rfc6052:[new e([100,65435,0,0,0,0,0,0]),96],"6to4":[new e([8194,0,0,0,0,0,0,0]),16],teredo:[new e([8193,0,0,0,0,0,0,0]),32],reserved:[[new e([8193,3512,0,0,0,0,0,0]),32]],benchmarking:[new e([8193,2,0,0,0,0,0,0]),48],amt:[new e([8193,3,0,0,0,0,0,0]),32],as112v6:[new e([8193,4,274,0,0,0,0,0]),48],deprecated:[new e([8193,16,0,0,0,0,0,0]),28],orchid2:[new e([8193,32,0,0,0,0,0,0]),28]},e.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},e.prototype.kind=function(){return"ipv6"},e.prototype.match=function(e,t){var r;if(void 0===t&&(e=(r=e)[0],t=r[1]),"ipv6"!==e.kind())throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return l(this.parts,e.parts,16,t)},e.prototype.prefixLengthFromSubnetMask=function(){for(var e,t,r=0,n=!1,i={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0},a=7;a>=0;a-=1){if(!((e=this.parts[a])in i))return null;if(t=i[e],n&&0!==t)return null;16!==t&&(n=!0),r+=t}return 128-r},e.prototype.range=function(){return d.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){for(var e,t=[],r=this.parts,n=0;n<r.length;n++)e=r[n],t.push(e>>8),t.push(255&e);return t},e.prototype.toFixedLengthString=function(){var e=function(){for(var e=[],t=0;t<this.parts.length;t++)e.push(f(this.parts[t].toString(16),4));return e}.call(this).join(":"),t="";return this.zoneId&&(t="%".concat(this.zoneId)),e+t},e.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");var e=this.parts.slice(-2),t=e[0],r=e[1];return new d.IPv4([t>>8,255&t,r>>8,255&r])},e.prototype.toNormalizedString=function(){var e=function(){for(var e=[],t=0;t<this.parts.length;t++)e.push(this.parts[t].toString(16));return e}.call(this).join(":"),t="";return this.zoneId&&(t="%".concat(this.zoneId)),e+t},e.prototype.toRFC5952String=function(){for(var e,t=/((^|:)(0(:|$)){2,})/g,r=this.toNormalizedString(),n=0,i=-1;e=t.exec(r);)e[0].length>i&&(n=e.index,i=e[0].length);return i<0?r:"".concat(r.substring(0,n),"::").concat(r.substring(n+i))},e.prototype.toString=function(){return this.toRFC5952String()},e}(),d.IPv6.broadcastAddressFromCIDR=function(e){try{for(var t=this.parseCIDR(e),r=t[0].toByteArray(),n=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[],a=0;a<16;)i.push(parseInt(r[a],10)|255^parseInt(n[a],10)),a++;return new this(i)}catch(s){throw new Error("ipaddr: the address does not have IPv6 CIDR format (".concat(s,")"))}},d.IPv6.isIPv6=function(e){return null!==this.parser(e)},d.IPv6.isValid=function(e){if("string"===typeof e&&-1===e.indexOf(":"))return!1;try{var t=this.parser(e);return new this(t.parts,t.zoneId),!0}catch(r){return!1}},d.IPv6.networkAddressFromCIDR=function(e){var t,r,n,i,a;try{for(n=(t=this.parseCIDR(e))[0].toByteArray(),a=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[],r=0;r<16;)i.push(parseInt(n[r],10)&parseInt(a[r],10)),r++;return new this(i)}catch(s){throw new Error("ipaddr: the address does not have IPv6 CIDR format (".concat(s,")"))}},d.IPv6.parse=function(e){var t=this.parser(e);if(null===t.parts)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(t.parts,t.zoneId)},d.IPv6.parseCIDR=function(e){var t,r,n;if((r=e.match(/^(.+)\/(\d+)$/))&&(t=parseInt(r[2]))>=0&&t<=128)return n=[this.parse(r[1]),t],Object.defineProperty(n,"toString",{value:function(){return this.join("/")}}),n;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},d.IPv6.parser=function(e){var t,r,n,i,a,s;if(n=e.match(u.deprecatedTransitional))return this.parser("::ffff:".concat(n[1]));if(u.native.test(e))return c(e,8);if((n=e.match(u.transitional))&&(s=n[6]||"",(t=c(n[1].slice(0,-1)+s,6)).parts)){for(a=[parseInt(n[2]),parseInt(n[3]),parseInt(n[4]),parseInt(n[5])],r=0;r<a.length;r++)if(!(0<=(i=a[r])&&i<=255))return null;return t.parts.push(a[0]<<8|a[1]),t.parts.push(a[2]<<8|a[3]),{parts:t.parts,zoneId:t.zoneId}}return null},d.IPv6.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>128)throw new Error("ipaddr: invalid IPv6 prefix length");for(var t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=0,n=Math.floor(e/8);r<n;)t[r]=255,r++;return n<16&&(t[n]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},d.fromByteArray=function(e){var t=e.length;if(4===t)return new d.IPv4(e);if(16===t)return new d.IPv6(e);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},d.isValid=function(e){return d.IPv6.isValid(e)||d.IPv4.isValid(e)},d.parse=function(e){if(d.IPv6.isValid(e))return d.IPv6.parse(e);if(d.IPv4.isValid(e))return d.IPv4.parse(e);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},d.parseCIDR=function(e){try{return d.IPv6.parseCIDR(e)}catch(t){try{return d.IPv4.parseCIDR(e)}catch(r){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},d.process=function(e){var t=this.parse(e);return"ipv6"===t.kind()&&t.isIPv4MappedAddress()?t.toIPv4Address():t},d.subnetMatch=function(e,t,r){var n,i,a,s;for(i in void 0!==r&&null!==r||(r="unicast"),t)if(Object.prototype.hasOwnProperty.call(t,i))for(!(a=t[i])[0]||a[0]instanceof Array||(a=[a]),n=0;n<a.length;n++)if(s=a[n],e.kind()===s[0].kind()&&e.match.apply(e,s))return i;return r},e.exports?e.exports=d:t.ipaddr=d}(this)},8314:function(e,t,r){var n=r(4704).default;function i(e){var t=new globalThis.AbortController;function r(){t.abort();var i,a=n(e);try{for(a.s();!(i=a.n()).done;){var s=i.value;s&&s.removeEventListener&&s.removeEventListener("abort",r)}}catch(o){a.e(o)}finally{a.f()}}var i,a=n(e);try{for(a.s();!(i=a.n()).done;){var s=i.value;if(s&&s.addEventListener){if(s.aborted){r();break}s.addEventListener("abort",r)}}}catch(o){a.e(o)}finally{a.f()}return t.signal}e.exports=i,e.exports.anySignal=i},1306:function(e,t,r){"use strict";var n=r(7061).default,i=r(6737).default,a=r(8186).default;function s(){return s=a((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n().mark((function r(){var a,s;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:a=e.getReader(),r.prev=1;case 2:return r.next=5,i(a.read());case 5:if(!(s=r.sent).done){r.next=8;break}return r.abrupt("return");case 8:return r.next=10,s.value;case 10:r.next=2;break;case 12:return r.prev=12,!0!==t.preventCancel&&a.cancel(),a.releaseLock(),r.finish(12);case 16:case"end":return r.stop()}}),r,null,[[1,,12,16]])}))()})),s.apply(this,arguments)}e.exports=function(e){return s.apply(this,arguments)}},6963:function(e,t,r){"use strict";var n=r(7061).default,i=r(7156).default,a=r(8237).default,s=function(){var e=i(n().mark((function e(t){var r,i,s,o,u,c,l;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],i=!1,s=!1,e.prev=3,u=a(t);case 5:return e.next=7,u.next();case 7:if(!(i=!(c=e.sent).done)){e.next=13;break}l=c.value,r.push(l);case 10:i=!1,e.next=5;break;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(3),s=!0,o=e.t0;case 19:if(e.prev=19,e.prev=20,!i||null==u.return){e.next=24;break}return e.next=24,u.return();case 24:if(e.prev=24,!s){e.next=27;break}throw o;case 27:return e.finish(24);case 28:return e.finish(19);case 29:return e.abrupt("return",r);case 30:case"end":return e.stop()}}),e,null,[[3,15,19,29],[20,,24,28]])})));return function(t){return e.apply(this,arguments)}}();e.exports=s},3749:function(e,t,r){"use strict";globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?e.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:e.exports={default:r(5359).default,Headers:r(5359).Headers,Request:r(5359).Request,Response:r(5359).Response}},6927:function(e,t,r){"use strict";var n=r(1426),i=r(2193),a="object"===typeof window&&"object"===typeof document&&9===document.nodeType,s=i(),o=a&&!s,u=s&&!a,c=s&&a,l="undefined"!==typeof n&&"undefined"!==typeof n.release&&"node"===n.release.name&&!s,h="function"===typeof importScripts&&"undefined"!==typeof self&&"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,f="undefined"!==typeof n&&!1,d="undefined"!==typeof navigator&&"ReactNative"===navigator.product;e.exports={isTest:f,isElectron:s,isElectronMain:u,isElectronRenderer:c,isNode:l,isBrowser:o,isWebWorker:h,isEnvWithDom:a,isReactNative:d}},5213:function(e,t,r){"use strict";e.exports=r(3749)},5014:function(e,t,r){"use strict";var n=r(7061).default,i=r(8186).default,a=r(6737).default,s=r(8131).default,o=r(8237).default,u=r(8257);function c(e,t){return l.apply(this,arguments)}function l(){return(l=i(n().mark((function e(t,r){var i,c;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new u,e.next=3,a(i.get(t,r));case 3:return c=e.sent,e.delegateYield(s(o(c.iterator()),a),"t0",5);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}e.exports=function(e,t){return{path:decodeURIComponent(new URL(e).pathname.split("/").pop()||""),content:c(e,t)}}},8257:function(e,t,r){"use strict";var n=r(8416).default,i=r(7061).default,a=r(2122).default,s=r(7156).default,o=r(6690).default,u=r(9728).default,c=r(8186).default,l=r(6737).default,h=r(8131).default,f=r(8237).default,d=r(2020),p=d.fetch,v=d.Request,g=d.Headers,y=r(8407),m=y.TimeoutError,b=y.HTTPError,_=r(9842).bind({ignoreUndefined:!0}),w=r(6791),k=w.URL,x=w.URLSearchParams,E=r(8314),S=r(1306),C=r(6927),A=C.isBrowser,D=C.isWebWorker,R=r(6963),T=function(e,t,r){if(void 0===t)return e;var n=Date.now(),i=function(){return Date.now()-n>=t};return new Promise((function(n,a){var s=setTimeout((function(){i()&&(a(new m),r.abort())}),t),o=function(e){return function(t){clearTimeout(s),i()?a(new m):e(t)}};e.then(o(n),o(a))}))},Z={throwHttpErrors:!0,credentials:"same-origin"},I=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this.opts=_(Z,t)}return u(e,[{key:"fetch",value:function(){var e=s(i().mark((function e(t){var r,n,s,o,u,d,y,m,w,C,Z=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Z.length>1&&void 0!==Z[1]?Z[1]:{},n=_(this.opts,r),s=new g(n.headers),"string"===typeof t||(t instanceof k||t instanceof v)){e.next=5;break}throw new TypeError("`resource` must be a string, URL, or Request");case 5:if(o=new k(t.toString(),n.base),u=n.searchParams,d=n.transformSearchParams,y=n.json,u&&(o.search="function"===typeof d?d(new x(n.searchParams)):new x(n.searchParams)),y&&(n.body=JSON.stringify(n.json),s.set("content-type","application/json")),m=new AbortController,w=E([m.signal,n.signal]),!(null!=globalThis.ReadableStream&&n.body instanceof globalThis.ReadableStream&&(A||D))){e.next=17;break}return e.t0=Blob,e.next=15,R(S(n.body));case 15:e.t1=e.sent,n.body=new e.t0(e.t1);case 17:return e.next=19,T(p(o.toString(),a(a({},n),{},{signal:w,timeout:void 0,headers:s,duplex:"half"})),n.timeout,m);case 19:if((C=e.sent).ok||!n.throwHttpErrors){e.next=25;break}if(!n.handleError){e.next=24;break}return e.next=24,n.handleError(C);case 24:throw new b(C);case 25:return C.iterator=c(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(h(f(L(C.body)),l),"t0",1);case 1:case"end":return e.stop()}}),e)}))),C.ndjson=c(i().mark((function e(){var t,n,a,s,o,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!1,n=!1,e.prev=2,s=f(P(C.iterator()));case 4:return e.next=6,l(s.next());case 6:if(!(t=!(o=e.sent).done)){e.next=18;break}if(u=o.value,!r.transform){e.next=13;break}return e.next=11,r.transform(u);case 11:e.next=15;break;case 13:return e.next=15,u;case 15:t=!1,e.next=4;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(2),n=!0,a=e.t0;case 24:if(e.prev=24,e.prev=25,!t||null==s.return){e.next=29;break}return e.next=29,l(s.return());case 29:if(e.prev=29,!n){e.next=32;break}throw a;case 32:return e.finish(29);case 33:return e.finish(24);case 34:case"end":return e.stop()}}),e,null,[[2,20,24,34],[25,,29,33]])}))),e.abrupt("return",C);case 28:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"post",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.fetch(e,a(a({},t),{},{method:"POST"}))}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.fetch(e,a(a({},t),{},{method:"GET"}))}},{key:"put",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.fetch(e,a(a({},t),{},{method:"PUT"}))}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.fetch(e,a(a({},t),{},{method:"DELETE"}))}},{key:"options",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.fetch(e,a(a({},t),{},{method:"OPTIONS"}))}}]),e}(),P=function(){var e=c(i().mark((function e(t){var r,n,a,s,o,u,c,h,d,p,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=new TextDecoder,n="",a=!1,s=!1,e.prev=4,u=f(t);case 6:return e.next=8,l(u.next());case 8:if(!(a=!(c=e.sent).done)){e.next=25;break}h=c.value,n+=r.decode(h,{stream:!0}),d=n.split(/\r?\n/),p=0;case 13:if(!(p<d.length-1)){e.next=21;break}if(!((v=d[p].trim()).length>0)){e.next=18;break}return e.next=18,JSON.parse(v);case 18:p++,e.next=13;break;case 21:n=d[d.length-1];case 22:a=!1,e.next=6;break;case 25:e.next=31;break;case 27:e.prev=27,e.t0=e.catch(4),s=!0,o=e.t0;case 31:if(e.prev=31,e.prev=32,!a||null==u.return){e.next=36;break}return e.next=36,l(u.return());case 36:if(e.prev=36,!s){e.next=39;break}throw o;case 39:return e.finish(36);case 40:return e.finish(31);case 41:if(0===(n=(n+=r.decode()).trim()).length){e.next=46;break}return e.next=46,JSON.parse(n);case 46:case"end":return e.stop()}}),e,null,[[4,27,31,41],[32,,36,40]])})));return function(t){return e.apply(this,arguments)}}(),L=function(e){if(M(e))return e;if(O(e)){var t=e[Symbol.asyncIterator]();return n({},Symbol.asyncIterator,(function(){return{next:t.next.bind(t),return:function(r){return e.destroy(),"function"===typeof t.return?t.return():Promise.resolve({done:!0,value:r})}}}))}if(B(e)){var r=e.getReader();return c(i().mark((function e(){var t,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0;case 1:return e.next=4,l(r.read());case 4:if(t=e.sent,n=t.done,a=t.value,!n){e.next=9;break}return e.abrupt("return");case 9:if(!a){e.next=12;break}return e.next=12,a;case 12:e.next=1;break;case 14:return e.prev=14,r.releaseLock(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[0,,14,17]])})))()}throw new TypeError("Body can't be converted to AsyncIterable")},M=function(e){return"object"===typeof e&&null!==e&&"function"===typeof e[Symbol.asyncIterator]},B=function(e){return e&&"function"===typeof e.getReader},O=function(e){return Object.prototype.hasOwnProperty.call(e,"readable")&&Object.prototype.hasOwnProperty.call(e,"writable")};I.HTTPError=b,I.TimeoutError=m,I.streamToAsyncIterator=L,I.post=function(e,t){return new I(t).post(e,t)},I.get=function(e,t){return new I(t).get(e,t)},I.put=function(e,t){return new I(t).put(e,t)},I.delete=function(e,t){return new I(t).delete(e,t)},I.options=function(e,t){return new I(t).options(e,t)},e.exports=I},8407:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,a=r(1655).default,s=r(6389).default,o=r(3496).default,u=function(e){a(r,e);var t=s(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Request timed out";return i(this,r),(e=t.call(this,n)).name="TimeoutError",e}return n(r)}(o(Error));t.TimeoutError=u;var c=function(e){a(r,e);var t=s(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The operation was aborted.";return i(this,r),(e=t.call(this,n)).name="AbortError",e}return n(r)}(o(Error));t.AbortError=c;var l=function(e){a(r,e);var t=s(r);function r(e){var n;return i(this,r),(n=t.call(this,e.statusText)).name="HTTPError",n.response=e,n}return n(r)}(o(Error));t.HTTPError=l},2020:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,a=r(6115).default,s=r(1655).default,o=r(6389).default,u=r(7424).default,c=r(4704).default,l=r(8407),h=l.TimeoutError,f=l.AbortError,d=r(5213),p=d.Response,v=d.Request,g=d.Headers,y=d.default,m=y,b=function(e){var t,r=new g,n=c(e.trim().split(/[\r\n]+/));try{for(n.s();!(t=n.n()).done;){var i=t.value,a=i.indexOf(": ");a>0&&r.set(i.slice(0,a),i.slice(a+1))}}catch(s){n.e(s)}finally{n.f()}return r},_=function(e){s(r,e);var t=o(r);function r(e,n,s){var o;return i(this,r),o=t.call(this,n,s),Object.defineProperty(a(o),"url",{value:e}),o}return n(r)}(p);e.exports={fetch:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null!=t.onUploadProgress?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new XMLHttpRequest;r.open(t.method||"GET",e.toString(),!0);var n=t.timeout,i=t.headers;if(n&&n>0&&n<1/0&&(r.timeout=n),null!=t.overrideMimeType&&r.overrideMimeType(t.overrideMimeType),i){var a,s=c(new g(i));try{for(s.s();!(a=s.n()).done;){var o=u(a.value,2),l=o[0],d=o[1];r.setRequestHeader(l,d)}}catch(v){s.e(v)}finally{s.f()}}return t.signal&&(t.signal.onabort=function(){return r.abort()}),t.onUploadProgress&&(r.upload.onprogress=t.onUploadProgress),r.responseType="arraybuffer",new Promise((function(e,n){var i=function(t){switch(t.type){case"error":e(p.error());break;case"load":e(new _(r.responseURL,r.response,{status:r.status,statusText:r.statusText,headers:b(r.getAllResponseHeaders())}));break;case"timeout":n(new h);break;case"abort":n(new f)}};r.onerror=i,r.onload=i,r.ontimeout=i,r.onabort=i,r.send(t.body)}))}(e,t):m(e,t)},Request:v,Headers:g}},2193:function(e,t,r){var n=r(1426);e.exports=function(){return"undefined"!==typeof window&&"object"===typeof window.process&&"renderer"===window.process.type||(!("undefined"===typeof n||"object"!==typeof n.versions||!n.versions.electron)||"object"===typeof navigator&&"string"===typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0)}},887:function(e){"use strict";e.exports=function(e){if("[object Object]"!==Object.prototype.toString.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}},5410:function(e){"use strict";var t=65536;e.exports=function(e){var r=new Uint8Array(e),n=0;if(e>0)if(e>t)for(;n<e;)n+t>e?(crypto.getRandomValues(r.subarray(n,n+(e-n))),n+=e-n):(crypto.getRandomValues(r.subarray(n,n+t)),n+=t);else crypto.getRandomValues(r);return r}},6791:function(e,t,r){"use strict";var n=r(5732),i=n.URLWithLegacySupport,a=n.format,s=n.URLSearchParams,o=n.defaultBase,u=r(9640);e.exports={URL:i,URLSearchParams:s,format:a,relative:u,defaultBase:o}},9640:function(e,t,r){"use strict";var n=r(5732),i=n.URLWithLegacySupport,a=n.format;e.exports=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0,o=r.protocol?r.protocol.replace(":",""):"http";o=(n[o]||s||o)+":";try{t=new i(e)}catch(c){t={}}var u=Object.assign({},r,{protocol:o||t.protocol,host:r.host||t.host});return new i(e,a(u)).toString()}},5732:function(e,t,r){"use strict";var n=r(6690).default,i=r(9728).default,a="undefined"!==typeof navigator&&"ReactNative"===navigator.product;var s=self.URL,o=a?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:"",u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o;n(this,e),this.super=new s(t,r),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}return i(e,[{key:"hash",get:function(){return this.super.hash},set:function(e){this.super.hash=e}},{key:"host",get:function(){return this.super.host},set:function(e){this.super.host=e}},{key:"hostname",get:function(){return this.super.hostname},set:function(e){this.super.hostname=e}},{key:"href",get:function(){return this.super.href},set:function(e){this.super.href=e}},{key:"origin",get:function(){return this.super.origin}},{key:"password",get:function(){return this.super.password},set:function(e){this.super.password=e}},{key:"pathname",get:function(){return this.super.pathname},set:function(e){this.super.pathname=e}},{key:"port",get:function(){return this.super.port},set:function(e){this.super.port=e}},{key:"protocol",get:function(){return this.super.protocol},set:function(e){this.super.protocol=e}},{key:"search",get:function(){return this.super.search},set:function(e){this.super.search=e}},{key:"searchParams",get:function(){return this.super.searchParams}},{key:"username",get:function(){return this.super.username},set:function(e){this.super.username=e}},{key:"toJSON",value:function(){return this.super.toJSON()}},{key:"toString",value:function(){return this.super.toString()}},{key:"format",value:function(){return this.toString()}}],[{key:"createObjectURL",value:function(e){return s.createObjectURL(e)}},{key:"revokeObjectURL",value:function(e){s.revokeObjectURL(e)}}]),e}();e.exports={URLWithLegacySupport:u,URLSearchParams:self.URLSearchParams,defaultBase:o,format:function(e){if("string"===typeof e)return new s(e).toString();if(!(e instanceof s)){var t=e.username&&e.password?"".concat(e.username,":").concat(e.password,"@"):"",r=e.auth?e.auth+"@":"",n=e.port?":"+e.port:"",i=e.protocol?e.protocol+"//":"",a=e.host||"",o=e.hostname||"",u=e.search||(e.query?"?"+e.query:""),c=e.hash||"",l=e.pathname||"",h=e.path||l+u;return"".concat(i).concat(t||r).concat(a||o+n).concat(h).concat(c)}}}},3925:function(e,t,r){e.exports=r(60),e.exports.parse=r(60),e.exports.stringify=r(4729)},60:function(e,t,r){var n=r(7061).default,i=r(6737).default,a=r(8186).default,s=r(8237).default;e.exports=function(e){return a(n().mark((function t(){var r,a,o,u,c,l,h,f,d,p,v;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=/\r?\n/,a=new TextDecoder("utf8"),o="",u=!1,c=!1,t.prev=5,h=s(e);case 7:return t.next=9,i(h.next());case 9:if(!(u=!(f=t.sent).done)){t.next=25;break}"string"===typeof(d=f.value)&&(d=(new TextEncoder).encode(d)),o+=a.decode(d,{stream:!0}),p=o.split(r),o=p.pop(),v=0;case 16:if(!(v<p.length)){t.next=22;break}return t.next=19,JSON.parse(p[v]);case 19:v++,t.next=16;break;case 22:u=!1,t.next=7;break;case 25:t.next=31;break;case 27:t.prev=27,t.t0=t.catch(5),c=!0,l=t.t0;case 31:if(t.prev=31,t.prev=32,!u||null==h.return){t.next=36;break}return t.next=36,i(h.return());case 36:if(t.prev=36,!c){t.next=39;break}throw l;case 39:return t.finish(36);case 40:return t.finish(31);case 41:if(!(o+=a.decode())){t.next=45;break}return t.next=45,JSON.parse(o);case 45:case"end":return t.stop()}}),t,null,[[5,27,31,41],[32,,36,40]])})))()}},4729:function(e,t,r){var n=r(7061).default,i=r(6737).default,a=r(8186).default,s=r(8237).default;e.exports=function(e){return a(n().mark((function t(){var r,a,o,u,c,l;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=!1,a=!1,t.prev=2,u=s(e);case 4:return t.next=6,i(u.next());case 6:if(!(r=!(c=t.sent).done)){t.next=13;break}return l=c.value,t.next=10,JSON.stringify(l)+"\n";case 10:r=!1,t.next=4;break;case 13:t.next=19;break;case 15:t.prev=15,t.t0=t.catch(2),a=!0,o=t.t0;case 19:if(t.prev=19,t.prev=20,!r||null==u.return){t.next=24;break}return t.next=24,i(u.return());case 24:if(t.prev=24,!a){t.next=27;break}throw o;case 27:return t.finish(24);case 28:return t.finish(19);case 29:case"end":return t.stop()}}),t,null,[[2,15,19,29],[20,,24,28]])})))()}},4736:function(e,t,r){var n=r(4704).default;function i(e){var t=new globalThis.AbortController;function r(){t.abort();var i,a=n(e);try{for(a.s();!(i=a.n()).done;){var s=i.value;s&&s.removeEventListener&&s.removeEventListener("abort",r)}}catch(o){a.e(o)}finally{a.f()}}var i,a=n(e);try{for(a.s();!(i=a.n()).done;){var s=i.value;if(s&&s.addEventListener){if(s.aborted){r();break}s.addEventListener("abort",r)}}}catch(o){a.e(o)}finally{a.f()}return t.signal}e.exports=i,e.exports.anySignal=i},9842:function(e,t,r){"use strict";var n=r(4704).default,i=r(887),a=Object.prototype.hasOwnProperty,s=Object.propertyIsEnumerable,o=function(e,t,r){return Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0})},u=this,c={concatArrays:!1,ignoreUndefined:!1},l=function(e){var t=[];for(var r in e)a.call(e,r)&&t.push(r);if(Object.getOwnPropertySymbols){var i,o=Object.getOwnPropertySymbols(e),u=n(o);try{for(u.s();!(i=u.n()).done;){var c=i.value;s.call(e,c)&&t.push(c)}}catch(l){u.e(l)}finally{u.f()}}return t};function h(e){return Array.isArray(e)?function(e){var t=e.slice(0,0);return l(e).forEach((function(r){o(t,r,h(e[r]))})),t}(e):i(e)?function(e){var t=null===Object.getPrototypeOf(e)?Object.create(null):{};return l(e).forEach((function(r){o(t,r,h(e[r]))})),t}(e):e}var f=function(e,t,r,n){return r.forEach((function(r){"undefined"===typeof t[r]&&n.ignoreUndefined||(r in e&&e[r]!==Object.getPrototypeOf(e)?o(e,r,p(e[r],t[r],n)):o(e,r,h(t[r])))})),e},d=function(e,t,r){var n=e.slice(0,0),i=0;return[e,t].forEach((function(t){for(var s=[],u=0;u<t.length;u++)a.call(t,u)&&(s.push(String(u)),o(n,i++,t===e?t[u]:h(t[u])));n=f(n,t,l(t).filter((function(e){return!s.includes(e)})),r)})),n};function p(e,t,r){return r.concatArrays&&Array.isArray(e)&&Array.isArray(t)?d(e,t,r):i(t)&&i(e)?f(e,t,l(t),r):h(t)}e.exports=function(){for(var e=p(h(c),this!==u&&this||{},c),t={_:{}},r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];for(var s=0,o=n;s<o.length;s++){var l=o[s];if(void 0!==l){if(!i(l))throw new TypeError("`"+l+"` is not an Option Object");t=p(t,{_:l},e)}}return t._}},2426:function(e,t,r){(e=r.nmd(e)).exports=function(){"use strict";var t,r;function n(){return t.apply(null,arguments)}function i(e){t=e}function a(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function s(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function o(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function u(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(o(e,t))return!1;return!0}function c(e){return void 0===e}function l(e){return"number"===typeof e||"[object Number]"===Object.prototype.toString.call(e)}function h(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function f(e,t){var r,n=[],i=e.length;for(r=0;r<i;++r)n.push(t(e[r],r));return n}function d(e,t){for(var r in t)o(t,r)&&(e[r]=t[r]);return o(t,"toString")&&(e.toString=t.toString),o(t,"valueOf")&&(e.valueOf=t.valueOf),e}function p(e,t,r,n){return Kr(e,t,r,n,!0).utc()}function v(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function g(e){return null==e._pf&&(e._pf=v()),e._pf}function y(e){if(null==e._isValid){var t=g(e),n=r.call(t.parsedDateParts,(function(e){return null!=e})),i=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(i=i&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return i;e._isValid=i}return e._isValid}function m(e){var t=p(NaN);return null!=e?d(g(t),e):g(t).userInvalidated=!0,t}r=Array.prototype.some?Array.prototype.some:function(e){var t,r=Object(this),n=r.length>>>0;for(t=0;t<n;t++)if(t in r&&e.call(this,r[t],t,r))return!0;return!1};var b=n.momentProperties=[],_=!1;function w(e,t){var r,n,i,a=b.length;if(c(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),c(t._i)||(e._i=t._i),c(t._f)||(e._f=t._f),c(t._l)||(e._l=t._l),c(t._strict)||(e._strict=t._strict),c(t._tzm)||(e._tzm=t._tzm),c(t._isUTC)||(e._isUTC=t._isUTC),c(t._offset)||(e._offset=t._offset),c(t._pf)||(e._pf=g(t)),c(t._locale)||(e._locale=t._locale),a>0)for(r=0;r<a;r++)c(i=t[n=b[r]])||(e[n]=i);return e}function k(e){w(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===_&&(_=!0,n.updateOffset(this),_=!1)}function x(e){return e instanceof k||null!=e&&null!=e._isAMomentObject}function E(e){!1===n.suppressDeprecationWarnings&&"undefined"!==typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function S(e,t){var r=!0;return d((function(){if(null!=n.deprecationHandler&&n.deprecationHandler(null,e),r){var i,a,s,u=[],c=arguments.length;for(a=0;a<c;a++){if(i="","object"===typeof arguments[a]){for(s in i+="\n["+a+"] ",arguments[0])o(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[a];u.push(i)}E(e+"\nArguments: "+Array.prototype.slice.call(u).join("")+"\n"+(new Error).stack),r=!1}return t.apply(this,arguments)}),t)}var C,A={};function D(e,t){null!=n.deprecationHandler&&n.deprecationHandler(e,t),A[e]||(E(t),A[e]=!0)}function R(e){return"undefined"!==typeof Function&&e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function T(e){var t,r;for(r in e)o(e,r)&&(R(t=e[r])?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Z(e,t){var r,n=d({},e);for(r in t)o(t,r)&&(s(e[r])&&s(t[r])?(n[r]={},d(n[r],e[r]),d(n[r],t[r])):null!=t[r]?n[r]=t[r]:delete n[r]);for(r in e)o(e,r)&&!o(t,r)&&s(e[r])&&(n[r]=d({},n[r]));return n}function I(e){null!=e&&this.set(e)}n.suppressDeprecationWarnings=!1,n.deprecationHandler=null,C=Object.keys?Object.keys:function(e){var t,r=[];for(t in e)o(e,t)&&r.push(t);return r};var P={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function L(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return R(n)?n.call(t,r):n}function M(e,t,r){var n=""+Math.abs(e),i=t-n.length;return(e>=0?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var B=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,O=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,N={},F={};function U(e,t,r,n){var i=n;"string"===typeof n&&(i=function(){return this[n]()}),e&&(F[e]=i),t&&(F[t[0]]=function(){return M(i.apply(this,arguments),t[1],t[2])}),r&&(F[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function z(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function j(e){var t,r,n=e.match(B);for(t=0,r=n.length;t<r;t++)F[n[t]]?n[t]=F[n[t]]:n[t]=z(n[t]);return function(t){var i,a="";for(i=0;i<r;i++)a+=R(n[i])?n[i].call(t,e):n[i];return a}}function H(e,t){return e.isValid()?(t=W(t,e.localeData()),N[t]=N[t]||j(t),N[t](e)):e.localeData().invalidDate()}function W(e,t){var r=5;function n(e){return t.longDateFormat(e)||e}for(O.lastIndex=0;r>=0&&O.test(e);)e=e.replace(O,n),O.lastIndex=0,r-=1;return e}var q={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function V(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(B).map((function(e){return"MMMM"===e||"MM"===e||"DD"===e||"dddd"===e?e.slice(1):e})).join(""),this._longDateFormat[e])}var K="Invalid date";function Y(){return this._invalidDate}var G="%d",Q=/\d{1,2}/;function X(e){return this._ordinal.replace("%d",e)}var J={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function $(e,t,r,n){var i=this._relativeTime[r];return R(i)?i(e,t,r,n):i.replace(/%d/i,e)}function ee(e,t){var r=this._relativeTime[e>0?"future":"past"];return R(r)?r(t):r.replace(/%s/i,t)}var te={};function re(e,t){var r=e.toLowerCase();te[r]=te[r+"s"]=te[t]=e}function ne(e){return"string"===typeof e?te[e]||te[e.toLowerCase()]:void 0}function ie(e){var t,r,n={};for(r in e)o(e,r)&&(t=ne(r))&&(n[t]=e[r]);return n}var ae={};function se(e,t){ae[e]=t}function oe(e){var t,r=[];for(t in e)o(e,t)&&r.push({unit:t,priority:ae[t]});return r.sort((function(e,t){return e.priority-t.priority})),r}function ue(e){return e%4===0&&e%100!==0||e%400===0}function ce(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function le(e){var t=+e,r=0;return 0!==t&&isFinite(t)&&(r=ce(t)),r}function he(e,t){return function(r){return null!=r?(de(this,e,r),n.updateOffset(this,t),this):fe(this,e)}}function fe(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function de(e,t,r){e.isValid()&&!isNaN(r)&&("FullYear"===t&&ue(e.year())&&1===e.month()&&29===e.date()?(r=le(r),e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),$e(r,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](r))}function pe(e){return R(this[e=ne(e)])?this[e]():this}function ve(e,t){if("object"===typeof e){var r,n=oe(e=ie(e)),i=n.length;for(r=0;r<i;r++)this[n[r].unit](e[n[r].unit])}else if(R(this[e=ne(e)]))return this[e](t);return this}var ge,ye=/\d/,me=/\d\d/,be=/\d{3}/,_e=/\d{4}/,we=/[+-]?\d{6}/,ke=/\d\d?/,xe=/\d\d\d\d?/,Ee=/\d\d\d\d\d\d?/,Se=/\d{1,3}/,Ce=/\d{1,4}/,Ae=/[+-]?\d{1,6}/,De=/\d+/,Re=/[+-]?\d+/,Te=/Z|[+-]\d\d:?\d\d/gi,Ze=/Z|[+-]\d\d(?::?\d\d)?/gi,Ie=/[+-]?\d+(\.\d{1,3})?/,Pe=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;function Le(e,t,r){ge[e]=R(t)?t:function(e,n){return e&&r?r:t}}function Me(e,t){return o(ge,e)?ge[e](t._strict,t._locale):new RegExp(Be(e))}function Be(e){return Oe(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(e,t,r,n,i){return t||r||n||i})))}function Oe(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}ge={};var Ne={};function Fe(e,t){var r,n,i=t;for("string"===typeof e&&(e=[e]),l(t)&&(i=function(e,r){r[t]=le(e)}),n=e.length,r=0;r<n;r++)Ne[e[r]]=i}function Ue(e,t){Fe(e,(function(e,r,n,i){n._w=n._w||{},t(e,n._w,n,i)}))}function ze(e,t,r){null!=t&&o(Ne,e)&&Ne[e](t,r._a,r,e)}var je,He=0,We=1,qe=2,Ve=3,Ke=4,Ye=5,Ge=6,Qe=7,Xe=8;function Je(e,t){return(e%t+t)%t}function $e(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=Je(t,12);return e+=(t-r)/12,1===r?ue(e)?29:28:31-r%7%2}je=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},U("M",["MM",2],"Mo",(function(){return this.month()+1})),U("MMM",0,0,(function(e){return this.localeData().monthsShort(this,e)})),U("MMMM",0,0,(function(e){return this.localeData().months(this,e)})),re("month","M"),se("month",8),Le("M",ke),Le("MM",ke,me),Le("MMM",(function(e,t){return t.monthsShortRegex(e)})),Le("MMMM",(function(e,t){return t.monthsRegex(e)})),Fe(["M","MM"],(function(e,t){t[We]=le(e)-1})),Fe(["MMM","MMMM"],(function(e,t,r,n){var i=r._locale.monthsParse(e,n,r._strict);null!=i?t[We]=i:g(r).invalidMonth=e}));var et="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),tt="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),rt=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,nt=Pe,it=Pe;function at(e,t){return e?a(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||rt).test(t)?"format":"standalone"][e.month()]:a(this._months)?this._months:this._months.standalone}function st(e,t){return e?a(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[rt.test(t)?"format":"standalone"][e.month()]:a(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function ot(e,t,r){var n,i,a,s=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)a=p([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(a,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(a,"").toLocaleLowerCase();return r?"MMM"===t?-1!==(i=je.call(this._shortMonthsParse,s))?i:null:-1!==(i=je.call(this._longMonthsParse,s))?i:null:"MMM"===t?-1!==(i=je.call(this._shortMonthsParse,s))||-1!==(i=je.call(this._longMonthsParse,s))?i:null:-1!==(i=je.call(this._longMonthsParse,s))||-1!==(i=je.call(this._shortMonthsParse,s))?i:null}function ut(e,t,r){var n,i,a;if(this._monthsParseExact)return ot.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=p([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),r||this._monthsParse[n]||(a="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(a.replace(".",""),"i")),r&&"MMMM"===t&&this._longMonthsParse[n].test(e))return n;if(r&&"MMM"===t&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function ct(e,t){var r;if(!e.isValid())return e;if("string"===typeof t)if(/^\d+$/.test(t))t=le(t);else if(!l(t=e.localeData().monthsParse(t)))return e;return r=Math.min(e.date(),$e(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r),e}function lt(e){return null!=e?(ct(this,e),n.updateOffset(this,!0),this):fe(this,"Month")}function ht(){return $e(this.year(),this.month())}function ft(e){return this._monthsParseExact?(o(this,"_monthsRegex")||pt.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(o(this,"_monthsShortRegex")||(this._monthsShortRegex=nt),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function dt(e){return this._monthsParseExact?(o(this,"_monthsRegex")||pt.call(this),e?this._monthsStrictRegex:this._monthsRegex):(o(this,"_monthsRegex")||(this._monthsRegex=it),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function pt(){function e(e,t){return t.length-e.length}var t,r,n=[],i=[],a=[];for(t=0;t<12;t++)r=p([2e3,t]),n.push(this.monthsShort(r,"")),i.push(this.months(r,"")),a.push(this.months(r,"")),a.push(this.monthsShort(r,""));for(n.sort(e),i.sort(e),a.sort(e),t=0;t<12;t++)n[t]=Oe(n[t]),i[t]=Oe(i[t]);for(t=0;t<24;t++)a[t]=Oe(a[t]);this._monthsRegex=new RegExp("^("+a.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+n.join("|")+")","i")}function vt(e){return ue(e)?366:365}U("Y",0,0,(function(){var e=this.year();return e<=9999?M(e,4):"+"+e})),U(0,["YY",2],0,(function(){return this.year()%100})),U(0,["YYYY",4],0,"year"),U(0,["YYYYY",5],0,"year"),U(0,["YYYYYY",6,!0],0,"year"),re("year","y"),se("year",1),Le("Y",Re),Le("YY",ke,me),Le("YYYY",Ce,_e),Le("YYYYY",Ae,we),Le("YYYYYY",Ae,we),Fe(["YYYYY","YYYYYY"],He),Fe("YYYY",(function(e,t){t[He]=2===e.length?n.parseTwoDigitYear(e):le(e)})),Fe("YY",(function(e,t){t[He]=n.parseTwoDigitYear(e)})),Fe("Y",(function(e,t){t[He]=parseInt(e,10)})),n.parseTwoDigitYear=function(e){return le(e)+(le(e)>68?1900:2e3)};var gt=he("FullYear",!0);function yt(){return ue(this.year())}function mt(e,t,r,n,i,a,s){var o;return e<100&&e>=0?(o=new Date(e+400,t,r,n,i,a,s),isFinite(o.getFullYear())&&o.setFullYear(e)):o=new Date(e,t,r,n,i,a,s),o}function bt(e){var t,r;return e<100&&e>=0?((r=Array.prototype.slice.call(arguments))[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function _t(e,t,r){var n=7+t-r;return-(7+bt(e,0,n).getUTCDay()-t)%7+n-1}function wt(e,t,r,n,i){var a,s,o=1+7*(t-1)+(7+r-n)%7+_t(e,n,i);return o<=0?s=vt(a=e-1)+o:o>vt(e)?(a=e+1,s=o-vt(e)):(a=e,s=o),{year:a,dayOfYear:s}}function kt(e,t,r){var n,i,a=_t(e.year(),t,r),s=Math.floor((e.dayOfYear()-a-1)/7)+1;return s<1?n=s+xt(i=e.year()-1,t,r):s>xt(e.year(),t,r)?(n=s-xt(e.year(),t,r),i=e.year()+1):(i=e.year(),n=s),{week:n,year:i}}function xt(e,t,r){var n=_t(e,t,r),i=_t(e+1,t,r);return(vt(e)-n+i)/7}function Et(e){return kt(e,this._week.dow,this._week.doy).week}U("w",["ww",2],"wo","week"),U("W",["WW",2],"Wo","isoWeek"),re("week","w"),re("isoWeek","W"),se("week",5),se("isoWeek",5),Le("w",ke),Le("ww",ke,me),Le("W",ke),Le("WW",ke,me),Ue(["w","ww","W","WW"],(function(e,t,r,n){t[n.substr(0,1)]=le(e)}));var St={dow:0,doy:6};function Ct(){return this._week.dow}function At(){return this._week.doy}function Dt(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function Rt(e){var t=kt(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function Tt(e,t){return"string"!==typeof e?e:isNaN(e)?"number"===typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}function Zt(e,t){return"string"===typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function It(e,t){return e.slice(t,7).concat(e.slice(0,t))}U("d",0,"do","day"),U("dd",0,0,(function(e){return this.localeData().weekdaysMin(this,e)})),U("ddd",0,0,(function(e){return this.localeData().weekdaysShort(this,e)})),U("dddd",0,0,(function(e){return this.localeData().weekdays(this,e)})),U("e",0,0,"weekday"),U("E",0,0,"isoWeekday"),re("day","d"),re("weekday","e"),re("isoWeekday","E"),se("day",11),se("weekday",11),se("isoWeekday",11),Le("d",ke),Le("e",ke),Le("E",ke),Le("dd",(function(e,t){return t.weekdaysMinRegex(e)})),Le("ddd",(function(e,t){return t.weekdaysShortRegex(e)})),Le("dddd",(function(e,t){return t.weekdaysRegex(e)})),Ue(["dd","ddd","dddd"],(function(e,t,r,n){var i=r._locale.weekdaysParse(e,n,r._strict);null!=i?t.d=i:g(r).invalidWeekday=e})),Ue(["d","e","E"],(function(e,t,r,n){t[n]=le(e)}));var Pt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Lt="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Mt="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Bt=Pe,Ot=Pe,Nt=Pe;function Ft(e,t){var r=a(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?It(r,this._week.dow):e?r[e.day()]:r}function Ut(e){return!0===e?It(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function zt(e){return!0===e?It(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function jt(e,t,r){var n,i,a,s=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)a=p([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(a,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(a,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(a,"").toLocaleLowerCase();return r?"dddd"===t?-1!==(i=je.call(this._weekdaysParse,s))?i:null:"ddd"===t?-1!==(i=je.call(this._shortWeekdaysParse,s))?i:null:-1!==(i=je.call(this._minWeekdaysParse,s))?i:null:"dddd"===t?-1!==(i=je.call(this._weekdaysParse,s))||-1!==(i=je.call(this._shortWeekdaysParse,s))||-1!==(i=je.call(this._minWeekdaysParse,s))?i:null:"ddd"===t?-1!==(i=je.call(this._shortWeekdaysParse,s))||-1!==(i=je.call(this._weekdaysParse,s))||-1!==(i=je.call(this._minWeekdaysParse,s))?i:null:-1!==(i=je.call(this._minWeekdaysParse,s))||-1!==(i=je.call(this._weekdaysParse,s))||-1!==(i=je.call(this._shortWeekdaysParse,s))?i:null}function Ht(e,t,r){var n,i,a;if(this._weekdaysParseExact)return jt.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=p([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(a="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(a.replace(".",""),"i")),r&&"dddd"===t&&this._fullWeekdaysParse[n].test(e))return n;if(r&&"ddd"===t&&this._shortWeekdaysParse[n].test(e))return n;if(r&&"dd"===t&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function Wt(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=Tt(e,this.localeData()),this.add(e-t,"d")):t}function qt(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function Vt(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=Zt(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function Kt(e){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||Qt.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(o(this,"_weekdaysRegex")||(this._weekdaysRegex=Bt),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Yt(e){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||Qt.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(o(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Ot),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Gt(e){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||Qt.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(o(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Nt),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Qt(){function e(e,t){return t.length-e.length}var t,r,n,i,a,s=[],o=[],u=[],c=[];for(t=0;t<7;t++)r=p([2e3,1]).day(t),n=Oe(this.weekdaysMin(r,"")),i=Oe(this.weekdaysShort(r,"")),a=Oe(this.weekdays(r,"")),s.push(n),o.push(i),u.push(a),c.push(n),c.push(i),c.push(a);s.sort(e),o.sort(e),u.sort(e),c.sort(e),this._weekdaysRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+s.join("|")+")","i")}function Xt(){return this.hours()%12||12}function Jt(){return this.hours()||24}function $t(e,t){U(e,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)}))}function er(e,t){return t._meridiemParse}function tr(e){return"p"===(e+"").toLowerCase().charAt(0)}U("H",["HH",2],0,"hour"),U("h",["hh",2],0,Xt),U("k",["kk",2],0,Jt),U("hmm",0,0,(function(){return""+Xt.apply(this)+M(this.minutes(),2)})),U("hmmss",0,0,(function(){return""+Xt.apply(this)+M(this.minutes(),2)+M(this.seconds(),2)})),U("Hmm",0,0,(function(){return""+this.hours()+M(this.minutes(),2)})),U("Hmmss",0,0,(function(){return""+this.hours()+M(this.minutes(),2)+M(this.seconds(),2)})),$t("a",!0),$t("A",!1),re("hour","h"),se("hour",13),Le("a",er),Le("A",er),Le("H",ke),Le("h",ke),Le("k",ke),Le("HH",ke,me),Le("hh",ke,me),Le("kk",ke,me),Le("hmm",xe),Le("hmmss",Ee),Le("Hmm",xe),Le("Hmmss",Ee),Fe(["H","HH"],Ve),Fe(["k","kk"],(function(e,t,r){var n=le(e);t[Ve]=24===n?0:n})),Fe(["a","A"],(function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e})),Fe(["h","hh"],(function(e,t,r){t[Ve]=le(e),g(r).bigHour=!0})),Fe("hmm",(function(e,t,r){var n=e.length-2;t[Ve]=le(e.substr(0,n)),t[Ke]=le(e.substr(n)),g(r).bigHour=!0})),Fe("hmmss",(function(e,t,r){var n=e.length-4,i=e.length-2;t[Ve]=le(e.substr(0,n)),t[Ke]=le(e.substr(n,2)),t[Ye]=le(e.substr(i)),g(r).bigHour=!0})),Fe("Hmm",(function(e,t,r){var n=e.length-2;t[Ve]=le(e.substr(0,n)),t[Ke]=le(e.substr(n))})),Fe("Hmmss",(function(e,t,r){var n=e.length-4,i=e.length-2;t[Ve]=le(e.substr(0,n)),t[Ke]=le(e.substr(n,2)),t[Ye]=le(e.substr(i))}));var rr=/[ap]\.?m?\.?/i,nr=he("Hours",!0);function ir(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var ar,sr={calendar:P,longDateFormat:q,invalidDate:K,ordinal:G,dayOfMonthOrdinalParse:Q,relativeTime:J,months:et,monthsShort:tt,week:St,weekdays:Pt,weekdaysMin:Mt,weekdaysShort:Lt,meridiemParse:rr},or={},ur={};function cr(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function lr(e){return e?e.toLowerCase().replace("_","-"):e}function hr(e){for(var t,r,n,i,a=0;a<e.length;){for(t=(i=lr(e[a]).split("-")).length,r=(r=lr(e[a+1]))?r.split("-"):null;t>0;){if(n=dr(i.slice(0,t).join("-")))return n;if(r&&r.length>=t&&cr(i,r)>=t-1)break;t--}a++}return ar}function fr(e){return null!=e.match("^[^/\\\\]*$")}function dr(t){var r=null;if(void 0===or[t]&&e&&e.exports&&fr(t))try{r=ar._abbr,Object(function(){var e=new Error("Cannot find module 'undefined'");throw e.code="MODULE_NOT_FOUND",e}()),pr(r)}catch(n){or[t]=null}return or[t]}function pr(e,t){var r;return e&&((r=c(t)?yr(e):vr(e,t))?ar=r:"undefined"!==typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),ar._abbr}function vr(e,t){if(null!==t){var r,n=sr;if(t.abbr=e,null!=or[e])D("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=or[e]._config;else if(null!=t.parentLocale)if(null!=or[t.parentLocale])n=or[t.parentLocale]._config;else{if(null==(r=dr(t.parentLocale)))return ur[t.parentLocale]||(ur[t.parentLocale]=[]),ur[t.parentLocale].push({name:e,config:t}),null;n=r._config}return or[e]=new I(Z(n,t)),ur[e]&&ur[e].forEach((function(e){vr(e.name,e.config)})),pr(e),or[e]}return delete or[e],null}function gr(e,t){if(null!=t){var r,n,i=sr;null!=or[e]&&null!=or[e].parentLocale?or[e].set(Z(or[e]._config,t)):(null!=(n=dr(e))&&(i=n._config),t=Z(i,t),null==n&&(t.abbr=e),(r=new I(t)).parentLocale=or[e],or[e]=r),pr(e)}else null!=or[e]&&(null!=or[e].parentLocale?(or[e]=or[e].parentLocale,e===pr()&&pr(e)):null!=or[e]&&delete or[e]);return or[e]}function yr(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return ar;if(!a(e)){if(t=dr(e))return t;e=[e]}return hr(e)}function mr(){return C(or)}function br(e){var t,r=e._a;return r&&-2===g(e).overflow&&(t=r[We]<0||r[We]>11?We:r[qe]<1||r[qe]>$e(r[He],r[We])?qe:r[Ve]<0||r[Ve]>24||24===r[Ve]&&(0!==r[Ke]||0!==r[Ye]||0!==r[Ge])?Ve:r[Ke]<0||r[Ke]>59?Ke:r[Ye]<0||r[Ye]>59?Ye:r[Ge]<0||r[Ge]>999?Ge:-1,g(e)._overflowDayOfYear&&(t<He||t>qe)&&(t=qe),g(e)._overflowWeeks&&-1===t&&(t=Qe),g(e)._overflowWeekday&&-1===t&&(t=Xe),g(e).overflow=t),e}var _r=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,wr=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,kr=/Z|[+-]\d\d(?::?\d\d)?/,xr=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Er=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Sr=/^\/?Date\((-?\d+)/i,Cr=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Ar={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Dr(e){var t,r,n,i,a,s,o=e._i,u=_r.exec(o)||wr.exec(o),c=xr.length,l=Er.length;if(u){for(g(e).iso=!0,t=0,r=c;t<r;t++)if(xr[t][1].exec(u[1])){i=xr[t][0],n=!1!==xr[t][2];break}if(null==i)return void(e._isValid=!1);if(u[3]){for(t=0,r=l;t<r;t++)if(Er[t][1].exec(u[3])){a=(u[2]||" ")+Er[t][0];break}if(null==a)return void(e._isValid=!1)}if(!n&&null!=a)return void(e._isValid=!1);if(u[4]){if(!kr.exec(u[4]))return void(e._isValid=!1);s="Z"}e._f=i+(a||"")+(s||""),Ur(e)}else e._isValid=!1}function Rr(e,t,r,n,i,a){var s=[Tr(e),tt.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return a&&s.push(parseInt(a,10)),s}function Tr(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function Zr(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Ir(e,t,r){return!e||Lt.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(g(r).weekdayMismatch=!0,r._isValid=!1,!1)}function Pr(e,t,r){if(e)return Ar[e];if(t)return 0;var n=parseInt(r,10),i=n%100;return(n-i)/100*60+i}function Lr(e){var t,r=Cr.exec(Zr(e._i));if(r){if(t=Rr(r[4],r[3],r[2],r[5],r[6],r[7]),!Ir(r[1],t,e))return;e._a=t,e._tzm=Pr(r[8],r[9],r[10]),e._d=bt.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),g(e).rfc2822=!0}else e._isValid=!1}function Mr(e){var t=Sr.exec(e._i);null===t?(Dr(e),!1===e._isValid&&(delete e._isValid,Lr(e),!1===e._isValid&&(delete e._isValid,e._strict?e._isValid=!1:n.createFromInputFallback(e)))):e._d=new Date(+t[1])}function Br(e,t,r){return null!=e?e:null!=t?t:r}function Or(e){var t=new Date(n.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function Nr(e){var t,r,n,i,a,s=[];if(!e._d){for(n=Or(e),e._w&&null==e._a[qe]&&null==e._a[We]&&Fr(e),null!=e._dayOfYear&&(a=Br(e._a[He],n[He]),(e._dayOfYear>vt(a)||0===e._dayOfYear)&&(g(e)._overflowDayOfYear=!0),r=bt(a,0,e._dayOfYear),e._a[We]=r.getUTCMonth(),e._a[qe]=r.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=s[t]=n[t];for(;t<7;t++)e._a[t]=s[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[Ve]&&0===e._a[Ke]&&0===e._a[Ye]&&0===e._a[Ge]&&(e._nextDay=!0,e._a[Ve]=0),e._d=(e._useUTC?bt:mt).apply(null,s),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Ve]=24),e._w&&"undefined"!==typeof e._w.d&&e._w.d!==i&&(g(e).weekdayMismatch=!0)}}function Fr(e){var t,r,n,i,a,s,o,u,c;null!=(t=e._w).GG||null!=t.W||null!=t.E?(a=1,s=4,r=Br(t.GG,e._a[He],kt(Yr(),1,4).year),n=Br(t.W,1),((i=Br(t.E,1))<1||i>7)&&(u=!0)):(a=e._locale._week.dow,s=e._locale._week.doy,c=kt(Yr(),a,s),r=Br(t.gg,e._a[He],c.year),n=Br(t.w,c.week),null!=t.d?((i=t.d)<0||i>6)&&(u=!0):null!=t.e?(i=t.e+a,(t.e<0||t.e>6)&&(u=!0)):i=a),n<1||n>xt(r,a,s)?g(e)._overflowWeeks=!0:null!=u?g(e)._overflowWeekday=!0:(o=wt(r,n,i,a,s),e._a[He]=o.year,e._dayOfYear=o.dayOfYear)}function Ur(e){if(e._f!==n.ISO_8601)if(e._f!==n.RFC_2822){e._a=[],g(e).empty=!0;var t,r,i,a,s,o,u,c=""+e._i,l=c.length,h=0;for(u=(i=W(e._f,e._locale).match(B)||[]).length,t=0;t<u;t++)a=i[t],(r=(c.match(Me(a,e))||[])[0])&&((s=c.substr(0,c.indexOf(r))).length>0&&g(e).unusedInput.push(s),c=c.slice(c.indexOf(r)+r.length),h+=r.length),F[a]?(r?g(e).empty=!1:g(e).unusedTokens.push(a),ze(a,r,e)):e._strict&&!r&&g(e).unusedTokens.push(a);g(e).charsLeftOver=l-h,c.length>0&&g(e).unusedInput.push(c),e._a[Ve]<=12&&!0===g(e).bigHour&&e._a[Ve]>0&&(g(e).bigHour=void 0),g(e).parsedDateParts=e._a.slice(0),g(e).meridiem=e._meridiem,e._a[Ve]=zr(e._locale,e._a[Ve],e._meridiem),null!==(o=g(e).era)&&(e._a[He]=e._locale.erasConvertYear(o,e._a[He])),Nr(e),br(e)}else Lr(e);else Dr(e)}function zr(e,t,r){var n;return null==r?t:null!=e.meridiemHour?e.meridiemHour(t,r):null!=e.isPM?((n=e.isPM(r))&&t<12&&(t+=12),n||12!==t||(t=0),t):t}function jr(e){var t,r,n,i,a,s,o=!1,u=e._f.length;if(0===u)return g(e).invalidFormat=!0,void(e._d=new Date(NaN));for(i=0;i<u;i++)a=0,s=!1,t=w({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],Ur(t),y(t)&&(s=!0),a+=g(t).charsLeftOver,a+=10*g(t).unusedTokens.length,g(t).score=a,o?a<n&&(n=a,r=t):(null==n||a<n||s)&&(n=a,r=t,s&&(o=!0));d(e,r||t)}function Hr(e){if(!e._d){var t=ie(e._i),r=void 0===t.day?t.date:t.day;e._a=f([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],(function(e){return e&&parseInt(e,10)})),Nr(e)}}function Wr(e){var t=new k(br(qr(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function qr(e){var t=e._i,r=e._f;return e._locale=e._locale||yr(e._l),null===t||void 0===r&&""===t?m({nullInput:!0}):("string"===typeof t&&(e._i=t=e._locale.preparse(t)),x(t)?new k(br(t)):(h(t)?e._d=t:a(r)?jr(e):r?Ur(e):Vr(e),y(e)||(e._d=null),e))}function Vr(e){var t=e._i;c(t)?e._d=new Date(n.now()):h(t)?e._d=new Date(t.valueOf()):"string"===typeof t?Mr(e):a(t)?(e._a=f(t.slice(0),(function(e){return parseInt(e,10)})),Nr(e)):s(t)?Hr(e):l(t)?e._d=new Date(t):n.createFromInputFallback(e)}function Kr(e,t,r,n,i){var o={};return!0!==t&&!1!==t||(n=t,t=void 0),!0!==r&&!1!==r||(n=r,r=void 0),(s(e)&&u(e)||a(e)&&0===e.length)&&(e=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=r,o._i=e,o._f=t,o._strict=n,Wr(o)}function Yr(e,t,r,n){return Kr(e,t,r,n,!1)}n.createFromInputFallback=S("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))})),n.ISO_8601=function(){},n.RFC_2822=function(){};var Gr=S("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Yr.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:m()})),Qr=S("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Yr.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:m()}));function Xr(e,t){var r,n;if(1===t.length&&a(t[0])&&(t=t[0]),!t.length)return Yr();for(r=t[0],n=1;n<t.length;++n)t[n].isValid()&&!t[n][e](r)||(r=t[n]);return r}function Jr(){return Xr("isBefore",[].slice.call(arguments,0))}function $r(){return Xr("isAfter",[].slice.call(arguments,0))}var en=function(){return Date.now?Date.now():+new Date},tn=["year","quarter","month","week","day","hour","minute","second","millisecond"];function rn(e){var t,r,n=!1,i=tn.length;for(t in e)if(o(e,t)&&(-1===je.call(tn,t)||null!=e[t]&&isNaN(e[t])))return!1;for(r=0;r<i;++r)if(e[tn[r]]){if(n)return!1;parseFloat(e[tn[r]])!==le(e[tn[r]])&&(n=!0)}return!0}function nn(){return this._isValid}function an(){return Dn(NaN)}function sn(e){var t=ie(e),r=t.year||0,n=t.quarter||0,i=t.month||0,a=t.week||t.isoWeek||0,s=t.day||0,o=t.hour||0,u=t.minute||0,c=t.second||0,l=t.millisecond||0;this._isValid=rn(t),this._milliseconds=+l+1e3*c+6e4*u+1e3*o*60*60,this._days=+s+7*a,this._months=+i+3*n+12*r,this._data={},this._locale=yr(),this._bubble()}function on(e){return e instanceof sn}function un(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function cn(e,t,r){var n,i=Math.min(e.length,t.length),a=Math.abs(e.length-t.length),s=0;for(n=0;n<i;n++)(r&&e[n]!==t[n]||!r&&le(e[n])!==le(t[n]))&&s++;return s+a}function ln(e,t){U(e,0,0,(function(){var e=this.utcOffset(),r="+";return e<0&&(e=-e,r="-"),r+M(~~(e/60),2)+t+M(~~e%60,2)}))}ln("Z",":"),ln("ZZ",""),Le("Z",Ze),Le("ZZ",Ze),Fe(["Z","ZZ"],(function(e,t,r){r._useUTC=!0,r._tzm=fn(Ze,e)}));var hn=/([\+\-]|\d\d)/gi;function fn(e,t){var r,n,i=(t||"").match(e);return null===i?null:0===(n=60*(r=((i[i.length-1]||[])+"").match(hn)||["-",0,0])[1]+le(r[2]))?0:"+"===r[0]?n:-n}function dn(e,t){var r,i;return t._isUTC?(r=t.clone(),i=(x(e)||h(e)?e.valueOf():Yr(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+i),n.updateOffset(r,!1),r):Yr(e).local()}function pn(e){return-Math.round(e._d.getTimezoneOffset())}function vn(e,t,r){var i,a=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"===typeof e){if(null===(e=fn(Ze,e)))return this}else Math.abs(e)<16&&!r&&(e*=60);return!this._isUTC&&t&&(i=pn(this)),this._offset=e,this._isUTC=!0,null!=i&&this.add(i,"m"),a!==e&&(!t||this._changeInProgress?Pn(this,Dn(e-a,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,n.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?a:pn(this)}function gn(e,t){return null!=e?("string"!==typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function yn(e){return this.utcOffset(0,e)}function mn(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(pn(this),"m")),this}function bn(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"===typeof this._i){var e=fn(Te,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this}function _n(e){return!!this.isValid()&&(e=e?Yr(e).utcOffset():0,(this.utcOffset()-e)%60===0)}function wn(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function kn(){if(!c(this._isDSTShifted))return this._isDSTShifted;var e,t={};return w(t,this),(t=qr(t))._a?(e=t._isUTC?p(t._a):Yr(t._a),this._isDSTShifted=this.isValid()&&cn(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function xn(){return!!this.isValid()&&!this._isUTC}function En(){return!!this.isValid()&&this._isUTC}function Sn(){return!!this.isValid()&&this._isUTC&&0===this._offset}n.updateOffset=function(){};var Cn=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,An=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Dn(e,t){var r,n,i,a=e,s=null;return on(e)?a={ms:e._milliseconds,d:e._days,M:e._months}:l(e)||!isNaN(+e)?(a={},t?a[t]=+e:a.milliseconds=+e):(s=Cn.exec(e))?(r="-"===s[1]?-1:1,a={y:0,d:le(s[qe])*r,h:le(s[Ve])*r,m:le(s[Ke])*r,s:le(s[Ye])*r,ms:le(un(1e3*s[Ge]))*r}):(s=An.exec(e))?(r="-"===s[1]?-1:1,a={y:Rn(s[2],r),M:Rn(s[3],r),w:Rn(s[4],r),d:Rn(s[5],r),h:Rn(s[6],r),m:Rn(s[7],r),s:Rn(s[8],r)}):null==a?a={}:"object"===typeof a&&("from"in a||"to"in a)&&(i=Zn(Yr(a.from),Yr(a.to)),(a={}).ms=i.milliseconds,a.M=i.months),n=new sn(a),on(e)&&o(e,"_locale")&&(n._locale=e._locale),on(e)&&o(e,"_isValid")&&(n._isValid=e._isValid),n}function Rn(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function Tn(e,t){var r={};return r.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function Zn(e,t){var r;return e.isValid()&&t.isValid()?(t=dn(t,e),e.isBefore(t)?r=Tn(e,t):((r=Tn(t,e)).milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function In(e,t){return function(r,n){var i;return null===n||isNaN(+n)||(D(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=r,r=n,n=i),Pn(this,Dn(r,n),e),this}}function Pn(e,t,r,i){var a=t._milliseconds,s=un(t._days),o=un(t._months);e.isValid()&&(i=null==i||i,o&&ct(e,fe(e,"Month")+o*r),s&&de(e,"Date",fe(e,"Date")+s*r),a&&e._d.setTime(e._d.valueOf()+a*r),i&&n.updateOffset(e,s||o))}Dn.fn=sn.prototype,Dn.invalid=an;var Ln=In(1,"add"),Mn=In(-1,"subtract");function Bn(e){return"string"===typeof e||e instanceof String}function On(e){return x(e)||h(e)||Bn(e)||l(e)||Fn(e)||Nn(e)||null===e||void 0===e}function Nn(e){var t,r,n=s(e)&&!u(e),i=!1,a=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],c=a.length;for(t=0;t<c;t+=1)r=a[t],i=i||o(e,r);return n&&i}function Fn(e){var t=a(e),r=!1;return t&&(r=0===e.filter((function(t){return!l(t)&&Bn(e)})).length),t&&r}function Un(e){var t,r,n=s(e)&&!u(e),i=!1,a=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(t=0;t<a.length;t+=1)r=a[t],i=i||o(e,r);return n&&i}function zn(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function jn(e,t){1===arguments.length&&(arguments[0]?On(arguments[0])?(e=arguments[0],t=void 0):Un(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||Yr(),i=dn(r,this).startOf("day"),a=n.calendarFormat(this,i)||"sameElse",s=t&&(R(t[a])?t[a].call(this,r):t[a]);return this.format(s||this.localeData().calendar(a,this,Yr(r)))}function Hn(){return new k(this)}function Wn(e,t){var r=x(e)?e:Yr(e);return!(!this.isValid()||!r.isValid())&&("millisecond"===(t=ne(t)||"millisecond")?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf())}function qn(e,t){var r=x(e)?e:Yr(e);return!(!this.isValid()||!r.isValid())&&("millisecond"===(t=ne(t)||"millisecond")?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf())}function Vn(e,t,r,n){var i=x(e)?e:Yr(e),a=x(t)?t:Yr(t);return!!(this.isValid()&&i.isValid()&&a.isValid())&&("("===(n=n||"()")[0]?this.isAfter(i,r):!this.isBefore(i,r))&&(")"===n[1]?this.isBefore(a,r):!this.isAfter(a,r))}function Kn(e,t){var r,n=x(e)?e:Yr(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=ne(t)||"millisecond")?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(t).valueOf()<=r&&r<=this.clone().endOf(t).valueOf()))}function Yn(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function Gn(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function Qn(e,t,r){var n,i,a;if(!this.isValid())return NaN;if(!(n=dn(e,this)).isValid())return NaN;switch(i=6e4*(n.utcOffset()-this.utcOffset()),t=ne(t)){case"year":a=Xn(this,n)/12;break;case"month":a=Xn(this,n);break;case"quarter":a=Xn(this,n)/3;break;case"second":a=(this-n)/1e3;break;case"minute":a=(this-n)/6e4;break;case"hour":a=(this-n)/36e5;break;case"day":a=(this-n-i)/864e5;break;case"week":a=(this-n-i)/6048e5;break;default:a=this-n}return r?a:ce(a)}function Xn(e,t){if(e.date()<t.date())return-Xn(t,e);var r=12*(t.year()-e.year())+(t.month()-e.month()),n=e.clone().add(r,"months");return-(r+(t-n<0?(t-n)/(n-e.clone().add(r-1,"months")):(t-n)/(e.clone().add(r+1,"months")-n)))||0}function Jn(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function $n(e){if(!this.isValid())return null;var t=!0!==e,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?H(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):R(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",H(r,"Z")):H(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function ei(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e,t,r,n,i="moment",a="";return this.isLocal()||(i=0===this.utcOffset()?"moment.utc":"moment.parseZone",a="Z"),e="["+i+'("]',t=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r="-MM-DD[T]HH:mm:ss.SSS",n=a+'[")]',this.format(e+t+r+n)}function ti(e){e||(e=this.isUtc()?n.defaultFormatUtc:n.defaultFormat);var t=H(this,e);return this.localeData().postformat(t)}function ri(e,t){return this.isValid()&&(x(e)&&e.isValid()||Yr(e).isValid())?Dn({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function ni(e){return this.from(Yr(),e)}function ii(e,t){return this.isValid()&&(x(e)&&e.isValid()||Yr(e).isValid())?Dn({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function ai(e){return this.to(Yr(),e)}function si(e){var t;return void 0===e?this._locale._abbr:(null!=(t=yr(e))&&(this._locale=t),this)}n.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",n.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var oi=S("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(e){return void 0===e?this.localeData():this.locale(e)}));function ui(){return this._locale}var ci=1e3,li=60*ci,hi=60*li,fi=3506328*hi;function di(e,t){return(e%t+t)%t}function pi(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-fi:new Date(e,t,r).valueOf()}function vi(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-fi:Date.UTC(e,t,r)}function gi(e){var t,r;if(void 0===(e=ne(e))||"millisecond"===e||!this.isValid())return this;switch(r=this._isUTC?vi:pi,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=di(t+(this._isUTC?0:this.utcOffset()*li),hi);break;case"minute":t=this._d.valueOf(),t-=di(t,li);break;case"second":t=this._d.valueOf(),t-=di(t,ci)}return this._d.setTime(t),n.updateOffset(this,!0),this}function yi(e){var t,r;if(void 0===(e=ne(e))||"millisecond"===e||!this.isValid())return this;switch(r=this._isUTC?vi:pi,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=hi-di(t+(this._isUTC?0:this.utcOffset()*li),hi)-1;break;case"minute":t=this._d.valueOf(),t+=li-di(t,li)-1;break;case"second":t=this._d.valueOf(),t+=ci-di(t,ci)-1}return this._d.setTime(t),n.updateOffset(this,!0),this}function mi(){return this._d.valueOf()-6e4*(this._offset||0)}function bi(){return Math.floor(this.valueOf()/1e3)}function _i(){return new Date(this.valueOf())}function wi(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function ki(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function xi(){return this.isValid()?this.toISOString():null}function Ei(){return y(this)}function Si(){return d({},g(this))}function Ci(){return g(this).overflow}function Ai(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Di(e,t){var r,i,a,s=this._eras||yr("en")._eras;for(r=0,i=s.length;r<i;++r)switch("string"===typeof s[r].since&&(a=n(s[r].since).startOf("day"),s[r].since=a.valueOf()),typeof s[r].until){case"undefined":s[r].until=1/0;break;case"string":a=n(s[r].until).startOf("day").valueOf(),s[r].until=a.valueOf()}return s}function Ri(e,t,r){var n,i,a,s,o,u=this.eras();for(e=e.toUpperCase(),n=0,i=u.length;n<i;++n)if(a=u[n].name.toUpperCase(),s=u[n].abbr.toUpperCase(),o=u[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(s===e)return u[n];break;case"NNNN":if(a===e)return u[n];break;case"NNNNN":if(o===e)return u[n]}else if([a,s,o].indexOf(e)>=0)return u[n]}function Ti(e,t){var r=e.since<=e.until?1:-1;return void 0===t?n(e.since).year():n(e.since).year()+(t-e.offset)*r}function Zi(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e){if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until)return n[e].name;if(n[e].until<=r&&r<=n[e].since)return n[e].name}return""}function Ii(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e){if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until)return n[e].narrow;if(n[e].until<=r&&r<=n[e].since)return n[e].narrow}return""}function Pi(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e){if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until)return n[e].abbr;if(n[e].until<=r&&r<=n[e].since)return n[e].abbr}return""}function Li(){var e,t,r,i,a=this.localeData().eras();for(e=0,t=a.length;e<t;++e)if(r=a[e].since<=a[e].until?1:-1,i=this.clone().startOf("day").valueOf(),a[e].since<=i&&i<=a[e].until||a[e].until<=i&&i<=a[e].since)return(this.year()-n(a[e].since).year())*r+a[e].offset;return this.year()}function Mi(e){return o(this,"_erasNameRegex")||ji.call(this),e?this._erasNameRegex:this._erasRegex}function Bi(e){return o(this,"_erasAbbrRegex")||ji.call(this),e?this._erasAbbrRegex:this._erasRegex}function Oi(e){return o(this,"_erasNarrowRegex")||ji.call(this),e?this._erasNarrowRegex:this._erasRegex}function Ni(e,t){return t.erasAbbrRegex(e)}function Fi(e,t){return t.erasNameRegex(e)}function Ui(e,t){return t.erasNarrowRegex(e)}function zi(e,t){return t._eraYearOrdinalRegex||De}function ji(){var e,t,r=[],n=[],i=[],a=[],s=this.eras();for(e=0,t=s.length;e<t;++e)n.push(Oe(s[e].name)),r.push(Oe(s[e].abbr)),i.push(Oe(s[e].narrow)),a.push(Oe(s[e].name)),a.push(Oe(s[e].abbr)),a.push(Oe(s[e].narrow));this._erasRegex=new RegExp("^("+a.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+n.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+i.join("|")+")","i")}function Hi(e,t){U(0,[e,e.length],0,t)}function Wi(e){return Qi.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function qi(e){return Qi.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Vi(){return xt(this.year(),1,4)}function Ki(){return xt(this.isoWeekYear(),1,4)}function Yi(){var e=this.localeData()._week;return xt(this.year(),e.dow,e.doy)}function Gi(){var e=this.localeData()._week;return xt(this.weekYear(),e.dow,e.doy)}function Qi(e,t,r,n,i){var a;return null==e?kt(this,n,i).year:(t>(a=xt(e,n,i))&&(t=a),Xi.call(this,e,t,r,n,i))}function Xi(e,t,r,n,i){var a=wt(e,t,r,n,i),s=bt(a.year,0,a.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}function Ji(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}U("N",0,0,"eraAbbr"),U("NN",0,0,"eraAbbr"),U("NNN",0,0,"eraAbbr"),U("NNNN",0,0,"eraName"),U("NNNNN",0,0,"eraNarrow"),U("y",["y",1],"yo","eraYear"),U("y",["yy",2],0,"eraYear"),U("y",["yyy",3],0,"eraYear"),U("y",["yyyy",4],0,"eraYear"),Le("N",Ni),Le("NN",Ni),Le("NNN",Ni),Le("NNNN",Fi),Le("NNNNN",Ui),Fe(["N","NN","NNN","NNNN","NNNNN"],(function(e,t,r,n){var i=r._locale.erasParse(e,n,r._strict);i?g(r).era=i:g(r).invalidEra=e})),Le("y",De),Le("yy",De),Le("yyy",De),Le("yyyy",De),Le("yo",zi),Fe(["y","yy","yyy","yyyy"],He),Fe(["yo"],(function(e,t,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[He]=r._locale.eraYearOrdinalParse(e,i):t[He]=parseInt(e,10)})),U(0,["gg",2],0,(function(){return this.weekYear()%100})),U(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),Hi("gggg","weekYear"),Hi("ggggg","weekYear"),Hi("GGGG","isoWeekYear"),Hi("GGGGG","isoWeekYear"),re("weekYear","gg"),re("isoWeekYear","GG"),se("weekYear",1),se("isoWeekYear",1),Le("G",Re),Le("g",Re),Le("GG",ke,me),Le("gg",ke,me),Le("GGGG",Ce,_e),Le("gggg",Ce,_e),Le("GGGGG",Ae,we),Le("ggggg",Ae,we),Ue(["gggg","ggggg","GGGG","GGGGG"],(function(e,t,r,n){t[n.substr(0,2)]=le(e)})),Ue(["gg","GG"],(function(e,t,r,i){t[i]=n.parseTwoDigitYear(e)})),U("Q",0,"Qo","quarter"),re("quarter","Q"),se("quarter",7),Le("Q",ye),Fe("Q",(function(e,t){t[We]=3*(le(e)-1)})),U("D",["DD",2],"Do","date"),re("date","D"),se("date",9),Le("D",ke),Le("DD",ke,me),Le("Do",(function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient})),Fe(["D","DD"],qe),Fe("Do",(function(e,t){t[qe]=le(e.match(ke)[0])}));var $i=he("Date",!0);function ea(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}U("DDD",["DDDD",3],"DDDo","dayOfYear"),re("dayOfYear","DDD"),se("dayOfYear",4),Le("DDD",Se),Le("DDDD",be),Fe(["DDD","DDDD"],(function(e,t,r){r._dayOfYear=le(e)})),U("m",["mm",2],0,"minute"),re("minute","m"),se("minute",14),Le("m",ke),Le("mm",ke,me),Fe(["m","mm"],Ke);var ta=he("Minutes",!1);U("s",["ss",2],0,"second"),re("second","s"),se("second",15),Le("s",ke),Le("ss",ke,me),Fe(["s","ss"],Ye);var ra,na,ia=he("Seconds",!1);for(U("S",0,0,(function(){return~~(this.millisecond()/100)})),U(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),U(0,["SSS",3],0,"millisecond"),U(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),U(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),U(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),U(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),U(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),U(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),re("millisecond","ms"),se("millisecond",16),Le("S",Se,ye),Le("SS",Se,me),Le("SSS",Se,be),ra="SSSS";ra.length<=9;ra+="S")Le(ra,De);function aa(e,t){t[Ge]=le(1e3*("0."+e))}for(ra="S";ra.length<=9;ra+="S")Fe(ra,aa);function sa(){return this._isUTC?"UTC":""}function oa(){return this._isUTC?"Coordinated Universal Time":""}na=he("Milliseconds",!1),U("z",0,0,"zoneAbbr"),U("zz",0,0,"zoneName");var ua=k.prototype;function ca(e){return Yr(1e3*e)}function la(){return Yr.apply(null,arguments).parseZone()}function ha(e){return e}ua.add=Ln,ua.calendar=jn,ua.clone=Hn,ua.diff=Qn,ua.endOf=yi,ua.format=ti,ua.from=ri,ua.fromNow=ni,ua.to=ii,ua.toNow=ai,ua.get=pe,ua.invalidAt=Ci,ua.isAfter=Wn,ua.isBefore=qn,ua.isBetween=Vn,ua.isSame=Kn,ua.isSameOrAfter=Yn,ua.isSameOrBefore=Gn,ua.isValid=Ei,ua.lang=oi,ua.locale=si,ua.localeData=ui,ua.max=Qr,ua.min=Gr,ua.parsingFlags=Si,ua.set=ve,ua.startOf=gi,ua.subtract=Mn,ua.toArray=wi,ua.toObject=ki,ua.toDate=_i,ua.toISOString=$n,ua.inspect=ei,"undefined"!==typeof Symbol&&null!=Symbol.for&&(ua[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),ua.toJSON=xi,ua.toString=Jn,ua.unix=bi,ua.valueOf=mi,ua.creationData=Ai,ua.eraName=Zi,ua.eraNarrow=Ii,ua.eraAbbr=Pi,ua.eraYear=Li,ua.year=gt,ua.isLeapYear=yt,ua.weekYear=Wi,ua.isoWeekYear=qi,ua.quarter=ua.quarters=Ji,ua.month=lt,ua.daysInMonth=ht,ua.week=ua.weeks=Dt,ua.isoWeek=ua.isoWeeks=Rt,ua.weeksInYear=Yi,ua.weeksInWeekYear=Gi,ua.isoWeeksInYear=Vi,ua.isoWeeksInISOWeekYear=Ki,ua.date=$i,ua.day=ua.days=Wt,ua.weekday=qt,ua.isoWeekday=Vt,ua.dayOfYear=ea,ua.hour=ua.hours=nr,ua.minute=ua.minutes=ta,ua.second=ua.seconds=ia,ua.millisecond=ua.milliseconds=na,ua.utcOffset=vn,ua.utc=yn,ua.local=mn,ua.parseZone=bn,ua.hasAlignedHourOffset=_n,ua.isDST=wn,ua.isLocal=xn,ua.isUtcOffset=En,ua.isUtc=Sn,ua.isUTC=Sn,ua.zoneAbbr=sa,ua.zoneName=oa,ua.dates=S("dates accessor is deprecated. Use date instead.",$i),ua.months=S("months accessor is deprecated. Use month instead",lt),ua.years=S("years accessor is deprecated. Use year instead",gt),ua.zone=S("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",gn),ua.isDSTShifted=S("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",kn);var fa=I.prototype;function da(e,t,r,n){var i=yr(),a=p().set(n,t);return i[r](a,e)}function pa(e,t,r){if(l(e)&&(t=e,e=void 0),e=e||"",null!=t)return da(e,t,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=da(e,n,r,"month");return i}function va(e,t,r,n){"boolean"===typeof e?(l(t)&&(r=t,t=void 0),t=t||""):(r=t=e,e=!1,l(t)&&(r=t,t=void 0),t=t||"");var i,a=yr(),s=e?a._week.dow:0,o=[];if(null!=r)return da(t,(r+s)%7,n,"day");for(i=0;i<7;i++)o[i]=da(t,(i+s)%7,n,"day");return o}function ga(e,t){return pa(e,t,"months")}function ya(e,t){return pa(e,t,"monthsShort")}function ma(e,t,r){return va(e,t,r,"weekdays")}function ba(e,t,r){return va(e,t,r,"weekdaysShort")}function _a(e,t,r){return va(e,t,r,"weekdaysMin")}fa.calendar=L,fa.longDateFormat=V,fa.invalidDate=Y,fa.ordinal=X,fa.preparse=ha,fa.postformat=ha,fa.relativeTime=$,fa.pastFuture=ee,fa.set=T,fa.eras=Di,fa.erasParse=Ri,fa.erasConvertYear=Ti,fa.erasAbbrRegex=Bi,fa.erasNameRegex=Mi,fa.erasNarrowRegex=Oi,fa.months=at,fa.monthsShort=st,fa.monthsParse=ut,fa.monthsRegex=dt,fa.monthsShortRegex=ft,fa.week=Et,fa.firstDayOfYear=At,fa.firstDayOfWeek=Ct,fa.weekdays=Ft,fa.weekdaysMin=zt,fa.weekdaysShort=Ut,fa.weekdaysParse=Ht,fa.weekdaysRegex=Kt,fa.weekdaysShortRegex=Yt,fa.weekdaysMinRegex=Gt,fa.isPM=tr,fa.meridiem=ir,pr("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===le(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),n.lang=S("moment.lang is deprecated. Use moment.locale instead.",pr),n.langData=S("moment.langData is deprecated. Use moment.localeData instead.",yr);var wa=Math.abs;function ka(){var e=this._data;return this._milliseconds=wa(this._milliseconds),this._days=wa(this._days),this._months=wa(this._months),e.milliseconds=wa(e.milliseconds),e.seconds=wa(e.seconds),e.minutes=wa(e.minutes),e.hours=wa(e.hours),e.months=wa(e.months),e.years=wa(e.years),this}function xa(e,t,r,n){var i=Dn(t,r);return e._milliseconds+=n*i._milliseconds,e._days+=n*i._days,e._months+=n*i._months,e._bubble()}function Ea(e,t){return xa(this,e,t,1)}function Sa(e,t){return xa(this,e,t,-1)}function Ca(e){return e<0?Math.floor(e):Math.ceil(e)}function Aa(){var e,t,r,n,i,a=this._milliseconds,s=this._days,o=this._months,u=this._data;return a>=0&&s>=0&&o>=0||a<=0&&s<=0&&o<=0||(a+=864e5*Ca(Ra(o)+s),s=0,o=0),u.milliseconds=a%1e3,e=ce(a/1e3),u.seconds=e%60,t=ce(e/60),u.minutes=t%60,r=ce(t/60),u.hours=r%24,s+=ce(r/24),o+=i=ce(Da(s)),s-=Ca(Ra(i)),n=ce(o/12),o%=12,u.days=s,u.months=o,u.years=n,this}function Da(e){return 4800*e/146097}function Ra(e){return 146097*e/4800}function Ta(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if("month"===(e=ne(e))||"quarter"===e||"year"===e)switch(t=this._days+n/864e5,r=this._months+Da(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(Ra(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return 24*t+n/36e5;case"minute":return 1440*t+n/6e4;case"second":return 86400*t+n/1e3;case"millisecond":return Math.floor(864e5*t)+n;default:throw new Error("Unknown unit "+e)}}function Za(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*le(this._months/12):NaN}function Ia(e){return function(){return this.as(e)}}var Pa=Ia("ms"),La=Ia("s"),Ma=Ia("m"),Ba=Ia("h"),Oa=Ia("d"),Na=Ia("w"),Fa=Ia("M"),Ua=Ia("Q"),za=Ia("y");function ja(){return Dn(this)}function Ha(e){return e=ne(e),this.isValid()?this[e+"s"]():NaN}function Wa(e){return function(){return this.isValid()?this._data[e]:NaN}}var qa=Wa("milliseconds"),Va=Wa("seconds"),Ka=Wa("minutes"),Ya=Wa("hours"),Ga=Wa("days"),Qa=Wa("months"),Xa=Wa("years");function Ja(){return ce(this.days()/7)}var $a=Math.round,es={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function ts(e,t,r,n,i){return i.relativeTime(t||1,!!r,e,n)}function rs(e,t,r,n){var i=Dn(e).abs(),a=$a(i.as("s")),s=$a(i.as("m")),o=$a(i.as("h")),u=$a(i.as("d")),c=$a(i.as("M")),l=$a(i.as("w")),h=$a(i.as("y")),f=a<=r.ss&&["s",a]||a<r.s&&["ss",a]||s<=1&&["m"]||s<r.m&&["mm",s]||o<=1&&["h"]||o<r.h&&["hh",o]||u<=1&&["d"]||u<r.d&&["dd",u];return null!=r.w&&(f=f||l<=1&&["w"]||l<r.w&&["ww",l]),(f=f||c<=1&&["M"]||c<r.M&&["MM",c]||h<=1&&["y"]||["yy",h])[2]=t,f[3]=+e>0,f[4]=n,ts.apply(null,f)}function ns(e){return void 0===e?$a:"function"===typeof e&&($a=e,!0)}function is(e,t){return void 0!==es[e]&&(void 0===t?es[e]:(es[e]=t,"s"===e&&(es.ss=t-1),!0))}function as(e,t){if(!this.isValid())return this.localeData().invalidDate();var r,n,i=!1,a=es;return"object"===typeof e&&(t=e,e=!1),"boolean"===typeof e&&(i=e),"object"===typeof t&&(a=Object.assign({},es,t),null!=t.s&&null==t.ss&&(a.ss=t.s-1)),n=rs(this,!i,a,r=this.localeData()),i&&(n=r.pastFuture(+this,n)),r.postformat(n)}var ss=Math.abs;function os(e){return(e>0)-(e<0)||+e}function us(){if(!this.isValid())return this.localeData().invalidDate();var e,t,r,n,i,a,s,o,u=ss(this._milliseconds)/1e3,c=ss(this._days),l=ss(this._months),h=this.asSeconds();return h?(e=ce(u/60),t=ce(e/60),u%=60,e%=60,r=ce(l/12),l%=12,n=u?u.toFixed(3).replace(/\.?0+$/,""):"",i=h<0?"-":"",a=os(this._months)!==os(h)?"-":"",s=os(this._days)!==os(h)?"-":"",o=os(this._milliseconds)!==os(h)?"-":"",i+"P"+(r?a+r+"Y":"")+(l?a+l+"M":"")+(c?s+c+"D":"")+(t||e||u?"T":"")+(t?o+t+"H":"")+(e?o+e+"M":"")+(u?o+n+"S":"")):"P0D"}var cs=sn.prototype;return cs.isValid=nn,cs.abs=ka,cs.add=Ea,cs.subtract=Sa,cs.as=Ta,cs.asMilliseconds=Pa,cs.asSeconds=La,cs.asMinutes=Ma,cs.asHours=Ba,cs.asDays=Oa,cs.asWeeks=Na,cs.asMonths=Fa,cs.asQuarters=Ua,cs.asYears=za,cs.valueOf=Za,cs._bubble=Aa,cs.clone=ja,cs.get=Ha,cs.milliseconds=qa,cs.seconds=Va,cs.minutes=Ka,cs.hours=Ya,cs.days=Ga,cs.weeks=Ja,cs.months=Qa,cs.years=Xa,cs.humanize=as,cs.toISOString=us,cs.toString=us,cs.toJSON=us,cs.locale=si,cs.localeData=ui,cs.toIsoString=S("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",us),cs.lang=oi,U("X",0,0,"unix"),U("x",0,0,"valueOf"),Le("x",Re),Le("X",Ie),Fe("X",(function(e,t,r){r._d=new Date(1e3*parseFloat(e))})),Fe("x",(function(e,t,r){r._d=new Date(le(e))})),n.version="2.29.4",i(Yr),n.fn=ua,n.min=Jr,n.max=$r,n.now=en,n.utc=p,n.unix=ca,n.months=ga,n.isDate=h,n.locale=pr,n.invalid=m,n.duration=Dn,n.isMoment=x,n.weekdays=ma,n.parseZone=la,n.localeData=yr,n.isDuration=on,n.monthsShort=ya,n.weekdaysMin=_a,n.defineLocale=vr,n.updateLocale=gr,n.locales=mr,n.weekdaysShort=ba,n.normalizeUnits=ne,n.relativeTimeRounding=ns,n.relativeTimeThreshold=is,n.calendarFormat=zn,n.prototype=ua,n.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},n}()},8193:function(e){var t=1e3,r=60*t,n=60*r,i=24*n,a=7*i,s=365.25*i;function o(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}e.exports=function(e,u){u=u||{};var c=typeof e;if("string"===c&&e.length>0)return function(e){if((e=String(e)).length>100)return;var o=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!o)return;var u=parseFloat(o[1]);switch((o[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return u*s;case"weeks":case"week":case"w":return u*a;case"days":case"day":case"d":return u*i;case"hours":case"hour":case"hrs":case"hr":case"h":return u*n;case"minutes":case"minute":case"mins":case"min":case"m":return u*r;case"seconds":case"second":case"secs":case"sec":case"s":return u*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return u;default:return}}(e);if("number"===c&&isFinite(e))return u.long?function(e){var a=Math.abs(e);if(a>=i)return o(e,a,i,"day");if(a>=n)return o(e,a,n,"hour");if(a>=r)return o(e,a,r,"minute");if(a>=t)return o(e,a,t,"second");return e+" ms"}(e):function(e){var a=Math.abs(e);if(a>=i)return Math.round(e/i)+"d";if(a>=n)return Math.round(e/n)+"h";if(a>=r)return Math.round(e/r)+"m";if(a>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},3543:function(e,t,r){"use strict";var n=r(4704).default,i=r(6690).default,a=r(9728).default,s=r(1348).encodeText,o=function(){function e(t,r,n,a){i(this,e),this.name=t,this.code=r,this.codeBuf=s(this.code),this.alphabet=a,this.codec=n(a)}return a(e,[{key:"encode",value:function(e){return this.codec.encode(e)}},{key:"decode",value:function(e){var t,r=n(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(this.alphabet&&this.alphabet.indexOf(i)<0)throw new Error("invalid character '".concat(i,"' in '").concat(e,"'"))}}catch(a){r.e(a)}finally{r.f()}return this.codec.decode(e)}}]),e}();e.exports=o},9213:function(e,t,r){"use strict";var n=r(9814),i=r(3543),a=r(1186).rfc4648,s=r(1348),o=s.decodeText,u=s.encodeText,c=[["identity","\0",function(){return{encode:o,decode:u}},""],["base2","0",a(1),"01"],["base8","7",a(3),"01234567"],["base10","9",n,"0123456789"],["base16","f",a(4),"0123456789abcdef"],["base16upper","F",a(4),"0123456789ABCDEF"],["base32hex","v",a(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",a(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",a(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",a(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",a(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",a(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",a(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",a(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",a(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",n,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",n,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",n,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",n,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",a(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",a(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",a(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",a(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],l=c.reduce((function(e,t){return e[t[0]]=new i(t[0],t[1],t[2],t[3]),e}),{}),h=c.reduce((function(e,t){return e[t[1]]=l[t[0]],e}),{});e.exports={names:l,codes:h}},141:function(e,t,r){"use strict";var n=r(9213),i=r(1348),a=i.encodeText,s=i.decodeText,o=i.concat;function u(e){if(Object.prototype.hasOwnProperty.call(n.names,e))return n.names[e];if(Object.prototype.hasOwnProperty.call(n.codes,e))return n.codes[e];throw new Error("Unsupported encoding: ".concat(e))}(t=e.exports=function(e,t){if(!t)throw new Error("requires an encoded Uint8Array");var r=u(e),n=r.name,i=r.codeBuf;return function(e,t){var r=u(e);r.decode(s(t))}(n,t),o([i,t],i.length+t.length)}).encode=function(e,t){var r=u(e),n=a(r.encode(t));return o([r.codeBuf,n],r.codeBuf.length+n.length)},t.decode=function(e){e instanceof Uint8Array&&(e=s(e));var t=e[0];return["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(t)&&(e=e.toLowerCase()),u(e[0]).decode(e.substring(1))},t.isEncoded=function(e){if(e instanceof Uint8Array&&(e=s(e)),"[object String]"!==Object.prototype.toString.call(e))return!1;try{return u(e[0]).name}catch(t){return!1}},t.encoding=u,t.encodingFromData=function(e){return e instanceof Uint8Array&&(e=s(e)),u(e[0])};var c=Object.freeze(n.names),l=Object.freeze(n.codes);t.names=c,t.codes=l},1186:function(e){"use strict";e.exports={rfc4648:function(e){return function(t){return{encode:function(r){return function(e,t,r){for(var n="="===t[t.length-1],i=(1<<r)-1,a="",s=0,o=0,u=0;u<e.length;++u)for(o=o<<8|e[u],s+=8;s>r;)a+=t[i&o>>(s-=r)];if(s&&(a+=t[i&o<<r-s]),n)for(;a.length*r&7;)a+="=";return a}(r,t,e)},decode:function(r){return function(e,t,r){for(var n={},i=0;i<t.length;++i)n[t[i]]=i;for(var a=e.length;"="===e[a-1];)--a;for(var s=new Uint8Array(a*r/8|0),o=0,u=0,c=0,l=0;l<a;++l){var h=n[e[l]];if(void 0===h)throw new SyntaxError("Invalid character "+e[l]);u=u<<r|h,(o+=r)>=8&&(o-=8,s[c++]=255&u>>o)}if(o>=r||255&u<<8-o)throw new SyntaxError("Unexpected end of data");return s}(r,t,e)}}}}}},1348:function(e,t,r){"use strict";var n=r(4704).default,i=new TextDecoder,a=new TextEncoder;e.exports={decodeText:function(e){return i.decode(e)},encodeText:function(e){return a.encode(e)},concat:function(e,t){var r,i=new Uint8Array(t),a=0,s=n(e);try{for(s.s();!(r=s.n()).done;){var o=r.value;i.set(o,a),a+=o.length}}catch(u){s.e(u)}finally{s.f()}return i}}},2044:function(e){e.exports=function e(n,i){var a,s=0,o=0,u=i=i||0,c=n.length;do{if(u>=c)throw e.bytes=0,new RangeError("Could not decode varint");a=n[u++],s+=o<28?(a&r)<<o:(a&r)*Math.pow(2,o),o+=7}while(a>=t);return e.bytes=u-i,s};var t=128,r=127},6076:function(e){e.exports=function e(i,a,s){a=a||[];var o=s=s||0;for(;i>=n;)a[s++]=255&i|t,i/=128;for(;i&r;)a[s++]=255&i|t,i>>>=7;return a[s]=0|i,e.bytes=s-o+1,a};var t=128,r=-128,n=Math.pow(2,31)},6414:function(e,t,r){e.exports={encode:r(6076),decode:r(2044),encodingLength:r(5592)}},5592:function(e){var t=Math.pow(2,7),r=Math.pow(2,14),n=Math.pow(2,21),i=Math.pow(2,28),a=Math.pow(2,35),s=Math.pow(2,42),o=Math.pow(2,49),u=Math.pow(2,56),c=Math.pow(2,63);e.exports=function(e){return e<t?1:e<r?2:e<n?3:e<i?4:e<a?5:e<s?6:e<o?7:e<u?8:e<c?9:10}},8280:function(e){"use strict";var t=Object.freeze({identity:0,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,"murmur3-128":34,"murmur3-32":35,"dbl-sha2-256":86,md4:212,md5:213,bmt:214,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,kangarootwelve:7425,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082});e.exports={names:t}},3765:function(e,t,r){"use strict";var n=r(141),i=r(6414),a=r(8280).names,s=r(4634).toString,o=r(8347).fromString,u=r(3568).concat,c={};for(var l in a){var h=l;c[a[h]]=h}function f(e){if(!(e instanceof Uint8Array))throw new Error("multihash must be a Uint8Array");if(e.length<2)throw new Error("multihash too short. must be > 2 bytes.");var t=i.decode(e);if(!v(t))throw new Error("multihash unknown function code: 0x".concat(t.toString(16)));e=e.slice(i.decode.bytes);var r=i.decode(e);if(r<0)throw new Error("multihash invalid length: ".concat(r));if((e=e.slice(i.decode.bytes)).length!==r)throw new Error("multihash length inconsistent: 0x".concat(s(e,"base16")));return{code:t,name:c[t],length:r,digest:e}}function d(e){var t=e;if("string"===typeof e){if(void 0===a[e])throw new Error("Unrecognized hash function named: ".concat(e));t=a[e]}if("number"!==typeof t)throw new Error("Hash function code should be a number. Got: ".concat(t));if(void 0===c[t]&&!p(t))throw new Error("Unrecognized function code: ".concat(t));return t}function p(e){return e>0&&e<16}function v(e){return!!p(e)||!!c[e]}function g(e){f(e)}Object.freeze(c),e.exports={names:a,codes:c,toHexString:function(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return s(e,"base16")},fromHexString:function(e){return o(e,"base16")},toB58String:function(e){if(!(e instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return s(n.encode("base58btc",e)).slice(1)},fromB58String:function(e){var t=e instanceof Uint8Array?s(e):e;return n.decode("z"+t)},decode:f,encode:function(e,t,r){if(!e||void 0===t)throw new Error("multihash encode requires at least two args: digest, code");var n=d(t);if(!(e instanceof Uint8Array))throw new Error("digest should be a Uint8Array");if(null==r&&(r=e.length),r&&e.length!==r)throw new Error("digest length should be equal to specified length.");var a=i.encode(n),s=i.encode(r);return u([a,s,e],a.length+s.length+e.length)},coerceCode:d,isAppCode:p,validate:g,prefix:function(e){return g(e),e.subarray(0,2)},isValidCode:v}},2165:function(e,t,r){e.exports=r(407)},407:function(e,t){!function(r,n){"use strict";var i={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function a(e){if(!Array.isArray(e)&&!ArrayBuffer.isView(e))return!1;for(var t=0;t<e.length;t++)if(!Number.isInteger(e[t])||e[t]<0||e[t]>255)return!1;return!0}function s(e,t){return(65535&e)*t+(((e>>>16)*t&65535)<<16)}function o(e,t){return e<<t|e>>>32-t}function u(e){return e=s(e^=e>>>16,2246822507),e=s(e^=e>>>13,3266489909),e^=e>>>16}function c(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]+t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]+t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]+t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]+t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function l(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]*t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]*t[3],r[1]+=r[2]>>>16,r[2]&=65535,r[2]+=e[3]*t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]*t[3],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[2]*t[2],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[3]*t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function h(e,t){return 32===(t%=64)?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:(t-=32,[e[1]<<t|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t])}function f(e,t){return 0===(t%=64)?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]}function d(e,t){return[e[0]^t[0],e[1]^t[1]]}function p(e){return e=d(e,[0,e[0]>>>1]),e=d(e=l(e,[4283543511,3981806797]),[0,e[0]>>>1]),e=d(e=l(e,[3301882366,444984403]),[0,e[0]>>>1])}i.x86.hash32=function(e,t){if(i.inputValidation&&!a(e))return n;t=t||0;for(var r=e.length%4,c=e.length-r,l=t,h=0,f=3432918353,d=461845907,p=0;p<c;p+=4)h=s(h=e[p]|e[p+1]<<8|e[p+2]<<16|e[p+3]<<24,f),h=s(h=o(h,15),d),l=s(l=o(l^=h,13),5)+3864292196;switch(h=0,r){case 3:h^=e[p+2]<<16;case 2:h^=e[p+1]<<8;case 1:h=s(h^=e[p],f),l^=h=s(h=o(h,15),d)}return(l=u(l^=e.length))>>>0},i.x86.hash128=function(e,t){if(i.inputValidation&&!a(e))return n;t=t||0;for(var r=e.length%16,c=e.length-r,l=t,h=t,f=t,d=t,p=0,v=0,g=0,y=0,m=597399067,b=2869860233,_=951274213,w=2716044179,k=0;k<c;k+=16)p=e[k]|e[k+1]<<8|e[k+2]<<16|e[k+3]<<24,v=e[k+4]|e[k+5]<<8|e[k+6]<<16|e[k+7]<<24,g=e[k+8]|e[k+9]<<8|e[k+10]<<16|e[k+11]<<24,y=e[k+12]|e[k+13]<<8|e[k+14]<<16|e[k+15]<<24,p=o(p=s(p,m),15),l=o(l^=p=s(p,b),19),l=s(l+=h,5)+1444728091,v=o(v=s(v,b),16),h=o(h^=v=s(v,_),17),h=s(h+=f,5)+197830471,g=o(g=s(g,_),17),f=o(f^=g=s(g,w),15),f=s(f+=d,5)+2530024501,y=o(y=s(y,w),18),d=o(d^=y=s(y,m),13),d=s(d+=l,5)+850148119;switch(p=0,v=0,g=0,y=0,r){case 15:y^=e[k+14]<<16;case 14:y^=e[k+13]<<8;case 13:y=s(y^=e[k+12],w),d^=y=s(y=o(y,18),m);case 12:g^=e[k+11]<<24;case 11:g^=e[k+10]<<16;case 10:g^=e[k+9]<<8;case 9:g=s(g^=e[k+8],_),f^=g=s(g=o(g,17),w);case 8:v^=e[k+7]<<24;case 7:v^=e[k+6]<<16;case 6:v^=e[k+5]<<8;case 5:v=s(v^=e[k+4],b),h^=v=s(v=o(v,16),_);case 4:p^=e[k+3]<<24;case 3:p^=e[k+2]<<16;case 2:p^=e[k+1]<<8;case 1:p=s(p^=e[k],m),l^=p=s(p=o(p,15),b)}return l^=e.length,l+=h^=e.length,l+=f^=e.length,h+=l+=d^=e.length,f+=l,d+=l,l=u(l),l+=h=u(h),l+=f=u(f),h+=l+=d=u(d),f+=l,d+=l,("00000000"+(l>>>0).toString(16)).slice(-8)+("00000000"+(h>>>0).toString(16)).slice(-8)+("00000000"+(f>>>0).toString(16)).slice(-8)+("00000000"+(d>>>0).toString(16)).slice(-8)},i.x64.hash128=function(e,t){if(i.inputValidation&&!a(e))return n;t=t||0;for(var r=e.length%16,s=e.length-r,o=[0,t],u=[0,t],v=[0,0],g=[0,0],y=[2277735313,289559509],m=[1291169091,658871167],b=0;b<s;b+=16)v=[e[b+4]|e[b+5]<<8|e[b+6]<<16|e[b+7]<<24,e[b]|e[b+1]<<8|e[b+2]<<16|e[b+3]<<24],g=[e[b+12]|e[b+13]<<8|e[b+14]<<16|e[b+15]<<24,e[b+8]|e[b+9]<<8|e[b+10]<<16|e[b+11]<<24],v=h(v=l(v,y),31),o=c(o=h(o=d(o,v=l(v,m)),27),u),o=c(l(o,[0,5]),[0,1390208809]),g=h(g=l(g,m),33),u=c(u=h(u=d(u,g=l(g,y)),31),o),u=c(l(u,[0,5]),[0,944331445]);switch(v=[0,0],g=[0,0],r){case 15:g=d(g,f([0,e[b+14]],48));case 14:g=d(g,f([0,e[b+13]],40));case 13:g=d(g,f([0,e[b+12]],32));case 12:g=d(g,f([0,e[b+11]],24));case 11:g=d(g,f([0,e[b+10]],16));case 10:g=d(g,f([0,e[b+9]],8));case 9:g=l(g=d(g,[0,e[b+8]]),m),u=d(u,g=l(g=h(g,33),y));case 8:v=d(v,f([0,e[b+7]],56));case 7:v=d(v,f([0,e[b+6]],48));case 6:v=d(v,f([0,e[b+5]],40));case 5:v=d(v,f([0,e[b+4]],32));case 4:v=d(v,f([0,e[b+3]],24));case 3:v=d(v,f([0,e[b+2]],16));case 2:v=d(v,f([0,e[b+1]],8));case 1:v=l(v=d(v,[0,e[b]]),y),o=d(o,v=l(v=h(v,31),m))}return o=c(o=d(o,[0,e.length]),u=d(u,[0,e.length])),u=c(u,o),o=c(o=p(o),u=p(u)),u=c(u,o),("00000000"+(o[0]>>>0).toString(16)).slice(-8)+("00000000"+(o[1]>>>0).toString(16)).slice(-8)+("00000000"+(u[0]>>>0).toString(16)).slice(-8)+("00000000"+(u[1]>>>0).toString(16)).slice(-8)},e.exports&&(t=e.exports=i),t.murmurHash3=i}()},7922:function(e,t){(function(){var e,r,n,i,a,s,o,u;u=function(e){return[(e&255<<24)>>>24,(e&255<<16)>>>16,(65280&e)>>>8,255&e].join(".")},o=function(e){var t,n,i,a,s,o;for(t=[],i=a=0;a<=3&&0!==e.length;i=++a){if(i>0){if("."!==e[0])throw new Error("Invalid IP");e=e.substring(1)}s=(o=r(e))[0],n=o[1],e=e.substring(n),t.push(s)}if(0!==e.length)throw new Error("Invalid IP");switch(t.length){case 1:if(t[0]>4294967295)throw new Error("Invalid IP");return t[0]>>>0;case 2:if(t[0]>255||t[1]>16777215)throw new Error("Invalid IP");return(t[0]<<24|t[1])>>>0;case 3:if(t[0]>255||t[1]>255||t[2]>65535)throw new Error("Invalid IP");return(t[0]<<24|t[1]<<16|t[2])>>>0;case 4:if(t[0]>255||t[1]>255||t[2]>255||t[3]>255)throw new Error("Invalid IP");return(t[0]<<24|t[1]<<16|t[2]<<8|t[3])>>>0;default:throw new Error("Invalid IP")}},i=(n=function(e){return e.charCodeAt(0)})("0"),s=n("a"),a=n("A"),r=function(e){var t,r,o,u,c;for(u=0,t=10,r="9",o=0,e.length>1&&"0"===e[o]&&("x"===e[o+1]||"X"===e[o+1]?(o+=2,t=16):"0"<=e[o+1]&&e[o+1]<="9"&&(o++,t=8,r="7")),c=o;o<e.length;){if("0"<=e[o]&&e[o]<=r)u=u*t+(n(e[o])-i)>>>0;else{if(16!==t)break;if("a"<=e[o]&&e[o]<="f")u=u*t+(10+n(e[o])-s)>>>0;else{if(!("A"<=e[o]&&e[o]<="F"))break;u=u*t+(10+n(e[o])-a)>>>0}}if(u>4294967295)throw new Error("too large");o++}if(o===c)throw new Error("empty octet");return[u,o]},e=function(){function e(e,t){var r,n,i;if("string"!==typeof e)throw new Error("Missing `net' parameter");if(t||(i=e.split("/",2),e=i[0],t=i[1]),t||(t=32),"string"===typeof t&&t.indexOf(".")>-1){try{this.maskLong=o(t)}catch(a){throw a,new Error("Invalid mask: "+t)}for(r=n=32;n>=0;r=--n)if(this.maskLong===4294967295<<32-r>>>0){this.bitmask=r;break}}else{if(!t&&0!==t)throw new Error("Invalid mask: empty");this.bitmask=parseInt(t,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0)}try{this.netLong=(o(e)&this.maskLong)>>>0}catch(a){throw a,new Error("Invalid net address: "+e)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+t);this.size=Math.pow(2,32-this.bitmask),this.base=u(this.netLong),this.mask=u(this.maskLong),this.hostmask=u(~this.maskLong),this.first=this.bitmask<=30?u(this.netLong+1):this.base,this.last=this.bitmask<=30?u(this.netLong+this.size-2):u(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?u(this.netLong+this.size-1):void 0}return e.prototype.contains=function(t){return"string"===typeof t&&(t.indexOf("/")>0||4!==t.split(".").length)&&(t=new e(t)),t instanceof e?this.contains(t.base)&&this.contains(t.broadcast||t.last):(o(t)&this.maskLong)>>>0===(this.netLong&this.maskLong)>>>0},e.prototype.next=function(t){return null==t&&(t=1),new e(u(this.netLong+this.size*t),this.mask)},e.prototype.forEach=function(e){var t,r,n;for(n=o(this.first),r=o(this.last),t=0;n<=r;)e(u(n),n,t),t++,n++},e.prototype.toString=function(){return this.base+"/"+this.bitmask},e}(),t.ip2long=o,t.long2ip=u,t.Netmask=e}).call(this)},5359:function(e,t,r){"use strict";var n=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof r.g)return r.g;throw new Error("unable to locate global object")}();e.exports=t=n.fetch,n.fetch&&(t.default=n.fetch.bind(n)),t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response},8605:function(e,t,r){var n=r(392);function i(e,t){n.cipher.registerAlgorithm(e,(function(){return new n.aes.Algorithm(e,t)}))}r(3397),r(4533),r(3877),e.exports=n.aes=n.aes||{},n.aes.startEncrypting=function(e,t,r,n){var i=v({key:e,output:r,decrypt:!1,mode:n});return i.start(t),i},n.aes.createEncryptionCipher=function(e,t){return v({key:e,output:null,decrypt:!1,mode:t})},n.aes.startDecrypting=function(e,t,r,n){var i=v({key:e,output:r,decrypt:!0,mode:n});return i.start(t),i},n.aes.createDecryptionCipher=function(e,t){return v({key:e,output:null,decrypt:!0,mode:t})},n.aes.Algorithm=function(e,t){l||f();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(e,t){return p(r._w,e,t,!1)},decrypt:function(e,t){return p(r._w,e,t,!0)}}}),r._init=!1},n.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t,r=e.key;if("string"!==typeof r||16!==r.length&&24!==r.length&&32!==r.length){if(n.util.isArray(r)&&(16===r.length||24===r.length||32===r.length)){t=r,r=n.util.createBuffer();for(var i=0;i<t.length;++i)r.putByte(t[i])}}else r=n.util.createBuffer(r);if(!n.util.isArray(r)){t=r,r=[];var a=t.length();if(16===a||24===a||32===a){a>>>=2;for(i=0;i<a;++i)r.push(t.getInt32())}}if(!n.util.isArray(r)||4!==r.length&&6!==r.length&&8!==r.length)throw new Error("Invalid key parameter.");var s=this.mode.name,o=-1!==["CFB","OFB","CTR","GCM"].indexOf(s);this._w=d(r,e.decrypt&&!o),this._init=!0}},n.aes._expandKey=function(e,t){return l||f(),d(e,t)},n.aes._updateBlock=p,i("AES-ECB",n.cipher.modes.ecb),i("AES-CBC",n.cipher.modes.cbc),i("AES-CFB",n.cipher.modes.cfb),i("AES-OFB",n.cipher.modes.ofb),i("AES-CTR",n.cipher.modes.ctr),i("AES-GCM",n.cipher.modes.gcm);var a,s,o,u,c,l=!1,h=4;function f(){l=!0,o=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;a=new Array(256),s=new Array(256),u=new Array(4),c=new Array(4);for(t=0;t<4;++t)u[t]=new Array(256),c[t]=new Array(256);var r,n,i,h,f,d,p,v=0,g=0;for(t=0;t<256;++t){h=(h=g^g<<1^g<<2^g<<3^g<<4)>>8^255&h^99,a[v]=h,s[h]=v,d=(f=e[h])<<24^h<<16^h<<8^h^f,p=((r=e[v])^(n=e[r])^(i=e[n]))<<24^(v^i)<<16^(v^n^i)<<8^v^r^i;for(var y=0;y<4;++y)u[y][v]=d,c[y][h]=p,d=d<<24|d>>>8,p=p<<24|p>>>8;0===v?v=g=1:(v=r^e[e[e[r^i]]],g^=e[e[g]])}}function d(e,t){for(var r,n=e.slice(0),i=1,s=n.length,u=h*(s+6+1),l=s;l<u;++l)r=n[l-1],l%s===0?(r=a[r>>>16&255]<<24^a[r>>>8&255]<<16^a[255&r]<<8^a[r>>>24]^o[i]<<24,i++):s>6&&l%s===4&&(r=a[r>>>24]<<24^a[r>>>16&255]<<16^a[r>>>8&255]<<8^a[255&r]),n[l]=n[l-s]^r;if(t){for(var f,d=c[0],p=c[1],v=c[2],g=c[3],y=n.slice(0),m=(l=0,(u=n.length)-h);l<u;l+=h,m-=h)if(0===l||l===u-h)y[l]=n[m],y[l+1]=n[m+3],y[l+2]=n[m+2],y[l+3]=n[m+1];else for(var b=0;b<h;++b)f=n[m+b],y[l+(3&-b)]=d[a[f>>>24]]^p[a[f>>>16&255]]^v[a[f>>>8&255]]^g[a[255&f]];n=y}return n}function p(e,t,r,n){var i,o,l,h,f,d,p,v,g,y,m,b,_=e.length/4-1;n?(i=c[0],o=c[1],l=c[2],h=c[3],f=s):(i=u[0],o=u[1],l=u[2],h=u[3],f=a),d=t[0]^e[0],p=t[n?3:1]^e[1],v=t[2]^e[2],g=t[n?1:3]^e[3];for(var w=3,k=1;k<_;++k)y=i[d>>>24]^o[p>>>16&255]^l[v>>>8&255]^h[255&g]^e[++w],m=i[p>>>24]^o[v>>>16&255]^l[g>>>8&255]^h[255&d]^e[++w],b=i[v>>>24]^o[g>>>16&255]^l[d>>>8&255]^h[255&p]^e[++w],g=i[g>>>24]^o[d>>>16&255]^l[p>>>8&255]^h[255&v]^e[++w],d=y,p=m,v=b;r[0]=f[d>>>24]<<24^f[p>>>16&255]<<16^f[v>>>8&255]<<8^f[255&g]^e[++w],r[n?3:1]=f[p>>>24]<<24^f[v>>>16&255]<<16^f[g>>>8&255]<<8^f[255&d]^e[++w],r[2]=f[v>>>24]<<24^f[g>>>16&255]<<16^f[d>>>8&255]<<8^f[255&p]^e[++w],r[n?1:3]=f[g>>>24]<<24^f[d>>>16&255]<<16^f[p>>>8&255]<<8^f[255&v]^e[++w]}function v(e){var t,r="AES-"+((e=e||{}).mode||"CBC").toUpperCase(),i=(t=e.decrypt?n.cipher.createDecipher(r,e.key):n.cipher.createCipher(r,e.key)).start;return t.start=function(e,r){var a=null;r instanceof n.util.ByteBuffer&&(a=r,r={}),(r=r||{}).output=a,r.iv=e,i.call(t,r)},t}},5049:function(e,t,r){var n=r(392);r(3877),r(2886);var i=e.exports=n.asn1=n.asn1||{};function a(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}i.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},i.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},i.create=function(e,t,r,a,s){if(n.util.isArray(a)){for(var o=[],u=0;u<a.length;++u)void 0!==a[u]&&o.push(a[u]);a=o}var c={tagClass:e,type:t,constructed:r,composed:r||n.util.isArray(a),value:a};return s&&"bitStringContents"in s&&(c.bitStringContents=s.bitStringContents,c.original=i.copy(c)),c},i.copy=function(e,t){var r;if(n.util.isArray(e)){r=[];for(var a=0;a<e.length;++a)r.push(i.copy(e[a],t));return r}return"string"===typeof e?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:i.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)},i.equals=function(e,t,r){if(n.util.isArray(e)){if(!n.util.isArray(t))return!1;if(e.length!==t.length)return!1;for(var a=0;a<e.length;++a)if(!i.equals(e[a],t[a]))return!1;return!0}if(typeof e!==typeof t)return!1;if("string"===typeof e)return e===t;var s=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&i.equals(e.value,t.value);return r&&r.includeBitStringContents&&(s=s&&e.bitStringContents===t.bitStringContents),s},i.getBerValueLength=function(e){var t=e.getByte();if(128!==t)return 128&t?e.getInt((127&t)<<3):t};function s(e,t,r,n){var o;a(e,t,2);var u=e.getByte();t--;var c=192&u,l=31&u;o=e.length();var h,f,d=function(e,t){var r=e.getByte();if(t--,128!==r){var n;if(128&r){var i=127&r;a(e,t,i),n=e.getInt(i<<3)}else n=r;if(n<0)throw new Error("Negative length: "+n);return n}}(e,t);if(t-=o-e.length(),void 0!==d&&d>t){if(n.strict){var p=new Error("Too few bytes to read ASN.1 value.");throw p.available=e.length(),p.remaining=t,p.requested=d,p}d=t}var v=32===(32&u);if(v)if(h=[],void 0===d)for(;;){if(a(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}o=e.length(),h.push(s(e,t,r+1,n)),t-=o-e.length()}else for(;d>0;)o=e.length(),h.push(s(e,d,r+1,n)),t-=o-e.length(),d-=o-e.length();if(void 0===h&&c===i.Class.UNIVERSAL&&l===i.Type.BITSTRING&&(f=e.bytes(d)),void 0===h&&n.decodeBitStrings&&c===i.Class.UNIVERSAL&&l===i.Type.BITSTRING&&d>1){var g=e.read,y=t,m=0;if(l===i.Type.BITSTRING&&(a(e,t,1),m=e.getByte(),t--),0===m)try{o=e.length();var b=s(e,t,r+1,{strict:!0,decodeBitStrings:!0}),_=o-e.length();t-=_,l==i.Type.BITSTRING&&_++;var w=b.tagClass;_!==d||w!==i.Class.UNIVERSAL&&w!==i.Class.CONTEXT_SPECIFIC||(h=[b])}catch(x){}void 0===h&&(e.read=g,t=y)}if(void 0===h){if(void 0===d){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");d=t}if(l===i.Type.BMPSTRING)for(h="";d>0;d-=2)a(e,t,2),h+=String.fromCharCode(e.getInt16()),t-=2;else h=e.getBytes(d),t-=d}var k=void 0===f?null:{bitStringContents:f};return i.create(c,l,v,h,k)}i.fromDer=function(e,t){void 0===t&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),"boolean"===typeof t&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),"string"===typeof e&&(e=n.util.createBuffer(e));var r=e.length(),i=s(e,e.length(),0,t);if(t.parseAllBytes&&0!==e.length()){var a=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw a.byteCount=r,a.remaining=e.length(),a}return i},i.toDer=function(e){var t=n.util.createBuffer(),r=e.tagClass|e.type,a=n.util.createBuffer(),s=!1;if("bitStringContents"in e&&(s=!0,e.original&&(s=i.equals(e,e.original))),s)a.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:a.putByte(0);for(var o=0;o<e.value.length;++o)void 0!==e.value[o]&&a.putBuffer(i.toDer(e.value[o]))}else if(e.type===i.Type.BMPSTRING)for(o=0;o<e.value.length;++o)a.putInt16(e.value.charCodeAt(o));else e.type===i.Type.INTEGER&&e.value.length>1&&(0===e.value.charCodeAt(0)&&0===(128&e.value.charCodeAt(1))||255===e.value.charCodeAt(0)&&128===(128&e.value.charCodeAt(1)))?a.putBytes(e.value.substr(1)):a.putBytes(e.value);if(t.putByte(r),a.length()<=127)t.putByte(127&a.length());else{var u=a.length(),c="";do{c+=String.fromCharCode(255&u),u>>>=8}while(u>0);t.putByte(128|c.length);for(o=c.length-1;o>=0;--o)t.putByte(c.charCodeAt(o))}return t.putBuffer(a),t},i.oidToDer=function(e){var t,r,i,a,s=e.split("."),o=n.util.createBuffer();o.putByte(40*parseInt(s[0],10)+parseInt(s[1],10));for(var u=2;u<s.length;++u){t=!0,r=[],i=parseInt(s[u],10);do{a=127&i,i>>>=7,t||(a|=128),r.push(a),t=!1}while(i>0);for(var c=r.length-1;c>=0;--c)o.putByte(r[c])}return o},i.derToOid=function(e){var t;"string"===typeof e&&(e=n.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var i=0;e.length()>0;)i<<=7,128&(r=e.getByte())?i+=127&r:(t+="."+(i+r),i=0);return t},i.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),a=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),o=0;if(e.length>11){var u=e.charAt(10),c=10;"+"!==u&&"-"!==u&&(o=parseInt(e.substr(10,2),10),c+=2)}if(t.setUTCFullYear(r,n,i),t.setUTCHours(a,s,o,0),c&&("+"===(u=e.charAt(c))||"-"===u)){var l=60*parseInt(e.substr(c+1,2),10)+parseInt(e.substr(c+4,2),10);l*=6e4,"+"===u?t.setTime(+t-l):t.setTime(+t+l)}return t},i.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),a=parseInt(e.substr(8,2),10),s=parseInt(e.substr(10,2),10),o=parseInt(e.substr(12,2),10),u=0,c=0,l=!1;"Z"===e.charAt(e.length-1)&&(l=!0);var h=e.length-5,f=e.charAt(h);"+"!==f&&"-"!==f||(c=60*parseInt(e.substr(h+1,2),10)+parseInt(e.substr(h+4,2),10),c*=6e4,"+"===f&&(c*=-1),l=!0);return"."===e.charAt(14)&&(u=1e3*parseFloat(e.substr(14),10)),l?(t.setUTCFullYear(r,n,i),t.setUTCHours(a,s,o,u),t.setTime(+t+c)):(t.setFullYear(r,n,i),t.setHours(a,s,o,u)),t},i.dateToUtcTime=function(e){if("string"===typeof e)return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z"},i.dateToGeneralizedTime=function(e){if("string"===typeof e)return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z"},i.integerToDer=function(e){var t=n.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r},i.derToInteger=function(e){"string"===typeof e&&(e=n.util.createBuffer(e));var t=8*e.length();if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)},i.validate=function(e,t,r,a){var s=!1;if(e.tagClass!==t.tagClass&&"undefined"!==typeof t.tagClass||e.type!==t.type&&"undefined"!==typeof t.type)a&&(e.tagClass!==t.tagClass&&a.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&a.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));else if(e.constructed===t.constructed||"undefined"===typeof t.constructed){if(s=!0,t.value&&n.util.isArray(t.value))for(var o=0,u=0;s&&u<t.value.length;++u)s=t.value[u].optional||!1,e.value[o]&&((s=i.validate(e.value[o],t.value[u],r,a))?++o:t.value[u].optional&&(s=!0)),!s&&a&&a.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(s&&r)if(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{if(0!==e.bitStringContents.charCodeAt(0))throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}else a&&a.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');return s};var o=/[^\\u0000-\\u00ff]/;i.prettyPrint=function(e,t,r){var a="";r=r||2,(t=t||0)>0&&(a+="\n");for(var s="",u=0;u<t*r;++u)s+=" ";switch(a+=s+"Tag: ",e.tagClass){case i.Class.UNIVERSAL:a+="Universal:";break;case i.Class.APPLICATION:a+="Application:";break;case i.Class.CONTEXT_SPECIFIC:a+="Context-Specific:";break;case i.Class.PRIVATE:a+="Private:"}if(e.tagClass===i.Class.UNIVERSAL)switch(a+=e.type,e.type){case i.Type.NONE:a+=" (None)";break;case i.Type.BOOLEAN:a+=" (Boolean)";break;case i.Type.INTEGER:a+=" (Integer)";break;case i.Type.BITSTRING:a+=" (Bit string)";break;case i.Type.OCTETSTRING:a+=" (Octet string)";break;case i.Type.NULL:a+=" (Null)";break;case i.Type.OID:a+=" (Object Identifier)";break;case i.Type.ODESC:a+=" (Object Descriptor)";break;case i.Type.EXTERNAL:a+=" (External or Instance of)";break;case i.Type.REAL:a+=" (Real)";break;case i.Type.ENUMERATED:a+=" (Enumerated)";break;case i.Type.EMBEDDED:a+=" (Embedded PDV)";break;case i.Type.UTF8:a+=" (UTF8)";break;case i.Type.ROID:a+=" (Relative Object Identifier)";break;case i.Type.SEQUENCE:a+=" (Sequence)";break;case i.Type.SET:a+=" (Set)";break;case i.Type.PRINTABLESTRING:a+=" (Printable String)";break;case i.Type.IA5String:a+=" (IA5String (ASCII))";break;case i.Type.UTCTIME:a+=" (UTC time)";break;case i.Type.GENERALIZEDTIME:a+=" (Generalized time)";break;case i.Type.BMPSTRING:a+=" (BMP String)"}else a+=e.type;if(a+="\n",a+=s+"Constructed: "+e.constructed+"\n",e.composed){var c=0,l="";for(u=0;u<e.value.length;++u)void 0!==e.value[u]&&(c+=1,l+=i.prettyPrint(e.value[u],t+1,r),u+1<e.value.length&&(l+=","));a+=s+"Sub values: "+c+l}else{if(a+=s+"Value: ",e.type===i.Type.OID){var h=i.derToOid(e.value);a+=h,n.pki&&n.pki.oids&&h in n.pki.oids&&(a+=" ("+n.pki.oids[h]+") ")}if(e.type===i.Type.INTEGER)try{a+=i.derToInteger(e.value)}catch(d){a+="0x"+n.util.bytesToHex(e.value)}else if(e.type===i.Type.BITSTRING){if(e.value.length>1?a+="0x"+n.util.bytesToHex(e.value.slice(1)):a+="(none)",e.value.length>0){var f=e.value.charCodeAt(0);1==f?a+=" (1 unused bit shown)":f>1&&(a+=" ("+f+" unused bits shown)")}}else if(e.type===i.Type.OCTETSTRING)o.test(e.value)||(a+="("+e.value+") "),a+="0x"+n.util.bytesToHex(e.value);else if(e.type===i.Type.UTF8)try{a+=n.util.decodeUtf8(e.value)}catch(p){if("URI malformed"!==p.message)throw p;a+="0x"+n.util.bytesToHex(e.value)+" (malformed UTF8)"}else e.type===i.Type.PRINTABLESTRING||e.type===i.Type.IA5String?a+=e.value:o.test(e.value)?a+="0x"+n.util.bytesToHex(e.value):0===e.value.length?a+="[null]":a+=e.value}return a}},5754:function(e,t,r){var n=r(2678).Buffer,i={};e.exports=i;var a={};i.encode=function(e,t,r){if("string"!==typeof t)throw new TypeError('"alphabet" must be a string.');if(void 0!==r&&"number"!==typeof r)throw new TypeError('"maxline" must be a number.');var n="";if(e instanceof Uint8Array){var i=0,a=t.length,s=t.charAt(0),o=[0];for(i=0;i<e.length;++i){for(var u=0,c=e[i];u<o.length;++u)c+=o[u]<<8,o[u]=c%a,c=c/a|0;for(;c>0;)o.push(c%a),c=c/a|0}for(i=0;0===e[i]&&i<e.length-1;++i)n+=s;for(i=o.length-1;i>=0;--i)n+=t[o[i]]}else n=function(e,t){var r=0,n=t.length,i=t.charAt(0),a=[0];for(r=0;r<e.length();++r){for(var s=0,o=e.at(r);s<a.length;++s)o+=a[s]<<8,a[s]=o%n,o=o/n|0;for(;o>0;)a.push(o%n),o=o/n|0}var u="";for(r=0;0===e.at(r)&&r<e.length()-1;++r)u+=i;for(r=a.length-1;r>=0;--r)u+=t[a[r]];return u}(e,t);if(r){var l=new RegExp(".{1,"+r+"}","g");n=n.match(l).join("\r\n")}return n},i.decode=function(e,t){if("string"!==typeof e)throw new TypeError('"input" must be a string.');if("string"!==typeof t)throw new TypeError('"alphabet" must be a string.');var r=a[t];if(!r){r=a[t]=[];for(var i=0;i<t.length;++i)r[t.charCodeAt(i)]=i}e=e.replace(/\s/g,"");var s=t.length,o=t.charAt(0),u=[0];for(i=0;i<e.length;i++){var c=r[e.charCodeAt(i)];if(void 0===c)return;for(var l=0,h=c;l<u.length;++l)h+=u[l]*s,u[l]=255&h,h>>=8;for(;h>0;)u.push(255&h),h>>=8}for(var f=0;e[f]===o&&f<e.length-1;++f)u.push(0);return"undefined"!==typeof n?n.from(u.reverse()):new Uint8Array(u.reverse())}},3397:function(e,t,r){var n=r(392);r(3877),e.exports=n.cipher=n.cipher||{},n.cipher.algorithms=n.cipher.algorithms||{},n.cipher.createCipher=function(e,t){var r=e;if("string"===typeof r&&(r=n.cipher.getAlgorithm(r))&&(r=r()),!r)throw new Error("Unsupported algorithm: "+e);return new n.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})},n.cipher.createDecipher=function(e,t){var r=e;if("string"===typeof r&&(r=n.cipher.getAlgorithm(r))&&(r=r()),!r)throw new Error("Unsupported algorithm: "+e);return new n.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})},n.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),n.cipher.algorithms[e]=t},n.cipher.getAlgorithm=function(e){return(e=e.toUpperCase())in n.cipher.algorithms?n.cipher.algorithms[e]:null};var i=n.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};i.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=n.util.createBuffer(),this.output=e.output||n.util.createBuffer(),this.mode.start(t)},i.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},i.prototype.finish=function(e){!e||"ECB"!==this.mode.name&&"CBC"!==this.mode.name||(this.mode.pad=function(t){return e(this.blockSize,t,!1)},this.mode.unpad=function(t){return e(this.blockSize,t,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t))&&(this._finish=!0,this.update(),!(this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))&&!(this.mode.afterFinish&&!this.mode.afterFinish(this.output,t)))}},4533:function(e,t,r){var n=r(392);r(3877),n.cipher=n.cipher||{};var i=e.exports=n.cipher.modes=n.cipher.modes||{};function a(e,t){if("string"===typeof e&&(e=n.util.createBuffer(e)),n.util.isArray(e)&&e.length>4){var r=e;e=n.util.createBuffer();for(var i=0;i<r.length;++i)e.putByte(r[i])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!n.util.isArray(e)){var a=[],s=t/4;for(i=0;i<s;++i)a.push(e.getInt32());e=a}return e}function s(e){e[e.length-1]=e[e.length-1]+1&4294967295}function o(e){return[e/4294967296|0,4294967295&e]}i.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},i.ecb.prototype.start=function(e){},i.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},i.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},i.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},i.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return!(n>this.blockSize<<2)&&(e.truncate(n),!0)},i.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},i.cbc.prototype.start=function(e){if(null===e.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=a(e.iv,this.blockSize),this._prev=this._iv.slice(0)}},i.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock},i.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)},i.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},i.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return!(n>this.blockSize<<2)&&(e.truncate(n),!0)},i.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},i.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=a(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(a>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(a>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},i.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=a(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===e.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(a>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.ofb.prototype.decrypt=i.ofb.prototype.encrypt,i.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},i.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=a(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]);else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(a>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}s(this._inBlock)},i.ctr.prototype.decrypt=i.ctr.prototype.encrypt,i.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0,this._R=3774873600},i.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t,r=n.util.createBuffer(e.iv);if(this._cipherLength=0,t="additionalData"in e?n.util.createBuffer(e.additionalData):n.util.createBuffer(),this._tagLength="tagLength"in e?e.tagLength:128,this._tag=null,e.decrypt&&(this._tag=n.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var i=r.length();if(12===i)this._j0=[r.getInt32(),r.getInt32(),r.getInt32(),1];else{for(this._j0=[0,0,0,0];r.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(o(8*i)))}this._inBlock=this._j0.slice(0),s(this._inBlock),this._partialBytes=0,t=n.util.createBuffer(t),this._aDataLength=o(8*t.length());var a=t.length()%this.blockSize;for(a&&t.fillWithByte(0,this.blockSize-a),this._s=[0,0,0,0];t.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])},i.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^=e.getInt32());this._cipherLength+=this.blockSize}else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(a<=0||r){if(r){var o=n%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),s(this._inBlock)},i.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),s(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize},i.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=n.util.createBuffer();var i=this._aDataLength.concat(o(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,i);var a=[];this.cipher.encrypt(this._j0,a);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^a[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r},i.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),i=0;i<128;++i){e[i/32|0]&1<<31-i%32&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r},i.gcm.prototype.pow=function(e,t){for(var r=1&e[3],n=3;n>0;--n)t[n]=e[n]>>>1|(1&e[n-1])<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)},i.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=e[r/8|0]>>>4*(7-r%8)&15,i=this._m[r][n];t[0]^=i[0],t[1]^=i[1],t[2]^=i[2],t[3]^=i[3]}return t},i.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)},i.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,i=16*r,a=new Array(i),s=0;s<i;++s){var o=[0,0,0,0],u=(n-1-s%n)*t;o[s/n|0]=1<<t-1<<u,a[s]=this.generateSubHashTable(this.multiply(o,e),t)}return a},i.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,i=new Array(r);i[n]=e.slice(0);for(var a=n>>>1;a>0;)this.pow(i[2*a],i[a]=[]),a>>=1;for(a=2;a<n;){for(var s=1;s<a;++s){var o=i[a],u=i[s];i[a+s]=[o[0]^u[0],o[1]^u[1],o[2]^u[2],o[3]^u[3]]}a*=2}for(i[0]=[0,0,0,0],a=n+1;a<r;++a){var c=i[a^n];i[a]=[e[0]^c[0],e[1]^c[1],e[2]^c[2],e[3]^c[3]]}return i}},1400:function(e,t,r){var n=r(392);function i(e,t){n.cipher.registerAlgorithm(e,(function(){return new n.des.Algorithm(e,t)}))}r(3397),r(4533),r(3877),e.exports=n.des=n.des||{},n.des.startEncrypting=function(e,t,r,n){var i=p({key:e,output:r,decrypt:!1,mode:n||(null===t?"ECB":"CBC")});return i.start(t),i},n.des.createEncryptionCipher=function(e,t){return p({key:e,output:null,decrypt:!1,mode:t})},n.des.startDecrypting=function(e,t,r,n){var i=p({key:e,output:r,decrypt:!0,mode:n||(null===t?"ECB":"CBC")});return i.start(t),i},n.des.createDecryptionCipher=function(e,t){return p({key:e,output:null,decrypt:!0,mode:t})},n.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(e,t){return d(r._keys,e,t,!1)},decrypt:function(e,t){return d(r._keys,e,t,!0)}}}),r._init=!1},n.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=n.util.createBuffer(e.key);if(0===this.name.indexOf("3DES")&&24!==t.length())throw new Error("Invalid Triple-DES key size: "+8*t.length());this._keys=function(e){for(var t,r=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],n=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],a=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],u=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],l=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],h=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],f=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],d=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],v=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=e.length()>8?3:1,y=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],b=0,_=0;_<g;_++){var w=e.getInt32(),k=e.getInt32();w^=(t=252645135&(w>>>4^k))<<4,w^=t=65535&((k^=t)>>>-16^w),w^=(t=858993459&(w>>>2^(k^=t<<-16)))<<2,w^=t=65535&((k^=t)>>>-16^w),w^=(t=1431655765&(w>>>1^(k^=t<<-16)))<<1,w^=t=16711935&((k^=t)>>>8^w),t=(w^=(t=1431655765&(w>>>1^(k^=t<<8)))<<1)<<8|(k^=t)>>>20&240,w=k<<24|k<<8&16711680|k>>>8&65280|k>>>24&240,k=t;for(var x=0;x<m.length;++x){m[x]?(w=w<<2|w>>>26,k=k<<2|k>>>26):(w=w<<1|w>>>27,k=k<<1|k>>>27),k&=-15;var E=r[(w&=-15)>>>28]|n[w>>>24&15]|i[w>>>20&15]|a[w>>>16&15]|s[w>>>12&15]|o[w>>>8&15]|u[w>>>4&15],S=c[k>>>28]|l[k>>>24&15]|h[k>>>20&15]|f[k>>>16&15]|d[k>>>12&15]|p[k>>>8&15]|v[k>>>4&15];t=65535&(S>>>16^E),y[b++]=E^t,y[b++]=S^t<<16}}return y}(t),this._init=!0}},i("DES-ECB",n.cipher.modes.ecb),i("DES-CBC",n.cipher.modes.cbc),i("DES-CFB",n.cipher.modes.cfb),i("DES-OFB",n.cipher.modes.ofb),i("DES-CTR",n.cipher.modes.ctr),i("3DES-ECB",n.cipher.modes.ecb),i("3DES-CBC",n.cipher.modes.cbc),i("3DES-CFB",n.cipher.modes.cfb),i("3DES-OFB",n.cipher.modes.ofb),i("3DES-CTR",n.cipher.modes.ctr);var a=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],s=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],o=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],u=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],c=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],l=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],h=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],f=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function d(e,t,r,n){var i,d,p=32===e.length?3:9;i=3===p?n?[30,-2,-2]:[0,32,2]:n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var v=t[0],g=t[1];v^=(d=252645135&(v>>>4^g))<<4,v^=(d=65535&(v>>>16^(g^=d)))<<16,v^=d=858993459&((g^=d)>>>2^v),v^=d=16711935&((g^=d<<2)>>>8^v),v=(v^=(d=1431655765&(v>>>1^(g^=d<<8)))<<1)<<1|v>>>31,g=(g^=d)<<1|g>>>31;for(var y=0;y<p;y+=3){for(var m=i[y+1],b=i[y+2],_=i[y];_!=m;_+=b){var w=g^e[_],k=(g>>>4|g<<28)^e[_+1];d=v,v=g,g=d^(s[w>>>24&63]|u[w>>>16&63]|l[w>>>8&63]|f[63&w]|a[k>>>24&63]|o[k>>>16&63]|c[k>>>8&63]|h[63&k])}d=v,v=g,g=d}g=g>>>1|g<<31,g^=d=1431655765&((v=v>>>1|v<<31)>>>1^g),g^=(d=16711935&(g>>>8^(v^=d<<1)))<<8,g^=(d=858993459&(g>>>2^(v^=d)))<<2,g^=d=65535&((v^=d)>>>16^g),g^=d=252645135&((v^=d<<16)>>>4^g),v^=d<<4,r[0]=v,r[1]=g}function p(e){var t,r="DES-"+((e=e||{}).mode||"CBC").toUpperCase(),i=(t=e.decrypt?n.cipher.createDecipher(r,e.key):n.cipher.createCipher(r,e.key)).start;return t.start=function(e,r){var a=null;r instanceof n.util.ByteBuffer&&(a=r,r={}),(r=r||{}).output=a,r.iv=e,i.call(t,r)},t}},392:function(e){e.exports={options:{usePureJavaScript:!1}}},878:function(e,t,r){var n=r(392);r(29),r(3877),(e.exports=n.hmac=n.hmac||{}).create=function(){var e=null,t=null,r=null,i=null,a={start:function(a,s){if(null!==a)if("string"===typeof a){if(!((a=a.toLowerCase())in n.md.algorithms))throw new Error('Unknown hash algorithm "'+a+'"');t=n.md.algorithms[a].create()}else t=a;if(null===s)s=e;else{if("string"===typeof s)s=n.util.createBuffer(s);else if(n.util.isArray(s)){var o=s;s=n.util.createBuffer();for(var u=0;u<o.length;++u)s.putByte(o[u])}var c=s.length();c>t.blockLength&&(t.start(),t.update(s.bytes()),s=t.digest()),r=n.util.createBuffer(),i=n.util.createBuffer(),c=s.length();for(u=0;u<c;++u){o=s.at(u);r.putByte(54^o),i.putByte(92^o)}if(c<t.blockLength)for(o=t.blockLength-c,u=0;u<o;++u)r.putByte(54),i.putByte(92);e=s,r=r.bytes(),i=i.bytes()}t.start(),t.update(r)},update:function(e){t.update(e)},getMac:function(){var e=t.digest().bytes();return t.start(),t.update(i),t.update(e),t.digest()}};return a.digest=a.getMac,a}},3055:function(e,t,r){var n,i=r(392);e.exports=i.jsbn=i.jsbn||{};function a(e,t,r){this.data=[],null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function s(){return new a(null)}function o(e,t,r,n,i,a){for(var s=16383&t,o=t>>14;--a>=0;){var u=16383&this.data[e],c=this.data[e++]>>14,l=o*u+c*s;i=((u=s*u+((16383&l)<<14)+r.data[n]+i)>>28)+(l>>14)+o*c,r.data[n++]=268435455&u}return i}i.jsbn.BigInteger=a,"undefined"===typeof navigator?(a.prototype.am=o,n=28):"Microsoft Internet Explorer"==navigator.appName?(a.prototype.am=function(e,t,r,n,i,a){for(var s=32767&t,o=t>>15;--a>=0;){var u=32767&this.data[e],c=this.data[e++]>>15,l=o*u+c*s;i=((u=s*u+((32767&l)<<15)+r.data[n]+(1073741823&i))>>>30)+(l>>>15)+o*c+(i>>>30),r.data[n++]=1073741823&u}return i},n=30):"Netscape"!=navigator.appName?(a.prototype.am=function(e,t,r,n,i,a){for(;--a>=0;){var s=t*this.data[e++]+r.data[n]+i;i=Math.floor(s/67108864),r.data[n++]=67108863&s}return i},n=26):(a.prototype.am=o,n=28),a.prototype.DB=n,a.prototype.DM=(1<<n)-1,a.prototype.DV=1<<n;a.prototype.FV=Math.pow(2,52),a.prototype.F1=52-n,a.prototype.F2=2*n-52;var u,c,l="0123456789abcdefghijklmnopqrstuvwxyz",h=new Array;for(u="0".charCodeAt(0),c=0;c<=9;++c)h[u++]=c;for(u="a".charCodeAt(0),c=10;c<36;++c)h[u++]=c;for(u="A".charCodeAt(0),c=10;c<36;++c)h[u++]=c;function f(e){return l.charAt(e)}function d(e,t){var r=h[e.charCodeAt(t)];return null==r?-1:r}function p(e){var t=s();return t.fromInt(e),t}function v(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function g(e){this.m=e}function y(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function m(e,t){return e&t}function b(e,t){return e|t}function _(e,t){return e^t}function w(e,t){return e&~t}function k(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function x(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function E(){}function S(e){return e}function C(e){this.r2=s(),this.q3=s(),a.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}g.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},g.prototype.revert=function(e){return e},g.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},g.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},g.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},y.prototype.convert=function(e){var t=s();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(a.ZERO)>0&&this.m.subTo(t,t),t},y.prototype.revert=function(e){var t=s();return e.copyTo(t),this.reduce(t),t},y.prototype.reduce=function(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e.data[t],n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},y.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},y.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},a.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s},a.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0},a.prototype.fromString=function(e,t){var r;if(16==t)r=4;else if(8==t)r=3;else if(256==t)r=8;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return void this.fromRadix(e,t);r=2}this.t=0,this.s=0;for(var n=e.length,i=!1,s=0;--n>=0;){var o=8==r?255&e[n]:d(e,n);o<0?"-"==e.charAt(n)&&(i=!0):(i=!1,0==s?this.data[this.t++]=o:s+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,(s+=r)>=this.DB&&(s-=this.DB))}8==r&&0!=(128&e[0])&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&a.ZERO.subTo(this,this)},a.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t},a.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s},a.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s},a.prototype.lShiftTo=function(e,t){var r,n=e%this.DB,i=this.DB-n,a=(1<<i)-1,s=Math.floor(e/this.DB),o=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t.data[r+s+1]=this.data[r]>>i|o,o=(this.data[r]&a)<<n;for(r=s-1;r>=0;--r)t.data[r]=0;t.data[s]=o,t.t=this.t+s+1,t.s=this.s,t.clamp()},a.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,i=this.DB-n,a=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)t.data[s-r-1]|=(this.data[s]&a)<<i,t.data[s-r]=this.data[s]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&a)<<i),t.t=this.t-r,t.clamp()}},a.prototype.subTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()},a.prototype.multiplyTo=function(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t.data[i]=0;for(i=0;i<n.t;++i)t.data[i+r.t]=r.am(0,n.data[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&a.ZERO.subTo(t,t)},a.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()},a.prototype.divRemTo=function(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t)return null!=t&&t.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=s());var o=s(),u=this.s,c=e.s,l=this.DB-v(n.data[n.t-1]);l>0?(n.lShiftTo(l,o),i.lShiftTo(l,r)):(n.copyTo(o),i.copyTo(r));var h=o.t,f=o.data[h-1];if(0!=f){var d=f*(1<<this.F1)+(h>1?o.data[h-2]>>this.F2:0),p=this.FV/d,g=(1<<this.F1)/d,y=1<<this.F2,m=r.t,b=m-h,_=null==t?s():t;for(o.dlShiftTo(b,_),r.compareTo(_)>=0&&(r.data[r.t++]=1,r.subTo(_,r)),a.ONE.dlShiftTo(h,_),_.subTo(o,o);o.t<h;)o.data[o.t++]=0;for(;--b>=0;){var w=r.data[--m]==f?this.DM:Math.floor(r.data[m]*p+(r.data[m-1]+y)*g);if((r.data[m]+=o.am(0,w,r,b,0,h))<w)for(o.dlShiftTo(b,_),r.subTo(_,r);r.data[m]<--w;)r.subTo(_,r)}null!=t&&(r.drShiftTo(h,t),u!=c&&a.ZERO.subTo(t,t)),r.t=h,r.clamp(),l>0&&r.rShiftTo(l,r),u<0&&a.ZERO.subTo(r,r)}}},a.prototype.invDigit=function(){if(this.t<1)return 0;var e=this.data[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},a.prototype.isEven=function(){return 0==(this.t>0?1&this.data[0]:this.s)},a.prototype.exp=function(e,t){if(e>4294967295||e<1)return a.ONE;var r=s(),n=s(),i=t.convert(this),o=v(e)-1;for(i.copyTo(r);--o>=0;)if(t.sqrTo(r,n),(e&1<<o)>0)t.mulTo(n,i,r);else{var u=r;r=n,n=u}return t.revert(r)},a.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,i=!1,a="",s=this.t,o=this.DB-s*this.DB%t;if(s-- >0)for(o<this.DB&&(r=this.data[s]>>o)>0&&(i=!0,a=f(r));s>=0;)o<t?(r=(this.data[s]&(1<<o)-1)<<t-o,r|=this.data[--s]>>(o+=this.DB-t)):(r=this.data[s]>>(o-=t)&n,o<=0&&(o+=this.DB,--s)),r>0&&(i=!0),i&&(a+=f(r));return i?a:"0"},a.prototype.negate=function(){var e=s();return a.ZERO.subTo(this,e),e},a.prototype.abs=function(){return this.s<0?this.negate():this},a.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this.data[r]-e.data[r]))return t;return 0},a.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+v(this.data[this.t-1]^this.s&this.DM)},a.prototype.mod=function(e){var t=s();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(a.ZERO)>0&&e.subTo(t,t),t},a.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new g(t):new y(t),this.exp(e,r)},a.ZERO=p(0),a.ONE=p(1),E.prototype.convert=S,E.prototype.revert=S,E.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},E.prototype.sqrTo=function(e,t){e.squareTo(t)},C.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=s();return e.copyTo(t),this.reduce(t),t},C.prototype.revert=function(e){return e},C.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},C.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},C.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var A=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],D=(1<<26)/A[A.length-1];a.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},a.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=p(r),i=s(),a=s(),o="";for(this.divRemTo(n,i,a);i.signum()>0;)o=(r+a.intValue()).toString(e).substr(1)+o,i.divRemTo(n,i,a);return a.intValue().toString(e)+o},a.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,s=0,o=0,u=0;u<e.length;++u){var c=d(e,u);c<0?"-"==e.charAt(u)&&0==this.signum()&&(i=!0):(o=t*o+c,++s>=r&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0))}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(o,0)),i&&a.ZERO.subTo(this,this)},a.prototype.fromNumber=function(e,t,r){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(a.ONE.shiftLeft(e-1),b,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(a.ONE.shiftLeft(e-1),this);else{var n=new Array,i=7&e;n.length=1+(e>>3),t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}},a.prototype.bitwiseTo=function(e,t,r){var n,i,a=Math.min(e.t,this.t);for(n=0;n<a;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(i=e.s&this.DM,n=a;n<this.t;++n)r.data[n]=t(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=a;n<e.t;++n)r.data[n]=t(i,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},a.prototype.changeBit=function(e,t){var r=a.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r},a.prototype.addTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()},a.prototype.dMultiply=function(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},a.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}},a.prototype.multiplyLowerTo=function(e,t,r){var n,i=Math.min(this.t+e.t,t);for(r.s=0,r.t=i;i>0;)r.data[--i]=0;for(n=r.t-this.t;i<n;++i)r.data[i+this.t]=this.am(0,e.data[i],r,i,0,this.t);for(n=Math.min(e.t,t);i<n;++i)this.am(0,e.data[i],r,i,0,t-i);r.clamp()},a.prototype.multiplyUpperTo=function(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},a.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r},a.prototype.millerRabin=function(e){var t=this.subtract(a.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n,i=t.shiftRight(r),s={nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(256*Math.random())}},o=0;o<e;++o){do{n=new a(this.bitLength(),s)}while(n.compareTo(a.ONE)<=0||n.compareTo(t)>=0);var u=n.modPow(i,this);if(0!=u.compareTo(a.ONE)&&0!=u.compareTo(t)){for(var c=1;c++<r&&0!=u.compareTo(t);)if(0==(u=u.modPowInt(2,this)).compareTo(a.ONE))return!1;if(0!=u.compareTo(t))return!1}}return!0},a.prototype.clone=function(){var e=s();return this.copyTo(e),e},a.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]},a.prototype.byteValue=function(){return 0==this.t?this.s:this.data[0]<<24>>24},a.prototype.shortValue=function(){return 0==this.t?this.s:this.data[0]<<16>>16},a.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1},a.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,i=0;if(e-- >0)for(n<this.DB&&(r=this.data[e]>>n)!=(this.s&this.DM)>>n&&(t[i++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this.data[e]&(1<<n)-1)<<8-n,r|=this.data[--e]>>(n+=this.DB-8)):(r=this.data[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(i>0||r!=this.s)&&(t[i++]=r);return t},a.prototype.equals=function(e){return 0==this.compareTo(e)},a.prototype.min=function(e){return this.compareTo(e)<0?this:e},a.prototype.max=function(e){return this.compareTo(e)>0?this:e},a.prototype.and=function(e){var t=s();return this.bitwiseTo(e,m,t),t},a.prototype.or=function(e){var t=s();return this.bitwiseTo(e,b,t),t},a.prototype.xor=function(e){var t=s();return this.bitwiseTo(e,_,t),t},a.prototype.andNot=function(e){var t=s();return this.bitwiseTo(e,w,t),t},a.prototype.not=function(){for(var e=s(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e},a.prototype.shiftLeft=function(e){var t=s();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},a.prototype.shiftRight=function(e){var t=s();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},a.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this.data[e])return e*this.DB+k(this.data[e]);return this.s<0?this.t*this.DB:-1},a.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=x(this.data[r]^t);return e},a.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this.data[t]&1<<e%this.DB)},a.prototype.setBit=function(e){return this.changeBit(e,b)},a.prototype.clearBit=function(e){return this.changeBit(e,w)},a.prototype.flipBit=function(e){return this.changeBit(e,_)},a.prototype.add=function(e){var t=s();return this.addTo(e,t),t},a.prototype.subtract=function(e){var t=s();return this.subTo(e,t),t},a.prototype.multiply=function(e){var t=s();return this.multiplyTo(e,t),t},a.prototype.divide=function(e){var t=s();return this.divRemTo(e,t,null),t},a.prototype.remainder=function(e){var t=s();return this.divRemTo(e,null,t),t},a.prototype.divideAndRemainder=function(e){var t=s(),r=s();return this.divRemTo(e,t,r),new Array(t,r)},a.prototype.modPow=function(e,t){var r,n,i=e.bitLength(),a=p(1);if(i<=0)return a;r=i<18?1:i<48?3:i<144?4:i<768?5:6,n=i<8?new g(t):t.isEven()?new C(t):new y(t);var o=new Array,u=3,c=r-1,l=(1<<r)-1;if(o[1]=n.convert(this),r>1){var h=s();for(n.sqrTo(o[1],h);u<=l;)o[u]=s(),n.mulTo(h,o[u-2],o[u]),u+=2}var f,d,m=e.t-1,b=!0,_=s();for(i=v(e.data[m])-1;m>=0;){for(i>=c?f=e.data[m]>>i-c&l:(f=(e.data[m]&(1<<i+1)-1)<<c-i,m>0&&(f|=e.data[m-1]>>this.DB+i-c)),u=r;0==(1&f);)f>>=1,--u;if((i-=u)<0&&(i+=this.DB,--m),b)o[f].copyTo(a),b=!1;else{for(;u>1;)n.sqrTo(a,_),n.sqrTo(_,a),u-=2;u>0?n.sqrTo(a,_):(d=a,a=_,_=d),n.mulTo(_,o[f],a)}for(;m>=0&&0==(e.data[m]&1<<i);)n.sqrTo(a,_),d=a,a=_,_=d,--i<0&&(i=this.DB-1,--m)}return n.revert(a)},a.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return a.ZERO;for(var r=e.clone(),n=this.clone(),i=p(1),s=p(0),o=p(0),u=p(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(i.isEven()&&s.isEven()||(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),t?(o.isEven()&&u.isEven()||(o.addTo(this,o),u.subTo(e,u)),o.rShiftTo(1,o)):u.isEven()||u.subTo(e,u),u.rShiftTo(1,u);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(o,i),s.subTo(u,s)):(n.subTo(r,n),t&&o.subTo(i,o),u.subTo(s,u))}return 0!=n.compareTo(a.ONE)?a.ZERO:u.compareTo(e)>=0?u.subtract(e):u.signum()<0?(u.addTo(e,u),u.signum()<0?u.add(e):u):u},a.prototype.pow=function(e){return this.exp(e,new E)},a.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),a=r.getLowestSetBit();if(a<0)return t;for(i<a&&(a=i),a>0&&(t.rShiftTo(a,t),r.rShiftTo(a,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return a>0&&r.lShiftTo(a,r),r},a.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r.data[0]<=A[A.length-1]){for(t=0;t<A.length;++t)if(r.data[0]==A[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<A.length;){for(var n=A[t],i=t+1;i<A.length&&n<D;)n*=A[i++];for(n=r.modInt(n);t<i;)if(n%A[t++]==0)return!1}return r.millerRabin(e)}},29:function(e,t,r){var n=r(392);e.exports=n.md=n.md||{},n.md.algorithms=n.md.algorithms||{}},2886:function(e,t,r){var n=r(392);n.pki=n.pki||{};var i=e.exports=n.pki.oids=n.oids=n.oids||{};function a(e,t){i[e]=t,i[t]=e}function s(e,t){i[e]=t}a("1.2.840.113549.1.1.1","rsaEncryption"),a("1.2.840.113549.1.1.4","md5WithRSAEncryption"),a("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),a("1.2.840.113549.1.1.7","RSAES-OAEP"),a("1.2.840.113549.1.1.8","mgf1"),a("1.2.840.113549.1.1.9","pSpecified"),a("1.2.840.113549.1.1.10","RSASSA-PSS"),a("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),a("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),a("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),a("1.3.101.112","EdDSA25519"),a("1.2.840.10040.4.3","dsa-with-sha1"),a("1.3.14.3.2.7","desCBC"),a("1.3.14.3.2.26","sha1"),a("1.3.14.3.2.29","sha1WithRSASignature"),a("2.16.840.1.101.3.4.2.1","sha256"),a("2.16.840.1.101.3.4.2.2","sha384"),a("2.16.840.1.101.3.4.2.3","sha512"),a("2.16.840.1.101.3.4.2.4","sha224"),a("2.16.840.1.101.3.4.2.5","sha512-224"),a("2.16.840.1.101.3.4.2.6","sha512-256"),a("1.2.840.113549.2.2","md2"),a("1.2.840.113549.2.5","md5"),a("1.2.840.113549.1.7.1","data"),a("1.2.840.113549.1.7.2","signedData"),a("1.2.840.113549.1.7.3","envelopedData"),a("1.2.840.113549.1.7.4","signedAndEnvelopedData"),a("1.2.840.113549.1.7.5","digestedData"),a("1.2.840.113549.1.7.6","encryptedData"),a("1.2.840.113549.1.9.1","emailAddress"),a("1.2.840.113549.1.9.2","unstructuredName"),a("1.2.840.113549.1.9.3","contentType"),a("1.2.840.113549.1.9.4","messageDigest"),a("1.2.840.113549.1.9.5","signingTime"),a("1.2.840.113549.1.9.6","counterSignature"),a("1.2.840.113549.1.9.7","challengePassword"),a("1.2.840.113549.1.9.8","unstructuredAddress"),a("1.2.840.113549.1.9.14","extensionRequest"),a("1.2.840.113549.1.9.20","friendlyName"),a("1.2.840.113549.1.9.21","localKeyId"),a("1.2.840.113549.1.9.22.1","x509Certificate"),a("1.2.840.113549.1.12.10.1.1","keyBag"),a("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),a("1.2.840.113549.1.12.10.1.3","certBag"),a("1.2.840.113549.1.12.10.1.4","crlBag"),a("1.2.840.113549.1.12.10.1.5","secretBag"),a("1.2.840.113549.1.12.10.1.6","safeContentsBag"),a("1.2.840.113549.1.5.13","pkcs5PBES2"),a("1.2.840.113549.1.5.12","pkcs5PBKDF2"),a("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),a("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),a("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),a("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),a("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),a("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),a("1.2.840.113549.2.7","hmacWithSHA1"),a("1.2.840.113549.2.8","hmacWithSHA224"),a("1.2.840.113549.2.9","hmacWithSHA256"),a("1.2.840.113549.2.10","hmacWithSHA384"),a("1.2.840.113549.2.11","hmacWithSHA512"),a("1.2.840.113549.3.7","des-EDE3-CBC"),a("2.16.840.1.101.3.4.1.2","aes128-CBC"),a("2.16.840.1.101.3.4.1.22","aes192-CBC"),a("2.16.840.1.101.3.4.1.42","aes256-CBC"),a("2.5.4.3","commonName"),a("2.5.4.4","surname"),a("2.5.4.5","serialNumber"),a("2.5.4.6","countryName"),a("2.5.4.7","localityName"),a("2.5.4.8","stateOrProvinceName"),a("2.5.4.9","streetAddress"),a("2.5.4.10","organizationName"),a("2.5.4.11","organizationalUnitName"),a("2.5.4.12","title"),a("2.5.4.13","description"),a("2.5.4.15","businessCategory"),a("2.5.4.17","postalCode"),a("2.5.4.42","givenName"),a("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),a("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),a("2.16.840.1.113730.1.1","nsCertType"),a("2.16.840.1.113730.1.13","nsComment"),s("2.5.29.1","authorityKeyIdentifier"),s("2.5.29.2","keyAttributes"),s("2.5.29.3","certificatePolicies"),s("2.5.29.4","keyUsageRestriction"),s("2.5.29.5","policyMapping"),s("2.5.29.6","subtreesConstraint"),s("2.5.29.7","subjectAltName"),s("2.5.29.8","issuerAltName"),s("2.5.29.9","subjectDirectoryAttributes"),s("2.5.29.10","basicConstraints"),s("2.5.29.11","nameConstraints"),s("2.5.29.12","policyConstraints"),s("2.5.29.13","basicConstraints"),a("2.5.29.14","subjectKeyIdentifier"),a("2.5.29.15","keyUsage"),s("2.5.29.16","privateKeyUsagePeriod"),a("2.5.29.17","subjectAltName"),a("2.5.29.18","issuerAltName"),a("2.5.29.19","basicConstraints"),s("2.5.29.20","cRLNumber"),s("2.5.29.21","cRLReason"),s("2.5.29.22","expirationDate"),s("2.5.29.23","instructionCode"),s("2.5.29.24","invalidityDate"),s("2.5.29.25","cRLDistributionPoints"),s("2.5.29.26","issuingDistributionPoint"),s("2.5.29.27","deltaCRLIndicator"),s("2.5.29.28","issuingDistributionPoint"),s("2.5.29.29","certificateIssuer"),s("2.5.29.30","nameConstraints"),a("2.5.29.31","cRLDistributionPoints"),a("2.5.29.32","certificatePolicies"),s("2.5.29.33","policyMappings"),s("2.5.29.34","policyConstraints"),a("2.5.29.35","authorityKeyIdentifier"),s("2.5.29.36","policyConstraints"),a("2.5.29.37","extKeyUsage"),s("2.5.29.46","freshestCRL"),s("2.5.29.54","inhibitAnyPolicy"),a("1.3.6.1.4.1.11129.2.4.2","timestampList"),a("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),a("1.3.6.1.5.5.7.3.1","serverAuth"),a("1.3.6.1.5.5.7.3.2","clientAuth"),a("1.3.6.1.5.5.7.3.3","codeSigning"),a("1.3.6.1.5.5.7.3.4","emailProtection"),a("1.3.6.1.5.5.7.3.8","timeStamping")},9835:function(e,t,r){var n=r(392);if(r(8605),r(5049),r(1400),r(29),r(2886),r(6019),r(6193),r(3860),r(654),r(5493),r(3877),"undefined"===typeof i)var i=n.jsbn.BigInteger;var a=n.asn1,s=n.pki=n.pki||{};e.exports=s.pbe=n.pbe=n.pbe||{};var o=s.oids,u={name:"EncryptedPrivateKeyInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},c={name:"PBES2Algorithms",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},l={name:"pkcs-12PbeParams",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"iterations"}]};function h(e,t){return e.start().update(t).digest().getBytes()}function f(e){var t;if(e){if(!(t=s.oids[a.derToOid(e)])){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}}else t="hmacWithSHA1";return d(t)}function d(e){var t=n.md;switch(e){case"hmacWithSHA224":t=n.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}s.encryptPrivateKeyInfo=function(e,t,r){(r=r||{}).saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var i,u,c,l=n.random.getBytesSync(r.saltSize),h=r.count,f=a.integerToDer(h);if(0===r.algorithm.indexOf("aes")||"des"===r.algorithm){var p,v,g;switch(r.algorithm){case"aes128":i=16,p=16,v=o["aes128-CBC"],g=n.aes.createEncryptionCipher;break;case"aes192":i=24,p=16,v=o["aes192-CBC"],g=n.aes.createEncryptionCipher;break;case"aes256":i=32,p=16,v=o["aes256-CBC"],g=n.aes.createEncryptionCipher;break;case"des":i=8,p=8,v=o.desCBC,g=n.des.createEncryptionCipher;break;default:throw(k=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=r.algorithm,k}var y="hmacWith"+r.prfAlgorithm.toUpperCase(),m=d(y),b=n.pkcs5.pbkdf2(t,l,h,i,m),_=n.random.getBytesSync(p);(x=g(b)).start(_),x.update(a.toDer(e)),x.finish(),c=x.output.getBytes();var w=function(e,t,r,i){var o=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,e),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,t.getBytes())]);"hmacWithSHA1"!==i&&o.value.push(a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,n.util.hexToBytes(r.toString(16))),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s.oids[i]).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.NULL,!1,"")]));return o}(l,f,i,y);u=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(o.pkcs5PBES2).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(o.pkcs5PBKDF2).getBytes()),w]),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(v).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,_)])])])}else{var k;if("3des"!==r.algorithm)throw(k=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=r.algorithm,k;i=24;var x,E=new n.util.ByteBuffer(l);b=s.pbe.generatePkcs12Key(t,E,1,h,i),_=s.pbe.generatePkcs12Key(t,E,2,h,i);(x=n.des.createEncryptionCipher(b)).start(_),x.update(a.toDer(e)),x.finish(),c=x.output.getBytes(),u=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(o["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,l),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,f.getBytes())])])}return a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[u,a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,c)])},s.decryptPrivateKeyInfo=function(e,t){var r=null,i={},o=[];if(!a.validate(e,u,i,o)){var c=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw c.errors=o,c}var l=a.derToOid(i.encryptionOid),h=s.pbe.getCipher(l,i.encryptionParams,t),f=n.util.createBuffer(i.encryptedData);return h.update(f),h.finish()&&(r=a.fromDer(h.output)),r},s.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:a.toDer(e).getBytes()};return n.pem.encode(r,{maxline:t})},s.encryptedPrivateKeyFromPem=function(e){var t=n.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==t.type){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return a.fromDer(t.body)},s.encryptRsaPrivateKey=function(e,t,r){if(!(r=r||{}).legacy){var i=s.wrapRsaPrivateKey(s.privateKeyToAsn1(e));return i=s.encryptPrivateKeyInfo(i,t,r),s.encryptedPrivateKeyToPem(i)}var o,u,c,l;switch(r.algorithm){case"aes128":o="AES-128-CBC",c=16,u=n.random.getBytesSync(16),l=n.aes.createEncryptionCipher;break;case"aes192":o="AES-192-CBC",c=24,u=n.random.getBytesSync(16),l=n.aes.createEncryptionCipher;break;case"aes256":o="AES-256-CBC",c=32,u=n.random.getBytesSync(16),l=n.aes.createEncryptionCipher;break;case"3des":o="DES-EDE3-CBC",c=24,u=n.random.getBytesSync(8),l=n.des.createEncryptionCipher;break;case"des":o="DES-CBC",c=8,u=n.random.getBytesSync(8),l=n.des.createEncryptionCipher;break;default:var h=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw h.algorithm=r.algorithm,h}var f=l(n.pbe.opensslDeriveBytes(t,u.substr(0,8),c));f.start(u),f.update(a.toDer(s.privateKeyToAsn1(e))),f.finish();var d={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:o,parameters:n.util.bytesToHex(u).toUpperCase()},body:f.output.getBytes()};return n.pem.encode(d)},s.decryptRsaPrivateKey=function(e,t){var r=null,i=n.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==i.type&&"PRIVATE KEY"!==i.type&&"RSA PRIVATE KEY"!==i.type)throw(c=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".')).headerType=c,c;if(i.procType&&"ENCRYPTED"===i.procType.type){var o,u;switch(i.dekInfo.algorithm){case"DES-CBC":o=8,u=n.des.createDecryptionCipher;break;case"DES-EDE3-CBC":o=24,u=n.des.createDecryptionCipher;break;case"AES-128-CBC":o=16,u=n.aes.createDecryptionCipher;break;case"AES-192-CBC":o=24,u=n.aes.createDecryptionCipher;break;case"AES-256-CBC":o=32,u=n.aes.createDecryptionCipher;break;case"RC2-40-CBC":o=5,u=function(e){return n.rc2.createDecryptionCipher(e,40)};break;case"RC2-64-CBC":o=8,u=function(e){return n.rc2.createDecryptionCipher(e,64)};break;case"RC2-128-CBC":o=16,u=function(e){return n.rc2.createDecryptionCipher(e,128)};break;default:var c;throw(c=new Error('Could not decrypt private key; unsupported encryption algorithm "'+i.dekInfo.algorithm+'".')).algorithm=i.dekInfo.algorithm,c}var l=n.util.hexToBytes(i.dekInfo.parameters),h=u(n.pbe.opensslDeriveBytes(t,l.substr(0,8),o));if(h.start(l),h.update(n.util.createBuffer(i.body)),!h.finish())return r;r=h.output.getBytes()}else r=i.body;return null!==(r="ENCRYPTED PRIVATE KEY"===i.type?s.decryptPrivateKeyInfo(a.fromDer(r),t):a.fromDer(r))&&(r=s.privateKeyFromAsn1(r)),r},s.pbe.generatePkcs12Key=function(e,t,r,i,a,s){var o,u;if("undefined"===typeof s||null===s){if(!("sha1"in n.md))throw new Error('"sha1" hash algorithm unavailable.');s=n.md.sha1.create()}var c=s.digestLength,l=s.blockLength,h=new n.util.ByteBuffer,f=new n.util.ByteBuffer;if(null!==e&&void 0!==e){for(u=0;u<e.length;u++)f.putInt16(e.charCodeAt(u));f.putInt16(0)}var d=f.length(),p=t.length(),v=new n.util.ByteBuffer;v.fillWithByte(r,l);var g=l*Math.ceil(p/l),y=new n.util.ByteBuffer;for(u=0;u<g;u++)y.putByte(t.at(u%p));var m=l*Math.ceil(d/l),b=new n.util.ByteBuffer;for(u=0;u<m;u++)b.putByte(f.at(u%d));var _=y;_.putBuffer(b);for(var w=Math.ceil(a/c),k=1;k<=w;k++){var x=new n.util.ByteBuffer;x.putBytes(v.bytes()),x.putBytes(_.bytes());for(var E=0;E<i;E++)s.start(),s.update(x.getBytes()),x=s.digest();var S=new n.util.ByteBuffer;for(u=0;u<l;u++)S.putByte(x.at(u%c));var C=Math.ceil(p/l)+Math.ceil(d/l),A=new n.util.ByteBuffer;for(o=0;o<C;o++){var D=new n.util.ByteBuffer(_.getBytes(l)),R=511;for(u=S.length()-1;u>=0;u--)R>>=8,R+=S.at(u)+D.at(u),D.setAt(u,255&R);A.putBuffer(D)}_=A,h.putBuffer(x)}return h.truncate(h.length()-a),h},s.pbe.getCipher=function(e,t,r){switch(e){case s.oids.pkcs5PBES2:return s.pbe.getCipherForPBES2(e,t,r);case s.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case s.oids["pbewithSHAAnd40BitRC2-CBC"]:return s.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}},s.pbe.getCipherForPBES2=function(e,t,r){var i,o={},u=[];if(!a.validate(t,c,o,u))throw(i=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=u,i;if((e=a.derToOid(o.kdfOid))!==s.oids.pkcs5PBKDF2)throw(i=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.")).oid=e,i.supportedOids=["pkcs5PBKDF2"],i;if((e=a.derToOid(o.encOid))!==s.oids["aes128-CBC"]&&e!==s.oids["aes192-CBC"]&&e!==s.oids["aes256-CBC"]&&e!==s.oids["des-EDE3-CBC"]&&e!==s.oids.desCBC)throw(i=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.")).oid=e,i.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],i;var l,h,d=o.kdfSalt,p=n.util.createBuffer(o.kdfIterationCount);switch(p=p.getInt(p.length()<<3),s.oids[e]){case"aes128-CBC":l=16,h=n.aes.createDecryptionCipher;break;case"aes192-CBC":l=24,h=n.aes.createDecryptionCipher;break;case"aes256-CBC":l=32,h=n.aes.createDecryptionCipher;break;case"des-EDE3-CBC":l=24,h=n.des.createDecryptionCipher;break;case"desCBC":l=8,h=n.des.createDecryptionCipher}var v=f(o.prfOid),g=n.pkcs5.pbkdf2(r,d,p,l,v),y=o.encIv,m=h(g);return m.start(y),m},s.pbe.getCipherForPKCS12PBE=function(e,t,r){var i={},o=[];if(!a.validate(t,l,i,o))throw(v=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=o,v;var u,c,h,d=n.util.createBuffer(i.salt),p=n.util.createBuffer(i.iterations);switch(p=p.getInt(p.length()<<3),e){case s.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:u=24,c=8,h=n.des.startDecrypting;break;case s.oids["pbewithSHAAnd40BitRC2-CBC"]:u=5,c=8,h=function(e,t){var r=n.rc2.createDecryptionCipher(e,40);return r.start(t,null),r};break;default:var v;throw(v=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.")).oid=e,v}var g=f(i.prfOid),y=s.pbe.generatePkcs12Key(r,d,1,p,u,g);return g.start(),h(y,s.pbe.generatePkcs12Key(r,d,2,p,c,g))},s.pbe.opensslDeriveBytes=function(e,t,r,i){if("undefined"===typeof i||null===i){if(!("md5"in n.md))throw new Error('"md5" hash algorithm unavailable.');i=n.md.md5.create()}null===t&&(t="");for(var a=[h(i,e+t)],s=16,o=1;s<r;++o,s+=16)a.push(h(i,a[o-1]+e+t));return a.join("").substr(0,r)}},6019:function(e,t,r){var n=r(2678).Buffer,i=r(392);r(878),r(29),r(3877);var a,s=i.pkcs5=i.pkcs5||{};i.util.isNodejs&&!i.options.usePureJavaScript&&(a=r(5819)),e.exports=i.pbkdf2=s.pbkdf2=function(e,t,r,s,o,u){if("function"===typeof o&&(u=o,o=null),i.util.isNodejs&&!i.options.usePureJavaScript&&a.pbkdf2&&(null===o||"object"!==typeof o)&&(a.pbkdf2Sync.length>4||!o||"sha1"===o))return"string"!==typeof o&&(o="sha1"),e=n.from(e,"binary"),t=n.from(t,"binary"),u?4===a.pbkdf2Sync.length?a.pbkdf2(e,t,r,s,(function(e,t){if(e)return u(e);u(null,t.toString("binary"))})):a.pbkdf2(e,t,r,s,o,(function(e,t){if(e)return u(e);u(null,t.toString("binary"))})):4===a.pbkdf2Sync.length?a.pbkdf2Sync(e,t,r,s).toString("binary"):a.pbkdf2Sync(e,t,r,s,o).toString("binary");if("undefined"!==typeof o&&null!==o||(o="sha1"),"string"===typeof o){if(!(o in i.md.algorithms))throw new Error("Unknown hash algorithm: "+o);o=i.md[o].create()}var c=o.digestLength;if(s>4294967295*c){var l=new Error("Derived key is too long.");if(u)return u(l);throw l}var h=Math.ceil(s/c),f=s-(h-1)*c,d=i.hmac.create();d.start(o,e);var p,v,g,y="";if(!u){for(var m=1;m<=h;++m){d.start(null,null),d.update(t),d.update(i.util.int32ToBytes(m)),p=g=d.digest().getBytes();for(var b=2;b<=r;++b)d.start(null,null),d.update(g),v=d.digest().getBytes(),p=i.util.xorBytes(p,v,c),g=v;y+=m<h?p:p.substr(0,f)}return y}m=1;function _(){if(m>h)return u(null,y);d.start(null,null),d.update(t),d.update(i.util.int32ToBytes(m)),p=g=d.digest().getBytes(),b=2,w()}function w(){if(b<=r)return d.start(null,null),d.update(g),v=d.digest().getBytes(),p=i.util.xorBytes(p,v,c),g=v,++b,i.util.setImmediate(w);y+=m<h?p:p.substr(0,f),++m,_()}_()}},6193:function(e,t,r){var n=r(392);r(3877);var i=e.exports=n.pem=n.pem||{};function a(e){for(var t=e.name+": ",r=[],n=function(e,t){return" "+t},i=0;i<e.values.length;++i)r.push(e.values[i].replace(/^(\S+\r\n)/,n));t+=r.join(",")+"\r\n";var a=0,s=-1;for(i=0;i<t.length;++i,++a)if(a>65&&-1!==s){var o=t[s];","===o?(++s,t=t.substr(0,s)+"\r\n "+t.substr(s)):t=t.substr(0,s)+"\r\n"+o+t.substr(s+1),a=i-s-1,s=-1,++i}else" "!==t[i]&&"\t"!==t[i]&&","!==t[i]||(s=i);return t}function s(e){return e.replace(/^\s+/,"")}i.encode=function(e,t){t=t||{};var r,i="-----BEGIN "+e.type+"-----\r\n";if(e.procType&&(i+=a(r={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]})),e.contentDomain&&(i+=a(r={name:"Content-Domain",values:[e.contentDomain]})),e.dekInfo&&(r={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&r.values.push(e.dekInfo.parameters),i+=a(r)),e.headers)for(var s=0;s<e.headers.length;++s)i+=a(e.headers[s]);return e.procType&&(i+="\r\n"),i+=n.util.encode64(e.body,t.maxline||64)+"\r\n",i+="-----END "+e.type+"-----\r\n"},i.decode=function(e){for(var t,r=[],i=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,a=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,o=/\r?\n/;t=i.exec(e);){var u=t[1];"NEW CERTIFICATE REQUEST"===u&&(u="CERTIFICATE REQUEST");var c={type:u,procType:null,contentDomain:null,dekInfo:null,headers:[],body:n.util.decode64(t[3])};if(r.push(c),t[2]){for(var l=t[2].split(o),h=0;t&&h<l.length;){for(var f=l[h].replace(/\s+$/,""),d=h+1;d<l.length;++d){var p=l[d];if(!/\s/.test(p[0]))break;f+=p,h=d}if(t=f.match(a)){for(var v={name:t[1],values:[]},g=t[2].split(","),y=0;y<g.length;++y)v.values.push(s(g[y]));if(c.procType)if(c.contentDomain||"Content-Domain"!==v.name)if(c.dekInfo||"DEK-Info"!==v.name)c.headers.push(v);else{if(0===v.values.length)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');c.dekInfo={algorithm:g[0],parameters:g[1]||null}}else c.contentDomain=g[0]||"";else{if("Proc-Type"!==v.name)throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==v.values.length)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');c.procType={version:g[0],type:g[1]}}}++h}if("ENCRYPTED"===c.procType&&!c.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(0===r.length)throw new Error("Invalid PEM formatted message.");return r}},2627:function(e,t,r){var n=r(392);r(3877),r(3860),r(928);var i=e.exports=n.pkcs1=n.pkcs1||{};function a(e,t,r){r||(r=n.md.sha1.create());for(var i="",a=Math.ceil(t/r.digestLength),s=0;s<a;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,255&s);r.start(),r.update(e+o),i+=r.digest().getBytes()}return i.substring(0,t)}i.encode_rsa_oaep=function(e,t,r){var i,s,o,u;"string"===typeof r?(i=r,s=arguments[3]||void 0,o=arguments[4]||void 0):r&&(i=r.label||void 0,s=r.seed||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(u=r.mgf1.md)),o?o.start():o=n.md.sha1.create(),u||(u=o);var c=Math.ceil(e.n.bitLength()/8),l=c-2*o.digestLength-2;if(t.length>l)throw(g=new Error("RSAES-OAEP input message length is too long.")).length=t.length,g.maxLength=l,g;i||(i=""),o.update(i,"raw");for(var h=o.digest(),f="",d=l-t.length,p=0;p<d;p++)f+="\0";var v=h.getBytes()+f+"\x01"+t;if(s){if(s.length!==o.digestLength){var g;throw(g=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.")).seedLength=s.length,g.digestLength=o.digestLength,g}}else s=n.random.getBytes(o.digestLength);var y=a(s,c-o.digestLength-1,u),m=n.util.xorBytes(v,y,v.length),b=a(m,o.digestLength,u);return"\0"+n.util.xorBytes(s,b,s.length)+m},i.decode_rsa_oaep=function(e,t,r){var i,s,o;"string"===typeof r?(i=r,s=arguments[3]||void 0):r&&(i=r.label||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md));var u=Math.ceil(e.n.bitLength()/8);if(t.length!==u)throw(y=new Error("RSAES-OAEP encoded message length is invalid.")).length=t.length,y.expectedLength=u,y;if(void 0===s?s=n.md.sha1.create():s.start(),o||(o=s),u<2*s.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");i||(i=""),s.update(i,"raw");for(var c=s.digest().getBytes(),l=t.charAt(0),h=t.substring(1,s.digestLength+1),f=t.substring(1+s.digestLength),d=a(f,s.digestLength,o),p=a(n.util.xorBytes(h,d,h.length),u-s.digestLength-1,o),v=n.util.xorBytes(f,p,f.length),g=v.substring(0,s.digestLength),y="\0"!==l,m=0;m<s.digestLength;++m)y|=c.charAt(m)!==g.charAt(m);for(var b=1,_=s.digestLength,w=s.digestLength;w<v.length;w++){var k=v.charCodeAt(w);y|=k&(b?65534:0),_+=b&=1&k^1}if(y||1!==v.charCodeAt(_))throw new Error("Invalid RSAES-OAEP padding.");return v.substring(_+1)}},5132:function(e,t,r){var n=r(392);r(3877),r(3055),r(3860),function(){if(n.prime)e.exports=n.prime;else{var t=e.exports=n.prime=n.prime||{},r=n.jsbn.BigInteger,i=[6,4,2,4,2,4,6,2],a=new r(null);a.fromInt(30);var s=function(e,t){return e|t};t.generateProbablePrime=function(e,t,i){"function"===typeof t&&(i=t,t={});var a=(t=t||{}).algorithm||"PRIMEINC";"string"===typeof a&&(a={name:a}),a.options=a.options||{};var s=t.prng||n.random,u={nextBytes:function(e){for(var t=s.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}};if("PRIMEINC"===a.name)return function(e,t,i,a){if("workers"in i)return function(e,t,i,a){if("undefined"===typeof Worker)return o(e,t,i,a);var s=c(e,t),u=i.workers,l=i.workLoad||100,h=30*l/8,f=i.workerScript||"forge/prime.worker.js";if(-1===u)return n.util.estimateCores((function(e,t){e&&(t=2),u=t-1,d()}));function d(){u=Math.max(1,u);for(var n=[],i=0;i<u;++i)n[i]=new Worker(f);for(i=0;i<u;++i)n[i].addEventListener("message",d);var o=!1;function d(i){if(!o){0;var u=i.data;if(u.found){for(var f=0;f<n.length;++f)n[f].terminate();return o=!0,a(null,new r(u.prime,16))}s.bitLength()>e&&(s=c(e,t));var d=s.toString(16);i.target.postMessage({hex:d,workLoad:l}),s.dAddOffset(h,0)}}}d()}(e,t,i,a);return o(e,t,i,a)}(e,u,a.options,i);throw new Error("Invalid prime generation algorithm: "+a.name)}}function o(e,t,r,n){var i=c(e,t),a=function(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}(i.bitLength());"millerRabinTests"in r&&(a=r.millerRabinTests);var s=10;"maxBlockTime"in r&&(s=r.maxBlockTime),u(i,e,t,0,a,s,n)}function u(e,t,r,a,s,o,l){var h=+new Date;do{if(e.bitLength()>t&&(e=c(t,r)),e.isProbablePrime(s))return l(null,e);e.dAddOffset(i[a++%8],0)}while(o<0||+new Date-h<o);n.util.setImmediate((function(){u(e,t,r,a,s,o,l)}))}function c(e,t){var n=new r(e,t),i=e-1;return n.testBit(i)||n.bitwiseTo(r.ONE.shiftLeft(i),s,n),n.dAddOffset(31-n.mod(a).byteValue(),0),n}}()},6140:function(e,t,r){var n=r(1426),i=r(392);r(3877);var a=null;!i.util.isNodejs||i.options.usePureJavaScript||n.versions["node-webkit"]||(a=r(5819)),(e.exports=i.prng=i.prng||{}).create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,n=new Array(32),s=0;s<32;++s)n[s]=r.create();function o(){if(t.pools[0].messageLength>=32)return u();var e=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(e)),u()}function u(){t.reseeds=4294967295===t.reseeds?0:t.reseeds+1;var e=t.plugin.md.create();e.update(t.keyBytes);for(var r=1,n=0;n<32;++n)t.reseeds%r===0&&(e.update(t.pools[n].digest().getBytes()),t.pools[n].start()),r<<=1;t.keyBytes=e.digest().getBytes(),e.start(),e.update(t.keyBytes);var i=e.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(i),t.generated=0}function c(e){var t=null,r=i.util.globalScope,n=r.crypto||r.msCrypto;n&&n.getRandomValues&&(t=function(e){return n.getRandomValues(e)});var a=i.util.createBuffer();if(t)for(;a.length()<e;){var s=Math.max(1,Math.min(e-a.length(),65536)/4),o=new Uint32Array(Math.floor(s));try{t(o);for(var u=0;u<o.length;++u)a.putInt32(o[u])}catch(d){if(!("undefined"!==typeof QuotaExceededError&&d instanceof QuotaExceededError))throw d}}if(a.length()<e)for(var c,l,h,f=Math.floor(65536*Math.random());a.length()<e;){l=16807*(65535&f),l+=(32767&(c=16807*(f>>16)))<<16,f=4294967295&(l=(2147483647&(l+=c>>15))+(l>>31));for(u=0;u<3;++u)h=f>>>(u<<3),h^=Math.floor(256*Math.random()),a.putByte(255&h)}return a.getBytes(e)}return t.pools=n,t.pool=0,t.generate=function(e,r){if(!r)return t.generateSync(e);var n=t.plugin.cipher,a=t.plugin.increment,s=t.plugin.formatKey,o=t.plugin.formatSeed,c=i.util.createBuffer();t.key=null,function l(h){if(h)return r(h);if(c.length()>=e)return r(null,c.getBytes(e));t.generated>1048575&&(t.key=null);if(null===t.key)return i.util.nextTick((function(){!function(e){if(t.pools[0].messageLength>=32)return u(),e();var r=32-t.pools[0].messageLength<<5;t.seedFile(r,(function(r,n){if(r)return e(r);t.collect(n),u(),e()}))}(l)}));var f=n(t.key,t.seed);t.generated+=f.length,c.putBytes(f),t.key=s(n(t.key,a(t.seed))),t.seed=o(n(t.key,t.seed)),i.util.setImmediate(l)}()},t.generateSync=function(e){var r=t.plugin.cipher,n=t.plugin.increment,a=t.plugin.formatKey,s=t.plugin.formatSeed;t.key=null;for(var u=i.util.createBuffer();u.length()<e;){t.generated>1048575&&(t.key=null),null===t.key&&o();var c=r(t.key,t.seed);t.generated+=c.length,u.putBytes(c),t.key=a(r(t.key,n(t.seed))),t.seed=s(r(t.key,t.seed))}return u.getBytes(e)},a?(t.seedFile=function(e,t){a.randomBytes(e,(function(e,r){if(e)return t(e);t(null,r.toString())}))},t.seedFileSync=function(e){return a.randomBytes(e).toString()}):(t.seedFile=function(e,t){try{t(null,c(e))}catch(r){t(r)}},t.seedFileSync=c),t.collect=function(e){for(var r=e.length,n=0;n<r;++n)t.pools[t.pool].update(e.substr(n,1)),t.pool=31===t.pool?0:t.pool+1},t.collectInt=function(e,r){for(var n="",i=0;i<r;i+=8)n+=String.fromCharCode(e>>i&255);t.collect(n)},t.registerWorker=function(e){if(e===self)t.seedFile=function(e,t){self.addEventListener("message",(function e(r){var n=r.data;n.forge&&n.forge.prng&&(self.removeEventListener("message",e),t(n.forge.prng.err,n.forge.prng.bytes))})),self.postMessage({forge:{prng:{needed:e}}})};else{e.addEventListener("message",(function(r){var n=r.data;n.forge&&n.forge.prng&&t.seedFile(n.forge.prng.needed,(function(t,r){e.postMessage({forge:{prng:{err:t,bytes:r}}})}))}))}},t}},3860:function(e,t,r){var n=r(392);r(8605),r(7404),r(6140),r(3877),n.random&&n.random.getBytes?e.exports=n.random:function(t){var r={},i=new Array(4),a=n.util.createBuffer();function s(){var e=n.prng.create(r);return e.getBytes=function(t,r){return e.generate(t,r)},e.getBytesSync=function(t){return e.generate(t)},e}r.formatKey=function(e){var t=n.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),n.aes._expandKey(e,!1)},r.formatSeed=function(e){var t=n.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),e},r.cipher=function(e,t){return n.aes._updateBlock(e,t,i,!1),a.putInt32(i[0]),a.putInt32(i[1]),a.putInt32(i[2]),a.putInt32(i[3]),a.getBytes()},r.increment=function(e){return++e[3],e},r.md=n.md.sha256;var o=s(),u=null,c=n.util.globalScope,l=c.crypto||c.msCrypto;if(l&&l.getRandomValues&&(u=function(e){return l.getRandomValues(e)}),n.options.usePureJavaScript||!n.util.isNodejs&&!u){if("undefined"===typeof window||window.document,o.collectInt(+new Date,32),"undefined"!==typeof navigator){var h="";for(var f in navigator)try{"string"==typeof navigator[f]&&(h+=navigator[f])}catch(d){}o.collect(h),h=null}t&&(t().mousemove((function(e){o.collectInt(e.clientX,16),o.collectInt(e.clientY,16)})),t().keypress((function(e){o.collectInt(e.charCode,8)})))}if(n.random)for(var f in o)n.random[f]=o[f];else n.random=o;n.random.createInstance=s,e.exports=n.random}("undefined"!==typeof jQuery?jQuery:null)},654:function(e,t,r){var n=r(392);r(3877);var i=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],a=[1,2,3,5],s=function(e,t){return e<<t&65535|(65535&e)>>16-t},o=function(e,t){return(65535&e)>>t|e<<16-t&65535};e.exports=n.rc2=n.rc2||{},n.rc2.expandKey=function(e,t){"string"===typeof e&&(e=n.util.createBuffer(e)),t=t||128;var r,a=e,s=e.length(),o=t,u=Math.ceil(o/8),c=255>>(7&o);for(r=s;r<128;r++)a.putByte(i[a.at(r-1)+a.at(r-s)&255]);for(a.setAt(128-u,i[a.at(128-u)&c]),r=127-u;r>=0;r--)a.setAt(r,i[a.at(r+1)^a.at(r+u)]);return a};var u=function(e,t,r){var i,u,c,l,h=!1,f=null,d=null,p=null,v=[];for(e=n.rc2.expandKey(e,t),c=0;c<64;c++)v.push(e.getInt16Le());r?(i=function(e){for(c=0;c<4;c++)e[c]+=v[l]+(e[(c+3)%4]&e[(c+2)%4])+(~e[(c+3)%4]&e[(c+1)%4]),e[c]=s(e[c],a[c]),l++},u=function(e){for(c=0;c<4;c++)e[c]+=v[63&e[(c+3)%4]]}):(i=function(e){for(c=3;c>=0;c--)e[c]=o(e[c],a[c]),e[c]-=v[l]+(e[(c+3)%4]&e[(c+2)%4])+(~e[(c+3)%4]&e[(c+1)%4]),l--},u=function(e){for(c=3;c>=0;c--)e[c]-=v[63&e[(c+3)%4]]});var g=function(e){var t=[];for(c=0;c<4;c++){var n=f.getInt16Le();null!==p&&(r?n^=p.getInt16Le():p.putInt16Le(n)),t.push(65535&n)}l=r?0:63;for(var i=0;i<e.length;i++)for(var a=0;a<e[i][0];a++)e[i][1](t);for(c=0;c<4;c++)null!==p&&(r?p.putInt16Le(t[c]):t[c]^=p.getInt16Le()),d.putInt16Le(t[c])},y=null;return y={start:function(e,t){e&&"string"===typeof e&&(e=n.util.createBuffer(e)),h=!1,f=n.util.createBuffer(),d=t||new n.util.createBuffer,p=e,y.output=d},update:function(e){for(h||f.putBuffer(e);f.length()>=8;)g([[5,i],[1,u],[6,i],[1,u],[5,i]])},finish:function(e){var t=!0;if(r)if(e)t=e(8,f,!r);else{var n=8===f.length()?8:8-f.length();f.fillWithByte(n,n)}if(t&&(h=!0,y.update()),!r&&(t=0===f.length()))if(e)t=e(8,d,!r);else{var i=d.length(),a=d.at(i-1);a>i?t=!1:d.truncate(a)}return t}}};n.rc2.startEncrypting=function(e,t,r){var i=n.rc2.createEncryptionCipher(e,128);return i.start(t,r),i},n.rc2.createEncryptionCipher=function(e,t){return u(e,t,!0)},n.rc2.startDecrypting=function(e,t,r){var i=n.rc2.createDecryptionCipher(e,128);return i.start(t,r),i},n.rc2.createDecryptionCipher=function(e,t){return u(e,t,!1)}},5493:function(e,t,r){var n=r(392);if(r(5049),r(3055),r(2886),r(2627),r(5132),r(3860),r(3877),"undefined"===typeof i)var i=n.jsbn.BigInteger;var a=n.util.isNodejs?r(5819):null,s=n.asn1,o=n.util;n.pki=n.pki||{},e.exports=n.pki.rsa=n.rsa=n.rsa||{};var u=n.pki,c=[6,4,2,4,2,4,6,2],l={name:"PrivateKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},h={name:"RSAPrivateKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},f={name:"RSAPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},d=n.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},p={name:"DigestInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:s.Class.UNIVERSAL,type:s.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},v=function(e){var t;if(!(e.algorithm in u.oids)){var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}t=u.oids[e.algorithm];var n=s.oidToDer(t).getBytes(),i=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]),a=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);a.value.push(s.create(s.Class.UNIVERSAL,s.Type.OID,!1,n)),a.value.push(s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,""));var o=s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(a),i.value.push(o),s.toDer(i).getBytes()},g=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);var a;t.dP||(t.dP=t.d.mod(t.p.subtract(i.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(i.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));do{a=new i(n.util.bytesToHex(n.random.getBytes(t.n.bitLength()/8)),16)}while(a.compareTo(t.n)>=0||!a.gcd(t.n).equals(i.ONE));for(var s=(e=e.multiply(a.modPow(t.e,t.n)).mod(t.n)).mod(t.p).modPow(t.dP,t.p),o=e.mod(t.q).modPow(t.dQ,t.q);s.compareTo(o)<0;)s=s.add(t.p);var u=s.subtract(o).multiply(t.qInv).mod(t.p).multiply(t.q).add(o);return u=u.multiply(a.modInverse(t.n)).mod(t.n)};function y(e,t,r){var i=n.util.createBuffer(),a=Math.ceil(t.n.bitLength()/8);if(e.length>a-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=e.length,s.max=a-11,s}i.putByte(0),i.putByte(r);var o,u=a-3-e.length;if(0===r||1===r){o=0===r?0:255;for(var c=0;c<u;++c)i.putByte(o)}else for(;u>0;){var l=0,h=n.random.getBytes(u);for(c=0;c<u;++c)0===(o=h.charCodeAt(c))?++l:i.putByte(o);u=l}return i.putByte(0),i.putBytes(e),i}function m(e,t,r,i){var a=Math.ceil(t.n.bitLength()/8),s=n.util.createBuffer(e),o=s.getByte(),u=s.getByte();if(0!==o||r&&0!==u&&1!==u||!r&&2!=u||r&&0===u&&"undefined"===typeof i)throw new Error("Encryption block is invalid.");var c=0;if(0===u){c=a-3-i;for(var l=0;l<c;++l)if(0!==s.getByte())throw new Error("Encryption block is invalid.")}else if(1===u)for(c=0;s.length()>1;){if(255!==s.getByte()){--s.read;break}++c}else if(2===u)for(c=0;s.length()>1;){if(0===s.getByte()){--s.read;break}++c}if(0!==s.getByte()||c!==a-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function b(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=n.util.hexToBytes(t);return r.length>1&&(0===r.charCodeAt(0)&&0===(128&r.charCodeAt(1))||255===r.charCodeAt(0)&&128===(128&r.charCodeAt(1)))?r.substr(1):r}function _(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function w(e){return n.util.isNodejs&&"function"===typeof a[e]}function k(e){return"undefined"!==typeof o.globalScope&&"object"===typeof o.globalScope.crypto&&"object"===typeof o.globalScope.crypto.subtle&&"function"===typeof o.globalScope.crypto.subtle[e]}function x(e){return"undefined"!==typeof o.globalScope&&"object"===typeof o.globalScope.msCrypto&&"object"===typeof o.globalScope.msCrypto.subtle&&"function"===typeof o.globalScope.msCrypto.subtle[e]}function E(e){for(var t=n.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),i=0;i<t.length;++i)r[i]=t.charCodeAt(i);return r}u.rsa.encrypt=function(e,t,r){var a,s=r,o=Math.ceil(t.n.bitLength()/8);!1!==r&&!0!==r?(s=2===r,a=y(e,t,r)):(a=n.util.createBuffer()).putBytes(e);for(var u=new i(a.toHex(),16),c=g(u,t,s).toString(16),l=n.util.createBuffer(),h=o-Math.ceil(c.length/2);h>0;)l.putByte(0),--h;return l.putBytes(n.util.hexToBytes(c)),l.getBytes()},u.rsa.decrypt=function(e,t,r,a){var s=Math.ceil(t.n.bitLength()/8);if(e.length!==s){var o=new Error("Encrypted message length is invalid.");throw o.length=e.length,o.expected=s,o}var u=new i(n.util.createBuffer(e).toHex(),16);if(u.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var c=g(u,t,r).toString(16),l=n.util.createBuffer(),h=s-Math.ceil(c.length/2);h>0;)l.putByte(0),--h;return l.putBytes(n.util.hexToBytes(c)),!1!==a?m(l.getBytes(),t,r):l.getBytes()},u.rsa.createKeyPairGenerationState=function(e,t,r){"string"===typeof e&&(e=parseInt(e,10)),e=e||2048;var a,s=(r=r||{}).prng||n.random,o={nextBytes:function(e){for(var t=s.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}},u=r.algorithm||"PRIMEINC";if("PRIMEINC"!==u)throw new Error("Invalid key generation algorithm: "+u);return(a={algorithm:u,state:0,bits:e,rng:o,eInt:t||65537,e:new i(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null}).e.fromInt(a.eInt),a},u.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new i(null);r.fromInt(30);for(var n,a=0,s=function(e,t){return e|t},o=+new Date,l=0;null===e.keys&&(t<=0||l<t);){if(0===e.state){var h=null===e.p?e.pBits:e.qBits,f=h-1;0===e.pqState?(e.num=new i(h,e.rng),e.num.testBit(f)||e.num.bitwiseTo(i.ONE.shiftLeft(f),s,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),a=0,++e.pqState):1===e.pqState?e.num.bitLength()>h?e.pqState=0:e.num.isProbablePrime(_(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(c[a++%8],0):2===e.pqState?e.pqState=0===e.num.subtract(i.ONE).gcd(e.e).compareTo(i.ONE)?3:0:3===e.pqState&&(e.pqState=0,null===e.p?e.p=e.num:e.q=e.num,null!==e.p&&null!==e.q&&++e.state,e.num=null)}else if(1===e.state)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(2===e.state)e.p1=e.p.subtract(i.ONE),e.q1=e.q.subtract(i.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(3===e.state)0===e.phi.gcd(e.e).compareTo(i.ONE)?++e.state:(e.p=null,e.q=null,e.state=0);else if(4===e.state)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(5===e.state){var d=e.e.modInverse(e.phi);e.keys={privateKey:u.rsa.setPrivateKey(e.n,e.e,d,e.p,e.q,d.mod(e.p1),d.mod(e.q1),e.q.modInverse(e.p)),publicKey:u.rsa.setPublicKey(e.n,e.e)}}l+=(n=+new Date)-o,o=n}return null!==e.keys},u.rsa.generateKeyPair=function(e,t,r,c){if(1===arguments.length?"object"===typeof e?(r=e,e=void 0):"function"===typeof e&&(c=e,e=void 0):2===arguments.length?"number"===typeof e?"function"===typeof t?(c=t,t=void 0):"number"!==typeof t&&(r=t,t=void 0):(r=e,c=t,e=void 0,t=void 0):3===arguments.length&&("number"===typeof t?"function"===typeof r&&(c=r,r=void 0):(c=r,r=t,t=void 0)),r=r||{},void 0===e&&(e=r.bits||2048),void 0===t&&(t=r.e||65537),!n.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(65537===t||3===t))if(c){if(w("generateKeyPair"))return a.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},(function(e,t,r){if(e)return c(e);c(null,{privateKey:u.privateKeyFromPem(r),publicKey:u.publicKeyFromPem(t)})}));if(k("generateKey")&&k("exportKey"))return o.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:E(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then((function(e){return o.globalScope.crypto.subtle.exportKey("pkcs8",e.privateKey)})).then(void 0,(function(e){c(e)})).then((function(e){if(e){var t=u.privateKeyFromAsn1(s.fromDer(n.util.createBuffer(e)));c(null,{privateKey:t,publicKey:u.setRsaPublicKey(t.n,t.e)})}}));if(x("generateKey")&&x("exportKey")){var l=o.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:E(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);return l.oncomplete=function(e){var t=e.target.result,r=o.globalScope.msCrypto.subtle.exportKey("pkcs8",t.privateKey);r.oncomplete=function(e){var t=e.target.result,r=u.privateKeyFromAsn1(s.fromDer(n.util.createBuffer(t)));c(null,{privateKey:r,publicKey:u.setRsaPublicKey(r.n,r.e)})},r.onerror=function(e){c(e)}},void(l.onerror=function(e){c(e)})}}else if(w("generateKeyPairSync")){var h=a.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:u.privateKeyFromPem(h.privateKey),publicKey:u.publicKeyFromPem(h.publicKey)}}var f=u.rsa.createKeyPairGenerationState(e,t,r);if(!c)return u.rsa.stepKeyPairGenerationState(f,0),f.keys;!function(e,t,r){"function"===typeof t&&(r=t,t={});t=t||{};var a={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(a.prng=t.prng);function s(){o(e.pBits,(function(t,n){return t?r(t):(e.p=n,null!==e.q?c(t,e.q):void o(e.qBits,c))}))}function o(e,t){n.prime.generateProbablePrime(e,a,t)}function c(t,n){if(t)return r(t);if(e.q=n,e.p.compareTo(e.q)<0){var a=e.p;e.p=e.q,e.q=a}if(0!==e.p.subtract(i.ONE).gcd(e.e).compareTo(i.ONE))return e.p=null,void s();if(0!==e.q.subtract(i.ONE).gcd(e.e).compareTo(i.ONE))return e.q=null,void o(e.qBits,c);if(e.p1=e.p.subtract(i.ONE),e.q1=e.q.subtract(i.ONE),e.phi=e.p1.multiply(e.q1),0!==e.phi.gcd(e.e).compareTo(i.ONE))return e.p=e.q=null,void s();if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits)return e.q=null,void o(e.qBits,c);var l=e.e.modInverse(e.phi);e.keys={privateKey:u.rsa.setPrivateKey(e.n,e.e,l,e.p,e.q,l.mod(e.p1),l.mod(e.q1),e.q.modInverse(e.p)),publicKey:u.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}s()}(f,r,c)},u.setRsaPublicKey=u.rsa.setPublicKey=function(e,t){var r={n:e,e:t,encrypt:function(e,t,i){if("string"===typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===t)t={encode:function(e,t,r){return y(e,t,2).getBytes()}};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={encode:function(e,t){return n.pkcs1.encode_rsa_oaep(t,e,i)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(t))t={encode:function(e){return e}};else if("string"===typeof t)throw new Error('Unsupported encryption scheme: "'+t+'".');var a=t.encode(e,r,!0);return u.rsa.encrypt(a,r,!0)},verify:function(e,t,i,a){"string"===typeof i?i=i.toUpperCase():void 0===i&&(i="RSASSA-PKCS1-V1_5"),void 0===a&&(a={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in a||(a._parseAllDigestBytes=!0),"RSASSA-PKCS1-V1_5"===i?i={verify:function(e,t){t=m(t,r,!0);var i=s.fromDer(t,{parseAllBytes:a._parseAllDigestBytes}),o={},u=[];if(!s.validate(i,p,o,u))throw(c=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.")).errors=u,c;var c,l=s.derToOid(o.algorithmIdentifier);if(l!==n.oids.md2&&l!==n.oids.md5&&l!==n.oids.sha1&&l!==n.oids.sha224&&l!==n.oids.sha256&&l!==n.oids.sha384&&l!==n.oids.sha512&&l!==n.oids["sha512-224"]&&l!==n.oids["sha512-256"])throw(c=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.")).oid=l,c;if((l===n.oids.md2||l===n.oids.md5)&&!("parameters"in o))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return e===o.digest}}:"NONE"!==i&&"NULL"!==i&&null!==i||(i={verify:function(e,t){return e===(t=m(t,r,!0))}});var o=u.rsa.decrypt(t,r,!0,!1);return i.verify(e,o,r.n.bitLength())}};return r},u.setRsaPrivateKey=u.rsa.setPrivateKey=function(e,t,r,i,a,s,o,c){var l={n:e,e:t,d:r,p:i,q:a,dP:s,dQ:o,qInv:c,decrypt:function(e,t,r){"string"===typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5");var i=u.rsa.decrypt(e,l,!1,!1);if("RSAES-PKCS1-V1_5"===t)t={decode:m};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={decode:function(e,t){return n.pkcs1.decode_rsa_oaep(t,e,r)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(t))throw new Error('Unsupported encryption scheme: "'+t+'".');t={decode:function(e){return e}}}return t.decode(i,l,!1)},sign:function(e,t){var r=!1;"string"===typeof t&&(t=t.toUpperCase()),void 0===t||"RSASSA-PKCS1-V1_5"===t?(t={encode:v},r=1):"NONE"!==t&&"NULL"!==t&&null!==t||(t={encode:function(){return e}},r=1);var n=t.encode(e,l.n.bitLength());return u.rsa.encrypt(n,l,r)}};return l},u.wrapRsaPrivateKey=function(e){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(0).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(u.oids.rsaEncryption).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]),s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,s.toDer(e).getBytes())])},u.privateKeyFromAsn1=function(e){var t,r,a,o,c,f,d,p,v={},g=[];if(s.validate(e,l,v,g)&&(e=s.fromDer(n.util.createBuffer(v.privateKey))),v={},g=[],!s.validate(e,h,v,g)){var y=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw y.errors=g,y}return t=n.util.createBuffer(v.privateKeyModulus).toHex(),r=n.util.createBuffer(v.privateKeyPublicExponent).toHex(),a=n.util.createBuffer(v.privateKeyPrivateExponent).toHex(),o=n.util.createBuffer(v.privateKeyPrime1).toHex(),c=n.util.createBuffer(v.privateKeyPrime2).toHex(),f=n.util.createBuffer(v.privateKeyExponent1).toHex(),d=n.util.createBuffer(v.privateKeyExponent2).toHex(),p=n.util.createBuffer(v.privateKeyCoefficient).toHex(),u.setRsaPrivateKey(new i(t,16),new i(r,16),new i(a,16),new i(o,16),new i(c,16),new i(f,16),new i(d,16),new i(p,16))},u.privateKeyToAsn1=u.privateKeyToRSAPrivateKey=function(e){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(0).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.n)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.e)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.d)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.p)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.q)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.dP)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.dQ)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.qInv))])},u.publicKeyFromAsn1=function(e){var t={},r=[];if(s.validate(e,d,t,r)){var a,o=s.derToOid(t.publicKeyOid);if(o!==u.oids.rsaEncryption)throw(a=new Error("Cannot read public key. Unknown OID.")).oid=o,a;e=t.rsaPublicKey}if(r=[],!s.validate(e,f,t,r))throw(a=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.")).errors=r,a;var c=n.util.createBuffer(t.publicKeyModulus).toHex(),l=n.util.createBuffer(t.publicKeyExponent).toHex();return u.setRsaPublicKey(new i(c,16),new i(l,16))},u.publicKeyToAsn1=u.publicKeyToSubjectPublicKeyInfo=function(e){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(u.oids.rsaEncryption).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]),s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,[u.publicKeyToRSAPublicKey(e)])])},u.publicKeyToRSAPublicKey=function(e){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.n)),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,b(e.e))])}},928:function(e,t,r){var n=r(392);r(29),r(3877);var i=e.exports=n.sha1=n.sha1||{};n.md.sha1=n.md.algorithms.sha1=i,i.create=function(){s||(a=String.fromCharCode(128),a+=n.util.fillString(String.fromCharCode(0),64),s=!0);var e=null,t=n.util.createBuffer(),r=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var r=i.messageLengthSize/4,a=0;a<r;++a)i.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i}};return i.start(),i.update=function(a,s){"utf8"===s&&(a=n.util.encodeUtf8(a));var u=a.length;i.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var c=i.fullMessageLength.length-1;c>=0;--c)i.fullMessageLength[c]+=u[1],u[1]=u[0]+(i.fullMessageLength[c]/4294967296>>>0),i.fullMessageLength[c]=i.fullMessageLength[c]>>>0,u[0]=u[1]/4294967296>>>0;return t.putBytes(a),o(e,r,t),(t.read>2048||0===t.length())&&t.compact(),i},i.digest=function(){var s=n.util.createBuffer();s.putBytes(t.bytes());var u,c=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize&i.blockLength-1;s.putBytes(a.substr(0,i.blockLength-c));for(var l=8*i.fullMessageLength[0],h=0;h<i.fullMessageLength.length-1;++h)l+=(u=8*i.fullMessageLength[h+1])/4294967296>>>0,s.putInt32(l>>>0),l=u>>>0;s.putInt32(l);var f={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};o(f,r,s);var d=n.util.createBuffer();return d.putInt32(f.h0),d.putInt32(f.h1),d.putInt32(f.h2),d.putInt32(f.h3),d.putInt32(f.h4),d},i};var a=null,s=!1;function o(e,t,r){for(var n,i,a,s,o,u,c,l=r.length();l>=64;){for(i=e.h0,a=e.h1,s=e.h2,o=e.h3,u=e.h4,c=0;c<16;++c)n=r.getInt32(),t[c]=n,n=(i<<5|i>>>27)+(o^a&(s^o))+u+1518500249+n,u=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;c<20;++c)n=(n=t[c-3]^t[c-8]^t[c-14]^t[c-16])<<1|n>>>31,t[c]=n,n=(i<<5|i>>>27)+(o^a&(s^o))+u+1518500249+n,u=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;c<32;++c)n=(n=t[c-3]^t[c-8]^t[c-14]^t[c-16])<<1|n>>>31,t[c]=n,n=(i<<5|i>>>27)+(a^s^o)+u+1859775393+n,u=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;c<40;++c)n=(n=t[c-6]^t[c-16]^t[c-28]^t[c-32])<<2|n>>>30,t[c]=n,n=(i<<5|i>>>27)+(a^s^o)+u+1859775393+n,u=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;c<60;++c)n=(n=t[c-6]^t[c-16]^t[c-28]^t[c-32])<<2|n>>>30,t[c]=n,n=(i<<5|i>>>27)+(a&s|o&(a^s))+u+2400959708+n,u=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;c<80;++c)n=(n=t[c-6]^t[c-16]^t[c-28]^t[c-32])<<2|n>>>30,t[c]=n,n=(i<<5|i>>>27)+(a^s^o)+u+3395469782+n,u=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;e.h0=e.h0+i|0,e.h1=e.h1+a|0,e.h2=e.h2+s|0,e.h3=e.h3+o|0,e.h4=e.h4+u|0,l-=64}}},7404:function(e,t,r){var n=r(392);r(29),r(3877);var i=e.exports=n.sha256=n.sha256||{};n.md.sha256=n.md.algorithms.sha256=i,i.create=function(){s||(a=String.fromCharCode(128),a+=n.util.fillString(String.fromCharCode(0),64),o=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=!0);var e=null,t=n.util.createBuffer(),r=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var r=i.messageLengthSize/4,a=0;a<r;++a)i.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i}};return i.start(),i.update=function(a,s){"utf8"===s&&(a=n.util.encodeUtf8(a));var o=a.length;i.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var c=i.fullMessageLength.length-1;c>=0;--c)i.fullMessageLength[c]+=o[1],o[1]=o[0]+(i.fullMessageLength[c]/4294967296>>>0),i.fullMessageLength[c]=i.fullMessageLength[c]>>>0,o[0]=o[1]/4294967296>>>0;return t.putBytes(a),u(e,r,t),(t.read>2048||0===t.length())&&t.compact(),i},i.digest=function(){var s=n.util.createBuffer();s.putBytes(t.bytes());var o,c=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize&i.blockLength-1;s.putBytes(a.substr(0,i.blockLength-c));for(var l=8*i.fullMessageLength[0],h=0;h<i.fullMessageLength.length-1;++h)l+=(o=8*i.fullMessageLength[h+1])/4294967296>>>0,s.putInt32(l>>>0),l=o>>>0;s.putInt32(l);var f={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};u(f,r,s);var d=n.util.createBuffer();return d.putInt32(f.h0),d.putInt32(f.h1),d.putInt32(f.h2),d.putInt32(f.h3),d.putInt32(f.h4),d.putInt32(f.h5),d.putInt32(f.h6),d.putInt32(f.h7),d},i};var a=null,s=!1,o=null;function u(e,t,r){for(var n,i,a,s,u,c,l,h,f,d,p,v,g,y=r.length();y>=64;){for(u=0;u<16;++u)t[u]=r.getInt32();for(;u<64;++u)n=((n=t[u-2])>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=((i=t[u-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[u]=n+t[u-7]+i+t[u-16]|0;for(c=e.h0,l=e.h1,h=e.h2,f=e.h3,d=e.h4,p=e.h5,v=e.h6,g=e.h7,u=0;u<64;++u)a=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),s=c&l|h&(c^l),n=g+((d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7))+(v^d&(p^v))+o[u]+t[u],g=v,v=p,p=d,d=f+n>>>0,f=h,h=l,l=c,c=n+(i=a+s)>>>0;e.h0=e.h0+c|0,e.h1=e.h1+l|0,e.h2=e.h2+h|0,e.h3=e.h3+f|0,e.h4=e.h4+d|0,e.h5=e.h5+p|0,e.h6=e.h6+v|0,e.h7=e.h7+g|0,y-=64}}},4770:function(e,t,r){var n=r(392);r(29),r(3877);var i=e.exports=n.sha512=n.sha512||{};n.md.sha512=n.md.algorithms.sha512=i;var a=n.sha384=n.sha512.sha384=n.sha512.sha384||{};a.create=function(){return i.create("SHA-384")},n.md.sha384=n.md.algorithms.sha384=a,n.sha512.sha256=n.sha512.sha256||{create:function(){return i.create("SHA-512/256")}},n.md["sha512/256"]=n.md.algorithms["sha512/256"]=n.sha512.sha256,n.sha512.sha224=n.sha512.sha224||{create:function(){return i.create("SHA-512/224")}},n.md["sha512/224"]=n.md.algorithms["sha512/224"]=n.sha512.sha224,i.create=function(e){if(o||(s=String.fromCharCode(128),s+=n.util.fillString(String.fromCharCode(0),128),u=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],(c={})["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],c["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],c["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],c["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],o=!0),"undefined"===typeof e&&(e="SHA-512"),!(e in c))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=c[e],r=null,i=n.util.createBuffer(),a=new Array(80),h=0;h<80;++h)a[h]=new Array(2);var f=64;switch(e){case"SHA-384":f=48;break;case"SHA-512/256":f=32;break;case"SHA-512/224":f=28}var d={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:f,messageLength:0,fullMessageLength:null,messageLengthSize:16,start:function(){d.messageLength=0,d.fullMessageLength=d.messageLength128=[];for(var e=d.messageLengthSize/4,a=0;a<e;++a)d.fullMessageLength.push(0);i=n.util.createBuffer(),r=new Array(t.length);for(a=0;a<t.length;++a)r[a]=t[a].slice(0);return d}};return d.start(),d.update=function(e,t){"utf8"===t&&(e=n.util.encodeUtf8(e));var s=e.length;d.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=d.fullMessageLength.length-1;o>=0;--o)d.fullMessageLength[o]+=s[1],s[1]=s[0]+(d.fullMessageLength[o]/4294967296>>>0),d.fullMessageLength[o]=d.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return i.putBytes(e),l(r,a,i),(i.read>2048||0===i.length())&&i.compact(),d},d.digest=function(){var t=n.util.createBuffer();t.putBytes(i.bytes());var o,u=d.fullMessageLength[d.fullMessageLength.length-1]+d.messageLengthSize&d.blockLength-1;t.putBytes(s.substr(0,d.blockLength-u));for(var c=8*d.fullMessageLength[0],h=0;h<d.fullMessageLength.length-1;++h)c+=(o=8*d.fullMessageLength[h+1])/4294967296>>>0,t.putInt32(c>>>0),c=o>>>0;t.putInt32(c);var f=new Array(r.length);for(h=0;h<r.length;++h)f[h]=r[h].slice(0);l(f,a,t);var p,v=n.util.createBuffer();p="SHA-512"===e?f.length:"SHA-384"===e?f.length-2:f.length-4;for(h=0;h<p;++h)v.putInt32(f[h][0]),h===p-1&&"SHA-512/224"===e||v.putInt32(f[h][1]);return v},d};var s=null,o=!1,u=null,c=null;function l(e,t,r){for(var n,i,a,s,o,c,l,h,f,d,p,v,g,y,m,b,_,w,k,x,E,S,C,A,D,R,T,Z,I,P,L,M,B,O=r.length();O>=128;){for(T=0;T<16;++T)t[T][0]=r.getInt32()>>>0,t[T][1]=r.getInt32()>>>0;for(;T<80;++T)n=(((Z=(P=t[T-2])[0])>>>19|(I=P[1])<<13)^(I>>>29|Z<<3)^Z>>>6)>>>0,i=((Z<<13|I>>>19)^(I<<3|Z>>>29)^(Z<<26|I>>>6))>>>0,a=(((Z=(M=t[T-15])[0])>>>1|(I=M[1])<<31)^(Z>>>8|I<<24)^Z>>>7)>>>0,s=((Z<<31|I>>>1)^(Z<<24|I>>>8)^(Z<<25|I>>>7))>>>0,L=t[T-7],B=t[T-16],I=i+L[1]+s+B[1],t[T][0]=n+L[0]+a+B[0]+(I/4294967296>>>0)>>>0,t[T][1]=I>>>0;for(p=e[0][0],v=e[0][1],g=e[1][0],y=e[1][1],m=e[2][0],b=e[2][1],_=e[3][0],w=e[3][1],k=e[4][0],x=e[4][1],E=e[5][0],S=e[5][1],C=e[6][0],A=e[6][1],D=e[7][0],R=e[7][1],T=0;T<80;++T)l=((k>>>14|x<<18)^(k>>>18|x<<14)^(x>>>9|k<<23))>>>0,h=(C^k&(E^C))>>>0,o=((p>>>28|v<<4)^(v>>>2|p<<30)^(v>>>7|p<<25))>>>0,c=((p<<4|v>>>28)^(v<<30|p>>>2)^(v<<25|p>>>7))>>>0,f=(p&g|m&(p^g))>>>0,d=(v&y|b&(v^y))>>>0,I=R+(((k<<18|x>>>14)^(k<<14|x>>>18)^(x<<23|k>>>9))>>>0)+((A^x&(S^A))>>>0)+u[T][1]+t[T][1],n=D+l+h+u[T][0]+t[T][0]+(I/4294967296>>>0)>>>0,i=I>>>0,a=o+f+((I=c+d)/4294967296>>>0)>>>0,s=I>>>0,D=C,R=A,C=E,A=S,E=k,S=x,k=_+n+((I=w+i)/4294967296>>>0)>>>0,x=I>>>0,_=m,w=b,m=g,b=y,g=p,y=v,p=n+a+((I=i+s)/4294967296>>>0)>>>0,v=I>>>0;I=e[0][1]+v,e[0][0]=e[0][0]+p+(I/4294967296>>>0)>>>0,e[0][1]=I>>>0,I=e[1][1]+y,e[1][0]=e[1][0]+g+(I/4294967296>>>0)>>>0,e[1][1]=I>>>0,I=e[2][1]+b,e[2][0]=e[2][0]+m+(I/4294967296>>>0)>>>0,e[2][1]=I>>>0,I=e[3][1]+w,e[3][0]=e[3][0]+_+(I/4294967296>>>0)>>>0,e[3][1]=I>>>0,I=e[4][1]+x,e[4][0]=e[4][0]+k+(I/4294967296>>>0)>>>0,e[4][1]=I>>>0,I=e[5][1]+S,e[5][0]=e[5][0]+E+(I/4294967296>>>0)>>>0,e[5][1]=I>>>0,I=e[6][1]+A,e[6][0]=e[6][0]+C+(I/4294967296>>>0)>>>0,e[6][1]=I>>>0,I=e[7][1]+R,e[7][0]=e[7][0]+D+(I/4294967296>>>0)>>>0,e[7][1]=I>>>0,O-=128}}},3877:function(e,t,r){var n=r(1426),i=r(2678).Buffer,a=r(392),s=r(5754),o=e.exports=a.util=a.util||{};function u(e){if(8!==e&&16!==e&&24!==e&&32!==e)throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}function c(e){if(this.data="",this.read=0,"string"===typeof e)this.data=e;else if(o.isArrayBuffer(e)||o.isArrayBufferView(e))if("undefined"!==typeof i&&e instanceof i)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch(n){for(var r=0;r<t.length;++r)this.putByte(t[r])}}else(e instanceof c||"object"===typeof e&&"string"===typeof e.data&&"number"===typeof e.read)&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}!function(){if("undefined"!==typeof n&&n.nextTick&&!n.browser)return o.nextTick=n.nextTick,void("function"===typeof setImmediate?o.setImmediate=setImmediate:o.setImmediate=o.nextTick);if("function"===typeof setImmediate)return o.setImmediate=function(){return setImmediate.apply(void 0,arguments)},void(o.nextTick=function(e){return setImmediate(e)});if(o.setImmediate=function(e){setTimeout(e,0)},"undefined"!==typeof window&&"function"===typeof window.postMessage){var e="forge.setImmediate",t=[];o.setImmediate=function(r){t.push(r),1===t.length&&window.postMessage(e,"*")},window.addEventListener("message",(function(r){if(r.source===window&&r.data===e){r.stopPropagation();var n=t.slice();t.length=0,n.forEach((function(e){e()}))}}),!0)}if("undefined"!==typeof MutationObserver){var r=Date.now(),i=!0,a=document.createElement("div");t=[];new MutationObserver((function(){var e=t.slice();t.length=0,e.forEach((function(e){e()}))})).observe(a,{attributes:!0});var s=o.setImmediate;o.setImmediate=function(e){Date.now()-r>15?(r=Date.now(),s(e)):(t.push(e),1===t.length&&a.setAttribute("a",i=!i))}}o.nextTick=o.setImmediate}(),o.isNodejs="undefined"!==typeof n&&n.versions&&n.versions.node,o.globalScope=o.isNodejs?r.g:"undefined"===typeof self?window:self,o.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},o.isArrayBuffer=function(e){return"undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer},o.isArrayBufferView=function(e){return e&&o.isArrayBuffer(e.buffer)&&void 0!==e.byteLength},o.ByteBuffer=c,o.ByteStringBuffer=c;o.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>4096&&(this.data.substr(0,1),this._constructedStringLength=0)},o.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},o.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},o.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))},o.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)1&t&&(r+=e),(t>>>=1)>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this},o.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this},o.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(o.encodeUtf8(e))},o.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},o.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},o.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},o.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255))},o.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))},o.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))},o.ByteStringBuffer.prototype.putInt=function(e,t){u(t);var r="";do{t-=8,r+=String.fromCharCode(e>>t&255)}while(t>0);return this.putBytes(r)},o.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)},o.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())},o.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},o.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e},o.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e},o.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},o.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e},o.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e},o.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e},o.ByteStringBuffer.prototype.getInt=function(e){u(e);var t=0;do{t=(t<<8)+this.data.charCodeAt(this.read++),e-=8}while(e>0);return t},o.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},o.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},o.ByteStringBuffer.prototype.bytes=function(e){return"undefined"===typeof e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},o.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)},o.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this},o.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},o.ByteStringBuffer.prototype.copy=function(){var e=o.createBuffer(this.data);return e.read=this.read,e},o.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},o.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},o.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this},o.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e},o.ByteStringBuffer.prototype.toString=function(){return o.decodeUtf8(this.bytes())},o.DataBuffer=function(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=o.isArrayBuffer(e),n=o.isArrayBufferView(e);if(r||n)return this.data=r?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),void(this.write="writeOffset"in t?t.writeOffset:this.data.byteLength);this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!==e&&void 0!==e&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)},o.DataBuffer.prototype.length=function(){return this.write-this.read},o.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},o.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this},o.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this},o.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this},o.DataBuffer.prototype.putBytes=function(e,t){if(o.isArrayBufferView(e)){var r=(n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)).byteLength-n.byteOffset;return this.accommodate(r),new Uint8Array(this.data.buffer,this.write).set(n),this.write+=r,this}if(o.isArrayBuffer(e)){var n=new Uint8Array(e);return this.accommodate(n.byteLength),new Uint8Array(this.data.buffer).set(n,this.write),this.write+=n.byteLength,this}if(e instanceof o.DataBuffer||"object"===typeof e&&"number"===typeof e.read&&"number"===typeof e.write&&o.isArrayBufferView(e.data)){n=new Uint8Array(e.data.byteLength,e.read,e.length());return this.accommodate(n.byteLength),new Uint8Array(e.data.byteLength,this.write).set(n),this.write+=n.byteLength,this}if(e instanceof o.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary","string"===typeof e){var i;if("hex"===t)return this.accommodate(Math.ceil(e.length/2)),i=new Uint8Array(this.data.buffer,this.write),this.write+=o.binary.hex.decode(e,i,this.write),this;if("base64"===t)return this.accommodate(3*Math.ceil(e.length/4)),i=new Uint8Array(this.data.buffer,this.write),this.write+=o.binary.base64.decode(e,i,this.write),this;if("utf8"===t&&(e=o.encodeUtf8(e),t="binary"),"binary"===t||"raw"===t)return this.accommodate(e.length),i=new Uint8Array(this.data.buffer,this.write),this.write+=o.binary.raw.decode(i),this;if("utf16"===t)return this.accommodate(2*e.length),i=new Uint16Array(this.data.buffer,this.write),this.write+=o.text.utf16.encode(i),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)},o.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this},o.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")},o.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this},o.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this},o.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this},o.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this},o.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this},o.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this},o.DataBuffer.prototype.putInt=function(e,t){u(t),this.accommodate(t/8);do{t-=8,this.data.setInt8(this.write++,e>>t&255)}while(t>0);return this},o.DataBuffer.prototype.putSignedInt=function(e,t){return u(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)},o.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},o.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e},o.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e},o.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e},o.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e},o.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e},o.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e},o.DataBuffer.prototype.getInt=function(e){u(e);var t=0;do{t=(t<<8)+this.data.getInt8(this.read++),e-=8}while(e>0);return t},o.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},o.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},o.DataBuffer.prototype.bytes=function(e){return"undefined"===typeof e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},o.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)},o.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this},o.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},o.DataBuffer.prototype.copy=function(){return new o.DataBuffer(this)},o.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this},o.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},o.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this},o.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e},o.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if("binary"===(e=e||"utf8")||"raw"===e)return o.binary.raw.encode(t);if("hex"===e)return o.binary.hex.encode(t);if("base64"===e)return o.binary.base64.encode(t);if("utf8"===e)return o.text.utf8.decode(t);if("utf16"===e)return o.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)},o.createBuffer=function(e,t){return t=t||"raw",void 0!==e&&"utf8"===t&&(e=o.encodeUtf8(e)),new o.ByteBuffer(e)},o.fillString=function(e,t){for(var r="";t>0;)1&t&&(r+=e),(t>>>=1)>0&&(e+=e);return r},o.xorBytes=function(e,t,r){for(var n="",i="",a="",s=0,o=0;r>0;--r,++s)i=e.charCodeAt(s)^t.charCodeAt(s),o>=10&&(n+=a,a="",o=0),a+=String.fromCharCode(i),++o;return n+=a},o.hexToBytes=function(e){var t="",r=0;for(!0&e.length&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t},o.bytesToHex=function(e){return o.createBuffer(e).toHex()},o.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)};var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],f="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";o.encode64=function(e,t){for(var r,n,i,a="",s="",o=0;o<e.length;)r=e.charCodeAt(o++),n=e.charCodeAt(o++),i=e.charCodeAt(o++),a+=l.charAt(r>>2),a+=l.charAt((3&r)<<4|n>>4),isNaN(n)?a+="==":(a+=l.charAt((15&n)<<2|i>>6),a+=isNaN(i)?"=":l.charAt(63&i)),t&&a.length>t&&(s+=a.substr(0,t)+"\r\n",a=a.substr(t));return s+=a},o.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t,r,n,i,a="",s=0;s<e.length;)t=h[e.charCodeAt(s++)-43],r=h[e.charCodeAt(s++)-43],n=h[e.charCodeAt(s++)-43],i=h[e.charCodeAt(s++)-43],a+=String.fromCharCode(t<<2|r>>4),64!==n&&(a+=String.fromCharCode((15&r)<<4|n>>2),64!==i&&(a+=String.fromCharCode((3&n)<<6|i)));return a},o.encodeUtf8=function(e){return unescape(encodeURIComponent(e))},o.decodeUtf8=function(e){return decodeURIComponent(escape(e))},o.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:s.encode,decode:s.decode}},o.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)},o.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length));for(var i=r=r||0,a=0;a<e.length;++a)n[i++]=e.charCodeAt(a);return t?i-r:n},o.binary.hex.encode=o.bytesToHex,o.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2)));var i=0,a=r=r||0;for(1&e.length&&(i=1,n[a++]=parseInt(e[0],16));i<e.length;i+=2)n[a++]=parseInt(e.substr(i,2),16);return t?a-r:n},o.binary.base64.encode=function(e,t){for(var r,n,i,a="",s="",o=0;o<e.byteLength;)r=e[o++],n=e[o++],i=e[o++],a+=l.charAt(r>>2),a+=l.charAt((3&r)<<4|n>>4),isNaN(n)?a+="==":(a+=l.charAt((15&n)<<2|i>>6),a+=isNaN(i)?"=":l.charAt(63&i)),t&&a.length>t&&(s+=a.substr(0,t)+"\r\n",a=a.substr(t));return s+=a},o.binary.base64.decode=function(e,t,r){var n,i,a,s,o=t;o||(o=new Uint8Array(3*Math.ceil(e.length/4))),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var u=0,c=r=r||0;u<e.length;)n=h[e.charCodeAt(u++)-43],i=h[e.charCodeAt(u++)-43],a=h[e.charCodeAt(u++)-43],s=h[e.charCodeAt(u++)-43],o[c++]=n<<2|i>>4,64!==a&&(o[c++]=(15&i)<<4|a>>2,64!==s&&(o[c++]=(3&a)<<6|s));return t?c-r:o.subarray(0,c)},o.binary.base58.encode=function(e,t){return o.binary.baseN.encode(e,f,t)},o.binary.base58.decode=function(e,t){return o.binary.baseN.decode(e,f,t)},o.text={utf8:{},utf16:{}},o.text.utf8.encode=function(e,t,r){e=o.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length));for(var i=r=r||0,a=0;a<e.length;++a)n[i++]=e.charCodeAt(a);return t?i-r:n},o.text.utf8.decode=function(e){return o.decodeUtf8(String.fromCharCode.apply(null,e))},o.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(2*e.length));for(var i=new Uint16Array(n.buffer),a=r=r||0,s=r,o=0;o<e.length;++o)i[s++]=e.charCodeAt(o),a+=2;return t?a-r:n},o.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))},o.deflate=function(e,t,r){if(t=o.decode64(e.deflate(o.encode64(t)).rval),r){var n=2;32&t.charCodeAt(1)&&(n=6),t=t.substring(n,t.length-4)}return t},o.inflate=function(e,t,r){var n=e.inflate(o.encode64(t)).rval;return null===n?null:o.decode64(n)};var d=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(null===r?n=e.removeItem(t):(r=o.encode64(JSON.stringify(r)),n=e.setItem(t,r)),"undefined"!==typeof n&&!0!==n.rval){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},p=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(null===r.rval){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return null!==r&&(r=JSON.parse(o.decode64(r))),r},v=function(e,t,r,n){var i=p(e,t);null===i&&(i={}),i[r]=n,d(e,t,i)},g=function(e,t,r){var n=p(e,t);return null!==n&&(n=r in n?n[r]:null),n},y=function(e,t,r){var n=p(e,t);if(null!==n&&r in n){delete n[r];var i=!0;for(var a in n){i=!1;break}i&&(n=null),d(e,t,n)}},m=function(e,t){d(e,t,null)},b=function(e,t,r){var n,i=null;"undefined"===typeof r&&(r=["web","flash"]);var a=!1,s=null;for(var o in r){n=r[o];try{if("flash"===n||"both"===n){if(null===t[0])throw new Error("Flash local storage not available.");i=e.apply(this,t),a="flash"===n}"web"!==n&&"both"!==n||(t[0]=localStorage,i=e.apply(this,t),a=!0)}catch(u){s=u}if(a)break}if(!a)throw s;return i};o.setItem=function(e,t,r,n,i){b(v,arguments,i)},o.getItem=function(e,t,r,n){return b(g,arguments,n)},o.removeItem=function(e,t,r,n){b(y,arguments,n)},o.clearItems=function(e,t,r){b(m,arguments,r)},o.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},o.format=function(e){for(var t,r,n=/%./g,i=0,a=[],s=0;t=n.exec(e);){(r=e.substring(s,n.lastIndex-2)).length>0&&a.push(r),s=n.lastIndex;var o=t[0][1];switch(o){case"s":case"o":i<arguments.length?a.push(arguments[1+i++]):a.push("<?>");break;case"%":a.push("%");break;default:a.push("<%"+o+"?>")}}return a.push(e.substring(s)),a.join("")},o.formatNumber=function(e,t,r,n){var i=e,a=isNaN(t=Math.abs(t))?2:t,s=void 0===r?",":r,o=void 0===n?".":n,u=i<0?"-":"",c=parseInt(i=Math.abs(+i||0).toFixed(a),10)+"",l=c.length>3?c.length%3:0;return u+(l?c.substr(0,l)+o:"")+c.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+o)+(a?s+Math.abs(i-c).toFixed(a).slice(2):"")},o.formatSize=function(e){return e=e>=1073741824?o.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?o.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?o.formatNumber(e/1024,0)+" KiB":o.formatNumber(e,0)+" bytes"},o.bytesFromIP=function(e){return-1!==e.indexOf(".")?o.bytesFromIPv4(e):-1!==e.indexOf(":")?o.bytesFromIPv6(e):null},o.bytesFromIPv4=function(e){if(4!==(e=e.split(".")).length)return null;for(var t=o.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()},o.bytesFromIPv6=function(e){for(var t=0,r=2*(8-(e=e.split(":").filter((function(e){return 0===e.length&&++t,!0}))).length+t),n=o.createBuffer(),i=0;i<8;++i)if(e[i]&&0!==e[i].length){var a=o.hexToBytes(e[i]);a.length<2&&n.putByte(0),n.putBytes(a)}else n.fillWithByte(0,r),r=0;return n.getBytes()},o.bytesToIP=function(e){return 4===e.length?o.bytesToIPv4(e):16===e.length?o.bytesToIPv6(e):null},o.bytesToIPv4=function(e){if(4!==e.length)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")},o.bytesToIPv6=function(e){if(16!==e.length)return null;for(var t=[],r=[],n=0,i=0;i<e.length;i+=2){for(var a=o.bytesToHex(e[i]+e[i+1]);"0"===a[0]&&"0"!==a;)a=a.substr(1);if("0"===a){var s=r[r.length-1],u=t.length;s&&u===s.end+1?(s.end=u,s.end-s.start>r[n].end-r[n].start&&(n=r.length-1)):r.push({start:u,end:u})}t.push(a)}if(r.length>0){var c=r[n];c.end-c.start>0&&(t.splice(c.start,c.end-c.start+1,""),0===c.start&&t.unshift(""),7===c.end&&t.push(""))}return t.join(":")},o.estimateCores=function(e,t){if("function"===typeof e&&(t=e,e={}),e=e||{},"cores"in o&&!e.update)return t(null,o.cores);if("undefined"!==typeof navigator&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return o.cores=navigator.hardwareConcurrency,t(null,o.cores);if("undefined"===typeof Worker)return o.cores=1,t(null,o.cores);if("undefined"===typeof Blob)return o.cores=2,t(null,o.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",(function(e){for(var t=Date.now(),r=t+4;Date.now()<r;);self.postMessage({st:t,et:r})}))}.toString(),")()"],{type:"application/javascript"}));!function e(n,i,a){if(0===i){var s=Math.floor(n.reduce((function(e,t){return e+t}),0)/n.length);return o.cores=Math.max(1,s),URL.revokeObjectURL(r),t(null,o.cores)}!function(e,t){for(var n=[],i=[],a=0;a<e;++a){var s=new Worker(r);s.addEventListener("message",(function(r){if(i.push(r.data),i.length===e){for(var a=0;a<e;++a)n[a].terminate();t(null,i)}})),n.push(s)}for(a=0;a<e;++a)n[a].postMessage(a)}(a,(function(t,r){n.push(function(e,t){for(var r=[],n=0;n<e;++n)for(var i=t[n],a=r[n]=[],s=0;s<e;++s)if(n!==s){var o=t[s];(i.st>o.st&&i.st<o.et||o.st>i.st&&o.st<i.et)&&a.push(s)}return r.reduce((function(e,t){return Math.max(e,t.length)}),0)}(a,r)),e(n,i-1,a)}))}([],5,16)}},1426:function(e){var t,r,n=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"===typeof setTimeout?setTimeout:i}catch(e){t=i}try{r="function"===typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var o,u=[],c=!1,l=-1;function h(){c&&o&&(c=!1,o.length?u=o.concat(u):l=-1,u.length&&f())}function f(){if(!c){var e=s(h);c=!0;for(var t=u.length;t;){for(o=u,u=[];++l<t;)o&&o[l].run();l=-1,t=u.length}o=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function p(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new d(e,t)),1!==u.length||c||s(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},886:function(e,t,r){"use strict";e.exports=r(4722)},4722:function(e,t,r){"use strict";var n=t;function i(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=r(7063),n.BufferWriter=r(2815),n.Reader=r(6216),n.BufferReader=r(3557),n.util=r(3097),n.rpc=r(9994),n.roots=r(7907),n.configure=i,i()},6216:function(e,t,r){"use strict";e.exports=u;var n,i=r(3097),a=i.LongBits,s=i.utf8;function o(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function u(e){this.buf=e,this.pos=0,this.len=e.length}var c="undefined"!==typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new u(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new u(e);throw Error("illegal buffer")},l=function(){return i.Buffer?function(e){return(u.create=function(e){return i.Buffer.isBuffer(e)?new n(e):c(e)})(e)}:c};function h(){var e=new a(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw o(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw o(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function f(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function d(){if(this.pos+8>this.len)throw o(this,8);return new a(f(this.buf,this.pos+=4),f(this.buf,this.pos+=4))}u.create=l(),u.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,u.prototype.uint32=function(){var e=4294967295;return function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len)throw this.pos=this.len,o(this,10);return e}}(),u.prototype.int32=function(){return 0|this.uint32()},u.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},u.prototype.bool=function(){return 0!==this.uint32()},u.prototype.fixed32=function(){if(this.pos+4>this.len)throw o(this,4);return f(this.buf,this.pos+=4)},u.prototype.sfixed32=function(){if(this.pos+4>this.len)throw o(this,4);return 0|f(this.buf,this.pos+=4)},u.prototype.float=function(){if(this.pos+4>this.len)throw o(this,4);var e=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},u.prototype.double=function(){if(this.pos+8>this.len)throw o(this,4);var e=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},u.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw o(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,r);if(t===r){var n=i.Buffer;return n?n.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,r)},u.prototype.string=function(){var e=this.bytes();return s.read(e,0,e.length)},u.prototype.skip=function(e){if("number"===typeof e){if(this.pos+e>this.len)throw o(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw o(this)}while(128&this.buf[this.pos++]);return this},u.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!==(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},u._configure=function(e){n=e,u.create=l(),n._configure();var t=i.Long?"toLong":"toNumber";i.merge(u.prototype,{int64:function(){return h.call(this)[t](!1)},uint64:function(){return h.call(this)[t](!0)},sint64:function(){return h.call(this).zzDecode()[t](!1)},fixed64:function(){return d.call(this)[t](!0)},sfixed64:function(){return d.call(this)[t](!1)}})}},3557:function(e,t,r){"use strict";e.exports=a;var n=r(6216);(a.prototype=Object.create(n.prototype)).constructor=a;var i=r(3097);function a(e){n.call(this,e)}a._configure=function(){i.Buffer&&(a.prototype._slice=i.Buffer.prototype.slice)},a.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},a._configure()},7907:function(e){"use strict";e.exports={}},9994:function(e,t,r){"use strict";t.Service=r(4281)},4281:function(e,t,r){"use strict";e.exports=i;var n=r(3097);function i(e,t,r){if("function"!==typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}(i.prototype=Object.create(n.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function e(t,r,i,a,s){if(!a)throw TypeError("request must be specified");var o=this;if(!s)return n.asPromise(e,o,t,r,i,a);if(o.rpcImpl)try{return o.rpcImpl(t,r[o.requestDelimited?"encodeDelimited":"encode"](a).finish(),(function(e,r){if(e)return o.emit("error",e,t),s(e);if(null!==r){if(!(r instanceof i))try{r=i[o.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return o.emit("error",e,t),s(e)}return o.emit("data",r,t),s(null,r)}o.end(!0)}))}catch(u){return o.emit("error",u,t),void setTimeout((function(){s(u)}),0)}else setTimeout((function(){s(Error("already ended"))}),0)},i.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},9351:function(e,t,r){"use strict";e.exports=i;var n=r(3097);function i(e,t){this.lo=e>>>0,this.hi=t>>>0}var a=i.zero=new i(0,0);a.toNumber=function(){return 0},a.zzEncode=a.zzDecode=function(){return this},a.length=function(){return 1};var s=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(e){if(0===e)return a;var t=e<0;t&&(e=-e);var r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new i(r,n)},i.from=function(e){if("number"===typeof e)return i.fromNumber(e);if(n.isString(e)){if(!n.Long)return i.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new i(e.low>>>0,e.high>>>0):a},i.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var o=String.prototype.charCodeAt;i.fromHash=function(e){return e===s?a:new i((o.call(e,0)|o.call(e,1)<<8|o.call(e,2)<<16|o.call(e,3)<<24)>>>0,(o.call(e,4)|o.call(e,5)<<8|o.call(e,6)<<16|o.call(e,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},i.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},i.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}},3097:function(e,t,r){"use strict";var n=t;function i(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)void 0!==e[n[i]]&&r||(e[n[i]]=t[n[i]]);return e}function a(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&i(this,r)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}n.asPromise=r(7206),n.base64=r(1),n.EventEmitter=r(7111),n.float=r(802),n.inquire=r(7172),n.utf8=r(3861),n.pool=r(8236),n.LongBits=r(9351),n.isNode=Boolean("undefined"!==typeof r.g&&r.g&&r.g.process&&r.g.process.versions&&r.g.process.versions.node),n.global=n.isNode&&r.g||"undefined"!==typeof window&&window||"undefined"!==typeof self&&self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"===typeof e||e instanceof String},n.isObject=function(e){return e&&"object"===typeof e},n.isset=n.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!==typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(t){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"===typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"===typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!==typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var r=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))},n.merge=i,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=a,n.ProtocolError=a("ProtocolError"),n.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},n.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}},7063:function(e,t,r){"use strict";e.exports=h;var n,i=r(3097),a=i.LongBits,s=i.base64,o=i.utf8;function u(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function c(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function h(){this.len=0,this.head=new u(c,0,0),this.tail=this.head,this.states=null}var f=function(){return i.Buffer?function(){return(h.create=function(){return new n})()}:function(){return new h}};function d(e,t,r){t[r]=255&e}function p(e,t){this.len=e,this.next=void 0,this.val=t}function v(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function g(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}h.create=f(),h.alloc=function(e){return new i.Array(e)},i.Array!==Array&&(h.alloc=i.pool(h.alloc,i.Array.prototype.subarray)),h.prototype._push=function(e,t,r){return this.tail=this.tail.next=new u(e,t,r),this.len+=t,this},p.prototype=Object.create(u.prototype),p.prototype.fn=function(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e},h.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new p((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},h.prototype.int32=function(e){return e<0?this._push(v,10,a.fromNumber(e)):this.uint32(e)},h.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},h.prototype.uint64=function(e){var t=a.from(e);return this._push(v,t.length(),t)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(e){var t=a.from(e).zzEncode();return this._push(v,t.length(),t)},h.prototype.bool=function(e){return this._push(d,1,e?1:0)},h.prototype.fixed32=function(e){return this._push(g,4,e>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(e){var t=a.from(e);return this._push(g,4,t.lo)._push(g,4,t.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(e){return this._push(i.float.writeFloatLE,4,e)},h.prototype.double=function(e){return this._push(i.float.writeDoubleLE,8,e)};var y=i.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};h.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(d,1,0);if(i.isString(e)){var r=h.alloc(t=s.length(e));s.decode(e,r,0),e=r}return this.uint32(t)._push(y,t,e)},h.prototype.string=function(e){var t=o.length(e);return t?this.uint32(t)._push(o.write,t,e):this._push(d,1,0)},h.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new u(c,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new u(c,0,0),this.len=0),this},h.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},h.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},h._configure=function(e){n=e,h.create=f(),n._configure()}},2815:function(e,t,r){"use strict";e.exports=a;var n=r(7063);(a.prototype=Object.create(n.prototype)).constructor=a;var i=r(3097);function a(){n.call(this)}function s(e,t,r){e.length<40?i.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}a._configure=function(){a.alloc=i._Buffer_allocUnsafe,a.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&"set"===i.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}},a.prototype.bytes=function(e){i.isString(e)&&(e=i._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(a.writeBytesBuffer,t,e),this},a.prototype.string=function(e){var t=i.Buffer.byteLength(e);return this.uint32(t),t&&this._push(s,t,e),this},a._configure()},760:function(e,t,r){var n=r(9361).instantiate;function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!i.supported)return null;var t=new Uint8Array([0,97,115,109,1,0,0,0,1,78,14,96,2,127,126,0,96,1,127,1,126,96,2,127,127,0,96,1,127,1,127,96,1,127,0,96,2,127,127,1,127,96,3,127,127,127,1,127,96,0,0,96,3,127,127,127,0,96,0,1,127,96,4,127,127,127,127,0,96,5,127,127,127,127,127,1,127,96,1,126,1,127,96,2,126,126,1,126,2,13,1,3,101,110,118,5,97,98,111,114,116,0,10,3,54,53,2,2,8,9,3,5,2,8,6,5,3,4,2,6,9,12,13,2,5,11,3,2,3,2,3,2,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,6,7,7,4,4,5,3,1,0,1,6,47,9,127,1,65,0,11,127,1,65,0,11,127,0,65,3,11,127,0,65,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,127,0,65,240,2,11,127,0,65,6,11,7,240,5,41,6,109,101,109,111,114,121,2,0,7,95,95,97,108,108,111,99,0,10,8,95,95,114,101,116,97,105,110,0,11,9,95,95,114,101,108,101,97,115,101,0,12,9,95,95,99,111,108,108,101,99,116,0,51,11,95,95,114,116,116,105,95,98,97,115,101,3,7,13,73,110,116,51,50,65,114,114,97,121,95,73,68,3,2,13,85,105,110,116,56,65,114,114,97,121,95,73,68,3,3,6,100,101,103,114,101,101,0,16,3,109,111,100,0,17,5,82,97,98,105,110,3,8,16,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,0,21,16,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,0,22,21,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,23,21,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,24,14,82,97,98,105,110,35,103,101,116,58,119,112,111,115,0,25,14,82,97,98,105,110,35,115,101,116,58,119,112,111,115,0,26,15,82,97,98,105,110,35,103,101,116,58,99,111,117,110,116,0,27,15,82,97,98,105,110,35,115,101,116,58,99,111,117,110,116,0,28,13,82,97,98,105,110,35,103,101,116,58,112,111,115,0,29,13,82,97,98,105,110,35,115,101,116,58,112,111,115,0,30,15,82,97,98,105,110,35,103,101,116,58,115,116,97,114,116,0,31,15,82,97,98,105,110,35,115,101,116,58,115,116,97,114,116,0,32,16,82,97,98,105,110,35,103,101,116,58,100,105,103,101,115,116,0,33,16,82,97,98,105,110,35,115,101,116,58,100,105,103,101,115,116,0,34,21,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,35,21,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,36,22,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,37,22,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,38,31,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,39,31,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,40,20,82,97,98,105,110,35,103,101,116,58,112,111,108,121,110,111,109,105,97,108,0,41,20,82,97,98,105,110,35,115,101,116,58,112,111,108,121,110,111,109,105,97,108,0,42,17,82,97,98,105,110,35,103,101,116,58,109,105,110,115,105,122,101,0,43,17,82,97,98,105,110,35,115,101,116,58,109,105,110,115,105,122,101,0,44,17,82,97,98,105,110,35,103,101,116,58,109,97,120,115,105,122,101,0,45,17,82,97,98,105,110,35,115,101,116,58,109,97,120,115,105,122,101,0,46,14,82,97,98,105,110,35,103,101,116,58,109,97,115,107,0,47,14,82,97,98,105,110,35,115,101,116,58,109,97,115,107,0,48,17,82,97,98,105,110,35,99,111,110,115,116,114,117,99,116,111,114,0,20,17,82,97,98,105,110,35,102,105,110,103,101,114,112,114,105,110,116,0,49,8,1,50,10,165,31,53,199,1,1,4,127,32,1,40,2,0,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,3,65,4,107,118,65,16,115,33,4,32,3,65,7,107,11,33,3,32,1,40,2,20,33,2,32,1,40,2,16,34,5,4,64,32,5,32,2,54,2,20,11,32,2,4,64,32,2,32,5,54,2,16,11,32,1,32,0,32,4,32,3,65,4,116,106,65,2,116,106,40,2,96,70,4,64,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,2,54,2,96,32,2,69,4,64,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,65,127,115,113,34,1,54,2,4,32,1,69,4,64,32,0,32,0,40,2,0,65,1,32,3,116,65,127,115,113,54,2,0,11,11,11,11,226,2,1,6,127,32,1,40,2,0,33,3,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,34,5,65,1,113,4,64,32,3,65,124,113,65,16,106,32,5,65,124,113,106,34,2,65,240,255,255,255,3,73,4,64,32,0,32,4,16,1,32,1,32,2,32,3,65,3,113,114,34,3,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,33,5,11,11,32,3,65,2,113,4,64,32,1,65,4,107,40,2,0,34,2,40,2,0,34,6,65,124,113,65,16,106,32,3,65,124,113,106,34,7,65,240,255,255,255,3,73,4,64,32,0,32,2,16,1,32,2,32,7,32,6,65,3,113,114,34,3,54,2,0,32,2,33,1,11,11,32,4,32,5,65,2,114,54,2,0,32,4,65,4,107,32,1,54,2,0,32,0,32,3,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,2,65,4,107,118,65,16,115,33,4,32,2,65,7,107,11,34,3,65,4,116,32,4,106,65,2,116,106,40,2,96,33,2,32,1,65,0,54,2,16,32,1,32,2,54,2,20,32,2,4,64,32,2,32,1,54,2,16,11,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,1,54,2,96,32,0,32,0,40,2,0,65,1,32,3,116,114,54,2,0,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,114,54,2,4,11,119,1,1,127,32,2,2,127,32,0,40,2,160,12,34,2,4,64,32,2,32,1,65,16,107,70,4,64,32,2,40,2,0,33,3,32,1,65,16,107,33,1,11,11,32,1,11,107,34,2,65,48,73,4,64,15,11,32,1,32,3,65,2,113,32,2,65,32,107,65,1,114,114,54,2,0,32,1,65,0,54,2,16,32,1,65,0,54,2,20,32,1,32,2,106,65,16,107,34,2,65,2,54,2,0,32,0,32,2,54,2,160,12,32,0,32,1,16,2,11,155,1,1,3,127,35,0,34,0,69,4,64,65,1,63,0,34,0,74,4,127,65,1,32,0,107,64,0,65,0,72,5,65,0,11,4,64,0,11,65,176,3,34,0,65,0,54,2,0,65,208,15,65,0,54,2,0,3,64,32,1,65,23,73,4,64,32,1,65,2,116,65,176,3,106,65,0,54,2,4,65,0,33,2,3,64,32,2,65,16,73,4,64,32,1,65,4,116,32,2,106,65,2,116,65,176,3,106,65,0,54,2,96,32,2,65,1,106,33,2,12,1,11,11,32,1,65,1,106,33,1,12,1,11,11,65,176,3,65,224,15,63,0,65,16,116,16,3,65,176,3,36,0,11,32,0,11,45,0,32,0,65,240,255,255,255,3,79,4,64,65,32,65,224,0,65,201,3,65,29,16,0,0,11,32,0,65,15,106,65,112,113,34,0,65,16,32,0,65,16,75,27,11,169,1,1,1,127,32,0,32,1,65,128,2,73,4,127,32,1,65,4,118,33,1,65,0,5,32,1,65,248,255,255,255,1,73,4,64,32,1,65,1,65,27,32,1,103,107,116,106,65,1,107,33,1,11,32,1,65,31,32,1,103,107,34,2,65,4,107,118,65,16,115,33,1,32,2,65,7,107,11,34,2,65,2,116,106,40,2,4,65,127,32,1,116,113,34,1,4,127,32,0,32,1,104,32,2,65,4,116,106,65,2,116,106,40,2,96,5,32,0,40,2,0,65,127,32,2,65,1,106,116,113,34,1,4,127,32,0,32,0,32,1,104,34,0,65,2,116,106,40,2,4,104,32,0,65,4,116,106,65,2,116,106,40,2,96,5,65,0,11,11,11,111,1,1,127,63,0,34,2,32,1,65,248,255,255,255,1,73,4,127,32,1,65,1,65,27,32,1,103,107,116,65,1,107,106,5,32,1,11,65,16,32,0,40,2,160,12,32,2,65,16,116,65,16,107,71,116,106,65,255,255,3,106,65,128,128,124,113,65,16,118,34,1,32,2,32,1,74,27,64,0,65,0,72,4,64,32,1,64,0,65,0,72,4,64,0,11,11,32,0,32,2,65,16,116,63,0,65,16,116,16,3,11,113,1,2,127,32,1,40,2,0,34,3,65,124,113,32,2,107,34,4,65,32,79,4,64,32,1,32,2,32,3,65,2,113,114,54,2,0,32,2,32,1,65,16,106,106,34,1,32,4,65,16,107,65,1,114,54,2,0,32,0,32,1,16,2,5,32,1,32,3,65,126,113,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,32,1,65,16,106,32,1,40,2,0,65,124,113,106,40,2,0,65,125,113,54,2,0,11,11,91,1,2,127,32,0,32,1,16,5,34,4,16,6,34,3,69,4,64,65,1,36,1,65,0,36,1,32,0,32,4,16,6,34,3,69,4,64,32,0,32,4,16,7,32,0,32,4,16,6,33,3,11,11,32,3,65,0,54,2,4,32,3,32,2,54,2,8,32,3,32,1,54,2,12,32,0,32,3,16,1,32,0,32,3,32,4,16,8,32,3,11,13,0,16,4,32,0,32,1,16,9,65,16,106,11,33,1,1,127,32,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,18,0,32,0,65,172,3,75,4,64,32,0,65,16,107,16,52,11,11,140,3,1,1,127,2,64,32,1,69,13,0,32,0,65,0,58,0,0,32,0,32,1,106,65,1,107,65,0,58,0,0,32,1,65,2,77,13,0,32,0,65,1,106,65,0,58,0,0,32,0,65,2,106,65,0,58,0,0,32,0,32,1,106,34,2,65,2,107,65,0,58,0,0,32,2,65,3,107,65,0,58,0,0,32,1,65,6,77,13,0,32,0,65,3,106,65,0,58,0,0,32,0,32,1,106,65,4,107,65,0,58,0,0,32,1,65,8,77,13,0,32,1,65,0,32,0,107,65,3,113,34,1,107,33,2,32,0,32,1,106,34,0,65,0,54,2,0,32,0,32,2,65,124,113,34,1,106,65,4,107,65,0,54,2,0,32,1,65,8,77,13,0,32,0,65,4,106,65,0,54,2,0,32,0,65,8,106,65,0,54,2,0,32,0,32,1,106,34,2,65,12,107,65,0,54,2,0,32,2,65,8,107,65,0,54,2,0,32,1,65,24,77,13,0,32,0,65,12,106,65,0,54,2,0,32,0,65,16,106,65,0,54,2,0,32,0,65,20,106,65,0,54,2,0,32,0,65,24,106,65,0,54,2,0,32,0,32,1,106,34,2,65,28,107,65,0,54,2,0,32,2,65,24,107,65,0,54,2,0,32,2,65,20,107,65,0,54,2,0,32,2,65,16,107,65,0,54,2,0,32,0,32,0,65,4,113,65,24,106,34,2,106,33,0,32,1,32,2,107,33,1,3,64,32,1,65,32,79,4,64,32,0,66,0,55,3,0,32,0,65,8,106,66,0,55,3,0,32,0,65,16,106,66,0,55,3,0,32,0,65,24,106,66,0,55,3,0,32,1,65,32,107,33,1,32,0,65,32,106,33,0,12,1,11,11,11,11,178,1,1,3,127,32,1,65,240,255,255,255,3,32,2,118,75,4,64,65,144,1,65,192,1,65,23,65,56,16,0,0,11,32,1,32,2,116,34,3,65,0,16,10,34,2,32,3,16,13,32,0,69,4,64,65,12,65,2,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,2,34,1,32,0,40,2,0,34,4,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,32,4,16,12,11,32,0,32,1,54,2,0,32,0,32,2,54,2,4,32,0,32,3,54,2,8,32,0,11,46,1,2,127,65,12,65,5,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,65,128,2,65,3,16,14,11,9,0,65,63,32,0,121,167,107,11,49,1,2,127,65,63,32,1,121,167,107,33,2,3,64,65,63,32,0,121,167,107,32,2,107,34,3,65,0,78,4,64,32,0,32,1,32,3,172,134,133,33,0,12,1,11,11,32,0,11,40,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,163,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,65,0,58,0,0,11,38,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,152,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,45,0,0,11,254,5,2,1,127,4,126,32,0,69,4,64,65,232,0,65,6,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,24,32,0,66,0,55,3,32,32,0,66,0,55,3,40,32,0,66,0,55,3,48,32,0,66,0,55,3,56,32,0,66,0,55,3,64,32,0,66,0,55,3,72,32,0,66,0,55,3,80,32,0,66,0,55,3,88,32,0,66,0,55,3,96,32,0,32,2,173,55,3,80,32,0,32,3,173,55,3,88,65,12,65,4,16,10,34,2,65,172,3,75,4,64,32,2,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,32,4,65,0,16,14,33,2,32,0,40,2,0,16,12,32,0,32,2,54,2,0,32,0,32,4,54,2,4,32,0,66,1,32,1,173,134,66,1,125,55,3,96,32,0,66,243,130,183,218,216,230,232,30,55,3,72,35,4,69,4,64,65,0,33,2,3,64,32,2,65,128,2,72,4,64,32,2,65,255,1,113,173,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,65,0,33,4,3,64,32,4,32,0,40,2,4,65,1,107,72,4,64,32,6,66,8,134,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,32,4,65,1,106,33,4,12,1,11,11,35,6,40,2,4,32,2,65,3,116,106,32,6,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,63,32,0,41,3,72,121,167,107,172,33,7,65,0,33,2,3,64,32,2,65,128,2,72,4,64,35,5,33,1,32,2,172,32,7,134,34,8,33,6,65,63,32,0,41,3,72,34,9,121,167,107,33,3,3,64,65,63,32,6,121,167,107,32,3,107,34,4,65,0,78,4,64,32,6,32,9,32,4,172,134,133,33,6,12,1,11,11,32,1,40,2,4,32,2,65,3,116,106,32,6,32,8,132,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,1,36,4,11,32,0,66,0,55,3,24,32,0,66,0,55,3,32,65,0,33,2,3,64,32,2,32,0,40,2,4,72,4,64,32,0,40,2,0,32,2,16,18,32,2,65,1,106,33,2,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,6,66,45,136,167,65,3,116,106,41,3,0,32,6,66,8,134,66,1,132,133,55,3,40,32,0,11,38,1,1,127,32,0,40,2,0,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,55,1,2,127,32,1,32,0,40,2,0,34,2,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,16,12,11,32,0,32,1,54,2,0,11,7,0,32,0,40,2,4,11,9,0,32,0,32,1,54,2,4,11,7,0,32,0,40,2,8,11,9,0,32,0,32,1,54,2,8,11,7,0,32,0,41,3,16,11,9,0,32,0,32,1,55,3,16,11,7,0,32,0,41,3,24,11,9,0,32,0,32,1,55,3,24,11,7,0,32,0,41,3,32,11,9,0,32,0,32,1,55,3,32,11,7,0,32,0,41,3,40,11,9,0,32,0,32,1,55,3,40,11,7,0,32,0,41,3,48,11,9,0,32,0,32,1,55,3,48,11,7,0,32,0,41,3,56,11,9,0,32,0,32,1,55,3,56,11,7,0,32,0,41,3,64,11,9,0,32,0,32,1,55,3,64,11,7,0,32,0,41,3,72,11,9,0,32,0,32,1,55,3,72,11,7,0,32,0,41,3,80,11,9,0,32,0,32,1,55,3,80,11,7,0,32,0,41,3,88,11,9,0,32,0,32,1,55,3,88,11,7,0,32,0,41,3,96,11,9,0,32,0,32,1,55,3,96,11,172,4,2,5,127,1,126,32,2,65,172,3,75,4,64,32,2,65,16,107,34,4,32,4,40,2,4,65,1,106,54,2,4,11,32,2,33,4,65,0,33,2,32,1,40,2,8,33,5,32,1,40,2,4,33,6,3,64,2,127,65,0,33,3,3,64,32,3,32,5,72,4,64,32,3,32,6,106,45,0,0,33,1,32,0,40,2,0,32,0,40,2,8,16,19,33,7,32,0,40,2,8,32,0,40,2,0,40,2,4,106,32,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,7,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,1,173,32,8,66,8,134,132,133,55,3,40,32,0,32,0,41,3,16,66,1,124,55,3,16,32,0,32,0,41,3,24,66,1,124,55,3,24,32,0,41,3,16,32,0,41,3,80,90,4,127,32,0,41,3,40,32,0,41,3,96,131,80,5,65,0,11,4,127,65,1,5,32,0,41,3,16,32,0,41,3,88,90,11,4,64,32,0,32,0,41,3,32,55,3,48,32,0,32,0,41,3,16,55,3,56,32,0,32,0,41,3,40,55,3,64,65,0,33,1,3,64,32,1,32,0,40,2,4,72,4,64,32,0,40,2,0,32,1,16,18,32,1,65,1,106,33,1,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,8,66,8,134,66,1,132,133,55,3,40,32,3,65,1,106,12,3,11,32,3,65,1,106,33,3,12,1,11,11,65,127,11,34,1,65,0,78,4,64,32,5,32,1,107,33,5,32,1,32,6,106,33,6,32,2,34,1,65,1,106,33,2,32,4,40,2,4,32,1,65,2,116,106,32,0,41,3,56,62,2,0,12,1,11,11,32,4,11,10,0,16,15,36,5,16,15,36,6,11,3,0,1,11,73,1,2,127,32,0,40,2,4,34,1,65,255,255,255,255,0,113,34,2,65,1,70,4,64,32,0,65,16,106,16,53,32,0,32,0,40,2,0,65,1,114,54,2,0,35,0,32,0,16,2,5,32,0,32,2,65,1,107,32,1,65,128,128,128,128,127,113,114,54,2,4,11,11,58,0,2,64,2,64,2,64,32,0,65,8,107,40,2,0,14,7,0,0,1,1,1,1,1,2,11,15,11,32,0,40,2,0,34,0,4,64,32,0,65,172,3,79,4,64,32,0,65,16,107,16,52,11,11,15,11,0,11,11,137,3,7,0,65,16,11,55,40,0,0,0,1,0,0,0,1,0,0,0,40,0,0,0,97,0,108,0,108,0,111,0,99,0,97,0,116,0,105,0,111,0,110,0,32,0,116,0,111,0,111,0,32,0,108,0,97,0,114,0,103,0,101,0,65,208,0,11,45,30,0,0,0,1,0,0,0,1,0,0,0,30,0,0,0,126,0,108,0,105,0,98,0,47,0,114,0,116,0,47,0,116,0,108,0,115,0,102,0,46,0,116,0,115,0,65,128,1,11,43,28,0,0,0,1,0,0,0,1,0,0,0,28,0,0,0,73,0,110,0,118,0,97,0,108,0,105,0,100,0,32,0,108,0,101,0,110,0,103,0,116,0,104,0,65,176,1,11,53,38,0,0,0,1,0,0,0,1,0,0,0,38,0,0,0,126,0,108,0,105,0,98,0,47,0,97,0,114,0,114,0,97,0,121,0,98,0,117,0,102,0,102,0,101,0,114,0,46,0,116,0,115,0,65,240,1,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,73,0,110,0,100,0,101,0,120,0,32,0,111,0,117,0,116,0,32,0,111,0,102,0,32,0,114,0,97,0,110,0,103,0,101,0,65,176,2,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,126,0,108,0,105,0,98,0,47,0,116,0,121,0,112,0,101,0,100,0,97,0,114,0,114,0,97,0,121,0,46,0,116,0,115,0,65,240,2,11,53,7,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,145,4,0,0,2,0,0,0,49,0,0,0,2,0,0,0,17,1,0,0,2,0,0,0,16,0,34,16,115,111,117,114,99,101,77,97,112,112,105,110,103,85,82,76,16,46,47,114,97,98,105,110,46,119,97,115,109,46,109,97,112]);return n(new Response(new Blob([t],{type:"application/wasm"})),e)}i.supported="undefined"!==typeof WebAssembly,e.exports=i},8729:function(e,t,r){var n=r(7061).default,i=r(7156).default,a=r(2983),s=r(760),o=function(){var e=i(n().mark((function e(t,r,i,o,u){var c;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s();case 2:return c=e.sent,e.abrupt("return",new a(c,t,r,i,o,u));case 4:case"end":return e.stop()}}),e)})));return function(t,r,n,i,a){return e.apply(this,arguments)}}();e.exports={Rabin:a,create:o}},2983:function(e,t,r){var n=r(6690).default,i=r(9728).default,a=function(){"use strict";function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8192,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32768,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:64,o=arguments.length>5?arguments[5]:void 0;n(this,e),this.bits=r,this.min=i,this.max=a,this.asModule=t,this.rabin=new t.Rabin(r,i,a,s,o),this.polynomial=o}return i(e,[{key:"fingerprint",value:function(e){var t=this.asModule,r=t.__retain,n=t.__release,i=t.__allocArray,a=t.__getInt32Array,s=t.Int32Array_ID,o=t.Uint8Array_ID,u=r(i(s,new Int32Array(Math.ceil(e.length/this.min)))),c=r(i(o,e)),l=a(this.rabin.fingerprint(c,u));n(c),n(u);var h=l.indexOf(0);return h>=0?l.subarray(0,h):l}}]),e}();e.exports=a},7896:function(e,t,r){var n=r(8139),i=r(5339),a=r(4052),s=r(3654),o=r(5503),u=o.RateLimiterClusterMaster,c=o.RateLimiterClusterMasterPM2,l=o.RateLimiterCluster,h=r(2408),f=r(8134),d=r(5e3),p=r(4066),v=r(3081),g=r(438),y=r(4819);e.exports={RateLimiterRedis:n,RateLimiterMongo:i,RateLimiterMySQL:a,RateLimiterPostgres:s,RateLimiterMemory:h,RateLimiterMemcache:f,RateLimiterClusterMaster:u,RateLimiterClusterMasterPM2:c,RateLimiterCluster:l,RLWrapperBlackAndWhite:d,RateLimiterUnion:p,RateLimiterQueue:v,BurstyRateLimiter:g,RateLimiterRes:y}},438:function(e,t,r){var n=r(7424).default,i=r(6690).default,a=r(9728).default,s=r(4819);e.exports=function(){"use strict";function e(t,r){i(this,e),this._rateLimiter=t,this._burstLimiter=r}return a(e,[{key:"_combineRes",value:function(e,t){return e?new s(e.remainingPoints,Math.min(e.msBeforeNext,t?t.msBeforeNext:0),e.consumedPoints,e.isFirstInDuration):null}},{key:"consume",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._rateLimiter.consume(e,r,n).catch((function(i){return i instanceof s?t._burstLimiter.consume(e,r,n).then((function(e){return Promise.resolve(t._combineRes(i,e))})).catch((function(e){return e instanceof s?Promise.reject(t._combineRes(i,e)):Promise.reject(e)})):Promise.reject(i)}))}},{key:"get",value:function(e){var t=this;return Promise.all([this._rateLimiter.get(e),this._burstLimiter.get(e)]).then((function(e){var r=n(e,2),i=r[0],a=r[1];return t._combineRes(i,a)}))}},{key:"points",get:function(){return this._rateLimiter.points}}]),e}()},5e3:function(e,t,r){var n=r(6690).default,i=r(9728).default,a=r(4819);e.exports=function(){"use strict";function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,e),this.limiter=t.limiter,this.blackList=t.blackList,this.whiteList=t.whiteList,this.isBlackListed=t.isBlackListed,this.isWhiteListed=t.isWhiteListed,this.runActionAnyway=t.runActionAnyway}return i(e,[{key:"limiter",get:function(){return this._limiter},set:function(e){if("undefined"===typeof e)throw new Error("limiter is not set");this._limiter=e}},{key:"runActionAnyway",get:function(){return this._runActionAnyway},set:function(e){this._runActionAnyway="undefined"!==typeof e&&e}},{key:"blackList",get:function(){return this._blackList},set:function(e){this._blackList=Array.isArray(e)?e:[]}},{key:"isBlackListed",get:function(){return this._isBlackListed},set:function(e){if("undefined"===typeof e&&(e=function(){return!1}),"function"!==typeof e)throw new Error("isBlackListed must be function");this._isBlackListed=e}},{key:"whiteList",get:function(){return this._whiteList},set:function(e){this._whiteList=Array.isArray(e)?e:[]}},{key:"isWhiteListed",get:function(){return this._isWhiteListed},set:function(e){if("undefined"===typeof e&&(e=function(){return!1}),"function"!==typeof e)throw new Error("isWhiteListed must be function");this._isWhiteListed=e}},{key:"isBlackListedSomewhere",value:function(e){return this.blackList.indexOf(e)>=0||this.isBlackListed(e)}},{key:"isWhiteListedSomewhere",value:function(e){return this.whiteList.indexOf(e)>=0||this.isWhiteListed(e)}},{key:"getBlackRes",value:function(){return new a(0,Number.MAX_SAFE_INTEGER,0,!1)}},{key:"getWhiteRes",value:function(){return new a(Number.MAX_SAFE_INTEGER,0,0,!1)}},{key:"rejectBlack",value:function(){return Promise.reject(this.getBlackRes())}},{key:"resolveBlack",value:function(){return Promise.resolve(this.getBlackRes())}},{key:"resolveWhite",value:function(){return Promise.resolve(this.getWhiteRes())}},{key:"consume",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.isWhiteListedSomewhere(e)?t=this.resolveWhite():this.isBlackListedSomewhere(e)&&(t=this.rejectBlack()),"undefined"===typeof t?this.limiter.consume(e,r):(this.runActionAnyway&&this.limiter.consume(e,r).catch((function(){})),t)}},{key:"block",value:function(e,t){var r;return this.isWhiteListedSomewhere(e)?r=this.resolveWhite():this.isBlackListedSomewhere(e)&&(r=this.resolveBlack()),"undefined"===typeof r?this.limiter.block(e,t):(this.runActionAnyway&&this.limiter.block(e,t).catch((function(){})),r)}},{key:"penalty",value:function(e,t){var r;return this.isWhiteListedSomewhere(e)?r=this.resolveWhite():this.isBlackListedSomewhere(e)&&(r=this.resolveBlack()),"undefined"===typeof r?this.limiter.penalty(e,t):(this.runActionAnyway&&this.limiter.penalty(e,t).catch((function(){})),r)}},{key:"reward",value:function(e,t){var r;return this.isWhiteListedSomewhere(e)?r=this.resolveWhite():this.isBlackListedSomewhere(e)&&(r=this.resolveBlack()),"undefined"===typeof r?this.limiter.reward(e,t):(this.runActionAnyway&&this.limiter.reward(e,t).catch((function(){})),r)}},{key:"get",value:function(e){var t;return this.isWhiteListedSomewhere(e)?t=this.resolveWhite():this.isBlackListedSomewhere(e)&&(t=this.resolveBlack()),"undefined"===typeof t||this.runActionAnyway?this.limiter.get(e):t}},{key:"delete",value:function(e){return this.limiter.delete(e)}}]),e}()},8855:function(e,t,r){var n=r(6690).default,i=r(9728).default;e.exports=function(){"use strict";function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,e),this.points=t.points,this.duration=t.duration,this.blockDuration=t.blockDuration,this.execEvenly=t.execEvenly,this.execEvenlyMinDelayMs=t.execEvenlyMinDelayMs,this.keyPrefix=t.keyPrefix}return i(e,[{key:"points",get:function(){return this._points},set:function(e){this._points=e>=0?e:4}},{key:"duration",get:function(){return this._duration},set:function(e){this._duration="undefined"===typeof e?1:e}},{key:"msDuration",get:function(){return 1e3*this.duration}},{key:"blockDuration",get:function(){return this._blockDuration},set:function(e){this._blockDuration="undefined"===typeof e?0:e}},{key:"msBlockDuration",get:function(){return 1e3*this.blockDuration}},{key:"execEvenly",get:function(){return this._execEvenly},set:function(e){this._execEvenly="undefined"!==typeof e&&Boolean(e)}},{key:"execEvenlyMinDelayMs",get:function(){return this._execEvenlyMinDelayMs},set:function(e){this._execEvenlyMinDelayMs="undefined"===typeof e?Math.ceil(this.msDuration/this.points):e}},{key:"keyPrefix",get:function(){return this._keyPrefix},set:function(e){if("undefined"===typeof e&&(e="rlflx"),"string"!==typeof e)throw new Error("keyPrefix must be string");this._keyPrefix=e}},{key:"_getKeySecDuration",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e&&e.customDuration>=0?e.customDuration:this.duration}},{key:"getKey",value:function(e){return this.keyPrefix.length>0?"".concat(this.keyPrefix,":").concat(e):e}},{key:"parseKey",value:function(e){return e.substring(this.keyPrefix.length)}},{key:"consume",value:function(){throw new Error("You have to implement the method 'consume'!")}},{key:"penalty",value:function(){throw new Error("You have to implement the method 'penalty'!")}},{key:"reward",value:function(){throw new Error("You have to implement the method 'reward'!")}},{key:"get",value:function(){throw new Error("You have to implement the method 'get'!")}},{key:"set",value:function(){throw new Error("You have to implement the method 'set'!")}},{key:"block",value:function(){throw new Error("You have to implement the method 'block'!")}},{key:"delete",value:function(){throw new Error("You have to implement the method 'delete'!")}}]),e}()},5503:function(e,t,r){var n=r(1426),i=r(6115).default,a=r(1655).default,s=r(6389).default,o=r(9728).default,u=r(6690).default,c=r(1265),l=r(5539),h=r(8855),f=r(2408),d=r(4819),p="rate_limiter_flexible",v=null,g=function(e,t,r,n){var i;i=null===n||!0===n||!1===n?n:{remainingPoints:n.remainingPoints,msBeforeNext:n.msBeforeNext,consumedPoints:n.consumedPoints,isFirstInDuration:n.isFirstInDuration},e.send({channel:p,keyPrefix:t.keyPrefix,promiseId:t.promiseId,type:r,data:i})},y=function e(t){var r=this;setTimeout((function(){r._initiated?n.send(t):"undefined"!==typeof r._promises[t.promiseId]&&e.call(r,t)}),30)},m=function(e,t,r,i,a){var s={channel:p,keyPrefix:this.keyPrefix,func:e,promiseId:t,data:{key:r,arg:i,opts:a}};this._initiated?n.send(s):y.call(this,s)},b=function(e,t){if(!t||t.channel!==p||"undefined"===typeof this._rateLimiters[t.keyPrefix])return!1;var r;switch(t.func){case"consume":r=this._rateLimiters[t.keyPrefix].consume(t.data.key,t.data.arg,t.data.opts);break;case"penalty":r=this._rateLimiters[t.keyPrefix].penalty(t.data.key,t.data.arg,t.data.opts);break;case"reward":r=this._rateLimiters[t.keyPrefix].reward(t.data.key,t.data.arg,t.data.opts);break;case"block":r=this._rateLimiters[t.keyPrefix].block(t.data.key,t.data.arg,t.data.opts);break;case"get":r=this._rateLimiters[t.keyPrefix].get(t.data.key,t.data.opts);break;case"delete":r=this._rateLimiters[t.keyPrefix].delete(t.data.key,t.data.opts);break;default:return!1}r&&r.then((function(r){g(e,t,"resolve",r)})).catch((function(r){g(e,t,"reject",r)}))},_=function(e){if(!e||e.channel!==p||e.keyPrefix!==this.keyPrefix)return!1;if(this._promises[e.promiseId]){var t;switch(clearTimeout(this._promises[e.promiseId].timeoutId),t=null===e.data||!0===e.data||!1===e.data?e.data:new d(e.data.remainingPoints,e.data.msBeforeNext,e.data.consumedPoints,e.data.isFirstInDuration),e.type){case"resolve":this._promises[e.promiseId].resolve(t);break;case"reject":this._promises[e.promiseId].reject(t);break;default:throw new Error("RateLimiterCluster: no such message type '".concat(e.type,"'"))}delete this._promises[e.promiseId]}},w=function(){return{points:this.points,duration:this.duration,blockDuration:this.blockDuration,execEvenly:this.execEvenly,execEvenlyMinDelayMs:this.execEvenlyMinDelayMs,keyPrefix:this.keyPrefix}},k=function(e,t){var r=this,i=n.hrtime(),a=i[0].toString()+i[1].toString();return"undefined"!==typeof this._promises[a]&&(a+=l.randomBytes(12).toString("base64")),this._promises[a]={resolve:e,reject:t,timeoutId:setTimeout((function(){delete r._promises[a],t(new Error("RateLimiterCluster timeout: no answer from master in time"))}),this.timeoutMs)},a},x=o((function e(){"use strict";var t=this;if(u(this,e),v)return v;this._rateLimiters={},c.setMaxListeners(0),c.on("message",(function(e,r){r&&r.channel===p&&"init"===r.type?("undefined"===typeof t._rateLimiters[r.opts.keyPrefix]&&(t._rateLimiters[r.opts.keyPrefix]=new f(r.opts)),e.send({channel:p,type:"init",keyPrefix:r.opts.keyPrefix})):b.call(t,e,r)})),v=this})),E=o((function e(t){"use strict";var r=this;if(u(this,e),v)return v;this._rateLimiters={},t.launchBus((function(e,n){n.on("process:msg",(function(e){var n=e.raw;n&&n.channel===p&&"init"===n.type?("undefined"===typeof r._rateLimiters[n.opts.keyPrefix]&&(r._rateLimiters[n.opts.keyPrefix]=new f(n.opts)),t.sendDataToProcessId(e.process.pm_id,{data:{},topic:p,channel:p,type:"init",keyPrefix:n.opts.keyPrefix},(function(e,t){e&&console.log(e,t)}))):b.call(r,{send:function(r){var n=r;n.topic=p,"undefined"===typeof n.data&&(n.data={}),t.sendDataToProcessId(e.process.pm_id,n,(function(e,t){e&&console.log(e,t)}))}},n)}))})),v=this})),S=function(e){"use strict";a(r,e);var t=s(r);function r(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return u(this,r),e=t.call(this,a),n.setMaxListeners(0),e.timeoutMs=a.timeoutMs,e._initiated=!1,n.on("message",(function(t){t&&t.channel===p&&"init"===t.type&&t.keyPrefix===e.keyPrefix?e._initiated=!0:_.call(i(e),t)})),n.send({channel:p,type:"init",opts:w.call(i(e))}),e._promises={},e}return o(r,[{key:"timeoutMs",get:function(){return this._timeoutMs},set:function(e){this._timeoutMs="undefined"===typeof e?5e3:Math.abs(parseInt(e))}},{key:"consume",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(i,a){var s=k.call(t,i,a);m.call(t,"consume",s,e,r,n)}))}},{key:"penalty",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(i,a){var s=k.call(t,i,a);m.call(t,"penalty",s,e,r,n)}))}},{key:"reward",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(i,a){var s=k.call(t,i,a);m.call(t,"reward",s,e,r,n)}))}},{key:"block",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(i,a){var s=k.call(r,i,a);m.call(r,"block",s,e,t,n)}))}},{key:"get",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n,i){var a=k.call(t,n,i);m.call(t,"get",a,e,r)}))}},{key:"delete",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n,i){var a=k.call(t,n,i);m.call(t,"delete",a,e,r)}))}}]),r}(h);e.exports={RateLimiterClusterMaster:x,RateLimiterClusterMasterPM2:E,RateLimiterCluster:S}},8134:function(e,t,r){var n=r(6690).default,i=r(9728).default,a=r(1655).default,s=r(6389).default,o=r(1434),u=r(4819),c=function(e){"use strict";a(r,e);var t=s(r);function r(e){var i;return n(this,r),(i=t.call(this,e)).client=e.storeClient,i}return i(r,[{key:"_getRateLimiterRes",value:function(e,t,r){var n=new u;return n.consumedPoints=parseInt(r.consumedPoints),n.isFirstInDuration=r.consumedPoints===t,n.remainingPoints=Math.max(this.points-n.consumedPoints,0),n.msBeforeNext=r.msBeforeNext,n}},{key:"_upsert",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return new Promise((function(s,o){var u=Date.now(),c=Math.floor(r/1e3);i?n.client.set(e,t,c,(function(r){r?o(r):n.client.set("".concat(e,"_expire"),c>0?u+1e3*c:-1,c,(function(){s({consumedPoints:t,msBeforeNext:c>0?1e3*c:-1})}))})):n.client.incr(e,t,(function(l,h){l||!1===h?n.client.add(e,t,c,(function(l,h){if(l||!h)if("undefined"===typeof a.attemptNumber||a.attemptNumber<3){var f=Object.assign({},a);f.attemptNumber=f.attemptNumber?f.attemptNumber+1:1,n._upsert(e,t,r,i,f).then((function(e){return s(e)})).catch((function(e){return o(e)}))}else o(new Error("Can not add key"));else n.client.add("".concat(e,"_expire"),c>0?u+1e3*c:-1,c,(function(){s({consumedPoints:t,msBeforeNext:c>0?1e3*c:-1})}))})):n.client.get("".concat(e,"_expire"),(function(e,t){if(e)o(e);else{var r=!1===t?0:t,n={consumedPoints:h,msBeforeNext:r>=0?Math.max(r-u,0):-1};s(n)}}))}))}))}},{key:"_get",value:function(e){var t=this;return new Promise((function(r,n){var i=Date.now();t.client.get(e,(function(a,s){s?t.client.get("".concat(e,"_expire"),(function(e,t){if(e)n(e);else{var a=!1===t?0:t,o={consumedPoints:s,msBeforeNext:a>=0?Math.max(a-i,0):-1};r(o)}})):r(null)}))}))}},{key:"_delete",value:function(e){var t=this;return new Promise((function(r,n){t.client.del(e,(function(i,a){i?n(i):!1===a?r(a):t.client.del("".concat(e,"_expire"),(function(e){e?n(e):r(a)}))}))}))}}]),r}(o);e.exports=c},2408:function(e,t,r){var n=r(6690).default,i=r(9728).default,a=r(1655).default,s=r(6389).default,o=r(8855),u=r(4327),c=r(4819),l=function(e){"use strict";a(r,e);var t=s(r);function r(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n(this,r),(e=t.call(this,i))._memoryStorage=new u,e}return i(r,[{key:"consume",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(i,a){var s=t.getKey(e),o=t._getKeySecDuration(n),u=t._memoryStorage.incrby(s,r,o);if(u.remainingPoints=Math.max(t.points-u.consumedPoints,0),u.consumedPoints>t.points)t.blockDuration>0&&u.consumedPoints<=t.points+r&&(u=t._memoryStorage.set(s,u.consumedPoints,t.blockDuration)),a(u);else if(t.execEvenly&&u.msBeforeNext>0&&!u.isFirstInDuration){var c=Math.ceil(u.msBeforeNext/(u.remainingPoints+2));c<t.execEvenlyMinDelayMs&&(c=u.consumedPoints*t.execEvenlyMinDelayMs),setTimeout(i,c,u)}else i(u)}))}},{key:"penalty",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.getKey(e);return new Promise((function(e){var a=t._getKeySecDuration(n),s=t._memoryStorage.incrby(i,r,a);s.remainingPoints=Math.max(t.points-s.consumedPoints,0),e(s)}))}},{key:"reward",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.getKey(e);return new Promise((function(e){var a=t._getKeySecDuration(n),s=t._memoryStorage.incrby(i,-r,a);s.remainingPoints=Math.max(t.points-s.consumedPoints,0),e(s)}))}},{key:"block",value:function(e,t){var r=1e3*t,n=this.points+1;return this._memoryStorage.set(this.getKey(e),n,t),Promise.resolve(new c(0,0===r?-1:r,n))}},{key:"set",value:function(e,t,r){var n=1e3*(r>=0?r:this.duration);return this._memoryStorage.set(this.getKey(e),t,r),Promise.resolve(new c(0,0===n?-1:n,t))}},{key:"get",value:function(e){var t=this._memoryStorage.get(this.getKey(e));return null!==t&&(t.remainingPoints=Math.max(this.points-t.consumedPoints,0)),Promise.resolve(t)}},{key:"delete",value:function(e){return Promise.resolve(this._memoryStorage.delete(this.getKey(e)))}}]),r}(o);e.exports=l},5339:function(e,t,r){var n=r(6690).default,i=r(9728).default,a=r(1655).default,s=r(6389).default,o=r(1434),u=r(4819);function c(e){try{var t=(e.client?e.client:e).topology.s.options.metadata.driver.version.split(".").map((function(e){return parseInt(e)}));return{major:t[0],feature:t[1],patch:t[2]}}catch(r){return{major:0,feature:0,patch:0}}}var l=function(e){"use strict";a(r,e);var t=s(r);function r(e){var i;return n(this,r),(i=t.call(this,e)).dbName=e.dbName,i.tableName=e.tableName,i.indexKeyPrefix=e.indexKeyPrefix,e.mongo?i.client=e.mongo:i.client=e.storeClient,"function"===typeof i.client.then?i.client.then((function(e){i.client=e,i._initCollection(),i._driverVersion=c(i.client)})):(i._initCollection(),i._driverVersion=c(i.client)),i}return i(r,[{key:"dbName",get:function(){return this._dbName},set:function(e){this._dbName="undefined"===typeof e?r.getDbName():e}},{key:"tableName",get:function(){return this._tableName},set:function(e){this._tableName="undefined"===typeof e?this.keyPrefix:e}},{key:"client",get:function(){return this._client},set:function(e){if("undefined"===typeof e)throw new Error("mongo is not set");this._client=e}},{key:"indexKeyPrefix",get:function(){return this._indexKeyPrefix},set:function(e){this._indexKeyPrefix=e||{}}},{key:"_initCollection",value:function(){var e=("function"===typeof this.client.db?this.client.db(this.dbName):this.client).collection(this.tableName);e.createIndex({expire:-1},{expireAfterSeconds:0}),e.createIndex(Object.assign({},this.indexKeyPrefix,{key:1}),{unique:!0}),this._collection=e}},{key:"_getRateLimiterRes",value:function(e,t,r){var n,i=new u;return n="undefined"===typeof r.value?r:r.value,i.isFirstInDuration=n.points===t,i.consumedPoints=n.points,i.remainingPoints=Math.max(this.points-i.consumedPoints,0),i.msBeforeNext=null!==n.expire?Math.max(new Date(n.expire).getTime()-Date.now(),0):-1,i}},{key:"_upsert",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));var s,o,u=a.attrs||{};i?(s={key:e},s=Object.assign(s,u),(o={$set:{key:e,points:t,expire:r>0?new Date(Date.now()+r):null}}).$set=Object.assign(o.$set,u)):(s={$or:[{expire:{$gt:new Date}},{expire:{$eq:null}}],key:e},s=Object.assign(s,u),(o={$setOnInsert:{key:e,expire:r>0?new Date(Date.now()+r):null},$inc:{points:t}}).$setOnInsert=Object.assign(o.$setOnInsert,u));var c={upsert:!0};return this._driverVersion.major>=4||3===this._driverVersion.major&&this._driverVersion.feature>=7||this._driverVersion.feature>=6&&this._driverVersion.patch>=7?c.returnDocument="after":c.returnOriginal=!1,new Promise((function(a,l){n._collection.findOneAndUpdate(s,o,c).then((function(e){a(e)})).catch((function(s){if(s&&11e3===s.code){var o=Object.assign({$or:[{expire:{$lte:new Date}},{expire:{$eq:null}}],key:e},u),h={$set:Object.assign({key:e,points:t,expire:r>0?new Date(Date.now()+r):null},u)};n._collection.findOneAndUpdate(o,h,c).then((function(e){a(e)})).catch((function(s){s&&11e3===s.code?n._upsert(e,t,r,i).then((function(e){return a(e)})).catch((function(e){return l(e)})):l(s)}))}else l(s)}))}))}},{key:"_get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));var r=t.attrs||{},n=Object.assign({key:e,$or:[{expire:{$gt:new Date}},{expire:{$eq:null}}]},r);return this._collection.findOne(n)}},{key:"_delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));var r=t.attrs||{},n=Object.assign({key:e},r);return this._collection.deleteOne(n).then((function(e){return e.deletedCount>0}))}}],[{key:"getDbName",value:function(){return"node-rate-limiter-flexible"}}]),r}(o);e.exports=l},4052:function(e,t,r){var n=r(7424).default,i=r(6690).default,a=r(9728).default,s=r(1655).default,o=r(6389).default,u=r(1434),c=r(4819),l=function(e){"use strict";s(r,e);var t=o(r);function r(e){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return i(this,r),(n=t.call(this,e)).client=e.storeClient,n.clientType=e.storeType,n.dbName=e.dbName,n.tableName=e.tableName,n.clearExpiredByTimeout=e.clearExpiredByTimeout,n.tableCreated=e.tableCreated,n.tableCreated?(n.clearExpiredByTimeout&&n._clearExpiredHourAgo(),"function"===typeof a&&a()):n._createDbAndTable().then((function(){n.tableCreated=!0,n.clearExpiredByTimeout&&n._clearExpiredHourAgo(),"function"===typeof a&&a()})).catch((function(e){if("function"!==typeof a)throw e;a(e)})),n}return a(r,[{key:"clearExpired",value:function(e){var t=this;return new Promise((function(r){t._getConnection().then((function(n){n.query("DELETE FROM ??.?? WHERE expire < ?",[t.dbName,t.tableName,e],(function(){t._releaseConnection(n),r()}))})).catch((function(){r()}))}))}},{key:"_clearExpiredHourAgo",value:function(){var e=this;this._clearExpiredTimeoutId&&clearTimeout(this._clearExpiredTimeoutId),this._clearExpiredTimeoutId=setTimeout((function(){e.clearExpired(Date.now()-36e5).then((function(){e._clearExpiredHourAgo()}))}),3e5),this._clearExpiredTimeoutId.unref()}},{key:"_getConnection",value:function(){var e=this;switch(this.clientType){case"pool":return new Promise((function(t,r){e.client.getConnection((function(e,n){if(e)return r(e);t(n)}))}));case"sequelize":return this.client.connectionManager.getConnection();case"knex":return this.client.client.acquireConnection();default:return Promise.resolve(this.client)}}},{key:"_releaseConnection",value:function(e){switch(this.clientType){case"pool":return e.release();case"sequelize":return this.client.connectionManager.releaseConnection(e);case"knex":return this.client.client.releaseConnection(e);default:return!0}}},{key:"_createDbAndTable",value:function(){var e=this;return new Promise((function(t,r){e._getConnection().then((function(n){n.query("CREATE DATABASE IF NOT EXISTS `".concat(e.dbName,"`;"),(function(i){if(i)return e._releaseConnection(n),r(i);n.query(e._getCreateTableStmt(),(function(i){if(i)return e._releaseConnection(n),r(i);e._releaseConnection(n),t()}))}))})).catch((function(e){r(e)}))}))}},{key:"_getCreateTableStmt",value:function(){return"CREATE TABLE IF NOT EXISTS `".concat(this.dbName,"`.`").concat(this.tableName,"` (")+"`key` VARCHAR(255) CHARACTER SET utf8 NOT NULL,`points` INT(9) NOT NULL default 0,`expire` BIGINT UNSIGNED,PRIMARY KEY (`key`)) ENGINE = INNODB;"}},{key:"clientType",get:function(){return this._clientType},set:function(e){if("undefined"===typeof e)if("Connection"===this.client.constructor.name)e="connection";else if("Pool"===this.client.constructor.name)e="pool";else{if("Sequelize"!==this.client.constructor.name)throw new Error("storeType is not defined");e="sequelize"}this._clientType=e.toLowerCase()}},{key:"dbName",get:function(){return this._dbName},set:function(e){this._dbName="undefined"===typeof e?"rtlmtrflx":e}},{key:"tableName",get:function(){return this._tableName},set:function(e){this._tableName="undefined"===typeof e?this.keyPrefix:e}},{key:"tableCreated",get:function(){return this._tableCreated},set:function(e){this._tableCreated="undefined"!==typeof e&&!!e}},{key:"clearExpiredByTimeout",get:function(){return this._clearExpiredByTimeout},set:function(e){this._clearExpiredByTimeout="undefined"===typeof e||Boolean(e)}},{key:"_getRateLimiterRes",value:function(e,t,r){var i=new c,a=n(r,1)[0];return i.isFirstInDuration=t===a.points,i.consumedPoints=i.isFirstInDuration?t:a.points,i.remainingPoints=Math.max(this.points-i.consumedPoints,0),i.msBeforeNext=a.expire?Math.max(a.expire-Date.now(),0):-1,i}},{key:"_upsertTransaction",value:function(e,t,r,n,i){var a=this;return new Promise((function(s,o){e.query("BEGIN",(function(u){if(u)return e.rollback(),o(u);var c,l,h=Date.now(),f=n>0?h+n:null;i?(c="INSERT INTO ??.?? VALUES (?, ?, ?)\n          ON DUPLICATE KEY UPDATE \n            points = ?, \n            expire = ?;",l=[a.dbName,a.tableName,t,r,f,r,f]):(c="INSERT INTO ??.?? VALUES (?, ?, ?)\n          ON DUPLICATE KEY UPDATE \n            points = IF(expire <= ?, ?, points + (?)), \n            expire = IF(expire <= ?, ?, expire);",l=[a.dbName,a.tableName,t,r,f,h,r,r,h,f]),e.query(c,l,(function(r){if(r)return e.rollback(),o(r);e.query("SELECT points, expire FROM ??.?? WHERE `key` = ?;",[a.dbName,a.tableName,t],(function(t,r){if(t)return e.rollback(),o(t);e.query("COMMIT",(function(t){if(t)return e.rollback(),o(t);s(r)}))}))}))}))}))}},{key:"_upsert",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.tableCreated?new Promise((function(a,s){n._getConnection().then((function(o){n._upsertTransaction(o,e,t,r,i).then((function(e){a(e),n._releaseConnection(o)})).catch((function(e){s(e),n._releaseConnection(o)}))})).catch((function(e){s(e)}))})):Promise.reject(Error("Table is not created yet"))}},{key:"_get",value:function(e){var t=this;return this.tableCreated?new Promise((function(r,n){t._getConnection().then((function(i){i.query("SELECT points, expire FROM ??.?? WHERE `key` = ? AND (`expire` > ? OR `expire` IS NULL)",[t.dbName,t.tableName,e,Date.now()],(function(e,a){e?n(e):0===a.length?r(null):r(a),t._releaseConnection(i)}))})).catch((function(e){n(e)}))})):Promise.reject(Error("Table is not created yet"))}},{key:"_delete",value:function(e){var t=this;return this.tableCreated?new Promise((function(r,n){t._getConnection().then((function(i){i.query("DELETE FROM ??.?? WHERE `key` = ?",[t.dbName,t.tableName,e],(function(e,a){e?n(e):r(a.affectedRows>0),t._releaseConnection(i)}))})).catch((function(e){n(e)}))})):Promise.reject(Error("Table is not created yet"))}}]),r}(u);e.exports=l},3654:function(e,t,r){var n=r(6690).default,i=r(9728).default,a=r(1655).default,s=r(6389).default,o=r(1434),u=r(4819),c=function(e){"use strict";a(r,e);var t=s(r);function r(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return n(this,r),(i=t.call(this,e)).client=e.storeClient,i.clientType=e.storeType,i.tableName=e.tableName,i.clearExpiredByTimeout=e.clearExpiredByTimeout,i.tableCreated=e.tableCreated,i.tableCreated?"function"===typeof a&&a():i._createTable().then((function(){i.tableCreated=!0,i.clearExpiredByTimeout&&i._clearExpiredHourAgo(),"function"===typeof a&&a()})).catch((function(e){if("function"!==typeof a)throw e;a(e)})),i}return i(r,[{key:"clearExpired",value:function(e){var t=this;return new Promise((function(r){var n={name:"rlflx-clear-expired",text:"DELETE FROM ".concat(t.tableName," WHERE expire < $1"),values:[e]};t._query(n).then((function(){r()})).catch((function(){r()}))}))}},{key:"_clearExpiredHourAgo",value:function(){var e=this;this._clearExpiredTimeoutId&&clearTimeout(this._clearExpiredTimeoutId),this._clearExpiredTimeoutId=setTimeout((function(){e.clearExpired(Date.now()-36e5).then((function(){e._clearExpiredHourAgo()}))}),3e5),this._clearExpiredTimeoutId.unref()}},{key:"_getConnection",value:function(){switch(this.clientType){case"pool":default:return Promise.resolve(this.client);case"sequelize":return this.client.connectionManager.getConnection();case"knex":return this.client.client.acquireConnection();case"typeorm":return Promise.resolve(this.client.driver.master)}}},{key:"_releaseConnection",value:function(e){switch(this.clientType){case"pool":case"typeorm":default:return!0;case"sequelize":return this.client.connectionManager.releaseConnection(e);case"knex":return this.client.client.releaseConnection(e)}}},{key:"_createTable",value:function(){var e=this;return new Promise((function(t,r){e._query({text:e._getCreateTableStmt()}).then((function(){t()})).catch((function(e){"23505"===e.code?t():r(e)}))}))}},{key:"_getCreateTableStmt",value:function(){return"CREATE TABLE IF NOT EXISTS ".concat(this.tableName," ( \n      key varchar(255) PRIMARY KEY,\n      points integer NOT NULL DEFAULT 0,\n      expire bigint\n    );")}},{key:"clientType",get:function(){return this._clientType},set:function(e){var t=this.client.constructor.name;if("undefined"===typeof e)if("Client"===t)e="client";else if("Pool"===t||"BoundPool"===t)e="pool";else{if("Sequelize"!==t)throw new Error("storeType is not defined");e="sequelize"}this._clientType=e.toLowerCase()}},{key:"tableName",get:function(){return this._tableName},set:function(e){this._tableName="undefined"===typeof e?this.keyPrefix:e}},{key:"tableCreated",get:function(){return this._tableCreated},set:function(e){this._tableCreated="undefined"!==typeof e&&!!e}},{key:"clearExpiredByTimeout",get:function(){return this._clearExpiredByTimeout},set:function(e){this._clearExpiredByTimeout="undefined"===typeof e||Boolean(e)}},{key:"_getRateLimiterRes",value:function(e,t,r){var n=new u,i=r.rows[0];return n.isFirstInDuration=t===i.points,n.consumedPoints=n.isFirstInDuration?t:i.points,n.remainingPoints=Math.max(this.points-n.consumedPoints,0),n.msBeforeNext=i.expire?Math.max(i.expire-Date.now(),0):-1,n}},{key:"_query",value:function(e){var t=this,r=this.tableName.toLowerCase(),n={name:"".concat(r,":").concat(e.name),text:e.text,values:e.values};return new Promise((function(e,r){t._getConnection().then((function(i){i.query(n).then((function(r){e(r),t._releaseConnection(i)})).catch((function(e){r(e),t._releaseConnection(i)}))})).catch((function(e){r(e)}))}))}},{key:"_upsert",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!this.tableCreated)return Promise.reject(Error("Table is not created yet"));var i=r>0?Date.now()+r:null,a=n?" $3 ":" CASE\n             WHEN ".concat(this.tableName,".expire <= $4 THEN $3\n             ELSE ").concat(this.tableName,".expire\n            END ");return this._query({name:n?"rlflx-upsert-force":"rlflx-upsert",text:"\n            INSERT INTO ".concat(this.tableName," VALUES ($1, $2, $3)\n              ON CONFLICT(key) DO UPDATE SET\n                points = CASE\n                          WHEN (").concat(this.tableName,".expire <= $4 OR 1=").concat(n?1:0,") THEN $2\n                          ELSE ").concat(this.tableName,".points + ($2)\n                         END,\n                expire = ").concat(a,"\n            RETURNING points, expire;"),values:[e,t,i,Date.now()]})}},{key:"_get",value:function(e){var t=this;return this.tableCreated?new Promise((function(r,n){t._query({name:"rlflx-get",text:"\n            SELECT points, expire FROM ".concat(t.tableName," WHERE key = $1 AND (expire > $2 OR expire IS NULL);"),values:[e,Date.now()]}).then((function(e){0===e.rowCount&&(e=null),r(e)})).catch((function(e){n(e)}))})):Promise.reject(Error("Table is not created yet"))}},{key:"_delete",value:function(e){return this.tableCreated?this._query({name:"rlflx-delete",text:"DELETE FROM ".concat(this.tableName," WHERE key = $1"),values:[e]}).then((function(e){return e.rowCount>0})):Promise.reject(Error("Table is not created yet"))}}]),r}(o);e.exports=c},3081:function(e,t,r){var n=r(6690).default,i=r(9728).default,a=r(4688),s=4294967295,o="limiter";e.exports=function(){"use strict";function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{maxQueueSize:s};n(this,e),this._queueLimiters={KEY_DEFAULT:new u(t,r)},this._limiterFlexible=t,this._maxQueueSize=r.maxQueueSize}return i(e,[{key:"getTokensRemaining",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;return this._queueLimiters[e]?this._queueLimiters[e].getTokensRemaining():Promise.resolve(this._limiterFlexible.points)}},{key:"removeTokens",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o;return this._queueLimiters[t]||(this._queueLimiters[t]=new u(this._limiterFlexible,{key:t,maxQueueSize:this._maxQueueSize})),this._queueLimiters[t].removeTokens(e)}}]),e}();var u=function(){"use strict";function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{maxQueueSize:s,key:o};n(this,e),this._key=r.key,this._waitTimeout=null,this._queue=[],this._limiterFlexible=t,this._maxQueueSize=r.maxQueueSize}return i(e,[{key:"getTokensRemaining",value:function(){var e=this;return this._limiterFlexible.get(this._key).then((function(t){return null!==t?t.remainingPoints:e._limiterFlexible.points}))}},{key:"removeTokens",value:function(e){var t=this;return new Promise((function(r,n){e>t._limiterFlexible.points?n(new a("Requested tokens ".concat(e," exceeds maximum ").concat(t._limiterFlexible.points," tokens per interval"))):t._queue.length>0?t._queueRequest.call(t,r,n,e):t._limiterFlexible.consume(t._key,e).then((function(e){r(e.remainingPoints)})).catch((function(i){i instanceof Error?n(i):(t._queueRequest.call(t,r,n,e),null===t._waitTimeout&&(t._waitTimeout=setTimeout(t._processFIFO.bind(t),i.msBeforeNext)))}))}))}},{key:"_queueRequest",value:function(e,t,r){var n=this;n._queue.length<n._maxQueueSize?n._queue.push({resolve:e,reject:t,tokens:r}):t(new a("Number of requests reached it's maximum ".concat(n._maxQueueSize)))}},{key:"_processFIFO",value:function(){var e=this;if(null!==e._waitTimeout&&(clearTimeout(e._waitTimeout),e._waitTimeout=null),0!==e._queue.length){var t=e._queue.shift();e._limiterFlexible.consume(e._key,t.tokens).then((function(r){t.resolve(r.remainingPoints),e._processFIFO.call(e)})).catch((function(r){r instanceof Error?(t.reject(r),e._processFIFO.call(e)):(e._queue.unshift(t),null===e._waitTimeout&&(e._waitTimeout=setTimeout(e._processFIFO.bind(e),r.msBeforeNext)))}))}}}]),e}()},8139:function(e,t,r){var n=r(7061).default,i=r(7156).default,a=r(7424).default,s=r(6690).default,o=r(9728).default,u=r(1655).default,c=r(6389).default,l=r(1434),h=r(4819),f="redis.call('set', KEYS[1], 0, 'EX', ARGV[2], 'NX') local consumed = redis.call('incrby', KEYS[1], ARGV[1]) local ttl = redis.call('pttl', KEYS[1]) if ttl == -1 then   redis.call('expire', KEYS[1], ARGV[2])   ttl = 1000 * ARGV[2] end return {consumed, ttl} ",d=function(e){"use strict";u(r,e);var t=c(r);function r(e){var n;return s(this,r),(n=t.call(this,e)).client=e.storeClient,n._rejectIfRedisNotReady=!!e.rejectIfRedisNotReady,n.useRedisPackage=e.useRedisPackage,n.useRedis3AndLowerPackage=e.useRedis3AndLowerPackage,"function"===typeof n.client.defineCommand&&n.client.defineCommand("rlflxIncr",{numberOfKeys:1,lua:f}),n}return o(r,[{key:"_isRedisReady",value:function(){return!this._rejectIfRedisNotReady||(!this.client.status||"ready"===this.client.status)&&!("function"===typeof this.client.isReady&&!this.client.isReady())}},{key:"_getRateLimiterRes",value:function(e,t,r){var n=a(r,2),i=n[0],s=n[1];Array.isArray(i)&&(i=a(i,2)[1],s=a(s,2)[1]);var o=new h;return o.consumedPoints=parseInt(i),o.isFirstInDuration=o.consumedPoints===t,o.remainingPoints=Math.max(this.points-o.consumedPoints,0),o.msBeforeNext=s,o}},{key:"_upsert",value:function(){var e=i(n().mark((function e(t,r,i){var a,s,o,u=this,c=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=c.length>3&&void 0!==c[3]&&c[3],this._isRedisReady()){e.next=3;break}throw new Error("Redis connection is not ready");case 3:if(s=Math.floor(i/1e3),o=this.client.multi(),!a){e.next=10;break}if(s>0?this.useRedisPackage||this.useRedis3AndLowerPackage?o.set(t,r,{EX:s}):o.set(t,r,"EX",s):o.set(t,r),this.useRedisPackage||this.useRedis3AndLowerPackage){e.next=9;break}return e.abrupt("return",o.pttl(t).exec(!0));case 9:return e.abrupt("return",o.pTTL(t).exec(!0));case 10:if(!(s>0)){e.next=20;break}if(this.useRedisPackage||this.useRedis3AndLowerPackage){e.next=13;break}return e.abrupt("return",this.client.rlflxIncr([t].concat([String(r),String(s)])));case 13:if(!this.useRedis3AndLowerPackage){e.next=17;break}return e.abrupt("return",new Promise((function(e,n){var i=function(t,r){return t?n(t):e(r)};"function"===typeof u.client.rlflxIncr?u.client.rlflxIncr(t,r,s,i):u.client.eval(f,1,t,r,s,i)})));case 17:return e.abrupt("return",this.client.eval(f,{keys:[t],arguments:[String(r),String(s)]}));case 18:e.next=23;break;case 20:if(this.useRedisPackage||this.useRedis3AndLowerPackage){e.next=22;break}return e.abrupt("return",o.incrby(t,r).pttl(t).exec(!0));case 22:return e.abrupt("return",o.incrBy(t,r).pTTL(t).exec(!0));case 23:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=i(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._isRedisReady()){e.next=2;break}throw new Error("Redis connection is not ready");case 2:if(this.useRedisPackage||this.useRedis3AndLowerPackage){e.next=4;break}return e.abrupt("return",this.client.multi().get(t).pttl(t).exec().then((function(e){var t=a(e,1);return null===a(t[0],2)[1]?null:e})));case 4:return e.abrupt("return",this.client.multi().get(t).pTTL(t).exec(!0).then((function(e){return null===a(e,1)[0]?null:e})));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_delete",value:function(e){return this.client.del(e).then((function(e){return e>0}))}}]),r}(l);e.exports=d},4819:function(e,t,r){var n=r(6690).default,i=r(9728).default;e.exports=function(e){"use strict";function t(e,r,i,a){n(this,t),this.remainingPoints="undefined"===typeof e?0:e,this.msBeforeNext="undefined"===typeof r?0:r,this.consumedPoints="undefined"===typeof i?0:i,this.isFirstInDuration="undefined"!==typeof a&&a}return i(t,[{key:"msBeforeNext",get:function(){return this._msBeforeNext},set:function(e){return this._msBeforeNext=e,this}},{key:"remainingPoints",get:function(){return this._remainingPoints},set:function(e){return this._remainingPoints=e,this}},{key:"consumedPoints",get:function(){return this._consumedPoints},set:function(e){return this._consumedPoints=e,this}},{key:"isFirstInDuration",get:function(){return this._isFirstInDuration},set:function(e){this._isFirstInDuration=Boolean(e)}},{key:"_getDecoratedProperties",value:function(){return{remainingPoints:this.remainingPoints,msBeforeNext:this.msBeforeNext,consumedPoints:this.consumedPoints,isFirstInDuration:this.isFirstInDuration}}},{key:e,value:function(){return this._getDecoratedProperties()}},{key:"toString",value:function(){return JSON.stringify(this._getDecoratedProperties())}},{key:"toJSON",value:function(){return this._getDecoratedProperties()}}]),t}(Symbol.for("nodejs.util.inspect.custom"))},1434:function(e,t,r){var n=r(6690).default,i=r(9728).default,a=r(1655).default,s=r(6389).default,o=r(8855),u=r(6704),c=r(4819);e.exports=function(e){"use strict";a(r,e);var t=s(r);function r(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n(this,r),(e=t.call(this,i)).inMemoryBlockOnConsumed=i.inMemoryBlockOnConsumed,e.inMemoryBlockDuration=i.inMemoryBlockDuration,e.insuranceLimiter=i.insuranceLimiter,e._inMemoryBlockedKeys=new u,e}return i(r,[{key:"client",get:function(){return this._client},set:function(e){if("undefined"===typeof e)throw new Error("storeClient is not set");this._client=e}},{key:"_afterConsume",value:function(e,t,r,n,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},s=this._getRateLimiterRes(r,n,i);if(this.inMemoryBlockOnConsumed>0&&!(this.inMemoryBlockDuration>0)&&s.consumedPoints>=this.inMemoryBlockOnConsumed)return this._inMemoryBlockedKeys.addMs(r,s.msBeforeNext),s.consumedPoints>this.points?t(s):e(s);if(s.consumedPoints>this.points){var o=Promise.resolve();this.blockDuration>0&&s.consumedPoints<=this.points+n&&(s.msBeforeNext=this.msBlockDuration,o=this._block(r,s.consumedPoints,this.msBlockDuration,a)),this.inMemoryBlockOnConsumed>0&&s.consumedPoints>=this.inMemoryBlockOnConsumed&&(this._inMemoryBlockedKeys.add(r,this.inMemoryBlockDuration),s.msBeforeNext=this.msInMemoryBlockDuration),o.then((function(){t(s)})).catch((function(e){t(e)}))}else if(this.execEvenly&&s.msBeforeNext>0&&!s.isFirstInDuration){var u=Math.ceil(s.msBeforeNext/(s.remainingPoints+2));u<this.execEvenlyMinDelayMs&&(u=s.consumedPoints*this.execEvenlyMinDelayMs),setTimeout(e,u,s)}else e(s)}},{key:"_handleError",value:function(e,t,r,n,i){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};this.insuranceLimiter instanceof o?this.insuranceLimiter[t](i,a,s).then((function(e){r(e)})).catch((function(e){n(e)})):n(e)}},{key:"getInMemoryBlockMsBeforeExpire",value:function(e){return this.inMemoryBlockOnConsumed>0?this._inMemoryBlockedKeys.msBeforeExpire(e):0}},{key:"inMemoryBlockOnConsumed",get:function(){return this._inMemoryBlockOnConsumed},set:function(e){if(this._inMemoryBlockOnConsumed=e?parseInt(e):0,this.inMemoryBlockOnConsumed>0&&this.points>this.inMemoryBlockOnConsumed)throw new Error('inMemoryBlockOnConsumed option must be greater or equal "points" option')}},{key:"inMemoryBlockDuration",get:function(){return this._inMemoryBlockDuration},set:function(e){if(this._inMemoryBlockDuration=e?parseInt(e):0,this.inMemoryBlockDuration>0&&0===this.inMemoryBlockOnConsumed)throw new Error("inMemoryBlockOnConsumed option must be set up")}},{key:"msInMemoryBlockDuration",get:function(){return 1e3*this._inMemoryBlockDuration}},{key:"insuranceLimiter",get:function(){return this._insuranceLimiter},set:function(e){if("undefined"!==typeof e&&!(e instanceof o))throw new Error("insuranceLimiter must be instance of RateLimiterAbstract");this._insuranceLimiter=e,this._insuranceLimiter&&(this._insuranceLimiter.blockDuration=this.blockDuration,this._insuranceLimiter.execEvenly=this.execEvenly)}},{key:"block",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=1e3*t;return this._block(this.getKey(e),this.points+1,n,r)}},{key:"set",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=1e3*(r>=0?r:this.duration);return this._block(this.getKey(e),t,i,n)}},{key:"consume",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(i,a){var s=t.getKey(e),o=t.getInMemoryBlockMsBeforeExpire(s);if(o>0)return a(new c(0,o));t._upsert(s,r,1e3*t._getKeySecDuration(n),!1,n).then((function(e){t._afterConsume(i,a,s,r,e)})).catch((function(s){t._handleError(s,"consume",i,a,e,r,n)}))}))}},{key:"penalty",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.getKey(e);return new Promise((function(a,s){t._upsert(i,r,1e3*t._getKeySecDuration(n),!1,n).then((function(e){a(t._getRateLimiterRes(i,r,e))})).catch((function(i){t._handleError(i,"penalty",a,s,e,r,n)}))}))}},{key:"reward",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.getKey(e);return new Promise((function(a,s){t._upsert(i,-r,1e3*t._getKeySecDuration(n),!1,n).then((function(e){a(t._getRateLimiterRes(i,-r,e))})).catch((function(i){t._handleError(i,"reward",a,s,e,r,n)}))}))}},{key:"get",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getKey(e);return new Promise((function(i,a){t._get(n,r).then((function(e){i(null===e||"undefined"===typeof e?null:t._getRateLimiterRes(n,0,e))})).catch((function(n){t._handleError(n,"get",i,a,e,r)}))}))}},{key:"delete",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getKey(e);return new Promise((function(i,a){t._delete(n,r).then((function(e){t._inMemoryBlockedKeys.delete(n),i(e)})).catch((function(n){t._handleError(n,"delete",i,a,e,r)}))}))}},{key:"deleteInMemoryBlockedAll",value:function(){this._inMemoryBlockedKeys.delete()}},{key:"_getRateLimiterRes",value:function(e,t,r){throw new Error("You have to implement the method '_getRateLimiterRes'!")}},{key:"_block",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new Promise((function(a,s){n._upsert(e,t,r,!0,i).then((function(){a(new c(0,r>0?r:-1,t))})).catch((function(t){n._handleError(t,"block",a,s,n.parseKey(e),r/1e3,i)}))}))}},{key:"_get",value:function(e){throw new Error("You have to implement the method '_get'!")}},{key:"_delete",value:function(e){throw new Error("You have to implement the method '_delete'!")}},{key:"_upsert",value:function(e,t,r){throw new Error("You have to implement the method '_upsert'!")}}]),r}(o)},4066:function(e,t,r){var n=r(6690).default,i=r(9728).default,a=r(8855);e.exports=function(){"use strict";function e(){n(this,e);for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];if(r.length<1)throw new Error("RateLimiterUnion: at least one limiter have to be passed");r.forEach((function(e){if(!(e instanceof a))throw new Error("RateLimiterUnion: all limiters have to be instance of RateLimiterAbstract")})),this._limiters=r}return i(e,[{key:"consume",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return new Promise((function(n,i){var a=[];t._limiters.forEach((function(t){a.push(t.consume(e,r).catch((function(e){return{rejected:!0,rej:e}})))})),Promise.all(a).then((function(e){var r={},a=!1;e.forEach((function(e){!0===e.rejected&&(a=!0)}));for(var s=0;s<e.length;s++)a&&!0===e[s].rejected?r[t._limiters[s].keyPrefix]=e[s].rej:a||(r[t._limiters[s].keyPrefix]=e[s]);a?i(r):n(r)}))}))}}]),e}()},9682:function(e,t,r){var n=r(6690).default,i=r(9728).default;e.exports=function(){"use strict";function e(){n(this,e),this._keys={},this._addedKeysAmount=0}return i(e,[{key:"collectExpired",value:function(){var e=this,t=Date.now();Object.keys(this._keys).forEach((function(r){e._keys[r]<=t&&delete e._keys[r]})),this._addedKeysAmount=Object.keys(this._keys).length}},{key:"add",value:function(e,t){this.addMs(e,1e3*t)}},{key:"addMs",value:function(e,t){this._keys[e]=Date.now()+t,this._addedKeysAmount++,this._addedKeysAmount>999&&this.collectExpired()}},{key:"msBeforeExpire",value:function(e){var t=this._keys[e];if(t&&t>=Date.now()){this.collectExpired();var r=Date.now();return t>=r?t-r:0}return 0}},{key:"delete",value:function(e){var t=this;e?delete this._keys[e]:Object.keys(this._keys).forEach((function(e){delete t._keys[e]}))}}]),e}()},6704:function(e,t,r){var n=r(9682);e.exports=n},4327:function(e,t,r){var n=r(6690).default,i=r(9728).default,a=r(9359),s=r(4819);e.exports=function(){"use strict";function e(){n(this,e),this._storage={}}return i(e,[{key:"incrby",value:function(e,t,r){if(this._storage[e]){var n=this._storage[e].expiresAt?this._storage[e].expiresAt.getTime()-(new Date).getTime():-1;return 0!==n?(this._storage[e].value=this._storage[e].value+t,new s(0,n,this._storage[e].value,!1)):this.set(e,t,r)}return this.set(e,t,r)}},{key:"set",value:function(e,t,r){var n=this,i=1e3*r;return this._storage[e]&&this._storage[e].timeoutId&&clearTimeout(this._storage[e].timeoutId),this._storage[e]=new a(t,i>0?new Date(Date.now()+i):null),i>0&&(this._storage[e].timeoutId=setTimeout((function(){delete n._storage[e]}),i),this._storage[e].timeoutId.unref&&this._storage[e].timeoutId.unref()),new s(0,0===i?-1:i,this._storage[e].value,!0)}},{key:"get",value:function(e){if(this._storage[e]){var t=this._storage[e].expiresAt?this._storage[e].expiresAt.getTime()-(new Date).getTime():-1;return new s(0,t,this._storage[e].value,!1)}return null}},{key:"delete",value:function(e){return!!this._storage[e]&&(this._storage[e].timeoutId&&clearTimeout(this._storage[e].timeoutId),delete this._storage[e],!0)}}]),e}()},9359:function(e,t,r){var n=r(6690).default,i=r(9728).default;e.exports=function(){"use strict";function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n(this,e),this.value=t,this.expiresAt=r,this.timeoutId=i}return i(e,[{key:"value",get:function(){return this._value},set:function(e){this._value=parseInt(e)}},{key:"expiresAt",get:function(){return this._expiresAt},set:function(e){e instanceof Date||!Number.isInteger(e)||(e=new Date(e)),this._expiresAt=e}},{key:"timeoutId",get:function(){return this._timeoutId},set:function(e){this._timeoutId=e}}]),e}()},4688:function(e,t,r){var n=r(9728).default,i=r(6690).default,a=r(6115).default,s=r(1655).default,o=r(6389).default,u=r(3496).default;e.exports=function(e){"use strict";s(r,e);var t=o(r);function r(e,n){var s;return i(this,r),s=t.call(this),Error.captureStackTrace&&Error.captureStackTrace(a(s),s.constructor),s.name="CustomError",s.message=e,n&&(s.extra=n),s}return n(r)}(u(Error))},4463:function(e,t,r){"use strict";var n=r(2791),i=r(5296);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function u(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)s.add(t[e])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},p={};function v(e,t,r,n,i,a,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=s}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new v(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new v(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new v(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new v(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new v(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new v(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function m(e){return e[1].toUpperCase()}function b(e,t,r,n){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,r,n){if(null===t||"undefined"===typeof t||function(e,t,r,n){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,i,n)&&(r=null),n||null===i?function(e){return!!h.call(p,e)||!h.call(d,e)&&(f.test(e)?p[e]=!0:(d[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=null===r?3!==i.type&&"":r:(t=i.attributeName,n=i.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(i=i.type)||4===i&&!0===r?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,m);g[t]=new v(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,m);g[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,m);g[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)}));var _=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),k=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),A=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),Z=Symbol.for("react.memo"),I=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var L=Symbol.iterator;function M(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=L&&e[L]||e["@@iterator"])?e:null}var B,O=Object.assign;function N(e){if(void 0===B)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);B=t&&t[1]||""}return"\n"+B+e}var F=!1;function U(e,t){if(!e||F)return"";F=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),a=n.stack.split("\n"),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(1!==s||1!==o)do{if(s--,0>--o||i[s]!==a[o]){var u="\n"+i[s].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=s&&0<=o);break}}}finally{F=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?N(e):""}function z(e){switch(e.tag){case 5:return N(e.type);case 16:return N("Lazy");case 13:return N("Suspense");case 19:return N("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function j(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case x:return"Fragment";case k:return"Portal";case S:return"Profiler";case E:return"StrictMode";case R:return"Suspense";case T:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case A:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case D:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case Z:return null!==(t=e.displayName||null)?t:j(e.type)||"Memo";case I:t=e._payload,e=e._init;try{return j(e(t))}catch(r){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return j(t);case 8:return t===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function V(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var i=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){n=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=q(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function Y(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function G(e,t){var r=t.checked;return O({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function Q(e,t){var r=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;r=W(null!=t.value?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){X(e,t);var r=W(t.value),n=t.type;if(null!=r)"number"===n?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,r):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function ee(e,t,r){"number"===t&&Y(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var te=Array.isArray;function re(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+W(r),t=null,i=0;i<e.length;i++){if(e[i].value===r)return e[i].selected=!0,void(n&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return O({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(a(92));if(te(r)){if(1<r.length)throw Error(a(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:W(r)}}function ae(e,t){var r=W(t.value),n=W(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=n&&(e.defaultValue=""+n)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ue(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,le,he=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction((function(){return le(e,t)}))}:le);function fe(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var de={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ve(e,t,r){return null==t||"boolean"===typeof t||""===t?"":r||"number"!==typeof t||0===t||de.hasOwnProperty(e)&&de[e]?(""+t).trim():t+"px"}function ge(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var n=0===r.indexOf("--"),i=ve(r,t[r],n);"float"===r&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}Object.keys(de).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),de[t]=de[e]}))}));var ye=O({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function me(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _e=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,xe=null,Ee=null;function Se(e){if(e=bi(e)){if("function"!==typeof ke)throw Error(a(280));var t=e.stateNode;t&&(t=wi(t),ke(e.stateNode,e.type,t))}}function Ce(e){xe?Ee?Ee.push(e):Ee=[e]:xe=e}function Ae(){if(xe){var e=xe,t=Ee;if(Ee=xe=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function De(e,t){return e(t)}function Re(){}var Te=!1;function Ze(e,t,r){if(Te)return e(t,r);Te=!0;try{return De(e,t,r)}finally{Te=!1,(null!==xe||null!==Ee)&&(Re(),Ae())}}function Ie(e,t){var r=e.stateNode;if(null===r)return null;var n=wi(r);if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(a(231,t,typeof r));return r}var Pe=!1;if(l)try{var Le={};Object.defineProperty(Le,"passive",{get:function(){Pe=!0}}),window.addEventListener("test",Le,Le),window.removeEventListener("test",Le,Le)}catch(le){Pe=!1}function Me(e,t,r,n,i,a,s,o,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(l){this.onError(l)}}var Be=!1,Oe=null,Ne=!1,Fe=null,Ue={onError:function(e){Be=!0,Oe=e}};function ze(e,t,r,n,i,a,s,o,u){Be=!1,Oe=null,Me.apply(Ue,arguments)}function je(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(je(e)!==e)throw Error(a(188))}function qe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=je(e)))throw Error(a(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(n=i.return)){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return We(i),e;if(s===n)return We(i),t;s=s.sibling}throw Error(a(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,u=i.child;u;){if(u===r){o=!0,r=i,n=s;break}if(u===n){o=!0,n=i,r=s;break}u=u.sibling}if(!o){for(u=s.child;u;){if(u===r){o=!0,r=s,n=i;break}if(u===n){o=!0,n=s,r=i;break}u=u.sibling}if(!o)throw Error(a(189))}}if(r.alternate!==n)throw Error(a(190))}if(3!==r.tag)throw Error(a(188));return r.stateNode.current===r?e:t}(e))?Ve(e):null}function Ve(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ve(e);if(null!==t)return t;e=e.sibling}return null}var Ke=i.unstable_scheduleCallback,Ye=i.unstable_cancelCallback,Ge=i.unstable_shouldYield,Qe=i.unstable_requestPaint,Xe=i.unstable_now,Je=i.unstable_getCurrentPriorityLevel,$e=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,rt=i.unstable_LowPriority,nt=i.unstable_IdlePriority,it=null,at=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/ut|0)|0},ot=Math.log,ut=Math.LN2;var ct=64,lt=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ft(e,t){var r=e.pendingLanes;if(0===r)return 0;var n=0,i=e.suspendedLanes,a=e.pingedLanes,s=268435455&r;if(0!==s){var o=s&~i;0!==o?n=ht(o):0!==(a&=s)&&(n=ht(a))}else 0!==(s=r&~i)?n=ht(s):0!==a&&(n=ht(a));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&i)&&((i=n&-n)>=(a=t&-t)||16===i&&0!==(4194240&a)))return t;if(0!==(4&n)&&(n|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)i=1<<(r=31-st(t)),n|=e[r],t&=~i;return n}function dt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function vt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function yt(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=r}function mt(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-st(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var bt=0;function _t(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,kt,xt,Et,St,Ct=!1,At=[],Dt=null,Rt=null,Tt=null,Zt=new Map,It=new Map,Pt=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mt(e,t){switch(e){case"focusin":case"focusout":Dt=null;break;case"dragenter":case"dragleave":Rt=null;break;case"mouseover":case"mouseout":Tt=null;break;case"pointerover":case"pointerout":Zt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":It.delete(t.pointerId)}}function Bt(e,t,r,n,i,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},null!==t&&(null!==(t=bi(t))&&kt(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ot(e){var t=mi(e.target);if(null!==t){var r=je(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=He(r)))return e.blockedOn=t,void St(e.priority,(function(){xt(r)}))}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Nt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=Gt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=bi(r))&&kt(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);_e=n,r.target.dispatchEvent(n),_e=null,t.shift()}return!0}function Ft(e,t,r){Nt(e)&&r.delete(t)}function Ut(){Ct=!1,null!==Dt&&Nt(Dt)&&(Dt=null),null!==Rt&&Nt(Rt)&&(Rt=null),null!==Tt&&Nt(Tt)&&(Tt=null),Zt.forEach(Ft),It.forEach(Ft)}function zt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Ut)))}function jt(e){function t(t){return zt(t,e)}if(0<At.length){zt(At[0],e);for(var r=1;r<At.length;r++){var n=At[r];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==Dt&&zt(Dt,e),null!==Rt&&zt(Rt,e),null!==Tt&&zt(Tt,e),Zt.forEach(t),It.forEach(t),r=0;r<Pt.length;r++)(n=Pt[r]).blockedOn===e&&(n.blockedOn=null);for(;0<Pt.length&&null===(r=Pt[0]).blockedOn;)Ot(r),null===r.blockedOn&&Pt.shift()}var Ht=_.ReactCurrentBatchConfig,Wt=!0;function qt(e,t,r,n){var i=bt,a=Ht.transition;Ht.transition=null;try{bt=1,Kt(e,t,r,n)}finally{bt=i,Ht.transition=a}}function Vt(e,t,r,n){var i=bt,a=Ht.transition;Ht.transition=null;try{bt=4,Kt(e,t,r,n)}finally{bt=i,Ht.transition=a}}function Kt(e,t,r,n){if(Wt){var i=Gt(e,t,r,n);if(null===i)Wn(e,t,n,Yt,r),Mt(e,n);else if(function(e,t,r,n,i){switch(t){case"focusin":return Dt=Bt(Dt,e,t,r,n,i),!0;case"dragenter":return Rt=Bt(Rt,e,t,r,n,i),!0;case"mouseover":return Tt=Bt(Tt,e,t,r,n,i),!0;case"pointerover":var a=i.pointerId;return Zt.set(a,Bt(Zt.get(a)||null,e,t,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,It.set(a,Bt(It.get(a)||null,e,t,r,n,i)),!0}return!1}(i,e,t,r,n))n.stopPropagation();else if(Mt(e,n),4&t&&-1<Lt.indexOf(e)){for(;null!==i;){var a=bi(i);if(null!==a&&wt(a),null===(a=Gt(e,t,r,n))&&Wn(e,t,n,Yt,r),a===i)break;i=a}null!==i&&n.stopPropagation()}else Wn(e,t,n,null,r)}}var Yt=null;function Gt(e,t,r,n){if(Yt=null,null!==(e=mi(e=we(n))))if(null===(t=je(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Yt=e,null}function Qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case $e:return 1;case et:return 4;case tt:case rt:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Xt=null,Jt=null,$t=null;function er(){if($t)return $t;var e,t,r=Jt,n=r.length,i="value"in Xt?Xt.value:Xt.textContent,a=i.length;for(e=0;e<n&&r[e]===i[e];e++);var s=n-e;for(t=1;t<=s&&r[n-t]===i[a-t];t++);return $t=i.slice(e,1<t?1-t:void 0)}function tr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rr(){return!0}function nr(){return!1}function ir(e){function t(t,r,n,i,a){for(var s in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?rr:nr,this.isPropagationStopped=nr,this}return O(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rr)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rr)},persist:function(){},isPersistent:rr}),t}var ar,sr,or,ur={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cr=ir(ur),lr=O({},ur,{view:0,detail:0}),hr=ir(lr),fr=O({},lr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Er,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==or&&(or&&"mousemove"===e.type?(ar=e.screenX-or.screenX,sr=e.screenY-or.screenY):sr=ar=0,or=e),ar)},movementY:function(e){return"movementY"in e?e.movementY:sr}}),dr=ir(fr),pr=ir(O({},fr,{dataTransfer:0})),vr=ir(O({},lr,{relatedTarget:0})),gr=ir(O({},ur,{animationName:0,elapsedTime:0,pseudoElement:0})),yr=O({},ur,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),mr=ir(yr),br=ir(O({},ur,{data:0})),_r={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=kr[e])&&!!t[e]}function Er(){return xr}var Sr=O({},lr,{key:function(e){if(e.key){var t=_r[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Er,charCode:function(e){return"keypress"===e.type?tr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cr=ir(Sr),Ar=ir(O({},fr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Dr=ir(O({},lr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Er})),Rr=ir(O({},ur,{propertyName:0,elapsedTime:0,pseudoElement:0})),Tr=O({},fr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Zr=ir(Tr),Ir=[9,13,27,32],Pr=l&&"CompositionEvent"in window,Lr=null;l&&"documentMode"in document&&(Lr=document.documentMode);var Mr=l&&"TextEvent"in window&&!Lr,Br=l&&(!Pr||Lr&&8<Lr&&11>=Lr),Or=String.fromCharCode(32),Nr=!1;function Fr(e,t){switch(e){case"keyup":return-1!==Ir.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ur(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var zr=!1;var jr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!jr[e.type]:"textarea"===t}function Wr(e,t,r,n){Ce(n),0<(t=Vn(t,"onChange")).length&&(r=new cr("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var qr=null,Vr=null;function Kr(e){Nn(e,0)}function Yr(e){if(K(_i(e)))return e}function Gr(e,t){if("change"===e)return t}var Qr=!1;if(l){var Xr;if(l){var Jr="oninput"in document;if(!Jr){var $r=document.createElement("div");$r.setAttribute("oninput","return;"),Jr="function"===typeof $r.oninput}Xr=Jr}else Xr=!1;Qr=Xr&&(!document.documentMode||9<document.documentMode)}function en(){qr&&(qr.detachEvent("onpropertychange",tn),Vr=qr=null)}function tn(e){if("value"===e.propertyName&&Yr(Vr)){var t=[];Wr(t,Vr,e,we(e)),Ze(Kr,t)}}function rn(e,t,r){"focusin"===e?(en(),Vr=r,(qr=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function nn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yr(Vr)}function an(e,t){if("click"===e)return Yr(t)}function sn(e,t){if("input"===e||"change"===e)return Yr(t)}var on="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function un(e,t){if(on(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!h.call(t,i)||!on(e[i],t[i]))return!1}return!0}function cn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ln(e,t){var r,n=cn(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=cn(n)}}function hn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fn(){for(var e=window,t=Y();t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(n){r=!1}if(!r)break;t=Y((e=t.contentWindow).document)}return t}function dn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pn(e){var t=fn(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&hn(r.ownerDocument.documentElement,r)){if(null!==n&&dn(r))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if((e=(t=r.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=void 0===n.end?a:Math.min(n.end,i),!e.extend&&a>n&&(i=n,n=a,a=i),i=ln(r,a);var s=ln(r,n);i&&s&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=r;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof r.focus&&r.focus(),r=0;r<t.length;r++)(e=t[r]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vn=l&&"documentMode"in document&&11>=document.documentMode,gn=null,yn=null,mn=null,bn=!1;function _n(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;bn||null==gn||gn!==Y(n)||("selectionStart"in(n=gn)&&dn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},mn&&un(mn,n)||(mn=n,0<(n=Vn(yn,"onSelect")).length&&(t=new cr("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=gn)))}function wn(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var kn={animationend:wn("Animation","AnimationEnd"),animationiteration:wn("Animation","AnimationIteration"),animationstart:wn("Animation","AnimationStart"),transitionend:wn("Transition","TransitionEnd")},xn={},En={};function Sn(e){if(xn[e])return xn[e];if(!kn[e])return e;var t,r=kn[e];for(t in r)if(r.hasOwnProperty(t)&&t in En)return xn[e]=r[t];return e}l&&(En=document.createElement("div").style,"AnimationEvent"in window||(delete kn.animationend.animation,delete kn.animationiteration.animation,delete kn.animationstart.animation),"TransitionEvent"in window||delete kn.transitionend.transition);var Cn=Sn("animationend"),An=Sn("animationiteration"),Dn=Sn("animationstart"),Rn=Sn("transitionend"),Tn=new Map,Zn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function In(e,t){Tn.set(e,t),u(t,[e])}for(var Pn=0;Pn<Zn.length;Pn++){var Ln=Zn[Pn];In(Ln.toLowerCase(),"on"+(Ln[0].toUpperCase()+Ln.slice(1)))}In(Cn,"onAnimationEnd"),In(An,"onAnimationIteration"),In(Dn,"onAnimationStart"),In("dblclick","onDoubleClick"),In("focusin","onFocus"),In("focusout","onBlur"),In(Rn,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Bn=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mn));function On(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,function(e,t,r,n,i,s,o,u,c){if(ze.apply(this,arguments),Be){if(!Be)throw Error(a(198));var l=Oe;Be=!1,Oe=null,Ne||(Ne=!0,Fe=l)}}(n,t,void 0,e),e.currentTarget=null}function Nn(e,t){t=0!==(4&t);for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],u=o.instance,c=o.currentTarget;if(o=o.listener,u!==a&&i.isPropagationStopped())break e;On(i,o,c),a=u}else for(s=0;s<n.length;s++){if(u=(o=n[s]).instance,c=o.currentTarget,o=o.listener,u!==a&&i.isPropagationStopped())break e;On(i,o,c),a=u}}}if(Ne)throw e=Fe,Ne=!1,Fe=null,e}function Fn(e,t){var r=t[vi];void 0===r&&(r=t[vi]=new Set);var n=e+"__bubble";r.has(n)||(Hn(t,e,2,!1),r.add(n))}function Un(e,t,r){var n=0;t&&(n|=4),Hn(r,e,n,t)}var zn="_reactListening"+Math.random().toString(36).slice(2);function jn(e){if(!e[zn]){e[zn]=!0,s.forEach((function(t){"selectionchange"!==t&&(Bn.has(t)||Un(t,!1,e),Un(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zn]||(t[zn]=!0,Un("selectionchange",!1,t))}}function Hn(e,t,r,n){switch(Qt(t)){case 1:var i=qt;break;case 4:i=Vt;break;default:i=Kt}r=i.bind(null,t,r,e),i=void 0,!Pe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),n?void 0!==i?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):void 0!==i?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Wn(e,t,r,n,i){var a=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var s=n.tag;if(3===s||4===s){var o=n.stateNode.containerInfo;if(o===i||8===o.nodeType&&o.parentNode===i)break;if(4===s)for(s=n.return;null!==s;){var u=s.tag;if((3===u||4===u)&&((u=s.stateNode.containerInfo)===i||8===u.nodeType&&u.parentNode===i))return;s=s.return}for(;null!==o;){if(null===(s=mi(o)))return;if(5===(u=s.tag)||6===u){n=a=s;continue e}o=o.parentNode}}n=n.return}Ze((function(){var n=a,i=we(r),s=[];e:{var o=Tn.get(e);if(void 0!==o){var u=cr,c=e;switch(e){case"keypress":if(0===tr(r))break e;case"keydown":case"keyup":u=Cr;break;case"focusin":c="focus",u=vr;break;case"focusout":c="blur",u=vr;break;case"beforeblur":case"afterblur":u=vr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=dr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=pr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=Dr;break;case Cn:case An:case Dn:u=gr;break;case Rn:u=Rr;break;case"scroll":u=hr;break;case"wheel":u=Zr;break;case"copy":case"cut":case"paste":u=mr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=Ar}var l=0!==(4&t),h=!l&&"scroll"===e,f=l?null!==o?o+"Capture":null:o;l=[];for(var d,p=n;null!==p;){var v=(d=p).stateNode;if(5===d.tag&&null!==v&&(d=v,null!==f&&(null!=(v=Ie(p,f))&&l.push(qn(p,v,d)))),h)break;p=p.return}0<l.length&&(o=new u(o,c,null,r,i),s.push({event:o,listeners:l}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||r===_e||!(c=r.relatedTarget||r.fromElement)||!mi(c)&&!c[pi])&&(u||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,u?(u=n,null!==(c=(c=r.relatedTarget||r.toElement)?mi(c):null)&&(c!==(h=je(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(u=null,c=n),u!==c)){if(l=dr,v="onMouseLeave",f="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(l=Ar,v="onPointerLeave",f="onPointerEnter",p="pointer"),h=null==u?o:_i(u),d=null==c?o:_i(c),(o=new l(v,p+"leave",u,r,i)).target=h,o.relatedTarget=d,v=null,mi(i)===n&&((l=new l(f,p+"enter",c,r,i)).target=d,l.relatedTarget=h,v=l),h=v,u&&c)e:{for(f=c,p=0,d=l=u;d;d=Kn(d))p++;for(d=0,v=f;v;v=Kn(v))d++;for(;0<p-d;)l=Kn(l),p--;for(;0<d-p;)f=Kn(f),d--;for(;p--;){if(l===f||null!==f&&l===f.alternate)break e;l=Kn(l),f=Kn(f)}l=null}else l=null;null!==u&&Yn(s,o,u,l,!1),null!==c&&null!==h&&Yn(s,h,c,l,!0)}if("select"===(u=(o=n?_i(n):window).nodeName&&o.nodeName.toLowerCase())||"input"===u&&"file"===o.type)var g=Gr;else if(Hr(o))if(Qr)g=sn;else{g=nn;var y=rn}else(u=o.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=an);switch(g&&(g=g(e,n))?Wr(s,g,r,i):(y&&y(e,o,n),"focusout"===e&&(y=o._wrapperState)&&y.controlled&&"number"===o.type&&ee(o,"number",o.value)),y=n?_i(n):window,e){case"focusin":(Hr(y)||"true"===y.contentEditable)&&(gn=y,yn=n,mn=null);break;case"focusout":mn=yn=gn=null;break;case"mousedown":bn=!0;break;case"contextmenu":case"mouseup":case"dragend":bn=!1,_n(s,r,i);break;case"selectionchange":if(vn)break;case"keydown":case"keyup":_n(s,r,i)}var m;if(Pr)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else zr?Fr(e,r)&&(b="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(b="onCompositionStart");b&&(Br&&"ko"!==r.locale&&(zr||"onCompositionStart"!==b?"onCompositionEnd"===b&&zr&&(m=er()):(Jt="value"in(Xt=i)?Xt.value:Xt.textContent,zr=!0)),0<(y=Vn(n,b)).length&&(b=new br(b,e,null,r,i),s.push({event:b,listeners:y}),m?b.data=m:null!==(m=Ur(r))&&(b.data=m))),(m=Mr?function(e,t){switch(e){case"compositionend":return Ur(t);case"keypress":return 32!==t.which?null:(Nr=!0,Or);case"textInput":return(e=t.data)===Or&&Nr?null:e;default:return null}}(e,r):function(e,t){if(zr)return"compositionend"===e||!Pr&&Fr(e,t)?(e=er(),$t=Jt=Xt=null,zr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Br&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(n=Vn(n,"onBeforeInput")).length&&(i=new br("onBeforeInput","beforeinput",null,r,i),s.push({event:i,listeners:n}),i.data=m))}Nn(s,t)}))}function qn(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Vn(e,t){for(var r=t+"Capture",n=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=Ie(e,r))&&n.unshift(qn(e,a,i)),null!=(a=Ie(e,t))&&n.push(qn(e,a,i))),e=e.return}return n}function Kn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Yn(e,t,r,n,i){for(var a=t._reactName,s=[];null!==r&&r!==n;){var o=r,u=o.alternate,c=o.stateNode;if(null!==u&&u===n)break;5===o.tag&&null!==c&&(o=c,i?null!=(u=Ie(r,a))&&s.unshift(qn(r,u,o)):i||null!=(u=Ie(r,a))&&s.push(qn(r,u,o))),r=r.return}0!==s.length&&e.push({event:t,listeners:s})}var Gn=/\r\n?/g,Qn=/\u0000|\uFFFD/g;function Xn(e){return("string"===typeof e?e:""+e).replace(Gn,"\n").replace(Qn,"")}function Jn(e,t,r){if(t=Xn(t),Xn(e)!==t&&r)throw Error(a(425))}function $n(){}var ei=null,ti=null;function ri(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ni="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,ai="function"===typeof Promise?Promise:void 0,si="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ai?function(e){return ai.resolve(null).then(e).catch(oi)}:ni;function oi(e){setTimeout((function(){throw e}))}function ui(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&8===i.nodeType)if("/$"===(r=i.data)){if(0===n)return e.removeChild(i),void jt(t);n--}else"$"!==r&&"$?"!==r&&"$!"!==r||n++;r=i}while(r);jt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function li(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),fi="__reactFiber$"+hi,di="__reactProps$"+hi,pi="__reactContainer$"+hi,vi="__reactEvents$"+hi,gi="__reactListeners$"+hi,yi="__reactHandles$"+hi;function mi(e){var t=e[fi];if(t)return t;for(var r=e.parentNode;r;){if(t=r[pi]||r[fi]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=li(e);null!==e;){if(r=e[fi])return r;e=li(e)}return t}r=(e=r).parentNode}return null}function bi(e){return!(e=e[fi]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function _i(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function wi(e){return e[di]||null}var ki=[],xi=-1;function Ei(e){return{current:e}}function Si(e){0>xi||(e.current=ki[xi],ki[xi]=null,xi--)}function Ci(e,t){xi++,ki[xi]=e.current,e.current=t}var Ai={},Di=Ei(Ai),Ri=Ei(!1),Ti=Ai;function Zi(e,t){var r=e.type.contextTypes;if(!r)return Ai;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in r)a[i]=t[i];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Ii(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Pi(){Si(Ri),Si(Di)}function Li(e,t,r){if(Di.current!==Ai)throw Error(a(168));Ci(Di,t),Ci(Ri,r)}function Mi(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return r;for(var i in n=n.getChildContext())if(!(i in t))throw Error(a(108,H(e)||"Unknown",i));return O({},r,n)}function Bi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ai,Ti=Di.current,Ci(Di,e),Ci(Ri,Ri.current),!0}function Oi(e,t,r){var n=e.stateNode;if(!n)throw Error(a(169));r?(e=Mi(e,t,Ti),n.__reactInternalMemoizedMergedChildContext=e,Si(Ri),Si(Di),Ci(Di,e)):Si(Ri),Ci(Ri,r)}var Ni=null,Fi=!1,Ui=!1;function zi(e){null===Ni?Ni=[e]:Ni.push(e)}function ji(){if(!Ui&&null!==Ni){Ui=!0;var e=0,t=bt;try{var r=Ni;for(bt=1;e<r.length;e++){var n=r[e];do{n=n(!0)}while(null!==n)}Ni=null,Fi=!1}catch(i){throw null!==Ni&&(Ni=Ni.slice(e+1)),Ke($e,ji),i}finally{bt=t,Ui=!1}}return null}var Hi=[],Wi=0,qi=null,Vi=0,Ki=[],Yi=0,Gi=null,Qi=1,Xi="";function Ji(e,t){Hi[Wi++]=Vi,Hi[Wi++]=qi,qi=e,Vi=t}function $i(e,t,r){Ki[Yi++]=Qi,Ki[Yi++]=Xi,Ki[Yi++]=Gi,Gi=e;var n=Qi;e=Xi;var i=32-st(n)-1;n&=~(1<<i),r+=1;var a=32-st(t)+i;if(30<a){var s=i-i%5;a=(n&(1<<s)-1).toString(32),n>>=s,i-=s,Qi=1<<32-st(t)+i|r<<i|n,Xi=a+e}else Qi=1<<a|r<<i|n,Xi=e}function ea(e){null!==e.return&&(Ji(e,1),$i(e,1,0))}function ta(e){for(;e===qi;)qi=Hi[--Wi],Hi[Wi]=null,Vi=Hi[--Wi],Hi[Wi]=null;for(;e===Gi;)Gi=Ki[--Yi],Ki[Yi]=null,Xi=Ki[--Yi],Ki[Yi]=null,Qi=Ki[--Yi],Ki[Yi]=null}var ra=null,na=null,ia=!1,aa=null;function sa(e,t){var r=Ic(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function oa(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ra=e,na=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ra=e,na=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==Gi?{id:Qi,overflow:Xi}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=Ic(18,null,null,0)).stateNode=t,r.return=e,e.child=r,ra=e,na=null,!0);default:return!1}}function ua(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ca(e){if(ia){var t=na;if(t){var r=t;if(!oa(e,t)){if(ua(e))throw Error(a(418));t=ci(r.nextSibling);var n=ra;t&&oa(e,t)?sa(n,r):(e.flags=-4097&e.flags|2,ia=!1,ra=e)}}else{if(ua(e))throw Error(a(418));e.flags=-4097&e.flags|2,ia=!1,ra=e}}}function la(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ra=e}function ha(e){if(e!==ra)return!1;if(!ia)return la(e),ia=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ri(e.type,e.memoizedProps)),t&&(t=na)){if(ua(e))throw fa(),Error(a(418));for(;t;)sa(e,t),t=ci(t.nextSibling)}if(la(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){na=ci(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}na=null}}else na=ra?ci(e.stateNode.nextSibling):null;return!0}function fa(){for(var e=na;e;)e=ci(e.nextSibling)}function da(){na=ra=null,ia=!1}function pa(e){null===aa?aa=[e]:aa.push(e)}var va=_.ReactCurrentBatchConfig;function ga(e,t){if(e&&e.defaultProps){for(var r in t=O({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}var ya=Ei(null),ma=null,ba=null,_a=null;function wa(){_a=ba=ma=null}function ka(e){var t=ya.current;Si(ya),e._currentValue=t}function xa(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ea(e,t){ma=e,_a=ba=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(_o=!0),e.firstContext=null)}function Sa(e){var t=e._currentValue;if(_a!==e)if(e={context:e,memoizedValue:t,next:null},null===ba){if(null===ma)throw Error(a(308));ba=e,ma.dependencies={lanes:0,firstContext:e}}else ba=ba.next=e;return t}var Ca=null;function Aa(e){null===Ca?Ca=[e]:Ca.push(e)}function Da(e,t,r,n){var i=t.interleaved;return null===i?(r.next=r,Aa(t)):(r.next=i.next,i.next=r),t.interleaved=r,Ra(e,n)}function Ra(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}var Ta=!1;function Za(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ia(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Pa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function La(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&Ru)){var i=n.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Ra(e,r)}return null===(i=n.interleaved)?(t.next=t,Aa(n)):(t.next=i.next,i.next=t),n.interleaved=t,Ra(e,r)}function Ma(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&r))){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,mt(e,r)}}function Ba(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var i=null,a=null;if(null!==(r=r.firstBaseUpdate)){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===a?i=a=s:a=a.next=s,r=r.next}while(null!==r);null===a?i=a=t:a=a.next=t}else i=a=t;return r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Oa(e,t,r,n){var i=e.updateQueue;Ta=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(null!==o){i.shared.pending=null;var u=o,c=u.next;u.next=null,null===s?a=c:s.next=c,s=u;var l=e.alternate;null!==l&&((o=(l=l.updateQueue).lastBaseUpdate)!==s&&(null===o?l.firstBaseUpdate=c:o.next=c,l.lastBaseUpdate=u))}if(null!==a){var h=i.baseState;for(s=0,l=c=u=null,o=a;;){var f=o.lane,d=o.eventTime;if((n&f)===f){null!==l&&(l=l.next={eventTime:d,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,v=o;switch(f=t,d=r,v.tag){case 1:if("function"===typeof(p=v.payload)){h=p.call(d,h,f);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(f="function"===typeof(p=v.payload)?p.call(d,h,f):p)||void 0===f)break e;h=O({},h,f);break e;case 2:Ta=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(f=i.effects)?i.effects=[o]:f.push(o))}else d={eventTime:d,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===l?(c=l=d,u=h):l=l.next=d,s|=f;if(null===(o=o.next)){if(null===(o=i.shared.pending))break;o=(f=o).next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}if(null===l&&(u=h),i.baseState=u,i.firstBaseUpdate=c,i.lastBaseUpdate=l,null!==(t=i.shared.interleaved)){i=t;do{s|=i.lane,i=i.next}while(i!==t)}else null===a&&(i.shared.lanes=0);Ou|=s,e.lanes=s,e.memoizedState=h}}function Na(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(null!==i){if(n.callback=null,n=r,"function"!==typeof i)throw Error(a(191,i));i.call(n)}}}var Fa=(new n.Component).refs;function Ua(e,t,r,n){r=null===(r=r(n,t=e.memoizedState))||void 0===r?t:O({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var za={isMounted:function(e){return!!(e=e._reactInternals)&&je(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=tc(),i=rc(e),a=Pa(n,i);a.payload=t,void 0!==r&&null!==r&&(a.callback=r),null!==(t=La(e,a,i))&&(nc(t,e,i,n),Ma(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=tc(),i=rc(e),a=Pa(n,i);a.tag=1,a.payload=t,void 0!==r&&null!==r&&(a.callback=r),null!==(t=La(e,a,i))&&(nc(t,e,i,n),Ma(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=tc(),n=rc(e),i=Pa(r,n);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=La(e,i,n))&&(nc(t,e,n,r),Ma(t,e,n))}};function ja(e,t,r,n,i,a,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,a,s):!t.prototype||!t.prototype.isPureReactComponent||(!un(r,n)||!un(i,a))}function Ha(e,t,r){var n=!1,i=Ai,a=t.contextType;return"object"===typeof a&&null!==a?a=Sa(a):(i=Ii(t)?Ti:Di.current,a=(n=null!==(n=t.contextTypes)&&void 0!==n)?Zi(e,i):Ai),t=new t(r,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=za,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function Wa(e,t,r,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&za.enqueueReplaceState(t,t.state,null)}function qa(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs=Fa,Za(e);var a=t.contextType;"object"===typeof a&&null!==a?i.context=Sa(a):(a=Ii(t)?Ti:Di.current,i.context=Zi(e,a)),i.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(Ua(e,t,a,r),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&za.enqueueReplaceState(i,i.state,null),Oa(e,r,i,n),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function Va(e,t,r){if(null!==(e=r.ref)&&"function"!==typeof e&&"object"!==typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(a(309));var n=r.stateNode}if(!n)throw Error(a(147,e));var i=n,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=i.refs;t===Fa&&(t=i.refs={}),null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(a(284));if(!r._owner)throw Error(a(290,e))}return e}function Ka(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ya(e){return(0,e._init)(e._payload)}function Ga(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Lc(e,t)).index=0,e.sibling=null,e}function s(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=2,r):n:(t.flags|=2,r):(t.flags|=1048576,r)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function u(e,t,r,n){return null===t||6!==t.tag?((t=Nc(r,e.mode,n)).return=e,t):((t=i(t,r)).return=e,t)}function c(e,t,r,n){var a=r.type;return a===x?h(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===I&&Ya(a)===t.type)?((n=i(t,r.props)).ref=Va(e,t,r),n.return=e,n):((n=Mc(r.type,r.key,r.props,null,e.mode,n)).ref=Va(e,t,r),n.return=e,n)}function l(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Fc(r,e.mode,n)).return=e,t):((t=i(t,r.children||[])).return=e,t)}function h(e,t,r,n,a){return null===t||7!==t.tag?((t=Bc(r,e.mode,n,a)).return=e,t):((t=i(t,r)).return=e,t)}function f(e,t,r){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Nc(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(r=Mc(t.type,t.key,t.props,null,e.mode,r)).ref=Va(e,null,t),r.return=e,r;case k:return(t=Fc(t,e.mode,r)).return=e,t;case I:return f(e,(0,t._init)(t._payload),r)}if(te(t)||M(t))return(t=Bc(t,e.mode,r,null)).return=e,t;Ka(e,t)}return null}function d(e,t,r,n){var i=null!==t?t.key:null;if("string"===typeof r&&""!==r||"number"===typeof r)return null!==i?null:u(e,t,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return r.key===i?c(e,t,r,n):null;case k:return r.key===i?l(e,t,r,n):null;case I:return d(e,t,(i=r._init)(r._payload),n)}if(te(r)||M(r))return null!==i?null:h(e,t,r,n,null);Ka(e,r)}return null}function p(e,t,r,n,i){if("string"===typeof n&&""!==n||"number"===typeof n)return u(t,e=e.get(r)||null,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return c(t,e=e.get(null===n.key?r:n.key)||null,n,i);case k:return l(t,e=e.get(null===n.key?r:n.key)||null,n,i);case I:return p(e,t,r,(0,n._init)(n._payload),i)}if(te(n)||M(n))return h(t,e=e.get(r)||null,n,i,null);Ka(t,n)}return null}function v(i,a,o,u){for(var c=null,l=null,h=a,v=a=0,g=null;null!==h&&v<o.length;v++){h.index>v?(g=h,h=null):g=h.sibling;var y=d(i,h,o[v],u);if(null===y){null===h&&(h=g);break}e&&h&&null===y.alternate&&t(i,h),a=s(y,a,v),null===l?c=y:l.sibling=y,l=y,h=g}if(v===o.length)return r(i,h),ia&&Ji(i,v),c;if(null===h){for(;v<o.length;v++)null!==(h=f(i,o[v],u))&&(a=s(h,a,v),null===l?c=h:l.sibling=h,l=h);return ia&&Ji(i,v),c}for(h=n(i,h);v<o.length;v++)null!==(g=p(h,i,v,o[v],u))&&(e&&null!==g.alternate&&h.delete(null===g.key?v:g.key),a=s(g,a,v),null===l?c=g:l.sibling=g,l=g);return e&&h.forEach((function(e){return t(i,e)})),ia&&Ji(i,v),c}function g(i,o,u,c){var l=M(u);if("function"!==typeof l)throw Error(a(150));if(null==(u=l.call(u)))throw Error(a(151));for(var h=l=null,v=o,g=o=0,y=null,m=u.next();null!==v&&!m.done;g++,m=u.next()){v.index>g?(y=v,v=null):y=v.sibling;var b=d(i,v,m.value,c);if(null===b){null===v&&(v=y);break}e&&v&&null===b.alternate&&t(i,v),o=s(b,o,g),null===h?l=b:h.sibling=b,h=b,v=y}if(m.done)return r(i,v),ia&&Ji(i,g),l;if(null===v){for(;!m.done;g++,m=u.next())null!==(m=f(i,m.value,c))&&(o=s(m,o,g),null===h?l=m:h.sibling=m,h=m);return ia&&Ji(i,g),l}for(v=n(i,v);!m.done;g++,m=u.next())null!==(m=p(v,i,g,m.value,c))&&(e&&null!==m.alternate&&v.delete(null===m.key?g:m.key),o=s(m,o,g),null===h?l=m:h.sibling=m,h=m);return e&&v.forEach((function(e){return t(i,e)})),ia&&Ji(i,g),l}return function e(n,a,s,u){if("object"===typeof s&&null!==s&&s.type===x&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case w:e:{for(var c=s.key,l=a;null!==l;){if(l.key===c){if((c=s.type)===x){if(7===l.tag){r(n,l.sibling),(a=i(l,s.props.children)).return=n,n=a;break e}}else if(l.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===I&&Ya(c)===l.type){r(n,l.sibling),(a=i(l,s.props)).ref=Va(n,l,s),a.return=n,n=a;break e}r(n,l);break}t(n,l),l=l.sibling}s.type===x?((a=Bc(s.props.children,n.mode,u,s.key)).return=n,n=a):((u=Mc(s.type,s.key,s.props,null,n.mode,u)).ref=Va(n,a,s),u.return=n,n=u)}return o(n);case k:e:{for(l=s.key;null!==a;){if(a.key===l){if(4===a.tag&&a.stateNode.containerInfo===s.containerInfo&&a.stateNode.implementation===s.implementation){r(n,a.sibling),(a=i(a,s.children||[])).return=n,n=a;break e}r(n,a);break}t(n,a),a=a.sibling}(a=Fc(s,n.mode,u)).return=n,n=a}return o(n);case I:return e(n,a,(l=s._init)(s._payload),u)}if(te(s))return v(n,a,s,u);if(M(s))return g(n,a,s,u);Ka(n,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==a&&6===a.tag?(r(n,a.sibling),(a=i(a,s)).return=n,n=a):(r(n,a),(a=Nc(s,n.mode,u)).return=n,n=a),o(n)):r(n,a)}}var Qa=Ga(!0),Xa=Ga(!1),Ja={},$a=Ei(Ja),es=Ei(Ja),ts=Ei(Ja);function rs(e){if(e===Ja)throw Error(a(174));return e}function ns(e,t){switch(Ci(ts,t),Ci(es,e),Ci($a,Ja),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ue(null,"");break;default:t=ue(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Si($a),Ci($a,t)}function is(){Si($a),Si(es),Si(ts)}function as(e){rs(ts.current);var t=rs($a.current),r=ue(t,e.type);t!==r&&(Ci(es,e),Ci($a,r))}function ss(e){es.current===e&&(Si($a),Si(es))}var os=Ei(0);function us(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var cs=[];function ls(){for(var e=0;e<cs.length;e++)cs[e]._workInProgressVersionPrimary=null;cs.length=0}var hs=_.ReactCurrentDispatcher,fs=_.ReactCurrentBatchConfig,ds=0,ps=null,vs=null,gs=null,ys=!1,ms=!1,bs=0,_s=0;function ws(){throw Error(a(321))}function ks(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!on(e[r],t[r]))return!1;return!0}function xs(e,t,r,n,i,s){if(ds=s,ps=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,hs.current=null===e||null===e.memoizedState?so:oo,e=r(n,i),ms){s=0;do{if(ms=!1,bs=0,25<=s)throw Error(a(301));s+=1,gs=vs=null,t.updateQueue=null,hs.current=uo,e=r(n,i)}while(ms)}if(hs.current=ao,t=null!==vs&&null!==vs.next,ds=0,gs=vs=ps=null,ys=!1,t)throw Error(a(300));return e}function Es(){var e=0!==bs;return bs=0,e}function Ss(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===gs?ps.memoizedState=gs=e:gs=gs.next=e,gs}function Cs(){if(null===vs){var e=ps.alternate;e=null!==e?e.memoizedState:null}else e=vs.next;var t=null===gs?ps.memoizedState:gs.next;if(null!==t)gs=t,vs=e;else{if(null===e)throw Error(a(310));e={memoizedState:(vs=e).memoizedState,baseState:vs.baseState,baseQueue:vs.baseQueue,queue:vs.queue,next:null},null===gs?ps.memoizedState=gs=e:gs=gs.next=e}return gs}function As(e,t){return"function"===typeof t?t(e):t}function Ds(e){var t=Cs(),r=t.queue;if(null===r)throw Error(a(311));r.lastRenderedReducer=e;var n=vs,i=n.baseQueue,s=r.pending;if(null!==s){if(null!==i){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(null!==i){s=i.next,n=n.baseState;var u=o=null,c=null,l=s;do{var h=l.lane;if((ds&h)===h)null!==c&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),n=l.hasEagerState?l.eagerState:e(n,l.action);else{var f={lane:h,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};null===c?(u=c=f,o=n):c=c.next=f,ps.lanes|=h,Ou|=h}l=l.next}while(null!==l&&l!==s);null===c?o=n:c.next=u,on(n,t.memoizedState)||(_o=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(null!==(e=r.interleaved)){i=e;do{s=i.lane,ps.lanes|=s,Ou|=s,i=i.next}while(i!==e)}else null===i&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Rs(e){var t=Cs(),r=t.queue;if(null===r)throw Error(a(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(null!==i){r.pending=null;var o=i=i.next;do{s=e(s,o.action),o=o.next}while(o!==i);on(s,t.memoizedState)||(_o=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function Ts(){}function Zs(e,t){var r=ps,n=Cs(),i=t(),s=!on(n.memoizedState,i);if(s&&(n.memoizedState=i,_o=!0),n=n.queue,Hs(Ls.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||null!==gs&&1&gs.memoizedState.tag){if(r.flags|=2048,Ns(9,Ps.bind(null,r,n,i,t),void 0,null),null===Tu)throw Error(a(349));0!==(30&ds)||Is(r,t,i)}return i}function Is(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=ps.updateQueue)?(t={lastEffect:null,stores:null},ps.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function Ps(e,t,r,n){t.value=r,t.getSnapshot=n,Ms(t)&&Bs(e)}function Ls(e,t,r){return r((function(){Ms(t)&&Bs(e)}))}function Ms(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!on(e,r)}catch(n){return!0}}function Bs(e){var t=Ra(e,1);null!==t&&nc(t,e,1,-1)}function Os(e){var t=Ss();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:As,lastRenderedState:e},t.queue=e,e=e.dispatch=to.bind(null,ps,e),[t.memoizedState,e]}function Ns(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===(t=ps.updateQueue)?(t={lastEffect:null,stores:null},ps.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function Fs(){return Cs().memoizedState}function Us(e,t,r,n){var i=Ss();ps.flags|=e,i.memoizedState=Ns(1|t,r,void 0,void 0===n?null:n)}function zs(e,t,r,n){var i=Cs();n=void 0===n?null:n;var a=void 0;if(null!==vs){var s=vs.memoizedState;if(a=s.destroy,null!==n&&ks(n,s.deps))return void(i.memoizedState=Ns(t,r,a,n))}ps.flags|=e,i.memoizedState=Ns(1|t,r,a,n)}function js(e,t){return Us(8390656,8,e,t)}function Hs(e,t){return zs(2048,8,e,t)}function Ws(e,t){return zs(4,2,e,t)}function qs(e,t){return zs(4,4,e,t)}function Vs(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ks(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,zs(4,4,Vs.bind(null,t,e),r)}function Ys(){}function Gs(e,t){var r=Cs();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&ks(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Qs(e,t){var r=Cs();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&ks(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Xs(e,t,r){return 0===(21&ds)?(e.baseState&&(e.baseState=!1,_o=!0),e.memoizedState=r):(on(r,t)||(r=vt(),ps.lanes|=r,Ou|=r,e.baseState=!0),t)}function Js(e,t){var r=bt;bt=0!==r&&4>r?r:4,e(!0);var n=fs.transition;fs.transition={};try{e(!1),t()}finally{bt=r,fs.transition=n}}function $s(){return Cs().memoizedState}function eo(e,t,r){var n=rc(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},ro(e))no(t,r);else if(null!==(r=Da(e,t,r,n))){nc(r,e,n,tc()),io(r,t,n)}}function to(e,t,r){var n=rc(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(ro(e))no(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=a(s,r);if(i.hasEagerState=!0,i.eagerState=o,on(o,s)){var u=t.interleaved;return null===u?(i.next=i,Aa(t)):(i.next=u.next,u.next=i),void(t.interleaved=i)}}catch(c){}null!==(r=Da(e,t,i,n))&&(nc(r,e,n,i=tc()),io(r,t,n))}}function ro(e){var t=e.alternate;return e===ps||null!==t&&t===ps}function no(e,t){ms=ys=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function io(e,t,r){if(0!==(4194240&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,mt(e,r)}}var ao={readContext:Sa,useCallback:ws,useContext:ws,useEffect:ws,useImperativeHandle:ws,useInsertionEffect:ws,useLayoutEffect:ws,useMemo:ws,useReducer:ws,useRef:ws,useState:ws,useDebugValue:ws,useDeferredValue:ws,useTransition:ws,useMutableSource:ws,useSyncExternalStore:ws,useId:ws,unstable_isNewReconciler:!1},so={readContext:Sa,useCallback:function(e,t){return Ss().memoizedState=[e,void 0===t?null:t],e},useContext:Sa,useEffect:js,useImperativeHandle:function(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Us(4194308,4,Vs.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Us(4194308,4,e,t)},useInsertionEffect:function(e,t){return Us(4,2,e,t)},useMemo:function(e,t){var r=Ss();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Ss();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=eo.bind(null,ps,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},Ss().memoizedState=e},useState:Os,useDebugValue:Ys,useDeferredValue:function(e){return Ss().memoizedState=e},useTransition:function(){var e=Os(!1),t=e[0];return e=Js.bind(null,e[1]),Ss().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ps,i=Ss();if(ia){if(void 0===r)throw Error(a(407));r=r()}else{if(r=t(),null===Tu)throw Error(a(349));0!==(30&ds)||Is(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,js(Ls.bind(null,n,s,e),[e]),n.flags|=2048,Ns(9,Ps.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Ss(),t=Tu.identifierPrefix;if(ia){var r=Xi;t=":"+t+"R"+(r=(Qi&~(1<<32-st(Qi)-1)).toString(32)+r),0<(r=bs++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=_s++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},oo={readContext:Sa,useCallback:Gs,useContext:Sa,useEffect:Hs,useImperativeHandle:Ks,useInsertionEffect:Ws,useLayoutEffect:qs,useMemo:Qs,useReducer:Ds,useRef:Fs,useState:function(){return Ds(As)},useDebugValue:Ys,useDeferredValue:function(e){return Xs(Cs(),vs.memoizedState,e)},useTransition:function(){return[Ds(As)[0],Cs().memoizedState]},useMutableSource:Ts,useSyncExternalStore:Zs,useId:$s,unstable_isNewReconciler:!1},uo={readContext:Sa,useCallback:Gs,useContext:Sa,useEffect:Hs,useImperativeHandle:Ks,useInsertionEffect:Ws,useLayoutEffect:qs,useMemo:Qs,useReducer:Rs,useRef:Fs,useState:function(){return Rs(As)},useDebugValue:Ys,useDeferredValue:function(e){var t=Cs();return null===vs?t.memoizedState=e:Xs(t,vs.memoizedState,e)},useTransition:function(){return[Rs(As)[0],Cs().memoizedState]},useMutableSource:Ts,useSyncExternalStore:Zs,useId:$s,unstable_isNewReconciler:!1};function co(e,t){try{var r="",n=t;do{r+=z(n),n=n.return}while(n);var i=r}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:i,digest:null}}function lo(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}function ho(e,t){try{console.error(t.value)}catch(r){setTimeout((function(){throw r}))}}var fo="function"===typeof WeakMap?WeakMap:Map;function po(e,t,r){(r=Pa(-1,r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){qu||(qu=!0,Vu=n),ho(0,t)},r}function vo(e,t,r){(r=Pa(-1,r)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){ho(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(r.callback=function(){ho(0,t),"function"!==typeof n&&(null===Ku?Ku=new Set([this]):Ku.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}function go(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new fo;var i=new Set;n.set(t,i)}else void 0===(i=n.get(t))&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=Cc.bind(null,e,t,r),t.then(e,e))}function yo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function mo(e,t,r,n,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=Pa(-1,1)).tag=2,La(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var bo=_.ReactCurrentOwner,_o=!1;function wo(e,t,r,n){t.child=null===e?Xa(t,null,r,n):Qa(t,e.child,r,n)}function ko(e,t,r,n,i){r=r.render;var a=t.ref;return Ea(t,i),n=xs(e,t,r,n,a,i),r=Es(),null===e||_o?(ia&&r&&ea(t),t.flags|=1,wo(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,qo(e,t,i))}function xo(e,t,r,n,i){if(null===e){var a=r.type;return"function"!==typeof a||Pc(a)||void 0!==a.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=Mc(r.type,null,n,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Eo(e,t,a,n,i))}if(a=e.child,0===(e.lanes&i)){var s=a.memoizedProps;if((r=null!==(r=r.compare)?r:un)(s,n)&&e.ref===t.ref)return qo(e,t,i)}return t.flags|=1,(e=Lc(a,n)).ref=t.ref,e.return=t,t.child=e}function Eo(e,t,r,n,i){if(null!==e){var a=e.memoizedProps;if(un(a,n)&&e.ref===t.ref){if(_o=!1,t.pendingProps=n=a,0===(e.lanes&i))return t.lanes=e.lanes,qo(e,t,i);0!==(131072&e.flags)&&(_o=!0)}}return Ao(e,t,r,n,i)}function So(e,t,r){var n=t.pendingProps,i=n.children,a=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ci(Lu,Pu),Pu|=r;else{if(0===(1073741824&r))return e=null!==a?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ci(Lu,Pu),Pu|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==a?a.baseLanes:r,Ci(Lu,Pu),Pu|=n}else null!==a?(n=a.baseLanes|r,t.memoizedState=null):n=r,Ci(Lu,Pu),Pu|=n;return wo(e,t,i,r),t.child}function Co(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Ao(e,t,r,n,i){var a=Ii(r)?Ti:Di.current;return a=Zi(t,a),Ea(t,i),r=xs(e,t,r,n,a,i),n=Es(),null===e||_o?(ia&&n&&ea(t),t.flags|=1,wo(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,qo(e,t,i))}function Do(e,t,r,n,i){if(Ii(r)){var a=!0;Bi(t)}else a=!1;if(Ea(t,i),null===t.stateNode)Wo(e,t),Ha(t,r,n),qa(t,r,n,i),n=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var u=s.context,c=r.contextType;"object"===typeof c&&null!==c?c=Sa(c):c=Zi(t,c=Ii(r)?Ti:Di.current);var l=r.getDerivedStateFromProps,h="function"===typeof l||"function"===typeof s.getSnapshotBeforeUpdate;h||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==n||u!==c)&&Wa(t,s,n,c),Ta=!1;var f=t.memoizedState;s.state=f,Oa(t,n,s,i),u=t.memoizedState,o!==n||f!==u||Ri.current||Ta?("function"===typeof l&&(Ua(t,r,l,n),u=t.memoizedState),(o=Ta||ja(t,r,o,n,f,u,c))?(h||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),s.props=n,s.state=u,s.context=c,n=o):("function"===typeof s.componentDidMount&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,Ia(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:ga(t.type,o),s.props=c,h=t.pendingProps,f=s.context,"object"===typeof(u=r.contextType)&&null!==u?u=Sa(u):u=Zi(t,u=Ii(r)?Ti:Di.current);var d=r.getDerivedStateFromProps;(l="function"===typeof d||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==h||f!==u)&&Wa(t,s,n,u),Ta=!1,f=t.memoizedState,s.state=f,Oa(t,n,s,i);var p=t.memoizedState;o!==h||f!==p||Ri.current||Ta?("function"===typeof d&&(Ua(t,r,d,n),p=t.memoizedState),(c=Ta||ja(t,r,c,n,f,p,u)||!1)?(l||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(n,p,u),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(n,p,u)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),s.props=n,s.state=p,s.context=u,n=c):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return Ro(e,t,r,n,a,i)}function Ro(e,t,r,n,i,a){Co(e,t);var s=0!==(128&t.flags);if(!n&&!s)return i&&Oi(t,r,!1),qo(e,t,a);n=t.stateNode,bo.current=t;var o=s&&"function"!==typeof r.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&s?(t.child=Qa(t,e.child,null,a),t.child=Qa(t,null,o,a)):wo(e,t,o,a),t.memoizedState=n.state,i&&Oi(t,r,!0),t.child}function To(e){var t=e.stateNode;t.pendingContext?Li(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Li(0,t.context,!1),ns(e,t.containerInfo)}function Zo(e,t,r,n,i){return da(),pa(i),t.flags|=256,wo(e,t,r,n),t.child}var Io,Po,Lo,Mo,Bo={dehydrated:null,treeContext:null,retryLane:0};function Oo(e){return{baseLanes:e,cachePool:null,transitions:null}}function No(e,t,r){var n,i=t.pendingProps,s=os.current,o=!1,u=0!==(128&t.flags);if((n=u)||(n=(null===e||null!==e.memoizedState)&&0!==(2&s)),n?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Ci(os,1&s),null===e)return ca(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(u=i.children,e=i.fallback,o?(i=t.mode,o=t.child,u={mode:"hidden",children:u},0===(1&i)&&null!==o?(o.childLanes=0,o.pendingProps=u):o=Oc(u,i,0,null),e=Bc(e,i,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Oo(r),t.memoizedState=Bo,e):Fo(t,u));if(null!==(s=e.memoizedState)&&null!==(n=s.dehydrated))return function(e,t,r,n,i,s,o){if(r)return 256&t.flags?(t.flags&=-257,Uo(e,t,o,n=lo(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=Oc({mode:"visible",children:n.children},i,0,null),(s=Bc(s,i,o,null)).flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,0!==(1&t.mode)&&Qa(t,e.child,null,o),t.child.memoizedState=Oo(o),t.memoizedState=Bo,s);if(0===(1&t.mode))return Uo(e,t,o,null);if("$!"===i.data){if(n=i.nextSibling&&i.nextSibling.dataset)var u=n.dgst;return n=u,Uo(e,t,o,n=lo(s=Error(a(419)),n,void 0))}if(u=0!==(o&e.childLanes),_o||u){if(null!==(n=Tu)){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(n.suspendedLanes|o))?0:i)&&i!==s.retryLane&&(s.retryLane=i,Ra(e,i),nc(n,e,i,-1))}return gc(),Uo(e,t,o,n=lo(Error(a(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Dc.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,na=ci(i.nextSibling),ra=t,ia=!0,aa=null,null!==e&&(Ki[Yi++]=Qi,Ki[Yi++]=Xi,Ki[Yi++]=Gi,Qi=e.id,Xi=e.overflow,Gi=t),t=Fo(t,n.children),t.flags|=4096,t)}(e,t,u,i,n,s,r);if(o){o=i.fallback,u=t.mode,n=(s=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&u)&&t.child!==s?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Lc(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==n?o=Lc(n,o):(o=Bc(o,u,r,null)).flags|=2,o.return=t,i.return=t,i.sibling=o,t.child=i,i=o,o=t.child,u=null===(u=e.child.memoizedState)?Oo(r):{baseLanes:u.baseLanes|r,cachePool:null,transitions:u.transitions},o.memoizedState=u,o.childLanes=e.childLanes&~r,t.memoizedState=Bo,i}return e=(o=e.child).sibling,i=Lc(o,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=r),i.return=t,i.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=i,t.memoizedState=null,i}function Fo(e,t){return(t=Oc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Uo(e,t,r,n){return null!==n&&pa(n),Qa(t,e.child,null,r),(e=Fo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zo(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),xa(e.return,t,r)}function jo(e,t,r,n,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function Ho(e,t,r){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(wo(e,t,n.children,r),0!==(2&(n=os.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zo(e,r,t);else if(19===e.tag)zo(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Ci(os,n),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;null!==r;)null!==(e=r.alternate)&&null===us(e)&&(i=r),r=r.sibling;null===(r=i)?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),jo(t,!1,i,r,a);break;case"backwards":for(r=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===us(e)){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}jo(t,!0,r,null,a);break;case"together":jo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qo(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),Ou|=t.lanes,0===(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(r=Lc(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Lc(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function Vo(e,t){if(!ia)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ko(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=14680064&i.subtreeFlags,n|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Yo(e,t,r){var n=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ko(t),null;case 1:case 17:return Ii(t.type)&&Pi(),Ko(t),null;case 3:return n=t.stateNode,is(),Si(Ri),Si(Di),ls(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ha(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==aa&&(oc(aa),aa=null))),Po(e,t),Ko(t),null;case 5:ss(t);var i=rs(ts.current);if(r=t.type,null!==e&&null!=t.stateNode)Lo(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(a(166));return Ko(t),null}if(e=rs($a.current),ha(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[fi]=t,n[di]=s,e=0!==(1&t.mode),r){case"dialog":Fn("cancel",n),Fn("close",n);break;case"iframe":case"object":case"embed":Fn("load",n);break;case"video":case"audio":for(i=0;i<Mn.length;i++)Fn(Mn[i],n);break;case"source":Fn("error",n);break;case"img":case"image":case"link":Fn("error",n),Fn("load",n);break;case"details":Fn("toggle",n);break;case"input":Q(n,s),Fn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Fn("invalid",n);break;case"textarea":ie(n,s),Fn("invalid",n)}for(var u in me(r,s),i=null,s)if(s.hasOwnProperty(u)){var c=s[u];"children"===u?"string"===typeof c?n.textContent!==c&&(!0!==s.suppressHydrationWarning&&Jn(n.textContent,c,e),i=["children",c]):"number"===typeof c&&n.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&Jn(n.textContent,c,e),i=["children",""+c]):o.hasOwnProperty(u)&&null!=c&&"onScroll"===u&&Fn("scroll",n)}switch(r){case"input":V(n),$(n,s,!0);break;case"textarea":V(n),se(n);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(n.onclick=$n)}n=i,t.updateQueue=n,null!==n&&(t.flags|=4)}else{u=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=u.createElement(r,{is:n.is}):(e=u.createElement(r),"select"===r&&(u=e,n.multiple?u.multiple=!0:n.size&&(u.size=n.size))):e=u.createElementNS(e,r),e[fi]=t,e[di]=n,Io(e,t,!1,!1),t.stateNode=e;e:{switch(u=be(r,n),r){case"dialog":Fn("cancel",e),Fn("close",e),i=n;break;case"iframe":case"object":case"embed":Fn("load",e),i=n;break;case"video":case"audio":for(i=0;i<Mn.length;i++)Fn(Mn[i],e);i=n;break;case"source":Fn("error",e),i=n;break;case"img":case"image":case"link":Fn("error",e),Fn("load",e),i=n;break;case"details":Fn("toggle",e),i=n;break;case"input":Q(e,n),i=G(e,n),Fn("invalid",e);break;case"option":default:i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=O({},n,{value:void 0}),Fn("invalid",e);break;case"textarea":ie(e,n),i=ne(e,n),Fn("invalid",e)}for(s in me(r,i),c=i)if(c.hasOwnProperty(s)){var l=c[s];"style"===s?ge(e,l):"dangerouslySetInnerHTML"===s?null!=(l=l?l.__html:void 0)&&he(e,l):"children"===s?"string"===typeof l?("textarea"!==r||""!==l)&&fe(e,l):"number"===typeof l&&fe(e,""+l):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(o.hasOwnProperty(s)?null!=l&&"onScroll"===s&&Fn("scroll",e):null!=l&&b(e,s,l,u))}switch(r){case"input":V(e),$(e,n,!1);break;case"textarea":V(e),se(e);break;case"option":null!=n.value&&e.setAttribute("value",""+W(n.value));break;case"select":e.multiple=!!n.multiple,null!=(s=n.value)?re(e,!!n.multiple,s,!1):null!=n.defaultValue&&re(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=$n)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ko(t),null;case 6:if(e&&null!=t.stateNode)Mo(e,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(a(166));if(r=rs(ts.current),rs($a.current),ha(t)){if(n=t.stateNode,r=t.memoizedProps,n[fi]=t,(s=n.nodeValue!==r)&&null!==(e=ra))switch(e.tag){case 3:Jn(n.nodeValue,r,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jn(n.nodeValue,r,0!==(1&e.mode))}s&&(t.flags|=4)}else(n=(9===r.nodeType?r:r.ownerDocument).createTextNode(n))[fi]=t,t.stateNode=n}return Ko(t),null;case 13:if(Si(os),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ia&&null!==na&&0!==(1&t.mode)&&0===(128&t.flags))fa(),da(),t.flags|=98560,s=!1;else if(s=ha(t),null!==n&&null!==n.dehydrated){if(null===e){if(!s)throw Error(a(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(a(317));s[fi]=t}else da(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ko(t),s=!1}else null!==aa&&(oc(aa),aa=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=r,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&os.current)?0===Mu&&(Mu=3):gc())),null!==t.updateQueue&&(t.flags|=4),Ko(t),null);case 4:return is(),Po(e,t),null===e&&jn(t.stateNode.containerInfo),Ko(t),null;case 10:return ka(t.type._context),Ko(t),null;case 19:if(Si(os),null===(s=t.memoizedState))return Ko(t),null;if(n=0!==(128&t.flags),null===(u=s.rendering))if(n)Vo(s,!1);else{if(0!==Mu||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(u=us(e))){for(t.flags|=128,Vo(s,!1),null!==(n=u.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;null!==r;)e=n,(s=r).flags&=14680066,null===(u=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,e=u.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ci(os,1&os.current|2),t.child}e=e.sibling}null!==s.tail&&Xe()>Hu&&(t.flags|=128,n=!0,Vo(s,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=us(u))){if(t.flags|=128,n=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),Vo(s,!0),null===s.tail&&"hidden"===s.tailMode&&!u.alternate&&!ia)return Ko(t),null}else 2*Xe()-s.renderingStartTime>Hu&&1073741824!==r&&(t.flags|=128,n=!0,Vo(s,!1),t.lanes=4194304);s.isBackwards?(u.sibling=t.child,t.child=u):(null!==(r=s.last)?r.sibling=u:t.child=u,s.last=u)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Xe(),t.sibling=null,r=os.current,Ci(os,n?1&r|2:1&r),t):(Ko(t),null);case 22:case 23:return fc(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&Pu)&&(Ko(t),6&t.subtreeFlags&&(t.flags|=8192)):Ko(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Go(e,t){switch(ta(t),t.tag){case 1:return Ii(t.type)&&Pi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return is(),Si(Ri),Si(Di),ls(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return ss(t),null;case 13:if(Si(os),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));da()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Si(os),null;case 4:return is(),null;case 10:return ka(t.type._context),null;case 22:case 23:return fc(),null;default:return null}}Io=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},Po=function(){},Lo=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,rs($a.current);var a,s=null;switch(r){case"input":i=G(e,i),n=G(e,n),s=[];break;case"select":i=O({},i,{value:void 0}),n=O({},n,{value:void 0}),s=[];break;case"textarea":i=ne(e,i),n=ne(e,n),s=[];break;default:"function"!==typeof i.onClick&&"function"===typeof n.onClick&&(e.onclick=$n)}for(l in me(r,n),r=null,i)if(!n.hasOwnProperty(l)&&i.hasOwnProperty(l)&&null!=i[l])if("style"===l){var u=i[l];for(a in u)u.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(o.hasOwnProperty(l)?s||(s=[]):(s=s||[]).push(l,null));for(l in n){var c=n[l];if(u=null!=i?i[l]:void 0,n.hasOwnProperty(l)&&c!==u&&(null!=c||null!=u))if("style"===l)if(u){for(a in u)!u.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in c)c.hasOwnProperty(a)&&u[a]!==c[a]&&(r||(r={}),r[a]=c[a])}else r||(s||(s=[]),s.push(l,r)),r=c;else"dangerouslySetInnerHTML"===l?(c=c?c.__html:void 0,u=u?u.__html:void 0,null!=c&&u!==c&&(s=s||[]).push(l,c)):"children"===l?"string"!==typeof c&&"number"!==typeof c||(s=s||[]).push(l,""+c):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(o.hasOwnProperty(l)?(null!=c&&"onScroll"===l&&Fn("scroll",e),s||u===c||(s=[])):(s=s||[]).push(l,c))}r&&(s=s||[]).push("style",r);var l=s;(t.updateQueue=l)&&(t.flags|=4)}},Mo=function(e,t,r,n){r!==n&&(t.flags|=4)};var Qo=!1,Xo=!1,Jo="function"===typeof WeakSet?WeakSet:Set,$o=null;function eu(e,t){var r=e.ref;if(null!==r)if("function"===typeof r)try{r(null)}catch(n){Sc(e,t,n)}else r.current=null}function tu(e,t,r){try{r()}catch(n){Sc(e,t,n)}}var ru=!1;function nu(e,t,r){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var i=n=n.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,void 0!==a&&tu(t,r,a)}i=i.next}while(i!==n)}}function iu(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function au(e){var t=e.ref;if(null!==t){var r=e.stateNode;e.tag,e=r,"function"===typeof t?t(e):t.current=e}}function su(e){var t=e.alternate;null!==t&&(e.alternate=null,su(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[fi],delete t[di],delete t[vi],delete t[gi],delete t[yi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ou(e){return 5===e.tag||3===e.tag||4===e.tag}function uu(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ou(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cu(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==t.onclick||(t.onclick=$n));else if(4!==n&&null!==(e=e.child))for(cu(e,t,r),e=e.sibling;null!==e;)cu(e,t,r),e=e.sibling}function lu(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&null!==(e=e.child))for(lu(e,t,r),e=e.sibling;null!==e;)lu(e,t,r),e=e.sibling}var hu=null,fu=!1;function du(e,t,r){for(r=r.child;null!==r;)pu(e,t,r),r=r.sibling}function pu(e,t,r){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(it,r)}catch(o){}switch(r.tag){case 5:Xo||eu(r,t);case 6:var n=hu,i=fu;hu=null,du(e,t,r),fu=i,null!==(hu=n)&&(fu?(e=hu,r=r.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)):hu.removeChild(r.stateNode));break;case 18:null!==hu&&(fu?(e=hu,r=r.stateNode,8===e.nodeType?ui(e.parentNode,r):1===e.nodeType&&ui(e,r),jt(e)):ui(hu,r.stateNode));break;case 4:n=hu,i=fu,hu=r.stateNode.containerInfo,fu=!0,du(e,t,r),hu=n,fu=i;break;case 0:case 11:case 14:case 15:if(!Xo&&(null!==(n=r.updateQueue)&&null!==(n=n.lastEffect))){i=n=n.next;do{var a=i,s=a.destroy;a=a.tag,void 0!==s&&(0!==(2&a)||0!==(4&a))&&tu(r,t,s),i=i.next}while(i!==n)}du(e,t,r);break;case 1:if(!Xo&&(eu(r,t),"function"===typeof(n=r.stateNode).componentWillUnmount))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Sc(r,t,o)}du(e,t,r);break;case 21:du(e,t,r);break;case 22:1&r.mode?(Xo=(n=Xo)||null!==r.memoizedState,du(e,t,r),Xo=n):du(e,t,r);break;default:du(e,t,r)}}function vu(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new Jo),t.forEach((function(t){var n=Rc.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))}))}}function gu(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,o=t,u=o;e:for(;null!==u;){switch(u.tag){case 5:hu=u.stateNode,fu=!1;break e;case 3:case 4:hu=u.stateNode.containerInfo,fu=!0;break e}u=u.return}if(null===hu)throw Error(a(160));pu(s,o,i),hu=null,fu=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(l){Sc(i,t,l)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)yu(t,e),t=t.sibling}function yu(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gu(t,e),mu(e),4&n){try{nu(3,e,e.return),iu(3,e)}catch(g){Sc(e,e.return,g)}try{nu(5,e,e.return)}catch(g){Sc(e,e.return,g)}}break;case 1:gu(t,e),mu(e),512&n&&null!==r&&eu(r,r.return);break;case 5:if(gu(t,e),mu(e),512&n&&null!==r&&eu(r,r.return),32&e.flags){var i=e.stateNode;try{fe(i,"")}catch(g){Sc(e,e.return,g)}}if(4&n&&null!=(i=e.stateNode)){var s=e.memoizedProps,o=null!==r?r.memoizedProps:s,u=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===u&&"radio"===s.type&&null!=s.name&&X(i,s),be(u,o);var l=be(u,s);for(o=0;o<c.length;o+=2){var h=c[o],f=c[o+1];"style"===h?ge(i,f):"dangerouslySetInnerHTML"===h?he(i,f):"children"===h?fe(i,f):b(i,h,f,l)}switch(u){case"input":J(i,s);break;case"textarea":ae(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;null!=p?re(i,!!s.multiple,p,!1):d!==!!s.multiple&&(null!=s.defaultValue?re(i,!!s.multiple,s.defaultValue,!0):re(i,!!s.multiple,s.multiple?[]:"",!1))}i[di]=s}catch(g){Sc(e,e.return,g)}}break;case 6:if(gu(t,e),mu(e),4&n){if(null===e.stateNode)throw Error(a(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(g){Sc(e,e.return,g)}}break;case 3:if(gu(t,e),mu(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{jt(t.containerInfo)}catch(g){Sc(e,e.return,g)}break;case 4:default:gu(t,e),mu(e);break;case 13:gu(t,e),mu(e),8192&(i=e.child).flags&&(s=null!==i.memoizedState,i.stateNode.isHidden=s,!s||null!==i.alternate&&null!==i.alternate.memoizedState||(ju=Xe())),4&n&&vu(e);break;case 22:if(h=null!==r&&null!==r.memoizedState,1&e.mode?(Xo=(l=Xo)||h,gu(t,e),Xo=l):gu(t,e),mu(e),8192&n){if(l=null!==e.memoizedState,(e.stateNode.isHidden=l)&&!h&&0!==(1&e.mode))for($o=e,h=e.child;null!==h;){for(f=$o=h;null!==$o;){switch(p=(d=$o).child,d.tag){case 0:case 11:case 14:case 15:nu(4,d,d.return);break;case 1:eu(d,d.return);var v=d.stateNode;if("function"===typeof v.componentWillUnmount){n=d,r=d.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(g){Sc(n,r,g)}}break;case 5:eu(d,d.return);break;case 22:if(null!==d.memoizedState){ku(f);continue}}null!==p?(p.return=d,$o=p):ku(f)}h=h.sibling}e:for(h=null,f=e;;){if(5===f.tag){if(null===h){h=f;try{i=f.stateNode,l?"function"===typeof(s=i.style).setProperty?s.setProperty("display","none","important"):s.display="none":(u=f.stateNode,o=void 0!==(c=f.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,u.style.display=ve("display",o))}catch(g){Sc(e,e.return,g)}}}else if(6===f.tag){if(null===h)try{f.stateNode.nodeValue=l?"":f.memoizedProps}catch(g){Sc(e,e.return,g)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===e)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;null===f.sibling;){if(null===f.return||f.return===e)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:gu(t,e),mu(e),4&n&&vu(e);case 21:}}function mu(e){var t=e.flags;if(2&t){try{e:{for(var r=e.return;null!==r;){if(ou(r)){var n=r;break e}r=r.return}throw Error(a(160))}switch(n.tag){case 5:var i=n.stateNode;32&n.flags&&(fe(i,""),n.flags&=-33),lu(e,uu(e),i);break;case 3:case 4:var s=n.stateNode.containerInfo;cu(e,uu(e),s);break;default:throw Error(a(161))}}catch(o){Sc(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bu(e,t,r){$o=e,_u(e,t,r)}function _u(e,t,r){for(var n=0!==(1&e.mode);null!==$o;){var i=$o,a=i.child;if(22===i.tag&&n){var s=null!==i.memoizedState||Qo;if(!s){var o=i.alternate,u=null!==o&&null!==o.memoizedState||Xo;o=Qo;var c=Xo;if(Qo=s,(Xo=u)&&!c)for($o=i;null!==$o;)u=(s=$o).child,22===s.tag&&null!==s.memoizedState?xu(i):null!==u?(u.return=s,$o=u):xu(i);for(;null!==a;)$o=a,_u(a,t,r),a=a.sibling;$o=i,Qo=o,Xo=c}wu(e)}else 0!==(8772&i.subtreeFlags)&&null!==a?(a.return=i,$o=a):wu(e)}}function wu(e){for(;null!==$o;){var t=$o;if(0!==(8772&t.flags)){var r=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Xo||iu(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Xo)if(null===r)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:ga(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Na(t,s,n);break;case 3:var o=t.updateQueue;if(null!==o){if(r=null,null!==t.child)switch(t.child.tag){case 5:case 1:r=t.child.stateNode}Na(t,o,r)}break;case 5:var u=t.stateNode;if(null===r&&4&t.flags){r=u;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var l=t.alternate;if(null!==l){var h=l.memoizedState;if(null!==h){var f=h.dehydrated;null!==f&&jt(f)}}}break;default:throw Error(a(163))}Xo||512&t.flags&&au(t)}catch(d){Sc(t,t.return,d)}}if(t===e){$o=null;break}if(null!==(r=t.sibling)){r.return=t.return,$o=r;break}$o=t.return}}function ku(e){for(;null!==$o;){var t=$o;if(t===e){$o=null;break}var r=t.sibling;if(null!==r){r.return=t.return,$o=r;break}$o=t.return}}function xu(e){for(;null!==$o;){var t=$o;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{iu(4,t)}catch(u){Sc(t,r,u)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var i=t.return;try{n.componentDidMount()}catch(u){Sc(t,i,u)}}var a=t.return;try{au(t)}catch(u){Sc(t,a,u)}break;case 5:var s=t.return;try{au(t)}catch(u){Sc(t,s,u)}}}catch(u){Sc(t,t.return,u)}if(t===e){$o=null;break}var o=t.sibling;if(null!==o){o.return=t.return,$o=o;break}$o=t.return}}var Eu,Su=Math.ceil,Cu=_.ReactCurrentDispatcher,Au=_.ReactCurrentOwner,Du=_.ReactCurrentBatchConfig,Ru=0,Tu=null,Zu=null,Iu=0,Pu=0,Lu=Ei(0),Mu=0,Bu=null,Ou=0,Nu=0,Fu=0,Uu=null,zu=null,ju=0,Hu=1/0,Wu=null,qu=!1,Vu=null,Ku=null,Yu=!1,Gu=null,Qu=0,Xu=0,Ju=null,$u=-1,ec=0;function tc(){return 0!==(6&Ru)?Xe():-1!==$u?$u:$u=Xe()}function rc(e){return 0===(1&e.mode)?1:0!==(2&Ru)&&0!==Iu?Iu&-Iu:null!==va.transition?(0===ec&&(ec=vt()),ec):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Qt(e.type)}function nc(e,t,r,n){if(50<Xu)throw Xu=0,Ju=null,Error(a(185));yt(e,r,n),0!==(2&Ru)&&e===Tu||(e===Tu&&(0===(2&Ru)&&(Nu|=r),4===Mu&&uc(e,Iu)),ic(e,n),1===r&&0===Ru&&0===(1&t.mode)&&(Hu=Xe()+500,Fi&&ji()))}function ic(e,t){var r=e.callbackNode;!function(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-st(a),o=1<<s,u=i[s];-1===u?0!==(o&r)&&0===(o&n)||(i[s]=dt(o,t)):u<=t&&(e.expiredLanes|=o),a&=~o}}(e,t);var n=ft(e,e===Tu?Iu:0);if(0===n)null!==r&&Ye(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=r&&Ye(r),1===t)0===e.tag?function(e){Fi=!0,zi(e)}(cc.bind(null,e)):zi(cc.bind(null,e)),si((function(){0===(6&Ru)&&ji()})),r=null;else{switch(_t(n)){case 1:r=$e;break;case 4:r=et;break;case 16:default:r=tt;break;case 536870912:r=nt}r=Tc(r,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function ac(e,t){if($u=-1,ec=0,0!==(6&Ru))throw Error(a(327));var r=e.callbackNode;if(xc()&&e.callbackNode!==r)return null;var n=ft(e,e===Tu?Iu:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=yc(e,n);else{t=n;var i=Ru;Ru|=2;var s=vc();for(Tu===e&&Iu===t||(Wu=null,Hu=Xe()+500,dc(e,t));;)try{bc();break}catch(u){pc(e,u)}wa(),Cu.current=s,Ru=i,null!==Zu?t=0:(Tu=null,Iu=0,t=Mu)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(n=i,t=sc(e,i))),1===t)throw r=Bu,dc(e,0),uc(e,n),ic(e,Xe()),r;if(6===t)uc(e,n);else{if(i=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!on(a(),i))return!1}catch(o){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=yc(e,n))&&(0!==(s=pt(e))&&(n=s,t=sc(e,s))),1===t))throw r=Bu,dc(e,0),uc(e,n),ic(e,Xe()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(a(345));case 2:case 5:kc(e,zu,Wu);break;case 3:if(uc(e,n),(130023424&n)===n&&10<(t=ju+500-Xe())){if(0!==ft(e,0))break;if(((i=e.suspendedLanes)&n)!==n){tc(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ni(kc.bind(null,e,zu,Wu),t);break}kc(e,zu,Wu);break;case 4:if(uc(e,n),(4194240&n)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-st(n);s=1<<o,(o=t[o])>i&&(i=o),n&=~s}if(n=i,10<(n=(120>(n=Xe()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Su(n/1960))-n)){e.timeoutHandle=ni(kc.bind(null,e,zu,Wu),n);break}kc(e,zu,Wu);break;default:throw Error(a(329))}}}return ic(e,Xe()),e.callbackNode===r?ac.bind(null,e):null}function sc(e,t){var r=Uu;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=yc(e,t))&&(t=zu,zu=r,null!==t&&oc(t)),e}function oc(e){null===zu?zu=e:zu.push.apply(zu,e)}function uc(e,t){for(t&=~Fu,t&=~Nu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-st(t),n=1<<r;e[r]=-1,t&=~n}}function cc(e){if(0!==(6&Ru))throw Error(a(327));xc();var t=ft(e,0);if(0===(1&t))return ic(e,Xe()),null;var r=yc(e,t);if(0!==e.tag&&2===r){var n=pt(e);0!==n&&(t=n,r=sc(e,n))}if(1===r)throw r=Bu,dc(e,0),uc(e,t),ic(e,Xe()),r;if(6===r)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,kc(e,zu,Wu),ic(e,Xe()),null}function lc(e,t){var r=Ru;Ru|=1;try{return e(t)}finally{0===(Ru=r)&&(Hu=Xe()+500,Fi&&ji())}}function hc(e){null!==Gu&&0===Gu.tag&&0===(6&Ru)&&xc();var t=Ru;Ru|=1;var r=Du.transition,n=bt;try{if(Du.transition=null,bt=1,e)return e()}finally{bt=n,Du.transition=r,0===(6&(Ru=t))&&ji()}}function fc(){Pu=Lu.current,Si(Lu)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,ii(r)),null!==Zu)for(r=Zu.return;null!==r;){var n=r;switch(ta(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&Pi();break;case 3:is(),Si(Ri),Si(Di),ls();break;case 5:ss(n);break;case 4:is();break;case 13:case 19:Si(os);break;case 10:ka(n.type._context);break;case 22:case 23:fc()}r=r.return}if(Tu=e,Zu=e=Lc(e.current,null),Iu=Pu=t,Mu=0,Bu=null,Fu=Nu=Ou=0,zu=Uu=null,null!==Ca){for(t=0;t<Ca.length;t++)if(null!==(n=(r=Ca[t]).interleaved)){r.interleaved=null;var i=n.next,a=r.pending;if(null!==a){var s=a.next;a.next=i,n.next=s}r.pending=n}Ca=null}return e}function pc(e,t){for(;;){var r=Zu;try{if(wa(),hs.current=ao,ys){for(var n=ps.memoizedState;null!==n;){var i=n.queue;null!==i&&(i.pending=null),n=n.next}ys=!1}if(ds=0,gs=vs=ps=null,ms=!1,bs=0,Au.current=null,null===r||null===r.return){Mu=1,Bu=t,Zu=null;break}e:{var s=e,o=r.return,u=r,c=t;if(t=Iu,u.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var l=c,h=u,f=h.tag;if(0===(1&h.mode)&&(0===f||11===f||15===f)){var d=h.alternate;d?(h.updateQueue=d.updateQueue,h.memoizedState=d.memoizedState,h.lanes=d.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=yo(o);if(null!==p){p.flags&=-257,mo(p,o,u,0,t),1&p.mode&&go(s,l,t),c=l;var v=(t=p).updateQueue;if(null===v){var g=new Set;g.add(c),t.updateQueue=g}else v.add(c);break e}if(0===(1&t)){go(s,l,t),gc();break e}c=Error(a(426))}else if(ia&&1&u.mode){var y=yo(o);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),mo(y,o,u,0,t),pa(co(c,u));break e}}s=c=co(c,u),4!==Mu&&(Mu=2),null===Uu?Uu=[s]:Uu.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Ba(s,po(0,c,t));break e;case 1:u=c;var m=s.type,b=s.stateNode;if(0===(128&s.flags)&&("function"===typeof m.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Ku||!Ku.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t,Ba(s,vo(s,u,t));break e}}s=s.return}while(null!==s)}wc(r)}catch(_){t=_,Zu===r&&null!==r&&(Zu=r=r.return);continue}break}}function vc(){var e=Cu.current;return Cu.current=ao,null===e?ao:e}function gc(){0!==Mu&&3!==Mu&&2!==Mu||(Mu=4),null===Tu||0===(268435455&Ou)&&0===(268435455&Nu)||uc(Tu,Iu)}function yc(e,t){var r=Ru;Ru|=2;var n=vc();for(Tu===e&&Iu===t||(Wu=null,dc(e,t));;)try{mc();break}catch(i){pc(e,i)}if(wa(),Ru=r,Cu.current=n,null!==Zu)throw Error(a(261));return Tu=null,Iu=0,Mu}function mc(){for(;null!==Zu;)_c(Zu)}function bc(){for(;null!==Zu&&!Ge();)_c(Zu)}function _c(e){var t=Eu(e.alternate,e,Pu);e.memoizedProps=e.pendingProps,null===t?wc(e):Zu=t,Au.current=null}function wc(e){var t=e;do{var r=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(r=Yo(r,t,Pu)))return void(Zu=r)}else{if(null!==(r=Go(r,t)))return r.flags&=32767,void(Zu=r);if(null===e)return Mu=6,void(Zu=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Zu=t);Zu=t=e}while(null!==t);0===Mu&&(Mu=5)}function kc(e,t,r){var n=bt,i=Du.transition;try{Du.transition=null,bt=1,function(e,t,r,n){do{xc()}while(null!==Gu);if(0!==(6&Ru))throw Error(a(327));r=e.finishedWork;var i=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(function(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-st(r),a=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~a}}(e,s),e===Tu&&(Zu=Tu=null,Iu=0),0===(2064&r.subtreeFlags)&&0===(2064&r.flags)||Yu||(Yu=!0,Tc(tt,(function(){return xc(),null}))),s=0!==(15990&r.flags),0!==(15990&r.subtreeFlags)||s){s=Du.transition,Du.transition=null;var o=bt;bt=1;var u=Ru;Ru|=4,Au.current=null,function(e,t){if(ei=Wt,dn(e=fn())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch(w){r=null;break e}var o=0,u=-1,c=-1,l=0,h=0,f=e,d=null;t:for(;;){for(var p;f!==r||0!==i&&3!==f.nodeType||(u=o+i),f!==s||0!==n&&3!==f.nodeType||(c=o+n),3===f.nodeType&&(o+=f.nodeValue.length),null!==(p=f.firstChild);)d=f,f=p;for(;;){if(f===e)break t;if(d===r&&++l===i&&(u=o),d===s&&++h===n&&(c=o),null!==(p=f.nextSibling))break;d=(f=d).parentNode}f=p}r=-1===u||-1===c?null:{start:u,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(ti={focusedElem:e,selectionRange:r},Wt=!1,$o=t;null!==$o;)if(e=(t=$o).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,$o=e;else for(;null!==$o;){t=$o;try{var v=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==v){var g=v.memoizedProps,y=v.memoizedState,m=t.stateNode,b=m.getSnapshotBeforeUpdate(t.elementType===t.type?g:ga(t.type,g),y);m.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var _=t.stateNode.containerInfo;1===_.nodeType?_.textContent="":9===_.nodeType&&_.documentElement&&_.removeChild(_.documentElement);break;default:throw Error(a(163))}}catch(w){Sc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,$o=e;break}$o=t.return}v=ru,ru=!1}(e,r),yu(r,e),pn(ti),Wt=!!ei,ti=ei=null,e.current=r,bu(r,e,i),Qe(),Ru=u,bt=o,Du.transition=s}else e.current=r;if(Yu&&(Yu=!1,Gu=e,Qu=i),s=e.pendingLanes,0===s&&(Ku=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(r.stateNode),ic(e,Xe()),null!==t)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(qu)throw qu=!1,e=Vu,Vu=null,e;0!==(1&Qu)&&0!==e.tag&&xc(),s=e.pendingLanes,0!==(1&s)?e===Ju?Xu++:(Xu=0,Ju=e):Xu=0,ji()}(e,t,r,n)}finally{Du.transition=i,bt=n}return null}function xc(){if(null!==Gu){var e=_t(Qu),t=Du.transition,r=bt;try{if(Du.transition=null,bt=16>e?16:e,null===Gu)var n=!1;else{if(e=Gu,Gu=null,Qu=0,0!==(6&Ru))throw Error(a(331));var i=Ru;for(Ru|=4,$o=e.current;null!==$o;){var s=$o,o=s.child;if(0!==(16&$o.flags)){var u=s.deletions;if(null!==u){for(var c=0;c<u.length;c++){var l=u[c];for($o=l;null!==$o;){var h=$o;switch(h.tag){case 0:case 11:case 15:nu(8,h,s)}var f=h.child;if(null!==f)f.return=h,$o=f;else for(;null!==$o;){var d=(h=$o).sibling,p=h.return;if(su(h),h===l){$o=null;break}if(null!==d){d.return=p,$o=d;break}$o=p}}}var v=s.alternate;if(null!==v){var g=v.child;if(null!==g){v.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}$o=s}}if(0!==(2064&s.subtreeFlags)&&null!==o)o.return=s,$o=o;else e:for(;null!==$o;){if(0!==(2048&(s=$o).flags))switch(s.tag){case 0:case 11:case 15:nu(9,s,s.return)}var m=s.sibling;if(null!==m){m.return=s.return,$o=m;break e}$o=s.return}}var b=e.current;for($o=b;null!==$o;){var _=(o=$o).child;if(0!==(2064&o.subtreeFlags)&&null!==_)_.return=o,$o=_;else e:for(o=b;null!==$o;){if(0!==(2048&(u=$o).flags))try{switch(u.tag){case 0:case 11:case 15:iu(9,u)}}catch(k){Sc(u,u.return,k)}if(u===o){$o=null;break e}var w=u.sibling;if(null!==w){w.return=u.return,$o=w;break e}$o=u.return}}if(Ru=i,ji(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(it,e)}catch(k){}n=!0}return n}finally{bt=r,Du.transition=t}}return!1}function Ec(e,t,r){e=La(e,t=po(0,t=co(r,t),1),1),t=tc(),null!==e&&(yt(e,1,t),ic(e,t))}function Sc(e,t,r){if(3===e.tag)Ec(e,e,r);else for(;null!==t;){if(3===t.tag){Ec(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Ku||!Ku.has(n))){t=La(t,e=vo(t,e=co(r,e),1),1),e=tc(),null!==t&&(yt(t,1,e),ic(t,e));break}}t=t.return}}function Cc(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&r,Tu===e&&(Iu&r)===r&&(4===Mu||3===Mu&&(130023424&Iu)===Iu&&500>Xe()-ju?dc(e,0):Fu|=r),ic(e,t)}function Ac(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var r=tc();null!==(e=Ra(e,t))&&(yt(e,t,r),ic(e,r))}function Dc(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Ac(e,r)}function Rc(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;null!==i&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(a(314))}null!==n&&n.delete(t),Ac(e,r)}function Tc(e,t){return Ke(e,t)}function Zc(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ic(e,t,r,n){return new Zc(e,t,r,n)}function Pc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Lc(e,t){var r=e.alternate;return null===r?((r=Ic(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Mc(e,t,r,n,i,s){var o=2;if(n=e,"function"===typeof e)Pc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case x:return Bc(r.children,i,s,t);case E:o=8,i|=8;break;case S:return(e=Ic(12,r,t,2|i)).elementType=S,e.lanes=s,e;case R:return(e=Ic(13,r,t,i)).elementType=R,e.lanes=s,e;case T:return(e=Ic(19,r,t,i)).elementType=T,e.lanes=s,e;case P:return Oc(r,i,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:o=10;break e;case A:o=9;break e;case D:o=11;break e;case Z:o=14;break e;case I:o=16,n=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Ic(o,r,t,i)).elementType=e,t.type=n,t.lanes=s,t}function Bc(e,t,r,n){return(e=Ic(7,e,n,t)).lanes=r,e}function Oc(e,t,r,n){return(e=Ic(22,e,n,t)).elementType=P,e.lanes=r,e.stateNode={isHidden:!1},e}function Nc(e,t,r){return(e=Ic(6,e,null,t)).lanes=r,e}function Fc(e,t,r){return(t=Ic(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function zc(e,t,r,n,i,a,s,o,u){return e=new Uc(e,t,r,o,u),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Ic(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Za(a),e}function jc(e){if(!e)return Ai;e:{if(je(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ii(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var r=e.type;if(Ii(r))return Mi(e,r,t)}return t}function Hc(e,t,r,n,i,a,s,o,u){return(e=zc(r,n,!0,e,0,a,0,o,u)).context=jc(null),r=e.current,(a=Pa(n=tc(),i=rc(r))).callback=void 0!==t&&null!==t?t:null,La(r,a,i),e.current.lanes=i,yt(e,i,n),ic(e,n),e}function Wc(e,t,r,n){var i=t.current,a=tc(),s=rc(i);return r=jc(r),null===t.context?t.context=r:t.pendingContext=r,(t=Pa(a,s)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=La(i,t,s))&&(nc(e,i,s,a),Ma(e,i,s)),s}function qc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Vc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function Kc(e,t){Vc(e,t),(e=e.alternate)&&Vc(e,t)}Eu=function(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ri.current)_o=!0;else{if(0===(e.lanes&r)&&0===(128&t.flags))return _o=!1,function(e,t,r){switch(t.tag){case 3:To(t),da();break;case 5:as(t);break;case 1:Ii(t.type)&&Bi(t);break;case 4:ns(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Ci(ya,n._currentValue),n._currentValue=i;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Ci(os,1&os.current),t.flags|=128,null):0!==(r&t.child.childLanes)?No(e,t,r):(Ci(os,1&os.current),null!==(e=qo(e,t,r))?e.sibling:null);Ci(os,1&os.current);break;case 19:if(n=0!==(r&t.childLanes),0!==(128&e.flags)){if(n)return Ho(e,t,r);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ci(os,os.current),n)break;return null;case 22:case 23:return t.lanes=0,So(e,t,r)}return qo(e,t,r)}(e,t,r);_o=0!==(131072&e.flags)}else _o=!1,ia&&0!==(1048576&t.flags)&&$i(t,Vi,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Wo(e,t),e=t.pendingProps;var i=Zi(t,Di.current);Ea(t,r),i=xs(null,t,n,e,i,r);var s=Es();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ii(n)?(s=!0,Bi(t)):s=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Za(t),i.updater=za,t.stateNode=i,i._reactInternals=t,qa(t,n,e,r),t=Ro(null,t,n,!0,s,r)):(t.tag=0,ia&&s&&ea(t),wo(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Wo(e,t),e=t.pendingProps,n=(i=n._init)(n._payload),t.type=n,i=t.tag=function(e){if("function"===typeof e)return Pc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===D)return 11;if(e===Z)return 14}return 2}(n),e=ga(n,e),i){case 0:t=Ao(null,t,n,e,r);break e;case 1:t=Do(null,t,n,e,r);break e;case 11:t=ko(null,t,n,e,r);break e;case 14:t=xo(null,t,n,ga(n.type,e),r);break e}throw Error(a(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,Ao(e,t,n,i=t.elementType===n?i:ga(n,i),r);case 1:return n=t.type,i=t.pendingProps,Do(e,t,n,i=t.elementType===n?i:ga(n,i),r);case 3:e:{if(To(t),null===e)throw Error(a(387));n=t.pendingProps,i=(s=t.memoizedState).element,Ia(e,t),Oa(t,n,null,r);var o=t.memoizedState;if(n=o.element,s.isDehydrated){if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Zo(e,t,n,r,i=co(Error(a(423)),t));break e}if(n!==i){t=Zo(e,t,n,r,i=co(Error(a(424)),t));break e}for(na=ci(t.stateNode.containerInfo.firstChild),ra=t,ia=!0,aa=null,r=Xa(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(da(),n===i){t=qo(e,t,r);break e}wo(e,t,n,r)}t=t.child}return t;case 5:return as(t),null===e&&ca(t),n=t.type,i=t.pendingProps,s=null!==e?e.memoizedProps:null,o=i.children,ri(n,i)?o=null:null!==s&&ri(n,s)&&(t.flags|=32),Co(e,t),wo(e,t,o,r),t.child;case 6:return null===e&&ca(t),null;case 13:return No(e,t,r);case 4:return ns(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=Qa(t,null,n,r):wo(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,ko(e,t,n,i=t.elementType===n?i:ga(n,i),r);case 7:return wo(e,t,t.pendingProps,r),t.child;case 8:case 12:return wo(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,Ci(ya,n._currentValue),n._currentValue=o,null!==s)if(on(s.value,o)){if(s.children===i.children&&!Ri.current){t=qo(e,t,r);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var u=s.dependencies;if(null!==u){o=s.child;for(var c=u.firstContext;null!==c;){if(c.context===n){if(1===s.tag){(c=Pa(-1,r&-r)).tag=2;var l=s.updateQueue;if(null!==l){var h=(l=l.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),l.pending=c}}s.lanes|=r,null!==(c=s.alternate)&&(c.lanes|=r),xa(s.return,r,t),u.lanes|=r;break}c=c.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(a(341));o.lanes|=r,null!==(u=o.alternate)&&(u.lanes|=r),xa(o,r,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}wo(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Ea(t,r),n=n(i=Sa(i)),t.flags|=1,wo(e,t,n,r),t.child;case 14:return i=ga(n=t.type,t.pendingProps),xo(e,t,n,i=ga(n.type,i),r);case 15:return Eo(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ga(n,i),Wo(e,t),t.tag=1,Ii(n)?(e=!0,Bi(t)):e=!1,Ea(t,r),Ha(t,n,i),qa(t,n,i,r),Ro(null,t,n,!0,e,r);case 19:return Ho(e,t,r);case 22:return So(e,t,r)}throw Error(a(156,t.tag))};var Yc="function"===typeof reportError?reportError:function(e){console.error(e)};function Gc(e){this._internalRoot=e}function Qc(e){this._internalRoot=e}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $c(){}function el(e,t,r,n,i){var a=r._reactRootContainer;if(a){var s=a;if("function"===typeof i){var o=i;i=function(){var e=qc(s);o.call(e)}}Wc(t,s,e,i)}else s=function(e,t,r,n,i){if(i){if("function"===typeof n){var a=n;n=function(){var e=qc(s);a.call(e)}}var s=Hc(t,n,e,0,null,!1,0,"",$c);return e._reactRootContainer=s,e[pi]=s.current,jn(8===e.nodeType?e.parentNode:e),hc(),s}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof n){var o=n;n=function(){var e=qc(u);o.call(e)}}var u=zc(e,0,!1,null,0,!1,0,"",$c);return e._reactRootContainer=u,e[pi]=u.current,jn(8===e.nodeType?e.parentNode:e),hc((function(){Wc(t,u,r,n)})),u}(r,t,e,i,n);return qc(s)}Qc.prototype.render=Gc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Wc(e,t,null,null)},Qc.prototype.unmount=Gc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;hc((function(){Wc(null,e,null,null)})),t[pi]=null}},Qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Et();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Pt.length&&0!==t&&t<Pt[r].priority;r++);Pt.splice(r,0,e),0===r&&Ot(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ht(t.pendingLanes);0!==r&&(mt(t,1|r),ic(t,Xe()),0===(6&Ru)&&(Hu=Xe()+500,ji()))}break;case 13:hc((function(){var t=Ra(e,1);if(null!==t){var r=tc();nc(t,e,1,r)}})),Kc(e,1)}},kt=function(e){if(13===e.tag){var t=Ra(e,134217728);if(null!==t)nc(t,e,134217728,tc());Kc(e,134217728)}},xt=function(e){if(13===e.tag){var t=rc(e),r=Ra(e,t);if(null!==r)nc(r,e,t,tc());Kc(e,t)}},Et=function(){return bt},St=function(e,t){var r=bt;try{return bt=e,t()}finally{bt=r}},ke=function(e,t,r){switch(t){case"input":if(J(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=wi(n);if(!i)throw Error(a(90));K(n),J(n,i)}}}break;case"textarea":ae(e,r);break;case"select":null!=(t=r.value)&&re(e,!!r.multiple,t,!1)}},De=lc,Re=hc;var tl={usingClientEntryPoint:!1,Events:[bi,_i,wi,Ce,Ae,lc]},rl={findFiberByHostInstance:mi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},nl={bundleType:rl.bundleType,version:rl.version,rendererPackageName:rl.rendererPackageName,rendererConfig:rl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:rl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var il=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!il.isDisabled&&il.supportsFiber)try{it=il.inject(nl),at=il}catch(le){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xc(t))throw Error(a(200));return function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},t.createRoot=function(e,t){if(!Xc(e))throw Error(a(299));var r=!1,n="",i=Yc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=zc(e,1,!1,null,0,r,0,n,i),e[pi]=t.current,jn(8===e.nodeType?e.parentNode:e),new Gc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return hc(e)},t.hydrate=function(e,t,r){if(!Jc(t))throw Error(a(200));return el(null,e,t,!0,r)},t.hydrateRoot=function(e,t,r){if(!Xc(e))throw Error(a(405));var n=null!=r&&r.hydratedSources||null,i=!1,s="",o=Yc;if(null!==r&&void 0!==r&&(!0===r.unstable_strictMode&&(i=!0),void 0!==r.identifierPrefix&&(s=r.identifierPrefix),void 0!==r.onRecoverableError&&(o=r.onRecoverableError)),t=Hc(t,null,e,1,null!=r?r:null,i,0,s,o),e[pi]=t.current,jn(e),n)for(e=0;e<n.length;e++)i=(i=(r=n[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new Qc(t)},t.render=function(e,t,r){if(!Jc(t))throw Error(a(200));return el(null,e,t,!1,r)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(a(40));return!!e._reactRootContainer&&(hc((function(){el(null,null,e,!1,(function(){e._reactRootContainer=null,e[pi]=null}))})),!0)},t.unstable_batchedUpdates=lc,t.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Jc(r))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return el(e,t,r,!1,n)},t.version="18.2.0-next-9e3b772b8-20220608"},1250:function(e,t,r){"use strict";var n=r(4164);t.createRoot=n.createRoot,t.hydrateRoot=n.hydrateRoot},4164:function(e,t,r){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(4463)},6374:function(e,t,r){"use strict";var n=r(2791),i=Symbol.for("react.element"),a=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var n,a={},c=null,l=null;for(n in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(l=t.ref),t)s.call(t,n)&&!u.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===a[n]&&(a[n]=t[n]);return{$$typeof:i,type:e,key:c,ref:l,props:a,_owner:o.current}}t.jsx=c},9117:function(e,t){"use strict";var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),d=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,g={};function y(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||p}function m(){}function b(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||p}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},m.prototype=y.prototype;var _=b.prototype=new m;_.constructor=b,v(_,y.prototype),_.isPureReactComponent=!0;var w=Array.isArray,k=Object.prototype.hasOwnProperty,x={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,n){var i,a={},s=null,o=null;if(null!=t)for(i in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)k.call(t,i)&&!E.hasOwnProperty(i)&&(a[i]=t[i]);var u=arguments.length-2;if(1===u)a.children=n;else if(1<u){for(var c=Array(u),l=0;l<u;l++)c[l]=arguments[l+2];a.children=c}if(e&&e.defaultProps)for(i in u=e.defaultProps)void 0===a[i]&&(a[i]=u[i]);return{$$typeof:r,type:e,key:s,ref:o,props:a,_owner:x.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var A=/\/+/g;function D(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function R(e,t,i,a,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var u=!1;if(null===e)u=!0;else switch(o){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case r:case n:u=!0}}if(u)return s=s(u=e),e=""===a?"."+D(u,0):a,w(s)?(i="",null!=e&&(i=e.replace(A,"$&/")+"/"),R(s,t,i,"",(function(e){return e}))):null!=s&&(C(s)&&(s=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,i+(!s.key||u&&u.key===s.key?"":(""+s.key).replace(A,"$&/")+"/")+e)),t.push(s)),1;if(u=0,a=""===a?".":a+":",w(e))for(var c=0;c<e.length;c++){var l=a+D(o=e[c],c);u+=R(o,t,i,l,s)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=d&&e[d]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),c=0;!(o=e.next()).done;)u+=R(o=o.value,t,i,l=a+D(o,c++),s);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function T(e,t,r){if(null==e)return e;var n=[],i=0;return R(e,n,"","",(function(e){return t.call(r,e,i++)})),n}function Z(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I={current:null},P={transition:null},L={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:P,ReactCurrentOwner:x};t.Children={map:T,forEach:function(e,t,r){T(e,(function(){t.apply(this,arguments)}),r)},count:function(e){var t=0;return T(e,(function(){t++})),t},toArray:function(e){return T(e,(function(e){return e}))||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=i,t.Profiler=s,t.PureComponent=b,t.StrictMode=a,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=v({},e.props),a=e.key,s=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,o=x.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(c in t)k.call(t,c)&&!E.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==u?u[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){u=Array(c);for(var l=0;l<c;l++)u[l]=arguments[l+2];i.children=u}return{$$typeof:r,type:e.type,key:a,ref:s,props:i,_owner:o}},t.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:Z}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return I.current.useCallback(e,t)},t.useContext=function(e){return I.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return I.current.useDeferredValue(e)},t.useEffect=function(e,t){return I.current.useEffect(e,t)},t.useId=function(){return I.current.useId()},t.useImperativeHandle=function(e,t,r){return I.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return I.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return I.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return I.current.useMemo(e,t)},t.useReducer=function(e,t,r){return I.current.useReducer(e,t,r)},t.useRef=function(e){return I.current.useRef(e)},t.useState=function(e){return I.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return I.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return I.current.useTransition()},t.version="18.2.0"},2791:function(e,t,r){"use strict";e.exports=r(9117)},184:function(e,t,r){"use strict";e.exports=r(6374)},449:function(e,t,r){"use strict";e.exports=s;var n=r(8193),i=s.prototype,a=new Date%1e9;function s(e){e=e||{},this.id=e.id||(1e9*Math.random()>>>0)+a++,this.max=e.max||1/0,this.items=e.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(e.lastModified||new Date);for(var t,r,n=this.items.length;n--;)t=this.items[n],r=new Date(t.expires)-new Date,this._lookup[t.key]=t,r>0?this.expire(t.key,r):r<=0&&this.delete(t.key)}i.has=function(e){return e in this._lookup},i.get=function(e){if(!this.has(e))return null;var t=this._lookup[e];return t.refresh&&this.expire(e,t.refresh),this.items.splice(this.items.indexOf(t),1),this.items.push(t),t.value},i.meta=function(e){if(!this.has(e))return null;var t=this._lookup[e];return"meta"in t?t.meta:null},i.set=function(e,t,r){var n=this._lookup[e],i=this._lookup[e]={key:e,value:t};return this.lastModified=new Date,n?(clearTimeout(n.timeout),this.items.splice(this.items.indexOf(n),1,i)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(i),this.size++),r&&("ttl"in r&&this.expire(e,r.ttl),"meta"in r&&(i.meta=r.meta),r.refresh&&(i.refresh=r.ttl)),this},i.delete=function(e){var t=this._lookup[e];return!!t&&(this.lastModified=new Date,this.items.splice(this.items.indexOf(t),1),clearTimeout(t.timeout),delete this._lookup[e],this.size--,this)},i.expire=function(e,t){var r=t||0,i=this._lookup[e];if(!i)return this;if("string"===typeof r&&(r=n(t)),"number"!==typeof r)throw new TypeError("Expiration time must be a string or number.");return clearTimeout(i.timeout),i.timeout=setTimeout(this.delete.bind(this,i.key),r),i.expires=Number(new Date)+r,this},i.clear=function(){for(var e=this.items.length;e--;)this.delete(this.items[e].key);return this},i.toJSON=function(){for(var e,t=new Array(this.items.length),r=t.length;r--;)e=this.items[r],t[r]={key:e.key,meta:e.meta,value:e.value,expires:e.expires,refresh:e.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:t}}},1779:function(e,t,r){"use strict";var n=r(6690).default,i=r(9728).default,a=r(6222),s=function(){function e(t,r,i){n(this,e);var s=this;this._started=a(),this._rescheduled=0,this._scheduled=r,this._args=i,this._triggered=!1,this._timerWrapper=function(){s._rescheduled>0?(s._scheduled=s._rescheduled-(a()-s._started),s._schedule(s._scheduled)):(s._triggered=!0,t.apply(null,s._args))},this._timer=setTimeout(this._timerWrapper,r)}return i(e,[{key:"reschedule",value:function(e){e||(e=this._scheduled);var t=a();t+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=t,this._rescheduled=e)}},{key:"_schedule",value:function(e){this._triggered=!1,this._started=a(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}},{key:"clear",value:function(){clearTimeout(this._timer)}}]),e}();e.exports=function(){if("function"!==typeof arguments[0])throw new Error("callback needed");if("number"!==typeof arguments[1])throw new Error("timeout needed");var e;if(arguments.length>0){e=new Array(arguments.length-2);for(var t=0;t<e.length;t++)e[t]=arguments[t+2]}return new s(arguments[0],arguments[1],e)}},6222:function(e){"use strict";e.exports=function(){return Date.now()}},9158:function(e,t,r){r(5509)},5509:function(e,t,r){var n=r(1500);t.operation=function(e){var r=t.timeouts(e);return new n(r,{forever:e&&(e.forever||e.retries===1/0),unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})},t.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var r in e)t[r]=e[r];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var n=[],i=0;i<t.retries;i++)n.push(this.createTimeout(i,t));return e&&e.forever&&!n.length&&n.push(this.createTimeout(i,t)),n.sort((function(e,t){return e-t})),n},t.createTimeout=function(e,t){var r=t.randomize?Math.random()+1:1,n=Math.round(r*Math.max(t.minTimeout,1)*Math.pow(t.factor,e));return n=Math.min(n,t.maxTimeout)},t.wrap=function(e,r,n){if(r instanceof Array&&(n=r,r=null),!n)for(var i in n=[],e)"function"===typeof e[i]&&n.push(i);for(var a=0;a<n.length;a++){var s=n[a],o=e[s];e[s]=function(n){var i=t.operation(r),a=Array.prototype.slice.call(arguments,1),s=a.pop();a.push((function(e){i.retry(e)||(e&&(arguments[0]=i.mainError()),s.apply(this,arguments))})),i.attempt((function(){n.apply(e,a)}))}.bind(e,o),e[s].options=r}}},1500:function(e){function t(e,t){"boolean"===typeof t&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}e.exports=t,t.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},t.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},t.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=(new Date).getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var r=this._timeouts.shift();if(void 0===r){if(!this._cachedTimeouts)return!1;this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1)}var n=this;return this._timer=setTimeout((function(){n._attempts++,n._operationTimeoutCb&&(n._timeout=setTimeout((function(){n._operationTimeoutCb(n._attempts)}),n._operationTimeout),n._options.unref&&n._timeout.unref()),n._fn(n._attempts)}),r),this._options.unref&&this._timer.unref(),!0},t.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout((function(){r._operationTimeoutCb()}),r._operationTimeout)),this._operationStart=(new Date).getTime(),this._fn(this._attempts)},t.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},t.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},t.prototype.start=t.prototype.try,t.prototype.errors=function(){return this._errors},t.prototype.attempts=function(){return this._attempts},t.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,r=0,n=0;n<this._errors.length;n++){var i=this._errors[n],a=i.message,s=(e[a]||0)+1;e[a]=s,s>=r&&(t=i,r=s)}return t}},6327:function(e,t,r){"use strict";var n=r(206),i=/[\/\?<>\\:\*\|"]/g,a=/[\x00-\x1f\x80-\x9f]/g,s=/^\.+$/,o=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,u=/[\. ]+$/;function c(e,t){if("string"!==typeof e)throw new Error("Input must be string");var r=e.replace(i,t).replace(a,t).replace(s,t).replace(o,t).replace(u,t);return n(r,255)}e.exports=function(e,t){var r=t&&t.replacement||"",n=c(e,r);return""===r?n:c(n,"")}},6813:function(e,t){"use strict";function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,i=e[n];if(!(0<a(i,t)))break e;e[n]=t,e[r]=i,r=n}}function n(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,i=e.length,s=i>>>1;n<s;){var o=2*(n+1)-1,u=e[o],c=o+1,l=e[c];if(0>a(u,r))c<i&&0>a(l,u)?(e[n]=l,e[c]=r,n=c):(e[n]=u,e[o]=r,n=o);else{if(!(c<i&&0>a(l,r)))break e;e[n]=l,e[c]=r,n=c}}}return t}function a(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,u=o.now();t.unstable_now=function(){return o.now()-u}}var c=[],l=[],h=1,f=null,d=3,p=!1,v=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,m="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function _(e){for(var t=n(l);null!==t;){if(null===t.callback)i(l);else{if(!(t.startTime<=e))break;i(l),t.sortIndex=t.expirationTime,r(c,t)}t=n(l)}}function w(e){if(g=!1,_(e),!v)if(null!==n(c))v=!0,P(k);else{var t=n(l);null!==t&&L(w,t.startTime-e)}}function k(e,r){v=!1,g&&(g=!1,m(C),C=-1),p=!0;var a=d;try{for(_(r),f=n(c);null!==f&&(!(f.expirationTime>r)||e&&!R());){var s=f.callback;if("function"===typeof s){f.callback=null,d=f.priorityLevel;var o=s(f.expirationTime<=r);r=t.unstable_now(),"function"===typeof o?f.callback=o:f===n(c)&&i(c),_(r)}else i(c);f=n(c)}if(null!==f)var u=!0;else{var h=n(l);null!==h&&L(w,h.startTime-r),u=!1}return u}finally{f=null,d=a,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var x,E=!1,S=null,C=-1,A=5,D=-1;function R(){return!(t.unstable_now()-D<A)}function T(){if(null!==S){var e=t.unstable_now();D=e;var r=!0;try{r=S(!0,e)}finally{r?x():(E=!1,S=null)}}else E=!1}if("function"===typeof b)x=function(){b(T)};else if("undefined"!==typeof MessageChannel){var Z=new MessageChannel,I=Z.port2;Z.port1.onmessage=T,x=function(){I.postMessage(null)}}else x=function(){y(T,0)};function P(e){S=e,E||(E=!0,x())}function L(e,r){C=y((function(){e(t.unstable_now())}),r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||p||(v=!0,P(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var r=d;d=t;try{return e()}finally{d=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=d;d=e;try{return t()}finally{d=r}},t.unstable_scheduleCallback=function(e,i,a){var s=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?s+a:s:a=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:a,expirationTime:o=a+o,sortIndex:-1},a>s?(e.sortIndex=a,r(l,e),null===n(c)&&e===n(l)&&(g?(m(C),C=-1):g=!0,L(w,a-s))):(e.sortIndex=o,r(c,e),v||p||(v=!0,P(k))),e},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(e){var t=d;return function(){var r=d;d=t;try{return e.apply(this,arguments)}finally{d=r}}}},5296:function(e,t,r){"use strict";e.exports=r(6813)},1620:function(e,t,r){"use strict";var n=r(6690).default,i=r(9728).default;function a(e,t){return e+s(t)}function s(e){var t=e;return 16843009*((t=(858993459&(t-=t>>1&1431655765))+(t>>2&858993459))+(t>>4)&252645135)>>24}function o(e,t){return e[0]-t[0]}function u(e){return e[1]}e.exports=function(){function e(){n(this,e),this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}return i(e,[{key:"set",value:function(e,t){var r=this._internalPositionFor(e,!1);if(void 0===t)-1!==r&&(this._unsetInternalPos(r),this._unsetBit(e),this._changedLength=!0,this._changedData=!0);else{var n=!1;-1===r?(r=this._data.length,this._setBit(e),this._changedData=!0):n=!0,this._setInternalPos(r,e,t,n),this._changedLength=!0}}},{key:"unset",value:function(e){this.set(e,void 0)}},{key:"get",value:function(e){this._sortData();var t=this._internalPositionFor(e,!0);if(-1!==t)return this._data[t][1]}},{key:"push",value:function(e){return this.set(this.length,e),this.length}},{key:"length",get:function(){if(this._sortData(),this._changedLength){var e=this._data[this._data.length-1];this._length=e?e[0]+1:0,this._changedLength=!1}return this._length}},{key:"forEach",value:function(e){for(var t=0;t<this.length;)e(this.get(t),t,this),t++}},{key:"map",value:function(e){for(var t=0,r=new Array(this.length);t<this.length;)r[t]=e(this.get(t),t,this),t++;return r}},{key:"reduce",value:function(e,t){for(var r=0,n=t;r<this.length;){n=e(n,this.get(r),r),r++}return n}},{key:"find",value:function(e){for(var t,r,n=0;n<this.length&&!t;)t=e(r=this.get(n)),n++;return t?r:void 0}},{key:"_internalPositionFor",value:function(e,t){var r=this._bytePosFor(e,t);if(r>=this._bitArrays.length)return-1;var n=this._bitArrays[r],i=e-7*r;return(n&1<<i)>0?this._bitArrays.slice(0,r).reduce(a,0)+s(n&~(4294967295<<i+1))-1:-1}},{key:"_bytePosFor",value:function(e,t){for(var r=Math.floor(e/7),n=r+1;!t&&this._bitArrays.length<n;)this._bitArrays.push(0);return r}},{key:"_setBit",value:function(e){var t=this._bytePosFor(e,!1);this._bitArrays[t]|=1<<e-7*t}},{key:"_unsetBit",value:function(e){var t=this._bytePosFor(e,!1);this._bitArrays[t]&=~(1<<e-7*t)}},{key:"_setInternalPos",value:function(e,t,r,n){var i=this._data,a=[t,r];if(n)this._sortData(),i[e]=a;else{if(i.length)if(i[i.length-1][0]>=t)i.push(a);else if(i[0][0]<=t)i.unshift(a);else{var s=Math.round(i.length/2);this._data=i.slice(0,s).concat(a).concat(i.slice(s))}else this._data.push(a);this._changedData=!0,this._changedLength=!0}}},{key:"_unsetInternalPos",value:function(e){this._data.splice(e,1)}},{key:"_sortData",value:function(){this._changedData&&this._data.sort(o),this._changedData=!1}},{key:"bitField",value:function(){for(var e,t=[],r=8,n=0,i=0,a=this._bitArrays.slice();a.length||n;){0===n&&(e=a.shift(),n=7);var s=Math.min(n,r);i|=(e&~(255<<s))<<8-r,e>>>=s,n-=s,(r-=s)&&(n||a.length)||(t.push(i),i=0,r=8)}for(var o=t.length-1;o>0;o--){if(0!==t[o])break;t.pop()}return t}},{key:"compactArray",value:function(){return this._sortData(),this._data.map(u)}}]),e}()},6662:function(e,t,r){var n=r(7061).default,i=r(6737).default,a=r(8186).default;e.exports=function(e){if(e[Symbol.asyncIterator])return e;if(e.getReader)return a(n().mark((function t(){var r,a,s,o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.getReader(),t.prev=1;case 2:return t.next=5,i(r.read());case 5:if(a=t.sent,s=a.done,o=a.value,!s){t.next=10;break}return t.abrupt("return");case 10:return t.next=12,o;case 12:t.next=2;break;case 14:return t.prev=14,r.releaseLock(),t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[1,,14,17]])})))();throw new Error("unknown stream")}},7683:function(e,t,r){"use strict";var n=r(6690).default,i=r(9728).default,a=r(6115).default,s=r(1588).default,o=r(3808).default,u=r(1655).default,c=r(6389).default,l=globalThis.AbortController,h=r(1779),f=function(e){u(r,e);var t=c(r);function r(e){var i;return n(this,r),(i=t.call(this))._ms=e,i._timer=h((function(){return i.abort()}),e),Object.setPrototypeOf(a(i),r.prototype),i}return i(r,[{key:"abort",value:function(){return this._timer.clear(),s(o(r.prototype),"abort",this).call(this)}},{key:"clear",value:function(){this._timer.clear()}},{key:"reset",value:function(){var e=this;this._timer.clear(),this._timer=h((function(){return e.abort()}),this._ms)}}]),r}(l);e.exports={TimeoutController:f}},206:function(e,t,r){"use strict";var n=r(9022),i=r(4847);e.exports=n.bind(null,i)},9022:function(e){"use strict";function t(e){return e>=55296&&e<=56319}function r(e){return e>=56320&&e<=57343}e.exports=function(e,n,i){if("string"!==typeof n)throw new Error("Input must be string");for(var a,s,o=n.length,u=0,c=0;c<o;c+=1){if(a=n.charCodeAt(c),s=n[c],t(a)&&r(n.charCodeAt(c+1))&&(s+=n[c+=1]),(u+=e(s))===i)return n.slice(0,c+1);if(u>i)return n.slice(0,c-s.length+1)}return n}},4847:function(e){"use strict";function t(e){return e>=55296&&e<=56319}function r(e){return e>=56320&&e<=57343}e.exports=function(e){if("string"!==typeof e)throw new Error("Input must be string");for(var n=e.length,i=0,a=null,s=null,o=0;o<n;o++)r(a=e.charCodeAt(o))?null!=s&&t(s)?i+=1:i+=3:a<=127?i+=1:a>=128&&a<=2047?i+=2:a>=2048&&a<=65535&&(i+=3),s=a;return i}},9662:function(e){e.exports=function e(n,i){var a,s=0,o=0,u=i=i||0,c=n.length;do{if(u>=c)throw e.bytes=0,new RangeError("Could not decode varint");a=n[u++],s+=o<28?(a&r)<<o:(a&r)*Math.pow(2,o),o+=7}while(a>=t);return e.bytes=u-i,s};var t=128,r=127},1625:function(e){e.exports=function e(i,a,s){a=a||[];var o=s=s||0;for(;i>=n;)a[s++]=255&i|t,i/=128;for(;i&r;)a[s++]=255&i|t,i>>>=7;return a[s]=0|i,e.bytes=s-o+1,a};var t=128,r=-128,n=Math.pow(2,31)},6074:function(e,t,r){e.exports={encode:r(1625),decode:r(9662),encodingLength:r(3120)}},3120:function(e){var t=Math.pow(2,7),r=Math.pow(2,14),n=Math.pow(2,21),i=Math.pow(2,28),a=Math.pow(2,35),s=Math.pow(2,42),o=Math.pow(2,49),u=Math.pow(2,56),c=Math.pow(2,63);e.exports=function(e){return e<t?1:e<r?2:e<n?3:e<i?4:e<a?5:e<s?6:e<o?7:e<u?8:e<c?9:10}},9806:function(e,t,r){"use strict";var n=r(6074);e.exports=function(e){if(!(e instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");for(var t=[];e.length>0;){var r=n.decode(e);t.push(r),e=e.slice(n.decode.bytes)}return t}},3522:function(e){e.exports=function e(n,i){var a,s=0,o=0,u=i=i||0,c=n.length;do{if(u>=c||o>49)throw e.bytes=0,new RangeError("Could not decode varint");a=n[u++],s+=o<28?(a&r)<<o:(a&r)*Math.pow(2,o),o+=7}while(a>=t);return e.bytes=u-i,s};var t=128,r=127},6993:function(e){e.exports=function e(i,a,s){if(Number.MAX_SAFE_INTEGER&&i>Number.MAX_SAFE_INTEGER)throw e.bytes=0,new RangeError("Could not encode varint");a=a||[];var o=s=s||0;for(;i>=n;)a[s++]=255&i|t,i/=128;for(;i&r;)a[s++]=255&i|t,i>>>=7;return a[s]=0|i,e.bytes=s-o+1,a};var t=128,r=-128,n=Math.pow(2,31)},4561:function(e,t,r){e.exports={encode:r(6993),decode:r(3522),encodingLength:r(2570)}},2570:function(e){var t=Math.pow(2,7),r=Math.pow(2,14),n=Math.pow(2,21),i=Math.pow(2,28),a=Math.pow(2,35),s=Math.pow(2,42),o=Math.pow(2,49),u=Math.pow(2,56),c=Math.pow(2,63);e.exports=function(e){return e<t?1:e<r?2:e<n?3:e<i?4:e<a?5:e<s?6:e<o?7:e<u?8:e<c?9:10}},3531:function(e,t,r){var n=r(6690).default,i=r(9728).default;self,e.exports=function(){"use strict";var e={};return function(){var t=e;Object.defineProperty(t,"__esModule",{value:!0}),t.FitAddon=void 0,t.FitAddon=function(){function e(){n(this,e)}return i(e,[{key:"activate",value:function(e){this._terminal=e}},{key:"dispose",value:function(){}},{key:"fit",value:function(){var e=this.proposeDimensions();if(e&&this._terminal&&!isNaN(e.cols)&&!isNaN(e.rows)){var t=this._terminal._core;this._terminal.rows===e.rows&&this._terminal.cols===e.cols||(t._renderService.clear(),this._terminal.resize(e.cols,e.rows))}}},{key:"proposeDimensions",value:function(){if(this._terminal&&this._terminal.element&&this._terminal.element.parentElement){var e=this._terminal._core,t=e._renderService.dimensions;if(0!==t.css.cell.width&&0!==t.css.cell.height){var r=0===this._terminal.options.scrollback?0:e.viewport.scrollBarWidth,n=window.getComputedStyle(this._terminal.element.parentElement),i=parseInt(n.getPropertyValue("height")),a=Math.max(0,parseInt(n.getPropertyValue("width"))),s=window.getComputedStyle(this._terminal.element),o=i-(parseInt(s.getPropertyValue("padding-top"))+parseInt(s.getPropertyValue("padding-bottom"))),u=a-(parseInt(s.getPropertyValue("padding-right"))+parseInt(s.getPropertyValue("padding-left")))-r;return{cols:Math.max(2,Math.floor(u/t.css.cell.width)),rows:Math.max(1,Math.floor(o/t.css.cell.height))}}}}}]),e}()}(),e}()},3737:function(e,t,r){var n=r(6115).default,i=r(861).default,a=r(1588).default,s=r(3808).default,o=r(7424).default,u=r(4704).default,c=r(6690).default,l=r(9728).default,h=r(1655).default,f=r(6389).default;self,e.exports=function(){"use strict";var e={965:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.GlyphRenderer=void 0;var i,a=r(374),s=r(509),o=r(855),d=r(859),p=r(776),v=r(381),g=11,y=g*Float32Array.BYTES_PER_ELEMENT,m=0,b=0,_=0,w=function(e){h(r,e);var t=f(r);function r(e,n,i){var o;c(this,r),(o=t.call(this))._terminal=e,o._gl=n,o._dimensions=i,o._activeBuffer=0,o._vertices={count:0,attributes:new Float32Array(0),attributesBuffers:[new Float32Array(0),new Float32Array(0)]};var u=o._gl;void 0===s.TextureAtlas.maxAtlasPages&&(s.TextureAtlas.maxAtlasPages=Math.min(32,(0,a.throwIfFalsy)(u.getParameter(u.MAX_TEXTURE_IMAGE_UNITS))),s.TextureAtlas.maxTextureSize=(0,a.throwIfFalsy)(u.getParameter(u.MAX_TEXTURE_SIZE))),o._program=(0,a.throwIfFalsy)((0,v.createProgram)(u,"#version 300 es\nlayout (location = 0) in vec2 a_unitquad;\nlayout (location = 1) in vec2 a_cellpos;\nlayout (location = 2) in vec2 a_offset;\nlayout (location = 3) in vec2 a_size;\nlayout (location = 4) in float a_texpage;\nlayout (location = 5) in vec2 a_texcoord;\nlayout (location = 6) in vec2 a_texsize;\n\nuniform mat4 u_projection;\nuniform vec2 u_resolution;\n\nout vec2 v_texcoord;\nflat out int v_texpage;\n\nvoid main() {\n  vec2 zeroToOne = (a_offset / u_resolution) + a_cellpos + (a_unitquad * a_size);\n  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);\n  v_texpage = int(a_texpage);\n  v_texcoord = a_texcoord + a_unitquad * a_texsize;\n}",function(e){for(var t="",r=1;r<e;r++)t+=" else if (v_texpage == ".concat(r,") { outColor = texture(u_texture[").concat(r,"], v_texcoord); }");return"#version 300 es\nprecision lowp float;\n\nin vec2 v_texcoord;\nflat in int v_texpage;\n\nuniform sampler2D u_texture[".concat(e,"];\n\nout vec4 outColor;\n\nvoid main() {\n  if (v_texpage == 0) {\n    outColor = texture(u_texture[0], v_texcoord);\n  } ").concat(t,"\n}")}(s.TextureAtlas.maxAtlasPages))),o.register((0,d.toDisposable)((function(){return u.deleteProgram(o._program)}))),o._projectionLocation=(0,a.throwIfFalsy)(u.getUniformLocation(o._program,"u_projection")),o._resolutionLocation=(0,a.throwIfFalsy)(u.getUniformLocation(o._program,"u_resolution")),o._textureLocation=(0,a.throwIfFalsy)(u.getUniformLocation(o._program,"u_texture")),o._vertexArrayObject=u.createVertexArray(),u.bindVertexArray(o._vertexArrayObject);var l=new Float32Array([0,0,1,0,0,1,1,1]),h=u.createBuffer();o.register((0,d.toDisposable)((function(){return u.deleteBuffer(h)}))),u.bindBuffer(u.ARRAY_BUFFER,h),u.bufferData(u.ARRAY_BUFFER,l,u.STATIC_DRAW),u.enableVertexAttribArray(0),u.vertexAttribPointer(0,2,o._gl.FLOAT,!1,0,0);var f=new Uint8Array([0,1,2,3]),p=u.createBuffer();o.register((0,d.toDisposable)((function(){return u.deleteBuffer(p)}))),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,p),u.bufferData(u.ELEMENT_ARRAY_BUFFER,f,u.STATIC_DRAW),o._attributesBuffer=(0,a.throwIfFalsy)(u.createBuffer()),o.register((0,d.toDisposable)((function(){return u.deleteBuffer(o._attributesBuffer)}))),u.bindBuffer(u.ARRAY_BUFFER,o._attributesBuffer),u.enableVertexAttribArray(2),u.vertexAttribPointer(2,2,u.FLOAT,!1,y,0),u.vertexAttribDivisor(2,1),u.enableVertexAttribArray(3),u.vertexAttribPointer(3,2,u.FLOAT,!1,y,2*Float32Array.BYTES_PER_ELEMENT),u.vertexAttribDivisor(3,1),u.enableVertexAttribArray(4),u.vertexAttribPointer(4,1,u.FLOAT,!1,y,4*Float32Array.BYTES_PER_ELEMENT),u.vertexAttribDivisor(4,1),u.enableVertexAttribArray(5),u.vertexAttribPointer(5,2,u.FLOAT,!1,y,5*Float32Array.BYTES_PER_ELEMENT),u.vertexAttribDivisor(5,1),u.enableVertexAttribArray(6),u.vertexAttribPointer(6,2,u.FLOAT,!1,y,7*Float32Array.BYTES_PER_ELEMENT),u.vertexAttribDivisor(6,1),u.enableVertexAttribArray(1),u.vertexAttribPointer(1,2,u.FLOAT,!1,y,9*Float32Array.BYTES_PER_ELEMENT),u.vertexAttribDivisor(1,1),u.useProgram(o._program);for(var g=new Int32Array(s.TextureAtlas.maxAtlasPages),m=0;m<s.TextureAtlas.maxAtlasPages;m++)g[m]=m;u.uniform1iv(o._textureLocation,g),u.uniformMatrix4fv(o._projectionLocation,!1,v.PROJECTION_MATRIX),o._atlasTextures=[];for(var b=function(){var e=new v.GLTexture((0,a.throwIfFalsy)(u.createTexture()));o.register((0,d.toDisposable)((function(){return u.deleteTexture(e.texture)}))),u.activeTexture(u.TEXTURE0+_),u.bindTexture(u.TEXTURE_2D,e.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),u.texImage2D(u.TEXTURE_2D,0,u.RGBA,1,1,0,u.RGBA,u.UNSIGNED_BYTE,new Uint8Array([255,0,0,255])),o._atlasTextures[_]=e},_=0;_<s.TextureAtlas.maxAtlasPages;_++)b();return u.enable(u.BLEND),u.blendFunc(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA),o.handleResize(),o}return l(r,[{key:"beginFrame",value:function(){return!this._atlas||this._atlas.beginFrame()}},{key:"updateCell",value:function(e,t,r,n,i,a,s,o){this._updateCell(this._vertices.attributes,e,t,r,n,i,a,s,o)}},{key:"_updateCell",value:function(e,t,r,n,a,s,u,c,l){m=(r*this._terminal.cols+t)*g,n!==o.NULL_CELL_CODE&&void 0!==n?this._atlas&&(i=c&&c.length>1?this._atlas.getRasterizedGlyphCombinedChar(c,a,s,u,!1):this._atlas.getRasterizedGlyph(n,a,s,u,!1),b=Math.floor((this._dimensions.device.cell.width-this._dimensions.device.char.width)/2),a!==l&&i.offset.x>b?(_=i.offset.x-b,e[m]=-(i.offset.x-_)+this._dimensions.device.char.left,e[m+1]=-i.offset.y+this._dimensions.device.char.top,e[m+2]=(i.size.x-_)/this._dimensions.device.canvas.width,e[m+3]=i.size.y/this._dimensions.device.canvas.height,e[m+4]=i.texturePage,e[m+5]=i.texturePositionClipSpace.x+_/this._atlas.pages[i.texturePage].canvas.width,e[m+6]=i.texturePositionClipSpace.y,e[m+7]=i.sizeClipSpace.x-_/this._atlas.pages[i.texturePage].canvas.width,e[m+8]=i.sizeClipSpace.y):(e[m]=-i.offset.x+this._dimensions.device.char.left,e[m+1]=-i.offset.y+this._dimensions.device.char.top,e[m+2]=i.size.x/this._dimensions.device.canvas.width,e[m+3]=i.size.y/this._dimensions.device.canvas.height,e[m+4]=i.texturePage,e[m+5]=i.texturePositionClipSpace.x,e[m+6]=i.texturePositionClipSpace.y,e[m+7]=i.sizeClipSpace.x,e[m+8]=i.sizeClipSpace.y)):e.fill(0,m,m+g-1-2)}},{key:"clear",value:function(){var e=this._terminal,t=e.cols*e.rows*g;this._vertices.count!==t?this._vertices.attributes=new Float32Array(t):this._vertices.attributes.fill(0);for(var r=0;r<this._vertices.attributesBuffers.length;r++)this._vertices.count!==t?this._vertices.attributesBuffers[r]=new Float32Array(t):this._vertices.attributesBuffers[r].fill(0);this._vertices.count=t,r=0;for(var n=0;n<e.rows;n++)for(var i=0;i<e.cols;i++)this._vertices.attributes[r+9]=i/e.cols,this._vertices.attributes[r+10]=n/e.rows,r+=g}},{key:"handleResize",value:function(){var e=this._gl;e.useProgram(this._program),e.viewport(0,0,e.canvas.width,e.canvas.height),e.uniform2f(this._resolutionLocation,e.canvas.width,e.canvas.height),this.clear()}},{key:"render",value:function(e){if(this._atlas){var t=this._gl;t.useProgram(this._program),t.bindVertexArray(this._vertexArrayObject),this._activeBuffer=(this._activeBuffer+1)%2;for(var r=this._vertices.attributesBuffers[this._activeBuffer],n=0,i=0;i<e.lineLengths.length;i++){var a=i*this._terminal.cols*g,s=this._vertices.attributes.subarray(a,a+e.lineLengths[i]*g);r.set(s,n),n+=s.length}t.bindBuffer(t.ARRAY_BUFFER,this._attributesBuffer),t.bufferData(t.ARRAY_BUFFER,r.subarray(0,n),t.STREAM_DRAW);for(var o=0;o<this._atlas.pages.length;o++)this._atlas.pages[o].version!==this._atlasTextures[o].version&&this._bindAtlasPageTexture(t,this._atlas,o);t.drawElementsInstanced(t.TRIANGLE_STRIP,4,t.UNSIGNED_BYTE,0,n/g)}}},{key:"setAtlas",value:function(e){this._atlas=e;var t,r=u(this._atlasTextures);try{for(r.s();!(t=r.n()).done;)t.value.version=-1}catch(n){r.e(n)}finally{r.f()}}},{key:"_bindAtlasPageTexture",value:function(e,t,r){e.activeTexture(e.TEXTURE0+r),e.bindTexture(e.TEXTURE_2D,this._atlasTextures[r].texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.pages[r].canvas),e.generateMipmap(e.TEXTURE_2D),this._atlasTextures[r].version=t.pages[r].version}},{key:"setDimensions",value:function(e){this._dimensions=e}}]),r}(d.Disposable);t.GlyphRenderer=w,n([p.traceCall],w.prototype,"updateCell",null)},742:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.RectangleRenderer=void 0;var n=r(374),i=r(859),a=r(310),s=r(381),o=8*Float32Array.BYTES_PER_ELEMENT,u=l((function e(){c(this,e),this.attributes=new Float32Array(160),this.count=0})),d=0,p=0,v=0,g=0,y=0,m=0,b=0,_=function(e){h(r,e);var t=f(r);function r(e,a,l,h){var f;c(this,r),(f=t.call(this))._terminal=e,f._gl=a,f._dimensions=l,f._themeService=h,f._vertices=new u,f._verticesCursor=new u;var d=f._gl;f._program=(0,n.throwIfFalsy)((0,s.createProgram)(d,"#version 300 es\nlayout (location = 0) in vec2 a_position;\nlayout (location = 1) in vec2 a_size;\nlayout (location = 2) in vec4 a_color;\nlayout (location = 3) in vec2 a_unitquad;\n\nuniform mat4 u_projection;\n\nout vec4 v_color;\n\nvoid main() {\n  vec2 zeroToOne = a_position + (a_unitquad * a_size);\n  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);\n  v_color = a_color;\n}","#version 300 es\nprecision lowp float;\n\nin vec4 v_color;\n\nout vec4 outColor;\n\nvoid main() {\n  outColor = v_color;\n}")),f.register((0,i.toDisposable)((function(){return d.deleteProgram(f._program)}))),f._projectionLocation=(0,n.throwIfFalsy)(d.getUniformLocation(f._program,"u_projection")),f._vertexArrayObject=d.createVertexArray(),d.bindVertexArray(f._vertexArrayObject);var p=new Float32Array([0,0,1,0,0,1,1,1]),v=d.createBuffer();f.register((0,i.toDisposable)((function(){return d.deleteBuffer(v)}))),d.bindBuffer(d.ARRAY_BUFFER,v),d.bufferData(d.ARRAY_BUFFER,p,d.STATIC_DRAW),d.enableVertexAttribArray(3),d.vertexAttribPointer(3,2,f._gl.FLOAT,!1,0,0);var g=new Uint8Array([0,1,2,3]),y=d.createBuffer();return f.register((0,i.toDisposable)((function(){return d.deleteBuffer(y)}))),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,y),d.bufferData(d.ELEMENT_ARRAY_BUFFER,g,d.STATIC_DRAW),f._attributesBuffer=(0,n.throwIfFalsy)(d.createBuffer()),f.register((0,i.toDisposable)((function(){return d.deleteBuffer(f._attributesBuffer)}))),d.bindBuffer(d.ARRAY_BUFFER,f._attributesBuffer),d.enableVertexAttribArray(0),d.vertexAttribPointer(0,2,d.FLOAT,!1,o,0),d.vertexAttribDivisor(0,1),d.enableVertexAttribArray(1),d.vertexAttribPointer(1,2,d.FLOAT,!1,o,2*Float32Array.BYTES_PER_ELEMENT),d.vertexAttribDivisor(1,1),d.enableVertexAttribArray(2),d.vertexAttribPointer(2,4,d.FLOAT,!1,o,4*Float32Array.BYTES_PER_ELEMENT),d.vertexAttribDivisor(2,1),f._updateCachedColors(h.colors),f.register(f._themeService.onChangeColors((function(e){f._updateCachedColors(e),f._updateViewportRectangle()}))),f}return l(r,[{key:"renderBackgrounds",value:function(){this._renderVertices(this._vertices)}},{key:"renderCursor",value:function(){this._renderVertices(this._verticesCursor)}},{key:"_renderVertices",value:function(e){var t=this._gl;t.useProgram(this._program),t.bindVertexArray(this._vertexArrayObject),t.uniformMatrix4fv(this._projectionLocation,!1,s.PROJECTION_MATRIX),t.bindBuffer(t.ARRAY_BUFFER,this._attributesBuffer),t.bufferData(t.ARRAY_BUFFER,e.attributes,t.DYNAMIC_DRAW),t.drawElementsInstanced(this._gl.TRIANGLE_STRIP,4,t.UNSIGNED_BYTE,0,e.count)}},{key:"handleResize",value:function(){this._updateViewportRectangle()}},{key:"setDimensions",value:function(e){this._dimensions=e}},{key:"_updateCachedColors",value:function(e){this._bgFloat=this._colorToFloat32Array(e.background),this._cursorFloat=this._colorToFloat32Array(e.cursor)}},{key:"_updateViewportRectangle",value:function(){this._addRectangleFloat(this._vertices.attributes,0,0,0,this._terminal.cols*this._dimensions.device.cell.width,this._terminal.rows*this._dimensions.device.cell.height,this._bgFloat)}},{key:"updateBackgrounds",value:function(e){var t,r,n,i,s,o,u,c,l,h,f,d=this._terminal,p=this._vertices,v=1;for(t=0;t<d.rows;t++){for(n=-1,i=0,s=0,o=!1,r=0;r<d.cols;r++)u=(t*d.cols+r)*a.RENDER_MODEL_INDICIES_PER_CELL,c=e.cells[u+a.RENDER_MODEL_BG_OFFSET],h=!!(67108864&(l=e.cells[u+a.RENDER_MODEL_FG_OFFSET])),(c!==i||l!==s&&(o||h))&&((0!==i||o&&0!==s)&&(f=8*v++,this._updateRectangle(p,f,s,i,n,r,t)),n=r,i=c,s=l,o=h);(0!==i||o&&0!==s)&&(f=8*v++,this._updateRectangle(p,f,s,i,n,d.cols,t))}p.count=v}},{key:"updateCursor",value:function(e){var t=this._verticesCursor,r=e.cursor;if(r&&"block"!==r.style){var n,i=0;"bar"!==r.style&&"outline"!==r.style||(n=8*i++,this._addRectangleFloat(t.attributes,n,r.x*this._dimensions.device.cell.width,r.y*this._dimensions.device.cell.height,"bar"===r.style?r.dpr*r.cursorWidth:r.dpr,this._dimensions.device.cell.height,this._cursorFloat)),"underline"!==r.style&&"outline"!==r.style||(n=8*i++,this._addRectangleFloat(t.attributes,n,r.x*this._dimensions.device.cell.width,(r.y+1)*this._dimensions.device.cell.height-r.dpr,r.width*this._dimensions.device.cell.width,r.dpr,this._cursorFloat)),"outline"===r.style&&(n=8*i++,this._addRectangleFloat(t.attributes,n,r.x*this._dimensions.device.cell.width,r.y*this._dimensions.device.cell.height,r.width*this._dimensions.device.cell.width,r.dpr,this._cursorFloat),n=8*i++,this._addRectangleFloat(t.attributes,n,(r.x+r.width)*this._dimensions.device.cell.width-r.dpr,r.y*this._dimensions.device.cell.height,r.dpr,this._dimensions.device.cell.height,this._cursorFloat)),t.count=i}else t.count=0}},{key:"_updateRectangle",value:function(e,t,r,n,i,a,o){if(67108864&r)switch(50331648&r){case 16777216:case 33554432:d=this._themeService.colors.ansi[255&r].rgba;break;case 50331648:d=(16777215&r)<<8;break;default:d=this._themeService.colors.foreground.rgba}else switch(50331648&n){case 16777216:case 33554432:d=this._themeService.colors.ansi[255&n].rgba;break;case 50331648:d=(16777215&n)<<8;break;default:d=this._themeService.colors.background.rgba}e.attributes.length<t+4&&(e.attributes=(0,s.expandFloat32Array)(e.attributes,this._terminal.rows*this._terminal.cols*8)),p=i*this._dimensions.device.cell.width,v=o*this._dimensions.device.cell.height,g=(d>>24&255)/255,y=(d>>16&255)/255,m=(d>>8&255)/255,b=1,this._addRectangle(e.attributes,t,p,v,(a-i)*this._dimensions.device.cell.width,this._dimensions.device.cell.height,g,y,m,b)}},{key:"_addRectangle",value:function(e,t,r,n,i,a,s,o,u,c){e[t]=r/this._dimensions.device.canvas.width,e[t+1]=n/this._dimensions.device.canvas.height,e[t+2]=i/this._dimensions.device.canvas.width,e[t+3]=a/this._dimensions.device.canvas.height,e[t+4]=s,e[t+5]=o,e[t+6]=u,e[t+7]=c}},{key:"_addRectangleFloat",value:function(e,t,r,n,i,a,s){e[t]=r/this._dimensions.device.canvas.width,e[t+1]=n/this._dimensions.device.canvas.height,e[t+2]=i/this._dimensions.device.canvas.width,e[t+3]=a/this._dimensions.device.canvas.height,e[t+4]=s[0],e[t+5]=s[1],e[t+6]=s[2],e[t+7]=s[3]}},{key:"_colorToFloat32Array",value:function(e){return new Float32Array([(e.rgba>>24&255)/255,(e.rgba>>16&255)/255,(e.rgba>>8&255)/255,(255&e.rgba)/255])}}]),r}(i.Disposable);t.RectangleRenderer=_},310:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.RenderModel=t.COMBINED_CHAR_BIT_MASK=t.RENDER_MODEL_EXT_OFFSET=t.RENDER_MODEL_FG_OFFSET=t.RENDER_MODEL_BG_OFFSET=t.RENDER_MODEL_INDICIES_PER_CELL=void 0;var n=r(296);t.RENDER_MODEL_INDICIES_PER_CELL=4,t.RENDER_MODEL_BG_OFFSET=1,t.RENDER_MODEL_FG_OFFSET=2,t.RENDER_MODEL_EXT_OFFSET=3,t.COMBINED_CHAR_BIT_MASK=2147483648,t.RenderModel=function(){function e(){c(this,e),this.cells=new Uint32Array(0),this.lineLengths=new Uint32Array(0),this.selection=(0,n.createSelectionRenderModel)()}return l(e,[{key:"resize",value:function(e,r){var n=e*r*t.RENDER_MODEL_INDICIES_PER_CELL;n!==this.cells.length&&(this.cells=new Uint32Array(n),this.lineLengths=new Uint32Array(r))}},{key:"clear",value:function(){this.cells.fill(0,0),this.lineLengths.fill(0,0)}}]),e}()},666:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.JoinedCellData=t.WebglRenderer=void 0;var i=r(820),a=r(274),s=r(627),d=r(457),p=r(56),v=r(374),g=r(345),y=r(859),m=r(147),b=r(782),_=r(855),w=r(776),k=r(965),x=r(742),E=r(310),S=r(733),C=function(e){h(r,e);var t=f(r);function r(e,n,l,h,f,d,m,_,w){var k,x,C;c(this,r),(C=t.call(this))._terminal=e,C._characterJoinerService=n,C._charSizeService=l,C._coreBrowserService=h,C._coreService=f,C._decorationService=d,C._optionsService=m,C._themeService=_,C._cursorBlinkStateManager=new y.MutableDisposable,C._charAtlasDisposable=C.register(new y.MutableDisposable),C._model=new E.RenderModel,C._workCell=new b.CellData,C._rectangleRenderer=C.register(new y.MutableDisposable),C._glyphRenderer=C.register(new y.MutableDisposable),C._onChangeTextureAtlas=C.register(new g.EventEmitter),C.onChangeTextureAtlas=C._onChangeTextureAtlas.event,C._onAddTextureAtlasCanvas=C.register(new g.EventEmitter),C.onAddTextureAtlasCanvas=C._onAddTextureAtlasCanvas.event,C._onRemoveTextureAtlasCanvas=C.register(new g.EventEmitter),C.onRemoveTextureAtlasCanvas=C._onRemoveTextureAtlasCanvas.event,C._onRequestRedraw=C.register(new g.EventEmitter),C.onRequestRedraw=C._onRequestRedraw.event,C._onContextLoss=C.register(new g.EventEmitter),C.onContextLoss=C._onContextLoss.event,C.register(C._themeService.onChangeColors((function(){return C._handleColorChange()}))),C._cellColorResolver=new a.CellColorResolver(C._terminal,C._model.selection,C._decorationService,C._coreBrowserService,C._themeService),C._core=C._terminal._core,C._renderLayers=[new S.LinkRenderLayer(C._core.screenElement,2,C._terminal,C._core.linkifier2,C._coreBrowserService,m,C._themeService)],C.dimensions=(0,v.createRenderDimensions)(),C._devicePixelRatio=C._coreBrowserService.dpr,C._updateDimensions(),C._updateCursorBlink(),C.register(m.onOptionChange((function(){return C._handleOptionsChanged()}))),C._canvas=document.createElement("canvas");var A={antialias:!1,depth:!1,preserveDrawingBuffer:w};if(C._gl=C._canvas.getContext("webgl2",A),!C._gl)throw new Error("WebGL2 not supported "+C._gl);return C.register((0,i.addDisposableDomListener)(C._canvas,"webglcontextlost",(function(e){console.log("webglcontextlost event received"),e.preventDefault(),C._contextRestorationTimeout=setTimeout((function(){C._contextRestorationTimeout=void 0,console.warn("webgl context not restored; firing onContextLoss"),C._onContextLoss.fire(e)}),3e3)}))),C.register((0,i.addDisposableDomListener)(C._canvas,"webglcontextrestored",(function(e){console.warn("webglcontextrestored event received"),clearTimeout(C._contextRestorationTimeout),C._contextRestorationTimeout=void 0,(0,s.removeTerminalFromCache)(C._terminal),C._initializeWebGLState(),C._requestRedrawViewport()}))),C.register((0,p.observeDevicePixelDimensions)(C._canvas,C._coreBrowserService.window,(function(e,t){return C._setCanvasDevicePixelDimensions(e,t)}))),C._core.screenElement.appendChild(C._canvas),k=C._initializeWebGLState(),x=o(k,2),C._rectangleRenderer.value=x[0],C._glyphRenderer.value=x[1],C._isAttached=C._coreBrowserService.window.document.body.contains(C._core.screenElement),C.register((0,y.toDisposable)((function(){var e,t,r=u(C._renderLayers);try{for(r.s();!(t=r.n()).done;)t.value.dispose()}catch(n){r.e(n)}finally{r.f()}null===(e=C._canvas.parentElement)||void 0===e||e.removeChild(C._canvas),(0,s.removeTerminalFromCache)(C._terminal)}))),C}return l(r,[{key:"textureAtlas",get:function(){var e;return null===(e=this._charAtlas)||void 0===e?void 0:e.pages[0].canvas}},{key:"_handleColorChange",value:function(){this._refreshCharAtlas(),this._clearModel(!0)}},{key:"handleDevicePixelRatioChange",value:function(){this._devicePixelRatio!==this._coreBrowserService.dpr&&(this._devicePixelRatio=this._coreBrowserService.dpr,this.handleResize(this._terminal.cols,this._terminal.rows))}},{key:"handleResize",value:function(e,t){var r,n,i,a;this._updateDimensions(),this._model.resize(this._terminal.cols,this._terminal.rows);var s,o=u(this._renderLayers);try{for(o.s();!(s=o.n()).done;)s.value.resize(this._terminal,this.dimensions)}catch(c){o.e(c)}finally{o.f()}this._canvas.width=this.dimensions.device.canvas.width,this._canvas.height=this.dimensions.device.canvas.height,this._canvas.style.width="".concat(this.dimensions.css.canvas.width,"px"),this._canvas.style.height="".concat(this.dimensions.css.canvas.height,"px"),this._core.screenElement.style.width="".concat(this.dimensions.css.canvas.width,"px"),this._core.screenElement.style.height="".concat(this.dimensions.css.canvas.height,"px"),null===(r=this._rectangleRenderer.value)||void 0===r||r.setDimensions(this.dimensions),null===(n=this._rectangleRenderer.value)||void 0===n||n.handleResize(),null===(i=this._glyphRenderer.value)||void 0===i||i.setDimensions(this.dimensions),null===(a=this._glyphRenderer.value)||void 0===a||a.handleResize(),this._refreshCharAtlas(),this._clearModel(!1)}},{key:"handleCharSizeChanged",value:function(){this.handleResize(this._terminal.cols,this._terminal.rows)}},{key:"handleBlur",value:function(){var e,t,r=u(this._renderLayers);try{for(r.s();!(t=r.n()).done;)t.value.handleBlur(this._terminal)}catch(n){r.e(n)}finally{r.f()}null===(e=this._cursorBlinkStateManager.value)||void 0===e||e.pause(),this._requestRedrawViewport()}},{key:"handleFocus",value:function(){var e,t,r=u(this._renderLayers);try{for(r.s();!(t=r.n()).done;)t.value.handleFocus(this._terminal)}catch(n){r.e(n)}finally{r.f()}null===(e=this._cursorBlinkStateManager.value)||void 0===e||e.resume(),this._requestRedrawViewport()}},{key:"handleSelectionChanged",value:function(e,t,r){var n,i=u(this._renderLayers);try{for(i.s();!(n=i.n()).done;)n.value.handleSelectionChanged(this._terminal,e,t,r)}catch(a){i.e(a)}finally{i.f()}this._model.selection.update(this._terminal,e,t,r),this._requestRedrawViewport()}},{key:"handleCursorMove",value:function(){var e,t,r=u(this._renderLayers);try{for(r.s();!(t=r.n()).done;)t.value.handleCursorMove(this._terminal)}catch(n){r.e(n)}finally{r.f()}null===(e=this._cursorBlinkStateManager.value)||void 0===e||e.restartBlinkAnimation()}},{key:"_handleOptionsChanged",value:function(){this._updateDimensions(),this._refreshCharAtlas(),this._updateCursorBlink()}},{key:"_initializeWebGLState",value:function(){return this._rectangleRenderer.value=new x.RectangleRenderer(this._terminal,this._gl,this.dimensions,this._themeService),this._glyphRenderer.value=new k.GlyphRenderer(this._terminal,this._gl,this.dimensions),this.handleCharSizeChanged(),[this._rectangleRenderer.value,this._glyphRenderer.value]}},{key:"_refreshCharAtlas",value:function(){var e;if(this.dimensions.device.char.width<=0&&this.dimensions.device.char.height<=0)this._isAttached=!1;else{var t=(0,s.acquireTextureAtlas)(this._terminal,this._optionsService.rawOptions,this._themeService.colors,this.dimensions.device.cell.width,this.dimensions.device.cell.height,this.dimensions.device.char.width,this.dimensions.device.char.height,this._coreBrowserService.dpr);this._charAtlas!==t&&(this._onChangeTextureAtlas.fire(t.pages[0].canvas),this._charAtlasDisposable.value=(0,y.getDisposeArrayDisposable)([(0,g.forwardEvent)(t.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas),(0,g.forwardEvent)(t.onRemoveTextureAtlasCanvas,this._onRemoveTextureAtlasCanvas)])),this._charAtlas=t,this._charAtlas.warmUp(),null===(e=this._glyphRenderer.value)||void 0===e||e.setAtlas(this._charAtlas)}}},{key:"_clearModel",value:function(e){var t;this._model.clear(),e&&(null===(t=this._glyphRenderer.value)||void 0===t||t.clear())}},{key:"clearTextureAtlas",value:function(){var e;null===(e=this._charAtlas)||void 0===e||e.clearTexture(),this._clearModel(!0),this._requestRedrawViewport()}},{key:"clear",value:function(){var e;this._clearModel(!0);var t,r=u(this._renderLayers);try{for(r.s();!(t=r.n()).done;)t.value.reset(this._terminal)}catch(n){r.e(n)}finally{r.f()}null===(e=this._cursorBlinkStateManager.value)||void 0===e||e.restartBlinkAnimation(),this._updateCursorBlink()}},{key:"registerCharacterJoiner",value:function(e){return-1}},{key:"deregisterCharacterJoiner",value:function(e){return!1}},{key:"renderRows",value:function(e,t){if(!this._isAttached){if(!(this._coreBrowserService.window.document.body.contains(this._core.screenElement)&&this._charSizeService.width&&this._charSizeService.height))return;this._updateDimensions(),this._refreshCharAtlas(),this._isAttached=!0}var r,n=u(this._renderLayers);try{for(n.s();!(r=n.n()).done;)r.value.handleGridChanged(this._terminal,e,t)}catch(i){n.e(i)}finally{n.f()}this._glyphRenderer.value&&this._rectangleRenderer.value&&(this._glyphRenderer.value.beginFrame()?(this._clearModel(!0),this._updateModel(0,this._terminal.rows-1)):this._updateModel(e,t),this._rectangleRenderer.value.renderBackgrounds(),this._glyphRenderer.value.render(this._model),this._cursorBlinkStateManager.value&&!this._cursorBlinkStateManager.value.isCursorVisible||this._rectangleRenderer.value.renderCursor())}},{key:"_updateCursorBlink",value:function(){var e=this;this._terminal.options.cursorBlink?this._cursorBlinkStateManager.value=new d.CursorBlinkStateManager((function(){e._requestRedrawCursor()}),this._coreBrowserService):this._cursorBlinkStateManager.clear(),this._requestRedrawCursor()}},{key:"_updateModel",value:function(e,t){var r,n,i,a,s,o,u,c,l,h,f,d,p,v=this._core,g=this._workCell;e=D(e,v.rows-1,0),t=D(t,v.rows-1,0);var y=this._terminal.buffer.active.baseY+this._terminal.buffer.active.cursorY,m=Math.min(this._terminal.buffer.active.cursorX,v.cols-1),b=-1,w=this._coreService.isCursorInitialized&&!this._coreService.isCursorHidden&&(!this._cursorBlinkStateManager.value||this._cursorBlinkStateManager.value.isCursorVisible);this._model.cursor=void 0;var k=!1;for(n=e;n<=t;n++)for(i=n+v.buffer.ydisp,a=v.buffer.lines.get(i),this._model.lineLengths[n]=0,s=this._characterJoinerService.getJoinedCharacters(i),d=0;d<v.cols;d++)if(r=this._cellColorResolver.result.bg,a.loadCell(d,g),0===d&&(r=this._cellColorResolver.result.bg),o=!1,u=d,s.length>0&&d===s[0][0]&&(o=!0,c=s.shift(),g=new A(g,a.translateToString(!0,c[0],c[1]),c[1]-c[0]),u=c[1]-1),l=g.getChars(),h=g.getCode(),f=(n*v.cols+d)*E.RENDER_MODEL_INDICIES_PER_CELL,this._cellColorResolver.resolve(g,d,i),w&&i===y&&(d===m&&(this._model.cursor={x:m,y:this._terminal.buffer.active.cursorY,width:g.getWidth(),style:this._coreBrowserService.isFocused?v.options.cursorStyle||"block":v.options.cursorInactiveStyle,cursorWidth:v.options.cursorWidth,dpr:this._devicePixelRatio},b=m+g.getWidth()-1),d>=m&&d<=b&&(this._coreBrowserService.isFocused&&"block"===(v.options.cursorStyle||"block")||!1===this._coreBrowserService.isFocused&&"block"===v.options.cursorInactiveStyle)&&(this._cellColorResolver.result.fg=50331648|this._themeService.colors.cursorAccent.rgba>>8&16777215,this._cellColorResolver.result.bg=50331648|this._themeService.colors.cursor.rgba>>8&16777215)),h!==_.NULL_CELL_CODE&&(this._model.lineLengths[n]=d+1),(this._model.cells[f]!==h||this._model.cells[f+E.RENDER_MODEL_BG_OFFSET]!==this._cellColorResolver.result.bg||this._model.cells[f+E.RENDER_MODEL_FG_OFFSET]!==this._cellColorResolver.result.fg||this._model.cells[f+E.RENDER_MODEL_EXT_OFFSET]!==this._cellColorResolver.result.ext)&&(k=!0,l.length>1&&(h|=E.COMBINED_CHAR_BIT_MASK),this._model.cells[f]=h,this._model.cells[f+E.RENDER_MODEL_BG_OFFSET]=this._cellColorResolver.result.bg,this._model.cells[f+E.RENDER_MODEL_FG_OFFSET]=this._cellColorResolver.result.fg,this._model.cells[f+E.RENDER_MODEL_EXT_OFFSET]=this._cellColorResolver.result.ext,this._glyphRenderer.value.updateCell(d,n,h,this._cellColorResolver.result.bg,this._cellColorResolver.result.fg,this._cellColorResolver.result.ext,l,r),o))for(g=this._workCell,d++;d<u;d++)p=(n*v.cols+d)*E.RENDER_MODEL_INDICIES_PER_CELL,this._glyphRenderer.value.updateCell(d,n,_.NULL_CELL_CODE,0,0,0,_.NULL_CELL_CHAR,0),this._model.cells[p]=_.NULL_CELL_CODE,this._model.cells[p+E.RENDER_MODEL_BG_OFFSET]=this._cellColorResolver.result.bg,this._model.cells[p+E.RENDER_MODEL_FG_OFFSET]=this._cellColorResolver.result.fg,this._model.cells[p+E.RENDER_MODEL_EXT_OFFSET]=this._cellColorResolver.result.ext;k&&this._rectangleRenderer.value.updateBackgrounds(this._model),this._rectangleRenderer.value.updateCursor(this._model)}},{key:"_updateDimensions",value:function(){this._charSizeService.width&&this._charSizeService.height&&(this.dimensions.device.char.width=Math.floor(this._charSizeService.width*this._devicePixelRatio),this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*this._devicePixelRatio),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.top=1===this._optionsService.rawOptions.lineHeight?0:Math.round((this.dimensions.device.cell.height-this.dimensions.device.char.height)/2),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.char.left=Math.floor(this._optionsService.rawOptions.letterSpacing/2),this.dimensions.device.canvas.height=this._terminal.rows*this.dimensions.device.cell.height,this.dimensions.device.canvas.width=this._terminal.cols*this.dimensions.device.cell.width,this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/this._devicePixelRatio),this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/this._devicePixelRatio),this.dimensions.css.cell.height=this.dimensions.device.cell.height/this._devicePixelRatio,this.dimensions.css.cell.width=this.dimensions.device.cell.width/this._devicePixelRatio)}},{key:"_setCanvasDevicePixelDimensions",value:function(e,t){this._canvas.width===e&&this._canvas.height===t||(this._canvas.width=e,this._canvas.height=t,this._requestRedrawViewport())}},{key:"_requestRedrawViewport",value:function(){this._onRequestRedraw.fire({start:0,end:this._terminal.rows-1})}},{key:"_requestRedrawCursor",value:function(){var e=this._terminal.buffer.active.cursorY;this._onRequestRedraw.fire({start:e,end:e})}}]),r}(y.Disposable);t.WebglRenderer=C,n([w.traceCall],C.prototype,"renderRows",null);var A=function(e){h(r,e);var t=f(r);function r(e,n,i){var a;return c(this,r),(a=t.call(this)).content=0,a.combinedData="",a.fg=e.fg,a.bg=e.bg,a.combinedData=n,a._width=i,a}return l(r,[{key:"isCombined",value:function(){return 2097152}},{key:"getWidth",value:function(){return this._width}},{key:"getChars",value:function(){return this.combinedData}},{key:"getCode",value:function(){return 2097151}},{key:"setFromCharData",value:function(e){throw new Error("not implemented")}},{key:"getAsCharData",value:function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}]),r}(m.AttributeData);function D(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.max(Math.min(e,t),r)}t.JoinedCellData=A},381:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.GLTexture=t.expandFloat32Array=t.createShader=t.createProgram=t.PROJECTION_MATRIX=void 0;var n=r(374);function i(e,t,r){var i=(0,n.throwIfFalsy)(e.createShader(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))return i;console.error(e.getShaderInfoLog(i)),e.deleteShader(i)}t.PROJECTION_MATRIX=new Float32Array([2,0,0,0,0,-2,0,0,0,0,1,0,-1,1,0,1]),t.createProgram=function(e,t,r){var a=(0,n.throwIfFalsy)(e.createProgram());if(e.attachShader(a,(0,n.throwIfFalsy)(i(e,e.VERTEX_SHADER,t))),e.attachShader(a,(0,n.throwIfFalsy)(i(e,e.FRAGMENT_SHADER,r))),e.linkProgram(a),e.getProgramParameter(a,e.LINK_STATUS))return a;console.error(e.getProgramInfoLog(a)),e.deleteProgram(a)},t.createShader=i,t.expandFloat32Array=function(e,t){for(var r=Math.min(2*e.length,t),n=new Float32Array(r),i=0;i<e.length;i++)n[i]=e[i];return n},t.GLTexture=function(){function e(t){c(this,e),this.texture=t,this.version=-1}return l(e)}()},592:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.BaseRenderLayer=void 0;var n=r(627),i=r(237),a=r(374),s=r(859),o=function(e){h(r,e);var t=f(r);function r(e,n,i,a,o,u,l,h){var f;return c(this,r),(f=t.call(this))._container=n,f._alpha=o,f._coreBrowserService=u,f._optionsService=l,f._themeService=h,f._deviceCharWidth=0,f._deviceCharHeight=0,f._deviceCellWidth=0,f._deviceCellHeight=0,f._deviceCharLeft=0,f._deviceCharTop=0,f._canvas=document.createElement("canvas"),f._canvas.classList.add("xterm-".concat(i,"-layer")),f._canvas.style.zIndex=a.toString(),f._initCanvas(),f._container.appendChild(f._canvas),f.register(f._themeService.onChangeColors((function(t){f._refreshCharAtlas(e,t),f.reset(e)}))),f.register((0,s.toDisposable)((function(){f._canvas.remove()}))),f}return l(r,[{key:"_initCanvas",value:function(){this._ctx=(0,a.throwIfFalsy)(this._canvas.getContext("2d",{alpha:this._alpha})),this._alpha||this._clearAll()}},{key:"handleBlur",value:function(e){}},{key:"handleFocus",value:function(e){}},{key:"handleCursorMove",value:function(e){}},{key:"handleGridChanged",value:function(e,t,r){}},{key:"handleSelectionChanged",value:function(e,t,r){}},{key:"_setTransparency",value:function(e,t){if(t!==this._alpha){var r=this._canvas;this._alpha=t,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,r),this._refreshCharAtlas(e,this._themeService.colors),this.handleGridChanged(e,0,e.rows-1)}}},{key:"_refreshCharAtlas",value:function(e,t){this._deviceCharWidth<=0&&this._deviceCharHeight<=0||(this._charAtlas=(0,n.acquireTextureAtlas)(e,this._optionsService.rawOptions,t,this._deviceCellWidth,this._deviceCellHeight,this._deviceCharWidth,this._deviceCharHeight,this._coreBrowserService.dpr),this._charAtlas.warmUp())}},{key:"resize",value:function(e,t){this._deviceCellWidth=t.device.cell.width,this._deviceCellHeight=t.device.cell.height,this._deviceCharWidth=t.device.char.width,this._deviceCharHeight=t.device.char.height,this._deviceCharLeft=t.device.char.left,this._deviceCharTop=t.device.char.top,this._canvas.width=t.device.canvas.width,this._canvas.height=t.device.canvas.height,this._canvas.style.width="".concat(t.css.canvas.width,"px"),this._canvas.style.height="".concat(t.css.canvas.height,"px"),this._alpha||this._clearAll(),this._refreshCharAtlas(e,this._themeService.colors)}},{key:"_fillBottomLineAtCells",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this._ctx.fillRect(e*this._deviceCellWidth,(t+1)*this._deviceCellHeight-this._coreBrowserService.dpr-1,r*this._deviceCellWidth,this._coreBrowserService.dpr)}},{key:"_clearAll",value:function(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))}},{key:"_clearCells",value:function(e,t,r,n){this._alpha?this._ctx.clearRect(e*this._deviceCellWidth,t*this._deviceCellHeight,r*this._deviceCellWidth,n*this._deviceCellHeight):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(e*this._deviceCellWidth,t*this._deviceCellHeight,r*this._deviceCellWidth,n*this._deviceCellHeight))}},{key:"_fillCharTrueColor",value:function(e,t,r,n){this._ctx.font=this._getFont(e,!1,!1),this._ctx.textBaseline=i.TEXT_BASELINE,this._clipCell(r,n,t.getWidth()),this._ctx.fillText(t.getChars(),r*this._deviceCellWidth+this._deviceCharLeft,n*this._deviceCellHeight+this._deviceCharTop+this._deviceCharHeight)}},{key:"_clipCell",value:function(e,t,r){this._ctx.beginPath(),this._ctx.rect(e*this._deviceCellWidth,t*this._deviceCellHeight,r*this._deviceCellWidth,this._deviceCellHeight),this._ctx.clip()}},{key:"_getFont",value:function(e,t,r){return"".concat(r?"italic":""," ").concat(t?e.options.fontWeightBold:e.options.fontWeight," ").concat(e.options.fontSize*this._coreBrowserService.dpr,"px ").concat(e.options.fontFamily)}}]),r}(s.Disposable);t.BaseRenderLayer=o},733:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.LinkRenderLayer=void 0;var n=r(197),i=r(237),o=function(e){h(r,e);var t=f(r);function r(e,n,i,a,s,o,u){var l;return c(this,r),(l=t.call(this,i,e,"link",n,!0,s,o,u)).register(a.onShowLinkUnderline((function(e){return l._handleShowLinkUnderline(e)}))),l.register(a.onHideLinkUnderline((function(e){return l._handleHideLinkUnderline(e)}))),l}return l(r,[{key:"resize",value:function(e,t){a(s(r.prototype),"resize",this).call(this,e,t),this._state=void 0}},{key:"reset",value:function(e){this._clearCurrentLink()}},{key:"_clearCurrentLink",value:function(){if(this._state){this._clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);var e=this._state.y2-this._state.y1-1;e>0&&this._clearCells(0,this._state.y1+1,this._state.cols,e),this._clearCells(0,this._state.y2,this._state.x2,1),this._state=void 0}}},{key:"_handleShowLinkUnderline",value:function(e){if(e.fg===i.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._themeService.colors.background.css:void 0!==e.fg&&(0,n.is256Color)(e.fg)?this._ctx.fillStyle=this._themeService.colors.ansi[e.fg].css:this._ctx.fillStyle=this._themeService.colors.foreground.css,e.y1===e.y2)this._fillBottomLineAtCells(e.x1,e.y1,e.x2-e.x1);else{this._fillBottomLineAtCells(e.x1,e.y1,e.cols-e.x1);for(var t=e.y1+1;t<e.y2;t++)this._fillBottomLineAtCells(0,t,e.cols);this._fillBottomLineAtCells(0,e.y2,e.x2)}this._state=e}},{key:"_handleHideLinkUnderline",value:function(e){this._clearCurrentLink()}}]),r}(r(592).BaseRenderLayer);t.LinkRenderLayer=o},820:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.addDisposableDomListener=void 0,t.addDisposableDomListener=function(e,t,r,n){e.addEventListener(t,r,n);var i=!1;return{dispose:function(){i||(i=!0,e.removeEventListener(t,r,n))}}}},274:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CellColorResolver=void 0;var r,n=0,i=0,a=!1,s=!1,o=!1;t.CellColorResolver=function(){function e(t,r,n,i,a){c(this,e),this._terminal=t,this._selectionRenderModel=r,this._decorationService=n,this._coreBrowserService=i,this._themeService=a,this.result={fg:0,bg:0,ext:0}}return l(e,[{key:"resolve",value:function(e,t,u){this.result.bg=e.bg,this.result.fg=e.fg,this.result.ext=268435456&e.bg?e.extended.ext:0,i=0,n=0,s=!1,a=!1,o=!1,r=this._themeService.colors,this._decorationService.forEachDecorationAtCell(t,u,"bottom",(function(e){e.backgroundColorRGB&&(i=e.backgroundColorRGB.rgba>>8&16777215,s=!0),e.foregroundColorRGB&&(n=e.foregroundColorRGB.rgba>>8&16777215,a=!0)})),(o=this._selectionRenderModel.isCellSelected(this._terminal,t,u))&&(i=(this._coreBrowserService.isFocused?r.selectionBackgroundOpaque:r.selectionInactiveBackgroundOpaque).rgba>>8&16777215,s=!0,r.selectionForeground&&(n=r.selectionForeground.rgba>>8&16777215,a=!0)),this._decorationService.forEachDecorationAtCell(t,u,"top",(function(e){e.backgroundColorRGB&&(i=e.backgroundColorRGB.rgba>>8&16777215,s=!0),e.foregroundColorRGB&&(n=e.foregroundColorRGB.rgba>>8&16777215,a=!0)})),s&&(i=o?-16777216&e.bg&-134217729|i|50331648:-16777216&e.bg|i|50331648),a&&(n=-16777216&e.fg&-67108865|n|50331648),67108864&this.result.fg&&(s&&!a&&(n=0==(50331648&this.result.bg)?-134217728&this.result.fg|16777215&r.background.rgba>>8|50331648:-134217728&this.result.fg|67108863&this.result.bg,a=!0),!s&&a&&(i=0==(50331648&this.result.fg)?-67108864&this.result.bg|16777215&r.foreground.rgba>>8|50331648:-67108864&this.result.bg|67108863&this.result.fg,s=!0)),r=void 0,this.result.bg=s?i:this.result.bg,this.result.fg=a?n:this.result.fg}}]),e}()},627:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.removeTerminalFromCache=t.acquireTextureAtlas=void 0;var n=r(509),i=r(197),a=[];t.acquireTextureAtlas=function(e,t,r,s,o,u,c,l){for(var h=(0,i.generateConfig)(s,o,u,c,t,r,l),f=0;f<a.length;f++){var d=a[f],p=d.ownedBy.indexOf(e);if(p>=0){if((0,i.configEquals)(d.config,h))return d.atlas;1===d.ownedBy.length?(d.atlas.dispose(),a.splice(f,1)):d.ownedBy.splice(p,1);break}}for(var v=0;v<a.length;v++){var g=a[v];if((0,i.configEquals)(g.config,h))return g.ownedBy.push(e),g.atlas}var y=e._core,m={atlas:new n.TextureAtlas(document,h,y.unicodeService),config:h,ownedBy:[e]};return a.push(m),m.atlas},t.removeTerminalFromCache=function(e){for(var t=0;t<a.length;t++){var r=a[t].ownedBy.indexOf(e);if(-1!==r){1===a[t].ownedBy.length?(a[t].atlas.dispose(),a.splice(t,1)):a[t].ownedBy.splice(r,1);break}}}},197:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.is256Color=t.configEquals=t.generateConfig=void 0;var n=r(160);t.generateConfig=function(e,t,r,i,a,s,o){var u={foreground:s.foreground,background:s.background,cursor:n.NULL_COLOR,cursorAccent:n.NULL_COLOR,selectionForeground:n.NULL_COLOR,selectionBackgroundTransparent:n.NULL_COLOR,selectionBackgroundOpaque:n.NULL_COLOR,selectionInactiveBackgroundTransparent:n.NULL_COLOR,selectionInactiveBackgroundOpaque:n.NULL_COLOR,ansi:s.ansi.slice(),contrastCache:s.contrastCache,halfContrastCache:s.halfContrastCache};return{customGlyphs:a.customGlyphs,devicePixelRatio:o,letterSpacing:a.letterSpacing,lineHeight:a.lineHeight,deviceCellWidth:e,deviceCellHeight:t,deviceCharWidth:r,deviceCharHeight:i,fontFamily:a.fontFamily,fontSize:a.fontSize,fontWeight:a.fontWeight,fontWeightBold:a.fontWeightBold,allowTransparency:a.allowTransparency,drawBoldTextInBrightColors:a.drawBoldTextInBrightColors,minimumContrastRatio:a.minimumContrastRatio,colors:u}},t.configEquals=function(e,t){for(var r=0;r<e.colors.ansi.length;r++)if(e.colors.ansi[r].rgba!==t.colors.ansi[r].rgba)return!1;return e.devicePixelRatio===t.devicePixelRatio&&e.customGlyphs===t.customGlyphs&&e.lineHeight===t.lineHeight&&e.letterSpacing===t.letterSpacing&&e.fontFamily===t.fontFamily&&e.fontSize===t.fontSize&&e.fontWeight===t.fontWeight&&e.fontWeightBold===t.fontWeightBold&&e.allowTransparency===t.allowTransparency&&e.deviceCharWidth===t.deviceCharWidth&&e.deviceCharHeight===t.deviceCharHeight&&e.drawBoldTextInBrightColors===t.drawBoldTextInBrightColors&&e.minimumContrastRatio===t.minimumContrastRatio&&e.colors.foreground.rgba===t.colors.foreground.rgba&&e.colors.background.rgba===t.colors.background.rgba},t.is256Color=function(e){return 16777216==(50331648&e)||33554432==(50331648&e)}},237:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.TEXT_BASELINE=t.DIM_OPACITY=t.INVERTED_DEFAULT_COLOR=void 0;var n=r(399);t.INVERTED_DEFAULT_COLOR=257,t.DIM_OPACITY=.5,t.TEXT_BASELINE=n.isFirefox||n.isLegacyEdge?"bottom":"ideographic"},457:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CursorBlinkStateManager=void 0,t.CursorBlinkStateManager=function(){function e(t,r){c(this,e),this._renderCallback=t,this._coreBrowserService=r,this.isCursorVisible=!0,this._coreBrowserService.isFocused&&this._restartInterval()}return l(e,[{key:"isPaused",get:function(){return!(this._blinkStartTimeout||this._blinkInterval)}},{key:"dispose",value:function(){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}},{key:"restartBlinkAnimation",value:function(){var e=this;this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame((function(){e._renderCallback(),e._animationFrame=void 0}))))}},{key:"_restartInterval",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:600;this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout=this._coreBrowserService.window.setTimeout((function(){if(e._animationTimeRestarted){var t=600-(Date.now()-e._animationTimeRestarted);if(e._animationTimeRestarted=void 0,t>0)return void e._restartInterval(t)}e.isCursorVisible=!1,e._animationFrame=e._coreBrowserService.window.requestAnimationFrame((function(){e._renderCallback(),e._animationFrame=void 0})),e._blinkInterval=e._coreBrowserService.window.setInterval((function(){if(e._animationTimeRestarted){var t=600-(Date.now()-e._animationTimeRestarted);return e._animationTimeRestarted=void 0,void e._restartInterval(t)}e.isCursorVisible=!e.isCursorVisible,e._animationFrame=e._coreBrowserService.window.requestAnimationFrame((function(){e._renderCallback(),e._animationFrame=void 0}))}),600)}),t)}},{key:"pause",value:function(){this.isCursorVisible=!0,this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}},{key:"resume",value:function(){this.pause(),this._animationTimeRestarted=void 0,this._restartInterval(),this.restartBlinkAnimation()}}]),e}()},860:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.tryDrawCustomChar=t.powerlineDefinitions=t.boxDrawingDefinitions=t.blockElementDefinitions=void 0;var n=r(374);t.blockElementDefinitions={"\u2580":[{x:0,y:0,w:8,h:4}],"\u2581":[{x:0,y:7,w:8,h:1}],"\u2582":[{x:0,y:6,w:8,h:2}],"\u2583":[{x:0,y:5,w:8,h:3}],"\u2584":[{x:0,y:4,w:8,h:4}],"\u2585":[{x:0,y:3,w:8,h:5}],"\u2586":[{x:0,y:2,w:8,h:6}],"\u2587":[{x:0,y:1,w:8,h:7}],"\u2588":[{x:0,y:0,w:8,h:8}],"\u2589":[{x:0,y:0,w:7,h:8}],"\u258a":[{x:0,y:0,w:6,h:8}],"\u258b":[{x:0,y:0,w:5,h:8}],"\u258c":[{x:0,y:0,w:4,h:8}],"\u258d":[{x:0,y:0,w:3,h:8}],"\u258e":[{x:0,y:0,w:2,h:8}],"\u258f":[{x:0,y:0,w:1,h:8}],"\u2590":[{x:4,y:0,w:4,h:8}],"\u2594":[{x:0,y:0,w:8,h:1}],"\u2595":[{x:7,y:0,w:1,h:8}],"\u2596":[{x:0,y:4,w:4,h:4}],"\u2597":[{x:4,y:4,w:4,h:4}],"\u2598":[{x:0,y:0,w:4,h:4}],"\u2599":[{x:0,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"\u259a":[{x:0,y:0,w:4,h:4},{x:4,y:4,w:4,h:4}],"\u259b":[{x:0,y:0,w:4,h:8},{x:4,y:0,w:4,h:4}],"\u259c":[{x:0,y:0,w:8,h:4},{x:4,y:0,w:4,h:8}],"\u259d":[{x:4,y:0,w:4,h:4}],"\u259e":[{x:4,y:0,w:4,h:4},{x:0,y:4,w:4,h:4}],"\u259f":[{x:4,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"\ud83e\udf70":[{x:1,y:0,w:1,h:8}],"\ud83e\udf71":[{x:2,y:0,w:1,h:8}],"\ud83e\udf72":[{x:3,y:0,w:1,h:8}],"\ud83e\udf73":[{x:4,y:0,w:1,h:8}],"\ud83e\udf74":[{x:5,y:0,w:1,h:8}],"\ud83e\udf75":[{x:6,y:0,w:1,h:8}],"\ud83e\udf76":[{x:0,y:1,w:8,h:1}],"\ud83e\udf77":[{x:0,y:2,w:8,h:1}],"\ud83e\udf78":[{x:0,y:3,w:8,h:1}],"\ud83e\udf79":[{x:0,y:4,w:8,h:1}],"\ud83e\udf7a":[{x:0,y:5,w:8,h:1}],"\ud83e\udf7b":[{x:0,y:6,w:8,h:1}],"\ud83e\udf7c":[{x:0,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"\ud83e\udf7d":[{x:0,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"\ud83e\udf7e":[{x:7,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"\ud83e\udf7f":[{x:7,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"\ud83e\udf80":[{x:0,y:0,w:8,h:1},{x:0,y:7,w:8,h:1}],"\ud83e\udf81":[{x:0,y:0,w:8,h:1},{x:0,y:2,w:8,h:1},{x:0,y:4,w:8,h:1},{x:0,y:7,w:8,h:1}],"\ud83e\udf82":[{x:0,y:0,w:8,h:2}],"\ud83e\udf83":[{x:0,y:0,w:8,h:3}],"\ud83e\udf84":[{x:0,y:0,w:8,h:5}],"\ud83e\udf85":[{x:0,y:0,w:8,h:6}],"\ud83e\udf86":[{x:0,y:0,w:8,h:7}],"\ud83e\udf87":[{x:6,y:0,w:2,h:8}],"\ud83e\udf88":[{x:5,y:0,w:3,h:8}],"\ud83e\udf89":[{x:3,y:0,w:5,h:8}],"\ud83e\udf8a":[{x:2,y:0,w:6,h:8}],"\ud83e\udf8b":[{x:1,y:0,w:7,h:8}],"\ud83e\udf95":[{x:0,y:0,w:2,h:2},{x:4,y:0,w:2,h:2},{x:2,y:2,w:2,h:2},{x:6,y:2,w:2,h:2},{x:0,y:4,w:2,h:2},{x:4,y:4,w:2,h:2},{x:2,y:6,w:2,h:2},{x:6,y:6,w:2,h:2}],"\ud83e\udf96":[{x:2,y:0,w:2,h:2},{x:6,y:0,w:2,h:2},{x:0,y:2,w:2,h:2},{x:4,y:2,w:2,h:2},{x:2,y:4,w:2,h:2},{x:6,y:4,w:2,h:2},{x:0,y:6,w:2,h:2},{x:4,y:6,w:2,h:2}],"\ud83e\udf97":[{x:0,y:2,w:8,h:2},{x:0,y:6,w:8,h:2}]};var i={"\u2591":[[1,0,0,0],[0,0,0,0],[0,0,1,0],[0,0,0,0]],"\u2592":[[1,0],[0,0],[0,1],[0,0]],"\u2593":[[0,1],[1,1],[1,0],[1,1]]};t.boxDrawingDefinitions={"\u2500":{1:"M0,.5 L1,.5"},"\u2501":{3:"M0,.5 L1,.5"},"\u2502":{1:"M.5,0 L.5,1"},"\u2503":{3:"M.5,0 L.5,1"},"\u250c":{1:"M0.5,1 L.5,.5 L1,.5"},"\u250f":{3:"M0.5,1 L.5,.5 L1,.5"},"\u2510":{1:"M0,.5 L.5,.5 L.5,1"},"\u2513":{3:"M0,.5 L.5,.5 L.5,1"},"\u2514":{1:"M.5,0 L.5,.5 L1,.5"},"\u2517":{3:"M.5,0 L.5,.5 L1,.5"},"\u2518":{1:"M.5,0 L.5,.5 L0,.5"},"\u251b":{3:"M.5,0 L.5,.5 L0,.5"},"\u251c":{1:"M.5,0 L.5,1 M.5,.5 L1,.5"},"\u2523":{3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"\u2524":{1:"M.5,0 L.5,1 M.5,.5 L0,.5"},"\u252b":{3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"\u252c":{1:"M0,.5 L1,.5 M.5,.5 L.5,1"},"\u2533":{3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"\u2534":{1:"M0,.5 L1,.5 M.5,.5 L.5,0"},"\u253b":{3:"M0,.5 L1,.5 M.5,.5 L.5,0"},"\u253c":{1:"M0,.5 L1,.5 M.5,0 L.5,1"},"\u254b":{3:"M0,.5 L1,.5 M.5,0 L.5,1"},"\u2574":{1:"M.5,.5 L0,.5"},"\u2578":{3:"M.5,.5 L0,.5"},"\u2575":{1:"M.5,.5 L.5,0"},"\u2579":{3:"M.5,.5 L.5,0"},"\u2576":{1:"M.5,.5 L1,.5"},"\u257a":{3:"M.5,.5 L1,.5"},"\u2577":{1:"M.5,.5 L.5,1"},"\u257b":{3:"M.5,.5 L.5,1"},"\u2550":{1:function(e,t){return"M0,".concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L1,").concat(.5+t)}},"\u2551":{1:function(e,t){return"M".concat(.5-e,",0 L").concat(.5-e,",1 M").concat(.5+e,",0 L").concat(.5+e,",1")}},"\u2552":{1:function(e,t){return"M.5,1 L.5,".concat(.5-t," L1,").concat(.5-t," M.5,").concat(.5+t," L1,").concat(.5+t)}},"\u2553":{1:function(e,t){return"M".concat(.5-e,",1 L").concat(.5-e,",.5 L1,.5 M").concat(.5+e,",.5 L").concat(.5+e,",1")}},"\u2554":{1:function(e,t){return"M1,".concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",1 M1,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",1")}},"\u2555":{1:function(e,t){return"M0,".concat(.5-t," L.5,").concat(.5-t," L.5,1 M0,").concat(.5+t," L.5,").concat(.5+t)}},"\u2556":{1:function(e,t){return"M".concat(.5+e,",1 L").concat(.5+e,",.5 L0,.5 M").concat(.5-e,",.5 L").concat(.5-e,",1")}},"\u2557":{1:function(e,t){return"M0,".concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",1 M0,").concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",1")}},"\u2558":{1:function(e,t){return"M.5,0 L.5,".concat(.5+t," L1,").concat(.5+t," M.5,").concat(.5-t," L1,").concat(.5-t)}},"\u2559":{1:function(e,t){return"M1,.5 L".concat(.5-e,",.5 L").concat(.5-e,",0 M").concat(.5+e,",.5 L").concat(.5+e,",0")}},"\u255a":{1:function(e,t){return"M1,".concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",0 M1,").concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",0")}},"\u255b":{1:function(e,t){return"M0,".concat(.5+t," L.5,").concat(.5+t," L.5,0 M0,").concat(.5-t," L.5,").concat(.5-t)}},"\u255c":{1:function(e,t){return"M0,.5 L".concat(.5+e,",.5 L").concat(.5+e,",0 M").concat(.5-e,",.5 L").concat(.5-e,",0")}},"\u255d":{1:function(e,t){return"M0,".concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",0 M0,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",0")}},"\u255e":{1:function(e,t){return"M.5,0 L.5,1 M.5,".concat(.5-t," L1,").concat(.5-t," M.5,").concat(.5+t," L1,").concat(.5+t)}},"\u255f":{1:function(e,t){return"M".concat(.5-e,",0 L").concat(.5-e,",1 M").concat(.5+e,",0 L").concat(.5+e,",1 M").concat(.5+e,",.5 L1,.5")}},"\u2560":{1:function(e,t){return"M".concat(.5-e,",0 L").concat(.5-e,",1 M1,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",1 M1,").concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",0")}},"\u2561":{1:function(e,t){return"M.5,0 L.5,1 M0,".concat(.5-t," L.5,").concat(.5-t," M0,").concat(.5+t," L.5,").concat(.5+t)}},"\u2562":{1:function(e,t){return"M0,.5 L".concat(.5-e,",.5 M").concat(.5-e,",0 L").concat(.5-e,",1 M").concat(.5+e,",0 L").concat(.5+e,",1")}},"\u2563":{1:function(e,t){return"M".concat(.5+e,",0 L").concat(.5+e,",1 M0,").concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",1 M0,").concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",0")}},"\u2564":{1:function(e,t){return"M0,".concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L1,").concat(.5+t," M.5,").concat(.5+t," L.5,1")}},"\u2565":{1:function(e,t){return"M0,.5 L1,.5 M".concat(.5-e,",.5 L").concat(.5-e,",1 M").concat(.5+e,",.5 L").concat(.5+e,",1")}},"\u2566":{1:function(e,t){return"M0,".concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",1 M1,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",1")}},"\u2567":{1:function(e,t){return"M.5,0 L.5,".concat(.5-t," M0,").concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L1,").concat(.5+t)}},"\u2568":{1:function(e,t){return"M0,.5 L1,.5 M".concat(.5-e,",.5 L").concat(.5-e,",0 M").concat(.5+e,",.5 L").concat(.5+e,",0")}},"\u2569":{1:function(e,t){return"M0,".concat(.5+t," L1,").concat(.5+t," M0,").concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",0 M1,").concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",0")}},"\u256a":{1:function(e,t){return"M.5,0 L.5,1 M0,".concat(.5-t," L1,").concat(.5-t," M0,").concat(.5+t," L1,").concat(.5+t)}},"\u256b":{1:function(e,t){return"M0,.5 L1,.5 M".concat(.5-e,",0 L").concat(.5-e,",1 M").concat(.5+e,",0 L").concat(.5+e,",1")}},"\u256c":{1:function(e,t){return"M0,".concat(.5+t," L").concat(.5-e,",").concat(.5+t," L").concat(.5-e,",1 M1,").concat(.5+t," L").concat(.5+e,",").concat(.5+t," L").concat(.5+e,",1 M0,").concat(.5-t," L").concat(.5-e,",").concat(.5-t," L").concat(.5-e,",0 M1,").concat(.5-t," L").concat(.5+e,",").concat(.5-t," L").concat(.5+e,",0")}},"\u2571":{1:"M1,0 L0,1"},"\u2572":{1:"M0,0 L1,1"},"\u2573":{1:"M1,0 L0,1 M0,0 L1,1"},"\u257c":{1:"M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"\u257d":{1:"M.5,.5 L.5,0",3:"M.5,.5 L.5,1"},"\u257e":{1:"M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"\u257f":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"\u250d":{1:"M.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"\u250e":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"\u2511":{1:"M.5,.5 L.5,1",3:"M.5,.5 L0,.5"},"\u2512":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"\u2515":{1:"M.5,.5 L.5,0",3:"M.5,.5 L1,.5"},"\u2516":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"\u2519":{1:"M.5,.5 L.5,0",3:"M.5,.5 L0,.5"},"\u251a":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,0"},"\u251d":{1:"M.5,0 L.5,1",3:"M.5,.5 L1,.5"},"\u251e":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"\u251f":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"\u2520":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1"},"\u2521":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"\u2522":{1:"M.5,.5 L.5,0",3:"M0.5,1 L.5,.5 L1,.5"},"\u2525":{1:"M.5,0 L.5,1",3:"M.5,.5 L0,.5"},"\u2526":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"\u2527":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"\u2528":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1"},"\u2529":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L0,.5"},"\u252a":{1:"M.5,.5 L.5,0",3:"M0,.5 L.5,.5 L.5,1"},"\u252d":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"\u252e":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"\u252f":{1:"M.5,.5 L.5,1",3:"M0,.5 L1,.5"},"\u2530":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"\u2531":{1:"M.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"\u2532":{1:"M.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"\u2535":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"\u2536":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"\u2537":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5"},"\u2538":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,0"},"\u2539":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"\u253a":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,.5 L1,.5"},"\u253d":{1:"M.5,0 L.5,1 M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"\u253e":{1:"M.5,0 L.5,1 M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"\u253f":{1:"M.5,0 L.5,1",3:"M0,.5 L1,.5"},"\u2540":{1:"M0,.5 L1,.5 M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"\u2541":{1:"M.5,.5 L.5,0 M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"\u2542":{1:"M0,.5 L1,.5",3:"M.5,0 L.5,1"},"\u2543":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"\u2544":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"\u2545":{1:"M.5,0 L.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"\u2546":{1:"M.5,0 L.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"\u2547":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0 M0,.5 L1,.5"},"\u2548":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"\u2549":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"\u254a":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"\u254c":{1:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"\u254d":{3:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"\u2504":{1:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"\u2505":{3:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"\u2508":{1:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"\u2509":{3:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"\u254e":{1:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"\u254f":{3:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"\u2506":{1:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"\u2507":{3:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"\u250a":{1:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"\u250b":{3:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"\u256d":{1:function(e,t){return"M.5,1 L.5,".concat(.5+t/.15*.5," C.5,").concat(.5+t/.15*.5,",.5,.5,1,.5")}},"\u256e":{1:function(e,t){return"M.5,1 L.5,".concat(.5+t/.15*.5," C.5,").concat(.5+t/.15*.5,",.5,.5,0,.5")}},"\u256f":{1:function(e,t){return"M.5,0 L.5,".concat(.5-t/.15*.5," C.5,").concat(.5-t/.15*.5,",.5,.5,0,.5")}},"\u2570":{1:function(e,t){return"M.5,0 L.5,".concat(.5-t/.15*.5," C.5,").concat(.5-t/.15*.5,",.5,.5,1,.5")}}},t.powerlineDefinitions={"\ue0b0":{d:"M0,0 L1,.5 L0,1",type:0,rightPadding:2},"\ue0b1":{d:"M-1,-.5 L1,.5 L-1,1.5",type:1,leftPadding:1,rightPadding:1},"\ue0b2":{d:"M1,0 L0,.5 L1,1",type:0,leftPadding:2},"\ue0b3":{d:"M2,-.5 L0,.5 L2,1.5",type:1,leftPadding:1,rightPadding:1},"\ue0b4":{d:"M0,0 L0,1 C0.552,1,1,0.776,1,.5 C1,0.224,0.552,0,0,0",type:0,rightPadding:1},"\ue0b5":{d:"M.2,1 C.422,1,.8,.826,.78,.5 C.8,.174,0.422,0,.2,0",type:1,rightPadding:1},"\ue0b6":{d:"M1,0 L1,1 C0.448,1,0,0.776,0,.5 C0,0.224,0.448,0,1,0",type:0,leftPadding:1},"\ue0b7":{d:"M.8,1 C0.578,1,0.2,.826,.22,.5 C0.2,0.174,0.578,0,0.8,0",type:1,leftPadding:1},"\ue0b8":{d:"M-.5,-.5 L1.5,1.5 L-.5,1.5",type:0},"\ue0b9":{d:"M-.5,-.5 L1.5,1.5",type:1,leftPadding:1,rightPadding:1},"\ue0ba":{d:"M1.5,-.5 L-.5,1.5 L1.5,1.5",type:0},"\ue0bc":{d:"M1.5,-.5 L-.5,1.5 L-.5,-.5",type:0},"\ue0bd":{d:"M1.5,-.5 L-.5,1.5",type:1,leftPadding:1,rightPadding:1},"\ue0be":{d:"M-.5,-.5 L1.5,1.5 L1.5,-.5",type:0}},t.powerlineDefinitions["\ue0bb"]=t.powerlineDefinitions["\ue0bd"],t.powerlineDefinitions["\ue0bf"]=t.powerlineDefinitions["\ue0b9"],t.tryDrawCustomChar=function(e,r,s,h,f,d,p,v){var g=t.blockElementDefinitions[r];if(g)return function(e,t,r,n,i,a){for(var s=0;s<t.length;s++){var o=t[s],u=i/8,c=a/8;e.fillRect(r+o.x*u,n+o.y*c,o.w*u,o.h*c)}}(e,g,s,h,f,d),!0;var y=i[r];if(y)return function(e,t,r,i,s,u){var c=a.get(t);c||(c=new Map,a.set(t,c));var l=e.fillStyle;if("string"!=typeof l)throw new Error('Unexpected fillStyle type "'.concat(l,'"'));var h=c.get(l);if(!h){var f=t[0].length,d=t.length,p=document.createElement("canvas");p.width=f,p.height=d;var v,g,y,m,b=(0,n.throwIfFalsy)(p.getContext("2d")),_=new ImageData(f,d);if(l.startsWith("#"))v=parseInt(l.slice(1,3),16),g=parseInt(l.slice(3,5),16),y=parseInt(l.slice(5,7),16),m=l.length>7&&parseInt(l.slice(7,9),16)||1;else{if(!l.startsWith("rgba"))throw new Error('Unexpected fillStyle color format "'.concat(l,'" when drawing pattern glyph'));var w=l.substring(5,l.length-1).split(",").map((function(e){return parseFloat(e)})),k=o(w,4);v=k[0],g=k[1],y=k[2],m=k[3]}for(var x=0;x<d;x++)for(var E=0;E<f;E++)_.data[4*(x*f+E)]=v,_.data[4*(x*f+E)+1]=g,_.data[4*(x*f+E)+2]=y,_.data[4*(x*f+E)+3]=t[x][E]*(255*m);b.putImageData(_,0,0),h=(0,n.throwIfFalsy)(e.createPattern(p,null)),c.set(l,h)}e.fillStyle=h,e.fillRect(r,i,s,u)}(e,y,s,h,f,d),!0;var m=t.boxDrawingDefinitions[r];if(m)return function(e,t,r,n,i,a,s){e.strokeStyle=e.fillStyle;for(var h=0,f=Object.entries(t);h<f.length;h++){var d=o(f[h],2),p=d[0],v=d[1],g=void 0;e.beginPath(),e.lineWidth=s*Number.parseInt(p),g="function"==typeof v?v(.15,.15/a*i):v;var y,m=u(g.split(" "));try{for(m.s();!(y=m.n()).done;){var b=y.value,_=b[0],w=c[_];if(w){var k=b.substring(1).split(",");k[0]&&k[1]&&w(e,l(k,i,a,r,n,!0,s))}else console.error('Could not find drawing instructions for "'.concat(_,'"'))}}catch(x){m.e(x)}finally{m.f()}e.stroke(),e.closePath()}}(e,m,s,h,f,d,v),!0;var b=t.powerlineDefinitions[r];return!!b&&(function(e,t,r,n,i,a,s,o){var h,f,d=new Path2D;d.rect(r,n,i,a),e.clip(d),e.beginPath();var p=s/12;e.lineWidth=o*p;var v,g=u(t.d.split(" "));try{for(g.s();!(v=g.n()).done;){var y=v.value,m=y[0],b=c[m];if(b){var _=y.substring(1).split(",");_[0]&&_[1]&&b(e,l(_,i,a,r,n,!1,o,(null!==(h=t.leftPadding)&&void 0!==h?h:0)*(p/2),(null!==(f=t.rightPadding)&&void 0!==f?f:0)*(p/2)))}else console.error('Could not find drawing instructions for "'.concat(m,'"'))}}catch(w){g.e(w)}finally{g.f()}1===t.type?(e.strokeStyle=e.fillStyle,e.stroke()):e.fill(),e.closePath()}(e,b,s,h,f,d,p,v),!0)};var a=new Map;function s(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.max(Math.min(e,t),r)}var c={C:function(e,t){return e.bezierCurveTo(t[0],t[1],t[2],t[3],t[4],t[5])},L:function(e,t){return e.lineTo(t[0],t[1])},M:function(e,t){return e.moveTo(t[0],t[1])}};function l(e,t,r,n,i,a,o){var u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,l=e.map((function(e){return parseFloat(e)||parseInt(e)}));if(l.length<2)throw new Error("Too few arguments for instruction");for(var h=0;h<l.length;h+=2)l[h]*=t-u*o-c*o,a&&0!==l[h]&&(l[h]=s(Math.round(l[h]+.5)-.5,t,0)),l[h]+=n+u*o;for(var f=1;f<l.length;f+=2)l[f]*=r,a&&0!==l[f]&&(l[f]=s(Math.round(l[f]+.5)-.5,r,0)),l[f]+=i;return l}},56:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.observeDevicePixelDimensions=void 0;var n=r(859);t.observeDevicePixelDimensions=function(e,t,r){var i=new t.ResizeObserver((function(t){var n=t.find((function(t){return t.target===e}));if(n){if(!("devicePixelContentBoxSize"in n))return null==i||i.disconnect(),void(i=void 0);var a=n.devicePixelContentBoxSize[0].inlineSize,s=n.devicePixelContentBoxSize[0].blockSize;a>0&&s>0&&r(a,s)}}));try{i.observe(e,{box:["device-pixel-content-box"]})}catch(e){i.disconnect(),i=void 0}return(0,n.toDisposable)((function(){return null==i?void 0:i.disconnect()}))}},374:function(e,t){function r(e){return 57508<=e&&e<=57558}Object.defineProperty(t,"__esModule",{value:!0}),t.createRenderDimensions=t.excludeFromContrastRatioDemands=t.isRestrictedPowerlineGlyph=t.isPowerlineGlyph=t.throwIfFalsy=void 0,t.throwIfFalsy=function(e){if(!e)throw new Error("value must not be falsy");return e},t.isPowerlineGlyph=r,t.isRestrictedPowerlineGlyph=function(e){return 57520<=e&&e<=57527},t.excludeFromContrastRatioDemands=function(e){return r(e)||function(e){return 9472<=e&&e<=9631}(e)},t.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},296:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createSelectionRenderModel=void 0;var r=function(){function e(){c(this,e),this.clear()}return l(e,[{key:"clear",value:function(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}},{key:"update",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.selectionStart=t,this.selectionEnd=r,t&&r&&(t[0]!==r[0]||t[1]!==r[1])){var i=t[1]-e.buffer.active.viewportY,a=r[1]-e.buffer.active.viewportY,s=Math.max(i,0),o=Math.min(a,e.rows-1);s>=e.rows||o<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=n,this.viewportStartRow=i,this.viewportEndRow=a,this.viewportCappedStartRow=s,this.viewportCappedEndRow=o,this.startCol=t[0],this.endCol=r[0])}else this.clear()}},{key:"isCellSelected",value:function(e,t,r){return!!this.hasSelection&&(r-=e.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?t>=this.startCol&&r>=this.viewportCappedStartRow&&t<this.endCol&&r<=this.viewportCappedEndRow:t<this.startCol&&r>=this.viewportCappedStartRow&&t>=this.endCol&&r<=this.viewportCappedEndRow:r>this.viewportStartRow&&r<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&r===this.viewportStartRow&&t>=this.startCol&&t<this.endCol||this.viewportStartRow<this.viewportEndRow&&r===this.viewportEndRow&&t<this.endCol||this.viewportStartRow<this.viewportEndRow&&r===this.viewportStartRow&&t>=this.startCol)}}]),e}();t.createSelectionRenderModel=function(){return new r}},509:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.TextureAtlas=void 0;var a,s=r(237),h=r(860),f=r(374),d=r(160),p=r(345),v=r(485),g=r(385),y=r(147),m=r(855),b=r(776),_={texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},offset:{x:0,y:0},size:{x:0,y:0},sizeClipSpace:{x:0,y:0}},w=function(){function e(t,r,n){c(this,e),this._document=t,this._config=r,this._unicodeService=n,this._didWarmUp=!1,this._cacheMap=new v.FourKeyMap,this._cacheMapCombined=new v.FourKeyMap,this._pages=[],this._activePages=[],this._workBoundingBox={top:0,left:0,bottom:0,right:0},this._workAttributeData=new y.AttributeData,this._textureSize=512,this._onAddTextureAtlasCanvas=new p.EventEmitter,this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=new p.EventEmitter,this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._requestClearModel=!1,this._createNewPage(),this._tmpCanvas=E(t,4*this._config.deviceCellWidth+4,this._config.deviceCellHeight+4),this._tmpCtx=(0,f.throwIfFalsy)(this._tmpCanvas.getContext("2d",{alpha:this._config.allowTransparency,willReadFrequently:!0}))}return l(e,[{key:"pages",get:function(){return this._pages}},{key:"dispose",value:function(){var e,t=u(this.pages);try{for(t.s();!(e=t.n()).done;)e.value.canvas.remove()}catch(r){t.e(r)}finally{t.f()}this._onAddTextureAtlasCanvas.dispose()}},{key:"warmUp",value:function(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)}},{key:"_doWarmUp",value:function(){for(var e=this,t=new g.IdleTaskQueue,r=function(r){t.enqueue((function(){if(!e._cacheMap.get(r,m.DEFAULT_COLOR,m.DEFAULT_COLOR,m.DEFAULT_EXT)){var t=e._drawToCache(r,m.DEFAULT_COLOR,m.DEFAULT_COLOR,m.DEFAULT_EXT);e._cacheMap.set(r,m.DEFAULT_COLOR,m.DEFAULT_COLOR,m.DEFAULT_EXT,t)}}))},n=33;n<126;n++)r(n)}},{key:"beginFrame",value:function(){return this._requestClearModel}},{key:"clearTexture",value:function(){if(0!==this._pages[0].currentRow.x||0!==this._pages[0].currentRow.y){var e,t=u(this._pages);try{for(t.s();!(e=t.n()).done;)e.value.clear()}catch(r){t.e(r)}finally{t.f()}this._cacheMap.clear(),this._cacheMapCombined.clear(),this._didWarmUp=!1}}},{key:"_createNewPage",value:function(){if(e.maxAtlasPages&&this._pages.length>=Math.max(4,e.maxAtlasPages)){for(var t=this._pages.filter((function(t){return 2*t.canvas.width<=(e.maxTextureSize||4096)})).sort((function(e,t){return t.canvas.width!==e.canvas.width?t.canvas.width-e.canvas.width:t.percentageUsed-e.percentageUsed})),r=-1,n=0,i=0;i<t.length;i++)if(t[i].canvas.width!==n)r=i,n=t[i].canvas.width;else if(i-r==3)break;var a=t.slice(r,r+4),s=a.map((function(e){return e.glyphs[0].texturePage})).sort((function(e,t){return e>t?1:-1})),o=this.pages.length-a.length,u=this._mergePages(a,o);u.version++;for(var c=s.length-1;c>=0;c--)this._deletePage(s[c]);this.pages.push(u),this._requestClearModel=!0,this._onAddTextureAtlasCanvas.fire(u.canvas)}var l=new k(this._document,this._textureSize);return this._pages.push(l),this._activePages.push(l),this._onAddTextureAtlasCanvas.fire(l.canvas),l}},{key:"_mergePages",value:function(e,t){var r,n=2*e[0].canvas.width,i=new k(this._document,n,e),a=u(e.entries());try{for(a.s();!(r=a.n()).done;){var s=o(r.value,2),c=s[0],l=s[1],h=c*l.canvas.width%n,f=Math.floor(c/2)*l.canvas.height;i.ctx.drawImage(l.canvas,h,f);var d,p=u(l.glyphs);try{for(p.s();!(d=p.n()).done;){var v=d.value;v.texturePage=t,v.sizeClipSpace.x=v.size.x/n,v.sizeClipSpace.y=v.size.y/n,v.texturePosition.x+=h,v.texturePosition.y+=f,v.texturePositionClipSpace.x=v.texturePosition.x/n,v.texturePositionClipSpace.y=v.texturePosition.y/n}}catch(y){p.e(y)}finally{p.f()}this._onRemoveTextureAtlasCanvas.fire(l.canvas);var g=this._activePages.indexOf(l);-1!==g&&this._activePages.splice(g,1)}}catch(y){a.e(y)}finally{a.f()}return i}},{key:"_deletePage",value:function(e){this._pages.splice(e,1);for(var t=e;t<this._pages.length;t++){var r,n=this._pages[t],i=u(n.glyphs);try{for(i.s();!(r=i.n()).done;)r.value.texturePage--}catch(a){i.e(a)}finally{i.f()}n.version++}}},{key:"getRasterizedGlyphCombinedChar",value:function(e,t,r,n,i){return this._getFromCacheMap(this._cacheMapCombined,e,t,r,n,i)}},{key:"getRasterizedGlyph",value:function(e,t,r,n,i){return this._getFromCacheMap(this._cacheMap,e,t,r,n,i)}},{key:"_getFromCacheMap",value:function(e,t,r,n,i){var s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return(a=e.get(t,r,n,i))||(a=this._drawToCache(t,r,n,i,s),e.set(t,r,n,i,a)),a}},{key:"_getColorFromAnsiIndex",value:function(e){if(e>=this._config.colors.ansi.length)throw new Error("No color found for idx "+e);return this._config.colors.ansi[e]}},{key:"_getBackgroundColor",value:function(e,t,r,n){if(this._config.allowTransparency)return d.NULL_COLOR;var i;switch(e){case 16777216:case 33554432:i=this._getColorFromAnsiIndex(t);break;case 50331648:var a=y.AttributeData.toColorRGB(t);i=d.rgba.toColor(a[0],a[1],a[2]);break;default:i=r?d.color.opaque(this._config.colors.foreground):this._config.colors.background}return i}},{key:"_getForegroundColor",value:function(e,t,r,n,i,a,o,u,c,l){var h,f=this._getMinimumContrastColor(e,t,r,n,i,a,!1,c,u,l);if(f)return f;switch(i){case 16777216:case 33554432:this._config.drawBoldTextInBrightColors&&c&&a<8&&(a+=8),h=this._getColorFromAnsiIndex(a);break;case 50331648:var p=y.AttributeData.toColorRGB(a);h=d.rgba.toColor(p[0],p[1],p[2]);break;default:h=o?this._config.colors.background:this._config.colors.foreground}return this._config.allowTransparency&&(h=d.color.opaque(h)),u&&(h=d.color.multiplyOpacity(h,s.DIM_OPACITY)),h}},{key:"_resolveBackgroundRgba",value:function(e,t,r){switch(e){case 16777216:case 33554432:return this._getColorFromAnsiIndex(t).rgba;case 50331648:return t<<8;default:return r?this._config.colors.foreground.rgba:this._config.colors.background.rgba}}},{key:"_resolveForegroundRgba",value:function(e,t,r,n){switch(e){case 16777216:case 33554432:return this._config.drawBoldTextInBrightColors&&n&&t<8&&(t+=8),this._getColorFromAnsiIndex(t).rgba;case 50331648:return t<<8;default:return r?this._config.colors.background.rgba:this._config.colors.foreground.rgba}}},{key:"_getMinimumContrastColor",value:function(e,t,r,n,i,a,s,o,u,c){if(1!==this._config.minimumContrastRatio&&!c){var l=this._getContrastCache(u),h=l.getColor(e,n);if(void 0!==h)return h||void 0;var f=this._resolveBackgroundRgba(t,r,s),p=this._resolveForegroundRgba(i,a,s,o),v=d.rgba.ensureContrastRatio(f,p,this._config.minimumContrastRatio/(u?2:1));if(v){var g=d.rgba.toColor(v>>24&255,v>>16&255,v>>8&255);return l.setColor(e,n,g),g}l.setColor(e,n,null)}}},{key:"_getContrastCache",value:function(e){return e?this._config.colors.halfContrastCache:this._config.colors.contrastCache}},{key:"_drawToCache",value:function(t,r,n,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o="number"==typeof t?String.fromCharCode(t):t,c=Math.min(this._config.deviceCellWidth*Math.max(o.length,2)+4,this._textureSize);this._tmpCanvas.width<c&&(this._tmpCanvas.width=c);var l=Math.min(this._config.deviceCellHeight+8,this._textureSize);if(this._tmpCanvas.height<l&&(this._tmpCanvas.height=l),this._tmpCtx.save(),this._workAttributeData.fg=n,this._workAttributeData.bg=r,this._workAttributeData.extended.ext=i,this._workAttributeData.isInvisible())return _;var d=!!this._workAttributeData.isBold(),p=!!this._workAttributeData.isInverse(),v=!!this._workAttributeData.isDim(),g=!!this._workAttributeData.isItalic(),m=!!this._workAttributeData.isUnderline(),b=!!this._workAttributeData.isStrikethrough(),w=!!this._workAttributeData.isOverline(),k=this._workAttributeData.getFgColor(),E=this._workAttributeData.getFgColorMode(),S=this._workAttributeData.getBgColor(),C=this._workAttributeData.getBgColorMode();if(p){var A=k;k=S,S=A;var D=E;E=C,C=D}var R=this._getBackgroundColor(C,S,p,v);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=R.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.globalCompositeOperation="source-over";var T=d?this._config.fontWeightBold:this._config.fontWeight,Z=g?"italic":"";this._tmpCtx.font="".concat(Z," ").concat(T," ").concat(this._config.fontSize*this._config.devicePixelRatio,"px ").concat(this._config.fontFamily),this._tmpCtx.textBaseline=s.TEXT_BASELINE;var I=1===o.length&&(0,f.isPowerlineGlyph)(o.charCodeAt(0)),P=1===o.length&&(0,f.isRestrictedPowerlineGlyph)(o.charCodeAt(0)),L=this._getForegroundColor(r,C,S,n,E,k,p,v,d,(0,f.excludeFromContrastRatioDemands)(o.charCodeAt(0)));this._tmpCtx.fillStyle=L.css;var M=P?0:4,B=!1;!1!==this._config.customGlyphs&&(B=(0,h.tryDrawCustomChar)(this._tmpCtx,o,M,M,this._config.deviceCellWidth,this._config.deviceCellHeight,this._config.fontSize,this._config.devicePixelRatio));var O,N=!I;if(O="number"==typeof t?this._unicodeService.wcwidth(t):this._unicodeService.getStringCellWidth(t),m){this._tmpCtx.save();var F=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),U=F%2==1?.5:0;if(this._tmpCtx.lineWidth=F,this._workAttributeData.isUnderlineColorDefault())this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle;else if(this._workAttributeData.isUnderlineColorRGB())N=!1,this._tmpCtx.strokeStyle="rgb(".concat(y.AttributeData.toColorRGB(this._workAttributeData.getUnderlineColor()).join(","),")");else{N=!1;var z=this._workAttributeData.getUnderlineColor();this._config.drawBoldTextInBrightColors&&this._workAttributeData.isBold()&&z<8&&(z+=8),this._tmpCtx.strokeStyle=this._getColorFromAnsiIndex(z).css}this._tmpCtx.beginPath();for(var j=M,H=Math.ceil(M+this._config.deviceCharHeight)-U-(a?2*F:0),W=H+F,q=H+2*F,V=0;V<O;V++){this._tmpCtx.save();var K=j+V*this._config.deviceCellWidth,Y=j+(V+1)*this._config.deviceCellWidth,G=K+this._config.deviceCellWidth/2;switch(this._workAttributeData.extended.underlineStyle){case 2:this._tmpCtx.moveTo(K,H),this._tmpCtx.lineTo(Y,H),this._tmpCtx.moveTo(K,q),this._tmpCtx.lineTo(Y,q);break;case 3:var Q=F<=1?q:Math.ceil(M+this._config.deviceCharHeight-F/2)-U,X=F<=1?H:Math.ceil(M+this._config.deviceCharHeight+F/2)-U,J=new Path2D;J.rect(K,H,this._config.deviceCellWidth,q-H),this._tmpCtx.clip(J),this._tmpCtx.moveTo(K-this._config.deviceCellWidth/2,W),this._tmpCtx.bezierCurveTo(K-this._config.deviceCellWidth/2,X,K,X,K,W),this._tmpCtx.bezierCurveTo(K,Q,G,Q,G,W),this._tmpCtx.bezierCurveTo(G,X,Y,X,Y,W),this._tmpCtx.bezierCurveTo(Y,Q,Y+this._config.deviceCellWidth/2,Q,Y+this._config.deviceCellWidth/2,W);break;case 4:this._tmpCtx.setLineDash([Math.round(F),Math.round(F)]),this._tmpCtx.moveTo(K,H),this._tmpCtx.lineTo(Y,H);break;case 5:this._tmpCtx.setLineDash([4*this._config.devicePixelRatio,3*this._config.devicePixelRatio]),this._tmpCtx.moveTo(K,H),this._tmpCtx.lineTo(Y,H);break;default:this._tmpCtx.moveTo(K,H),this._tmpCtx.lineTo(Y,H)}this._tmpCtx.stroke(),this._tmpCtx.restore()}if(this._tmpCtx.restore(),!B&&this._config.fontSize>=12&&!this._config.allowTransparency&&" "!==o){this._tmpCtx.save(),this._tmpCtx.textBaseline="alphabetic";var $=this._tmpCtx.measureText(o);if(this._tmpCtx.restore(),"actualBoundingBoxDescent"in $&&$.actualBoundingBoxDescent>0){this._tmpCtx.save();var ee=new Path2D;ee.rect(j,H-Math.ceil(F/2),this._config.deviceCellWidth*O,q-H+Math.ceil(F/2)),this._tmpCtx.clip(ee),this._tmpCtx.lineWidth=3*this._config.devicePixelRatio,this._tmpCtx.strokeStyle=R.css,this._tmpCtx.strokeText(o,M,M+this._config.deviceCharHeight),this._tmpCtx.restore()}}}if(w){var te=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),re=te%2==1?.5:0;this._tmpCtx.lineWidth=te,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(M,M+re),this._tmpCtx.lineTo(M+this._config.deviceCharWidth*O,M+re),this._tmpCtx.stroke()}if(B||this._tmpCtx.fillText(o,M,M+this._config.deviceCharHeight),"_"===o&&!this._config.allowTransparency){var ne=x(this._tmpCtx.getImageData(M,M,this._config.deviceCellWidth,this._config.deviceCellHeight),R,L,N);if(ne)for(var ie=1;ie<=5&&(this._tmpCtx.save(),this._tmpCtx.fillStyle=R.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.restore(),this._tmpCtx.fillText(o,M,M+this._config.deviceCharHeight-ie),ne=x(this._tmpCtx.getImageData(M,M,this._config.deviceCellWidth,this._config.deviceCellHeight),R,L,N));ie++);}if(b){var ae=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/10)),se=this._tmpCtx.lineWidth%2==1?.5:0;this._tmpCtx.lineWidth=ae,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(M,M+Math.floor(this._config.deviceCharHeight/2)-se),this._tmpCtx.lineTo(M+this._config.deviceCharWidth*O,M+Math.floor(this._config.deviceCharHeight/2)-se),this._tmpCtx.stroke()}this._tmpCtx.restore();var oe,ue=this._tmpCtx.getImageData(0,0,this._tmpCanvas.width,this._tmpCanvas.height);if(oe=this._config.allowTransparency?function(e){for(var t=0;t<e.data.length;t+=4)if(e.data[t+3]>0)return!1;return!0}(ue):x(ue,R,L,N),oe)return _;for(var ce,le,he=this._findGlyphBoundingBox(ue,this._workBoundingBox,c,P,B,M);;){if(0===this._activePages.length){var fe=this._createNewPage();ce=fe,(le=fe.currentRow).height=he.size.y;break}le=(ce=this._activePages[this._activePages.length-1]).currentRow;var de,pe=u(this._activePages);try{for(pe.s();!(de=pe.n()).done;){var ve=de.value;he.size.y<=ve.currentRow.height&&(ce=ve,le=ve.currentRow)}}catch(Ce){pe.e(Ce)}finally{pe.f()}for(var ge=this._activePages.length-1;ge>=0;ge--){var ye,me=u(this._activePages[ge].fixedRows);try{for(me.s();!(ye=me.n()).done;){var be=ye.value;be.height<=le.height&&he.size.y<=be.height&&(ce=this._activePages[ge],le=be)}}catch(Ce){me.e(Ce)}finally{me.f()}}if(le.y+he.size.y>=ce.canvas.height||le.height>he.size.y+2){var _e=!1;if(ce.currentRow.y+ce.currentRow.height+he.size.y>=ce.canvas.height){var we,ke=void 0,xe=u(this._activePages);try{for(xe.s();!(we=xe.n()).done;){var Ee=we.value;if(Ee.currentRow.y+Ee.currentRow.height+he.size.y<Ee.canvas.height){ke=Ee;break}}}catch(Ce){xe.e(Ce)}finally{xe.f()}if(ke)ce=ke;else if(e.maxAtlasPages&&this._pages.length>=e.maxAtlasPages&&le.y+he.size.y<=ce.canvas.height&&le.height>=he.size.y&&le.x+he.size.x<=ce.canvas.width)_e=!0;else{var Se=this._createNewPage();ce=Se,(le=Se.currentRow).height=he.size.y,_e=!0}}_e||(ce.currentRow.height>0&&ce.fixedRows.push(ce.currentRow),le={x:0,y:ce.currentRow.y+ce.currentRow.height,height:he.size.y},ce.fixedRows.push(le),ce.currentRow={x:0,y:le.y+le.height,height:0})}if(le.x+he.size.x<=ce.canvas.width)break;le===ce.currentRow?(le.x=0,le.y+=le.height,le.height=0):ce.fixedRows.splice(ce.fixedRows.indexOf(le),1)}return he.texturePage=this._pages.indexOf(ce),he.texturePosition.x=le.x,he.texturePosition.y=le.y,he.texturePositionClipSpace.x=le.x/ce.canvas.width,he.texturePositionClipSpace.y=le.y/ce.canvas.height,he.sizeClipSpace.x/=ce.canvas.width,he.sizeClipSpace.y/=ce.canvas.height,le.height=Math.max(le.height,he.size.y),le.x+=he.size.x,ce.ctx.putImageData(ue,he.texturePosition.x-this._workBoundingBox.left,he.texturePosition.y-this._workBoundingBox.top,this._workBoundingBox.left,this._workBoundingBox.top,he.size.x,he.size.y),ce.addGlyph(he),ce.version++,he}},{key:"_findGlyphBoundingBox",value:function(e,t,r,n,i,a){t.top=0;for(var s=n?this._config.deviceCellHeight:this._tmpCanvas.height,o=n?this._config.deviceCellWidth:r,u=!1,c=0;c<s;c++){for(var l=0;l<o;l++){var h=c*this._tmpCanvas.width*4+4*l+3;if(0!==e.data[h]){t.top=c,u=!0;break}}if(u)break}t.left=0,u=!1;for(var f=0;f<a+o;f++){for(var d=0;d<s;d++){var p=d*this._tmpCanvas.width*4+4*f+3;if(0!==e.data[p]){t.left=f,u=!0;break}}if(u)break}t.right=o,u=!1;for(var v=a+o-1;v>=a;v--){for(var g=0;g<s;g++){var y=g*this._tmpCanvas.width*4+4*v+3;if(0!==e.data[y]){t.right=v,u=!0;break}}if(u)break}t.bottom=s,u=!1;for(var m=s-1;m>=0;m--){for(var b=0;b<o;b++){var _=m*this._tmpCanvas.width*4+4*b+3;if(0!==e.data[_]){t.bottom=m,u=!0;break}}if(u)break}return{texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},size:{x:t.right-t.left+1,y:t.bottom-t.top+1},sizeClipSpace:{x:t.right-t.left+1,y:t.bottom-t.top+1},offset:{x:-t.left+a+(n||i?Math.floor((this._config.deviceCellWidth-this._config.deviceCharWidth)/2):0),y:-t.top+a+(n||i?1===this._config.lineHeight?0:Math.round((this._config.deviceCellHeight-this._config.deviceCharHeight)/2):0)}}}}]),e}();t.TextureAtlas=w,n([b.traceCall],w.prototype,"_drawToCache",null);var k=function(){function e(t,r,n){if(c(this,e),this._usedPixels=0,this._glyphs=[],this.version=0,this.currentRow={x:0,y:0,height:0},this.fixedRows=[],n){var a,s=u(n);try{for(s.s();!(a=s.n()).done;){var o,l=a.value;(o=this._glyphs).push.apply(o,i(l.glyphs)),this._usedPixels+=l._usedPixels}}catch(h){s.e(h)}finally{s.f()}}this.canvas=E(t,r,r),this.ctx=(0,f.throwIfFalsy)(this.canvas.getContext("2d",{alpha:!0}))}return l(e,[{key:"percentageUsed",get:function(){return this._usedPixels/(this.canvas.width*this.canvas.height)}},{key:"glyphs",get:function(){return this._glyphs}},{key:"addGlyph",value:function(e){this._glyphs.push(e),this._usedPixels+=e.size.x*e.size.y}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.currentRow.x=0,this.currentRow.y=0,this.currentRow.height=0,this.fixedRows.length=0,this.version++}}]),e}();function x(e,t,r,n){for(var i=t.rgba>>>24,a=t.rgba>>>16&255,s=t.rgba>>>8&255,o=r.rgba>>>24,u=r.rgba>>>16&255,c=r.rgba>>>8&255,l=Math.floor((Math.abs(i-o)+Math.abs(a-u)+Math.abs(s-c))/12),h=!0,f=0;f<e.data.length;f+=4)e.data[f]===i&&e.data[f+1]===a&&e.data[f+2]===s||n&&Math.abs(e.data[f]-i)+Math.abs(e.data[f+1]-a)+Math.abs(e.data[f+2]-s)<l?e.data[f+3]=0:h=!1;return h}function E(e,t,r){var n=e.createElement("canvas");return n.width=t,n.height=r,n}},160:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.contrastRatio=t.toPaddedHex=t.rgba=t.rgb=t.css=t.color=t.channels=t.NULL_COLOR=void 0;var n,i,a,s,u,c=r(399),l=0,h=0,f=0,d=0;function p(e){var t=e.toString(16);return t.length<2?"0"+t:t}function v(e,t){return e<t?(t+.05)/(e+.05):(e+.05)/(t+.05)}t.NULL_COLOR={css:"#00000000",rgba:0},function(e){e.toCss=function(e,t,r,n){return void 0!==n?"#".concat(p(e)).concat(p(t)).concat(p(r)).concat(p(n)):"#".concat(p(e)).concat(p(t)).concat(p(r))},e.toRgba=function(e,t,r){return(e<<24|t<<16|r<<8|(arguments.length>3&&void 0!==arguments[3]?arguments[3]:255))>>>0}}(n||(t.channels=n={})),function(e){function t(e,t){var r,i;return d=Math.round(255*t),r=u.toChannels(e.rgba),i=o(r,3),l=i[0],h=i[1],f=i[2],{css:n.toCss(l,h,f,d),rgba:n.toRgba(l,h,f,d)}}e.blend=function(e,t){if(1===(d=(255&t.rgba)/255))return{css:t.css,rgba:t.rgba};var r=t.rgba>>24&255,i=t.rgba>>16&255,a=t.rgba>>8&255,s=e.rgba>>24&255,o=e.rgba>>16&255,u=e.rgba>>8&255;return l=s+Math.round((r-s)*d),h=o+Math.round((i-o)*d),f=u+Math.round((a-u)*d),{css:n.toCss(l,h,f),rgba:n.toRgba(l,h,f)}},e.isOpaque=function(e){return 255==(255&e.rgba)},e.ensureContrastRatio=function(e,t,r){var n=u.ensureContrastRatio(e.rgba,t.rgba,r);if(n)return u.toColor(n>>24&255,n>>16&255,n>>8&255)},e.opaque=function(e){var t,r,i=(255|e.rgba)>>>0;return t=u.toChannels(i),r=o(t,3),l=r[0],h=r[1],f=r[2],{css:n.toCss(l,h,f),rgba:i}},e.opacity=t,e.multiplyOpacity=function(e,r){return t(e,(d=255&e.rgba)*r/255)},e.toColorRGB=function(e){return[e.rgba>>24&255,e.rgba>>16&255,e.rgba>>8&255]}}(i||(t.color=i={})),function(e){var t,r;if(!c.isNode){var i=document.createElement("canvas");i.width=1,i.height=1;var a=i.getContext("2d",{willReadFrequently:!0});a&&((t=a).globalCompositeOperation="copy",r=t.createLinearGradient(0,0,1,1))}e.toColor=function(e){var i;if(e.match(/#[\da-f]{3,8}/i))switch(e.length){case 4:return l=parseInt(e.slice(1,2).repeat(2),16),h=parseInt(e.slice(2,3).repeat(2),16),f=parseInt(e.slice(3,4).repeat(2),16),u.toColor(l,h,f);case 5:return l=parseInt(e.slice(1,2).repeat(2),16),h=parseInt(e.slice(2,3).repeat(2),16),f=parseInt(e.slice(3,4).repeat(2),16),d=parseInt(e.slice(4,5).repeat(2),16),u.toColor(l,h,f,d);case 7:return{css:e,rgba:(parseInt(e.slice(1),16)<<8|255)>>>0};case 9:return{css:e,rgba:parseInt(e.slice(1),16)>>>0}}var a=e.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(a)return l=parseInt(a[1]),h=parseInt(a[2]),f=parseInt(a[3]),d=Math.round(255*(void 0===a[5]?1:parseFloat(a[5]))),u.toColor(l,h,f,d);if(!t||!r)throw new Error("css.toColor: Unsupported css format");if(t.fillStyle=r,t.fillStyle=e,"string"!=typeof t.fillStyle)throw new Error("css.toColor: Unsupported css format");if(t.fillRect(0,0,1,1),i=o(t.getImageData(0,0,1,1).data,4),l=i[0],h=i[1],f=i[2],255!==(d=i[3]))throw new Error("css.toColor: Unsupported css format");return{rgba:n.toRgba(l,h,f,d),css:e}}}(a||(t.css=a={})),function(e){function t(e,t,r){var n=e/255,i=t/255,a=r/255;return.2126*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.7152*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))+.0722*(a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4))}e.relativeLuminance=function(e){return t(e>>16&255,e>>8&255,255&e)},e.relativeLuminance2=t}(s||(t.rgb=s={})),function(e){function t(e,t,r){for(var n=e>>24&255,i=e>>16&255,a=e>>8&255,o=t>>24&255,u=t>>16&255,c=t>>8&255,l=v(s.relativeLuminance2(o,u,c),s.relativeLuminance2(n,i,a));l<r&&(o>0||u>0||c>0);)o-=Math.max(0,Math.ceil(.1*o)),u-=Math.max(0,Math.ceil(.1*u)),c-=Math.max(0,Math.ceil(.1*c)),l=v(s.relativeLuminance2(o,u,c),s.relativeLuminance2(n,i,a));return(o<<24|u<<16|c<<8|255)>>>0}function r(e,t,r){for(var n=e>>24&255,i=e>>16&255,a=e>>8&255,o=t>>24&255,u=t>>16&255,c=t>>8&255,l=v(s.relativeLuminance2(o,u,c),s.relativeLuminance2(n,i,a));l<r&&(o<255||u<255||c<255);)o=Math.min(255,o+Math.ceil(.1*(255-o))),u=Math.min(255,u+Math.ceil(.1*(255-u))),c=Math.min(255,c+Math.ceil(.1*(255-c))),l=v(s.relativeLuminance2(o,u,c),s.relativeLuminance2(n,i,a));return(o<<24|u<<16|c<<8|255)>>>0}e.ensureContrastRatio=function(e,n,i){var a=s.relativeLuminance(e>>8),o=s.relativeLuminance(n>>8);if(v(a,o)<i){if(o<a){var u=t(e,n,i),c=v(a,s.relativeLuminance(u>>8));if(c<i){var l=r(e,n,i);return c>v(a,s.relativeLuminance(l>>8))?u:l}return u}var h=r(e,n,i),f=v(a,s.relativeLuminance(h>>8));if(f<i){var d=t(e,n,i);return f>v(a,s.relativeLuminance(d>>8))?h:d}return h}},e.reduceLuminance=t,e.increaseLuminance=r,e.toChannels=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]},e.toColor=function(e,t,r,i){return{css:n.toCss(e,t,r,i),rgba:n.toRgba(e,t,r,i)}}}(u||(t.rgba=u={})),t.toPaddedHex=p,t.contrastRatio=v},345:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.forwardEvent=t.EventEmitter=void 0,t.EventEmitter=function(){function e(){c(this,e),this._listeners=[],this._disposed=!1}return l(e,[{key:"event",get:function(){var e=this;return this._event||(this._event=function(t){return e._listeners.push(t),{dispose:function(){if(!e._disposed)for(var r=0;r<e._listeners.length;r++)if(e._listeners[r]===t)return void e._listeners.splice(r,1)}}}),this._event}},{key:"fire",value:function(e,t){for(var r=[],n=0;n<this._listeners.length;n++)r.push(this._listeners[n]);for(var i=0;i<r.length;i++)r[i].call(void 0,e,t)}},{key:"dispose",value:function(){this.clearListeners(),this._disposed=!0}},{key:"clearListeners",value:function(){this._listeners&&(this._listeners.length=0)}}]),e}(),t.forwardEvent=function(e,t){return e((function(e){return t.fire(e)}))}},859:function(e,t){function r(e){var t,r=u(e);try{for(r.s();!(t=r.n()).done;)t.value.dispose()}catch(n){r.e(n)}finally{r.f()}e.length=0}Object.defineProperty(t,"__esModule",{value:!0}),t.getDisposeArrayDisposable=t.disposeArray=t.toDisposable=t.MutableDisposable=t.Disposable=void 0,t.Disposable=function(){function e(){c(this,e),this._disposables=[],this._isDisposed=!1}return l(e,[{key:"dispose",value:function(){this._isDisposed=!0;var e,t=u(this._disposables);try{for(t.s();!(e=t.n()).done;)e.value.dispose()}catch(r){t.e(r)}finally{t.f()}this._disposables.length=0}},{key:"register",value:function(e){return this._disposables.push(e),e}},{key:"unregister",value:function(e){var t=this._disposables.indexOf(e);-1!==t&&this._disposables.splice(t,1)}}]),e}(),t.MutableDisposable=function(){function e(){c(this,e),this._isDisposed=!1}return l(e,[{key:"value",get:function(){return this._isDisposed?void 0:this._value},set:function(e){var t;this._isDisposed||e===this._value||(null===(t=this._value)||void 0===t||t.dispose(),this._value=e)}},{key:"clear",value:function(){this.value=void 0}},{key:"dispose",value:function(){var e;this._isDisposed=!0,null===(e=this._value)||void 0===e||e.dispose(),this._value=void 0}}]),e}(),t.toDisposable=function(e){return{dispose:e}},t.disposeArray=r,t.getDisposeArrayDisposable=function(e){return{dispose:function(){return r(e)}}}},485:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.FourKeyMap=t.TwoKeyMap=void 0;var r=function(){function e(){c(this,e),this._data={}}return l(e,[{key:"set",value:function(e,t,r){this._data[e]||(this._data[e]={}),this._data[e][t]=r}},{key:"get",value:function(e,t){return this._data[e]?this._data[e][t]:void 0}},{key:"clear",value:function(){this._data={}}}]),e}();t.TwoKeyMap=r,t.FourKeyMap=function(){function e(){c(this,e),this._data=new r}return l(e,[{key:"set",value:function(e,t,n,i,a){this._data.get(e,t)||this._data.set(e,t,new r),this._data.get(e,t).set(n,i,a)}},{key:"get",value:function(e,t,r,n){var i;return null===(i=this._data.get(e,t))||void 0===i?void 0:i.get(r,n)}},{key:"clear",value:function(){this._data.clear()}}]),e}()},399:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isChromeOS=t.isLinux=t.isWindows=t.isIphone=t.isIpad=t.isMac=t.getSafariVersion=t.isSafari=t.isLegacyEdge=t.isFirefox=t.isNode=void 0,t.isNode="undefined"==typeof navigator;var r=t.isNode?"node":navigator.userAgent,n=t.isNode?"node":navigator.platform;t.isFirefox=r.includes("Firefox"),t.isLegacyEdge=r.includes("Edge"),t.isSafari=/^((?!chrome|android).)*safari/i.test(r),t.getSafariVersion=function(){if(!t.isSafari)return 0;var e=r.match(/Version\/(\d+)/);return null===e||e.length<2?0:parseInt(e[1])},t.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(n),t.isIpad="iPad"===n,t.isIphone="iPhone"===n,t.isWindows=["Windows","Win16","Win32","WinCE"].includes(n),t.isLinux=n.indexOf("Linux")>=0,t.isChromeOS=/\bCrOS\b/.test(r)},385:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.DebouncedIdleTask=t.IdleTaskQueue=t.PriorityTaskQueue=void 0;var n=r(399),i=function(){function e(){c(this,e),this._tasks=[],this._i=0}return l(e,[{key:"enqueue",value:function(e){this._tasks.push(e),this._start()}},{key:"flush",value:function(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}},{key:"clear",value:function(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}},{key:"_start",value:function(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}},{key:"_process",value:function(e){this._idleCallback=void 0;for(var t=0,r=0,n=e.timeRemaining(),i=0;this._i<this._tasks.length;){if(t=Date.now(),this._tasks[this._i]()||this._i++,t=Math.max(1,Date.now()-t),1.5*(r=Math.max(t,r))>(i=e.timeRemaining()))return n-t<-20&&console.warn("task queue exceeded allotted deadline by ".concat(Math.abs(Math.round(n-t)),"ms")),void this._start();n=i}this.clear()}}]),e}(),a=function(e){h(r,e);var t=f(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"_requestCallback",value:function(e){var t=this;return setTimeout((function(){return e(t._createDeadline(16))}))}},{key:"_cancelCallback",value:function(e){clearTimeout(e)}},{key:"_createDeadline",value:function(e){var t=Date.now()+e;return{timeRemaining:function(){return Math.max(0,t-Date.now())}}}}]),r}(i);t.PriorityTaskQueue=a,t.IdleTaskQueue=!n.isNode&&"requestIdleCallback"in window?function(e){h(r,e);var t=f(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"_requestCallback",value:function(e){return requestIdleCallback(e)}},{key:"_cancelCallback",value:function(e){cancelIdleCallback(e)}}]),r}(i):a,t.DebouncedIdleTask=function(){function e(){c(this,e),this._queue=new t.IdleTaskQueue}return l(e,[{key:"set",value:function(e){this._queue.clear(),this._queue.enqueue(e)}},{key:"flush",value:function(){this._queue.flush()}}]),e}()},147:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedAttrs=t.AttributeData=void 0;var r=function(){function e(){c(this,e),this.fg=0,this.bg=0,this.extended=new n}return l(e,[{key:"clone",value:function(){var t=new e;return t.fg=this.fg,t.bg=this.bg,t.extended=this.extended.clone(),t}},{key:"isInverse",value:function(){return 67108864&this.fg}},{key:"isBold",value:function(){return 134217728&this.fg}},{key:"isUnderline",value:function(){return this.hasExtendedAttrs()&&0!==this.extended.underlineStyle?1:268435456&this.fg}},{key:"isBlink",value:function(){return 536870912&this.fg}},{key:"isInvisible",value:function(){return 1073741824&this.fg}},{key:"isItalic",value:function(){return 67108864&this.bg}},{key:"isDim",value:function(){return 134217728&this.bg}},{key:"isStrikethrough",value:function(){return 2147483648&this.fg}},{key:"isProtected",value:function(){return 536870912&this.bg}},{key:"isOverline",value:function(){return 1073741824&this.bg}},{key:"getFgColorMode",value:function(){return 50331648&this.fg}},{key:"getBgColorMode",value:function(){return 50331648&this.bg}},{key:"isFgRGB",value:function(){return 50331648==(50331648&this.fg)}},{key:"isBgRGB",value:function(){return 50331648==(50331648&this.bg)}},{key:"isFgPalette",value:function(){return 16777216==(50331648&this.fg)||33554432==(50331648&this.fg)}},{key:"isBgPalette",value:function(){return 16777216==(50331648&this.bg)||33554432==(50331648&this.bg)}},{key:"isFgDefault",value:function(){return 0==(50331648&this.fg)}},{key:"isBgDefault",value:function(){return 0==(50331648&this.bg)}},{key:"isAttributeDefault",value:function(){return 0===this.fg&&0===this.bg}},{key:"getFgColor",value:function(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}},{key:"getBgColor",value:function(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}},{key:"hasExtendedAttrs",value:function(){return 268435456&this.bg}},{key:"updateExtended",value:function(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}},{key:"getUnderlineColor",value:function(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}},{key:"getUnderlineColorMode",value:function(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}},{key:"isUnderlineColorRGB",value:function(){return 268435456&this.bg&&~this.extended.underlineColor?50331648==(50331648&this.extended.underlineColor):this.isFgRGB()}},{key:"isUnderlineColorPalette",value:function(){return 268435456&this.bg&&~this.extended.underlineColor?16777216==(50331648&this.extended.underlineColor)||33554432==(50331648&this.extended.underlineColor):this.isFgPalette()}},{key:"isUnderlineColorDefault",value:function(){return 268435456&this.bg&&~this.extended.underlineColor?0==(50331648&this.extended.underlineColor):this.isFgDefault()}},{key:"getUnderlineStyle",value:function(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}],[{key:"toColorRGB",value:function(e){return[e>>>16&255,e>>>8&255,255&e]}},{key:"fromColorRGB",value:function(e){return(255&e[0])<<16|(255&e[1])<<8|255&e[2]}}]),e}();t.AttributeData=r;var n=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;c(this,e),this._ext=0,this._urlId=0,this._ext=t,this._urlId=r}return l(e,[{key:"ext",get:function(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext},set:function(e){this._ext=e}},{key:"underlineStyle",get:function(){return this._urlId?5:(469762048&this._ext)>>26},set:function(e){this._ext&=-469762049,this._ext|=e<<26&469762048}},{key:"underlineColor",get:function(){return 67108863&this._ext},set:function(e){this._ext&=-67108864,this._ext|=67108863&e}},{key:"urlId",get:function(){return this._urlId},set:function(e){this._urlId=e}},{key:"clone",value:function(){return new e(this._ext,this._urlId)}},{key:"isEmpty",value:function(){return 0===this.underlineStyle&&0===this._urlId}}]),e}();t.ExtendedAttrs=n},782:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.CellData=void 0;var n=r(133),i=r(855),a=r(147),s=function(e){h(r,e);var t=f(r);function r(){var e;return c(this,r),(e=t.apply(this,arguments)).content=0,e.fg=0,e.bg=0,e.extended=new a.ExtendedAttrs,e.combinedData="",e}return l(r,[{key:"isCombined",value:function(){return 2097152&this.content}},{key:"getWidth",value:function(){return this.content>>22}},{key:"getChars",value:function(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,n.stringFromCodePoint)(2097151&this.content):""}},{key:"getCode",value:function(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}},{key:"setFromCharData",value:function(e){this.fg=e[i.CHAR_DATA_ATTR_INDEX],this.bg=0;var t=!1;if(e[i.CHAR_DATA_CHAR_INDEX].length>2)t=!0;else if(2===e[i.CHAR_DATA_CHAR_INDEX].length){var r=e[i.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=r&&r<=56319){var n=e[i.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=n&&n<=57343?this.content=1024*(r-55296)+n-56320+65536|e[i.CHAR_DATA_WIDTH_INDEX]<<22:t=!0}else t=!0}else this.content=e[i.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|e[i.CHAR_DATA_WIDTH_INDEX]<<22;t&&(this.combinedData=e[i.CHAR_DATA_CHAR_INDEX],this.content=2097152|e[i.CHAR_DATA_WIDTH_INDEX]<<22)}},{key:"getAsCharData",value:function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}],[{key:"fromCharData",value:function(e){var t=new r;return t.setFromCharData(e),t}}]),r}(a.AttributeData);t.CellData=s},855:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.WHITESPACE_CELL_CODE=t.WHITESPACE_CELL_WIDTH=t.WHITESPACE_CELL_CHAR=t.NULL_CELL_CODE=t.NULL_CELL_WIDTH=t.NULL_CELL_CHAR=t.CHAR_DATA_CODE_INDEX=t.CHAR_DATA_WIDTH_INDEX=t.CHAR_DATA_CHAR_INDEX=t.CHAR_DATA_ATTR_INDEX=t.DEFAULT_EXT=t.DEFAULT_ATTR=t.DEFAULT_COLOR=void 0,t.DEFAULT_COLOR=0,t.DEFAULT_ATTR=256|t.DEFAULT_COLOR<<9,t.DEFAULT_EXT=0,t.CHAR_DATA_ATTR_INDEX=0,t.CHAR_DATA_CHAR_INDEX=1,t.CHAR_DATA_WIDTH_INDEX=2,t.CHAR_DATA_CODE_INDEX=3,t.NULL_CELL_CHAR="",t.NULL_CELL_WIDTH=1,t.NULL_CELL_CODE=0,t.WHITESPACE_CELL_CHAR=" ",t.WHITESPACE_CELL_WIDTH=1,t.WHITESPACE_CELL_CODE=32},133:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Utf8ToUtf32=t.StringToUtf32=t.utf32ToString=t.stringFromCodePoint=void 0,t.stringFromCodePoint=function(e){return e>65535?(e-=65536,String.fromCharCode(55296+(e>>10))+String.fromCharCode(e%1024+56320)):String.fromCharCode(e)},t.utf32ToString=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,n="",i=t;i<r;++i){var a=e[i];a>65535?(a-=65536,n+=String.fromCharCode(55296+(a>>10))+String.fromCharCode(a%1024+56320)):n+=String.fromCharCode(a)}return n},t.StringToUtf32=function(){function e(){c(this,e),this._interim=0}return l(e,[{key:"clear",value:function(){this._interim=0}},{key:"decode",value:function(e,t){var r=e.length;if(!r)return 0;var n=0,i=0;if(this._interim){var a=e.charCodeAt(i++);56320<=a&&a<=57343?t[n++]=1024*(this._interim-55296)+a-56320+65536:(t[n++]=this._interim,t[n++]=a),this._interim=0}for(var s=i;s<r;++s){var o=e.charCodeAt(s);if(55296<=o&&o<=56319){if(++s>=r)return this._interim=o,n;var u=e.charCodeAt(s);56320<=u&&u<=57343?t[n++]=1024*(o-55296)+u-56320+65536:(t[n++]=o,t[n++]=u)}else 65279!==o&&(t[n++]=o)}return n}}]),e}(),t.Utf8ToUtf32=function(){function e(){c(this,e),this.interim=new Uint8Array(3)}return l(e,[{key:"clear",value:function(){this.interim.fill(0)}},{key:"decode",value:function(e,t){var r=e.length;if(!r)return 0;var n,i,a,s,o=0,u=0,c=0;if(this.interim[0]){var l=!1,h=this.interim[0];h&=192==(224&h)?31:224==(240&h)?15:7;for(var f,d=0;(f=63&this.interim[++d])&&d<4;)h<<=6,h|=f;for(var p=192==(224&this.interim[0])?2:224==(240&this.interim[0])?3:4,v=p-d;c<v;){if(c>=r)return 0;if(128!=(192&(f=e[c++]))){c--,l=!0;break}this.interim[d++]=f,h<<=6,h|=63&f}l||(2===p?h<128?c--:t[o++]=h:3===p?h<2048||h>=55296&&h<=57343||65279===h||(t[o++]=h):h<65536||h>1114111||(t[o++]=h)),this.interim.fill(0)}for(var g=r-4,y=c;y<r;){for(;!(!(y<g)||128&(n=e[y])||128&(i=e[y+1])||128&(a=e[y+2])||128&(s=e[y+3]));)t[o++]=n,t[o++]=i,t[o++]=a,t[o++]=s,y+=4;if((n=e[y++])<128)t[o++]=n;else if(192==(224&n)){if(y>=r)return this.interim[0]=n,o;if(128!=(192&(i=e[y++]))){y--;continue}if((u=(31&n)<<6|63&i)<128){y--;continue}t[o++]=u}else if(224==(240&n)){if(y>=r)return this.interim[0]=n,o;if(128!=(192&(i=e[y++]))){y--;continue}if(y>=r)return this.interim[0]=n,this.interim[1]=i,o;if(128!=(192&(a=e[y++]))){y--;continue}if((u=(15&n)<<12|(63&i)<<6|63&a)<2048||u>=55296&&u<=57343||65279===u)continue;t[o++]=u}else if(240==(248&n)){if(y>=r)return this.interim[0]=n,o;if(128!=(192&(i=e[y++]))){y--;continue}if(y>=r)return this.interim[0]=n,this.interim[1]=i,o;if(128!=(192&(a=e[y++]))){y--;continue}if(y>=r)return this.interim[0]=n,this.interim[1]=i,this.interim[2]=a,o;if(128!=(192&(s=e[y++]))){y--;continue}if((u=(7&n)<<18|(63&i)<<12|(63&a)<<6|63&s)<65536||u>1114111)continue;t[o++]=u}}return o}}]),e}()},776:function(e,t,r){var a=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s},s=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.traceCall=t.setTraceLogger=t.LogService=void 0;var o,u=r(859),d=r(97),p={trace:d.LogLevelEnum.TRACE,debug:d.LogLevelEnum.DEBUG,info:d.LogLevelEnum.INFO,warn:d.LogLevelEnum.WARN,error:d.LogLevelEnum.ERROR,off:d.LogLevelEnum.OFF},v=t.LogService=function(e){h(r,e);var t=f(r);function r(e){var i;return c(this,r),(i=t.call(this))._optionsService=e,i._logLevel=d.LogLevelEnum.OFF,i._updateLogLevel(),i.register(i._optionsService.onSpecificOptionChange("logLevel",(function(){return i._updateLogLevel()}))),o=n(i),i}return l(r,[{key:"logLevel",get:function(){return this._logLevel}},{key:"_updateLogLevel",value:function(){this._logLevel=p[this._optionsService.rawOptions.logLevel]}},{key:"_evalLazyOptionalParams",value:function(e){for(var t=0;t<e.length;t++)"function"==typeof e[t]&&(e[t]=e[t]())}},{key:"_log",value:function(e,t,r){this._evalLazyOptionalParams(r),e.call.apply(e,[console,(this._optionsService.options.logger?"":"xterm.js: ")+t].concat(i(r)))}},{key:"trace",value:function(e){for(var t,r,n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];this._logLevel<=d.LogLevelEnum.TRACE&&this._log(null!==(r=null===(t=this._optionsService.options.logger)||void 0===t?void 0:t.trace.bind(this._optionsService.options.logger))&&void 0!==r?r:console.log,e,i)}},{key:"debug",value:function(e){for(var t,r,n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];this._logLevel<=d.LogLevelEnum.DEBUG&&this._log(null!==(r=null===(t=this._optionsService.options.logger)||void 0===t?void 0:t.debug.bind(this._optionsService.options.logger))&&void 0!==r?r:console.log,e,i)}},{key:"info",value:function(e){for(var t,r,n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];this._logLevel<=d.LogLevelEnum.INFO&&this._log(null!==(r=null===(t=this._optionsService.options.logger)||void 0===t?void 0:t.info.bind(this._optionsService.options.logger))&&void 0!==r?r:console.info,e,i)}},{key:"warn",value:function(e){for(var t,r,n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];this._logLevel<=d.LogLevelEnum.WARN&&this._log(null!==(r=null===(t=this._optionsService.options.logger)||void 0===t?void 0:t.warn.bind(this._optionsService.options.logger))&&void 0!==r?r:console.warn,e,i)}},{key:"error",value:function(e){for(var t,r,n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];this._logLevel<=d.LogLevelEnum.ERROR&&this._log(null!==(r=null===(t=this._optionsService.options.logger)||void 0===t?void 0:t.error.bind(this._optionsService.options.logger))&&void 0!==r?r:console.error,e,i)}}]),r}(u.Disposable);t.LogService=v=a([s(0,d.IOptionsService)],v),t.setTraceLogger=function(e){o=e},t.traceCall=function(e,t,r){if("function"!=typeof r.value)throw new Error("not supported");var n=r.value;r.value=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(o.logLevel!==d.LogLevelEnum.TRACE)return n.apply(this,t);o.trace("GlyphRenderer#".concat(n.name,"(").concat(t.map((function(e){return JSON.stringify(e)})).join(", "),")"));var i=n.apply(this,t);return o.trace("GlyphRenderer#".concat(n.name," return"),i),i}}},726:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createDecorator=t.getServiceDependencies=t.serviceRegistry=void 0;var r="di$target",n="di$dependencies";t.serviceRegistry=new Map,t.getServiceDependencies=function(e){return e[n]||[]},t.createDecorator=function(e){if(t.serviceRegistry.has(e))return t.serviceRegistry.get(e);var i=function e(t,i,a){if(3!==arguments.length)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");!function(e,t,i){t[r]===t?t[n].push({id:e,index:i}):(t[n]=[{id:e,index:i}],t[r]=t)}(e,t,a)};return i.toString=function(){return e},t.serviceRegistry.set(e,i),i}},97:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.IDecorationService=t.IUnicodeService=t.IOscLinkService=t.IOptionsService=t.ILogService=t.LogLevelEnum=t.IInstantiationService=t.ICharsetService=t.ICoreService=t.ICoreMouseService=t.IBufferService=void 0;var n,i=r(726);t.IBufferService=(0,i.createDecorator)("BufferService"),t.ICoreMouseService=(0,i.createDecorator)("CoreMouseService"),t.ICoreService=(0,i.createDecorator)("CoreService"),t.ICharsetService=(0,i.createDecorator)("CharsetService"),t.IInstantiationService=(0,i.createDecorator)("InstantiationService"),function(e){e[e.TRACE=0]="TRACE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.OFF=5]="OFF"}(n||(t.LogLevelEnum=n={})),t.ILogService=(0,i.createDecorator)("LogService"),t.IOptionsService=(0,i.createDecorator)("OptionsService"),t.IOscLinkService=(0,i.createDecorator)("OscLinkService"),t.IUnicodeService=(0,i.createDecorator)("UnicodeService"),t.IDecorationService=(0,i.createDecorator)("DecorationService")}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,r),a.exports}var d={};return function(){var e=d;Object.defineProperty(e,"__esModule",{value:!0}),e.WebglAddon=void 0;var t=r(345),n=r(859),i=r(399),a=r(666),s=r(776),o=function(e){h(o,e);var r=f(o);function o(e){var n;if(c(this,o),i.isSafari&&(0,i.getSafariVersion)()<16)throw new Error("Webgl2 is only supported on Safari 16 and above");return(n=r.call(this))._preserveDrawingBuffer=e,n._onChangeTextureAtlas=n.register(new t.EventEmitter),n.onChangeTextureAtlas=n._onChangeTextureAtlas.event,n._onAddTextureAtlasCanvas=n.register(new t.EventEmitter),n.onAddTextureAtlasCanvas=n._onAddTextureAtlasCanvas.event,n._onRemoveTextureAtlasCanvas=n.register(new t.EventEmitter),n.onRemoveTextureAtlasCanvas=n._onRemoveTextureAtlasCanvas.event,n._onContextLoss=n.register(new t.EventEmitter),n.onContextLoss=n._onContextLoss.event,n}return l(o,[{key:"activate",value:function(e){var r=this,i=e._core;if(e.element){this._terminal=e;var o=i.coreService,u=i.optionsService,c=i,l=c._renderService,h=c._characterJoinerService,f=c._charSizeService,d=c._coreBrowserService,p=c._decorationService,v=c._logService,g=c._themeService;(0,s.setTraceLogger)(v),this._renderer=this.register(new a.WebglRenderer(e,h,f,d,o,p,u,g,this._preserveDrawingBuffer)),this.register((0,t.forwardEvent)(this._renderer.onContextLoss,this._onContextLoss)),this.register((0,t.forwardEvent)(this._renderer.onChangeTextureAtlas,this._onChangeTextureAtlas)),this.register((0,t.forwardEvent)(this._renderer.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas)),this.register((0,t.forwardEvent)(this._renderer.onRemoveTextureAtlasCanvas,this._onRemoveTextureAtlasCanvas)),l.setRenderer(this._renderer),this.register((0,n.toDisposable)((function(){var t=r._terminal._core._renderService;t.setRenderer(r._terminal._core._createRenderer()),t.handleResize(e.cols,e.rows)})))}else this.register(i.onWillOpen((function(){return r.activate(e)})))}},{key:"textureAtlas",get:function(){var e;return null===(e=this._renderer)||void 0===e?void 0:e.textureAtlas}},{key:"clearTextureAtlas",value:function(){var e;null===(e=this._renderer)||void 0===e||e.clearTextureAtlas()}}]),o}(n.Disposable);e.WebglAddon=o}(),d}()},2699:function(e,t,r){var n=r(3515).default,i=r(7061).default,a=r(4993).default,s=r(861).default,o=r(1588).default,u=r(3808).default,c=r(7424).default,l=r(4704).default,h=r(6690).default,f=r(9728).default,d=r(6115).default,p=r(1655).default,v=r(6389).default;self,e.exports=function(){"use strict";var e={4567:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.AccessibilityManager=void 0;var a=r(9042),s=r(6114),o=r(9924),u=r(844),c=r(5596),l=r(4725),g=r(3656),y=t.AccessibilityManager=function(e){p(r,e);var t=v(r);function r(e,n){var i;h(this,r),(i=t.call(this))._terminal=e,i._renderService=n,i._liveRegionLineCount=0,i._charsToConsume=[],i._charsToAnnounce="",i._accessibilityContainer=document.createElement("div"),i._accessibilityContainer.classList.add("xterm-accessibility"),i._rowContainer=document.createElement("div"),i._rowContainer.setAttribute("role","list"),i._rowContainer.classList.add("xterm-accessibility-tree"),i._rowElements=[];for(var a=0;a<i._terminal.rows;a++)i._rowElements[a]=i._createAccessibilityTreeNode(),i._rowContainer.appendChild(i._rowElements[a]);if(i._topBoundaryFocusListener=function(e){return i._handleBoundaryFocus(e,0)},i._bottomBoundaryFocusListener=function(e){return i._handleBoundaryFocus(e,1)},i._rowElements[0].addEventListener("focus",i._topBoundaryFocusListener),i._rowElements[i._rowElements.length-1].addEventListener("focus",i._bottomBoundaryFocusListener),i._refreshRowsDimensions(),i._accessibilityContainer.appendChild(i._rowContainer),i._liveRegion=document.createElement("div"),i._liveRegion.classList.add("live-region"),i._liveRegion.setAttribute("aria-live","assertive"),i._accessibilityContainer.appendChild(i._liveRegion),i._liveRegionDebouncer=i.register(new o.TimeBasedDebouncer(i._renderRows.bind(d(i)))),!i._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");return i._terminal.element.insertAdjacentElement("afterbegin",i._accessibilityContainer),i.register(i._terminal.onResize((function(e){return i._handleResize(e.rows)}))),i.register(i._terminal.onRender((function(e){return i._refreshRows(e.start,e.end)}))),i.register(i._terminal.onScroll((function(){return i._refreshRows()}))),i.register(i._terminal.onA11yChar((function(e){return i._handleChar(e)}))),i.register(i._terminal.onLineFeed((function(){return i._handleChar("\n")}))),i.register(i._terminal.onA11yTab((function(e){return i._handleTab(e)}))),i.register(i._terminal.onKey((function(e){return i._handleKey(e.key)}))),i.register(i._terminal.onBlur((function(){return i._clearLiveRegion()}))),i.register(i._renderService.onDimensionsChange((function(){return i._refreshRowsDimensions()}))),i._screenDprMonitor=new c.ScreenDprMonitor(window),i.register(i._screenDprMonitor),i._screenDprMonitor.setListener((function(){return i._refreshRowsDimensions()})),i.register((0,g.addDisposableDomListener)(window,"resize",(function(){return i._refreshRowsDimensions()}))),i._refreshRows(),i.register((0,u.toDisposable)((function(){i._accessibilityContainer.remove(),i._rowElements.length=0}))),i}return f(r,[{key:"_handleTab",value:function(e){for(var t=0;t<e;t++)this._handleChar(" ")}},{key:"_handleChar",value:function(e){var t=this;this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==e&&(this._charsToAnnounce+=e):this._charsToAnnounce+=e,"\n"===e&&(this._liveRegionLineCount++,21===this._liveRegionLineCount&&(this._liveRegion.textContent+=a.tooMuchOutput)),s.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout((function(){t._accessibilityContainer.appendChild(t._liveRegion)}),0))}},{key:"_clearLiveRegion",value:function(){this._liveRegion.textContent="",this._liveRegionLineCount=0,s.isMac&&this._liveRegion.remove()}},{key:"_handleKey",value:function(e){this._clearLiveRegion(),/[\0-\x1F\x7F-\x9F]/.test(e)||this._charsToConsume.push(e)}},{key:"_refreshRows",value:function(e,t){this._liveRegionDebouncer.refresh(e,t,this._terminal.rows)}},{key:"_renderRows",value:function(e,t){for(var r=this._terminal.buffer,n=r.lines.length.toString(),i=e;i<=t;i++){var a=r.translateBufferLineToString(r.ydisp+i,!0),s=(r.ydisp+i+1).toString(),o=this._rowElements[i];o&&(0===a.length?o.innerText="\xa0":o.textContent=a,o.setAttribute("aria-posinset",s),o.setAttribute("aria-setsize",n))}this._announceCharacters()}},{key:"_announceCharacters",value:function(){0!==this._charsToAnnounce.length&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}},{key:"_handleBoundaryFocus",value:function(e,t){var r=e.target,n=this._rowElements[0===t?1:this._rowElements.length-2];if(r.getAttribute("aria-posinset")!==(0===t?"1":"".concat(this._terminal.buffer.lines.length))&&e.relatedTarget===n){var i,a;if(0===t?(i=r,a=this._rowElements.pop(),this._rowContainer.removeChild(a)):(i=this._rowElements.shift(),a=r,this._rowContainer.removeChild(i)),i.removeEventListener("focus",this._topBoundaryFocusListener),a.removeEventListener("focus",this._bottomBoundaryFocusListener),0===t){var s=this._createAccessibilityTreeNode();this._rowElements.unshift(s),this._rowContainer.insertAdjacentElement("afterbegin",s)}else{var o=this._createAccessibilityTreeNode();this._rowElements.push(o),this._rowContainer.appendChild(o)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(0===t?-1:1),this._rowElements[0===t?1:this._rowElements.length-2].focus(),e.preventDefault(),e.stopImmediatePropagation()}}},{key:"_handleResize",value:function(e){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(var t=this._rowContainer.children.length;t<this._terminal.rows;t++)this._rowElements[t]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[t]);for(;this._rowElements.length>e;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}},{key:"_createAccessibilityTreeNode",value:function(){var e=document.createElement("div");return e.setAttribute("role","listitem"),e.tabIndex=-1,this._refreshRowDimensions(e),e}},{key:"_refreshRowsDimensions",value:function(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width="".concat(this._renderService.dimensions.css.canvas.width,"px"),this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(var e=0;e<this._terminal.rows;e++)this._refreshRowDimensions(this._rowElements[e])}}},{key:"_refreshRowDimensions",value:function(e){e.style.height="".concat(this._renderService.dimensions.css.cell.height,"px")}}]),r}(u.Disposable);t.AccessibilityManager=y=n([i(1,l.IRenderService)],y)},3614:function(e,t){function r(e){return e.replace(/\r?\n/g,"\r")}function n(e,t){return t?"\x1b[200~"+e+"\x1b[201~":e}function i(e,t,i,a){e=n(e=r(e),i.decPrivateModes.bracketedPasteMode&&!0!==a.rawOptions.ignoreBracketedPasteMode),i.triggerDataEvent(e,!0),t.value=""}function a(e,t,r){var n=r.getBoundingClientRect(),i=e.clientX-n.left-10,a=e.clientY-n.top-10;t.style.width="20px",t.style.height="20px",t.style.left="".concat(i,"px"),t.style.top="".concat(a,"px"),t.style.zIndex="1000",t.focus()}Object.defineProperty(t,"__esModule",{value:!0}),t.rightClickHandler=t.moveTextAreaUnderMouseCursor=t.paste=t.handlePasteEvent=t.copyHandler=t.bracketTextForPaste=t.prepareTextForTerminal=void 0,t.prepareTextForTerminal=r,t.bracketTextForPaste=n,t.copyHandler=function(e,t){e.clipboardData&&e.clipboardData.setData("text/plain",t.selectionText),e.preventDefault()},t.handlePasteEvent=function(e,t,r,n){e.stopPropagation(),e.clipboardData&&i(e.clipboardData.getData("text/plain"),t,r,n)},t.paste=i,t.moveTextAreaUnderMouseCursor=a,t.rightClickHandler=function(e,t,r,n,i){a(e,t,r),i&&n.rightClickSelect(e),t.value=n.selectionText,t.select()}},7239:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ColorContrastCache=void 0;var n=r(1505);t.ColorContrastCache=function(){function e(){h(this,e),this._color=new n.TwoKeyMap,this._css=new n.TwoKeyMap}return f(e,[{key:"setCss",value:function(e,t,r){this._css.set(e,t,r)}},{key:"getCss",value:function(e,t){return this._css.get(e,t)}},{key:"setColor",value:function(e,t,r){this._color.set(e,t,r)}},{key:"getColor",value:function(e,t){return this._color.get(e,t)}},{key:"clear",value:function(){this._color.clear(),this._css.clear()}}]),e}()},3656:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.addDisposableDomListener=void 0,t.addDisposableDomListener=function(e,t,r,n){e.addEventListener(t,r,n);var i=!1;return{dispose:function(){i||(i=!0,e.removeEventListener(t,r,n))}}}},6465:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Linkifier2=void 0;var a=r(3656),s=r(8460),o=r(844),u=r(2585),d=t.Linkifier2=function(e){p(r,e);var t=v(r);function r(e){var n;return h(this,r),(n=t.call(this))._bufferService=e,n._linkProviders=[],n._linkCacheDisposables=[],n._isMouseOut=!0,n._wasResized=!1,n._activeLine=-1,n._onShowLinkUnderline=n.register(new s.EventEmitter),n.onShowLinkUnderline=n._onShowLinkUnderline.event,n._onHideLinkUnderline=n.register(new s.EventEmitter),n.onHideLinkUnderline=n._onHideLinkUnderline.event,n.register((0,o.getDisposeArrayDisposable)(n._linkCacheDisposables)),n.register((0,o.toDisposable)((function(){n._lastMouseEvent=void 0}))),n.register(n._bufferService.onResize((function(){n._clearCurrentLink(),n._wasResized=!0}))),n}return f(r,[{key:"currentLink",get:function(){return this._currentLink}},{key:"registerLinkProvider",value:function(e){var t=this;return this._linkProviders.push(e),{dispose:function(){var r=t._linkProviders.indexOf(e);-1!==r&&t._linkProviders.splice(r,1)}}}},{key:"attachToDom",value:function(e,t,r){var n=this;this._element=e,this._mouseService=t,this._renderService=r,this.register((0,a.addDisposableDomListener)(this._element,"mouseleave",(function(){n._isMouseOut=!0,n._clearCurrentLink()}))),this.register((0,a.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,a.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,a.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}},{key:"_handleMouseMove",value:function(e){if(this._lastMouseEvent=e,this._element&&this._mouseService){var t=this._positionFromMouseEvent(e,this._element,this._mouseService);if(t){this._isMouseOut=!1;for(var r=e.composedPath(),n=0;n<r.length;n++){var i=r[n];if(i.classList.contains("xterm"))break;if(i.classList.contains("xterm-hover"))return}this._lastBufferCell&&t.x===this._lastBufferCell.x&&t.y===this._lastBufferCell.y||(this._handleHover(t),this._lastBufferCell=t)}}}},{key:"_handleHover",value:function(e){if(this._activeLine!==e.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(e,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,e)||(this._clearCurrentLink(),this._askForLink(e,!0))}},{key:"_askForLink",value:function(e,t){var r,n,i=this;this._activeProviderReplies&&t||(null===(r=this._activeProviderReplies)||void 0===r||r.forEach((function(e){null==e||e.forEach((function(e){e.link.dispose&&e.link.dispose()}))})),this._activeProviderReplies=new Map,this._activeLine=e.y);var a,s=!1,o=l(this._linkProviders.entries());try{var u=function(){var r=c(a.value,2),o=r[0],u=r[1];t?(null===(n=i._activeProviderReplies)||void 0===n?void 0:n.get(o))&&(s=i._checkLinkProviderResult(o,e,s)):u.provideLinks(e.y,(function(t){var r,n;if(!i._isMouseOut){var a=null==t?void 0:t.map((function(e){return{link:e}}));null===(r=i._activeProviderReplies)||void 0===r||r.set(o,a),s=i._checkLinkProviderResult(o,e,s),(null===(n=i._activeProviderReplies)||void 0===n?void 0:n.size)===i._linkProviders.length&&i._removeIntersectingLinks(e.y,i._activeProviderReplies)}}))};for(o.s();!(a=o.n()).done;)u()}catch(h){o.e(h)}finally{o.f()}}},{key:"_removeIntersectingLinks",value:function(e,t){for(var r=new Set,n=0;n<t.size;n++){var i=t.get(n);if(i)for(var a=0;a<i.length;a++)for(var s=i[a],o=s.link.range.start.y<e?0:s.link.range.start.x,u=s.link.range.end.y>e?this._bufferService.cols:s.link.range.end.x,c=o;c<=u;c++){if(r.has(c)){i.splice(a--,1);break}r.add(c)}}}},{key:"_checkLinkProviderResult",value:function(e,t,r){var n,i=this;if(!this._activeProviderReplies)return r;for(var a=this._activeProviderReplies.get(e),s=!1,o=0;o<e;o++)this._activeProviderReplies.has(o)&&!this._activeProviderReplies.get(o)||(s=!0);if(!s&&a){var u=a.find((function(e){return i._linkAtPosition(e.link,t)}));u&&(r=!0,this._handleNewLink(u))}if(this._activeProviderReplies.size===this._linkProviders.length&&!r)for(var c=0;c<this._activeProviderReplies.size;c++){var l=null===(n=this._activeProviderReplies.get(c))||void 0===n?void 0:n.find((function(e){return i._linkAtPosition(e.link,t)}));if(l){r=!0,this._handleNewLink(l);break}}return r}},{key:"_handleMouseDown",value:function(){this._mouseDownLink=this._currentLink}},{key:"_handleMouseUp",value:function(e){if(this._element&&this._mouseService&&this._currentLink){var t=this._positionFromMouseEvent(e,this._element,this._mouseService);t&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,t)&&this._currentLink.link.activate(e,this._currentLink.link.text)}}},{key:"_clearCurrentLink",value:function(e,t){this._element&&this._currentLink&&this._lastMouseEvent&&(!e||!t||this._currentLink.link.range.start.y>=e&&this._currentLink.link.range.end.y<=t)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,o.disposeArray)(this._linkCacheDisposables))}},{key:"_handleNewLink",value:function(e){var t=this;if(this._element&&this._lastMouseEvent&&this._mouseService){var r=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);r&&this._linkAtPosition(e.link,r)&&(this._currentLink=e,this._currentLink.state={decorations:{underline:void 0===e.link.decorations||e.link.decorations.underline,pointerCursor:void 0===e.link.decorations||e.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,e.link,this._lastMouseEvent),e.link.decorations={},Object.defineProperties(e.link.decorations,{pointerCursor:{get:function(){var e,r;return null===(r=null===(e=t._currentLink)||void 0===e?void 0:e.state)||void 0===r?void 0:r.decorations.pointerCursor},set:function(e){var r,n;(null===(r=t._currentLink)||void 0===r?void 0:r.state)&&t._currentLink.state.decorations.pointerCursor!==e&&(t._currentLink.state.decorations.pointerCursor=e,t._currentLink.state.isHovered&&(null===(n=t._element)||void 0===n||n.classList.toggle("xterm-cursor-pointer",e)))}},underline:{get:function(){var e,r;return null===(r=null===(e=t._currentLink)||void 0===e?void 0:e.state)||void 0===r?void 0:r.decorations.underline},set:function(r){var n,i,a;(null===(n=t._currentLink)||void 0===n?void 0:n.state)&&(null===(a=null===(i=t._currentLink)||void 0===i?void 0:i.state)||void 0===a?void 0:a.decorations.underline)!==r&&(t._currentLink.state.decorations.underline=r,t._currentLink.state.isHovered&&t._fireUnderlineEvent(e.link,r))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange((function(e){if(t._currentLink){var r=0===e.start?0:e.start+1+t._bufferService.buffer.ydisp,n=t._bufferService.buffer.ydisp+1+e.end;if(t._currentLink.link.range.start.y>=r&&t._currentLink.link.range.end.y<=n&&(t._clearCurrentLink(r,n),t._lastMouseEvent&&t._element)){var i=t._positionFromMouseEvent(t._lastMouseEvent,t._element,t._mouseService);i&&t._askForLink(i,!1)}}}))))}}},{key:"_linkHover",value:function(e,t,r){var n;(null===(n=this._currentLink)||void 0===n?void 0:n.state)&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(t,!0),this._currentLink.state.decorations.pointerCursor&&e.classList.add("xterm-cursor-pointer")),t.hover&&t.hover(r,t.text)}},{key:"_fireUnderlineEvent",value:function(e,t){var r=e.range,n=this._bufferService.buffer.ydisp,i=this._createLinkUnderlineEvent(r.start.x-1,r.start.y-n-1,r.end.x,r.end.y-n-1,void 0);(t?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(i)}},{key:"_linkLeave",value:function(e,t,r){var n;(null===(n=this._currentLink)||void 0===n?void 0:n.state)&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(t,!1),this._currentLink.state.decorations.pointerCursor&&e.classList.remove("xterm-cursor-pointer")),t.leave&&t.leave(r,t.text)}},{key:"_linkAtPosition",value:function(e,t){var r=e.range.start.y*this._bufferService.cols+e.range.start.x,n=e.range.end.y*this._bufferService.cols+e.range.end.x,i=t.y*this._bufferService.cols+t.x;return r<=i&&i<=n}},{key:"_positionFromMouseEvent",value:function(e,t,r){var n=r.getCoords(e,t,this._bufferService.cols,this._bufferService.rows);if(n)return{x:n[0],y:n[1]+this._bufferService.buffer.ydisp}}},{key:"_createLinkUnderlineEvent",value:function(e,t,r,n,i){return{x1:e,y1:t,x2:r,y2:n,cols:this._bufferService.cols,fg:i}}}]),r}(o.Disposable);t.Linkifier2=d=n([i(0,u.IBufferService)],d)},9042:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.tooMuchOutput=t.promptLabel=void 0,t.promptLabel="Terminal input",t.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OscLinkProvider=void 0;var a=r(511),s=r(2585),o=t.OscLinkProvider=function(){function e(t,r,n){h(this,e),this._bufferService=t,this._optionsService=r,this._oscLinkService=n}return f(e,[{key:"provideLinks",value:function(e,t){var r,n=this._bufferService.buffer.lines.get(e-1);if(n){for(var i=[],s=this._optionsService.rawOptions.linkHandler,o=new a.CellData,c=n.getTrimmedLength(),l=-1,h=-1,f=!1,d=0;d<c;d++)if(-1!==h||n.hasContent(d)){if(n.loadCell(d,o),o.hasExtendedAttrs()&&o.extended.urlId){if(-1===h){h=d,l=o.extended.urlId;continue}f=o.extended.urlId!==l}else-1!==h&&(f=!0);if(f||-1!==h&&d===c-1){var p=null===(r=this._oscLinkService.getLinkData(l))||void 0===r?void 0:r.uri;if(p){var v={start:{x:h+1,y:e},end:{x:d+(f||d!==c-1?0:1),y:e}},g=!1;if(!(null==s?void 0:s.allowNonHttpProtocols))try{var y=new URL(p);["http:","https:"].includes(y.protocol)||(g=!0)}catch(e){g=!0}g||i.push({text:p,range:v,activate:function(e,t){return s?s.activate(e,t,v):u(0,t)},hover:function(e,t){var r;return null===(r=null==s?void 0:s.hover)||void 0===r?void 0:r.call(s,e,t,v)},leave:function(e,t){var r;return null===(r=null==s?void 0:s.leave)||void 0===r?void 0:r.call(s,e,t,v)}})}f=!1,o.hasExtendedAttrs()&&o.extended.urlId?(h=d,l=o.extended.urlId):(h=-1,l=-1)}}t(i)}else t(void 0)}}]),e}();function u(e,t){if(confirm("Do you want to navigate to ".concat(t,"?\n\nWARNING: This link could potentially be dangerous"))){var r=window.open();if(r){try{r.opener=null}catch(e){}r.location.href=t}else console.warn("Opening link blocked as opener could not be cleared")}}t.OscLinkProvider=o=n([i(0,s.IBufferService),i(1,s.IOptionsService),i(2,s.IOscLinkService)],o)},6193:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.RenderDebouncer=void 0,t.RenderDebouncer=function(){function e(t,r){h(this,e),this._parentWindow=t,this._renderCallback=r,this._refreshCallbacks=[]}return f(e,[{key:"dispose",value:function(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}},{key:"addRefreshCallback",value:function(e){var t=this;return this._refreshCallbacks.push(e),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame((function(){return t._innerRefresh()}))),this._animationFrame}},{key:"refresh",value:function(e,t,r){var n=this;this._rowCount=r,e=void 0!==e?e:0,t=void 0!==t?t:this._rowCount-1,this._rowStart=void 0!==this._rowStart?Math.min(this._rowStart,e):e,this._rowEnd=void 0!==this._rowEnd?Math.max(this._rowEnd,t):t,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame((function(){return n._innerRefresh()})))}},{key:"_innerRefresh",value:function(){if(this._animationFrame=void 0,void 0!==this._rowStart&&void 0!==this._rowEnd&&void 0!==this._rowCount){var e=Math.max(this._rowStart,0),t=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(e,t),this._runRefreshCallbacks()}else this._runRefreshCallbacks()}},{key:"_runRefreshCallbacks",value:function(){var e,t=l(this._refreshCallbacks);try{for(t.s();!(e=t.n()).done;)(0,e.value)(0)}catch(r){t.e(r)}finally{t.f()}this._refreshCallbacks=[]}}]),e}()},5596:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ScreenDprMonitor=void 0;var n=r(844),i=function(e){p(r,e);var t=v(r);function r(e){var i;return h(this,r),(i=t.call(this))._parentWindow=e,i._currentDevicePixelRatio=i._parentWindow.devicePixelRatio,i.register((0,n.toDisposable)((function(){i.clearListener()}))),i}return f(r,[{key:"setListener",value:function(e){var t=this;this._listener&&this.clearListener(),this._listener=e,this._outerListener=function(){t._listener&&(t._listener(t._parentWindow.devicePixelRatio,t._currentDevicePixelRatio),t._updateDpr())},this._updateDpr()}},{key:"_updateDpr",value:function(){var e;this._outerListener&&(null===(e=this._resolutionMediaMatchList)||void 0===e||e.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia("screen and (resolution: ".concat(this._parentWindow.devicePixelRatio,"dppx)")),this._resolutionMediaMatchList.addListener(this._outerListener))}},{key:"clearListener",value:function(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}]),r}(n.Disposable);t.ScreenDprMonitor=i},3236:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Terminal=void 0;var n=r(3614),i=r(3656),a=r(6465),c=r(9042),d=r(3730),g=r(1680),y=r(3107),m=r(5744),b=r(2950),_=r(1296),w=r(428),k=r(4269),x=r(5114),E=r(8934),S=r(3230),C=r(9312),A=r(4725),D=r(6731),R=r(8055),T=r(8969),Z=r(8460),I=r(844),P=r(6114),L=r(8437),M=r(2584),B=r(7399),O=r(5941),N=r(9074),F=r(2585),U=r(5435),z=r(4567),j="undefined"!=typeof window?window.document:null,H=function(e){p(r,e);var t=v(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return h(this,r),(e=t.call(this,n)).browser=P,e._keyDownHandled=!1,e._keyDownSeen=!1,e._keyPressHandled=!1,e._unprocessedDeadKey=!1,e._accessibilityManager=e.register(new I.MutableDisposable),e._onCursorMove=e.register(new Z.EventEmitter),e.onCursorMove=e._onCursorMove.event,e._onKey=e.register(new Z.EventEmitter),e.onKey=e._onKey.event,e._onRender=e.register(new Z.EventEmitter),e.onRender=e._onRender.event,e._onSelectionChange=e.register(new Z.EventEmitter),e.onSelectionChange=e._onSelectionChange.event,e._onTitleChange=e.register(new Z.EventEmitter),e.onTitleChange=e._onTitleChange.event,e._onBell=e.register(new Z.EventEmitter),e.onBell=e._onBell.event,e._onFocus=e.register(new Z.EventEmitter),e._onBlur=e.register(new Z.EventEmitter),e._onA11yCharEmitter=e.register(new Z.EventEmitter),e._onA11yTabEmitter=e.register(new Z.EventEmitter),e._onWillOpen=e.register(new Z.EventEmitter),e._setup(),e.linkifier2=e.register(e._instantiationService.createInstance(a.Linkifier2)),e.linkifier2.registerLinkProvider(e._instantiationService.createInstance(d.OscLinkProvider)),e._decorationService=e._instantiationService.createInstance(N.DecorationService),e._instantiationService.setService(F.IDecorationService,e._decorationService),e.register(e._inputHandler.onRequestBell((function(){return e._onBell.fire()}))),e.register(e._inputHandler.onRequestRefreshRows((function(t,r){return e.refresh(t,r)}))),e.register(e._inputHandler.onRequestSendFocus((function(){return e._reportFocus()}))),e.register(e._inputHandler.onRequestReset((function(){return e.reset()}))),e.register(e._inputHandler.onRequestWindowsOptionsReport((function(t){return e._reportWindowsOptions(t)}))),e.register(e._inputHandler.onColor((function(t){return e._handleColorEvent(t)}))),e.register((0,Z.forwardEvent)(e._inputHandler.onCursorMove,e._onCursorMove)),e.register((0,Z.forwardEvent)(e._inputHandler.onTitleChange,e._onTitleChange)),e.register((0,Z.forwardEvent)(e._inputHandler.onA11yChar,e._onA11yCharEmitter)),e.register((0,Z.forwardEvent)(e._inputHandler.onA11yTab,e._onA11yTabEmitter)),e.register(e._bufferService.onResize((function(t){return e._afterResize(t.cols,t.rows)}))),e.register((0,I.toDisposable)((function(){var t,r;e._customKeyEventHandler=void 0,null===(r=null===(t=e.element)||void 0===t?void 0:t.parentNode)||void 0===r||r.removeChild(e.element)}))),e}return f(r,[{key:"onFocus",get:function(){return this._onFocus.event}},{key:"onBlur",get:function(){return this._onBlur.event}},{key:"onA11yChar",get:function(){return this._onA11yCharEmitter.event}},{key:"onA11yTab",get:function(){return this._onA11yTabEmitter.event}},{key:"onWillOpen",get:function(){return this._onWillOpen.event}},{key:"_handleColorEvent",value:function(e){var t=this;if(this._themeService){var r,n=l(e);try{var i=function(){var e,n=r.value,i="";switch(n.index){case 256:e="foreground",i="10";break;case 257:e="background",i="11";break;case 258:e="cursor",i="12";break;default:e="ansi",i="4;"+n.index}switch(n.type){case 0:var a=R.color.toColorRGB("ansi"===e?t._themeService.colors.ansi[n.index]:t._themeService.colors[e]);t.coreService.triggerDataEvent("".concat(M.C0.ESC,"]").concat(i,";").concat((0,O.toRgbString)(a)).concat(M.C1_ESCAPED.ST));break;case 1:if("ansi"===e)t._themeService.modifyColors((function(e){var t;return e.ansi[n.index]=(t=R.rgba).toColor.apply(t,s(n.color))}));else{var o=e;t._themeService.modifyColors((function(e){var t;return e[o]=(t=R.rgba).toColor.apply(t,s(n.color))}))}break;case 2:t._themeService.restoreColor(n.index)}};for(n.s();!(r=n.n()).done;)i()}catch(a){n.e(a)}finally{n.f()}}}},{key:"_setup",value:function(){o(u(r.prototype),"_setup",this).call(this),this._customKeyEventHandler=void 0}},{key:"buffer",get:function(){return this.buffers.active}},{key:"focus",value:function(){this.textarea&&this.textarea.focus({preventScroll:!0})}},{key:"_handleScreenReaderModeOptionChange",value:function(e){e?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(z.AccessibilityManager,this)):this._accessibilityManager.clear()}},{key:"_handleTextAreaFocus",value:function(e){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(M.C0.ESC+"[I"),this.updateCursorStyle(e),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}},{key:"blur",value:function(){var e;return null===(e=this.textarea)||void 0===e?void 0:e.blur()}},{key:"_handleTextAreaBlur",value:function(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(M.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}},{key:"_syncTextArea",value:function(){if(this.textarea&&this.buffer.isCursorInViewport&&!this._compositionHelper.isComposing&&this._renderService){var e=this.buffer.ybase+this.buffer.y,t=this.buffer.lines.get(e);if(t){var r=Math.min(this.buffer.x,this.cols-1),n=this._renderService.dimensions.css.cell.height,i=t.getWidth(r),a=this._renderService.dimensions.css.cell.width*i,s=this.buffer.y*this._renderService.dimensions.css.cell.height,o=r*this._renderService.dimensions.css.cell.width;this.textarea.style.left=o+"px",this.textarea.style.top=s+"px",this.textarea.style.width=a+"px",this.textarea.style.height=n+"px",this.textarea.style.lineHeight=n+"px",this.textarea.style.zIndex="-5"}}}},{key:"_initGlobal",value:function(){var e=this;this._bindKeys(),this.register((0,i.addDisposableDomListener)(this.element,"copy",(function(t){e.hasSelection()&&(0,n.copyHandler)(t,e._selectionService)})));var t=function(t){return(0,n.handlePasteEvent)(t,e.textarea,e.coreService,e.optionsService)};this.register((0,i.addDisposableDomListener)(this.textarea,"paste",t)),this.register((0,i.addDisposableDomListener)(this.element,"paste",t)),P.isFirefox?this.register((0,i.addDisposableDomListener)(this.element,"mousedown",(function(t){2===t.button&&(0,n.rightClickHandler)(t,e.textarea,e.screenElement,e._selectionService,e.options.rightClickSelectsWord)}))):this.register((0,i.addDisposableDomListener)(this.element,"contextmenu",(function(t){(0,n.rightClickHandler)(t,e.textarea,e.screenElement,e._selectionService,e.options.rightClickSelectsWord)}))),P.isLinux&&this.register((0,i.addDisposableDomListener)(this.element,"auxclick",(function(t){1===t.button&&(0,n.moveTextAreaUnderMouseCursor)(t,e.textarea,e.screenElement)})))}},{key:"_bindKeys",value:function(){var e=this;this.register((0,i.addDisposableDomListener)(this.textarea,"keyup",(function(t){return e._keyUp(t)}),!0)),this.register((0,i.addDisposableDomListener)(this.textarea,"keydown",(function(t){return e._keyDown(t)}),!0)),this.register((0,i.addDisposableDomListener)(this.textarea,"keypress",(function(t){return e._keyPress(t)}),!0)),this.register((0,i.addDisposableDomListener)(this.textarea,"compositionstart",(function(){return e._compositionHelper.compositionstart()}))),this.register((0,i.addDisposableDomListener)(this.textarea,"compositionupdate",(function(t){return e._compositionHelper.compositionupdate(t)}))),this.register((0,i.addDisposableDomListener)(this.textarea,"compositionend",(function(){return e._compositionHelper.compositionend()}))),this.register((0,i.addDisposableDomListener)(this.textarea,"input",(function(t){return e._inputEvent(t)}),!0)),this.register(this.onRender((function(){return e._compositionHelper.updateCompositionElements()})))}},{key:"open",value:function(e){var t,r=this;if(!e)throw new Error("Terminal requires a parent element.");e.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=e.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),e.appendChild(this.element);var n=j.createDocumentFragment();this._viewportElement=j.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),n.appendChild(this._viewportElement),this._viewportScrollArea=j.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=j.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=j.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),n.appendChild(this.screenElement),this.textarea=j.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",c.promptLabel),P.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(x.CoreBrowserService,this.textarea,null!==(t=this._document.defaultView)&&void 0!==t?t:window),this._instantiationService.setService(A.ICoreBrowserService,this._coreBrowserService),this.register((0,i.addDisposableDomListener)(this.textarea,"focus",(function(e){return r._handleTextAreaFocus(e)}))),this.register((0,i.addDisposableDomListener)(this.textarea,"blur",(function(){return r._handleTextAreaBlur()}))),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(w.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(A.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(D.ThemeService),this._instantiationService.setService(A.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(k.CharacterJoinerService),this._instantiationService.setService(A.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(S.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(A.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange((function(e){return r._onRender.fire(e)}))),this.onResize((function(e){return r._renderService.resize(e.cols,e.rows)})),this._compositionView=j.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(b.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(n);try{this._onWillOpen.fire(this.element)}catch(e){}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(E.MouseService),this._instantiationService.setService(A.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(g.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines((function(e){return r.scrollLines(e.amount,e.suppressScrollEvent,1)})),this.register(this._inputHandler.onRequestSyncScrollBar((function(){return r.viewport.syncScrollArea()}))),this.register(this.viewport),this.register(this.onCursorMove((function(){r._renderService.handleCursorMove(),r._syncTextArea()}))),this.register(this.onResize((function(){return r._renderService.handleResize(r.cols,r.rows)}))),this.register(this.onBlur((function(){return r._renderService.handleBlur()}))),this.register(this.onFocus((function(){return r._renderService.handleFocus()}))),this.register(this._renderService.onDimensionsChange((function(){return r.viewport.syncScrollArea()}))),this._selectionService=this.register(this._instantiationService.createInstance(C.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(A.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines((function(e){return r.scrollLines(e.amount,e.suppressScrollEvent)}))),this.register(this._selectionService.onSelectionChange((function(){return r._onSelectionChange.fire()}))),this.register(this._selectionService.onRequestRedraw((function(e){return r._renderService.handleSelectionChanged(e.start,e.end,e.columnSelectMode)}))),this.register(this._selectionService.onLinuxMouseSelection((function(e){r.textarea.value=e,r.textarea.focus(),r.textarea.select()}))),this.register(this._onScroll.event((function(e){r.viewport.syncScrollArea(),r._selectionService.refresh()}))),this.register((0,i.addDisposableDomListener)(this._viewportElement,"scroll",(function(){return r._selectionService.refresh()}))),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(y.BufferDecorationRenderer,this.screenElement)),this.register((0,i.addDisposableDomListener)(this.element,"mousedown",(function(e){return r._selectionService.handleMouseDown(e)}))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(z.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",(function(e){return r._handleScreenReaderModeOptionChange(e)}))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(m.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",(function(e){!r._overviewRulerRenderer&&e&&r._viewportElement&&r.screenElement&&(r._overviewRulerRenderer=r.register(r._instantiationService.createInstance(m.OverviewRulerRenderer,r._viewportElement,r.screenElement)))})),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}},{key:"_createRenderer",value:function(){return this._instantiationService.createInstance(_.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}},{key:"bindMouse",value:function(){var e=this,t=this,r=this.element;function n(e){var r,n,i=t._mouseService.getMouseReportCoords(e,t.screenElement);if(!i)return!1;switch(e.overrideType||e.type){case"mousemove":n=32,void 0===e.buttons?(r=3,void 0!==e.button&&(r=e.button<3?e.button:3)):r=1&e.buttons?0:4&e.buttons?1:2&e.buttons?2:3;break;case"mouseup":n=0,r=e.button<3?e.button:3;break;case"mousedown":n=1,r=e.button<3?e.button:3;break;case"wheel":if(0===t.viewport.getLinesScrolled(e))return!1;n=e.deltaY<0?0:1,r=4;break;default:return!1}return!(void 0===n||void 0===r||r>4)&&t.coreMouseService.triggerMouseEvent({col:i.col,row:i.row,x:i.x,y:i.y,button:r,action:n,ctrl:e.ctrlKey,alt:e.altKey,shift:e.shiftKey})}var a={mouseup:null,wheel:null,mousedrag:null,mousemove:null},s={mouseup:function(t){return n(t),t.buttons||(e._document.removeEventListener("mouseup",a.mouseup),a.mousedrag&&e._document.removeEventListener("mousemove",a.mousedrag)),e.cancel(t)},wheel:function(t){return n(t),e.cancel(t,!0)},mousedrag:function(e){e.buttons&&n(e)},mousemove:function(e){e.buttons||n(e)}};this.register(this.coreMouseService.onProtocolChange((function(t){t?("debug"===e.optionsService.rawOptions.logLevel&&e._logService.debug("Binding to mouse events:",e.coreMouseService.explainEvents(t)),e.element.classList.add("enable-mouse-events"),e._selectionService.disable()):(e._logService.debug("Unbinding from mouse events."),e.element.classList.remove("enable-mouse-events"),e._selectionService.enable()),8&t?a.mousemove||(r.addEventListener("mousemove",s.mousemove),a.mousemove=s.mousemove):(r.removeEventListener("mousemove",a.mousemove),a.mousemove=null),16&t?a.wheel||(r.addEventListener("wheel",s.wheel,{passive:!1}),a.wheel=s.wheel):(r.removeEventListener("wheel",a.wheel),a.wheel=null),2&t?a.mouseup||(r.addEventListener("mouseup",s.mouseup),a.mouseup=s.mouseup):(e._document.removeEventListener("mouseup",a.mouseup),r.removeEventListener("mouseup",a.mouseup),a.mouseup=null),4&t?a.mousedrag||(a.mousedrag=s.mousedrag):(e._document.removeEventListener("mousemove",a.mousedrag),a.mousedrag=null)}))),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,i.addDisposableDomListener)(r,"mousedown",(function(t){if(t.preventDefault(),e.focus(),e.coreMouseService.areMouseEventsActive&&!e._selectionService.shouldForceSelection(t))return n(t),a.mouseup&&e._document.addEventListener("mouseup",a.mouseup),a.mousedrag&&e._document.addEventListener("mousemove",a.mousedrag),e.cancel(t)}))),this.register((0,i.addDisposableDomListener)(r,"wheel",(function(t){if(!a.wheel){if(!e.buffer.hasScrollback){var r=e.viewport.getLinesScrolled(t);if(0===r)return;for(var n=M.C0.ESC+(e.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(t.deltaY<0?"A":"B"),i="",s=0;s<Math.abs(r);s++)i+=n;return e.coreService.triggerDataEvent(i,!0),e.cancel(t,!0)}return e.viewport.handleWheel(t)?e.cancel(t):void 0}}),{passive:!1})),this.register((0,i.addDisposableDomListener)(r,"touchstart",(function(t){if(!e.coreMouseService.areMouseEventsActive)return e.viewport.handleTouchStart(t),e.cancel(t)}),{passive:!0})),this.register((0,i.addDisposableDomListener)(r,"touchmove",(function(t){if(!e.coreMouseService.areMouseEventsActive)return e.viewport.handleTouchMove(t)?void 0:e.cancel(t)}),{passive:!1}))}},{key:"refresh",value:function(e,t){var r;null===(r=this._renderService)||void 0===r||r.refreshRows(e,t)}},{key:"updateCursorStyle",value:function(e){var t;(null===(t=this._selectionService)||void 0===t?void 0:t.shouldColumnSelect(e))?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}},{key:"_showCursor",value:function(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}},{key:"scrollLines",value:function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;1===i?(o(u(r.prototype),"scrollLines",this).call(this,e,t,i),this.refresh(0,this.rows-1)):null===(n=this.viewport)||void 0===n||n.scrollLines(e)}},{key:"paste",value:function(e){(0,n.paste)(e,this.textarea,this.coreService,this.optionsService)}},{key:"attachCustomKeyEventHandler",value:function(e){this._customKeyEventHandler=e}},{key:"registerLinkProvider",value:function(e){return this.linkifier2.registerLinkProvider(e)}},{key:"registerCharacterJoiner",value:function(e){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");var t=this._characterJoinerService.register(e);return this.refresh(0,this.rows-1),t}},{key:"deregisterCharacterJoiner",value:function(e){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(e)&&this.refresh(0,this.rows-1)}},{key:"markers",get:function(){return this.buffer.markers}},{key:"registerMarker",value:function(e){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+e)}},{key:"registerDecoration",value:function(e){return this._decorationService.registerDecoration(e)}},{key:"hasSelection",value:function(){return!!this._selectionService&&this._selectionService.hasSelection}},{key:"select",value:function(e,t,r){this._selectionService.setSelection(e,t,r)}},{key:"getSelection",value:function(){return this._selectionService?this._selectionService.selectionText:""}},{key:"getSelectionPosition",value:function(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}},{key:"clearSelection",value:function(){var e;null===(e=this._selectionService)||void 0===e||e.clearSelection()}},{key:"selectAll",value:function(){var e;null===(e=this._selectionService)||void 0===e||e.selectAll()}},{key:"selectLines",value:function(e,t){var r;null===(r=this._selectionService)||void 0===r||r.selectLines(e,t)}},{key:"_keyDown",value:function(e){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&!1===this._customKeyEventHandler(e))return!1;var t=this.browser.isMac&&this.options.macOptionIsMeta&&e.altKey;if(!t&&!this._compositionHelper.keydown(e))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;t||"Dead"!==e.key&&"AltGraph"!==e.key||(this._unprocessedDeadKey=!0);var r=(0,B.evaluateKeyboardEvent)(e,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(e),3===r.type||2===r.type){var n=this.rows-1;return this.scrollLines(2===r.type?-n:n),this.cancel(e,!0)}return 1===r.type&&this.selectAll(),!!this._isThirdLevelShift(this.browser,e)||(r.cancel&&this.cancel(e,!0),!r.key||!!(e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&1===e.key.length&&e.key.charCodeAt(0)>=65&&e.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(r.key!==M.C0.ETX&&r.key!==M.C0.CR||(this.textarea.value=""),this._onKey.fire({key:r.key,domEvent:e}),this._showCursor(),this.coreService.triggerDataEvent(r.key,!0),!this.optionsService.rawOptions.screenReaderMode||e.altKey||e.ctrlKey?this.cancel(e,!0):void(this._keyDownHandled=!0))))}},{key:"_isThirdLevelShift",value:function(e,t){var r=e.isMac&&!this.options.macOptionIsMeta&&t.altKey&&!t.ctrlKey&&!t.metaKey||e.isWindows&&t.altKey&&t.ctrlKey&&!t.metaKey||e.isWindows&&t.getModifierState("AltGraph");return"keypress"===t.type?r:r&&(!t.keyCode||t.keyCode>47)}},{key:"_keyUp",value:function(e){this._keyDownSeen=!1,this._customKeyEventHandler&&!1===this._customKeyEventHandler(e)||(function(e){return 16===e.keyCode||17===e.keyCode||18===e.keyCode}(e)||this.focus(),this.updateCursorStyle(e),this._keyPressHandled=!1)}},{key:"_keyPress",value:function(e){var t;if(this._keyPressHandled=!1,this._keyDownHandled)return!1;if(this._customKeyEventHandler&&!1===this._customKeyEventHandler(e))return!1;if(this.cancel(e),e.charCode)t=e.charCode;else if(null===e.which||void 0===e.which)t=e.keyCode;else{if(0===e.which||0===e.charCode)return!1;t=e.which}return!(!t||(e.altKey||e.ctrlKey||e.metaKey)&&!this._isThirdLevelShift(this.browser,e)||(t=String.fromCharCode(t),this._onKey.fire({key:t,domEvent:e}),this._showCursor(),this.coreService.triggerDataEvent(t,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}},{key:"_inputEvent",value:function(e){if(e.data&&"insertText"===e.inputType&&(!e.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;var t=e.data;return this.coreService.triggerDataEvent(t,!0),this.cancel(e),!0}return!1}},{key:"resize",value:function(e,t){e!==this.cols||t!==this.rows?o(u(r.prototype),"resize",this).call(this,e,t):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}},{key:"_afterResize",value:function(e,t){var r,n;null===(r=this._charSizeService)||void 0===r||r.measure(),null===(n=this.viewport)||void 0===n||n.syncScrollArea(!0)}},{key:"clear",value:function(){var e;if(0!==this.buffer.ybase||0!==this.buffer.y){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(var t=1;t<this.rows;t++)this.buffer.lines.push(this.buffer.getBlankLine(L.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),null===(e=this.viewport)||void 0===e||e.reset(),this.refresh(0,this.rows-1)}}},{key:"reset",value:function(){var e,t;this.options.rows=this.rows,this.options.cols=this.cols;var n=this._customKeyEventHandler;this._setup(),o(u(r.prototype),"reset",this).call(this),null===(e=this._selectionService)||void 0===e||e.reset(),this._decorationService.reset(),null===(t=this.viewport)||void 0===t||t.reset(),this._customKeyEventHandler=n,this.refresh(0,this.rows-1)}},{key:"clearTextureAtlas",value:function(){var e;null===(e=this._renderService)||void 0===e||e.clearTextureAtlas()}},{key:"_reportFocus",value:function(){var e;(null===(e=this.element)||void 0===e?void 0:e.classList.contains("focus"))?this.coreService.triggerDataEvent(M.C0.ESC+"[I"):this.coreService.triggerDataEvent(M.C0.ESC+"[O")}},{key:"_reportWindowsOptions",value:function(e){if(this._renderService)switch(e){case U.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:var t=this._renderService.dimensions.css.canvas.width.toFixed(0),r=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent("".concat(M.C0.ESC,"[4;").concat(r,";").concat(t,"t"));break;case U.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:var n=this._renderService.dimensions.css.cell.width.toFixed(0),i=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent("".concat(M.C0.ESC,"[6;").concat(i,";").concat(n,"t"))}}},{key:"cancel",value:function(e,t){if(this.options.cancelEvents||t)return e.preventDefault(),e.stopPropagation(),!1}}]),r}(T.CoreTerminal);t.Terminal=H},9924:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.TimeBasedDebouncer=void 0,t.TimeBasedDebouncer=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;h(this,e),this._renderCallback=t,this._debounceThresholdMS=r,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}return f(e,[{key:"dispose",value:function(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}},{key:"refresh",value:function(e,t,r){var n=this;this._rowCount=r,e=void 0!==e?e:0,t=void 0!==t?t:this._rowCount-1,this._rowStart=void 0!==this._rowStart?Math.min(this._rowStart,e):e,this._rowEnd=void 0!==this._rowEnd?Math.max(this._rowEnd,t):t;var i=Date.now();if(i-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=i,this._innerRefresh();else if(!this._additionalRefreshRequested){var a=i-this._lastRefreshMs,s=this._debounceThresholdMS-a;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout((function(){n._lastRefreshMs=Date.now(),n._innerRefresh(),n._additionalRefreshRequested=!1,n._refreshTimeoutID=void 0}),s)}}},{key:"_innerRefresh",value:function(){if(void 0!==this._rowStart&&void 0!==this._rowEnd&&void 0!==this._rowCount){var e=Math.max(this._rowStart,0),t=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(e,t)}}}]),e}()},1680:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Viewport=void 0;var a=r(3656),s=r(4725),o=r(8460),u=r(844),c=r(2585),l=t.Viewport=function(e){p(r,e);var t=v(r);function r(e,n,i,s,u,c,l,f){var p;return h(this,r),(p=t.call(this))._viewportElement=e,p._scrollArea=n,p._bufferService=i,p._optionsService=s,p._charSizeService=u,p._renderService=c,p._coreBrowserService=l,p.scrollBarWidth=0,p._currentRowHeight=0,p._currentDeviceCellHeight=0,p._lastRecordedBufferLength=0,p._lastRecordedViewportHeight=0,p._lastRecordedBufferHeight=0,p._lastTouchY=0,p._lastScrollTop=0,p._wheelPartialScroll=0,p._refreshAnimationFrame=null,p._ignoreNextScrollEvent=!1,p._smoothScrollState={startTime:0,origin:-1,target:-1},p._onRequestScrollLines=p.register(new o.EventEmitter),p.onRequestScrollLines=p._onRequestScrollLines.event,p.scrollBarWidth=p._viewportElement.offsetWidth-p._scrollArea.offsetWidth||15,p.register((0,a.addDisposableDomListener)(p._viewportElement,"scroll",p._handleScroll.bind(d(p)))),p._activeBuffer=p._bufferService.buffer,p.register(p._bufferService.buffers.onBufferActivate((function(e){return p._activeBuffer=e.activeBuffer}))),p._renderDimensions=p._renderService.dimensions,p.register(p._renderService.onDimensionsChange((function(e){return p._renderDimensions=e}))),p._handleThemeChange(f.colors),p.register(f.onChangeColors((function(e){return p._handleThemeChange(e)}))),p.register(p._optionsService.onSpecificOptionChange("scrollback",(function(){return p.syncScrollArea()}))),setTimeout((function(){return p.syncScrollArea()})),p}return f(r,[{key:"_handleThemeChange",value:function(e){this._viewportElement.style.backgroundColor=e.background.css}},{key:"reset",value:function(){var e=this;this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame((function(){return e.syncScrollArea()}))}},{key:"_refresh",value:function(e){var t=this;if(e)return this._innerRefresh(),void(null!==this._refreshAnimationFrame&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));null===this._refreshAnimationFrame&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame((function(){return t._innerRefresh()})))}},{key:"_innerRefresh",value:function(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;var e=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==e&&(this._lastRecordedBufferHeight=e,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}var t=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==t&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=t),this._refreshAnimationFrame=null}},{key:"syncScrollArea",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(e);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(e)}},{key:"_handleScroll",value:function(e){if(this._lastScrollTop=this._viewportElement.scrollTop,this._viewportElement.offsetParent){if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});var t=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:t,suppressScrollEvent:!0})}}},{key:"_smoothScroll",value:function(){var e=this;if(!this._isDisposed&&-1!==this._smoothScrollState.origin&&-1!==this._smoothScrollState.target){var t=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(t*(this._smoothScrollState.target-this._smoothScrollState.origin)),t<1?this._coreBrowserService.window.requestAnimationFrame((function(){return e._smoothScroll()})):this._clearSmoothScrollState()}}},{key:"_smoothScrollPercent",value:function(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}},{key:"_clearSmoothScrollState",value:function(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}},{key:"_bubbleScroll",value:function(e,t){var r=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(t<0&&0!==this._viewportElement.scrollTop||t>0&&r<this._lastRecordedBufferHeight)||(e.cancelable&&e.preventDefault(),!1)}},{key:"handleWheel",value:function(e){var t=this._getPixelsScrolled(e);return 0!==t&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,-1===this._smoothScrollState.target?this._smoothScrollState.target=this._viewportElement.scrollTop+t:this._smoothScrollState.target+=t,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=t,this._bubbleScroll(e,t))}},{key:"scrollLines",value:function(e){if(0!==e)if(this._optionsService.rawOptions.smoothScrollDuration){var t=e*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+t,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:e,suppressScrollEvent:!1})}},{key:"_getPixelsScrolled",value:function(e){if(0===e.deltaY||e.shiftKey)return 0;var t=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_LINE?t*=this._currentRowHeight:e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(t*=this._currentRowHeight*this._bufferService.rows),t}},{key:"getBufferElements",value:function(e,t){for(var r,n,i="",a=[],s=null!=t?t:this._bufferService.buffer.lines.length,o=this._bufferService.buffer.lines,u=e;u<s;u++){var c=o.get(u);if(c){var l=null===(r=o.get(u+1))||void 0===r?void 0:r.isWrapped;if(i+=c.translateToString(!l),!l||u===o.length-1){var h=document.createElement("div");h.textContent=i,a.push(h),i.length>0&&(n=h),i=""}}}return{bufferElements:a,cursorElement:n}}},{key:"getLinesScrolled",value:function(e){if(0===e.deltaY||e.shiftKey)return 0;var t=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(t/=this._currentRowHeight+0,this._wheelPartialScroll+=t,t=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(t*=this._bufferService.rows),t}},{key:"_applyScrollModifier",value:function(e,t){var r=this._optionsService.rawOptions.fastScrollModifier;return"alt"===r&&t.altKey||"ctrl"===r&&t.ctrlKey||"shift"===r&&t.shiftKey?e*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:e*this._optionsService.rawOptions.scrollSensitivity}},{key:"handleTouchStart",value:function(e){this._lastTouchY=e.touches[0].pageY}},{key:"handleTouchMove",value:function(e){var t=this._lastTouchY-e.touches[0].pageY;return this._lastTouchY=e.touches[0].pageY,0!==t&&(this._viewportElement.scrollTop+=t,this._bubbleScroll(e,t))}}]),r}(u.Disposable);t.Viewport=l=n([i(2,c.IBufferService),i(3,c.IOptionsService),i(4,s.ICharSizeService),i(5,s.IRenderService),i(6,s.ICoreBrowserService),i(7,s.IThemeService)],l)},3107:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferDecorationRenderer=void 0;var a=r(3656),s=r(4725),o=r(844),u=r(2585),c=t.BufferDecorationRenderer=function(e){p(r,e);var t=v(r);function r(e,n,i,s){var u;return h(this,r),(u=t.call(this))._screenElement=e,u._bufferService=n,u._decorationService=i,u._renderService=s,u._decorationElements=new Map,u._altBufferIsActive=!1,u._dimensionsChanged=!1,u._container=document.createElement("div"),u._container.classList.add("xterm-decoration-container"),u._screenElement.appendChild(u._container),u.register(u._renderService.onRenderedViewportChange((function(){return u._doRefreshDecorations()}))),u.register(u._renderService.onDimensionsChange((function(){u._dimensionsChanged=!0,u._queueRefresh()}))),u.register((0,a.addDisposableDomListener)(window,"resize",(function(){return u._queueRefresh()}))),u.register(u._bufferService.buffers.onBufferActivate((function(){u._altBufferIsActive=u._bufferService.buffer===u._bufferService.buffers.alt}))),u.register(u._decorationService.onDecorationRegistered((function(){return u._queueRefresh()}))),u.register(u._decorationService.onDecorationRemoved((function(e){return u._removeDecoration(e)}))),u.register((0,o.toDisposable)((function(){u._container.remove(),u._decorationElements.clear()}))),u}return f(r,[{key:"_queueRefresh",value:function(){var e=this;void 0===this._animationFrame&&(this._animationFrame=this._renderService.addRefreshCallback((function(){e._doRefreshDecorations(),e._animationFrame=void 0})))}},{key:"_doRefreshDecorations",value:function(){var e,t=l(this._decorationService.decorations);try{for(t.s();!(e=t.n()).done;){var r=e.value;this._renderDecoration(r)}}catch(n){t.e(n)}finally{t.f()}this._dimensionsChanged=!1}},{key:"_renderDecoration",value:function(e){this._refreshStyle(e),this._dimensionsChanged&&this._refreshXPosition(e)}},{key:"_createElement",value:function(e){var t,r,n=document.createElement("div");n.classList.add("xterm-decoration"),n.classList.toggle("xterm-decoration-top-layer","top"===(null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.layer)),n.style.width="".concat(Math.round((e.options.width||1)*this._renderService.dimensions.css.cell.width),"px"),n.style.height=(e.options.height||1)*this._renderService.dimensions.css.cell.height+"px",n.style.top=(e.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",n.style.lineHeight="".concat(this._renderService.dimensions.css.cell.height,"px");var i=null!==(r=e.options.x)&&void 0!==r?r:0;return i&&i>this._bufferService.cols&&(n.style.display="none"),this._refreshXPosition(e,n),n}},{key:"_refreshStyle",value:function(e){var t=this,r=e.marker.line-this._bufferService.buffers.active.ydisp;if(r<0||r>=this._bufferService.rows)e.element&&(e.element.style.display="none",e.onRenderEmitter.fire(e.element));else{var n=this._decorationElements.get(e);n||(n=this._createElement(e),e.element=n,this._decorationElements.set(e,n),this._container.appendChild(n),e.onDispose((function(){t._decorationElements.delete(e),n.remove()}))),n.style.top=r*this._renderService.dimensions.css.cell.height+"px",n.style.display=this._altBufferIsActive?"none":"block",e.onRenderEmitter.fire(n)}}},{key:"_refreshXPosition",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.element;if(r){var n=null!==(t=e.options.x)&&void 0!==t?t:0;"right"===(e.options.anchor||"left")?r.style.right=n?n*this._renderService.dimensions.css.cell.width+"px":"":r.style.left=n?n*this._renderService.dimensions.css.cell.width+"px":""}}},{key:"_removeDecoration",value:function(e){var t;null===(t=this._decorationElements.get(e))||void 0===t||t.remove(),this._decorationElements.delete(e),e.dispose()}}]),r}(o.Disposable);t.BufferDecorationRenderer=c=n([i(1,u.IBufferService),i(2,u.IDecorationService),i(3,s.IRenderService)],c)},5871:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ColorZoneStore=void 0,t.ColorZoneStore=function(){function e(){h(this,e),this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}return f(e,[{key:"zones",get:function(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}},{key:"clear",value:function(){this._zones.length=0,this._zonePoolIndex=0}},{key:"addDecoration",value:function(e){if(e.options.overviewRulerOptions){var t,r=l(this._zones);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.color===e.options.overviewRulerOptions.color&&n.position===e.options.overviewRulerOptions.position){if(this._lineIntersectsZone(n,e.marker.line))return;if(this._lineAdjacentToZone(n,e.marker.line,e.options.overviewRulerOptions.position))return void this._addLineToZone(n,e.marker.line)}}}catch(i){r.e(i)}finally{r.f()}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=e.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=e.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=e.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=e.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:e.options.overviewRulerOptions.color,position:e.options.overviewRulerOptions.position,startBufferLine:e.marker.line,endBufferLine:e.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}},{key:"setPadding",value:function(e){this._linePadding=e}},{key:"_lineIntersectsZone",value:function(e,t){return t>=e.startBufferLine&&t<=e.endBufferLine}},{key:"_lineAdjacentToZone",value:function(e,t,r){return t>=e.startBufferLine-this._linePadding[r||"full"]&&t<=e.endBufferLine+this._linePadding[r||"full"]}},{key:"_addLineToZone",value:function(e,t){e.startBufferLine=Math.min(e.startBufferLine,t),e.endBufferLine=Math.max(e.endBufferLine,t)}}]),e}()},5744:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OverviewRulerRenderer=void 0;var a=r(5871),s=r(3656),o=r(4725),u=r(844),c=r(2585),d={full:0,left:0,center:0,right:0},g={full:0,left:0,center:0,right:0},y={full:0,left:0,center:0,right:0},m=t.OverviewRulerRenderer=function(e){p(r,e);var t=v(r);function r(e,n,i,s,o,c,l){var f,d;h(this,r),(f=t.call(this))._viewportElement=e,f._screenElement=n,f._bufferService=i,f._decorationService=s,f._renderService=o,f._optionsService=c,f._coreBrowseService=l,f._colorZoneStore=new a.ColorZoneStore,f._shouldUpdateDimensions=!0,f._shouldUpdateAnchor=!0,f._lastKnownBufferLength=0,f._canvas=document.createElement("canvas"),f._canvas.classList.add("xterm-decoration-overview-ruler"),f._refreshCanvasDimensions(),null===(d=f._viewportElement.parentElement)||void 0===d||d.insertBefore(f._canvas,f._viewportElement);var p=f._canvas.getContext("2d");if(!p)throw new Error("Ctx cannot be null");return f._ctx=p,f._registerDecorationListeners(),f._registerBufferChangeListeners(),f._registerDimensionChangeListeners(),f.register((0,u.toDisposable)((function(){var e;null===(e=f._canvas)||void 0===e||e.remove()}))),f}return f(r,[{key:"_width",get:function(){return this._optionsService.options.overviewRulerWidth||0}},{key:"_registerDecorationListeners",value:function(){var e=this;this.register(this._decorationService.onDecorationRegistered((function(){return e._queueRefresh(void 0,!0)}))),this.register(this._decorationService.onDecorationRemoved((function(){return e._queueRefresh(void 0,!0)})))}},{key:"_registerBufferChangeListeners",value:function(){var e=this;this.register(this._renderService.onRenderedViewportChange((function(){return e._queueRefresh()}))),this.register(this._bufferService.buffers.onBufferActivate((function(){e._canvas.style.display=e._bufferService.buffer===e._bufferService.buffers.alt?"none":"block"}))),this.register(this._bufferService.onScroll((function(){e._lastKnownBufferLength!==e._bufferService.buffers.normal.lines.length&&(e._refreshDrawHeightConstants(),e._refreshColorZonePadding())})))}},{key:"_registerDimensionChangeListeners",value:function(){var e=this;this.register(this._renderService.onRender((function(){e._containerHeight&&e._containerHeight===e._screenElement.clientHeight||(e._queueRefresh(!0),e._containerHeight=e._screenElement.clientHeight)}))),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",(function(){return e._queueRefresh(!0)}))),this.register((0,s.addDisposableDomListener)(this._coreBrowseService.window,"resize",(function(){return e._queueRefresh(!0)}))),this._queueRefresh(!0)}},{key:"_refreshDrawConstants",value:function(){var e=Math.floor(this._canvas.width/3),t=Math.ceil(this._canvas.width/3);g.full=this._canvas.width,g.left=e,g.center=t,g.right=e,this._refreshDrawHeightConstants(),y.full=0,y.left=0,y.center=g.left,y.right=g.left+g.center}},{key:"_refreshDrawHeightConstants",value:function(){d.full=Math.round(2*this._coreBrowseService.dpr);var e=this._canvas.height/this._bufferService.buffer.lines.length,t=Math.round(Math.max(Math.min(e,12),6)*this._coreBrowseService.dpr);d.left=t,d.center=t,d.right=t}},{key:"_refreshColorZonePadding",value:function(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*d.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*d.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*d.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*d.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}},{key:"_refreshCanvasDimensions",value:function(){this._canvas.style.width="".concat(this._width,"px"),this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height="".concat(this._screenElement.clientHeight,"px"),this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}},{key:"_refreshDecorations",value:function(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();var e,t=l(this._decorationService.decorations);try{for(t.s();!(e=t.n()).done;){var r=e.value;this._colorZoneStore.addDecoration(r)}}catch(h){t.e(h)}finally{t.f()}this._ctx.lineWidth=1;var n,i=this._colorZoneStore.zones,a=l(i);try{for(a.s();!(n=a.n()).done;){var s=n.value;"full"!==s.position&&this._renderColorZone(s)}}catch(h){a.e(h)}finally{a.f()}var o,u=l(i);try{for(u.s();!(o=u.n()).done;){var c=o.value;"full"===c.position&&this._renderColorZone(c)}}catch(h){u.e(h)}finally{u.f()}this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}},{key:"_renderColorZone",value:function(e){this._ctx.fillStyle=e.color,this._ctx.fillRect(y[e.position||"full"],Math.round((this._canvas.height-1)*(e.startBufferLine/this._bufferService.buffers.active.lines.length)-d[e.position||"full"]/2),g[e.position||"full"],Math.round((this._canvas.height-1)*((e.endBufferLine-e.startBufferLine)/this._bufferService.buffers.active.lines.length)+d[e.position||"full"]))}},{key:"_queueRefresh",value:function(e,t){var r=this;this._shouldUpdateDimensions=e||this._shouldUpdateDimensions,this._shouldUpdateAnchor=t||this._shouldUpdateAnchor,void 0===this._animationFrame&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame((function(){r._refreshDecorations(),r._animationFrame=void 0})))}}]),r}(u.Disposable);t.OverviewRulerRenderer=m=n([i(2,c.IBufferService),i(3,c.IDecorationService),i(4,o.IRenderService),i(5,c.IOptionsService),i(6,o.ICoreBrowserService)],m)},2950:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CompositionHelper=void 0;var a=r(4725),s=r(2585),o=r(2584),u=t.CompositionHelper=function(){function e(t,r,n,i,a,s){h(this,e),this._textarea=t,this._compositionView=r,this._bufferService=n,this._optionsService=i,this._coreService=a,this._renderService=s,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}return f(e,[{key:"isComposing",get:function(){return this._isComposing}},{key:"compositionstart",value:function(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}},{key:"compositionupdate",value:function(e){var t=this;this._compositionView.textContent=e.data,this.updateCompositionElements(),setTimeout((function(){t._compositionPosition.end=t._textarea.value.length}),0)}},{key:"compositionend",value:function(){this._finalizeComposition(!0)}},{key:"keydown",value:function(e){if(this._isComposing||this._isSendingComposition){if(229===e.keyCode)return!1;if(16===e.keyCode||17===e.keyCode||18===e.keyCode)return!1;this._finalizeComposition(!1)}return 229!==e.keyCode||(this._handleAnyTextareaChanges(),!1)}},{key:"_finalizeComposition",value:function(e){var t=this;if(this._compositionView.classList.remove("active"),this._isComposing=!1,e){var r={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout((function(){var e;t._isSendingComposition&&(t._isSendingComposition=!1,r.start+=t._dataAlreadySent.length,(e=t._isComposing?t._textarea.value.substring(r.start,r.end):t._textarea.value.substring(r.start)).length>0&&t._coreService.triggerDataEvent(e,!0))}),0)}else{this._isSendingComposition=!1;var n=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(n,!0)}}},{key:"_handleAnyTextareaChanges",value:function(){var e=this,t=this._textarea.value;setTimeout((function(){if(!e._isComposing){var r=e._textarea.value,n=r.replace(t,"");e._dataAlreadySent=n,r.length>t.length?e._coreService.triggerDataEvent(n,!0):r.length<t.length?e._coreService.triggerDataEvent("".concat(o.C0.DEL),!0):r.length===t.length&&r!==t&&e._coreService.triggerDataEvent(r,!0)}}),0)}},{key:"updateCompositionElements",value:function(e){var t=this;if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){var r=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),n=this._renderService.dimensions.css.cell.height,i=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,a=r*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=a+"px",this._compositionView.style.top=i+"px",this._compositionView.style.height=n+"px",this._compositionView.style.lineHeight=n+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";var s=this._compositionView.getBoundingClientRect();this._textarea.style.left=a+"px",this._textarea.style.top=i+"px",this._textarea.style.width=Math.max(s.width,1)+"px",this._textarea.style.height=Math.max(s.height,1)+"px",this._textarea.style.lineHeight=s.height+"px"}e||setTimeout((function(){return t.updateCompositionElements(!0)}),0)}}}]),e}();t.CompositionHelper=u=n([i(2,s.IBufferService),i(3,s.IOptionsService),i(4,s.ICoreService),i(5,a.IRenderService)],u)},9806:function(e,t){function r(e,t,r){var n=r.getBoundingClientRect(),i=e.getComputedStyle(r),a=parseInt(i.getPropertyValue("padding-left")),s=parseInt(i.getPropertyValue("padding-top"));return[t.clientX-n.left-a,t.clientY-n.top-s]}Object.defineProperty(t,"__esModule",{value:!0}),t.getCoords=t.getCoordsRelativeToElement=void 0,t.getCoordsRelativeToElement=r,t.getCoords=function(e,t,n,i,a,s,o,u,c){if(s){var l=r(e,t,n);return l?(l[0]=Math.ceil((l[0]+(c?o/2:0))/o),l[1]=Math.ceil(l[1]/u),l[0]=Math.min(Math.max(l[0],1),i+(c?1:0)),l[1]=Math.min(Math.max(l[1],1),a),l):void 0}}},9504:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.moveToCellSequence=void 0;var n=r(2584);function i(e,t,r,n){var i=e-a(e,r),o=t-a(t,r),l=Math.abs(i-o)-function(e,t,r){for(var n=0,i=e-a(e,r),o=t-a(t,r),u=0;u<Math.abs(i-o);u++){var c="A"===s(e,t)?-1:1,l=r.buffer.lines.get(i+c*u);(null==l?void 0:l.isWrapped)&&n++}return n}(e,t,r);return c(l,u(s(e,t),n))}function a(e,t){for(var r=0,n=t.buffer.lines.get(e),i=null==n?void 0:n.isWrapped;i&&e>=0&&e<t.rows;)r++,i=null==(n=t.buffer.lines.get(--e))?void 0:n.isWrapped;return r}function s(e,t){return e>t?"A":"B"}function o(e,t,r,n,i,a){for(var s=e,o=t,u="";s!==r||o!==n;)s+=i?1:-1,i&&s>a.cols-1?(u+=a.buffer.translateBufferLineToString(o,!1,e,s),s=0,e=0,o++):!i&&s<0&&(u+=a.buffer.translateBufferLineToString(o,!1,0,e+1),e=s=a.cols-1,o--);return u+a.buffer.translateBufferLineToString(o,!1,e,s)}function u(e,t){var r=t?"O":"[";return n.C0.ESC+r+e}function c(e,t){e=Math.floor(e);for(var r="",n=0;n<e;n++)r+=t;return r}t.moveToCellSequence=function(e,t,r,n){var s,l=r.buffer.x,h=r.buffer.y;if(!r.buffer.hasScrollback)return function(e,t,r,n,s,l){return 0===i(t,n,s,l).length?"":c(o(e,t,e,t-a(t,s),!1,s).length,u("D",l))}(l,h,0,t,r,n)+i(h,t,r,n)+function(e,t,r,n,s,l){var h;h=i(t,n,s,l).length>0?n-a(n,s):t;var f=n,d=function(e,t,r,n,s,o){var u;return u=i(r,n,s,o).length>0?n-a(n,s):t,e<r&&u<=n||e>=r&&u<n?"C":"D"}(e,t,r,n,s,l);return c(o(e,h,r,f,"C"===d,s).length,u(d,l))}(l,h,e,t,r,n);if(h===t)return s=l>e?"D":"C",c(Math.abs(l-e),u(s,n));s=h>t?"D":"C";var f=Math.abs(h-t);return c(function(e,t){return t.cols-e}(h>t?e:l,r)+(f-1)*r.cols+1+((h>t?l:e)-1),u(s,n))}},1296:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRenderer=void 0;var a=r(3787),o=r(2550),u=r(2223),d=r(6171),g=r(4725),y=r(8055),m=r(8460),b=r(844),_=r(2585),w="xterm-dom-renderer-owner-",k="xterm-rows",x="xterm-fg-",E="xterm-bg-",S="xterm-focus",C="xterm-selection",A=1,D=t.DomRenderer=function(e){p(r,e);var t=v(r);function r(e,n,i,s,u,c,l,f,p,v){var g;return h(this,r),(g=t.call(this))._element=e,g._screenElement=n,g._viewportElement=i,g._linkifier2=s,g._charSizeService=c,g._optionsService=l,g._bufferService=f,g._coreBrowserService=p,g._themeService=v,g._terminalClass=A++,g._rowElements=[],g.onRequestRedraw=g.register(new m.EventEmitter).event,g._rowContainer=document.createElement("div"),g._rowContainer.classList.add(k),g._rowContainer.style.lineHeight="normal",g._rowContainer.setAttribute("aria-hidden","true"),g._refreshRowElements(g._bufferService.cols,g._bufferService.rows),g._selectionContainer=document.createElement("div"),g._selectionContainer.classList.add(C),g._selectionContainer.setAttribute("aria-hidden","true"),g.dimensions=(0,d.createRenderDimensions)(),g._updateDimensions(),g.register(g._optionsService.onOptionChange((function(){return g._handleOptionsChanged()}))),g.register(g._themeService.onChangeColors((function(e){return g._injectCss(e)}))),g._injectCss(g._themeService.colors),g._rowFactory=u.createInstance(a.DomRendererRowFactory,document),g._element.classList.add(w+g._terminalClass),g._screenElement.appendChild(g._rowContainer),g._screenElement.appendChild(g._selectionContainer),g.register(g._linkifier2.onShowLinkUnderline((function(e){return g._handleLinkHover(e)}))),g.register(g._linkifier2.onHideLinkUnderline((function(e){return g._handleLinkLeave(e)}))),g.register((0,b.toDisposable)((function(){g._element.classList.remove(w+g._terminalClass),g._rowContainer.remove(),g._selectionContainer.remove(),g._widthCache.dispose(),g._themeStyleElement.remove(),g._dimensionsStyleElement.remove()}))),g._widthCache=new o.WidthCache(document),g._widthCache.setFont(g._optionsService.rawOptions.fontFamily,g._optionsService.rawOptions.fontSize,g._optionsService.rawOptions.fontWeight,g._optionsService.rawOptions.fontWeightBold),g._setDefaultSpacing(),g}return f(r,[{key:"_updateDimensions",value:function(){var e=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*e,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*e),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/e),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/e),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;var t,r=l(this._rowElements);try{for(r.s();!(t=r.n()).done;){var n=t.value;n.style.width="".concat(this.dimensions.css.canvas.width,"px"),n.style.height="".concat(this.dimensions.css.cell.height,"px"),n.style.lineHeight="".concat(this.dimensions.css.cell.height,"px"),n.style.overflow="hidden"}}catch(a){r.e(a)}finally{r.f()}this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));var i="".concat(this._terminalSelector," .").concat(k," span { display: inline-block; height: 100%; vertical-align: top;}");this._dimensionsStyleElement.textContent=i,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width="".concat(this.dimensions.css.canvas.width,"px"),this._screenElement.style.height="".concat(this.dimensions.css.canvas.height,"px")}},{key:"_injectCss",value:function(e){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));var t="".concat(this._terminalSelector," .").concat(k," { color: ").concat(e.foreground.css,"; font-family: ").concat(this._optionsService.rawOptions.fontFamily,"; font-size: ").concat(this._optionsService.rawOptions.fontSize,"px; font-kerning: none; white-space: pre}");t+="".concat(this._terminalSelector," .").concat(k," .xterm-dim { color: ").concat(y.color.multiplyOpacity(e.foreground,.5).css,";}"),t+="".concat(this._terminalSelector," span:not(.xterm-bold) { font-weight: ").concat(this._optionsService.rawOptions.fontWeight,";}").concat(this._terminalSelector," span.xterm-bold { font-weight: ").concat(this._optionsService.rawOptions.fontWeightBold,";}").concat(this._terminalSelector," span.xterm-italic { font-style: italic;}"),t+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  border-bottom-style: hidden; }}",t+="@keyframes blink_block_"+this._terminalClass+" { 0% {"+"  background-color: ".concat(e.cursor.css,";")+"  color: ".concat(e.cursorAccent.css,"; } 50% {  background-color: inherit;")+"  color: ".concat(e.cursor.css,"; }}"),t+="".concat(this._terminalSelector," .").concat(k,".").concat(S," .xterm-cursor.xterm-cursor-blink:not(.xterm-cursor-block) { animation: blink_box_shadow_")+this._terminalClass+" 1s step-end infinite;}"+"".concat(this._terminalSelector," .").concat(k,".").concat(S," .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: blink_block_")+this._terminalClass+" 1s step-end infinite;}"+"".concat(this._terminalSelector," .").concat(k," .xterm-cursor.xterm-cursor-block {")+" background-color: ".concat(e.cursor.css,";")+" color: ".concat(e.cursorAccent.css,";}")+"".concat(this._terminalSelector," .").concat(k," .xterm-cursor.xterm-cursor-outline {")+" outline: 1px solid ".concat(e.cursor.css,"; outline-offset: -1px;}")+"".concat(this._terminalSelector," .").concat(k," .xterm-cursor.xterm-cursor-bar {")+" box-shadow: ".concat(this._optionsService.rawOptions.cursorWidth,"px 0 0 ").concat(e.cursor.css," inset;}")+"".concat(this._terminalSelector," .").concat(k," .xterm-cursor.xterm-cursor-underline {")+" border-bottom: 1px ".concat(e.cursor.css,"; border-bottom-style: solid; height: calc(100% - 1px);}"),t+="".concat(this._terminalSelector," .").concat(C," { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}").concat(this._terminalSelector,".focus .").concat(C," div { position: absolute; background-color: ").concat(e.selectionBackgroundOpaque.css,";}").concat(this._terminalSelector," .").concat(C," div { position: absolute; background-color: ").concat(e.selectionInactiveBackgroundOpaque.css,";}");var r,n=l(e.ansi.entries());try{for(n.s();!(r=n.n()).done;){var i=c(r.value,2),a=i[0],s=i[1];t+="".concat(this._terminalSelector," .").concat(x).concat(a," { color: ").concat(s.css,"; }").concat(this._terminalSelector," .").concat(x).concat(a,".xterm-dim { color: ").concat(y.color.multiplyOpacity(s,.5).css,"; }").concat(this._terminalSelector," .").concat(E).concat(a," { background-color: ").concat(s.css,"; }")}}catch(o){n.e(o)}finally{n.f()}t+="".concat(this._terminalSelector," .").concat(x).concat(u.INVERTED_DEFAULT_COLOR," { color: ").concat(y.color.opaque(e.background).css,"; }").concat(this._terminalSelector," .").concat(x).concat(u.INVERTED_DEFAULT_COLOR,".xterm-dim { color: ").concat(y.color.multiplyOpacity(y.color.opaque(e.background),.5).css,"; }").concat(this._terminalSelector," .").concat(E).concat(u.INVERTED_DEFAULT_COLOR," { background-color: ").concat(e.foreground.css,"; }"),this._themeStyleElement.textContent=t}},{key:"_setDefaultSpacing",value:function(){var e=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing="".concat(e,"px"),this._rowFactory.defaultSpacing=e}},{key:"handleDevicePixelRatioChange",value:function(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}},{key:"_refreshRowElements",value:function(e,t){for(var r=this._rowElements.length;r<=t;r++){var n=document.createElement("div");this._rowContainer.appendChild(n),this._rowElements.push(n)}for(;this._rowElements.length>t;)this._rowContainer.removeChild(this._rowElements.pop())}},{key:"handleResize",value:function(e,t){this._refreshRowElements(e,t),this._updateDimensions()}},{key:"handleCharSizeChanged",value:function(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}},{key:"handleBlur",value:function(){this._rowContainer.classList.remove(S)}},{key:"handleFocus",value:function(){this._rowContainer.classList.add(S),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}},{key:"handleSelectionChanged",value:function(e,t,r){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(e,t,r),this.renderRows(0,this._bufferService.rows-1),e&&t){var n=e[1]-this._bufferService.buffer.ydisp,i=t[1]-this._bufferService.buffer.ydisp,a=Math.max(n,0),s=Math.min(i,this._bufferService.rows-1);if(!(a>=this._bufferService.rows||s<0)){var o=document.createDocumentFragment();if(r){var u=e[0]>t[0];o.appendChild(this._createSelectionElement(a,u?t[0]:e[0],u?e[0]:t[0],s-a+1))}else{var c=n===a?e[0]:0,l=a===i?t[0]:this._bufferService.cols;o.appendChild(this._createSelectionElement(a,c,l));var h=s-a-1;if(o.appendChild(this._createSelectionElement(a+1,0,this._bufferService.cols,h)),a!==s){var f=i===s?t[0]:this._bufferService.cols;o.appendChild(this._createSelectionElement(s,0,f))}}this._selectionContainer.appendChild(o)}}}},{key:"_createSelectionElement",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=document.createElement("div");return i.style.height=n*this.dimensions.css.cell.height+"px",i.style.top=e*this.dimensions.css.cell.height+"px",i.style.left=t*this.dimensions.css.cell.width+"px",i.style.width=this.dimensions.css.cell.width*(r-t)+"px",i}},{key:"handleCursorMove",value:function(){}},{key:"_handleOptionsChanged",value:function(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}},{key:"clear",value:function(){var e,t=l(this._rowElements);try{for(t.s();!(e=t.n()).done;)e.value.replaceChildren()}catch(r){t.e(r)}finally{t.f()}}},{key:"renderRows",value:function(e,t){for(var r=this._bufferService.buffer,n=r.ybase+r.y,i=Math.min(r.x,this._bufferService.cols-1),a=this._optionsService.rawOptions.cursorBlink,o=this._optionsService.rawOptions.cursorStyle,u=this._optionsService.rawOptions.cursorInactiveStyle,c=e;c<=t;c++){var l=c+r.ydisp,h=this._rowElements[c],f=r.lines.get(l);if(!h||!f)break;h.replaceChildren.apply(h,s(this._rowFactory.createRow(f,l,l===n,o,u,i,a,this.dimensions.css.cell.width,this._widthCache,-1,-1)))}}},{key:"_terminalSelector",get:function(){return".".concat(w).concat(this._terminalClass)}},{key:"_handleLinkHover",value:function(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!0)}},{key:"_handleLinkLeave",value:function(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!1)}},{key:"_setCellUnderline",value:function(e,t,r,n,i,a){r<0&&(e=0),n<0&&(t=0);var o=this._bufferService.rows-1;r=Math.max(Math.min(r,o),0),n=Math.max(Math.min(n,o),0),i=Math.min(i,this._bufferService.cols);for(var u=this._bufferService.buffer,c=u.ybase+u.y,l=Math.min(u.x,i-1),h=this._optionsService.rawOptions.cursorBlink,f=this._optionsService.rawOptions.cursorStyle,d=this._optionsService.rawOptions.cursorInactiveStyle,p=r;p<=n;++p){var v=p+u.ydisp,g=this._rowElements[p],y=u.lines.get(v);if(!g||!y)break;g.replaceChildren.apply(g,s(this._rowFactory.createRow(y,v,v===c,f,d,l,h,this.dimensions.css.cell.width,this._widthCache,a?p===r?e:0:-1,a?(p===n?t:i)-1:-1)))}}}]),r}(b.Disposable);t.DomRenderer=D=n([i(4,_.IInstantiationService),i(5,g.ICharSizeService),i(6,_.IOptionsService),i(7,_.IBufferService),i(8,g.ICoreBrowserService),i(9,g.IThemeService)],D)},3787:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRendererRowFactory=void 0;var a=r(2223),s=r(643),o=r(511),u=r(2585),c=r(8055),l=r(4725),d=r(4269),p=r(6171),v=r(3734),g=t.DomRendererRowFactory=function(){function e(t,r,n,i,a,s,u){h(this,e),this._document=t,this._characterJoinerService=r,this._optionsService=n,this._coreBrowserService=i,this._coreService=a,this._decorationService=s,this._themeService=u,this._workCell=new o.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}return f(e,[{key:"handleSelectionChanged",value:function(e,t,r){this._selectionStart=e,this._selectionEnd=t,this._columnSelectMode=r}},{key:"createRow",value:function(e,t,r,n,i,o,u,l,h,f,p){var g,m=this,b=[],_=this._characterJoinerService.getJoinedCharacters(t),w=this._themeService.colors,k=e.getNoBgTrimmedLength();r&&k<o+1&&(k=o+1);for(var x=0,E="",S=0,C=0,A=0,D=!1,R=0,T=!1,Z=0,I=[],P=-1!==f&&-1!==p,L=function(k){e.loadCell(k,m._workCell);var L=m._workCell.getWidth();if(0===L)return M=k,0;var B=!1,O=k,N=m._workCell;if(_.length>0&&k===_[0][0]){B=!0;var F=_.shift();N=new d.JoinedCellData(m._workCell,e.translateToString(!0,F[0],F[1]),F[1]-F[0]),O=F[1]-1,L=N.getWidth()}var U=m._isCellInSelection(k,t),z=r&&k===o,j=P&&k>=f&&k<=p,H=!1;m._decorationService.forEachDecorationAtCell(k,t,void 0,(function(e){H=!0}));var W=N.getChars()||s.WHITESPACE_CELL_CHAR;if(" "===W&&(N.isUnderline()||N.isOverline())&&(W="\xa0"),Z=L*l-h.get(W,N.isBold(),N.isItalic()),g){if(x&&(U&&T||!U&&!T&&N.bg===S)&&(U&&T&&w.selectionForeground||N.fg===C)&&N.extended.ext===A&&j===D&&Z===R&&!z&&!B&&!H)return E+=W,x++,M=k,0;x&&(g.textContent=E),g=m._document.createElement("span"),x=0,E=""}else g=m._document.createElement("span");if(S=N.bg,C=N.fg,A=N.extended.ext,D=j,R=Z,T=U,B&&o>=k&&o<=O&&(o=k),!m._coreService.isCursorHidden&&z)if(I.push("xterm-cursor"),m._coreBrowserService.isFocused)u&&I.push("xterm-cursor-blink"),I.push("bar"===n?"xterm-cursor-bar":"underline"===n?"xterm-cursor-underline":"xterm-cursor-block");else if(i)switch(i){case"outline":I.push("xterm-cursor-outline");break;case"block":I.push("xterm-cursor-block");break;case"bar":I.push("xterm-cursor-bar");break;case"underline":I.push("xterm-cursor-underline")}if(N.isBold()&&I.push("xterm-bold"),N.isItalic()&&I.push("xterm-italic"),N.isDim()&&I.push("xterm-dim"),E=N.isInvisible()?s.WHITESPACE_CELL_CHAR:N.getChars()||s.WHITESPACE_CELL_CHAR,N.isUnderline()&&(I.push("xterm-underline-".concat(N.extended.underlineStyle))," "===E&&(E="\xa0"),!N.isUnderlineColorDefault()))if(N.isUnderlineColorRGB())g.style.textDecorationColor="rgb(".concat(v.AttributeData.toColorRGB(N.getUnderlineColor()).join(","),")");else{var q=N.getUnderlineColor();m._optionsService.rawOptions.drawBoldTextInBrightColors&&N.isBold()&&q<8&&(q+=8),g.style.textDecorationColor=w.ansi[q].css}N.isOverline()&&(I.push("xterm-overline")," "===E&&(E="\xa0")),N.isStrikethrough()&&I.push("xterm-strikethrough"),j&&(g.style.textDecoration="underline");var V=N.getFgColor(),K=N.getFgColorMode(),Y=N.getBgColor(),G=N.getBgColorMode(),Q=!!N.isInverse();if(Q){var X=V;V=Y,Y=X;var J=K;K=G,G=J}var $,ee,te,re=!1;switch(m._decorationService.forEachDecorationAtCell(k,t,void 0,(function(e){"top"!==e.options.layer&&re||(e.backgroundColorRGB&&(G=50331648,Y=e.backgroundColorRGB.rgba>>8&16777215,$=e.backgroundColorRGB),e.foregroundColorRGB&&(K=50331648,V=e.foregroundColorRGB.rgba>>8&16777215,ee=e.foregroundColorRGB),re="top"===e.options.layer)})),!re&&U&&($=m._coreBrowserService.isFocused?w.selectionBackgroundOpaque:w.selectionInactiveBackgroundOpaque,Y=$.rgba>>8&16777215,G=50331648,re=!0,w.selectionForeground&&(K=50331648,V=w.selectionForeground.rgba>>8&16777215,ee=w.selectionForeground)),re&&I.push("xterm-decoration-top"),G){case 16777216:case 33554432:te=w.ansi[Y],I.push("xterm-bg-".concat(Y));break;case 50331648:te=c.rgba.toColor(Y>>16,Y>>8&255,255&Y),m._addStyle(g,"background-color:#".concat(y((Y>>>0).toString(16),"0",6)));break;default:Q?(te=w.foreground,I.push("xterm-bg-".concat(a.INVERTED_DEFAULT_COLOR))):te=w.background}switch($||N.isDim()&&($=c.color.multiplyOpacity(te,.5)),K){case 16777216:case 33554432:N.isBold()&&V<8&&m._optionsService.rawOptions.drawBoldTextInBrightColors&&(V+=8),m._applyMinimumContrast(g,te,w.ansi[V],N,$,void 0)||I.push("xterm-fg-".concat(V));break;case 50331648:var ne=c.rgba.toColor(V>>16&255,V>>8&255,255&V);m._applyMinimumContrast(g,te,ne,N,$,ee)||m._addStyle(g,"color:#".concat(y(V.toString(16),"0",6)));break;default:m._applyMinimumContrast(g,te,w.foreground,N,$,void 0)||Q&&I.push("xterm-fg-".concat(a.INVERTED_DEFAULT_COLOR))}I.length&&(g.className=I.join(" "),I.length=0),z||B||H?g.textContent=E:x++,Z!==m.defaultSpacing&&(g.style.letterSpacing="".concat(Z,"px")),b.push(g),M=k=O},M=0;M<k;M++)L(M);return g&&x&&(g.textContent=E),b}},{key:"_applyMinimumContrast",value:function(e,t,r,n,i,a){if(1===this._optionsService.rawOptions.minimumContrastRatio||(0,p.excludeFromContrastRatioDemands)(n.getCode()))return!1;var s,o=this._getContrastCache(n);if(i||a||(s=o.getColor(t.rgba,r.rgba)),void 0===s){var u=this._optionsService.rawOptions.minimumContrastRatio/(n.isDim()?2:1);s=c.color.ensureContrastRatio(i||t,a||r,u),o.setColor((i||t).rgba,(a||r).rgba,null!=s?s:null)}return!!s&&(this._addStyle(e,"color:".concat(s.css)),!0)}},{key:"_getContrastCache",value:function(e){return e.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}},{key:"_addStyle",value:function(e,t){e.setAttribute("style","".concat(e.getAttribute("style")||"").concat(t,";"))}},{key:"_isCellInSelection",value:function(e,t){var r=this._selectionStart,n=this._selectionEnd;return!(!r||!n)&&(this._columnSelectMode?r[0]<=n[0]?e>=r[0]&&t>=r[1]&&e<n[0]&&t<=n[1]:e<r[0]&&t>=r[1]&&e>=n[0]&&t<=n[1]:t>r[1]&&t<n[1]||r[1]===n[1]&&t===r[1]&&e>=r[0]&&e<n[0]||r[1]<n[1]&&t===n[1]&&e<n[0]||r[1]<n[1]&&t===r[1]&&e>=r[0])}}]),e}();function y(e,t,r){for(;e.length<r;)e=t+e;return e}t.DomRendererRowFactory=g=n([i(1,l.ICharacterJoinerService),i(2,u.IOptionsService),i(3,l.ICoreBrowserService),i(4,u.ICoreService),i(5,u.IDecorationService),i(6,l.IThemeService)],g)},2550:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.WidthCache=void 0,t.WidthCache=function(){function e(t){h(this,e),this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=t.createElement("div"),this._container.style.position="absolute",this._container.style.top="-50000px",this._container.style.width="50000px",this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";var r=t.createElement("span"),n=t.createElement("span");n.style.fontWeight="bold";var i=t.createElement("span");i.style.fontStyle="italic";var a=t.createElement("span");a.style.fontWeight="bold",a.style.fontStyle="italic",this._measureElements=[r,n,i,a],this._container.appendChild(r),this._container.appendChild(n),this._container.appendChild(i),this._container.appendChild(a),t.body.appendChild(this._container),this.clear()}return f(e,[{key:"dispose",value:function(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}},{key:"clear",value:function(){this._flat.fill(-9999),this._holey=new Map}},{key:"setFont",value:function(e,t,r,n){e===this._font&&t===this._fontSize&&r===this._weight&&n===this._weightBold||(this._font=e,this._fontSize=t,this._weight=r,this._weightBold=n,this._container.style.fontFamily=this._font,this._container.style.fontSize="".concat(this._fontSize,"px"),this._measureElements[0].style.fontWeight="".concat(r),this._measureElements[1].style.fontWeight="".concat(n),this._measureElements[2].style.fontWeight="".concat(r),this._measureElements[3].style.fontWeight="".concat(n),this.clear())}},{key:"get",value:function(e,t,r){var n=0;if(!t&&!r&&1===e.length&&(n=e.charCodeAt(0))<256)return-9999!==this._flat[n]?this._flat[n]:this._flat[n]=this._measure(e,0);var i=e;t&&(i+="B"),r&&(i+="I");var a=this._holey.get(i);if(void 0===a){var s=0;t&&(s|=1),r&&(s|=2),a=this._measure(e,s),this._holey.set(i,a)}return a}},{key:"_measure",value:function(e,t){var r=this._measureElements[t];return r.textContent=e.repeat(32),r.offsetWidth/32}}]),e}()},2223:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.TEXT_BASELINE=t.DIM_OPACITY=t.INVERTED_DEFAULT_COLOR=void 0;var n=r(6114);t.INVERTED_DEFAULT_COLOR=257,t.DIM_OPACITY=.5,t.TEXT_BASELINE=n.isFirefox||n.isLegacyEdge?"bottom":"ideographic"},6171:function(e,t){function r(e){return 57508<=e&&e<=57558}Object.defineProperty(t,"__esModule",{value:!0}),t.createRenderDimensions=t.excludeFromContrastRatioDemands=t.isRestrictedPowerlineGlyph=t.isPowerlineGlyph=t.throwIfFalsy=void 0,t.throwIfFalsy=function(e){if(!e)throw new Error("value must not be falsy");return e},t.isPowerlineGlyph=r,t.isRestrictedPowerlineGlyph=function(e){return 57520<=e&&e<=57527},t.excludeFromContrastRatioDemands=function(e){return r(e)||function(e){return 9472<=e&&e<=9631}(e)},t.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionModel=void 0,t.SelectionModel=function(){function e(t){h(this,e),this._bufferService=t,this.isSelectAllActive=!1,this.selectionStartLength=0}return f(e,[{key:"clearSelection",value:function(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}},{key:"finalSelectionStart",get:function(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}},{key:"finalSelectionEnd",get:function(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){var e=this.selectionStart[0]+this.selectionStartLength;return e>this._bufferService.cols?e%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)-1]:[e%this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)]:[e,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){var t=this.selectionStart[0]+this.selectionStartLength;return t>this._bufferService.cols?[t%this._bufferService.cols,this.selectionStart[1]+Math.floor(t/this._bufferService.cols)]:[Math.max(t,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}},{key:"areSelectionValuesReversed",value:function(){var e=this.selectionStart,t=this.selectionEnd;return!(!e||!t)&&(e[1]>t[1]||e[1]===t[1]&&e[0]>t[0])}},{key:"handleTrim",value:function(e){return this.selectionStart&&(this.selectionStart[1]-=e),this.selectionEnd&&(this.selectionEnd[1]-=e),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}]),e}()},428:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharSizeService=void 0;var a=r(2585),s=r(8460),o=r(844),u=t.CharSizeService=function(e){p(r,e);var t=v(r);function r(e,n,i){var a;return h(this,r),(a=t.call(this))._optionsService=i,a.width=0,a.height=0,a._onCharSizeChange=a.register(new s.EventEmitter),a.onCharSizeChange=a._onCharSizeChange.event,a._measureStrategy=new c(e,n,a._optionsService),a.register(a._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],(function(){return a.measure()}))),a}return f(r,[{key:"hasValidSize",get:function(){return this.width>0&&this.height>0}},{key:"measure",value:function(){var e=this._measureStrategy.measure();e.width===this.width&&e.height===this.height||(this.width=e.width,this.height=e.height,this._onCharSizeChange.fire())}}]),r}(o.Disposable);t.CharSizeService=u=n([i(2,a.IOptionsService)],u);var c=function(){function e(t,r,n){h(this,e),this._document=t,this._parentElement=r,this._optionsService=n,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}return f(e,[{key:"measure",value:function(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize="".concat(this._optionsService.rawOptions.fontSize,"px");var e={height:Number(this._measureElement.offsetHeight),width:Number(this._measureElement.offsetWidth)};return 0!==e.width&&0!==e.height&&(this._result.width=e.width/32,this._result.height=Math.ceil(e.height)),this._result}}]),e}()},4269:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterJoinerService=t.JoinedCellData=void 0;var a=r(3734),s=r(643),o=r(511),u=r(2585),c=function(e){p(r,e);var t=v(r);function r(e,n,i){var a;return h(this,r),(a=t.call(this)).content=0,a.combinedData="",a.fg=e.fg,a.bg=e.bg,a.combinedData=n,a._width=i,a}return f(r,[{key:"isCombined",value:function(){return 2097152}},{key:"getWidth",value:function(){return this._width}},{key:"getChars",value:function(){return this.combinedData}},{key:"getCode",value:function(){return 2097151}},{key:"setFromCharData",value:function(e){throw new Error("not implemented")}},{key:"getAsCharData",value:function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}]),r}(a.AttributeData);t.JoinedCellData=c;var l=t.CharacterJoinerService=function(){function e(t){h(this,e),this._bufferService=t,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new o.CellData}return f(e,[{key:"register",value:function(e){var t={id:this._nextCharacterJoinerId++,handler:e};return this._characterJoiners.push(t),t.id}},{key:"deregister",value:function(e){for(var t=0;t<this._characterJoiners.length;t++)if(this._characterJoiners[t].id===e)return this._characterJoiners.splice(t,1),!0;return!1}},{key:"getJoinedCharacters",value:function(e){if(0===this._characterJoiners.length)return[];var t=this._bufferService.buffer.lines.get(e);if(!t||0===t.length)return[];for(var r=[],n=t.translateToString(!0),i=0,a=0,o=0,u=t.getFg(0),c=t.getBg(0),l=0;l<t.getTrimmedLength();l++)if(t.loadCell(l,this._workCell),0!==this._workCell.getWidth()){if(this._workCell.fg!==u||this._workCell.bg!==c){if(l-i>1)for(var h=this._getJoinedRanges(n,o,a,t,i),f=0;f<h.length;f++)r.push(h[f]);i=l,o=a,u=this._workCell.fg,c=this._workCell.bg}a+=this._workCell.getChars().length||s.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-i>1)for(var d=this._getJoinedRanges(n,o,a,t,i),p=0;p<d.length;p++)r.push(d[p]);return r}},{key:"_getJoinedRanges",value:function(t,r,n,i,a){var s=t.substring(r,n),o=[];try{o=this._characterJoiners[0].handler(s)}catch(h){console.error(h)}for(var u=1;u<this._characterJoiners.length;u++)try{for(var c=this._characterJoiners[u].handler(s),l=0;l<c.length;l++)e._mergeRanges(o,c[l])}catch(f){console.error(f)}return this._stringRangesToCellRanges(o,i,a),o}},{key:"_stringRangesToCellRanges",value:function(e,t,r){var n=0,i=!1,a=0,o=e[n];if(o){for(var u=r;u<this._bufferService.cols;u++){var c=t.getWidth(u),l=t.getString(u).length||s.WHITESPACE_CELL_CHAR.length;if(0!==c){if(!i&&o[0]<=a&&(o[0]=u,i=!0),o[1]<=a){if(o[1]=u,!(o=e[++n]))break;o[0]<=a?(o[0]=u,i=!0):i=!1}a+=l}}o&&(o[1]=this._bufferService.cols)}}}],[{key:"_mergeRanges",value:function(e,t){for(var r=!1,n=0;n<e.length;n++){var i=e[n];if(r){if(t[1]<=i[0])return e[n-1][1]=t[1],e;if(t[1]<=i[1])return e[n-1][1]=Math.max(t[1],i[1]),e.splice(n,1),e;e.splice(n,1),n--}else{if(t[1]<=i[0])return e.splice(n,0,t),e;if(t[1]<=i[1])return i[0]=Math.min(t[0],i[0]),e;t[0]<i[1]&&(i[0]=Math.min(t[0],i[0]),r=!0)}}return r?e[e.length-1][1]=t[1]:e.push(t),e}}]),e}();t.CharacterJoinerService=l=n([i(0,u.IBufferService)],l)},5114:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CoreBrowserService=void 0,t.CoreBrowserService=function(){function e(t,r){var n=this;h(this,e),this._textarea=t,this.window=r,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",(function(){return n._isFocused=!0})),this._textarea.addEventListener("blur",(function(){return n._isFocused=!1}))}return f(e,[{key:"dpr",get:function(){return this.window.devicePixelRatio}},{key:"isFocused",get:function(){var e=this;return void 0===this._cachedIsFocused&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask((function(){return e._cachedIsFocused=void 0}))),this._cachedIsFocused}}]),e}()},8934:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MouseService=void 0;var a=r(4725),s=r(9806),o=t.MouseService=function(){function e(t,r){h(this,e),this._renderService=t,this._charSizeService=r}return f(e,[{key:"getCoords",value:function(e,t,r,n,i){return(0,s.getCoords)(window,e,t,r,n,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,i)}},{key:"getMouseReportCoords",value:function(e,t){var r=(0,s.getCoordsRelativeToElement)(window,e,t);if(this._charSizeService.hasValidSize)return r[0]=Math.min(Math.max(r[0],0),this._renderService.dimensions.css.canvas.width-1),r[1]=Math.min(Math.max(r[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(r[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(r[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(r[0]),y:Math.floor(r[1])}}}]),e}();t.MouseService=o=n([i(0,a.IRenderService),i(1,a.ICharSizeService)],o)},3230:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.RenderService=void 0;var s=r(3656),o=r(6193),u=r(5596),c=r(4725),l=r(8460),d=r(844),g=r(7226),y=r(2585),m=t.RenderService=function(e){p(r,e);var t=v(r);function r(e,n,i,c,f,p,v,y){var m;if(h(this,r),(m=t.call(this))._rowCount=e,m._charSizeService=c,m._renderer=m.register(new d.MutableDisposable),m._pausedResizeTask=new g.DebouncedIdleTask,m._isPaused=!1,m._needsFullRefresh=!1,m._isNextRenderRedrawOnly=!0,m._needsSelectionRefresh=!1,m._canvasWidth=0,m._canvasHeight=0,m._selectionState={start:void 0,end:void 0,columnSelectMode:!1},m._onDimensionsChange=m.register(new l.EventEmitter),m.onDimensionsChange=m._onDimensionsChange.event,m._onRenderedViewportChange=m.register(new l.EventEmitter),m.onRenderedViewportChange=m._onRenderedViewportChange.event,m._onRender=m.register(new l.EventEmitter),m.onRender=m._onRender.event,m._onRefreshRequest=m.register(new l.EventEmitter),m.onRefreshRequest=m._onRefreshRequest.event,m._renderDebouncer=new o.RenderDebouncer(v.window,(function(e,t){return m._renderRows(e,t)})),m.register(m._renderDebouncer),m._screenDprMonitor=new u.ScreenDprMonitor(v.window),m._screenDprMonitor.setListener((function(){return m.handleDevicePixelRatioChange()})),m.register(m._screenDprMonitor),m.register(p.onResize((function(){return m._fullRefresh()}))),m.register(p.buffers.onBufferActivate((function(){var e;return null===(e=m._renderer.value)||void 0===e?void 0:e.clear()}))),m.register(i.onOptionChange((function(){return m._handleOptionsChanged()}))),m.register(m._charSizeService.onCharSizeChange((function(){return m.handleCharSizeChanged()}))),m.register(f.onDecorationRegistered((function(){return m._fullRefresh()}))),m.register(f.onDecorationRemoved((function(){return m._fullRefresh()}))),m.register(i.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],(function(){m.clear(),m.handleResize(p.cols,p.rows),m._fullRefresh()}))),m.register(i.onMultipleOptionChange(["cursorBlink","cursorStyle"],(function(){return m.refreshRows(p.buffer.y,p.buffer.y,!0)}))),m.register((0,s.addDisposableDomListener)(v.window,"resize",(function(){return m.handleDevicePixelRatioChange()}))),m.register(y.onChangeColors((function(){return m._fullRefresh()}))),"IntersectionObserver"in v.window){var b=new v.window.IntersectionObserver((function(e){return m._handleIntersectionChange(e[e.length-1])}),{threshold:0});b.observe(n),m.register({dispose:function(){return b.disconnect()}})}return a(m)}return f(r,[{key:"dimensions",get:function(){return this._renderer.value.dimensions}},{key:"_handleIntersectionChange",value:function(e){this._isPaused=void 0===e.isIntersecting?0===e.intersectionRatio:!e.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}},{key:"refreshRows",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._isPaused?this._needsFullRefresh=!0:(r||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(e,t,this._rowCount))}},{key:"_renderRows",value:function(e,t){this._renderer.value&&(e=Math.min(e,this._rowCount-1),t=Math.min(t,this._rowCount-1),this._renderer.value.renderRows(e,t),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:e,end:t}),this._onRender.fire({start:e,end:t}),this._isNextRenderRedrawOnly=!0)}},{key:"resize",value:function(e,t){this._rowCount=t,this._fireOnCanvasResize()}},{key:"_handleOptionsChanged",value:function(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}},{key:"_fireOnCanvasResize",value:function(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}},{key:"hasRenderer",value:function(){return!!this._renderer.value}},{key:"setRenderer",value:function(e){var t=this;this._renderer.value=e,this._renderer.value.onRequestRedraw((function(e){return t.refreshRows(e.start,e.end,!0)})),this._needsSelectionRefresh=!0,this._fullRefresh()}},{key:"addRefreshCallback",value:function(e){return this._renderDebouncer.addRefreshCallback(e)}},{key:"_fullRefresh",value:function(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}},{key:"clearTextureAtlas",value:function(){var e,t;this._renderer.value&&(null===(t=(e=this._renderer.value).clearTextureAtlas)||void 0===t||t.call(e),this._fullRefresh())}},{key:"handleDevicePixelRatioChange",value:function(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}},{key:"handleResize",value:function(e,t){var r=this;this._renderer.value&&(this._isPaused?this._pausedResizeTask.set((function(){return r._renderer.value.handleResize(e,t)})):this._renderer.value.handleResize(e,t),this._fullRefresh())}},{key:"handleCharSizeChanged",value:function(){var e;null===(e=this._renderer.value)||void 0===e||e.handleCharSizeChanged()}},{key:"handleBlur",value:function(){var e;null===(e=this._renderer.value)||void 0===e||e.handleBlur()}},{key:"handleFocus",value:function(){var e;null===(e=this._renderer.value)||void 0===e||e.handleFocus()}},{key:"handleSelectionChanged",value:function(e,t,r){var n;this._selectionState.start=e,this._selectionState.end=t,this._selectionState.columnSelectMode=r,null===(n=this._renderer.value)||void 0===n||n.handleSelectionChanged(e,t,r)}},{key:"handleCursorMove",value:function(){var e;null===(e=this._renderer.value)||void 0===e||e.handleCursorMove()}},{key:"clear",value:function(){var e;null===(e=this._renderer.value)||void 0===e||e.clear()}}]),r}(d.Disposable);t.RenderService=m=n([i(2,y.IOptionsService),i(3,c.ICharSizeService),i(4,y.IDecorationService),i(5,y.IBufferService),i(6,c.ICoreBrowserService),i(7,c.IThemeService)],m)},9312:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionService=void 0;var a=r(9806),s=r(9504),o=r(456),u=r(4725),c=r(8460),l=r(844),d=r(6114),g=r(4841),y=r(511),m=r(2585),b=String.fromCharCode(160),_=new RegExp(b,"g"),w=t.SelectionService=function(e){p(r,e);var t=v(r);function r(e,n,i,a,s,u,f,d,p){var v;return h(this,r),(v=t.call(this))._element=e,v._screenElement=n,v._linkifier=i,v._bufferService=a,v._coreService=s,v._mouseService=u,v._optionsService=f,v._renderService=d,v._coreBrowserService=p,v._dragScrollAmount=0,v._enabled=!0,v._workCell=new y.CellData,v._mouseDownTimeStamp=0,v._oldHasSelection=!1,v._oldSelectionStart=void 0,v._oldSelectionEnd=void 0,v._onLinuxMouseSelection=v.register(new c.EventEmitter),v.onLinuxMouseSelection=v._onLinuxMouseSelection.event,v._onRedrawRequest=v.register(new c.EventEmitter),v.onRequestRedraw=v._onRedrawRequest.event,v._onSelectionChange=v.register(new c.EventEmitter),v.onSelectionChange=v._onSelectionChange.event,v._onRequestScrollLines=v.register(new c.EventEmitter),v.onRequestScrollLines=v._onRequestScrollLines.event,v._mouseMoveListener=function(e){return v._handleMouseMove(e)},v._mouseUpListener=function(e){return v._handleMouseUp(e)},v._coreService.onUserInput((function(){v.hasSelection&&v.clearSelection()})),v._trimListener=v._bufferService.buffer.lines.onTrim((function(e){return v._handleTrim(e)})),v.register(v._bufferService.buffers.onBufferActivate((function(e){return v._handleBufferActivate(e)}))),v.enable(),v._model=new o.SelectionModel(v._bufferService),v._activeSelectionMode=0,v.register((0,l.toDisposable)((function(){v._removeMouseDownListeners()}))),v}return f(r,[{key:"reset",value:function(){this.clearSelection()}},{key:"disable",value:function(){this.clearSelection(),this._enabled=!1}},{key:"enable",value:function(){this._enabled=!0}},{key:"selectionStart",get:function(){return this._model.finalSelectionStart}},{key:"selectionEnd",get:function(){return this._model.finalSelectionEnd}},{key:"hasSelection",get:function(){var e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd;return!(!e||!t||e[0]===t[0]&&e[1]===t[1])}},{key:"selectionText",get:function(){var e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd;if(!e||!t)return"";var r=this._bufferService.buffer,n=[];if(3===this._activeSelectionMode){if(e[0]===t[0])return"";for(var i=e[0]<t[0]?e[0]:t[0],a=e[0]<t[0]?t[0]:e[0],s=e[1];s<=t[1];s++){var o=r.translateBufferLineToString(s,!0,i,a);n.push(o)}}else{var u=e[1]===t[1]?t[0]:void 0;n.push(r.translateBufferLineToString(e[1],!0,e[0],u));for(var c=e[1]+1;c<=t[1]-1;c++){var l=r.lines.get(c),h=r.translateBufferLineToString(c,!0);(null==l?void 0:l.isWrapped)?n[n.length-1]+=h:n.push(h)}if(e[1]!==t[1]){var f=r.lines.get(t[1]),p=r.translateBufferLineToString(t[1],!0,0,t[0]);f&&f.isWrapped?n[n.length-1]+=p:n.push(p)}}return n.map((function(e){return e.replace(_," ")})).join(d.isWindows?"\r\n":"\n")}},{key:"clearSelection",value:function(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}},{key:"refresh",value:function(e){var t=this;this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame((function(){return t._refresh()}))),d.isLinux&&e&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}},{key:"_refresh",value:function(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:3===this._activeSelectionMode})}},{key:"_isClickInSelection",value:function(e){var t=this._getMouseBufferCoords(e),r=this._model.finalSelectionStart,n=this._model.finalSelectionEnd;return!!(r&&n&&t)&&this._areCoordsInSelection(t,r,n)}},{key:"isCellInSelection",value:function(e,t){var r=this._model.finalSelectionStart,n=this._model.finalSelectionEnd;return!(!r||!n)&&this._areCoordsInSelection([e,t],r,n)}},{key:"_areCoordsInSelection",value:function(e,t,r){return e[1]>t[1]&&e[1]<r[1]||t[1]===r[1]&&e[1]===t[1]&&e[0]>=t[0]&&e[0]<r[0]||t[1]<r[1]&&e[1]===r[1]&&e[0]<r[0]||t[1]<r[1]&&e[1]===t[1]&&e[0]>=t[0]}},{key:"_selectWordAtCursor",value:function(e,t){var r,n,i=null===(n=null===(r=this._linkifier.currentLink)||void 0===r?void 0:r.link)||void 0===n?void 0:n.range;if(i)return this._model.selectionStart=[i.start.x-1,i.start.y-1],this._model.selectionStartLength=(0,g.getRangeLength)(i,this._bufferService.cols),this._model.selectionEnd=void 0,!0;var a=this._getMouseBufferCoords(e);return!!a&&(this._selectWordAt(a,t),this._model.selectionEnd=void 0,!0)}},{key:"selectAll",value:function(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}},{key:"selectLines",value:function(e,t){this._model.clearSelection(),e=Math.max(e,0),t=Math.min(t,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,e],this._model.selectionEnd=[this._bufferService.cols,t],this.refresh(),this._onSelectionChange.fire()}},{key:"_handleTrim",value:function(e){this._model.handleTrim(e)&&this.refresh()}},{key:"_getMouseBufferCoords",value:function(e){var t=this._mouseService.getCoords(e,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(t)return t[0]--,t[1]--,t[1]+=this._bufferService.buffer.ydisp,t}},{key:"_getMouseEventScrollAmount",value:function(e){var t=(0,a.getCoordsRelativeToElement)(this._coreBrowserService.window,e,this._screenElement)[1],r=this._renderService.dimensions.css.canvas.height;return t>=0&&t<=r?0:(t>r&&(t-=r),t=Math.min(Math.max(t,-50),50),(t/=50)/Math.abs(t)+Math.round(14*t))}},{key:"shouldForceSelection",value:function(e){return d.isMac?e.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:e.shiftKey}},{key:"handleMouseDown",value:function(e){if(this._mouseDownTimeStamp=e.timeStamp,(2!==e.button||!this.hasSelection)&&0===e.button){if(!this._enabled){if(!this.shouldForceSelection(e))return;e.stopPropagation()}e.preventDefault(),this._dragScrollAmount=0,this._enabled&&e.shiftKey?this._handleIncrementalClick(e):1===e.detail?this._handleSingleClick(e):2===e.detail?this._handleDoubleClick(e):3===e.detail&&this._handleTripleClick(e),this._addMouseDownListeners(),this.refresh(!0)}}},{key:"_addMouseDownListeners",value:function(){var e=this;this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval((function(){return e._dragScroll()}),50)}},{key:"_removeMouseDownListeners",value:function(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}},{key:"_handleIncrementalClick",value:function(e){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(e))}},{key:"_handleSingleClick",value:function(e){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(e)?3:0,this._model.selectionStart=this._getMouseBufferCoords(e),this._model.selectionStart){this._model.selectionEnd=void 0;var t=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);t&&t.length!==this._model.selectionStart[0]&&0===t.hasWidth(this._model.selectionStart[0])&&this._model.selectionStart[0]++}}},{key:"_handleDoubleClick",value:function(e){this._selectWordAtCursor(e,!0)&&(this._activeSelectionMode=1)}},{key:"_handleTripleClick",value:function(e){var t=this._getMouseBufferCoords(e);t&&(this._activeSelectionMode=2,this._selectLineAt(t[1]))}},{key:"shouldColumnSelect",value:function(e){return e.altKey&&!(d.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}},{key:"_handleMouseMove",value:function(e){if(e.stopImmediatePropagation(),this._model.selectionStart){var t=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(e),this._model.selectionEnd){2===this._activeSelectionMode?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:1===this._activeSelectionMode&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(e),3!==this._activeSelectionMode&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));var r=this._bufferService.buffer;if(this._model.selectionEnd[1]<r.lines.length){var n=r.lines.get(this._model.selectionEnd[1]);n&&0===n.hasWidth(this._model.selectionEnd[0])&&this._model.selectionEnd[0]++}t&&t[0]===this._model.selectionEnd[0]&&t[1]===this._model.selectionEnd[1]||this.refresh(!0)}else this.refresh(!0)}}},{key:"_dragScroll",value:function(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});var e=this._bufferService.buffer;this._dragScrollAmount>0?(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(e.ydisp+this._bufferService.rows,e.lines.length-1)):(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=e.ydisp),this.refresh()}}},{key:"_handleMouseUp",value:function(e){var t=e.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&t<500&&e.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){var r=this._mouseService.getCoords(e,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(r&&void 0!==r[0]&&void 0!==r[1]){var n=(0,s.moveToCellSequence)(r[0]-1,r[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(n,!0)}}}else this._fireEventIfSelectionChanged()}},{key:"_fireEventIfSelectionChanged",value:function(){var e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd,r=!(!e||!t||e[0]===t[0]&&e[1]===t[1]);r?e&&t&&(this._oldSelectionStart&&this._oldSelectionEnd&&e[0]===this._oldSelectionStart[0]&&e[1]===this._oldSelectionStart[1]&&t[0]===this._oldSelectionEnd[0]&&t[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(e,t,r)):this._oldHasSelection&&this._fireOnSelectionChange(e,t,r)}},{key:"_fireOnSelectionChange",value:function(e,t,r){this._oldSelectionStart=e,this._oldSelectionEnd=t,this._oldHasSelection=r,this._onSelectionChange.fire()}},{key:"_handleBufferActivate",value:function(e){var t=this;this.clearSelection(),this._trimListener.dispose(),this._trimListener=e.activeBuffer.lines.onTrim((function(e){return t._handleTrim(e)}))}},{key:"_convertViewportColToCharacterIndex",value:function(e,t){for(var r=t,n=0;t>=n;n++){var i=e.loadCell(n,this._workCell).getChars().length;0===this._workCell.getWidth()?r--:i>1&&t!==n&&(r+=i-1)}return r}},{key:"setSelection",value:function(e,t,r){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[e,t],this._model.selectionStartLength=r,this.refresh(),this._fireEventIfSelectionChanged()}},{key:"rightClickSelect",value:function(e){this._isClickInSelection(e)||(this._selectWordAtCursor(e,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}},{key:"_getWordAt",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!(e[0]>=this._bufferService.cols)){var i=this._bufferService.buffer,a=i.lines.get(e[1]);if(a){var s=i.translateBufferLineToString(e[1],!1),o=this._convertViewportColToCharacterIndex(a,e[0]),u=o,c=e[0]-o,l=0,h=0,f=0,d=0;if(" "===s.charAt(o)){for(;o>0&&" "===s.charAt(o-1);)o--;for(;u<s.length&&" "===s.charAt(u+1);)u++}else{var p=e[0],v=e[0];0===a.getWidth(p)&&(l++,p--),2===a.getWidth(v)&&(h++,v++);var g=a.getString(v).length;for(g>1&&(d+=g-1,u+=g-1);p>0&&o>0&&!this._isCharWordSeparator(a.loadCell(p-1,this._workCell));){a.loadCell(p-1,this._workCell);var y=this._workCell.getChars().length;0===this._workCell.getWidth()?(l++,p--):y>1&&(f+=y-1,o-=y-1),o--,p--}for(;v<a.length&&u+1<s.length&&!this._isCharWordSeparator(a.loadCell(v+1,this._workCell));){a.loadCell(v+1,this._workCell);var m=this._workCell.getChars().length;2===this._workCell.getWidth()?(h++,v++):m>1&&(d+=m-1,u+=m-1),u++,v++}}u++;var b=o+c-l+f,_=Math.min(this._bufferService.cols,u-o+l+h-f-d);if(t||""!==s.slice(o,u).trim()){if(r&&0===b&&32!==a.getCodePoint(0)){var w=i.lines.get(e[1]-1);if(w&&a.isWrapped&&32!==w.getCodePoint(this._bufferService.cols-1)){var k=this._getWordAt([this._bufferService.cols-1,e[1]-1],!1,!0,!1);if(k){var x=this._bufferService.cols-k.start;b-=x,_+=x}}}if(n&&b+_===this._bufferService.cols&&32!==a.getCodePoint(this._bufferService.cols-1)){var E=i.lines.get(e[1]+1);if((null==E?void 0:E.isWrapped)&&32!==E.getCodePoint(0)){var S=this._getWordAt([0,e[1]+1],!1,!1,!0);S&&(_+=S.length)}}return{start:b,length:_}}}}}},{key:"_selectWordAt",value:function(e,t){var r=this._getWordAt(e,t);if(r){for(;r.start<0;)r.start+=this._bufferService.cols,e[1]--;this._model.selectionStart=[r.start,e[1]],this._model.selectionStartLength=r.length}}},{key:"_selectToWordAt",value:function(e){var t=this._getWordAt(e,!0);if(t){for(var r=e[1];t.start<0;)t.start+=this._bufferService.cols,r--;if(!this._model.areSelectionValuesReversed())for(;t.start+t.length>this._bufferService.cols;)t.length-=this._bufferService.cols,r++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?t.start:t.start+t.length,r]}}},{key:"_isCharWordSeparator",value:function(e){return 0!==e.getWidth()&&this._optionsService.rawOptions.wordSeparator.indexOf(e.getChars())>=0}},{key:"_selectLineAt",value:function(e){var t=this._bufferService.buffer.getWrappedRangeForLine(e),r={start:{x:0,y:t.first},end:{x:this._bufferService.cols-1,y:t.last}};this._model.selectionStart=[0,t.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,g.getRangeLength)(r,this._bufferService.cols)}}]),r}(l.Disposable);t.SelectionService=w=n([i(3,m.IBufferService),i(4,m.ICoreService),i(5,u.IMouseService),i(6,m.IOptionsService),i(7,u.IRenderService),i(8,u.ICoreBrowserService)],w)},4725:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.IThemeService=t.ICharacterJoinerService=t.ISelectionService=t.IRenderService=t.IMouseService=t.ICoreBrowserService=t.ICharSizeService=void 0;var n=r(8343);t.ICharSizeService=(0,n.createDecorator)("CharSizeService"),t.ICoreBrowserService=(0,n.createDecorator)("CoreBrowserService"),t.IMouseService=(0,n.createDecorator)("MouseService"),t.IRenderService=(0,n.createDecorator)("RenderService"),t.ISelectionService=(0,n.createDecorator)("SelectionService"),t.ICharacterJoinerService=(0,n.createDecorator)("CharacterJoinerService"),t.IThemeService=(0,n.createDecorator)("ThemeService")},6731:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeService=t.DEFAULT_ANSI_COLORS=void 0;var a=r(7239),s=r(8055),o=r(8460),u=r(844),c=r(2585),l=s.css.toColor("#ffffff"),d=s.css.toColor("#000000"),g=s.css.toColor("#ffffff"),y=s.css.toColor("#000000"),m={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};t.DEFAULT_ANSI_COLORS=Object.freeze(function(){for(var e=[s.css.toColor("#2e3436"),s.css.toColor("#cc0000"),s.css.toColor("#4e9a06"),s.css.toColor("#c4a000"),s.css.toColor("#3465a4"),s.css.toColor("#75507b"),s.css.toColor("#06989a"),s.css.toColor("#d3d7cf"),s.css.toColor("#555753"),s.css.toColor("#ef2929"),s.css.toColor("#8ae234"),s.css.toColor("#fce94f"),s.css.toColor("#729fcf"),s.css.toColor("#ad7fa8"),s.css.toColor("#34e2e2"),s.css.toColor("#eeeeec")],t=[0,95,135,175,215,255],r=0;r<216;r++){var n=t[r/36%6|0],i=t[r/6%6|0],a=t[r%6];e.push({css:s.channels.toCss(n,i,a),rgba:s.channels.toRgba(n,i,a)})}for(var o=0;o<24;o++){var u=8+10*o;e.push({css:s.channels.toCss(u,u,u),rgba:s.channels.toRgba(u,u,u)})}return e}());var b=t.ThemeService=function(e){p(n,e);var r=v(n);function n(e){var i;return h(this,n),(i=r.call(this))._optionsService=e,i._contrastCache=new a.ColorContrastCache,i._halfContrastCache=new a.ColorContrastCache,i._onChangeColors=i.register(new o.EventEmitter),i.onChangeColors=i._onChangeColors.event,i._colors={foreground:l,background:d,cursor:g,cursorAccent:y,selectionForeground:void 0,selectionBackgroundTransparent:m,selectionBackgroundOpaque:s.color.blend(d,m),selectionInactiveBackgroundTransparent:m,selectionInactiveBackgroundOpaque:s.color.blend(d,m),ansi:t.DEFAULT_ANSI_COLORS.slice(),contrastCache:i._contrastCache,halfContrastCache:i._halfContrastCache},i._updateRestoreColors(),i._setTheme(i._optionsService.rawOptions.theme),i.register(i._optionsService.onSpecificOptionChange("minimumContrastRatio",(function(){return i._contrastCache.clear()}))),i.register(i._optionsService.onSpecificOptionChange("theme",(function(){return i._setTheme(i._optionsService.rawOptions.theme)}))),i}return f(n,[{key:"colors",get:function(){return this._colors}},{key:"_setTheme",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this._colors;if(r.foreground=_(e.foreground,l),r.background=_(e.background,d),r.cursor=_(e.cursor,g),r.cursorAccent=_(e.cursorAccent,y),r.selectionBackgroundTransparent=_(e.selectionBackground,m),r.selectionBackgroundOpaque=s.color.blend(r.background,r.selectionBackgroundTransparent),r.selectionInactiveBackgroundTransparent=_(e.selectionInactiveBackground,r.selectionBackgroundTransparent),r.selectionInactiveBackgroundOpaque=s.color.blend(r.background,r.selectionInactiveBackgroundTransparent),r.selectionForeground=e.selectionForeground?_(e.selectionForeground,s.NULL_COLOR):void 0,r.selectionForeground===s.NULL_COLOR&&(r.selectionForeground=void 0),s.color.isOpaque(r.selectionBackgroundTransparent)){var n=.3;r.selectionBackgroundTransparent=s.color.opacity(r.selectionBackgroundTransparent,n)}if(s.color.isOpaque(r.selectionInactiveBackgroundTransparent)){var i=.3;r.selectionInactiveBackgroundTransparent=s.color.opacity(r.selectionInactiveBackgroundTransparent,i)}if(r.ansi=t.DEFAULT_ANSI_COLORS.slice(),r.ansi[0]=_(e.black,t.DEFAULT_ANSI_COLORS[0]),r.ansi[1]=_(e.red,t.DEFAULT_ANSI_COLORS[1]),r.ansi[2]=_(e.green,t.DEFAULT_ANSI_COLORS[2]),r.ansi[3]=_(e.yellow,t.DEFAULT_ANSI_COLORS[3]),r.ansi[4]=_(e.blue,t.DEFAULT_ANSI_COLORS[4]),r.ansi[5]=_(e.magenta,t.DEFAULT_ANSI_COLORS[5]),r.ansi[6]=_(e.cyan,t.DEFAULT_ANSI_COLORS[6]),r.ansi[7]=_(e.white,t.DEFAULT_ANSI_COLORS[7]),r.ansi[8]=_(e.brightBlack,t.DEFAULT_ANSI_COLORS[8]),r.ansi[9]=_(e.brightRed,t.DEFAULT_ANSI_COLORS[9]),r.ansi[10]=_(e.brightGreen,t.DEFAULT_ANSI_COLORS[10]),r.ansi[11]=_(e.brightYellow,t.DEFAULT_ANSI_COLORS[11]),r.ansi[12]=_(e.brightBlue,t.DEFAULT_ANSI_COLORS[12]),r.ansi[13]=_(e.brightMagenta,t.DEFAULT_ANSI_COLORS[13]),r.ansi[14]=_(e.brightCyan,t.DEFAULT_ANSI_COLORS[14]),r.ansi[15]=_(e.brightWhite,t.DEFAULT_ANSI_COLORS[15]),e.extendedAnsi)for(var a=Math.min(r.ansi.length-16,e.extendedAnsi.length),o=0;o<a;o++)r.ansi[o+16]=_(e.extendedAnsi[o],t.DEFAULT_ANSI_COLORS[o+16]);this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}},{key:"restoreColor",value:function(e){this._restoreColor(e),this._onChangeColors.fire(this.colors)}},{key:"_restoreColor",value:function(e){if(void 0!==e)switch(e){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[e]=this._restoreColors.ansi[e]}else for(var t=0;t<this._restoreColors.ansi.length;++t)this._colors.ansi[t]=this._restoreColors.ansi[t]}},{key:"modifyColors",value:function(e){e(this._colors),this._onChangeColors.fire(this.colors)}},{key:"_updateRestoreColors",value:function(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}}]),n}(u.Disposable);function _(e,t){if(void 0!==e)try{return s.css.toColor(e)}catch(e){}return t}t.ThemeService=b=n([i(0,c.IOptionsService)],b)},6349:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.CircularList=void 0;var n=r(8460),i=function(e){p(r,e);var t=v(r);function r(e){var i;return h(this,r),(i=t.call(this))._maxLength=e,i.onDeleteEmitter=i.register(new n.EventEmitter),i.onDelete=i.onDeleteEmitter.event,i.onInsertEmitter=i.register(new n.EventEmitter),i.onInsert=i.onInsertEmitter.event,i.onTrimEmitter=i.register(new n.EventEmitter),i.onTrim=i.onTrimEmitter.event,i._array=new Array(i._maxLength),i._startIndex=0,i._length=0,i}return f(r,[{key:"maxLength",get:function(){return this._maxLength},set:function(e){if(this._maxLength!==e){for(var t=new Array(e),r=0;r<Math.min(e,this.length);r++)t[r]=this._array[this._getCyclicIndex(r)];this._array=t,this._maxLength=e,this._startIndex=0}}},{key:"length",get:function(){return this._length},set:function(e){if(e>this._length)for(var t=this._length;t<e;t++)this._array[t]=void 0;this._length=e}},{key:"get",value:function(e){return this._array[this._getCyclicIndex(e)]}},{key:"set",value:function(e,t){this._array[this._getCyclicIndex(e)]=t}},{key:"push",value:function(e){this._array[this._getCyclicIndex(this._length)]=e,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}},{key:"recycle",value:function(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}},{key:"isFull",get:function(){return this._length===this._maxLength}},{key:"pop",value:function(){return this._array[this._getCyclicIndex(this._length---1)]}},{key:"splice",value:function(e,t){if(t){for(var r=e;r<this._length-t;r++)this._array[this._getCyclicIndex(r)]=this._array[this._getCyclicIndex(r+t)];this._length-=t,this.onDeleteEmitter.fire({index:e,amount:t})}for(var n=this._length-1;n>=e;n--)this._array[this._getCyclicIndex(n+(arguments.length<=2?0:arguments.length-2))]=this._array[this._getCyclicIndex(n)];for(var i=0;i<(arguments.length<=2?0:arguments.length-2);i++)this._array[this._getCyclicIndex(e+i)]=i+2<2||arguments.length<=i+2?void 0:arguments[i+2];if((arguments.length<=2?0:arguments.length-2)&&this.onInsertEmitter.fire({index:e,amount:arguments.length<=2?0:arguments.length-2}),this._length+(arguments.length<=2?0:arguments.length-2)>this._maxLength){var a=this._length+(arguments.length<=2?0:arguments.length-2)-this._maxLength;this._startIndex+=a,this._length=this._maxLength,this.onTrimEmitter.fire(a)}else this._length+=arguments.length<=2?0:arguments.length-2}},{key:"trimStart",value:function(e){e>this._length&&(e=this._length),this._startIndex+=e,this._length-=e,this.onTrimEmitter.fire(e)}},{key:"shiftElements",value:function(e,t,r){if(!(t<=0)){if(e<0||e>=this._length)throw new Error("start argument out of range");if(e+r<0)throw new Error("Cannot shift elements in list beyond index 0");if(r>0){for(var n=t-1;n>=0;n--)this.set(e+n+r,this.get(e+n));var i=e+t+r-this._length;if(i>0)for(this._length+=i;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(var a=0;a<t;a++)this.set(e+a+r,this.get(e+a))}}},{key:"_getCyclicIndex",value:function(e){return(this._startIndex+e)%this._maxLength}}]),r}(r(844).Disposable);t.CircularList=i},1439:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.clone=void 0,t.clone=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("object"!=typeof t)return t;var n=Array.isArray(t)?[]:{};for(var i in t)n[i]=r<=1?t[i]:t[i]&&e(t[i],r-1);return n}},8055:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.contrastRatio=t.toPaddedHex=t.rgba=t.rgb=t.css=t.color=t.channels=t.NULL_COLOR=void 0;var n,i,a,s,o,u=r(6114),l=0,h=0,f=0,d=0;function p(e){var t=e.toString(16);return t.length<2?"0"+t:t}function v(e,t){return e<t?(t+.05)/(e+.05):(e+.05)/(t+.05)}t.NULL_COLOR={css:"#00000000",rgba:0},function(e){e.toCss=function(e,t,r,n){return void 0!==n?"#".concat(p(e)).concat(p(t)).concat(p(r)).concat(p(n)):"#".concat(p(e)).concat(p(t)).concat(p(r))},e.toRgba=function(e,t,r){return(e<<24|t<<16|r<<8|(arguments.length>3&&void 0!==arguments[3]?arguments[3]:255))>>>0}}(n||(t.channels=n={})),function(e){function t(e,t){var r,i;return d=Math.round(255*t),r=o.toChannels(e.rgba),i=c(r,3),l=i[0],h=i[1],f=i[2],{css:n.toCss(l,h,f,d),rgba:n.toRgba(l,h,f,d)}}e.blend=function(e,t){if(1===(d=(255&t.rgba)/255))return{css:t.css,rgba:t.rgba};var r=t.rgba>>24&255,i=t.rgba>>16&255,a=t.rgba>>8&255,s=e.rgba>>24&255,o=e.rgba>>16&255,u=e.rgba>>8&255;return l=s+Math.round((r-s)*d),h=o+Math.round((i-o)*d),f=u+Math.round((a-u)*d),{css:n.toCss(l,h,f),rgba:n.toRgba(l,h,f)}},e.isOpaque=function(e){return 255==(255&e.rgba)},e.ensureContrastRatio=function(e,t,r){var n=o.ensureContrastRatio(e.rgba,t.rgba,r);if(n)return o.toColor(n>>24&255,n>>16&255,n>>8&255)},e.opaque=function(e){var t,r,i=(255|e.rgba)>>>0;return t=o.toChannels(i),r=c(t,3),l=r[0],h=r[1],f=r[2],{css:n.toCss(l,h,f),rgba:i}},e.opacity=t,e.multiplyOpacity=function(e,r){return t(e,(d=255&e.rgba)*r/255)},e.toColorRGB=function(e){return[e.rgba>>24&255,e.rgba>>16&255,e.rgba>>8&255]}}(i||(t.color=i={})),function(e){var t,r;if(!u.isNode){var i=document.createElement("canvas");i.width=1,i.height=1;var a=i.getContext("2d",{willReadFrequently:!0});a&&((t=a).globalCompositeOperation="copy",r=t.createLinearGradient(0,0,1,1))}e.toColor=function(e){var i;if(e.match(/#[\da-f]{3,8}/i))switch(e.length){case 4:return l=parseInt(e.slice(1,2).repeat(2),16),h=parseInt(e.slice(2,3).repeat(2),16),f=parseInt(e.slice(3,4).repeat(2),16),o.toColor(l,h,f);case 5:return l=parseInt(e.slice(1,2).repeat(2),16),h=parseInt(e.slice(2,3).repeat(2),16),f=parseInt(e.slice(3,4).repeat(2),16),d=parseInt(e.slice(4,5).repeat(2),16),o.toColor(l,h,f,d);case 7:return{css:e,rgba:(parseInt(e.slice(1),16)<<8|255)>>>0};case 9:return{css:e,rgba:parseInt(e.slice(1),16)>>>0}}var a=e.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(a)return l=parseInt(a[1]),h=parseInt(a[2]),f=parseInt(a[3]),d=Math.round(255*(void 0===a[5]?1:parseFloat(a[5]))),o.toColor(l,h,f,d);if(!t||!r)throw new Error("css.toColor: Unsupported css format");if(t.fillStyle=r,t.fillStyle=e,"string"!=typeof t.fillStyle)throw new Error("css.toColor: Unsupported css format");if(t.fillRect(0,0,1,1),i=c(t.getImageData(0,0,1,1).data,4),l=i[0],h=i[1],f=i[2],255!==(d=i[3]))throw new Error("css.toColor: Unsupported css format");return{rgba:n.toRgba(l,h,f,d),css:e}}}(a||(t.css=a={})),function(e){function t(e,t,r){var n=e/255,i=t/255,a=r/255;return.2126*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.7152*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))+.0722*(a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4))}e.relativeLuminance=function(e){return t(e>>16&255,e>>8&255,255&e)},e.relativeLuminance2=t}(s||(t.rgb=s={})),function(e){function t(e,t,r){for(var n=e>>24&255,i=e>>16&255,a=e>>8&255,o=t>>24&255,u=t>>16&255,c=t>>8&255,l=v(s.relativeLuminance2(o,u,c),s.relativeLuminance2(n,i,a));l<r&&(o>0||u>0||c>0);)o-=Math.max(0,Math.ceil(.1*o)),u-=Math.max(0,Math.ceil(.1*u)),c-=Math.max(0,Math.ceil(.1*c)),l=v(s.relativeLuminance2(o,u,c),s.relativeLuminance2(n,i,a));return(o<<24|u<<16|c<<8|255)>>>0}function r(e,t,r){for(var n=e>>24&255,i=e>>16&255,a=e>>8&255,o=t>>24&255,u=t>>16&255,c=t>>8&255,l=v(s.relativeLuminance2(o,u,c),s.relativeLuminance2(n,i,a));l<r&&(o<255||u<255||c<255);)o=Math.min(255,o+Math.ceil(.1*(255-o))),u=Math.min(255,u+Math.ceil(.1*(255-u))),c=Math.min(255,c+Math.ceil(.1*(255-c))),l=v(s.relativeLuminance2(o,u,c),s.relativeLuminance2(n,i,a));return(o<<24|u<<16|c<<8|255)>>>0}e.ensureContrastRatio=function(e,n,i){var a=s.relativeLuminance(e>>8),o=s.relativeLuminance(n>>8);if(v(a,o)<i){if(o<a){var u=t(e,n,i),c=v(a,s.relativeLuminance(u>>8));if(c<i){var l=r(e,n,i);return c>v(a,s.relativeLuminance(l>>8))?u:l}return u}var h=r(e,n,i),f=v(a,s.relativeLuminance(h>>8));if(f<i){var d=t(e,n,i);return f>v(a,s.relativeLuminance(d>>8))?h:d}return h}},e.reduceLuminance=t,e.increaseLuminance=r,e.toChannels=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]},e.toColor=function(e,t,r,i){return{css:n.toCss(e,t,r,i),rgba:n.toRgba(e,t,r,i)}}}(o||(t.rgba=o={})),t.toPaddedHex=p,t.contrastRatio=v},8969:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.CoreTerminal=void 0;var n=r(844),i=r(2585),a=r(4348),s=r(7866),o=r(744),u=r(7302),c=r(6975),l=r(8460),d=r(1753),g=r(1480),y=r(7994),m=r(9282),b=r(5435),_=r(5981),w=r(2660),k=!1,x=function(e){p(r,e);var t=v(r);function r(e){var f;return h(this,r),(f=t.call(this))._windowsWrappingHeuristics=f.register(new n.MutableDisposable),f._onBinary=f.register(new l.EventEmitter),f.onBinary=f._onBinary.event,f._onData=f.register(new l.EventEmitter),f.onData=f._onData.event,f._onLineFeed=f.register(new l.EventEmitter),f.onLineFeed=f._onLineFeed.event,f._onResize=f.register(new l.EventEmitter),f.onResize=f._onResize.event,f._onWriteParsed=f.register(new l.EventEmitter),f.onWriteParsed=f._onWriteParsed.event,f._onScroll=f.register(new l.EventEmitter),f._instantiationService=new a.InstantiationService,f.optionsService=f.register(new u.OptionsService(e)),f._instantiationService.setService(i.IOptionsService,f.optionsService),f._bufferService=f.register(f._instantiationService.createInstance(o.BufferService)),f._instantiationService.setService(i.IBufferService,f._bufferService),f._logService=f.register(f._instantiationService.createInstance(s.LogService)),f._instantiationService.setService(i.ILogService,f._logService),f.coreService=f.register(f._instantiationService.createInstance(c.CoreService)),f._instantiationService.setService(i.ICoreService,f.coreService),f.coreMouseService=f.register(f._instantiationService.createInstance(d.CoreMouseService)),f._instantiationService.setService(i.ICoreMouseService,f.coreMouseService),f.unicodeService=f.register(f._instantiationService.createInstance(g.UnicodeService)),f._instantiationService.setService(i.IUnicodeService,f.unicodeService),f._charsetService=f._instantiationService.createInstance(y.CharsetService),f._instantiationService.setService(i.ICharsetService,f._charsetService),f._oscLinkService=f._instantiationService.createInstance(w.OscLinkService),f._instantiationService.setService(i.IOscLinkService,f._oscLinkService),f._inputHandler=f.register(new b.InputHandler(f._bufferService,f._charsetService,f.coreService,f._logService,f.optionsService,f._oscLinkService,f.coreMouseService,f.unicodeService)),f.register((0,l.forwardEvent)(f._inputHandler.onLineFeed,f._onLineFeed)),f.register(f._inputHandler),f.register((0,l.forwardEvent)(f._bufferService.onResize,f._onResize)),f.register((0,l.forwardEvent)(f.coreService.onData,f._onData)),f.register((0,l.forwardEvent)(f.coreService.onBinary,f._onBinary)),f.register(f.coreService.onRequestScrollToBottom((function(){return f.scrollToBottom()}))),f.register(f.coreService.onUserInput((function(){return f._writeBuffer.handleUserInput()}))),f.register(f.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],(function(){return f._handleWindowsPtyOptionChange()}))),f.register(f._bufferService.onScroll((function(e){f._onScroll.fire({position:f._bufferService.buffer.ydisp,source:0}),f._inputHandler.markRangeDirty(f._bufferService.buffer.scrollTop,f._bufferService.buffer.scrollBottom)}))),f.register(f._inputHandler.onScroll((function(e){f._onScroll.fire({position:f._bufferService.buffer.ydisp,source:0}),f._inputHandler.markRangeDirty(f._bufferService.buffer.scrollTop,f._bufferService.buffer.scrollBottom)}))),f._writeBuffer=f.register(new _.WriteBuffer((function(e,t){return f._inputHandler.parse(e,t)}))),f.register((0,l.forwardEvent)(f._writeBuffer.onWriteParsed,f._onWriteParsed)),f}return f(r,[{key:"onScroll",get:function(){var e=this;return this._onScrollApi||(this._onScrollApi=this.register(new l.EventEmitter),this._onScroll.event((function(t){var r;null===(r=e._onScrollApi)||void 0===r||r.fire(t.position)}))),this._onScrollApi.event}},{key:"cols",get:function(){return this._bufferService.cols}},{key:"rows",get:function(){return this._bufferService.rows}},{key:"buffers",get:function(){return this._bufferService.buffers}},{key:"options",get:function(){return this.optionsService.options},set:function(e){for(var t in e)this.optionsService.options[t]=e[t]}},{key:"write",value:function(e,t){this._writeBuffer.write(e,t)}},{key:"writeSync",value:function(e,t){this._logService.logLevel<=i.LogLevelEnum.WARN&&!k&&(this._logService.warn("writeSync is unreliable and will be removed soon."),k=!0),this._writeBuffer.writeSync(e,t)}},{key:"resize",value:function(e,t){isNaN(e)||isNaN(t)||(e=Math.max(e,o.MINIMUM_COLS),t=Math.max(t,o.MINIMUM_ROWS),this._bufferService.resize(e,t))}},{key:"scroll",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._bufferService.scroll(e,t)}},{key:"scrollLines",value:function(e,t,r){this._bufferService.scrollLines(e,t,r)}},{key:"scrollPages",value:function(e){this.scrollLines(e*(this.rows-1))}},{key:"scrollToTop",value:function(){this.scrollLines(-this._bufferService.buffer.ydisp)}},{key:"scrollToBottom",value:function(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}},{key:"scrollToLine",value:function(e){var t=e-this._bufferService.buffer.ydisp;0!==t&&this.scrollLines(t)}},{key:"registerEscHandler",value:function(e,t){return this._inputHandler.registerEscHandler(e,t)}},{key:"registerDcsHandler",value:function(e,t){return this._inputHandler.registerDcsHandler(e,t)}},{key:"registerCsiHandler",value:function(e,t){return this._inputHandler.registerCsiHandler(e,t)}},{key:"registerOscHandler",value:function(e,t){return this._inputHandler.registerOscHandler(e,t)}},{key:"_setup",value:function(){this._handleWindowsPtyOptionChange()}},{key:"reset",value:function(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}},{key:"_handleWindowsPtyOptionChange",value:function(){var e=!1,t=this.optionsService.rawOptions.windowsPty;t&&void 0!==t.buildNumber&&void 0!==t.buildNumber?e=!!("conpty"===t.backend&&t.buildNumber<21376):this.optionsService.rawOptions.windowsMode&&(e=!0),e?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}},{key:"_enableWindowsWrappingHeuristics",value:function(){var e=this;if(!this._windowsWrappingHeuristics.value){var t=[];t.push(this.onLineFeed(m.updateWindowsModeWrappedState.bind(null,this._bufferService))),t.push(this.registerCsiHandler({final:"H"},(function(){return(0,m.updateWindowsModeWrappedState)(e._bufferService),!1}))),this._windowsWrappingHeuristics.value=(0,n.toDisposable)((function(){for(var e=0,r=t;e<r.length;e++)r[e].dispose()}))}}}]),r}(n.Disposable);t.CoreTerminal=x},8460:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.forwardEvent=t.EventEmitter=void 0,t.EventEmitter=function(){function e(){h(this,e),this._listeners=[],this._disposed=!1}return f(e,[{key:"event",get:function(){var e=this;return this._event||(this._event=function(t){return e._listeners.push(t),{dispose:function(){if(!e._disposed)for(var r=0;r<e._listeners.length;r++)if(e._listeners[r]===t)return void e._listeners.splice(r,1)}}}),this._event}},{key:"fire",value:function(e,t){for(var r=[],n=0;n<this._listeners.length;n++)r.push(this._listeners[n]);for(var i=0;i<r.length;i++)r[i].call(void 0,e,t)}},{key:"dispose",value:function(){this.clearListeners(),this._disposed=!0}},{key:"clearListeners",value:function(){this._listeners&&(this._listeners.length=0)}}]),e}(),t.forwardEvent=function(e,t){return e((function(e){return t.fire(e)}))}},5435:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InputHandler=t.WindowsOptionsReportType=void 0;var a,s=r(2584),o=r(7116),u=r(2015),c=r(844),l=r(482),d=r(8437),g=r(8460),y=r(643),m=r(511),b=r(3734),_=r(2585),w=r(6242),k=r(6351),x=r(5941),E={"(":0,")":1,"*":2,"+":3,"-":1,".":2},S=131072;function C(e,t){if(e>24)return t.setWinLines||!1;switch(e){case 1:return!!t.restoreWin;case 2:return!!t.minimizeWin;case 3:return!!t.setWinPosition;case 4:return!!t.setWinSizePixels;case 5:return!!t.raiseWin;case 6:return!!t.lowerWin;case 7:return!!t.refreshWin;case 8:return!!t.setWinSizeChars;case 9:return!!t.maximizeWin;case 10:return!!t.fullscreenWin;case 11:return!!t.getWinState;case 13:return!!t.getWinPosition;case 14:return!!t.getWinSizePixels;case 15:return!!t.getScreenSizePixels;case 16:return!!t.getCellSizePixels;case 18:return!!t.getWinSizeChars;case 19:return!!t.getScreenSizeChars;case 20:return!!t.getIconTitle;case 21:return!!t.getWinTitle;case 22:return!!t.pushTitle;case 23:return!!t.popTitle;case 24:return!!t.setWinLines}return!1}!function(e){e[e.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",e[e.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"}(a||(t.WindowsOptionsReportType=a={}));var A=0,D=function(e){p(r,e);var t=v(r);function r(e,n,i,a,c,f,p,v){var y,b=arguments.length>8&&void 0!==arguments[8]?arguments[8]:new u.EscapeSequenceParser;h(this,r),(y=t.call(this))._bufferService=e,y._charsetService=n,y._coreService=i,y._logService=a,y._optionsService=c,y._oscLinkService=f,y._coreMouseService=p,y._unicodeService=v,y._parser=b,y._parseBuffer=new Uint32Array(4096),y._stringDecoder=new l.StringToUtf32,y._utf8Decoder=new l.Utf8ToUtf32,y._workCell=new m.CellData,y._windowTitle="",y._iconName="",y._windowTitleStack=[],y._iconNameStack=[],y._curAttrData=d.DEFAULT_ATTR_DATA.clone(),y._eraseAttrDataInternal=d.DEFAULT_ATTR_DATA.clone(),y._onRequestBell=y.register(new g.EventEmitter),y.onRequestBell=y._onRequestBell.event,y._onRequestRefreshRows=y.register(new g.EventEmitter),y.onRequestRefreshRows=y._onRequestRefreshRows.event,y._onRequestReset=y.register(new g.EventEmitter),y.onRequestReset=y._onRequestReset.event,y._onRequestSendFocus=y.register(new g.EventEmitter),y.onRequestSendFocus=y._onRequestSendFocus.event,y._onRequestSyncScrollBar=y.register(new g.EventEmitter),y.onRequestSyncScrollBar=y._onRequestSyncScrollBar.event,y._onRequestWindowsOptionsReport=y.register(new g.EventEmitter),y.onRequestWindowsOptionsReport=y._onRequestWindowsOptionsReport.event,y._onA11yChar=y.register(new g.EventEmitter),y.onA11yChar=y._onA11yChar.event,y._onA11yTab=y.register(new g.EventEmitter),y.onA11yTab=y._onA11yTab.event,y._onCursorMove=y.register(new g.EventEmitter),y.onCursorMove=y._onCursorMove.event,y._onLineFeed=y.register(new g.EventEmitter),y.onLineFeed=y._onLineFeed.event,y._onScroll=y.register(new g.EventEmitter),y.onScroll=y._onScroll.event,y._onTitleChange=y.register(new g.EventEmitter),y.onTitleChange=y._onTitleChange.event,y._onColor=y.register(new g.EventEmitter),y.onColor=y._onColor.event,y._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},y._specialColors=[256,257,258],y.register(y._parser),y._dirtyRowTracker=new R(y._bufferService),y._activeBuffer=y._bufferService.buffer,y.register(y._bufferService.buffers.onBufferActivate((function(e){return y._activeBuffer=e.activeBuffer}))),y._parser.setCsiHandlerFallback((function(e,t){y._logService.debug("Unknown CSI code: ",{identifier:y._parser.identToString(e),params:t.toArray()})})),y._parser.setEscHandlerFallback((function(e){y._logService.debug("Unknown ESC code: ",{identifier:y._parser.identToString(e)})})),y._parser.setExecuteHandlerFallback((function(e){y._logService.debug("Unknown EXECUTE code: ",{code:e})})),y._parser.setOscHandlerFallback((function(e,t,r){y._logService.debug("Unknown OSC code: ",{identifier:e,action:t,data:r})})),y._parser.setDcsHandlerFallback((function(e,t,r){"HOOK"===t&&(r=r.toArray()),y._logService.debug("Unknown DCS code: ",{identifier:y._parser.identToString(e),action:t,payload:r})})),y._parser.setPrintHandler((function(e,t,r){return y.print(e,t,r)})),y._parser.registerCsiHandler({final:"@"},(function(e){return y.insertChars(e)})),y._parser.registerCsiHandler({intermediates:" ",final:"@"},(function(e){return y.scrollLeft(e)})),y._parser.registerCsiHandler({final:"A"},(function(e){return y.cursorUp(e)})),y._parser.registerCsiHandler({intermediates:" ",final:"A"},(function(e){return y.scrollRight(e)})),y._parser.registerCsiHandler({final:"B"},(function(e){return y.cursorDown(e)})),y._parser.registerCsiHandler({final:"C"},(function(e){return y.cursorForward(e)})),y._parser.registerCsiHandler({final:"D"},(function(e){return y.cursorBackward(e)})),y._parser.registerCsiHandler({final:"E"},(function(e){return y.cursorNextLine(e)})),y._parser.registerCsiHandler({final:"F"},(function(e){return y.cursorPrecedingLine(e)})),y._parser.registerCsiHandler({final:"G"},(function(e){return y.cursorCharAbsolute(e)})),y._parser.registerCsiHandler({final:"H"},(function(e){return y.cursorPosition(e)})),y._parser.registerCsiHandler({final:"I"},(function(e){return y.cursorForwardTab(e)})),y._parser.registerCsiHandler({final:"J"},(function(e){return y.eraseInDisplay(e,!1)})),y._parser.registerCsiHandler({prefix:"?",final:"J"},(function(e){return y.eraseInDisplay(e,!0)})),y._parser.registerCsiHandler({final:"K"},(function(e){return y.eraseInLine(e,!1)})),y._parser.registerCsiHandler({prefix:"?",final:"K"},(function(e){return y.eraseInLine(e,!0)})),y._parser.registerCsiHandler({final:"L"},(function(e){return y.insertLines(e)})),y._parser.registerCsiHandler({final:"M"},(function(e){return y.deleteLines(e)})),y._parser.registerCsiHandler({final:"P"},(function(e){return y.deleteChars(e)})),y._parser.registerCsiHandler({final:"S"},(function(e){return y.scrollUp(e)})),y._parser.registerCsiHandler({final:"T"},(function(e){return y.scrollDown(e)})),y._parser.registerCsiHandler({final:"X"},(function(e){return y.eraseChars(e)})),y._parser.registerCsiHandler({final:"Z"},(function(e){return y.cursorBackwardTab(e)})),y._parser.registerCsiHandler({final:"`"},(function(e){return y.charPosAbsolute(e)})),y._parser.registerCsiHandler({final:"a"},(function(e){return y.hPositionRelative(e)})),y._parser.registerCsiHandler({final:"b"},(function(e){return y.repeatPrecedingCharacter(e)})),y._parser.registerCsiHandler({final:"c"},(function(e){return y.sendDeviceAttributesPrimary(e)})),y._parser.registerCsiHandler({prefix:">",final:"c"},(function(e){return y.sendDeviceAttributesSecondary(e)})),y._parser.registerCsiHandler({final:"d"},(function(e){return y.linePosAbsolute(e)})),y._parser.registerCsiHandler({final:"e"},(function(e){return y.vPositionRelative(e)})),y._parser.registerCsiHandler({final:"f"},(function(e){return y.hVPosition(e)})),y._parser.registerCsiHandler({final:"g"},(function(e){return y.tabClear(e)})),y._parser.registerCsiHandler({final:"h"},(function(e){return y.setMode(e)})),y._parser.registerCsiHandler({prefix:"?",final:"h"},(function(e){return y.setModePrivate(e)})),y._parser.registerCsiHandler({final:"l"},(function(e){return y.resetMode(e)})),y._parser.registerCsiHandler({prefix:"?",final:"l"},(function(e){return y.resetModePrivate(e)})),y._parser.registerCsiHandler({final:"m"},(function(e){return y.charAttributes(e)})),y._parser.registerCsiHandler({final:"n"},(function(e){return y.deviceStatus(e)})),y._parser.registerCsiHandler({prefix:"?",final:"n"},(function(e){return y.deviceStatusPrivate(e)})),y._parser.registerCsiHandler({intermediates:"!",final:"p"},(function(e){return y.softReset(e)})),y._parser.registerCsiHandler({intermediates:" ",final:"q"},(function(e){return y.setCursorStyle(e)})),y._parser.registerCsiHandler({final:"r"},(function(e){return y.setScrollRegion(e)})),y._parser.registerCsiHandler({final:"s"},(function(e){return y.saveCursor(e)})),y._parser.registerCsiHandler({final:"t"},(function(e){return y.windowOptions(e)})),y._parser.registerCsiHandler({final:"u"},(function(e){return y.restoreCursor(e)})),y._parser.registerCsiHandler({intermediates:"'",final:"}"},(function(e){return y.insertColumns(e)})),y._parser.registerCsiHandler({intermediates:"'",final:"~"},(function(e){return y.deleteColumns(e)})),y._parser.registerCsiHandler({intermediates:'"',final:"q"},(function(e){return y.selectProtected(e)})),y._parser.registerCsiHandler({intermediates:"$",final:"p"},(function(e){return y.requestMode(e,!0)})),y._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},(function(e){return y.requestMode(e,!1)})),y._parser.setExecuteHandler(s.C0.BEL,(function(){return y.bell()})),y._parser.setExecuteHandler(s.C0.LF,(function(){return y.lineFeed()})),y._parser.setExecuteHandler(s.C0.VT,(function(){return y.lineFeed()})),y._parser.setExecuteHandler(s.C0.FF,(function(){return y.lineFeed()})),y._parser.setExecuteHandler(s.C0.CR,(function(){return y.carriageReturn()})),y._parser.setExecuteHandler(s.C0.BS,(function(){return y.backspace()})),y._parser.setExecuteHandler(s.C0.HT,(function(){return y.tab()})),y._parser.setExecuteHandler(s.C0.SO,(function(){return y.shiftOut()})),y._parser.setExecuteHandler(s.C0.SI,(function(){return y.shiftIn()})),y._parser.setExecuteHandler(s.C1.IND,(function(){return y.index()})),y._parser.setExecuteHandler(s.C1.NEL,(function(){return y.nextLine()})),y._parser.setExecuteHandler(s.C1.HTS,(function(){return y.tabSet()})),y._parser.registerOscHandler(0,new w.OscHandler((function(e){return y.setTitle(e),y.setIconName(e),!0}))),y._parser.registerOscHandler(1,new w.OscHandler((function(e){return y.setIconName(e)}))),y._parser.registerOscHandler(2,new w.OscHandler((function(e){return y.setTitle(e)}))),y._parser.registerOscHandler(4,new w.OscHandler((function(e){return y.setOrReportIndexedColor(e)}))),y._parser.registerOscHandler(8,new w.OscHandler((function(e){return y.setHyperlink(e)}))),y._parser.registerOscHandler(10,new w.OscHandler((function(e){return y.setOrReportFgColor(e)}))),y._parser.registerOscHandler(11,new w.OscHandler((function(e){return y.setOrReportBgColor(e)}))),y._parser.registerOscHandler(12,new w.OscHandler((function(e){return y.setOrReportCursorColor(e)}))),y._parser.registerOscHandler(104,new w.OscHandler((function(e){return y.restoreIndexedColor(e)}))),y._parser.registerOscHandler(110,new w.OscHandler((function(e){return y.restoreFgColor(e)}))),y._parser.registerOscHandler(111,new w.OscHandler((function(e){return y.restoreBgColor(e)}))),y._parser.registerOscHandler(112,new w.OscHandler((function(e){return y.restoreCursorColor(e)}))),y._parser.registerEscHandler({final:"7"},(function(){return y.saveCursor()})),y._parser.registerEscHandler({final:"8"},(function(){return y.restoreCursor()})),y._parser.registerEscHandler({final:"D"},(function(){return y.index()})),y._parser.registerEscHandler({final:"E"},(function(){return y.nextLine()})),y._parser.registerEscHandler({final:"H"},(function(){return y.tabSet()})),y._parser.registerEscHandler({final:"M"},(function(){return y.reverseIndex()})),y._parser.registerEscHandler({final:"="},(function(){return y.keypadApplicationMode()})),y._parser.registerEscHandler({final:">"},(function(){return y.keypadNumericMode()})),y._parser.registerEscHandler({final:"c"},(function(){return y.fullReset()})),y._parser.registerEscHandler({final:"n"},(function(){return y.setgLevel(2)})),y._parser.registerEscHandler({final:"o"},(function(){return y.setgLevel(3)})),y._parser.registerEscHandler({final:"|"},(function(){return y.setgLevel(3)})),y._parser.registerEscHandler({final:"}"},(function(){return y.setgLevel(2)})),y._parser.registerEscHandler({final:"~"},(function(){return y.setgLevel(1)})),y._parser.registerEscHandler({intermediates:"%",final:"@"},(function(){return y.selectDefaultCharset()})),y._parser.registerEscHandler({intermediates:"%",final:"G"},(function(){return y.selectDefaultCharset()}));var _=function(e){y._parser.registerEscHandler({intermediates:"(",final:e},(function(){return y.selectCharset("("+e)})),y._parser.registerEscHandler({intermediates:")",final:e},(function(){return y.selectCharset(")"+e)})),y._parser.registerEscHandler({intermediates:"*",final:e},(function(){return y.selectCharset("*"+e)})),y._parser.registerEscHandler({intermediates:"+",final:e},(function(){return y.selectCharset("+"+e)})),y._parser.registerEscHandler({intermediates:"-",final:e},(function(){return y.selectCharset("-"+e)})),y._parser.registerEscHandler({intermediates:".",final:e},(function(){return y.selectCharset("."+e)})),y._parser.registerEscHandler({intermediates:"/",final:e},(function(){return y.selectCharset("/"+e)}))};for(var x in o.CHARSETS)_(x);return y._parser.registerEscHandler({intermediates:"#",final:"8"},(function(){return y.screenAlignmentPattern()})),y._parser.setErrorHandler((function(e){return y._logService.error("Parsing error: ",e),e})),y._parser.registerDcsHandler({intermediates:"$",final:"q"},new k.DcsHandler((function(e,t){return y.requestStatusString(e,t)}))),y}return f(r,[{key:"getAttrData",value:function(){return this._curAttrData}},{key:"_preserveStack",value:function(e,t,r,n){this._parseStack.paused=!0,this._parseStack.cursorStartX=e,this._parseStack.cursorStartY=t,this._parseStack.decodedLength=r,this._parseStack.position=n}},{key:"_logSlowResolvingAsync",value:function(e){this._logService.logLevel<=_.LogLevelEnum.WARN&&Promise.race([e,new Promise((function(e,t){return setTimeout((function(){return t("#SLOW_TIMEOUT")}),5e3)}))]).catch((function(e){if("#SLOW_TIMEOUT"!==e)throw e;console.warn("async parser handler taking longer than 5000 ms")}))}},{key:"_getCurrentLinkId",value:function(){return this._curAttrData.extended.urlId}},{key:"parse",value:function(e,t){var r,n=this._activeBuffer.x,i=this._activeBuffer.y,a=0,s=this._parseStack.paused;if(s){if(r=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,t))return this._logSlowResolvingAsync(r),r;n=this._parseStack.cursorStartX,i=this._parseStack.cursorStartY,this._parseStack.paused=!1,e.length>S&&(a=this._parseStack.position+S)}if(this._logService.logLevel<=_.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+' "'.concat("string"==typeof e?e:Array.prototype.map.call(e,(function(e){return String.fromCharCode(e)})).join(""),'"'),"string"==typeof e?e.split("").map((function(e){return e.charCodeAt(0)})):e),this._parseBuffer.length<e.length&&this._parseBuffer.length<S&&(this._parseBuffer=new Uint32Array(Math.min(e.length,S))),s||this._dirtyRowTracker.clearRange(),e.length>S)for(var o=a;o<e.length;o+=S){var u=o+S<e.length?o+S:e.length,c="string"==typeof e?this._stringDecoder.decode(e.substring(o,u),this._parseBuffer):this._utf8Decoder.decode(e.subarray(o,u),this._parseBuffer);if(r=this._parser.parse(this._parseBuffer,c))return this._preserveStack(n,i,c,o),this._logSlowResolvingAsync(r),r}else if(!s){var l="string"==typeof e?this._stringDecoder.decode(e,this._parseBuffer):this._utf8Decoder.decode(e,this._parseBuffer);if(r=this._parser.parse(this._parseBuffer,l))return this._preserveStack(n,i,l,0),this._logSlowResolvingAsync(r),r}this._activeBuffer.x===n&&this._activeBuffer.y===i||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}},{key:"print",value:function(e,t,r){var n,i,a=this._charsetService.charset,s=this._optionsService.rawOptions.screenReaderMode,o=this._bufferService.cols,u=this._coreService.decPrivateModes.wraparound,c=this._coreService.modes.insertMode,h=this._curAttrData,f=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&r-t>0&&2===f.getWidth(this._activeBuffer.x-1)&&f.setCellFromCodePoint(this._activeBuffer.x-1,0,1,h.fg,h.bg,h.extended);for(var d=t;d<r;++d){if(n=e[d],i=this._unicodeService.wcwidth(n),n<127&&a){var p=a[String.fromCharCode(n)];p&&(n=p.charCodeAt(0))}if(s&&this._onA11yChar.fire((0,l.stringFromCodePoint)(n)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),i||!this._activeBuffer.x){if(this._activeBuffer.x+i-1>=o)if(u){for(;this._activeBuffer.x<o;)f.setCellFromCodePoint(this._activeBuffer.x++,0,1,h.fg,h.bg,h.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),f=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=o-1,2===i)continue;if(c&&(f.insertCells(this._activeBuffer.x,i,this._activeBuffer.getNullCell(h),h),2===f.getWidth(o-1)&&f.setCellFromCodePoint(o-1,y.NULL_CELL_CODE,y.NULL_CELL_WIDTH,h.fg,h.bg,h.extended)),f.setCellFromCodePoint(this._activeBuffer.x++,n,i,h.fg,h.bg,h.extended),i>0)for(;--i;)f.setCellFromCodePoint(this._activeBuffer.x++,0,0,h.fg,h.bg,h.extended)}else f.getWidth(this._activeBuffer.x-1)?f.addCodepointToCell(this._activeBuffer.x-1,n):f.addCodepointToCell(this._activeBuffer.x-2,n)}r-t>0&&(f.loadCell(this._activeBuffer.x-1,this._workCell),2===this._workCell.getWidth()||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<o&&r-t>0&&0===f.getWidth(this._activeBuffer.x)&&!f.hasContent(this._activeBuffer.x)&&f.setCellFromCodePoint(this._activeBuffer.x,0,1,h.fg,h.bg,h.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}},{key:"registerCsiHandler",value:function(e,t){var r=this;return"t"!==e.final||e.prefix||e.intermediates?this._parser.registerCsiHandler(e,t):this._parser.registerCsiHandler(e,(function(e){return!C(e.params[0],r._optionsService.rawOptions.windowOptions)||t(e)}))}},{key:"registerDcsHandler",value:function(e,t){return this._parser.registerDcsHandler(e,new k.DcsHandler(t))}},{key:"registerEscHandler",value:function(e,t){return this._parser.registerEscHandler(e,t)}},{key:"registerOscHandler",value:function(e,t){return this._parser.registerOscHandler(e,new w.OscHandler(t))}},{key:"bell",value:function(){return this._onRequestBell.fire(),!0}},{key:"lineFeed",value:function(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}},{key:"carriageReturn",value:function(){return this._activeBuffer.x=0,!0}},{key:"backspace",value:function(){var e;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(0===this._activeBuffer.x&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(null===(e=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))||void 0===e?void 0:e.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;var t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);t.hasWidth(this._activeBuffer.x)&&!t.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}},{key:"tab",value:function(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;var e=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-e),!0}},{key:"shiftOut",value:function(){return this._charsetService.setgLevel(1),!0}},{key:"shiftIn",value:function(){return this._charsetService.setgLevel(0),!0}},{key:"_restrictCursor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._bufferService.cols-1;this._activeBuffer.x=Math.min(e,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}},{key:"_setCursor",value:function(e,t){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=e,this._activeBuffer.y=this._activeBuffer.scrollTop+t):(this._activeBuffer.x=e,this._activeBuffer.y=t),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}},{key:"_moveCursor",value:function(e,t){this._restrictCursor(),this._setCursor(this._activeBuffer.x+e,this._activeBuffer.y+t)}},{key:"cursorUp",value:function(e){var t=this._activeBuffer.y-this._activeBuffer.scrollTop;return t>=0?this._moveCursor(0,-Math.min(t,e.params[0]||1)):this._moveCursor(0,-(e.params[0]||1)),!0}},{key:"cursorDown",value:function(e){var t=this._activeBuffer.scrollBottom-this._activeBuffer.y;return t>=0?this._moveCursor(0,Math.min(t,e.params[0]||1)):this._moveCursor(0,e.params[0]||1),!0}},{key:"cursorForward",value:function(e){return this._moveCursor(e.params[0]||1,0),!0}},{key:"cursorBackward",value:function(e){return this._moveCursor(-(e.params[0]||1),0),!0}},{key:"cursorNextLine",value:function(e){return this.cursorDown(e),this._activeBuffer.x=0,!0}},{key:"cursorPrecedingLine",value:function(e){return this.cursorUp(e),this._activeBuffer.x=0,!0}},{key:"cursorCharAbsolute",value:function(e){return this._setCursor((e.params[0]||1)-1,this._activeBuffer.y),!0}},{key:"cursorPosition",value:function(e){return this._setCursor(e.length>=2?(e.params[1]||1)-1:0,(e.params[0]||1)-1),!0}},{key:"charPosAbsolute",value:function(e){return this._setCursor((e.params[0]||1)-1,this._activeBuffer.y),!0}},{key:"hPositionRelative",value:function(e){return this._moveCursor(e.params[0]||1,0),!0}},{key:"linePosAbsolute",value:function(e){return this._setCursor(this._activeBuffer.x,(e.params[0]||1)-1),!0}},{key:"vPositionRelative",value:function(e){return this._moveCursor(0,e.params[0]||1),!0}},{key:"hVPosition",value:function(e){return this.cursorPosition(e),!0}},{key:"tabClear",value:function(e){var t=e.params[0];return 0===t?delete this._activeBuffer.tabs[this._activeBuffer.x]:3===t&&(this._activeBuffer.tabs={}),!0}},{key:"cursorForwardTab",value:function(e){if(this._activeBuffer.x>=this._bufferService.cols)return!0;for(var t=e.params[0]||1;t--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}},{key:"cursorBackwardTab",value:function(e){if(this._activeBuffer.x>=this._bufferService.cols)return!0;for(var t=e.params[0]||1;t--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}},{key:"selectProtected",value:function(e){var t=e.params[0];return 1===t&&(this._curAttrData.bg|=536870912),2!==t&&0!==t||(this._curAttrData.bg&=-536870913),!0}},{key:"_eraseInBufferLine",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);a.replaceCells(t,r,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),i),n&&(a.isWrapped=!1)}},{key:"_resetBufferLine",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);r&&(r.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),t),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+e),r.isWrapped=!1)}},{key:"eraseInDisplay",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(this._restrictCursor(this._bufferService.cols),e.params[0]){case 0:for(t=this._activeBuffer.y,this._dirtyRowTracker.markDirty(t),this._eraseInBufferLine(t++,this._activeBuffer.x,this._bufferService.cols,0===this._activeBuffer.x,r);t<this._bufferService.rows;t++)this._resetBufferLine(t,r);this._dirtyRowTracker.markDirty(t);break;case 1:for(t=this._activeBuffer.y,this._dirtyRowTracker.markDirty(t),this._eraseInBufferLine(t,0,this._activeBuffer.x+1,!0,r),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(t+1).isWrapped=!1);t--;)this._resetBufferLine(t,r);this._dirtyRowTracker.markDirty(0);break;case 2:for(t=this._bufferService.rows,this._dirtyRowTracker.markDirty(t-1);t--;)this._resetBufferLine(t,r);this._dirtyRowTracker.markDirty(0);break;case 3:var n=this._activeBuffer.lines.length-this._bufferService.rows;n>0&&(this._activeBuffer.lines.trimStart(n),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-n,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-n,0),this._onScroll.fire(0))}return!0}},{key:"eraseInLine",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(this._restrictCursor(this._bufferService.cols),e.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,0===this._activeBuffer.x,t);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,t);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,t)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}},{key:"insertLines",value:function(e){this._restrictCursor();var t=e.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var r=this._activeBuffer.ybase+this._activeBuffer.y,n=this._bufferService.rows-1-this._activeBuffer.scrollBottom,i=this._bufferService.rows-1+this._activeBuffer.ybase-n+1;t--;)this._activeBuffer.lines.splice(i-1,1),this._activeBuffer.lines.splice(r,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}},{key:"deleteLines",value:function(e){this._restrictCursor();var t=e.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;var r,n=this._activeBuffer.ybase+this._activeBuffer.y;for(r=this._bufferService.rows-1-this._activeBuffer.scrollBottom,r=this._bufferService.rows-1+this._activeBuffer.ybase-r;t--;)this._activeBuffer.lines.splice(n,1),this._activeBuffer.lines.splice(r,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}},{key:"insertChars",value:function(e){this._restrictCursor();var t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.insertCells(this._activeBuffer.x,e.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}},{key:"deleteChars",value:function(e){this._restrictCursor();var t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.deleteCells(this._activeBuffer.x,e.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}},{key:"scrollUp",value:function(e){for(var t=e.params[0]||1;t--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}},{key:"scrollDown",value:function(e){for(var t=e.params[0]||1;t--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(d.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}},{key:"scrollLeft",value:function(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var t=e.params[0]||1,r=this._activeBuffer.scrollTop;r<=this._activeBuffer.scrollBottom;++r){var n=this._activeBuffer.lines.get(this._activeBuffer.ybase+r);n.deleteCells(0,t,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),n.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}},{key:"scrollRight",value:function(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var t=e.params[0]||1,r=this._activeBuffer.scrollTop;r<=this._activeBuffer.scrollBottom;++r){var n=this._activeBuffer.lines.get(this._activeBuffer.ybase+r);n.insertCells(0,t,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),n.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}},{key:"insertColumns",value:function(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var t=e.params[0]||1,r=this._activeBuffer.scrollTop;r<=this._activeBuffer.scrollBottom;++r){var n=this._activeBuffer.lines.get(this._activeBuffer.ybase+r);n.insertCells(this._activeBuffer.x,t,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),n.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}},{key:"deleteColumns",value:function(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var t=e.params[0]||1,r=this._activeBuffer.scrollTop;r<=this._activeBuffer.scrollBottom;++r){var n=this._activeBuffer.lines.get(this._activeBuffer.ybase+r);n.deleteCells(this._activeBuffer.x,t,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),n.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}},{key:"eraseChars",value:function(e){this._restrictCursor();var t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(e.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}},{key:"repeatPrecedingCharacter",value:function(e){if(!this._parser.precedingCodepoint)return!0;for(var t=e.params[0]||1,r=new Uint32Array(t),n=0;n<t;++n)r[n]=this._parser.precedingCodepoint;return this.print(r,0,r.length),!0}},{key:"sendDeviceAttributesPrimary",value:function(e){return e.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(s.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(s.C0.ESC+"[?6c")),!0}},{key:"sendDeviceAttributesSecondary",value:function(e){return e.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(s.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(s.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(e.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(s.C0.ESC+"[>83;40003;0c")),!0}},{key:"_is",value:function(e){return 0===(this._optionsService.rawOptions.termName+"").indexOf(e)}},{key:"setMode",value:function(e){for(var t=0;t<e.length;t++)switch(e.params[t]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}},{key:"setModePrivate",value:function(e){for(var t=0;t<e.length;t++)switch(e.params[t]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,o.DEFAULT_CHARSET),this._charsetService.setgCharset(1,o.DEFAULT_CHARSET),this._charsetService.setgCharset(2,o.DEFAULT_CHARSET),this._charsetService.setgCharset(3,o.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}},{key:"resetMode",value:function(e){for(var t=0;t<e.length;t++)switch(e.params[t]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}},{key:"resetModePrivate",value:function(e){for(var t=0;t<e.length;t++)switch(e.params[t]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),1049===e.params[t]&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}},{key:"requestMode",value:function(e,t){var r,n,i=this._coreService.decPrivateModes,a=this._coreMouseService,o=a.activeProtocol,u=a.activeEncoding,c=this._coreService,l=this._bufferService,h=l.buffers,f=l.cols,d=h.active,p=h.alt,v=this._optionsService.rawOptions,g=function(e){return e?1:2},y=e.params[0];return r=y,n=t?2===y?4:4===y?g(c.modes.insertMode):12===y?3:20===y?g(v.convertEol):0:1===y?g(i.applicationCursorKeys):3===y?v.windowOptions.setWinLines?80===f?2:132===f?1:0:0:6===y?g(i.origin):7===y?g(i.wraparound):8===y?3:9===y?g("X10"===o):12===y?g(v.cursorBlink):25===y?g(!c.isCursorHidden):45===y?g(i.reverseWraparound):66===y?g(i.applicationKeypad):67===y?4:1e3===y?g("VT200"===o):1002===y?g("DRAG"===o):1003===y?g("ANY"===o):1004===y?g(i.sendFocus):1005===y?4:1006===y?g("SGR"===u):1015===y?4:1016===y?g("SGR_PIXELS"===u):1048===y?1:47===y||1047===y||1049===y?g(d===p):2004===y?g(i.bracketedPasteMode):0,c.triggerDataEvent("".concat(s.C0.ESC,"[").concat(t?"":"?").concat(r,";").concat(n,"$y")),!0}},{key:"_updateAttrColor",value:function(e,t,r,n,i){return 2===t?(e|=50331648,e&=-16777216,e|=b.AttributeData.fromColorRGB([r,n,i])):5===t&&(e&=-50331904,e|=33554432|255&r),e}},{key:"_extractColor",value:function(e,t,r){var n=[0,0,-1,0,0,0],i=0,a=0;do{if(n[a+i]=e.params[t+a],e.hasSubParams(t+a)){var s=e.getSubParams(t+a),o=0;do{5===n[1]&&(i=1),n[a+o+1+i]=s[o]}while(++o<s.length&&o+a+1+i<n.length);break}if(5===n[1]&&a+i>=2||2===n[1]&&a+i>=5)break;n[1]&&(i=1)}while(++a+t<e.length&&a+i<n.length);for(var u=2;u<n.length;++u)-1===n[u]&&(n[u]=0);switch(n[0]){case 38:r.fg=this._updateAttrColor(r.fg,n[1],n[3],n[4],n[5]);break;case 48:r.bg=this._updateAttrColor(r.bg,n[1],n[3],n[4],n[5]);break;case 58:r.extended=r.extended.clone(),r.extended.underlineColor=this._updateAttrColor(r.extended.underlineColor,n[1],n[3],n[4],n[5])}return a}},{key:"_processUnderline",value:function(e,t){t.extended=t.extended.clone(),(!~e||e>5)&&(e=1),t.extended.underlineStyle=e,t.fg|=268435456,0===e&&(t.fg&=-268435457),t.updateExtended()}},{key:"_processSGR0",value:function(e){e.fg=d.DEFAULT_ATTR_DATA.fg,e.bg=d.DEFAULT_ATTR_DATA.bg,e.extended=e.extended.clone(),e.extended.underlineStyle=0,e.extended.underlineColor&=-67108864,e.updateExtended()}},{key:"charAttributes",value:function(e){if(1===e.length&&0===e.params[0])return this._processSGR0(this._curAttrData),!0;for(var t,r=e.length,n=this._curAttrData,i=0;i<r;i++)(t=e.params[i])>=30&&t<=37?(n.fg&=-50331904,n.fg|=16777216|t-30):t>=40&&t<=47?(n.bg&=-50331904,n.bg|=16777216|t-40):t>=90&&t<=97?(n.fg&=-50331904,n.fg|=16777224|t-90):t>=100&&t<=107?(n.bg&=-50331904,n.bg|=16777224|t-100):0===t?this._processSGR0(n):1===t?n.fg|=134217728:3===t?n.bg|=67108864:4===t?(n.fg|=268435456,this._processUnderline(e.hasSubParams(i)?e.getSubParams(i)[0]:1,n)):5===t?n.fg|=536870912:7===t?n.fg|=67108864:8===t?n.fg|=1073741824:9===t?n.fg|=2147483648:2===t?n.bg|=134217728:21===t?this._processUnderline(2,n):22===t?(n.fg&=-134217729,n.bg&=-134217729):23===t?n.bg&=-67108865:24===t?(n.fg&=-268435457,this._processUnderline(0,n)):25===t?n.fg&=-536870913:27===t?n.fg&=-67108865:28===t?n.fg&=-1073741825:29===t?n.fg&=2147483647:39===t?(n.fg&=-67108864,n.fg|=16777215&d.DEFAULT_ATTR_DATA.fg):49===t?(n.bg&=-67108864,n.bg|=16777215&d.DEFAULT_ATTR_DATA.bg):38===t||48===t||58===t?i+=this._extractColor(e,i,n):53===t?n.bg|=1073741824:55===t?n.bg&=-1073741825:59===t?(n.extended=n.extended.clone(),n.extended.underlineColor=-1,n.updateExtended()):100===t?(n.fg&=-67108864,n.fg|=16777215&d.DEFAULT_ATTR_DATA.fg,n.bg&=-67108864,n.bg|=16777215&d.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",t);return!0}},{key:"deviceStatus",value:function(e){switch(e.params[0]){case 5:this._coreService.triggerDataEvent("".concat(s.C0.ESC,"[0n"));break;case 6:var t=this._activeBuffer.y+1,r=this._activeBuffer.x+1;this._coreService.triggerDataEvent("".concat(s.C0.ESC,"[").concat(t,";").concat(r,"R"))}return!0}},{key:"deviceStatusPrivate",value:function(e){if(6===e.params[0]){var t=this._activeBuffer.y+1,r=this._activeBuffer.x+1;this._coreService.triggerDataEvent("".concat(s.C0.ESC,"[?").concat(t,";").concat(r,"R"))}return!0}},{key:"softReset",value:function(e){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=d.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}},{key:"setCursorStyle",value:function(e){var t=e.params[0]||1;switch(t){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}var r=t%2==1;return this._optionsService.options.cursorBlink=r,!0}},{key:"setScrollRegion",value:function(e){var t,r=e.params[0]||1;return(e.length<2||(t=e.params[1])>this._bufferService.rows||0===t)&&(t=this._bufferService.rows),t>r&&(this._activeBuffer.scrollTop=r-1,this._activeBuffer.scrollBottom=t-1,this._setCursor(0,0)),!0}},{key:"windowOptions",value:function(e){if(!C(e.params[0],this._optionsService.rawOptions.windowOptions))return!0;var t=e.length>1?e.params[1]:0;switch(e.params[0]){case 14:2!==t&&this._onRequestWindowsOptionsReport.fire(a.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(a.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent("".concat(s.C0.ESC,"[8;").concat(this._bufferService.rows,";").concat(this._bufferService.cols,"t"));break;case 22:0!==t&&2!==t||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),0!==t&&1!==t||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:0!==t&&2!==t||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),0!==t&&1!==t||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}},{key:"saveCursor",value:function(e){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}},{key:"restoreCursor",value:function(e){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}},{key:"setTitle",value:function(e){return this._windowTitle=e,this._onTitleChange.fire(e),!0}},{key:"setIconName",value:function(e){return this._iconName=e,!0}},{key:"setOrReportIndexedColor",value:function(e){for(var t=[],r=e.split(";");r.length>1;){var n=r.shift(),i=r.shift();if(/^\d+$/.exec(n)){var a=parseInt(n);if(T(a))if("?"===i)t.push({type:0,index:a});else{var s=(0,x.parseColor)(i);s&&t.push({type:1,index:a,color:s})}}}return t.length&&this._onColor.fire(t),!0}},{key:"setHyperlink",value:function(e){var t=e.split(";");return!(t.length<2)&&(t[1]?this._createHyperlink(t[0],t[1]):!t[0]&&this._finishHyperlink())}},{key:"_createHyperlink",value:function(e,t){this._getCurrentLinkId()&&this._finishHyperlink();var r,n=e.split(":"),i=n.findIndex((function(e){return e.startsWith("id=")}));return-1!==i&&(r=n[i].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:r,uri:t}),this._curAttrData.updateExtended(),!0}},{key:"_finishHyperlink",value:function(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}},{key:"_setOrReportSpecialColor",value:function(e,t){for(var r=e.split(";"),n=0;n<r.length&&!(t>=this._specialColors.length);++n,++t)if("?"===r[n])this._onColor.fire([{type:0,index:this._specialColors[t]}]);else{var i=(0,x.parseColor)(r[n]);i&&this._onColor.fire([{type:1,index:this._specialColors[t],color:i}])}return!0}},{key:"setOrReportFgColor",value:function(e){return this._setOrReportSpecialColor(e,0)}},{key:"setOrReportBgColor",value:function(e){return this._setOrReportSpecialColor(e,1)}},{key:"setOrReportCursorColor",value:function(e){return this._setOrReportSpecialColor(e,2)}},{key:"restoreIndexedColor",value:function(e){if(!e)return this._onColor.fire([{type:2}]),!0;for(var t=[],r=e.split(";"),n=0;n<r.length;++n)if(/^\d+$/.exec(r[n])){var i=parseInt(r[n]);T(i)&&t.push({type:2,index:i})}return t.length&&this._onColor.fire(t),!0}},{key:"restoreFgColor",value:function(e){return this._onColor.fire([{type:2,index:256}]),!0}},{key:"restoreBgColor",value:function(e){return this._onColor.fire([{type:2,index:257}]),!0}},{key:"restoreCursorColor",value:function(e){return this._onColor.fire([{type:2,index:258}]),!0}},{key:"nextLine",value:function(){return this._activeBuffer.x=0,this.index(),!0}},{key:"keypadApplicationMode",value:function(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}},{key:"keypadNumericMode",value:function(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}},{key:"selectDefaultCharset",value:function(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,o.DEFAULT_CHARSET),!0}},{key:"selectCharset",value:function(e){return 2!==e.length?(this.selectDefaultCharset(),!0):("/"===e[0]||this._charsetService.setgCharset(E[e[0]],o.CHARSETS[e[1]]||o.DEFAULT_CHARSET),!0)}},{key:"index",value:function(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}},{key:"tabSet",value:function(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}},{key:"reverseIndex",value:function(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){var e=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,e,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}},{key:"fullReset",value:function(){return this._parser.reset(),this._onRequestReset.fire(),!0}},{key:"reset",value:function(){this._curAttrData=d.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=d.DEFAULT_ATTR_DATA.clone()}},{key:"_eraseAttrData",value:function(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}},{key:"setgLevel",value:function(e){return this._charsetService.setgLevel(e),!0}},{key:"screenAlignmentPattern",value:function(){var e=new m.CellData;e.content=1<<22|"E".charCodeAt(0),e.fg=this._curAttrData.fg,e.bg=this._curAttrData.bg,this._setCursor(0,0);for(var t=0;t<this._bufferService.rows;++t){var r=this._activeBuffer.ybase+this._activeBuffer.y+t,n=this._activeBuffer.lines.get(r);n&&(n.fill(e),n.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}},{key:"requestStatusString",value:function(e,t){var r=this,n=this._bufferService.buffer,i=this._optionsService.rawOptions;return function(e){return r._coreService.triggerDataEvent("".concat(s.C0.ESC).concat(e).concat(s.C0.ESC,"\\")),!0}('"q'===e?"P1$r".concat(this._curAttrData.isProtected()?1:0,'"q'):'"p'===e?'P1$r61;1"p':"r"===e?"P1$r".concat(n.scrollTop+1,";").concat(n.scrollBottom+1,"r"):"m"===e?"P1$r0m":" q"===e?"P1$r".concat({block:2,underline:4,bar:6}[i.cursorStyle]-(i.cursorBlink?1:0)," q"):"P0$r")}},{key:"markRangeDirty",value:function(e,t){this._dirtyRowTracker.markRangeDirty(e,t)}}]),r}(c.Disposable);t.InputHandler=D;var R=function(){function e(t){h(this,e),this._bufferService=t,this.clearRange()}return f(e,[{key:"clearRange",value:function(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}},{key:"markDirty",value:function(e){e<this.start?this.start=e:e>this.end&&(this.end=e)}},{key:"markRangeDirty",value:function(e,t){e>t&&(A=e,e=t,t=A),e<this.start&&(this.start=e),t>this.end&&(this.end=t)}},{key:"markAllDirty",value:function(){this.markRangeDirty(0,this._bufferService.rows-1)}}]),e}();function T(e){return 0<=e&&e<256}R=n([i(0,_.IBufferService)],R)},844:function(e,t){function r(e){var t,r=l(e);try{for(r.s();!(t=r.n()).done;)t.value.dispose()}catch(n){r.e(n)}finally{r.f()}e.length=0}Object.defineProperty(t,"__esModule",{value:!0}),t.getDisposeArrayDisposable=t.disposeArray=t.toDisposable=t.MutableDisposable=t.Disposable=void 0,t.Disposable=function(){function e(){h(this,e),this._disposables=[],this._isDisposed=!1}return f(e,[{key:"dispose",value:function(){this._isDisposed=!0;var e,t=l(this._disposables);try{for(t.s();!(e=t.n()).done;)e.value.dispose()}catch(r){t.e(r)}finally{t.f()}this._disposables.length=0}},{key:"register",value:function(e){return this._disposables.push(e),e}},{key:"unregister",value:function(e){var t=this._disposables.indexOf(e);-1!==t&&this._disposables.splice(t,1)}}]),e}(),t.MutableDisposable=function(){function e(){h(this,e),this._isDisposed=!1}return f(e,[{key:"value",get:function(){return this._isDisposed?void 0:this._value},set:function(e){var t;this._isDisposed||e===this._value||(null===(t=this._value)||void 0===t||t.dispose(),this._value=e)}},{key:"clear",value:function(){this.value=void 0}},{key:"dispose",value:function(){var e;this._isDisposed=!0,null===(e=this._value)||void 0===e||e.dispose(),this._value=void 0}}]),e}(),t.toDisposable=function(e){return{dispose:e}},t.disposeArray=r,t.getDisposeArrayDisposable=function(e){return{dispose:function(){return r(e)}}}},1505:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.FourKeyMap=t.TwoKeyMap=void 0;var r=function(){function e(){h(this,e),this._data={}}return f(e,[{key:"set",value:function(e,t,r){this._data[e]||(this._data[e]={}),this._data[e][t]=r}},{key:"get",value:function(e,t){return this._data[e]?this._data[e][t]:void 0}},{key:"clear",value:function(){this._data={}}}]),e}();t.TwoKeyMap=r,t.FourKeyMap=function(){function e(){h(this,e),this._data=new r}return f(e,[{key:"set",value:function(e,t,n,i,a){this._data.get(e,t)||this._data.set(e,t,new r),this._data.get(e,t).set(n,i,a)}},{key:"get",value:function(e,t,r,n){var i;return null===(i=this._data.get(e,t))||void 0===i?void 0:i.get(r,n)}},{key:"clear",value:function(){this._data.clear()}}]),e}()},6114:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isChromeOS=t.isLinux=t.isWindows=t.isIphone=t.isIpad=t.isMac=t.getSafariVersion=t.isSafari=t.isLegacyEdge=t.isFirefox=t.isNode=void 0,t.isNode="undefined"==typeof navigator;var r=t.isNode?"node":navigator.userAgent,n=t.isNode?"node":navigator.platform;t.isFirefox=r.includes("Firefox"),t.isLegacyEdge=r.includes("Edge"),t.isSafari=/^((?!chrome|android).)*safari/i.test(r),t.getSafariVersion=function(){if(!t.isSafari)return 0;var e=r.match(/Version\/(\d+)/);return null===e||e.length<2?0:parseInt(e[1])},t.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(n),t.isIpad="iPad"===n,t.isIphone="iPhone"===n,t.isWindows=["Windows","Win16","Win32","WinCE"].includes(n),t.isLinux=n.indexOf("Linux")>=0,t.isChromeOS=/\bCrOS\b/.test(r)},6106:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SortedList=void 0;var r=0;t.SortedList=function(){function e(t){h(this,e),this._getKey=t,this._array=[]}return f(e,[{key:"clear",value:function(){this._array.length=0}},{key:"insert",value:function(e){0!==this._array.length?(r=this._search(this._getKey(e)),this._array.splice(r,0,e)):this._array.push(e)}},{key:"delete",value:function(e){if(0===this._array.length)return!1;var t=this._getKey(e);if(void 0===t)return!1;if(-1===(r=this._search(t)))return!1;if(this._getKey(this._array[r])!==t)return!1;do{if(this._array[r]===e)return this._array.splice(r,1),!0}while(++r<this._array.length&&this._getKey(this._array[r])===t);return!1}},{key:"getKeyIterator",value:i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0===this._array.length||(r=this._search(t))<0||r>=this._array.length||this._getKey(this._array[r])!==t){e.next=4;break}case 1:return e.next=3,this._array[r];case 3:if(++r<this._array.length&&this._getKey(this._array[r])===t){e.next=1;break}case 4:case"end":return e.stop()}}),e,this)}))},{key:"forEachByKey",value:function(e,t){if(0!==this._array.length&&!((r=this._search(e))<0||r>=this._array.length)&&this._getKey(this._array[r])===e)do{t(this._array[r])}while(++r<this._array.length&&this._getKey(this._array[r])===e)}},{key:"values",value:function(){return s(this._array).values()}},{key:"_search",value:function(e){for(var t=0,r=this._array.length-1;r>=t;){var n=t+r>>1,i=this._getKey(this._array[n]);if(i>e)r=n-1;else{if(!(i<e)){for(;n>0&&this._getKey(this._array[n-1])===e;)n--;return n}t=n+1}}return t}}]),e}()},7226:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.DebouncedIdleTask=t.IdleTaskQueue=t.PriorityTaskQueue=void 0;var n=r(6114),i=function(){function e(){h(this,e),this._tasks=[],this._i=0}return f(e,[{key:"enqueue",value:function(e){this._tasks.push(e),this._start()}},{key:"flush",value:function(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}},{key:"clear",value:function(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}},{key:"_start",value:function(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}},{key:"_process",value:function(e){this._idleCallback=void 0;for(var t=0,r=0,n=e.timeRemaining(),i=0;this._i<this._tasks.length;){if(t=Date.now(),this._tasks[this._i]()||this._i++,t=Math.max(1,Date.now()-t),1.5*(r=Math.max(t,r))>(i=e.timeRemaining()))return n-t<-20&&console.warn("task queue exceeded allotted deadline by ".concat(Math.abs(Math.round(n-t)),"ms")),void this._start();n=i}this.clear()}}]),e}(),a=function(e){p(r,e);var t=v(r);function r(){return h(this,r),t.apply(this,arguments)}return f(r,[{key:"_requestCallback",value:function(e){var t=this;return setTimeout((function(){return e(t._createDeadline(16))}))}},{key:"_cancelCallback",value:function(e){clearTimeout(e)}},{key:"_createDeadline",value:function(e){var t=Date.now()+e;return{timeRemaining:function(){return Math.max(0,t-Date.now())}}}}]),r}(i);t.PriorityTaskQueue=a,t.IdleTaskQueue=!n.isNode&&"requestIdleCallback"in window?function(e){p(r,e);var t=v(r);function r(){return h(this,r),t.apply(this,arguments)}return f(r,[{key:"_requestCallback",value:function(e){return requestIdleCallback(e)}},{key:"_cancelCallback",value:function(e){cancelIdleCallback(e)}}]),r}(i):a,t.DebouncedIdleTask=function(){function e(){h(this,e),this._queue=new t.IdleTaskQueue}return f(e,[{key:"set",value:function(e){this._queue.clear(),this._queue.enqueue(e)}},{key:"flush",value:function(){this._queue.flush()}}]),e}()},9282:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.updateWindowsModeWrappedState=void 0;var n=r(643);t.updateWindowsModeWrappedState=function(e){var t=e.buffer.lines.get(e.buffer.ybase+e.buffer.y-1),r=null==t?void 0:t.get(e.cols-1),i=e.buffer.lines.get(e.buffer.ybase+e.buffer.y);i&&r&&(i.isWrapped=r[n.CHAR_DATA_CODE_INDEX]!==n.NULL_CELL_CODE&&r[n.CHAR_DATA_CODE_INDEX]!==n.WHITESPACE_CELL_CODE)}},3734:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedAttrs=t.AttributeData=void 0;var r=function(){function e(){h(this,e),this.fg=0,this.bg=0,this.extended=new n}return f(e,[{key:"clone",value:function(){var t=new e;return t.fg=this.fg,t.bg=this.bg,t.extended=this.extended.clone(),t}},{key:"isInverse",value:function(){return 67108864&this.fg}},{key:"isBold",value:function(){return 134217728&this.fg}},{key:"isUnderline",value:function(){return this.hasExtendedAttrs()&&0!==this.extended.underlineStyle?1:268435456&this.fg}},{key:"isBlink",value:function(){return 536870912&this.fg}},{key:"isInvisible",value:function(){return 1073741824&this.fg}},{key:"isItalic",value:function(){return 67108864&this.bg}},{key:"isDim",value:function(){return 134217728&this.bg}},{key:"isStrikethrough",value:function(){return 2147483648&this.fg}},{key:"isProtected",value:function(){return 536870912&this.bg}},{key:"isOverline",value:function(){return 1073741824&this.bg}},{key:"getFgColorMode",value:function(){return 50331648&this.fg}},{key:"getBgColorMode",value:function(){return 50331648&this.bg}},{key:"isFgRGB",value:function(){return 50331648==(50331648&this.fg)}},{key:"isBgRGB",value:function(){return 50331648==(50331648&this.bg)}},{key:"isFgPalette",value:function(){return 16777216==(50331648&this.fg)||33554432==(50331648&this.fg)}},{key:"isBgPalette",value:function(){return 16777216==(50331648&this.bg)||33554432==(50331648&this.bg)}},{key:"isFgDefault",value:function(){return 0==(50331648&this.fg)}},{key:"isBgDefault",value:function(){return 0==(50331648&this.bg)}},{key:"isAttributeDefault",value:function(){return 0===this.fg&&0===this.bg}},{key:"getFgColor",value:function(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}},{key:"getBgColor",value:function(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}},{key:"hasExtendedAttrs",value:function(){return 268435456&this.bg}},{key:"updateExtended",value:function(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}},{key:"getUnderlineColor",value:function(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}},{key:"getUnderlineColorMode",value:function(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}},{key:"isUnderlineColorRGB",value:function(){return 268435456&this.bg&&~this.extended.underlineColor?50331648==(50331648&this.extended.underlineColor):this.isFgRGB()}},{key:"isUnderlineColorPalette",value:function(){return 268435456&this.bg&&~this.extended.underlineColor?16777216==(50331648&this.extended.underlineColor)||33554432==(50331648&this.extended.underlineColor):this.isFgPalette()}},{key:"isUnderlineColorDefault",value:function(){return 268435456&this.bg&&~this.extended.underlineColor?0==(50331648&this.extended.underlineColor):this.isFgDefault()}},{key:"getUnderlineStyle",value:function(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}],[{key:"toColorRGB",value:function(e){return[e>>>16&255,e>>>8&255,255&e]}},{key:"fromColorRGB",value:function(e){return(255&e[0])<<16|(255&e[1])<<8|255&e[2]}}]),e}();t.AttributeData=r;var n=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;h(this,e),this._ext=0,this._urlId=0,this._ext=t,this._urlId=r}return f(e,[{key:"ext",get:function(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext},set:function(e){this._ext=e}},{key:"underlineStyle",get:function(){return this._urlId?5:(469762048&this._ext)>>26},set:function(e){this._ext&=-469762049,this._ext|=e<<26&469762048}},{key:"underlineColor",get:function(){return 67108863&this._ext},set:function(e){this._ext&=-67108864,this._ext|=67108863&e}},{key:"urlId",get:function(){return this._urlId},set:function(e){this._urlId=e}},{key:"clone",value:function(){return new e(this._ext,this._urlId)}},{key:"isEmpty",value:function(){return 0===this.underlineStyle&&0===this._urlId}}]),e}();t.ExtendedAttrs=n},9092:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Buffer=t.MAX_BUFFER_SIZE=void 0;var n=r(6349),i=r(7226),a=r(3734),s=r(8437),o=r(4634),u=r(511),c=r(643),l=r(4863),d=r(7116);t.MAX_BUFFER_SIZE=4294967295,t.Buffer=function(){function e(t,r,a){h(this,e),this._hasScrollback=t,this._optionsService=r,this._bufferService=a,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=s.DEFAULT_ATTR_DATA.clone(),this.savedCharset=d.DEFAULT_CHARSET,this.markers=[],this._nullCell=u.CellData.fromCharData([0,c.NULL_CELL_CHAR,c.NULL_CELL_WIDTH,c.NULL_CELL_CODE]),this._whitespaceCell=u.CellData.fromCharData([0,c.WHITESPACE_CELL_CHAR,c.WHITESPACE_CELL_WIDTH,c.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new i.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new n.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}return f(e,[{key:"getNullCell",value:function(e){return e?(this._nullCell.fg=e.fg,this._nullCell.bg=e.bg,this._nullCell.extended=e.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new a.ExtendedAttrs),this._nullCell}},{key:"getWhitespaceCell",value:function(e){return e?(this._whitespaceCell.fg=e.fg,this._whitespaceCell.bg=e.bg,this._whitespaceCell.extended=e.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new a.ExtendedAttrs),this._whitespaceCell}},{key:"getBlankLine",value:function(e,t){return new s.BufferLine(this._bufferService.cols,this.getNullCell(e),t)}},{key:"hasScrollback",get:function(){return this._hasScrollback&&this.lines.maxLength>this._rows}},{key:"isCursorInViewport",get:function(){var e=this.ybase+this.y-this.ydisp;return e>=0&&e<this._rows}},{key:"_getCorrectBufferLength",value:function(e){if(!this._hasScrollback)return e;var r=e+this._optionsService.rawOptions.scrollback;return r>t.MAX_BUFFER_SIZE?t.MAX_BUFFER_SIZE:r}},{key:"fillViewportRows",value:function(e){if(0===this.lines.length){void 0===e&&(e=s.DEFAULT_ATTR_DATA);for(var t=this._rows;t--;)this.lines.push(this.getBlankLine(e))}}},{key:"clear",value:function(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new n.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}},{key:"resize",value:function(e,t){var r=this,n=this.getNullCell(s.DEFAULT_ATTR_DATA),i=0,a=this._getCorrectBufferLength(t);if(a>this.lines.maxLength&&(this.lines.maxLength=a),this.lines.length>0){if(this._cols<e)for(var o=0;o<this.lines.length;o++)i+=+this.lines.get(o).resize(e,n);var u=0;if(this._rows<t)for(var c=this._rows;c<t;c++)this.lines.length<t+this.ybase&&(this._optionsService.rawOptions.windowsMode||void 0!==this._optionsService.rawOptions.windowsPty.backend||void 0!==this._optionsService.rawOptions.windowsPty.buildNumber?this.lines.push(new s.BufferLine(e,n)):this.ybase>0&&this.lines.length<=this.ybase+this.y+u+1?(this.ybase--,u++,this.ydisp>0&&this.ydisp--):this.lines.push(new s.BufferLine(e,n)));else for(var l=this._rows;l>t;l--)this.lines.length>t+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(a<this.lines.maxLength){var h=this.lines.length-a;h>0&&(this.lines.trimStart(h),this.ybase=Math.max(this.ybase-h,0),this.ydisp=Math.max(this.ydisp-h,0),this.savedY=Math.max(this.savedY-h,0)),this.lines.maxLength=a}this.x=Math.min(this.x,e-1),this.y=Math.min(this.y,t-1),u&&(this.y+=u),this.savedX=Math.min(this.savedX,e-1),this.scrollTop=0}if(this.scrollBottom=t-1,this._isReflowEnabled&&(this._reflow(e,t),this._cols>e))for(var f=0;f<this.lines.length;f++)i+=+this.lines.get(f).resize(e,n);this._cols=e,this._rows=t,this._memoryCleanupQueue.clear(),i>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue((function(){return r._batchedMemoryCleanup()})))}},{key:"_batchedMemoryCleanup",value:function(){var e=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,e=!1);for(var t=0;this._memoryCleanupPosition<this.lines.length;)if((t+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory())>100)return!0;return e}},{key:"_isReflowEnabled",get:function(){var e=this._optionsService.rawOptions.windowsPty;return e&&e.buildNumber?this._hasScrollback&&"conpty"===e.backend&&e.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}},{key:"_reflow",value:function(e,t){this._cols!==e&&(e>this._cols?this._reflowLarger(e,t):this._reflowSmaller(e,t))}},{key:"_reflowLarger",value:function(e,t){var r=(0,o.reflowLargerGetLinesToRemove)(this.lines,this._cols,e,this.ybase+this.y,this.getNullCell(s.DEFAULT_ATTR_DATA));if(r.length>0){var n=(0,o.reflowLargerCreateNewLayout)(this.lines,r);(0,o.reflowLargerApplyNewLayout)(this.lines,n.layout),this._reflowLargerAdjustViewport(e,t,n.countRemoved)}}},{key:"_reflowLargerAdjustViewport",value:function(e,t,r){for(var n=this.getNullCell(s.DEFAULT_ATTR_DATA),i=r;i-- >0;)0===this.ybase?(this.y>0&&this.y--,this.lines.length<t&&this.lines.push(new s.BufferLine(e,n))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-r,0)}},{key:"_reflowSmaller",value:function(e,t){for(var r=this.getNullCell(s.DEFAULT_ATTR_DATA),n=[],i=0,a=this.lines.length-1;a>=0;a--){var u=this.lines.get(a);if(!(!u||!u.isWrapped&&u.getTrimmedLength()<=e)){for(var c=[u];u.isWrapped&&a>0;)u=this.lines.get(--a),c.unshift(u);var l=this.ybase+this.y;if(!(l>=a&&l<a+c.length)){var h=c[c.length-1].getTrimmedLength(),f=(0,o.reflowSmallerGetNewLineLengths)(c,this._cols,e),d=f.length-c.length,p=void 0;p=0===this.ybase&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+d):Math.max(0,this.lines.length-this.lines.maxLength+d);for(var v=[],g=0;g<d;g++){var y=this.getBlankLine(s.DEFAULT_ATTR_DATA,!0);v.push(y)}v.length>0&&(n.push({start:a+c.length+i,newLines:v}),i+=v.length),c.push.apply(c,v);var m=f.length-1,b=f[m];0===b&&(b=f[--m]);for(var _=c.length-d-1,w=h;_>=0;){var k=Math.min(w,b);if(void 0===c[m])break;if(c[m].copyCellsFrom(c[_],w-k,b-k,k,!0),0===(b-=k)&&(b=f[--m]),0===(w-=k)){_--;var x=Math.max(_,0);w=(0,o.getWrappedLineTrimmedLength)(c,x,this._cols)}}for(var E=0;E<c.length;E++)f[E]<e&&c[E].setCell(f[E],r);for(var S=d-p;S-- >0;)0===this.ybase?this.y<t-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+i)-t&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+d,this.ybase+t-1)}}}if(n.length>0){for(var C=[],A=[],D=0;D<this.lines.length;D++)A.push(this.lines.get(D));var R=this.lines.length,T=R-1,Z=0,I=n[Z];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+i);for(var P=0,L=Math.min(this.lines.maxLength-1,R+i-1);L>=0;L--)if(I&&I.start>T+P){for(var M=I.newLines.length-1;M>=0;M--)this.lines.set(L--,I.newLines[M]);L++,C.push({index:T+1,amount:I.newLines.length}),P+=I.newLines.length,I=n[++Z]}else this.lines.set(L,A[T--]);for(var B=0,O=C.length-1;O>=0;O--)C[O].index+=B,this.lines.onInsertEmitter.fire(C[O]),B+=C[O].amount;var N=Math.max(0,R+i-this.lines.maxLength);N>0&&this.lines.onTrimEmitter.fire(N)}}},{key:"translateBufferLineToString",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0,i=this.lines.get(e);return i?i.translateToString(t,r,n):""}},{key:"getWrappedRangeForLine",value:function(e){for(var t=e,r=e;t>0&&this.lines.get(t).isWrapped;)t--;for(;r+1<this.lines.length&&this.lines.get(r+1).isWrapped;)r++;return{first:t,last:r}}},{key:"setupTabStops",value:function(e){for(null!=e?this.tabs[e]||(e=this.prevStop(e)):(this.tabs={},e=0);e<this._cols;e+=this._optionsService.rawOptions.tabStopWidth)this.tabs[e]=!0}},{key:"prevStop",value:function(e){for(null==e&&(e=this.x);!this.tabs[--e]&&e>0;);return e>=this._cols?this._cols-1:e<0?0:e}},{key:"nextStop",value:function(e){for(null==e&&(e=this.x);!this.tabs[++e]&&e<this._cols;);return e>=this._cols?this._cols-1:e<0?0:e}},{key:"clearMarkers",value:function(e){this._isClearing=!0;for(var t=0;t<this.markers.length;t++)this.markers[t].line===e&&(this.markers[t].dispose(),this.markers.splice(t--,1));this._isClearing=!1}},{key:"clearAllMarkers",value:function(){this._isClearing=!0;for(var e=0;e<this.markers.length;e++)this.markers[e].dispose(),this.markers.splice(e--,1);this._isClearing=!1}},{key:"addMarker",value:function(e){var t=this,r=new l.Marker(e);return this.markers.push(r),r.register(this.lines.onTrim((function(e){r.line-=e,r.line<0&&r.dispose()}))),r.register(this.lines.onInsert((function(e){r.line>=e.index&&(r.line+=e.amount)}))),r.register(this.lines.onDelete((function(e){r.line>=e.index&&r.line<e.index+e.amount&&r.dispose(),r.line>e.index&&(r.line-=e.amount)}))),r.register(r.onDispose((function(){return t._removeMarker(r)}))),r}},{key:"_removeMarker",value:function(e){this._isClearing||this.markers.splice(this.markers.indexOf(e),1)}}]),e}()},8437:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLine=t.DEFAULT_ATTR_DATA=void 0;var n=r(3734),i=r(511),a=r(643),s=r(482);t.DEFAULT_ATTR_DATA=Object.freeze(new n.AttributeData);var o=0,u=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];h(this,e),this.isWrapped=n,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*t);for(var s=r||i.CellData.fromCharData([0,a.NULL_CELL_CHAR,a.NULL_CELL_WIDTH,a.NULL_CELL_CODE]),o=0;o<t;++o)this.setCell(o,s);this.length=t}return f(e,[{key:"get",value:function(e){var t=this._data[3*e+0],r=2097151&t;return[this._data[3*e+1],2097152&t?this._combined[e]:r?(0,s.stringFromCodePoint)(r):"",t>>22,2097152&t?this._combined[e].charCodeAt(this._combined[e].length-1):r]}},{key:"set",value:function(e,t){this._data[3*e+1]=t[a.CHAR_DATA_ATTR_INDEX],t[a.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[e]=t[1],this._data[3*e+0]=2097152|e|t[a.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*e+0]=t[a.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|t[a.CHAR_DATA_WIDTH_INDEX]<<22}},{key:"getWidth",value:function(e){return this._data[3*e+0]>>22}},{key:"hasWidth",value:function(e){return 12582912&this._data[3*e+0]}},{key:"getFg",value:function(e){return this._data[3*e+1]}},{key:"getBg",value:function(e){return this._data[3*e+2]}},{key:"hasContent",value:function(e){return 4194303&this._data[3*e+0]}},{key:"getCodePoint",value:function(e){var t=this._data[3*e+0];return 2097152&t?this._combined[e].charCodeAt(this._combined[e].length-1):2097151&t}},{key:"isCombined",value:function(e){return 2097152&this._data[3*e+0]}},{key:"getString",value:function(e){var t=this._data[3*e+0];return 2097152&t?this._combined[e]:2097151&t?(0,s.stringFromCodePoint)(2097151&t):""}},{key:"isProtected",value:function(e){return 536870912&this._data[3*e+2]}},{key:"loadCell",value:function(e,t){return o=3*e,t.content=this._data[o+0],t.fg=this._data[o+1],t.bg=this._data[o+2],2097152&t.content&&(t.combinedData=this._combined[e]),268435456&t.bg&&(t.extended=this._extendedAttrs[e]),t}},{key:"setCell",value:function(e,t){2097152&t.content&&(this._combined[e]=t.combinedData),268435456&t.bg&&(this._extendedAttrs[e]=t.extended),this._data[3*e+0]=t.content,this._data[3*e+1]=t.fg,this._data[3*e+2]=t.bg}},{key:"setCellFromCodePoint",value:function(e,t,r,n,i,a){268435456&i&&(this._extendedAttrs[e]=a),this._data[3*e+0]=t|r<<22,this._data[3*e+1]=n,this._data[3*e+2]=i}},{key:"addCodepointToCell",value:function(e,t){var r=this._data[3*e+0];2097152&r?this._combined[e]+=(0,s.stringFromCodePoint)(t):(2097151&r?(this._combined[e]=(0,s.stringFromCodePoint)(2097151&r)+(0,s.stringFromCodePoint)(t),r&=-2097152,r|=2097152):r=t|1<<22,this._data[3*e+0]=r)}},{key:"insertCells",value:function(e,t,r,a){if((e%=this.length)&&2===this.getWidth(e-1)&&this.setCellFromCodePoint(e-1,0,1,(null==a?void 0:a.fg)||0,(null==a?void 0:a.bg)||0,(null==a?void 0:a.extended)||new n.ExtendedAttrs),t<this.length-e){for(var s=new i.CellData,o=this.length-e-t-1;o>=0;--o)this.setCell(e+t+o,this.loadCell(e+o,s));for(var u=0;u<t;++u)this.setCell(e+u,r)}else for(var c=e;c<this.length;++c)this.setCell(c,r);2===this.getWidth(this.length-1)&&this.setCellFromCodePoint(this.length-1,0,1,(null==a?void 0:a.fg)||0,(null==a?void 0:a.bg)||0,(null==a?void 0:a.extended)||new n.ExtendedAttrs)}},{key:"deleteCells",value:function(e,t,r,a){if(e%=this.length,t<this.length-e){for(var s=new i.CellData,o=0;o<this.length-e-t;++o)this.setCell(e+o,this.loadCell(e+t+o,s));for(var u=this.length-t;u<this.length;++u)this.setCell(u,r)}else for(var c=e;c<this.length;++c)this.setCell(c,r);e&&2===this.getWidth(e-1)&&this.setCellFromCodePoint(e-1,0,1,(null==a?void 0:a.fg)||0,(null==a?void 0:a.bg)||0,(null==a?void 0:a.extended)||new n.ExtendedAttrs),0!==this.getWidth(e)||this.hasContent(e)||this.setCellFromCodePoint(e,0,1,(null==a?void 0:a.fg)||0,(null==a?void 0:a.bg)||0,(null==a?void 0:a.extended)||new n.ExtendedAttrs)}},{key:"replaceCells",value:function(e,t,r,i){if(arguments.length>4&&void 0!==arguments[4]&&arguments[4])for(e&&2===this.getWidth(e-1)&&!this.isProtected(e-1)&&this.setCellFromCodePoint(e-1,0,1,(null==i?void 0:i.fg)||0,(null==i?void 0:i.bg)||0,(null==i?void 0:i.extended)||new n.ExtendedAttrs),t<this.length&&2===this.getWidth(t-1)&&!this.isProtected(t)&&this.setCellFromCodePoint(t,0,1,(null==i?void 0:i.fg)||0,(null==i?void 0:i.bg)||0,(null==i?void 0:i.extended)||new n.ExtendedAttrs);e<t&&e<this.length;)this.isProtected(e)||this.setCell(e,r),e++;else for(e&&2===this.getWidth(e-1)&&this.setCellFromCodePoint(e-1,0,1,(null==i?void 0:i.fg)||0,(null==i?void 0:i.bg)||0,(null==i?void 0:i.extended)||new n.ExtendedAttrs),t<this.length&&2===this.getWidth(t-1)&&this.setCellFromCodePoint(t,0,1,(null==i?void 0:i.fg)||0,(null==i?void 0:i.bg)||0,(null==i?void 0:i.extended)||new n.ExtendedAttrs);e<t&&e<this.length;)this.setCell(e++,r)}},{key:"resize",value:function(e,t){if(e===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;var r=3*e;if(e>this.length){if(this._data.buffer.byteLength>=4*r)this._data=new Uint32Array(this._data.buffer,0,r);else{var n=new Uint32Array(r);n.set(this._data),this._data=n}for(var i=this.length;i<e;++i)this.setCell(i,t)}else{this._data=this._data.subarray(0,r);for(var a=Object.keys(this._combined),s=0;s<a.length;s++){var o=parseInt(a[s],10);o>=e&&delete this._combined[o]}for(var u=Object.keys(this._extendedAttrs),c=0;c<u.length;c++){var l=parseInt(u[c],10);l>=e&&delete this._extendedAttrs[l]}}return this.length=e,4*r*2<this._data.buffer.byteLength}},{key:"cleanupMemory",value:function(){if(4*this._data.length*2<this._data.buffer.byteLength){var e=new Uint32Array(this._data.length);return e.set(this._data),this._data=e,1}return 0}},{key:"fill",value:function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])for(var t=0;t<this.length;++t)this.isProtected(t)||this.setCell(t,e);else{this._combined={},this._extendedAttrs={};for(var r=0;r<this.length;++r)this.setCell(r,e)}}},{key:"copyFrom",value:function(e){for(var t in this.length!==e.length?this._data=new Uint32Array(e._data):this._data.set(e._data),this.length=e.length,this._combined={},e._combined)this._combined[t]=e._combined[t];for(var r in this._extendedAttrs={},e._extendedAttrs)this._extendedAttrs[r]=e._extendedAttrs[r];this.isWrapped=e.isWrapped}},{key:"clone",value:function(){var t=new e(0);for(var r in t._data=new Uint32Array(this._data),t.length=this.length,this._combined)t._combined[r]=this._combined[r];for(var n in this._extendedAttrs)t._extendedAttrs[n]=this._extendedAttrs[n];return t.isWrapped=this.isWrapped,t}},{key:"getTrimmedLength",value:function(){for(var e=this.length-1;e>=0;--e)if(4194303&this._data[3*e+0])return e+(this._data[3*e+0]>>22);return 0}},{key:"getNoBgTrimmedLength",value:function(){for(var e=this.length-1;e>=0;--e)if(4194303&this._data[3*e+0]||50331648&this._data[3*e+2])return e+(this._data[3*e+0]>>22);return 0}},{key:"copyCellsFrom",value:function(e,t,r,n,i){var a=e._data;if(i)for(var s=n-1;s>=0;s--){for(var o=0;o<3;o++)this._data[3*(r+s)+o]=a[3*(t+s)+o];268435456&a[3*(t+s)+2]&&(this._extendedAttrs[r+s]=e._extendedAttrs[t+s])}else for(var u=0;u<n;u++){for(var c=0;c<3;c++)this._data[3*(r+u)+c]=a[3*(t+u)+c];268435456&a[3*(t+u)+2]&&(this._extendedAttrs[r+u]=e._extendedAttrs[t+u])}for(var l=Object.keys(e._combined),h=0;h<l.length;h++){var f=parseInt(l[h],10);f>=t&&(this._combined[f-t+r]=e._combined[f])}}},{key:"translateToString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.length;e&&(r=Math.min(r,this.getTrimmedLength()));for(var n="";t<r;){var i=this._data[3*t+0],o=2097151&i;n+=2097152&i?this._combined[t]:o?(0,s.stringFromCodePoint)(o):a.WHITESPACE_CELL_CHAR,t+=i>>22||1}return n}}]),e}();t.BufferLine=u},4841:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getRangeLength=void 0,t.getRangeLength=function(e,t){if(e.start.y>e.end.y)throw new Error("Buffer range end (".concat(e.end.x,", ").concat(e.end.y,") cannot be before start (").concat(e.start.x,", ").concat(e.start.y,")"));return t*(e.end.y-e.start.y)+(e.end.x-e.start.x+1)}},4634:function(e,t){function r(e,t,r){if(t===e.length-1)return e[t].getTrimmedLength();var n=!e[t].hasContent(r-1)&&1===e[t].getWidth(r-1),i=2===e[t+1].getWidth(0);return n&&i?r-1:r}Object.defineProperty(t,"__esModule",{value:!0}),t.getWrappedLineTrimmedLength=t.reflowSmallerGetNewLineLengths=t.reflowLargerApplyNewLayout=t.reflowLargerCreateNewLayout=t.reflowLargerGetLinesToRemove=void 0,t.reflowLargerGetLinesToRemove=function(e,t,n,i,a){for(var s=[],o=0;o<e.length-1;o++){var u=o,c=e.get(++u);if(c.isWrapped){for(var l=[e.get(o)];u<e.length&&c.isWrapped;)l.push(c),c=e.get(++u);if(i>=o&&i<u)o+=l.length-1;else{for(var h=0,f=r(l,h,t),d=1,p=0;d<l.length;){var v=r(l,d,t),g=v-p,y=n-f,m=Math.min(g,y);l[h].copyCellsFrom(l[d],p,f,m,!1),(f+=m)===n&&(h++,f=0),(p+=m)===v&&(d++,p=0),0===f&&0!==h&&2===l[h-1].getWidth(n-1)&&(l[h].copyCellsFrom(l[h-1],n-1,f++,1,!1),l[h-1].setCell(n-1,a))}l[h].replaceCells(f,n,a);for(var b=0,_=l.length-1;_>0&&(_>h||0===l[_].getTrimmedLength());_--)b++;b>0&&(s.push(o+l.length-b),s.push(b)),o+=l.length-1}}}return s},t.reflowLargerCreateNewLayout=function(e,t){for(var r=[],n=0,i=t[n],a=0,s=0;s<e.length;s++)if(i===s){var o=t[++n];e.onDeleteEmitter.fire({index:s-a,amount:o}),s+=o-1,a+=o,i=t[++n]}else r.push(s);return{layout:r,countRemoved:a}},t.reflowLargerApplyNewLayout=function(e,t){for(var r=[],n=0;n<t.length;n++)r.push(e.get(t[n]));for(var i=0;i<r.length;i++)e.set(i,r[i]);e.length=t.length},t.reflowSmallerGetNewLineLengths=function(e,t,n){for(var i=[],a=e.map((function(n,i){return r(e,i,t)})).reduce((function(e,t){return e+t})),s=0,o=0,u=0;u<a;){if(a-u<n){i.push(a-u);break}s+=n;var c=r(e,o,t);s>c&&(s-=c,o++);var l=2===e[o].getWidth(s-1);l&&s--;var h=l?n-1:n;i.push(h),u+=h}return i},t.getWrappedLineTrimmedLength=r},5295:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.BufferSet=void 0;var n=r(8460),i=r(844),a=r(9092),s=function(e){p(r,e);var t=v(r);function r(e,i){var a;return h(this,r),(a=t.call(this))._optionsService=e,a._bufferService=i,a._onBufferActivate=a.register(new n.EventEmitter),a.onBufferActivate=a._onBufferActivate.event,a.reset(),a.register(a._optionsService.onSpecificOptionChange("scrollback",(function(){return a.resize(a._bufferService.cols,a._bufferService.rows)}))),a.register(a._optionsService.onSpecificOptionChange("tabStopWidth",(function(){return a.setupTabStops()}))),a}return f(r,[{key:"reset",value:function(){this._normal=new a.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new a.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}},{key:"alt",get:function(){return this._alt}},{key:"active",get:function(){return this._activeBuffer}},{key:"normal",get:function(){return this._normal}},{key:"activateNormalBuffer",value:function(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}},{key:"activateAltBuffer",value:function(e){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(e),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}},{key:"resize",value:function(e,t){this._normal.resize(e,t),this._alt.resize(e,t),this.setupTabStops(e)}},{key:"setupTabStops",value:function(e){this._normal.setupTabStops(e),this._alt.setupTabStops(e)}}]),r}(i.Disposable);t.BufferSet=s},511:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.CellData=void 0;var n=r(482),i=r(643),a=r(3734),s=function(e){p(r,e);var t=v(r);function r(){var e;return h(this,r),(e=t.apply(this,arguments)).content=0,e.fg=0,e.bg=0,e.extended=new a.ExtendedAttrs,e.combinedData="",e}return f(r,[{key:"isCombined",value:function(){return 2097152&this.content}},{key:"getWidth",value:function(){return this.content>>22}},{key:"getChars",value:function(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,n.stringFromCodePoint)(2097151&this.content):""}},{key:"getCode",value:function(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}},{key:"setFromCharData",value:function(e){this.fg=e[i.CHAR_DATA_ATTR_INDEX],this.bg=0;var t=!1;if(e[i.CHAR_DATA_CHAR_INDEX].length>2)t=!0;else if(2===e[i.CHAR_DATA_CHAR_INDEX].length){var r=e[i.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=r&&r<=56319){var n=e[i.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=n&&n<=57343?this.content=1024*(r-55296)+n-56320+65536|e[i.CHAR_DATA_WIDTH_INDEX]<<22:t=!0}else t=!0}else this.content=e[i.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|e[i.CHAR_DATA_WIDTH_INDEX]<<22;t&&(this.combinedData=e[i.CHAR_DATA_CHAR_INDEX],this.content=2097152|e[i.CHAR_DATA_WIDTH_INDEX]<<22)}},{key:"getAsCharData",value:function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}],[{key:"fromCharData",value:function(e){var t=new r;return t.setFromCharData(e),t}}]),r}(a.AttributeData);t.CellData=s},643:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.WHITESPACE_CELL_CODE=t.WHITESPACE_CELL_WIDTH=t.WHITESPACE_CELL_CHAR=t.NULL_CELL_CODE=t.NULL_CELL_WIDTH=t.NULL_CELL_CHAR=t.CHAR_DATA_CODE_INDEX=t.CHAR_DATA_WIDTH_INDEX=t.CHAR_DATA_CHAR_INDEX=t.CHAR_DATA_ATTR_INDEX=t.DEFAULT_EXT=t.DEFAULT_ATTR=t.DEFAULT_COLOR=void 0,t.DEFAULT_COLOR=0,t.DEFAULT_ATTR=256|t.DEFAULT_COLOR<<9,t.DEFAULT_EXT=0,t.CHAR_DATA_ATTR_INDEX=0,t.CHAR_DATA_CHAR_INDEX=1,t.CHAR_DATA_WIDTH_INDEX=2,t.CHAR_DATA_CODE_INDEX=3,t.NULL_CELL_CHAR="",t.NULL_CELL_WIDTH=1,t.NULL_CELL_CODE=0,t.WHITESPACE_CELL_CHAR=" ",t.WHITESPACE_CELL_WIDTH=1,t.WHITESPACE_CELL_CODE=32},4863:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Marker=void 0;var n=r(8460),i=r(844),a=function(){function e(t){h(this,e),this.line=t,this.isDisposed=!1,this._disposables=[],this._id=e._nextId++,this._onDispose=this.register(new n.EventEmitter),this.onDispose=this._onDispose.event}return f(e,[{key:"id",get:function(){return this._id}},{key:"dispose",value:function(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,i.disposeArray)(this._disposables),this._disposables.length=0)}},{key:"register",value:function(e){return this._disposables.push(e),e}}]),e}();t.Marker=a,a._nextId=1},7116:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_CHARSET=t.CHARSETS=void 0,t.CHARSETS={},t.DEFAULT_CHARSET=t.CHARSETS.B,t.CHARSETS[0]={"`":"\u25c6",a:"\u2592",b:"\u2409",c:"\u240c",d:"\u240d",e:"\u240a",f:"\xb0",g:"\xb1",h:"\u2424",i:"\u240b",j:"\u2518",k:"\u2510",l:"\u250c",m:"\u2514",n:"\u253c",o:"\u23ba",p:"\u23bb",q:"\u2500",r:"\u23bc",s:"\u23bd",t:"\u251c",u:"\u2524",v:"\u2534",w:"\u252c",x:"\u2502",y:"\u2264",z:"\u2265","{":"\u03c0","|":"\u2260","}":"\xa3","~":"\xb7"},t.CHARSETS.A={"#":"\xa3"},t.CHARSETS.B=void 0,t.CHARSETS[4]={"#":"\xa3","@":"\xbe","[":"ij","\\":"\xbd","]":"|","{":"\xa8","|":"f","}":"\xbc","~":"\xb4"},t.CHARSETS.C=t.CHARSETS[5]={"[":"\xc4","\\":"\xd6","]":"\xc5","^":"\xdc","`":"\xe9","{":"\xe4","|":"\xf6","}":"\xe5","~":"\xfc"},t.CHARSETS.R={"#":"\xa3","@":"\xe0","[":"\xb0","\\":"\xe7","]":"\xa7","{":"\xe9","|":"\xf9","}":"\xe8","~":"\xa8"},t.CHARSETS.Q={"@":"\xe0","[":"\xe2","\\":"\xe7","]":"\xea","^":"\xee","`":"\xf4","{":"\xe9","|":"\xf9","}":"\xe8","~":"\xfb"},t.CHARSETS.K={"@":"\xa7","[":"\xc4","\\":"\xd6","]":"\xdc","{":"\xe4","|":"\xf6","}":"\xfc","~":"\xdf"},t.CHARSETS.Y={"#":"\xa3","@":"\xa7","[":"\xb0","\\":"\xe7","]":"\xe9","`":"\xf9","{":"\xe0","|":"\xf2","}":"\xe8","~":"\xec"},t.CHARSETS.E=t.CHARSETS[6]={"@":"\xc4","[":"\xc6","\\":"\xd8","]":"\xc5","^":"\xdc","`":"\xe4","{":"\xe6","|":"\xf8","}":"\xe5","~":"\xfc"},t.CHARSETS.Z={"#":"\xa3","@":"\xa7","[":"\xa1","\\":"\xd1","]":"\xbf","{":"\xb0","|":"\xf1","}":"\xe7"},t.CHARSETS.H=t.CHARSETS[7]={"@":"\xc9","[":"\xc4","\\":"\xd6","]":"\xc5","^":"\xdc","`":"\xe9","{":"\xe4","|":"\xf6","}":"\xe5","~":"\xfc"},t.CHARSETS["="]={"#":"\xf9","@":"\xe0","[":"\xe9","\\":"\xe7","]":"\xea","^":"\xee",_:"\xe8","`":"\xf4","{":"\xe4","|":"\xf6","}":"\xfc","~":"\xfb"}},2584:function(e,t){var r,n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.C1_ESCAPED=t.C1=t.C0=void 0,function(e){e.NUL="\0",e.SOH="\x01",e.STX="\x02",e.ETX="\x03",e.EOT="\x04",e.ENQ="\x05",e.ACK="\x06",e.BEL="\x07",e.BS="\b",e.HT="\t",e.LF="\n",e.VT="\v",e.FF="\f",e.CR="\r",e.SO="\x0e",e.SI="\x0f",e.DLE="\x10",e.DC1="\x11",e.DC2="\x12",e.DC3="\x13",e.DC4="\x14",e.NAK="\x15",e.SYN="\x16",e.ETB="\x17",e.CAN="\x18",e.EM="\x19",e.SUB="\x1a",e.ESC="\x1b",e.FS="\x1c",e.GS="\x1d",e.RS="\x1e",e.US="\x1f",e.SP=" ",e.DEL="\x7f"}(r||(t.C0=r={})),function(e){e.PAD="\x80",e.HOP="\x81",e.BPH="\x82",e.NBH="\x83",e.IND="\x84",e.NEL="\x85",e.SSA="\x86",e.ESA="\x87",e.HTS="\x88",e.HTJ="\x89",e.VTS="\x8a",e.PLD="\x8b",e.PLU="\x8c",e.RI="\x8d",e.SS2="\x8e",e.SS3="\x8f",e.DCS="\x90",e.PU1="\x91",e.PU2="\x92",e.STS="\x93",e.CCH="\x94",e.MW="\x95",e.SPA="\x96",e.EPA="\x97",e.SOS="\x98",e.SGCI="\x99",e.SCI="\x9a",e.CSI="\x9b",e.ST="\x9c",e.OSC="\x9d",e.PM="\x9e",e.APC="\x9f"}(n||(t.C1=n={})),function(e){e.ST="".concat(r.ESC,"\\")}(i||(t.C1_ESCAPED=i={}))},7399:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateKeyboardEvent=void 0;var n=r(2584),i={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};t.evaluateKeyboardEvent=function(e,t,r,a){var s={type:0,cancel:!1,key:void 0},o=(e.shiftKey?1:0)|(e.altKey?2:0)|(e.ctrlKey?4:0)|(e.metaKey?8:0);switch(e.keyCode){case 0:"UIKeyInputUpArrow"===e.key?s.key=t?n.C0.ESC+"OA":n.C0.ESC+"[A":"UIKeyInputLeftArrow"===e.key?s.key=t?n.C0.ESC+"OD":n.C0.ESC+"[D":"UIKeyInputRightArrow"===e.key?s.key=t?n.C0.ESC+"OC":n.C0.ESC+"[C":"UIKeyInputDownArrow"===e.key&&(s.key=t?n.C0.ESC+"OB":n.C0.ESC+"[B");break;case 8:if(e.altKey){s.key=n.C0.ESC+n.C0.DEL;break}s.key=n.C0.DEL;break;case 9:if(e.shiftKey){s.key=n.C0.ESC+"[Z";break}s.key=n.C0.HT,s.cancel=!0;break;case 13:s.key=e.altKey?n.C0.ESC+n.C0.CR:n.C0.CR,s.cancel=!0;break;case 27:s.key=n.C0.ESC,e.altKey&&(s.key=n.C0.ESC+n.C0.ESC),s.cancel=!0;break;case 37:if(e.metaKey)break;o?(s.key=n.C0.ESC+"[1;"+(o+1)+"D",s.key===n.C0.ESC+"[1;3D"&&(s.key=n.C0.ESC+(r?"b":"[1;5D"))):s.key=t?n.C0.ESC+"OD":n.C0.ESC+"[D";break;case 39:if(e.metaKey)break;o?(s.key=n.C0.ESC+"[1;"+(o+1)+"C",s.key===n.C0.ESC+"[1;3C"&&(s.key=n.C0.ESC+(r?"f":"[1;5C"))):s.key=t?n.C0.ESC+"OC":n.C0.ESC+"[C";break;case 38:if(e.metaKey)break;o?(s.key=n.C0.ESC+"[1;"+(o+1)+"A",r||s.key!==n.C0.ESC+"[1;3A"||(s.key=n.C0.ESC+"[1;5A")):s.key=t?n.C0.ESC+"OA":n.C0.ESC+"[A";break;case 40:if(e.metaKey)break;o?(s.key=n.C0.ESC+"[1;"+(o+1)+"B",r||s.key!==n.C0.ESC+"[1;3B"||(s.key=n.C0.ESC+"[1;5B")):s.key=t?n.C0.ESC+"OB":n.C0.ESC+"[B";break;case 45:e.shiftKey||e.ctrlKey||(s.key=n.C0.ESC+"[2~");break;case 46:s.key=o?n.C0.ESC+"[3;"+(o+1)+"~":n.C0.ESC+"[3~";break;case 36:s.key=o?n.C0.ESC+"[1;"+(o+1)+"H":t?n.C0.ESC+"OH":n.C0.ESC+"[H";break;case 35:s.key=o?n.C0.ESC+"[1;"+(o+1)+"F":t?n.C0.ESC+"OF":n.C0.ESC+"[F";break;case 33:e.shiftKey?s.type=2:e.ctrlKey?s.key=n.C0.ESC+"[5;"+(o+1)+"~":s.key=n.C0.ESC+"[5~";break;case 34:e.shiftKey?s.type=3:e.ctrlKey?s.key=n.C0.ESC+"[6;"+(o+1)+"~":s.key=n.C0.ESC+"[6~";break;case 112:s.key=o?n.C0.ESC+"[1;"+(o+1)+"P":n.C0.ESC+"OP";break;case 113:s.key=o?n.C0.ESC+"[1;"+(o+1)+"Q":n.C0.ESC+"OQ";break;case 114:s.key=o?n.C0.ESC+"[1;"+(o+1)+"R":n.C0.ESC+"OR";break;case 115:s.key=o?n.C0.ESC+"[1;"+(o+1)+"S":n.C0.ESC+"OS";break;case 116:s.key=o?n.C0.ESC+"[15;"+(o+1)+"~":n.C0.ESC+"[15~";break;case 117:s.key=o?n.C0.ESC+"[17;"+(o+1)+"~":n.C0.ESC+"[17~";break;case 118:s.key=o?n.C0.ESC+"[18;"+(o+1)+"~":n.C0.ESC+"[18~";break;case 119:s.key=o?n.C0.ESC+"[19;"+(o+1)+"~":n.C0.ESC+"[19~";break;case 120:s.key=o?n.C0.ESC+"[20;"+(o+1)+"~":n.C0.ESC+"[20~";break;case 121:s.key=o?n.C0.ESC+"[21;"+(o+1)+"~":n.C0.ESC+"[21~";break;case 122:s.key=o?n.C0.ESC+"[23;"+(o+1)+"~":n.C0.ESC+"[23~";break;case 123:s.key=o?n.C0.ESC+"[24;"+(o+1)+"~":n.C0.ESC+"[24~";break;default:if(!e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)if(r&&!a||!e.altKey||e.metaKey)!r||e.altKey||e.ctrlKey||e.shiftKey||!e.metaKey?e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&e.keyCode>=48&&1===e.key.length?s.key=e.key:e.key&&e.ctrlKey&&("_"===e.key&&(s.key=n.C0.US),"@"===e.key&&(s.key=n.C0.NUL)):65===e.keyCode&&(s.type=1);else{var u=i[e.keyCode],c=null==u?void 0:u[e.shiftKey?1:0];if(c)s.key=n.C0.ESC+c;else if(e.keyCode>=65&&e.keyCode<=90){var l=e.ctrlKey?e.keyCode-64:e.keyCode+32,h=String.fromCharCode(l);e.shiftKey&&(h=h.toUpperCase()),s.key=n.C0.ESC+h}else if(32===e.keyCode)s.key=n.C0.ESC+(e.ctrlKey?n.C0.NUL:" ");else if("Dead"===e.key&&e.code.startsWith("Key")){var f=e.code.slice(3,4);e.shiftKey||(f=f.toLowerCase()),s.key=n.C0.ESC+f,s.cancel=!0}}else e.keyCode>=65&&e.keyCode<=90?s.key=String.fromCharCode(e.keyCode-64):32===e.keyCode?s.key=n.C0.NUL:e.keyCode>=51&&e.keyCode<=55?s.key=String.fromCharCode(e.keyCode-51+27):56===e.keyCode?s.key=n.C0.DEL:219===e.keyCode?s.key=n.C0.ESC:220===e.keyCode?s.key=n.C0.FS:221===e.keyCode&&(s.key=n.C0.GS)}return s}},482:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Utf8ToUtf32=t.StringToUtf32=t.utf32ToString=t.stringFromCodePoint=void 0,t.stringFromCodePoint=function(e){return e>65535?(e-=65536,String.fromCharCode(55296+(e>>10))+String.fromCharCode(e%1024+56320)):String.fromCharCode(e)},t.utf32ToString=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,n="",i=t;i<r;++i){var a=e[i];a>65535?(a-=65536,n+=String.fromCharCode(55296+(a>>10))+String.fromCharCode(a%1024+56320)):n+=String.fromCharCode(a)}return n},t.StringToUtf32=function(){function e(){h(this,e),this._interim=0}return f(e,[{key:"clear",value:function(){this._interim=0}},{key:"decode",value:function(e,t){var r=e.length;if(!r)return 0;var n=0,i=0;if(this._interim){var a=e.charCodeAt(i++);56320<=a&&a<=57343?t[n++]=1024*(this._interim-55296)+a-56320+65536:(t[n++]=this._interim,t[n++]=a),this._interim=0}for(var s=i;s<r;++s){var o=e.charCodeAt(s);if(55296<=o&&o<=56319){if(++s>=r)return this._interim=o,n;var u=e.charCodeAt(s);56320<=u&&u<=57343?t[n++]=1024*(o-55296)+u-56320+65536:(t[n++]=o,t[n++]=u)}else 65279!==o&&(t[n++]=o)}return n}}]),e}(),t.Utf8ToUtf32=function(){function e(){h(this,e),this.interim=new Uint8Array(3)}return f(e,[{key:"clear",value:function(){this.interim.fill(0)}},{key:"decode",value:function(e,t){var r=e.length;if(!r)return 0;var n,i,a,s,o=0,u=0,c=0;if(this.interim[0]){var l=!1,h=this.interim[0];h&=192==(224&h)?31:224==(240&h)?15:7;for(var f,d=0;(f=63&this.interim[++d])&&d<4;)h<<=6,h|=f;for(var p=192==(224&this.interim[0])?2:224==(240&this.interim[0])?3:4,v=p-d;c<v;){if(c>=r)return 0;if(128!=(192&(f=e[c++]))){c--,l=!0;break}this.interim[d++]=f,h<<=6,h|=63&f}l||(2===p?h<128?c--:t[o++]=h:3===p?h<2048||h>=55296&&h<=57343||65279===h||(t[o++]=h):h<65536||h>1114111||(t[o++]=h)),this.interim.fill(0)}for(var g=r-4,y=c;y<r;){for(;!(!(y<g)||128&(n=e[y])||128&(i=e[y+1])||128&(a=e[y+2])||128&(s=e[y+3]));)t[o++]=n,t[o++]=i,t[o++]=a,t[o++]=s,y+=4;if((n=e[y++])<128)t[o++]=n;else if(192==(224&n)){if(y>=r)return this.interim[0]=n,o;if(128!=(192&(i=e[y++]))){y--;continue}if((u=(31&n)<<6|63&i)<128){y--;continue}t[o++]=u}else if(224==(240&n)){if(y>=r)return this.interim[0]=n,o;if(128!=(192&(i=e[y++]))){y--;continue}if(y>=r)return this.interim[0]=n,this.interim[1]=i,o;if(128!=(192&(a=e[y++]))){y--;continue}if((u=(15&n)<<12|(63&i)<<6|63&a)<2048||u>=55296&&u<=57343||65279===u)continue;t[o++]=u}else if(240==(248&n)){if(y>=r)return this.interim[0]=n,o;if(128!=(192&(i=e[y++]))){y--;continue}if(y>=r)return this.interim[0]=n,this.interim[1]=i,o;if(128!=(192&(a=e[y++]))){y--;continue}if(y>=r)return this.interim[0]=n,this.interim[1]=i,this.interim[2]=a,o;if(128!=(192&(s=e[y++]))){y--;continue}if((u=(7&n)<<18|(63&i)<<12|(63&a)<<6|63&s)<65536||u>1114111)continue;t[o++]=u}}return o}}]),e}()},225:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeV6=void 0;var r,n=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],i=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];t.UnicodeV6=function(){function e(){if(h(this,e),this.version="6",!r){(r=new Uint8Array(65536)).fill(1),r[0]=0,r.fill(0,1,32),r.fill(0,127,160),r.fill(2,4352,4448),r[9001]=2,r[9002]=2,r.fill(2,11904,42192),r[12351]=1,r.fill(2,44032,55204),r.fill(2,63744,64256),r.fill(2,65040,65050),r.fill(2,65072,65136),r.fill(2,65280,65377),r.fill(2,65504,65511);for(var t=0;t<n.length;++t)r.fill(0,n[t][0],n[t][1]+1)}}return f(e,[{key:"wcwidth",value:function(e){return e<32?0:e<127?1:e<65536?r[e]:function(e,t){var r,n=0,i=t.length-1;if(e<t[0][0]||e>t[i][1])return!1;for(;i>=n;)if(e>t[r=n+i>>1][1])n=r+1;else{if(!(e<t[r][0]))return!0;i=r-1}return!1}(e,i)?0:e>=131072&&e<=196605||e>=196608&&e<=262141?2:1}}]),e}()},5981:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.WriteBuffer=void 0;var n=r(8460),i=function(e){p(r,e);var t=v(r);function r(e){var i;return h(this,r),(i=t.call(this))._action=e,i._writeBuffer=[],i._callbacks=[],i._pendingData=0,i._bufferOffset=0,i._isSyncWriting=!1,i._syncCalls=0,i._didUserInput=!1,i._onWriteParsed=i.register(new n.EventEmitter),i.onWriteParsed=i._onWriteParsed.event,i}return f(r,[{key:"handleUserInput",value:function(){this._didUserInput=!0}},{key:"writeSync",value:function(e,t){if(void 0!==t&&this._syncCalls>t)this._syncCalls=0;else if(this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(void 0),this._syncCalls++,!this._isSyncWriting){var r;for(this._isSyncWriting=!0;r=this._writeBuffer.shift();){this._action(r);var n=this._callbacks.shift();n&&n()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}}},{key:"write",value:function(e,t){var r=this;if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(t),void this._innerWrite();setTimeout((function(){return r._innerWrite()}))}this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(t)}},{key:"_innerWrite",value:function(){for(var e=this,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)||Date.now();this._writeBuffer.length>this._bufferOffset;){var n=this._writeBuffer[this._bufferOffset],i=this._action(n,t);if(i){var a=function(t){return Date.now()-r>=12?setTimeout((function(){return e._innerWrite(0,t)})):e._innerWrite(r,t)};return void i.catch((function(e){return queueMicrotask((function(){throw e})),Promise.resolve(!1)})).then(a)}var s=this._callbacks[this._bufferOffset];if(s&&s(),this._bufferOffset++,this._pendingData-=n.length,Date.now()-r>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout((function(){return e._innerWrite()}))):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}]),r}(r(844).Disposable);t.WriteBuffer=i},5941:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.toRgbString=t.parseColor=void 0;var r=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,n=/^[\da-f]+$/;function i(e,t){var r=e.toString(16),n=r.length<2?"0"+r:r;switch(t){case 4:return r[0];case 8:return n;case 12:return(n+n).slice(0,3);default:return n+n}}t.parseColor=function(e){if(e){var t=e.toLowerCase();if(0===t.indexOf("rgb:")){t=t.slice(4);var i=r.exec(t);if(i){var a=i[1]?15:i[4]?255:i[7]?4095:65535;return[Math.round(parseInt(i[1]||i[4]||i[7]||i[10],16)/a*255),Math.round(parseInt(i[2]||i[5]||i[8]||i[11],16)/a*255),Math.round(parseInt(i[3]||i[6]||i[9]||i[12],16)/a*255)]}}else if(0===t.indexOf("#")&&(t=t.slice(1),n.exec(t)&&[3,6,9,12].includes(t.length))){for(var s=t.length/3,o=[0,0,0],u=0;u<3;++u){var c=parseInt(t.slice(s*u,s*u+s),16);o[u]=1===s?c<<4:2===s?c:3===s?c>>4:c>>8}return o}}},t.toRgbString=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,r=c(e,3),n=r[0],a=r[1],s=r[2];return"rgb:".concat(i(n,t),"/").concat(i(a,t),"/").concat(i(s,t))}},5770:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PAYLOAD_LIMIT=void 0,t.PAYLOAD_LIMIT=1e7},6351:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.DcsHandler=t.DcsParser=void 0;var n=r(482),i=r(8742),a=r(5770),s=[];t.DcsParser=function(){function e(){h(this,e),this._handlers=Object.create(null),this._active=s,this._ident=0,this._handlerFb=function(){},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}return f(e,[{key:"dispose",value:function(){this._handlers=Object.create(null),this._handlerFb=function(){},this._active=s}},{key:"registerHandler",value:function(e,t){void 0===this._handlers[e]&&(this._handlers[e]=[]);var r=this._handlers[e];return r.push(t),{dispose:function(){var e=r.indexOf(t);-1!==e&&r.splice(e,1)}}}},{key:"clearHandler",value:function(e){this._handlers[e]&&delete this._handlers[e]}},{key:"setHandlerFallback",value:function(e){this._handlerFb=e}},{key:"reset",value:function(){if(this._active.length)for(var e=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;e>=0;--e)this._active[e].unhook(!1);this._stack.paused=!1,this._active=s,this._ident=0}},{key:"hook",value:function(e,t){if(this.reset(),this._ident=e,this._active=this._handlers[e]||s,this._active.length)for(var r=this._active.length-1;r>=0;r--)this._active[r].hook(t);else this._handlerFb(this._ident,"HOOK",t)}},{key:"put",value:function(e,t,r){if(this._active.length)for(var i=this._active.length-1;i>=0;i--)this._active[i].put(e,t,r);else this._handlerFb(this._ident,"PUT",(0,n.utf32ToString)(e,t,r))}},{key:"unhook",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this._active.length){var r=!1,n=this._active.length-1,i=!1;if(this._stack.paused&&(n=this._stack.loopPosition-1,r=t,i=this._stack.fallThrough,this._stack.paused=!1),!i&&!1===r){for(;n>=0&&!0!==(r=this._active[n].unhook(e));n--)if(r instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=n,this._stack.fallThrough=!1,r;n--}for(;n>=0;n--)if((r=this._active[n].unhook(!1))instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=n,this._stack.fallThrough=!0,r}else this._handlerFb(this._ident,"UNHOOK",e);this._active=s,this._ident=0}}]),e}();var o=new i.Params;o.addParam(0),t.DcsHandler=function(){function e(t){h(this,e),this._handler=t,this._data="",this._params=o,this._hitLimit=!1}return f(e,[{key:"hook",value:function(e){this._params=e.length>1||e.params[0]?e.clone():o,this._data="",this._hitLimit=!1}},{key:"put",value:function(e,t,r){this._hitLimit||(this._data+=(0,n.utf32ToString)(e,t,r),this._data.length>a.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}},{key:"unhook",value:function(e){var t=this,r=!1;if(this._hitLimit)r=!1;else if(e&&(r=this._handler(this._data,this._params))instanceof Promise)return r.then((function(e){return t._params=o,t._data="",t._hitLimit=!1,e}));return this._params=o,this._data="",this._hitLimit=!1,r}}]),e}()},2015:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.EscapeSequenceParser=t.VT500_TRANSITION_TABLE=t.TransitionTable=void 0;var n=r(844),i=r(8742),a=r(6242),s=r(6351),o=function(){function e(t){h(this,e),this.table=new Uint8Array(t)}return f(e,[{key:"setDefault",value:function(e,t){this.table.fill(e<<4|t)}},{key:"add",value:function(e,t,r,n){this.table[t<<8|e]=r<<4|n}},{key:"addMany",value:function(e,t,r,n){for(var i=0;i<e.length;i++)this.table[t<<8|e[i]]=r<<4|n}}]),e}();t.TransitionTable=o;var u=160;t.VT500_TRANSITION_TABLE=function(){var e=new o(4095),t=Array.apply(null,Array(256)).map((function(e,t){return t})),r=function(e,r){return t.slice(e,r)},n=r(32,127),i=r(0,24);i.push(25),i.push.apply(i,r(28,32));var a,s=r(0,14);for(a in e.setDefault(1,0),e.addMany(n,0,2,0),s)e.addMany([24,26,153,154],a,3,0),e.addMany(r(128,144),a,3,0),e.addMany(r(144,152),a,3,0),e.add(156,a,0,0),e.add(27,a,11,1),e.add(157,a,4,8),e.addMany([152,158,159],a,0,7),e.add(155,a,11,3),e.add(144,a,11,9);return e.addMany(i,0,3,0),e.addMany(i,1,3,1),e.add(127,1,0,1),e.addMany(i,8,0,8),e.addMany(i,3,3,3),e.add(127,3,0,3),e.addMany(i,4,3,4),e.add(127,4,0,4),e.addMany(i,6,3,6),e.addMany(i,5,3,5),e.add(127,5,0,5),e.addMany(i,2,3,2),e.add(127,2,0,2),e.add(93,1,4,8),e.addMany(n,8,5,8),e.add(127,8,5,8),e.addMany([156,27,24,26,7],8,6,0),e.addMany(r(28,32),8,0,8),e.addMany([88,94,95],1,0,7),e.addMany(n,7,0,7),e.addMany(i,7,0,7),e.add(156,7,0,0),e.add(127,7,0,7),e.add(91,1,11,3),e.addMany(r(64,127),3,7,0),e.addMany(r(48,60),3,8,4),e.addMany([60,61,62,63],3,9,4),e.addMany(r(48,60),4,8,4),e.addMany(r(64,127),4,7,0),e.addMany([60,61,62,63],4,0,6),e.addMany(r(32,64),6,0,6),e.add(127,6,0,6),e.addMany(r(64,127),6,0,0),e.addMany(r(32,48),3,9,5),e.addMany(r(32,48),5,9,5),e.addMany(r(48,64),5,0,6),e.addMany(r(64,127),5,7,0),e.addMany(r(32,48),4,9,5),e.addMany(r(32,48),1,9,2),e.addMany(r(32,48),2,9,2),e.addMany(r(48,127),2,10,0),e.addMany(r(48,80),1,10,0),e.addMany(r(81,88),1,10,0),e.addMany([89,90,92],1,10,0),e.addMany(r(96,127),1,10,0),e.add(80,1,11,9),e.addMany(i,9,0,9),e.add(127,9,0,9),e.addMany(r(28,32),9,0,9),e.addMany(r(32,48),9,9,12),e.addMany(r(48,60),9,8,10),e.addMany([60,61,62,63],9,9,10),e.addMany(i,11,0,11),e.addMany(r(32,128),11,0,11),e.addMany(r(28,32),11,0,11),e.addMany(i,10,0,10),e.add(127,10,0,10),e.addMany(r(28,32),10,0,10),e.addMany(r(48,60),10,8,10),e.addMany([60,61,62,63],10,0,11),e.addMany(r(32,48),10,9,12),e.addMany(i,12,0,12),e.add(127,12,0,12),e.addMany(r(28,32),12,0,12),e.addMany(r(32,48),12,9,12),e.addMany(r(48,64),12,0,11),e.addMany(r(64,127),12,12,13),e.addMany(r(64,127),10,12,13),e.addMany(r(64,127),9,12,13),e.addMany(i,13,13,13),e.addMany(n,13,13,13),e.add(127,13,0,13),e.addMany([27,156,24,26],13,14,0),e.add(u,0,2,0),e.add(u,8,5,8),e.add(u,6,0,6),e.add(u,11,0,11),e.add(u,13,13,13),e}();var c=function(e){p(o,e);var r=v(o);function o(){var e,u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.VT500_TRANSITION_TABLE;return h(this,o),(e=r.call(this))._transitions=u,e._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},e.initialState=0,e.currentState=e.initialState,e._params=new i.Params,e._params.addParam(0),e._collect=0,e.precedingCodepoint=0,e._printHandlerFb=function(e,t,r){},e._executeHandlerFb=function(e){},e._csiHandlerFb=function(e,t){},e._escHandlerFb=function(e){},e._errorHandlerFb=function(e){return e},e._printHandler=e._printHandlerFb,e._executeHandlers=Object.create(null),e._csiHandlers=Object.create(null),e._escHandlers=Object.create(null),e.register((0,n.toDisposable)((function(){e._csiHandlers=Object.create(null),e._executeHandlers=Object.create(null),e._escHandlers=Object.create(null)}))),e._oscParser=e.register(new a.OscParser),e._dcsParser=e.register(new s.DcsParser),e._errorHandler=e._errorHandlerFb,e.registerEscHandler({final:"\\"},(function(){return!0})),e}return f(o,[{key:"_identifier",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[64,126],r=0;if(e.prefix){if(e.prefix.length>1)throw new Error("only one byte as prefix supported");if((r=e.prefix.charCodeAt(0))&&60>r||r>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(e.intermediates){if(e.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(var n=0;n<e.intermediates.length;++n){var i=e.intermediates.charCodeAt(n);if(32>i||i>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");r<<=8,r|=i}}if(1!==e.final.length)throw new Error("final must be a single byte");var a=e.final.charCodeAt(0);if(t[0]>a||a>t[1])throw new Error("final must be in range ".concat(t[0]," .. ").concat(t[1]));return r<<=8,r|=a}},{key:"identToString",value:function(e){for(var t=[];e;)t.push(String.fromCharCode(255&e)),e>>=8;return t.reverse().join("")}},{key:"setPrintHandler",value:function(e){this._printHandler=e}},{key:"clearPrintHandler",value:function(){this._printHandler=this._printHandlerFb}},{key:"registerEscHandler",value:function(e,t){var r=this._identifier(e,[48,126]);void 0===this._escHandlers[r]&&(this._escHandlers[r]=[]);var n=this._escHandlers[r];return n.push(t),{dispose:function(){var e=n.indexOf(t);-1!==e&&n.splice(e,1)}}}},{key:"clearEscHandler",value:function(e){this._escHandlers[this._identifier(e,[48,126])]&&delete this._escHandlers[this._identifier(e,[48,126])]}},{key:"setEscHandlerFallback",value:function(e){this._escHandlerFb=e}},{key:"setExecuteHandler",value:function(e,t){this._executeHandlers[e.charCodeAt(0)]=t}},{key:"clearExecuteHandler",value:function(e){this._executeHandlers[e.charCodeAt(0)]&&delete this._executeHandlers[e.charCodeAt(0)]}},{key:"setExecuteHandlerFallback",value:function(e){this._executeHandlerFb=e}},{key:"registerCsiHandler",value:function(e,t){var r=this._identifier(e);void 0===this._csiHandlers[r]&&(this._csiHandlers[r]=[]);var n=this._csiHandlers[r];return n.push(t),{dispose:function(){var e=n.indexOf(t);-1!==e&&n.splice(e,1)}}}},{key:"clearCsiHandler",value:function(e){this._csiHandlers[this._identifier(e)]&&delete this._csiHandlers[this._identifier(e)]}},{key:"setCsiHandlerFallback",value:function(e){this._csiHandlerFb=e}},{key:"registerDcsHandler",value:function(e,t){return this._dcsParser.registerHandler(this._identifier(e),t)}},{key:"clearDcsHandler",value:function(e){this._dcsParser.clearHandler(this._identifier(e))}},{key:"setDcsHandlerFallback",value:function(e){this._dcsParser.setHandlerFallback(e)}},{key:"registerOscHandler",value:function(e,t){return this._oscParser.registerHandler(e,t)}},{key:"clearOscHandler",value:function(e){this._oscParser.clearHandler(e)}},{key:"setOscHandlerFallback",value:function(e){this._oscParser.setHandlerFallback(e)}},{key:"setErrorHandler",value:function(e){this._errorHandler=e}},{key:"clearErrorHandler",value:function(){this._errorHandler=this._errorHandlerFb}},{key:"reset",value:function(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,0!==this._parseStack.state&&(this._parseStack.state=2,this._parseStack.handlers=[])}},{key:"_preserveStack",value:function(e,t,r,n,i){this._parseStack.state=e,this._parseStack.handlers=t,this._parseStack.handlerPos=r,this._parseStack.transition=n,this._parseStack.chunkPos=i}},{key:"parse",value:function(e,t,r){var n,i=0,a=0,s=0;if(this._parseStack.state)if(2===this._parseStack.state)this._parseStack.state=0,s=this._parseStack.chunkPos+1;else{if(void 0===r||1===this._parseStack.state)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");var o=this._parseStack.handlers,c=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(!1===r&&c>-1)for(;c>=0&&!0!==(n=o[c](this._params));c--)if(n instanceof Promise)return this._parseStack.handlerPos=c,n;this._parseStack.handlers=[];break;case 4:if(!1===r&&c>-1)for(;c>=0&&!0!==(n=o[c]());c--)if(n instanceof Promise)return this._parseStack.handlerPos=c,n;this._parseStack.handlers=[];break;case 6:if(i=e[this._parseStack.chunkPos],n=this._dcsParser.unhook(24!==i&&26!==i,r))return n;27===i&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(i=e[this._parseStack.chunkPos],n=this._oscParser.end(24!==i&&26!==i,r))return n;27===i&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,s=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(var l=s;l<t;++l){switch(i=e[l],(a=this._transitions.table[this.currentState<<8|(i<160?i:u)])>>4){case 2:for(var h=l+1;;++h){if(h>=t||(i=e[h])<32||i>126&&i<u){this._printHandler(e,l,h),l=h-1;break}if(++h>=t||(i=e[h])<32||i>126&&i<u){this._printHandler(e,l,h),l=h-1;break}if(++h>=t||(i=e[h])<32||i>126&&i<u){this._printHandler(e,l,h),l=h-1;break}if(++h>=t||(i=e[h])<32||i>126&&i<u){this._printHandler(e,l,h),l=h-1;break}}break;case 3:this._executeHandlers[i]?this._executeHandlers[i]():this._executeHandlerFb(i),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:l,code:i,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:for(var f=this._csiHandlers[this._collect<<8|i],d=f?f.length-1:-1;d>=0&&!0!==(n=f[d](this._params));d--)if(n instanceof Promise)return this._preserveStack(3,f,d,a,l),n;d<0&&this._csiHandlerFb(this._collect<<8|i,this._params),this.precedingCodepoint=0;break;case 8:do{switch(i){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(i-48)}}while(++l<t&&(i=e[l])>47&&i<60);l--;break;case 9:this._collect<<=8,this._collect|=i;break;case 10:for(var p=this._escHandlers[this._collect<<8|i],v=p?p.length-1:-1;v>=0&&!0!==(n=p[v]());v--)if(n instanceof Promise)return this._preserveStack(4,p,v,a,l),n;v<0&&this._escHandlerFb(this._collect<<8|i),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|i,this._params);break;case 13:for(var g=l+1;;++g)if(g>=t||24===(i=e[g])||26===i||27===i||i>127&&i<u){this._dcsParser.put(e,l,g),l=g-1;break}break;case 14:if(n=this._dcsParser.unhook(24!==i&&26!==i))return this._preserveStack(6,[],0,a,l),n;27===i&&(a|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(var y=l+1;;y++)if(y>=t||(i=e[y])<32||i>127&&i<u){this._oscParser.put(e,l,y),l=y-1;break}break;case 6:if(n=this._oscParser.end(24!==i&&26!==i))return this._preserveStack(5,[],0,a,l),n;27===i&&(a|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&a}}}]),o}(n.Disposable);t.EscapeSequenceParser=c},6242:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.OscHandler=t.OscParser=void 0;var n=r(5770),i=r(482),a=[];t.OscParser=function(){function e(){h(this,e),this._state=0,this._active=a,this._id=-1,this._handlers=Object.create(null),this._handlerFb=function(){},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}return f(e,[{key:"registerHandler",value:function(e,t){void 0===this._handlers[e]&&(this._handlers[e]=[]);var r=this._handlers[e];return r.push(t),{dispose:function(){var e=r.indexOf(t);-1!==e&&r.splice(e,1)}}}},{key:"clearHandler",value:function(e){this._handlers[e]&&delete this._handlers[e]}},{key:"setHandlerFallback",value:function(e){this._handlerFb=e}},{key:"dispose",value:function(){this._handlers=Object.create(null),this._handlerFb=function(){},this._active=a}},{key:"reset",value:function(){if(2===this._state)for(var e=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;e>=0;--e)this._active[e].end(!1);this._stack.paused=!1,this._active=a,this._id=-1,this._state=0}},{key:"_start",value:function(){if(this._active=this._handlers[this._id]||a,this._active.length)for(var e=this._active.length-1;e>=0;e--)this._active[e].start();else this._handlerFb(this._id,"START")}},{key:"_put",value:function(e,t,r){if(this._active.length)for(var n=this._active.length-1;n>=0;n--)this._active[n].put(e,t,r);else this._handlerFb(this._id,"PUT",(0,i.utf32ToString)(e,t,r))}},{key:"start",value:function(){this.reset(),this._state=1}},{key:"put",value:function(e,t,r){if(3!==this._state){if(1===this._state)for(;t<r;){var n=e[t++];if(59===n){this._state=2,this._start();break}if(n<48||57<n)return void(this._state=3);-1===this._id&&(this._id=0),this._id=10*this._id+n-48}2===this._state&&r-t>0&&this._put(e,t,r)}}},{key:"end",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(0!==this._state){if(3!==this._state)if(1===this._state&&this._start(),this._active.length){var r=!1,n=this._active.length-1,i=!1;if(this._stack.paused&&(n=this._stack.loopPosition-1,r=t,i=this._stack.fallThrough,this._stack.paused=!1),!i&&!1===r){for(;n>=0&&!0!==(r=this._active[n].end(e));n--)if(r instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=n,this._stack.fallThrough=!1,r;n--}for(;n>=0;n--)if((r=this._active[n].end(!1))instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=n,this._stack.fallThrough=!0,r}else this._handlerFb(this._id,"END",e);this._active=a,this._id=-1,this._state=0}}}]),e}(),t.OscHandler=function(){function e(t){h(this,e),this._handler=t,this._data="",this._hitLimit=!1}return f(e,[{key:"start",value:function(){this._data="",this._hitLimit=!1}},{key:"put",value:function(e,t,r){this._hitLimit||(this._data+=(0,i.utf32ToString)(e,t,r),this._data.length>n.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}},{key:"end",value:function(e){var t=this,r=!1;if(this._hitLimit)r=!1;else if(e&&(r=this._handler(this._data))instanceof Promise)return r.then((function(e){return t._data="",t._hitLimit=!1,e}));return this._data="",this._hitLimit=!1,r}}]),e}()},8742:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Params=void 0;var r=2147483647,n=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32;if(h(this,e),this.maxLength=t,this.maxSubParamsLength=r,r>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(t),this.length=0,this._subParams=new Int32Array(r),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(t),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}return f(e,[{key:"clone",value:function(){var t=new e(this.maxLength,this.maxSubParamsLength);return t.params.set(this.params),t.length=this.length,t._subParams.set(this._subParams),t._subParamsLength=this._subParamsLength,t._subParamsIdx.set(this._subParamsIdx),t._rejectDigits=this._rejectDigits,t._rejectSubDigits=this._rejectSubDigits,t._digitIsSub=this._digitIsSub,t}},{key:"toArray",value:function(){for(var e=[],t=0;t<this.length;++t){e.push(this.params[t]);var r=this._subParamsIdx[t]>>8,n=255&this._subParamsIdx[t];n-r>0&&e.push(Array.prototype.slice.call(this._subParams,r,n))}return e}},{key:"reset",value:function(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}},{key:"addParam",value:function(e){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(e<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=e>r?r:e}}},{key:"addSubParam",value:function(e){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(e<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=e>r?r:e,this._subParamsIdx[this.length-1]++}}},{key:"hasSubParams",value:function(e){return(255&this._subParamsIdx[e])-(this._subParamsIdx[e]>>8)>0}},{key:"getSubParams",value:function(e){var t=this._subParamsIdx[e]>>8,r=255&this._subParamsIdx[e];return r-t>0?this._subParams.subarray(t,r):null}},{key:"getSubParamsAll",value:function(){for(var e={},t=0;t<this.length;++t){var r=this._subParamsIdx[t]>>8,n=255&this._subParamsIdx[t];n-r>0&&(e[t]=this._subParams.slice(r,n))}return e}},{key:"addDigit",value:function(e){var t;if(!(this._rejectDigits||!(t=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)){var n=this._digitIsSub?this._subParams:this.params,i=n[t-1];n[t-1]=~i?Math.min(10*i+e,r):e}}}],[{key:"fromArray",value:function(t){var r=new e;if(!t.length)return r;for(var n=Array.isArray(t[0])?1:0;n<t.length;++n){var i=t[n];if(Array.isArray(i))for(var a=0;a<i.length;++a)r.addSubParam(i[a]);else r.addParam(i)}return r}}]),e}();t.Params=n},5741:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AddonManager=void 0,t.AddonManager=function(){function e(){h(this,e),this._addons=[]}return f(e,[{key:"dispose",value:function(){for(var e=this._addons.length-1;e>=0;e--)this._addons[e].instance.dispose()}},{key:"loadAddon",value:function(e,t){var r=this,n={instance:t,dispose:t.dispose,isDisposed:!1};this._addons.push(n),t.dispose=function(){return r._wrappedAddonDispose(n)},t.activate(e)}},{key:"_wrappedAddonDispose",value:function(e){if(!e.isDisposed){for(var t=-1,r=0;r<this._addons.length;r++)if(this._addons[r]===e){t=r;break}if(-1===t)throw new Error("Could not dispose an addon that has not been loaded");e.isDisposed=!0,e.dispose.apply(e.instance),this._addons.splice(t,1)}}}]),e}()},8771:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.BufferApiView=void 0;var n=r(3785),i=r(511);t.BufferApiView=function(){function e(t,r){h(this,e),this._buffer=t,this.type=r}return f(e,[{key:"init",value:function(e){return this._buffer=e,this}},{key:"cursorY",get:function(){return this._buffer.y}},{key:"cursorX",get:function(){return this._buffer.x}},{key:"viewportY",get:function(){return this._buffer.ydisp}},{key:"baseY",get:function(){return this._buffer.ybase}},{key:"length",get:function(){return this._buffer.lines.length}},{key:"getLine",value:function(e){var t=this._buffer.lines.get(e);if(t)return new n.BufferLineApiView(t)}},{key:"getNullCell",value:function(){return new i.CellData}}]),e}()},3785:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLineApiView=void 0;var n=r(511);t.BufferLineApiView=function(){function e(t){h(this,e),this._line=t}return f(e,[{key:"isWrapped",get:function(){return this._line.isWrapped}},{key:"length",get:function(){return this._line.length}},{key:"getCell",value:function(e,t){if(!(e<0||e>=this._line.length))return t?(this._line.loadCell(e,t),t):this._line.loadCell(e,new n.CellData)}},{key:"translateToString",value:function(e,t,r){return this._line.translateToString(e,t,r)}}]),e}()},8285:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.BufferNamespaceApi=void 0;var n=r(8771),i=r(8460),a=function(e){p(r,e);var t=v(r);function r(e){var a;return h(this,r),(a=t.call(this))._core=e,a._onBufferChange=a.register(new i.EventEmitter),a.onBufferChange=a._onBufferChange.event,a._normal=new n.BufferApiView(a._core.buffers.normal,"normal"),a._alternate=new n.BufferApiView(a._core.buffers.alt,"alternate"),a._core.buffers.onBufferActivate((function(){return a._onBufferChange.fire(a.active)})),a}return f(r,[{key:"active",get:function(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}},{key:"normal",get:function(){return this._normal.init(this._core.buffers.normal)}},{key:"alternate",get:function(){return this._alternate.init(this._core.buffers.alt)}}]),r}(r(844).Disposable);t.BufferNamespaceApi=a},7975:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ParserApi=void 0,t.ParserApi=function(){function e(t){h(this,e),this._core=t}return f(e,[{key:"registerCsiHandler",value:function(e,t){return this._core.registerCsiHandler(e,(function(e){return t(e.toArray())}))}},{key:"addCsiHandler",value:function(e,t){return this.registerCsiHandler(e,t)}},{key:"registerDcsHandler",value:function(e,t){return this._core.registerDcsHandler(e,(function(e,r){return t(e,r.toArray())}))}},{key:"addDcsHandler",value:function(e,t){return this.registerDcsHandler(e,t)}},{key:"registerEscHandler",value:function(e,t){return this._core.registerEscHandler(e,t)}},{key:"addEscHandler",value:function(e,t){return this.registerEscHandler(e,t)}},{key:"registerOscHandler",value:function(e,t){return this._core.registerOscHandler(e,t)}},{key:"addOscHandler",value:function(e,t){return this.registerOscHandler(e,t)}}]),e}()},7090:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeApi=void 0,t.UnicodeApi=function(){function e(t){h(this,e),this._core=t}return f(e,[{key:"register",value:function(e){this._core.unicodeService.register(e)}},{key:"versions",get:function(){return this._core.unicodeService.versions}},{key:"activeVersion",get:function(){return this._core.unicodeService.activeVersion},set:function(e){this._core.unicodeService.activeVersion=e}}]),e}()},744:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferService=t.MINIMUM_ROWS=t.MINIMUM_COLS=void 0;var a=r(8460),s=r(844),o=r(5295),u=r(2585);t.MINIMUM_COLS=2,t.MINIMUM_ROWS=1;var c=t.BufferService=function(e){p(n,e);var r=v(n);function n(e){var i;return h(this,n),(i=r.call(this)).isUserScrolling=!1,i._onResize=i.register(new a.EventEmitter),i.onResize=i._onResize.event,i._onScroll=i.register(new a.EventEmitter),i.onScroll=i._onScroll.event,i.cols=Math.max(e.rawOptions.cols||0,t.MINIMUM_COLS),i.rows=Math.max(e.rawOptions.rows||0,t.MINIMUM_ROWS),i.buffers=i.register(new o.BufferSet(e,d(i))),i}return f(n,[{key:"buffer",get:function(){return this.buffers.active}},{key:"resize",value:function(e,t){this.cols=e,this.rows=t,this.buffers.resize(e,t),this._onResize.fire({cols:e,rows:t})}},{key:"reset",value:function(){this.buffers.reset(),this.isUserScrolling=!1}},{key:"scroll",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.buffer;(t=this._cachedBlankLine)&&t.length===this.cols&&t.getFg(0)===e.fg&&t.getBg(0)===e.bg||(t=n.getBlankLine(e,r),this._cachedBlankLine=t),t.isWrapped=r;var i=n.ybase+n.scrollTop,a=n.ybase+n.scrollBottom;if(0===n.scrollTop){var s=n.lines.isFull;a===n.lines.length-1?s?n.lines.recycle().copyFrom(t):n.lines.push(t.clone()):n.lines.splice(a+1,0,t.clone()),s?this.isUserScrolling&&(n.ydisp=Math.max(n.ydisp-1,0)):(n.ybase++,this.isUserScrolling||n.ydisp++)}else{var o=a-i+1;n.lines.shiftElements(i+1,o-1,-1),n.lines.set(a,t.clone())}this.isUserScrolling||(n.ydisp=n.ybase),this._onScroll.fire(n.ydisp)}},{key:"scrollLines",value:function(e,t,r){var n=this.buffer;if(e<0){if(0===n.ydisp)return;this.isUserScrolling=!0}else e+n.ydisp>=n.ybase&&(this.isUserScrolling=!1);var i=n.ydisp;n.ydisp=Math.max(Math.min(n.ydisp+e,n.ybase),0),i!==n.ydisp&&(t||this._onScroll.fire(n.ydisp))}}]),n}(s.Disposable);t.BufferService=c=n([i(0,u.IOptionsService)],c)},7994:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CharsetService=void 0,t.CharsetService=function(){function e(){h(this,e),this.glevel=0,this._charsets=[]}return f(e,[{key:"reset",value:function(){this.charset=void 0,this._charsets=[],this.glevel=0}},{key:"setgLevel",value:function(e){this.glevel=e,this.charset=this._charsets[e]}},{key:"setgCharset",value:function(e,t){this._charsets[e]=t,this.glevel===e&&(this.charset=t)}}]),e}()},1753:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreMouseService=void 0;var a=r(2585),s=r(8460),o=r(844),u={NONE:{events:0,restrict:function(){return!1}},X10:{events:1,restrict:function(e){return 4!==e.button&&1===e.action&&(e.ctrl=!1,e.alt=!1,e.shift=!1,!0)}},VT200:{events:19,restrict:function(e){return 32!==e.action}},DRAG:{events:23,restrict:function(e){return 32!==e.action||3!==e.button}},ANY:{events:31,restrict:function(e){return!0}}};function c(e,t){var r=(e.ctrl?16:0)|(e.shift?4:0)|(e.alt?8:0);return 4===e.button?(r|=64,r|=e.action):(r|=3&e.button,4&e.button&&(r|=64),8&e.button&&(r|=128),32===e.action?r|=32:0!==e.action||t||(r|=3)),r}var l=String.fromCharCode,d={DEFAULT:function(e){var t=[c(e,!1)+32,e.col+32,e.row+32];return t[0]>255||t[1]>255||t[2]>255?"":"\x1b[M".concat(l(t[0])).concat(l(t[1])).concat(l(t[2]))},SGR:function(e){var t=0===e.action&&4!==e.button?"m":"M";return"\x1b[<".concat(c(e,!0),";").concat(e.col,";").concat(e.row).concat(t)},SGR_PIXELS:function(e){var t=0===e.action&&4!==e.button?"m":"M";return"\x1b[<".concat(c(e,!0),";").concat(e.x,";").concat(e.y).concat(t)}},g=t.CoreMouseService=function(e){p(r,e);var t=v(r);function r(e,n){var i;h(this,r),(i=t.call(this))._bufferService=e,i._coreService=n,i._protocols={},i._encodings={},i._activeProtocol="",i._activeEncoding="",i._lastEvent=null,i._onProtocolChange=i.register(new s.EventEmitter),i.onProtocolChange=i._onProtocolChange.event;for(var a=0,o=Object.keys(u);a<o.length;a++){var c=o[a];i.addProtocol(c,u[c])}for(var l=0,f=Object.keys(d);l<f.length;l++){var p=f[l];i.addEncoding(p,d[p])}return i.reset(),i}return f(r,[{key:"addProtocol",value:function(e,t){this._protocols[e]=t}},{key:"addEncoding",value:function(e,t){this._encodings[e]=t}},{key:"activeProtocol",get:function(){return this._activeProtocol},set:function(e){if(!this._protocols[e])throw new Error('unknown protocol "'.concat(e,'"'));this._activeProtocol=e,this._onProtocolChange.fire(this._protocols[e].events)}},{key:"areMouseEventsActive",get:function(){return 0!==this._protocols[this._activeProtocol].events}},{key:"activeEncoding",get:function(){return this._activeEncoding},set:function(e){if(!this._encodings[e])throw new Error('unknown encoding "'.concat(e,'"'));this._activeEncoding=e}},{key:"reset",value:function(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}},{key:"triggerMouseEvent",value:function(e){if(e.col<0||e.col>=this._bufferService.cols||e.row<0||e.row>=this._bufferService.rows)return!1;if(4===e.button&&32===e.action)return!1;if(3===e.button&&32!==e.action)return!1;if(4!==e.button&&(2===e.action||3===e.action))return!1;if(e.col++,e.row++,32===e.action&&this._lastEvent&&this._equalEvents(this._lastEvent,e,"SGR_PIXELS"===this._activeEncoding))return!1;if(!this._protocols[this._activeProtocol].restrict(e))return!1;var t=this._encodings[this._activeEncoding](e);return t&&("DEFAULT"===this._activeEncoding?this._coreService.triggerBinaryEvent(t):this._coreService.triggerDataEvent(t,!0)),this._lastEvent=e,!0}},{key:"explainEvents",value:function(e){return{down:!!(1&e),up:!!(2&e),drag:!!(4&e),move:!!(8&e),wheel:!!(16&e)}}},{key:"_equalEvents",value:function(e,t,r){if(r){if(e.x!==t.x)return!1;if(e.y!==t.y)return!1}else{if(e.col!==t.col)return!1;if(e.row!==t.row)return!1}return e.button===t.button&&e.action===t.action&&e.ctrl===t.ctrl&&e.alt===t.alt&&e.shift===t.shift}}]),r}(o.Disposable);t.CoreMouseService=g=n([i(0,a.IBufferService),i(1,a.ICoreService)],g)},6975:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreService=void 0;var a=r(1439),s=r(8460),o=r(844),u=r(2585),c=Object.freeze({insertMode:!1}),l=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0}),d=t.CoreService=function(e){p(r,e);var t=v(r);function r(e,n,i){var o;return h(this,r),(o=t.call(this))._bufferService=e,o._logService=n,o._optionsService=i,o.isCursorInitialized=!1,o.isCursorHidden=!1,o._onData=o.register(new s.EventEmitter),o.onData=o._onData.event,o._onUserInput=o.register(new s.EventEmitter),o.onUserInput=o._onUserInput.event,o._onBinary=o.register(new s.EventEmitter),o.onBinary=o._onBinary.event,o._onRequestScrollToBottom=o.register(new s.EventEmitter),o.onRequestScrollToBottom=o._onRequestScrollToBottom.event,o.modes=(0,a.clone)(c),o.decPrivateModes=(0,a.clone)(l),o}return f(r,[{key:"reset",value:function(){this.modes=(0,a.clone)(c),this.decPrivateModes=(0,a.clone)(l)}},{key:"triggerDataEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._optionsService.rawOptions.disableStdin){var r=this._bufferService.buffer;t&&this._optionsService.rawOptions.scrollOnUserInput&&r.ybase!==r.ydisp&&this._onRequestScrollToBottom.fire(),t&&this._onUserInput.fire(),this._logService.debug('sending data "'.concat(e,'"'),(function(){return e.split("").map((function(e){return e.charCodeAt(0)}))})),this._onData.fire(e)}}},{key:"triggerBinaryEvent",value:function(e){this._optionsService.rawOptions.disableStdin||(this._logService.debug('sending binary "'.concat(e,'"'),(function(){return e.split("").map((function(e){return e.charCodeAt(0)}))})),this._onBinary.fire(e))}}]),r}(o.Disposable);t.CoreService=d=n([i(0,u.IBufferService),i(1,u.ILogService),i(2,u.IOptionsService)],d)},9074:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.DecorationService=void 0;var n=r(8055),a=r(8460),s=r(844),c=r(6106),d=0,g=0,y=function(e){p(r,e);var t=v(r);function r(){var e;return h(this,r),(e=t.call(this))._decorations=new c.SortedList((function(e){return null==e?void 0:e.marker.line})),e._onDecorationRegistered=e.register(new a.EventEmitter),e.onDecorationRegistered=e._onDecorationRegistered.event,e._onDecorationRemoved=e.register(new a.EventEmitter),e.onDecorationRemoved=e._onDecorationRemoved.event,e.register((0,s.toDisposable)((function(){return e.reset()}))),e}return f(r,[{key:"decorations",get:function(){return this._decorations.values()}},{key:"registerDecoration",value:function(e){var t=this;if(!e.marker.isDisposed){var r=new m(e);if(r){var n=r.marker.onDispose((function(){return r.dispose()}));r.onDispose((function(){r&&(t._decorations.delete(r)&&t._onDecorationRemoved.fire(r),n.dispose())})),this._decorations.insert(r),this._onDecorationRegistered.fire(r)}return r}}},{key:"reset",value:function(){var e,t=l(this._decorations.values());try{for(t.s();!(e=t.n()).done;)e.value.dispose()}catch(r){t.e(r)}finally{t.f()}this._decorations.clear()}},{key:"getDecorationsAtCell",value:i().mark((function e(t,r,n){var a,s,o,u,c,h,f,d;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=0,c=0,h=l(this._decorations.getKeyIterator(r)),e.prev=2,h.s();case 4:if((f=h.n()).done){e.next=14;break}if(d=f.value,u=null!==(a=d.options.x)&&void 0!==a?a:0,c=u+(null!==(s=d.options.width)&&void 0!==s?s:1),e.t0=t>=u&&t<c&&(!n||(null!==(o=d.options.layer)&&void 0!==o?o:"bottom")===n),!e.t0){e.next=12;break}return e.next=12,d;case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),h.e(e.t1);case 19:return e.prev=19,h.f(),e.finish(19);case 22:case"end":return e.stop()}}),e,this,[[2,16,19,22]])}))},{key:"forEachDecorationAtCell",value:function(e,t,r,n){this._decorations.forEachByKey(t,(function(t){var i,a,s;d=null!==(i=t.options.x)&&void 0!==i?i:0,g=d+(null!==(a=t.options.width)&&void 0!==a?a:1),e>=d&&e<g&&(!r||(null!==(s=t.options.layer)&&void 0!==s?s:"bottom")===r)&&n(t)}))}}]),r}(s.Disposable);t.DecorationService=y;var m=function(e){p(r,e);var t=v(r);function r(e){var n;return h(this,r),(n=t.call(this)).options=e,n.onRenderEmitter=n.register(new a.EventEmitter),n.onRender=n.onRenderEmitter.event,n._onDispose=n.register(new a.EventEmitter),n.onDispose=n._onDispose.event,n._cachedBg=null,n._cachedFg=null,n.marker=e.marker,n.options.overviewRulerOptions&&!n.options.overviewRulerOptions.position&&(n.options.overviewRulerOptions.position="full"),n}return f(r,[{key:"isDisposed",get:function(){return this._isDisposed}},{key:"backgroundColorRGB",get:function(){return null===this._cachedBg&&(this.options.backgroundColor?this._cachedBg=n.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}},{key:"foregroundColorRGB",get:function(){return null===this._cachedFg&&(this.options.foregroundColor?this._cachedFg=n.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}},{key:"dispose",value:function(){this._onDispose.fire(),o(u(r.prototype),"dispose",this).call(this)}}]),r}(s.Disposable)},4348:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.InstantiationService=t.ServiceCollection=void 0;var i=r(2585),a=r(8343),s=function(){function e(){h(this,e),this._entries=new Map;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var i=0,a=r;i<a.length;i++){var s=c(a[i],2),o=s[0],u=s[1];this.set(o,u)}}return f(e,[{key:"set",value:function(e,t){var r=this._entries.get(e);return this._entries.set(e,t),r}},{key:"forEach",value:function(e){var t,r=l(this._entries.entries());try{for(r.s();!(t=r.n()).done;){var n=c(t.value,2);e(n[0],n[1])}}catch(i){r.e(i)}finally{r.f()}}},{key:"has",value:function(e){return this._entries.has(e)}},{key:"get",value:function(e){return this._entries.get(e)}}]),e}();t.ServiceCollection=s,t.InstantiationService=function(){function e(){h(this,e),this._services=new s,this._services.set(i.IInstantiationService,this)}return f(e,[{key:"setService",value:function(e,t){this._services.set(e,t)}},{key:"getService",value:function(e){return this._services.get(e)}},{key:"createInstance",value:function(e){var t,r=(0,a.getServiceDependencies)(e).sort((function(e,t){return e.index-t.index})),i=[],s=l(r);try{for(s.s();!(t=s.n()).done;){var o=t.value,u=this._services.get(o.id);if(!u)throw new Error("[createInstance] ".concat(e.name," depends on UNKNOWN service ").concat(o.id,"."));i.push(u)}}catch(p){s.e(p)}finally{s.f()}for(var c=arguments.length,h=new Array(c>1?c-1:0),f=1;f<c;f++)h[f-1]=arguments[f];var d=r.length>0?r[0].index:h.length;if(h.length!==d)throw new Error("[createInstance] First service dependency of ".concat(e.name," at position ").concat(d+1," conflicts with ").concat(h.length," static arguments"));return n(e,[].concat(h,i))}}]),e}()},7866:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.traceCall=t.setTraceLogger=t.LogService=void 0;var a,o=r(844),u=r(2585),c={trace:u.LogLevelEnum.TRACE,debug:u.LogLevelEnum.DEBUG,info:u.LogLevelEnum.INFO,warn:u.LogLevelEnum.WARN,error:u.LogLevelEnum.ERROR,off:u.LogLevelEnum.OFF},l=t.LogService=function(e){p(r,e);var t=v(r);function r(e){var n;return h(this,r),(n=t.call(this))._optionsService=e,n._logLevel=u.LogLevelEnum.OFF,n._updateLogLevel(),n.register(n._optionsService.onSpecificOptionChange("logLevel",(function(){return n._updateLogLevel()}))),a=d(n),n}return f(r,[{key:"logLevel",get:function(){return this._logLevel}},{key:"_updateLogLevel",value:function(){this._logLevel=c[this._optionsService.rawOptions.logLevel]}},{key:"_evalLazyOptionalParams",value:function(e){for(var t=0;t<e.length;t++)"function"==typeof e[t]&&(e[t]=e[t]())}},{key:"_log",value:function(e,t,r){this._evalLazyOptionalParams(r),e.call.apply(e,[console,(this._optionsService.options.logger?"":"xterm.js: ")+t].concat(s(r)))}},{key:"trace",value:function(e){for(var t,r,n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];this._logLevel<=u.LogLevelEnum.TRACE&&this._log(null!==(r=null===(t=this._optionsService.options.logger)||void 0===t?void 0:t.trace.bind(this._optionsService.options.logger))&&void 0!==r?r:console.log,e,i)}},{key:"debug",value:function(e){for(var t,r,n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];this._logLevel<=u.LogLevelEnum.DEBUG&&this._log(null!==(r=null===(t=this._optionsService.options.logger)||void 0===t?void 0:t.debug.bind(this._optionsService.options.logger))&&void 0!==r?r:console.log,e,i)}},{key:"info",value:function(e){for(var t,r,n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];this._logLevel<=u.LogLevelEnum.INFO&&this._log(null!==(r=null===(t=this._optionsService.options.logger)||void 0===t?void 0:t.info.bind(this._optionsService.options.logger))&&void 0!==r?r:console.info,e,i)}},{key:"warn",value:function(e){for(var t,r,n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];this._logLevel<=u.LogLevelEnum.WARN&&this._log(null!==(r=null===(t=this._optionsService.options.logger)||void 0===t?void 0:t.warn.bind(this._optionsService.options.logger))&&void 0!==r?r:console.warn,e,i)}},{key:"error",value:function(e){for(var t,r,n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];this._logLevel<=u.LogLevelEnum.ERROR&&this._log(null!==(r=null===(t=this._optionsService.options.logger)||void 0===t?void 0:t.error.bind(this._optionsService.options.logger))&&void 0!==r?r:console.error,e,i)}}]),r}(o.Disposable);t.LogService=l=n([i(0,u.IOptionsService)],l),t.setTraceLogger=function(e){a=e},t.traceCall=function(e,t,r){if("function"!=typeof r.value)throw new Error("not supported");var n=r.value;r.value=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(a.logLevel!==u.LogLevelEnum.TRACE)return n.apply(this,t);a.trace("GlyphRenderer#".concat(n.name,"(").concat(t.map((function(e){return JSON.stringify(e)})).join(", "),")"));var i=n.apply(this,t);return a.trace("GlyphRenderer#".concat(n.name," return"),i),i}}},7302:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.OptionsService=t.DEFAULT_OPTIONS=void 0;var n=r(8460),i=r(844),a=r(6114);t.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:a.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};var s=["normal","bold","100","200","300","400","500","600","700","800","900"],o=function(e){p(i,e);var r=v(i);function i(e){var a;h(this,i),(a=r.call(this))._onOptionChange=a.register(new n.EventEmitter),a.onOptionChange=a._onOptionChange.event;var s=Object.assign({},t.DEFAULT_OPTIONS);for(var o in e)if(o in s)try{var u=e[o];s[o]=a._sanitizeAndValidateOption(o,u)}catch(e){console.error(e)}return a.rawOptions=s,a.options=Object.assign({},s),a._setupOptions(),a}return f(i,[{key:"onSpecificOptionChange",value:function(e,t){var r=this;return this.onOptionChange((function(n){n===e&&t(r.rawOptions[e])}))}},{key:"onMultipleOptionChange",value:function(e,t){return this.onOptionChange((function(r){-1!==e.indexOf(r)&&t()}))}},{key:"_setupOptions",value:function(){var e=this,r=function(r){if(!(r in t.DEFAULT_OPTIONS))throw new Error('No option with key "'.concat(r,'"'));return e.rawOptions[r]},n=function(r,n){if(!(r in t.DEFAULT_OPTIONS))throw new Error('No option with key "'.concat(r,'"'));n=e._sanitizeAndValidateOption(r,n),e.rawOptions[r]!==n&&(e.rawOptions[r]=n,e._onOptionChange.fire(r))};for(var i in this.rawOptions){var a={get:r.bind(this,i),set:n.bind(this,i)};Object.defineProperty(this.options,i,a)}}},{key:"_sanitizeAndValidateOption",value:function(e,r){switch(e){case"cursorStyle":if(r||(r=t.DEFAULT_OPTIONS[e]),!function(e){return"block"===e||"underline"===e||"bar"===e}(r))throw new Error('"'.concat(r,'" is not a valid value for ').concat(e));break;case"wordSeparator":r||(r=t.DEFAULT_OPTIONS[e]);break;case"fontWeight":case"fontWeightBold":if("number"==typeof r&&1<=r&&r<=1e3)break;r=s.includes(r)?r:t.DEFAULT_OPTIONS[e];break;case"cursorWidth":r=Math.floor(r);case"lineHeight":case"tabStopWidth":if(r<1)throw new Error("".concat(e," cannot be less than 1, value: ").concat(r));break;case"minimumContrastRatio":r=Math.max(1,Math.min(21,Math.round(10*r)/10));break;case"scrollback":if((r=Math.min(r,4294967295))<0)throw new Error("".concat(e," cannot be less than 0, value: ").concat(r));break;case"fastScrollSensitivity":case"scrollSensitivity":if(r<=0)throw new Error("".concat(e," cannot be less than or equal to 0, value: ").concat(r));break;case"rows":case"cols":if(!r&&0!==r)throw new Error("".concat(e," must be numeric, value: ").concat(r));break;case"windowsPty":r=null!=r?r:{}}return r}}]),i}(i.Disposable);t.OptionsService=o},2660:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,a=arguments.length,s=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__param||function(e,t){return function(r,n){t(r,n,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OscLinkService=void 0;var a=r(2585),s=t.OscLinkService=function(){function e(t){h(this,e),this._bufferService=t,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}return f(e,[{key:"registerLink",value:function(e){var t=this,r=this._bufferService.buffer;if(void 0===e.id){var n=r.addMarker(r.ybase+r.y),i={data:e,id:this._nextId++,lines:[n]};return n.onDispose((function(){return t._removeMarkerFromLink(i,n)})),this._dataByLinkId.set(i.id,i),i.id}var a=e,s=this._getEntryIdKey(a),o=this._entriesWithId.get(s);if(o)return this.addLineToLink(o.id,r.ybase+r.y),o.id;var u=r.addMarker(r.ybase+r.y),c={id:this._nextId++,key:this._getEntryIdKey(a),data:a,lines:[u]};return u.onDispose((function(){return t._removeMarkerFromLink(c,u)})),this._entriesWithId.set(c.key,c),this._dataByLinkId.set(c.id,c),c.id}},{key:"addLineToLink",value:function(e,t){var r=this,n=this._dataByLinkId.get(e);if(n&&n.lines.every((function(e){return e.line!==t}))){var i=this._bufferService.buffer.addMarker(t);n.lines.push(i),i.onDispose((function(){return r._removeMarkerFromLink(n,i)}))}}},{key:"getLinkData",value:function(e){var t;return null===(t=this._dataByLinkId.get(e))||void 0===t?void 0:t.data}},{key:"_getEntryIdKey",value:function(e){return"".concat(e.id,";;").concat(e.uri)}},{key:"_removeMarkerFromLink",value:function(e,t){var r=e.lines.indexOf(t);-1!==r&&(e.lines.splice(r,1),0===e.lines.length&&(void 0!==e.data.id&&this._entriesWithId.delete(e.key),this._dataByLinkId.delete(e.id)))}}]),e}();t.OscLinkService=s=n([i(0,a.IBufferService)],s)},8343:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createDecorator=t.getServiceDependencies=t.serviceRegistry=void 0;var r="di$target",n="di$dependencies";t.serviceRegistry=new Map,t.getServiceDependencies=function(e){return e[n]||[]},t.createDecorator=function(e){if(t.serviceRegistry.has(e))return t.serviceRegistry.get(e);var i=function e(t,i,a){if(3!==arguments.length)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");!function(e,t,i){t[r]===t?t[n].push({id:e,index:i}):(t[n]=[{id:e,index:i}],t[r]=t)}(e,t,a)};return i.toString=function(){return e},t.serviceRegistry.set(e,i),i}},2585:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.IDecorationService=t.IUnicodeService=t.IOscLinkService=t.IOptionsService=t.ILogService=t.LogLevelEnum=t.IInstantiationService=t.ICharsetService=t.ICoreService=t.ICoreMouseService=t.IBufferService=void 0;var n,i=r(8343);t.IBufferService=(0,i.createDecorator)("BufferService"),t.ICoreMouseService=(0,i.createDecorator)("CoreMouseService"),t.ICoreService=(0,i.createDecorator)("CoreService"),t.ICharsetService=(0,i.createDecorator)("CharsetService"),t.IInstantiationService=(0,i.createDecorator)("InstantiationService"),function(e){e[e.TRACE=0]="TRACE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.OFF=5]="OFF"}(n||(t.LogLevelEnum=n={})),t.ILogService=(0,i.createDecorator)("LogService"),t.IOptionsService=(0,i.createDecorator)("OptionsService"),t.IOscLinkService=(0,i.createDecorator)("OscLinkService"),t.IUnicodeService=(0,i.createDecorator)("UnicodeService"),t.IDecorationService=(0,i.createDecorator)("DecorationService")},1480:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeService=void 0;var n=r(8460),i=r(225);t.UnicodeService=function(){function e(){h(this,e),this._providers=Object.create(null),this._active="",this._onChange=new n.EventEmitter,this.onChange=this._onChange.event;var t=new i.UnicodeV6;this.register(t),this._active=t.version,this._activeProvider=t}return f(e,[{key:"dispose",value:function(){this._onChange.dispose()}},{key:"versions",get:function(){return Object.keys(this._providers)}},{key:"activeVersion",get:function(){return this._active},set:function(e){if(!this._providers[e])throw new Error('unknown Unicode version "'.concat(e,'"'));this._active=e,this._activeProvider=this._providers[e],this._onChange.fire(e)}},{key:"register",value:function(e){this._providers[e.version]=e}},{key:"wcwidth",value:function(e){return this._activeProvider.wcwidth(e)}},{key:"getStringCellWidth",value:function(e){for(var t=0,r=e.length,n=0;n<r;++n){var i=e.charCodeAt(n);if(55296<=i&&i<=56319){if(++n>=r)return t+this.wcwidth(i);var a=e.charCodeAt(n);56320<=a&&a<=57343?i=1024*(i-55296)+a-56320+65536:t+=this.wcwidth(a)}t+=this.wcwidth(i)}return t}}]),e}()}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,r),a.exports}var g={};return function(){var e=g;Object.defineProperty(e,"__esModule",{value:!0}),e.Terminal=void 0;var t=r(9042),n=r(3236),i=r(844),a=r(5741),s=r(8285),c=r(7975),l=r(7090),y=["cols","rows"],m=function(e){p(i,e);var r=v(i);function i(e){var t;h(this,i),(t=r.call(this))._core=t.register(new n.Terminal(e)),t._addonManager=t.register(new a.AddonManager),t._publicOptions=Object.assign({},t._core.options);var s=function(e){return t._core.options[e]},o=function(e,r){t._checkReadonlyOptions(e),t._core.options[e]=r};for(var u in t._core.options){var c={get:s.bind(d(t),u),set:o.bind(d(t),u)};Object.defineProperty(t._publicOptions,u,c)}return t}return f(i,[{key:"_checkReadonlyOptions",value:function(e){if(y.includes(e))throw new Error('Option "'.concat(e,'" can only be set in the constructor'))}},{key:"_checkProposedApi",value:function(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}},{key:"onBell",get:function(){return this._core.onBell}},{key:"onBinary",get:function(){return this._core.onBinary}},{key:"onCursorMove",get:function(){return this._core.onCursorMove}},{key:"onData",get:function(){return this._core.onData}},{key:"onKey",get:function(){return this._core.onKey}},{key:"onLineFeed",get:function(){return this._core.onLineFeed}},{key:"onRender",get:function(){return this._core.onRender}},{key:"onResize",get:function(){return this._core.onResize}},{key:"onScroll",get:function(){return this._core.onScroll}},{key:"onSelectionChange",get:function(){return this._core.onSelectionChange}},{key:"onTitleChange",get:function(){return this._core.onTitleChange}},{key:"onWriteParsed",get:function(){return this._core.onWriteParsed}},{key:"element",get:function(){return this._core.element}},{key:"parser",get:function(){return this._parser||(this._parser=new c.ParserApi(this._core)),this._parser}},{key:"unicode",get:function(){return this._checkProposedApi(),new l.UnicodeApi(this._core)}},{key:"textarea",get:function(){return this._core.textarea}},{key:"rows",get:function(){return this._core.rows}},{key:"cols",get:function(){return this._core.cols}},{key:"buffer",get:function(){return this._buffer||(this._buffer=this.register(new s.BufferNamespaceApi(this._core))),this._buffer}},{key:"markers",get:function(){return this._checkProposedApi(),this._core.markers}},{key:"modes",get:function(){var e=this._core.coreService.decPrivateModes,t="none";switch(this._core.coreMouseService.activeProtocol){case"X10":t="x10";break;case"VT200":t="vt200";break;case"DRAG":t="drag";break;case"ANY":t="any"}return{applicationCursorKeysMode:e.applicationCursorKeys,applicationKeypadMode:e.applicationKeypad,bracketedPasteMode:e.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:t,originMode:e.origin,reverseWraparoundMode:e.reverseWraparound,sendFocusMode:e.sendFocus,wraparoundMode:e.wraparound}}},{key:"options",get:function(){return this._publicOptions},set:function(e){for(var t in e)this._publicOptions[t]=e[t]}},{key:"blur",value:function(){this._core.blur()}},{key:"focus",value:function(){this._core.focus()}},{key:"resize",value:function(e,t){this._verifyIntegers(e,t),this._core.resize(e,t)}},{key:"open",value:function(e){this._core.open(e)}},{key:"attachCustomKeyEventHandler",value:function(e){this._core.attachCustomKeyEventHandler(e)}},{key:"registerLinkProvider",value:function(e){return this._core.registerLinkProvider(e)}},{key:"registerCharacterJoiner",value:function(e){return this._checkProposedApi(),this._core.registerCharacterJoiner(e)}},{key:"deregisterCharacterJoiner",value:function(e){this._checkProposedApi(),this._core.deregisterCharacterJoiner(e)}},{key:"registerMarker",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._verifyIntegers(e),this._core.registerMarker(e)}},{key:"registerDecoration",value:function(e){var t,r,n;return this._checkProposedApi(),this._verifyPositiveIntegers(null!==(t=e.x)&&void 0!==t?t:0,null!==(r=e.width)&&void 0!==r?r:0,null!==(n=e.height)&&void 0!==n?n:0),this._core.registerDecoration(e)}},{key:"hasSelection",value:function(){return this._core.hasSelection()}},{key:"select",value:function(e,t,r){this._verifyIntegers(e,t,r),this._core.select(e,t,r)}},{key:"getSelection",value:function(){return this._core.getSelection()}},{key:"getSelectionPosition",value:function(){return this._core.getSelectionPosition()}},{key:"clearSelection",value:function(){this._core.clearSelection()}},{key:"selectAll",value:function(){this._core.selectAll()}},{key:"selectLines",value:function(e,t){this._verifyIntegers(e,t),this._core.selectLines(e,t)}},{key:"dispose",value:function(){o(u(i.prototype),"dispose",this).call(this)}},{key:"scrollLines",value:function(e){this._verifyIntegers(e),this._core.scrollLines(e)}},{key:"scrollPages",value:function(e){this._verifyIntegers(e),this._core.scrollPages(e)}},{key:"scrollToTop",value:function(){this._core.scrollToTop()}},{key:"scrollToBottom",value:function(){this._core.scrollToBottom()}},{key:"scrollToLine",value:function(e){this._verifyIntegers(e),this._core.scrollToLine(e)}},{key:"clear",value:function(){this._core.clear()}},{key:"write",value:function(e,t){this._core.write(e,t)}},{key:"writeln",value:function(e,t){this._core.write(e),this._core.write("\r\n",t)}},{key:"paste",value:function(e){this._core.paste(e)}},{key:"refresh",value:function(e,t){this._verifyIntegers(e,t),this._core.refresh(e,t)}},{key:"reset",value:function(){this._core.reset()}},{key:"clearTextureAtlas",value:function(){this._core.clearTextureAtlas()}},{key:"loadAddon",value:function(e){this._addonManager.loadAddon(this,e)}},{key:"_verifyIntegers",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0,i=t;n<i.length;n++){var a=i[n];if(a===1/0||isNaN(a)||a%1!=0)throw new Error("This API only accepts integers")}}},{key:"_verifyPositiveIntegers",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0,i=t;n<i.length;n++){var a=i[n];if(a&&(a===1/0||isNaN(a)||a%1!=0||a<0))throw new Error("This API only accepts positive integers")}}}],[{key:"strings",get:function(){return t}}]),i}(i.Disposable);e.Terminal=m}(),g}()},7064:function(){},5104:function(){},2678:function(){},5819:function(){},1265:function(){},5539:function(){},4642:function(e,t,r){var n=r(3801);function i(e){var t,r;function i(t,r){try{var s=e[t](r),o=s.value,u=o instanceof n;Promise.resolve(u?o.v:o).then((function(r){if(u){var n="return"===t?"return":"next";if(!o.k||r.done)return i(n,r);r=e[n](r).value}a(s.done?"return":"normal",r)}),(function(e){i("throw",e)}))}catch(e){a("throw",e)}}function a(e,n){switch(e){case"return":t.resolve({value:n,done:!0});break;case"throw":t.reject(n);break;default:t.resolve({value:n,done:!1})}(t=t.next)?i(t.key,t.arg):r=null}this._invoke=function(e,n){return new Promise((function(a,s){var o={key:e,arg:n,resolve:a,reject:s,next:null};r?r=r.next=o:(t=r=o,i(e,n))}))},"function"!=typeof e.return&&(this.return=void 0)}i.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},i.prototype.next=function(e){return this._invoke("next",e)},i.prototype.throw=function(e){return this._invoke("throw",e)},i.prototype.return=function(e){return this._invoke("return",e)},e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},3801:function(e){e.exports=function(e,t){this.v=e,this.k=t},e.exports.__esModule=!0,e.exports.default=e.exports},3897:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n},e.exports.__esModule=!0,e.exports.default=e.exports},5372:function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},3405:function(e,t,r){var n=r(3897);e.exports=function(e){if(Array.isArray(e))return n(e)},e.exports.__esModule=!0,e.exports.default=e.exports},6115:function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},8131:function(e,t,r){var n=r(3801);e.exports=function(e){var t={},r=!1;function i(t,i){return r=!0,i=new Promise((function(r){r(e[t](i))})),{done:!1,value:new n(i,1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return r?(r=!1,e):i("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(r)throw r=!1,e;return i("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return r?(r=!1,e):i("return",e)}),t},e.exports.__esModule=!0,e.exports.default=e.exports},8237:function(e){function t(e){function r(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return t=function(e){this.s=e,this.n=e.next},t.prototype={s:null,n:null,next:function(){return r(this.n.apply(this.s,arguments))},return:function(e){var t=this.s.return;return void 0===t?Promise.resolve({value:e,done:!0}):r(t.apply(this.s,arguments))},throw:function(e){var t=this.s.return;return void 0===t?Promise.reject(e):r(t.apply(this.s,arguments))}},new t(e)}e.exports=function(e){var r,n,i,a=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,i=Symbol.iterator);a--;){if(n&&null!=(r=e[n]))return r.call(e);if(i&&null!=(r=e[i]))return new t(r.call(e));n="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")},e.exports.__esModule=!0,e.exports.default=e.exports},7156:function(e){function t(e,t,r,n,i,a,s){try{var o=e[a](s),u=o.value}catch(c){return void r(c)}o.done?t(u):Promise.resolve(u).then(n,i)}e.exports=function(e){return function(){var r=this,n=arguments;return new Promise((function(i,a){var s=e.apply(r,n);function o(e){t(s,i,a,o,u,"next",e)}function u(e){t(s,i,a,o,u,"throw",e)}o(void 0)}))}},e.exports.__esModule=!0,e.exports.default=e.exports},6737:function(e,t,r){var n=r(3801);e.exports=function(e){return new n(e,0)},e.exports.__esModule=!0,e.exports.default=e.exports},6690:function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},3515:function(e,t,r){var n=r(6015),i=r(9617);function a(t,r,s){return i()?(e.exports=a=Reflect.construct.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=a=function(e,t,r){var i=[null];i.push.apply(i,t);var a=new(Function.bind.apply(e,i));return r&&n(a,r.prototype),a},e.exports.__esModule=!0,e.exports.default=e.exports),a.apply(null,arguments)}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},9728:function(e,t,r){var n=r(4062);function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,n(i.key),i)}}e.exports=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},4704:function(e,t,r){var n=r(6116);e.exports=function(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=n(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){u=!0,s=e},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw s}}}},e.exports.__esModule=!0,e.exports.default=e.exports},6389:function(e,t,r){var n=r(3808),i=r(9617),a=r(4993);e.exports=function(e){var t=i();return function(){var r,i=n(e);if(t){var s=n(this).constructor;r=Reflect.construct(i,arguments,s)}else r=i.apply(this,arguments);return a(this,r)}},e.exports.__esModule=!0,e.exports.default=e.exports},8416:function(e,t,r){var n=r(4062);e.exports=function(e,t,r){return(t=n(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e.exports.__esModule=!0,e.exports.default=e.exports},1588:function(e,t,r){var n=r(1753);function i(){return"undefined"!==typeof Reflect&&Reflect.get?(e.exports=i=Reflect.get.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=i=function(e,t,r){var i=n(e,t);if(i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(arguments.length<3?e:r):a.value}},e.exports.__esModule=!0,e.exports.default=e.exports),i.apply(this,arguments)}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},3808:function(e){function t(r){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},1655:function(e,t,r){var n=r(6015);e.exports=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},6035:function(e){e.exports=function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"===typeof e}},e.exports.__esModule=!0,e.exports.default=e.exports},9617:function(e){e.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.__esModule=!0,e.exports.default=e.exports},9498:function(e){e.exports=function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},8872:function(e){e.exports=function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a,s,o=[],u=!0,c=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(o.push(n.value),o.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw i}}return o}},e.exports.__esModule=!0,e.exports.default=e.exports},2218:function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},2281:function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},2122:function(e,t,r){var n=r(8416);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}e.exports=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e},e.exports.__esModule=!0,e.exports.default=e.exports},4993:function(e,t,r){var n=r(8698).default,i=r(6115);e.exports=function(e,t){if(t&&("object"===n(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return i(e)},e.exports.__esModule=!0,e.exports.default=e.exports},7061:function(e,t,r){var n=r(8698).default;function i(){"use strict";e.exports=i=function(){return r},e.exports.__esModule=!0,e.exports.default=e.exports;var t,r={},a=Object.prototype,s=a.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},u="function"==typeof Symbol?Symbol:{},c=u.iterator||"@@iterator",l=u.asyncIterator||"@@asyncIterator",h=u.toStringTag||"@@toStringTag";function f(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(t){f=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var i=t&&t.prototype instanceof _?t:_,a=Object.create(i.prototype),s=new P(n||[]);return o(a,"_invoke",{value:R(e,r,s)}),a}function p(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}r.wrap=d;var v="suspendedStart",g="suspendedYield",y="executing",m="completed",b={};function _(){}function w(){}function k(){}var x={};f(x,c,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(L([])));S&&S!==a&&s.call(S,c)&&(x=S);var C=k.prototype=_.prototype=Object.create(x);function A(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function D(e,t){function r(i,a,o,u){var c=p(e[i],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==n(h)&&s.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,o,u)}),(function(e){r("throw",e,o,u)})):t.resolve(h).then((function(e){l.value=e,o(l)}),(function(e){return r("throw",e,o,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,i){r(e,n,t,i)}))}return i=i?i.then(a,a):a()}})}function R(e,r,n){var i=v;return function(a,s){if(i===y)throw new Error("Generator is already running");if(i===m){if("throw"===a)throw s;return{value:t,done:!0}}for(n.method=a,n.arg=s;;){var o=n.delegate;if(o){var u=T(o,n);if(u){if(u===b)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===v)throw i=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=y;var c=p(e,r,n);if("normal"===c.type){if(i=n.done?m:g,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=m,n.method="throw",n.arg=c.arg)}}}function T(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var a=p(i,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,b;var s=a.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function Z(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(Z,this),this.reset(!0)}function L(e){if(e||""===e){var r=e[c];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function r(){for(;++i<e.length;)if(s.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(n(e)+" is not iterable")}return w.prototype=k,o(C,"constructor",{value:k,configurable:!0}),o(k,"constructor",{value:w,configurable:!0}),w.displayName=f(k,h,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,k):(e.__proto__=k,f(e,h,"GeneratorFunction")),e.prototype=Object.create(C),e},r.awrap=function(e){return{__await:e}},A(D.prototype),f(D.prototype,l,(function(){return this})),r.AsyncIterator=D,r.async=function(e,t,n,i,a){void 0===a&&(a=Promise);var s=new D(d(e,t,n,i),a);return r.isGeneratorFunction(t)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},A(C),f(C,h,"Generator"),f(C,c,(function(){return this})),f(C,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},r.values=L,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var r in this)"t"===r.charAt(0)&&s.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,i){return o.type="throw",o.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var u=s.call(a,"catchLoc"),c=s.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&s.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),b},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),I(r),b}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;I(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:L(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},r}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},6015:function(e){function t(r,n){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r,n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},7424:function(e,t,r){var n=r(5372),i=r(8872),a=r(6116),s=r(2218);e.exports=function(e,t){return n(e)||i(e,t)||a(e,t)||s()},e.exports.__esModule=!0,e.exports.default=e.exports},1753:function(e,t,r){var n=r(3808);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n(e)););return e},e.exports.__esModule=!0,e.exports.default=e.exports},861:function(e,t,r){var n=r(3405),i=r(9498),a=r(6116),s=r(2281);e.exports=function(e){return n(e)||i(e)||a(e)||s()},e.exports.__esModule=!0,e.exports.default=e.exports},5036:function(e,t,r){var n=r(8698).default;e.exports=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},4062:function(e,t,r){var n=r(8698).default,i=r(5036);e.exports=function(e){var t=i(e,"string");return"symbol"===n(t)?t:String(t)},e.exports.__esModule=!0,e.exports.default=e.exports},8698:function(e){function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},6116:function(e,t,r){var n=r(3897);e.exports=function(e,t){if(e){if("string"===typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},8186:function(e,t,r){var n=r(4642);e.exports=function(e){return function(){return new n(e.apply(this,arguments))}},e.exports.__esModule=!0,e.exports.default=e.exports},3496:function(e,t,r){var n=r(3808),i=r(6015),a=r(6035),s=r(3515);function o(t){var r="function"===typeof Map?new Map:void 0;return e.exports=o=function(e){if(null===e||!a(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof r){if(r.has(e))return r.get(e);r.set(e,t)}function t(){return s(e,arguments,n(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i(t,e)},e.exports.__esModule=!0,e.exports.default=e.exports,o(t)}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},4482:function(e,t,r){var n,i,a;i=[r(886)],void 0===(a="function"===typeof(n=function(e){"use strict";var t=e.Reader,r=e.Writer,n=e.util,i=e.roots.default||(e.roots.default={});return i.RPC=function(){function a(e){if(this.subscriptions=[],this.messages=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var s;return a.prototype.subscriptions=n.emptyArray,a.prototype.messages=n.emptyArray,a.prototype.control=null,Object.defineProperty(a.prototype,"_control",{get:n.oneOfGetter(s=["control"]),set:n.oneOfSetter(s)}),a.encode=function(e,t){if(t||(t=r.create()),null!=e.subscriptions&&e.subscriptions.length)for(var n=0;n<e.subscriptions.length;++n)i.RPC.SubOpts.encode(e.subscriptions[n],t.uint32(10).fork()).ldelim();if(null!=e.messages&&e.messages.length)for(n=0;n<e.messages.length;++n)i.RPC.Message.encode(e.messages[n],t.uint32(18).fork()).ldelim();return null!=e.control&&Object.hasOwnProperty.call(e,"control")&&i.RPC.ControlMessage.encode(e.control,t.uint32(26).fork()).ldelim(),t},a.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,a=new i.RPC;e.pos<n;){var s=e.uint32();switch(s>>>3){case 1:a.subscriptions&&a.subscriptions.length||(a.subscriptions=[]),a.subscriptions.push(i.RPC.SubOpts.decode(e,e.uint32()));break;case 2:a.messages&&a.messages.length||(a.messages=[]),a.messages.push(i.RPC.Message.decode(e,e.uint32()));break;case 3:a.control=i.RPC.ControlMessage.decode(e,e.uint32());break;default:e.skipType(7&s)}}return a},a.fromObject=function(e){if(e instanceof i.RPC)return e;var t=new i.RPC;if(e.subscriptions){if(!Array.isArray(e.subscriptions))throw TypeError(".RPC.subscriptions: array expected");t.subscriptions=[];for(var r=0;r<e.subscriptions.length;++r){if("object"!==typeof e.subscriptions[r])throw TypeError(".RPC.subscriptions: object expected");t.subscriptions[r]=i.RPC.SubOpts.fromObject(e.subscriptions[r])}}if(e.messages){if(!Array.isArray(e.messages))throw TypeError(".RPC.messages: array expected");for(t.messages=[],r=0;r<e.messages.length;++r){if("object"!==typeof e.messages[r])throw TypeError(".RPC.messages: object expected");t.messages[r]=i.RPC.Message.fromObject(e.messages[r])}}if(null!=e.control){if("object"!==typeof e.control)throw TypeError(".RPC.control: object expected");t.control=i.RPC.ControlMessage.fromObject(e.control)}return t},a.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.subscriptions=[],r.messages=[]),e.subscriptions&&e.subscriptions.length){r.subscriptions=[];for(var n=0;n<e.subscriptions.length;++n)r.subscriptions[n]=i.RPC.SubOpts.toObject(e.subscriptions[n],t)}if(e.messages&&e.messages.length)for(r.messages=[],n=0;n<e.messages.length;++n)r.messages[n]=i.RPC.Message.toObject(e.messages[n],t);return null!=e.control&&e.hasOwnProperty("control")&&(r.control=i.RPC.ControlMessage.toObject(e.control,t),t.oneofs&&(r._control="control")),r},a.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},a.SubOpts=function(){function a(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var s;return a.prototype.subscribe=null,a.prototype.topic=null,Object.defineProperty(a.prototype,"_subscribe",{get:n.oneOfGetter(s=["subscribe"]),set:n.oneOfSetter(s)}),Object.defineProperty(a.prototype,"_topic",{get:n.oneOfGetter(s=["topic"]),set:n.oneOfSetter(s)}),a.encode=function(e,t){return t||(t=r.create()),null!=e.subscribe&&Object.hasOwnProperty.call(e,"subscribe")&&t.uint32(8).bool(e.subscribe),null!=e.topic&&Object.hasOwnProperty.call(e,"topic")&&t.uint32(18).string(e.topic),t},a.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,a=new i.RPC.SubOpts;e.pos<n;){var s=e.uint32();switch(s>>>3){case 1:a.subscribe=e.bool();break;case 2:a.topic=e.string();break;default:e.skipType(7&s)}}return a},a.fromObject=function(e){if(e instanceof i.RPC.SubOpts)return e;var t=new i.RPC.SubOpts;return null!=e.subscribe&&(t.subscribe=Boolean(e.subscribe)),null!=e.topic&&(t.topic=String(e.topic)),t},a.toObject=function(e,t){t||(t={});var r={};return null!=e.subscribe&&e.hasOwnProperty("subscribe")&&(r.subscribe=e.subscribe,t.oneofs&&(r._subscribe="subscribe")),null!=e.topic&&e.hasOwnProperty("topic")&&(r.topic=e.topic,t.oneofs&&(r._topic="topic")),r},a.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},a}(),a.Message=function(){function a(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var s;return a.prototype.from=null,a.prototype.data=null,a.prototype.seqno=null,a.prototype.topic="",a.prototype.signature=null,a.prototype.key=null,Object.defineProperty(a.prototype,"_from",{get:n.oneOfGetter(s=["from"]),set:n.oneOfSetter(s)}),Object.defineProperty(a.prototype,"_data",{get:n.oneOfGetter(s=["data"]),set:n.oneOfSetter(s)}),Object.defineProperty(a.prototype,"_seqno",{get:n.oneOfGetter(s=["seqno"]),set:n.oneOfSetter(s)}),Object.defineProperty(a.prototype,"_signature",{get:n.oneOfGetter(s=["signature"]),set:n.oneOfSetter(s)}),Object.defineProperty(a.prototype,"_key",{get:n.oneOfGetter(s=["key"]),set:n.oneOfSetter(s)}),a.encode=function(e,t){return t||(t=r.create()),null!=e.from&&Object.hasOwnProperty.call(e,"from")&&t.uint32(10).bytes(e.from),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).bytes(e.data),null!=e.seqno&&Object.hasOwnProperty.call(e,"seqno")&&t.uint32(26).bytes(e.seqno),t.uint32(34).string(e.topic),null!=e.signature&&Object.hasOwnProperty.call(e,"signature")&&t.uint32(42).bytes(e.signature),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(50).bytes(e.key),t},a.decode=function(e,r){e instanceof t||(e=t.create(e));for(var a=void 0===r?e.len:e.pos+r,s=new i.RPC.Message;e.pos<a;){var o=e.uint32();switch(o>>>3){case 1:s.from=e.bytes();break;case 2:s.data=e.bytes();break;case 3:s.seqno=e.bytes();break;case 4:s.topic=e.string();break;case 5:s.signature=e.bytes();break;case 6:s.key=e.bytes();break;default:e.skipType(7&o)}}if(!s.hasOwnProperty("topic"))throw n.ProtocolError("missing required 'topic'",{instance:s});return s},a.fromObject=function(e){if(e instanceof i.RPC.Message)return e;var t=new i.RPC.Message;return null!=e.from&&("string"===typeof e.from?n.base64.decode(e.from,t.from=n.newBuffer(n.base64.length(e.from)),0):e.from.length&&(t.from=e.from)),null!=e.data&&("string"===typeof e.data?n.base64.decode(e.data,t.data=n.newBuffer(n.base64.length(e.data)),0):e.data.length&&(t.data=e.data)),null!=e.seqno&&("string"===typeof e.seqno?n.base64.decode(e.seqno,t.seqno=n.newBuffer(n.base64.length(e.seqno)),0):e.seqno.length&&(t.seqno=e.seqno)),null!=e.topic&&(t.topic=String(e.topic)),null!=e.signature&&("string"===typeof e.signature?n.base64.decode(e.signature,t.signature=n.newBuffer(n.base64.length(e.signature)),0):e.signature.length&&(t.signature=e.signature)),null!=e.key&&("string"===typeof e.key?n.base64.decode(e.key,t.key=n.newBuffer(n.base64.length(e.key)),0):e.key.length&&(t.key=e.key)),t},a.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.topic=""),null!=e.from&&e.hasOwnProperty("from")&&(r.from=t.bytes===String?n.base64.encode(e.from,0,e.from.length):t.bytes===Array?Array.prototype.slice.call(e.from):e.from,t.oneofs&&(r._from="from")),null!=e.data&&e.hasOwnProperty("data")&&(r.data=t.bytes===String?n.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data,t.oneofs&&(r._data="data")),null!=e.seqno&&e.hasOwnProperty("seqno")&&(r.seqno=t.bytes===String?n.base64.encode(e.seqno,0,e.seqno.length):t.bytes===Array?Array.prototype.slice.call(e.seqno):e.seqno,t.oneofs&&(r._seqno="seqno")),null!=e.topic&&e.hasOwnProperty("topic")&&(r.topic=e.topic),null!=e.signature&&e.hasOwnProperty("signature")&&(r.signature=t.bytes===String?n.base64.encode(e.signature,0,e.signature.length):t.bytes===Array?Array.prototype.slice.call(e.signature):e.signature,t.oneofs&&(r._signature="signature")),null!=e.key&&e.hasOwnProperty("key")&&(r.key=t.bytes===String?n.base64.encode(e.key,0,e.key.length):t.bytes===Array?Array.prototype.slice.call(e.key):e.key,t.oneofs&&(r._key="key")),r},a.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},a}(),a.ControlMessage=function(){function a(e){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return a.prototype.ihave=n.emptyArray,a.prototype.iwant=n.emptyArray,a.prototype.graft=n.emptyArray,a.prototype.prune=n.emptyArray,a.encode=function(e,t){if(t||(t=r.create()),null!=e.ihave&&e.ihave.length)for(var n=0;n<e.ihave.length;++n)i.RPC.ControlIHave.encode(e.ihave[n],t.uint32(10).fork()).ldelim();if(null!=e.iwant&&e.iwant.length)for(n=0;n<e.iwant.length;++n)i.RPC.ControlIWant.encode(e.iwant[n],t.uint32(18).fork()).ldelim();if(null!=e.graft&&e.graft.length)for(n=0;n<e.graft.length;++n)i.RPC.ControlGraft.encode(e.graft[n],t.uint32(26).fork()).ldelim();if(null!=e.prune&&e.prune.length)for(n=0;n<e.prune.length;++n)i.RPC.ControlPrune.encode(e.prune[n],t.uint32(34).fork()).ldelim();return t},a.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,a=new i.RPC.ControlMessage;e.pos<n;){var s=e.uint32();switch(s>>>3){case 1:a.ihave&&a.ihave.length||(a.ihave=[]),a.ihave.push(i.RPC.ControlIHave.decode(e,e.uint32()));break;case 2:a.iwant&&a.iwant.length||(a.iwant=[]),a.iwant.push(i.RPC.ControlIWant.decode(e,e.uint32()));break;case 3:a.graft&&a.graft.length||(a.graft=[]),a.graft.push(i.RPC.ControlGraft.decode(e,e.uint32()));break;case 4:a.prune&&a.prune.length||(a.prune=[]),a.prune.push(i.RPC.ControlPrune.decode(e,e.uint32()));break;default:e.skipType(7&s)}}return a},a.fromObject=function(e){if(e instanceof i.RPC.ControlMessage)return e;var t=new i.RPC.ControlMessage;if(e.ihave){if(!Array.isArray(e.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");t.ihave=[];for(var r=0;r<e.ihave.length;++r){if("object"!==typeof e.ihave[r])throw TypeError(".RPC.ControlMessage.ihave: object expected");t.ihave[r]=i.RPC.ControlIHave.fromObject(e.ihave[r])}}if(e.iwant){if(!Array.isArray(e.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");for(t.iwant=[],r=0;r<e.iwant.length;++r){if("object"!==typeof e.iwant[r])throw TypeError(".RPC.ControlMessage.iwant: object expected");t.iwant[r]=i.RPC.ControlIWant.fromObject(e.iwant[r])}}if(e.graft){if(!Array.isArray(e.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");for(t.graft=[],r=0;r<e.graft.length;++r){if("object"!==typeof e.graft[r])throw TypeError(".RPC.ControlMessage.graft: object expected");t.graft[r]=i.RPC.ControlGraft.fromObject(e.graft[r])}}if(e.prune){if(!Array.isArray(e.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");for(t.prune=[],r=0;r<e.prune.length;++r){if("object"!==typeof e.prune[r])throw TypeError(".RPC.ControlMessage.prune: object expected");t.prune[r]=i.RPC.ControlPrune.fromObject(e.prune[r])}}return t},a.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.ihave=[],r.iwant=[],r.graft=[],r.prune=[]),e.ihave&&e.ihave.length){r.ihave=[];for(var n=0;n<e.ihave.length;++n)r.ihave[n]=i.RPC.ControlIHave.toObject(e.ihave[n],t)}if(e.iwant&&e.iwant.length)for(r.iwant=[],n=0;n<e.iwant.length;++n)r.iwant[n]=i.RPC.ControlIWant.toObject(e.iwant[n],t);if(e.graft&&e.graft.length)for(r.graft=[],n=0;n<e.graft.length;++n)r.graft[n]=i.RPC.ControlGraft.toObject(e.graft[n],t);if(e.prune&&e.prune.length)for(r.prune=[],n=0;n<e.prune.length;++n)r.prune[n]=i.RPC.ControlPrune.toObject(e.prune[n],t);return r},a.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},a}(),a.ControlIHave=function(){function a(e){if(this.messageIDs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var s;return a.prototype.topicID=null,a.prototype.messageIDs=n.emptyArray,Object.defineProperty(a.prototype,"_topicID",{get:n.oneOfGetter(s=["topicID"]),set:n.oneOfSetter(s)}),a.encode=function(e,t){if(t||(t=r.create()),null!=e.topicID&&Object.hasOwnProperty.call(e,"topicID")&&t.uint32(10).string(e.topicID),null!=e.messageIDs&&e.messageIDs.length)for(var n=0;n<e.messageIDs.length;++n)t.uint32(18).bytes(e.messageIDs[n]);return t},a.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,a=new i.RPC.ControlIHave;e.pos<n;){var s=e.uint32();switch(s>>>3){case 1:a.topicID=e.string();break;case 2:a.messageIDs&&a.messageIDs.length||(a.messageIDs=[]),a.messageIDs.push(e.bytes());break;default:e.skipType(7&s)}}return a},a.fromObject=function(e){if(e instanceof i.RPC.ControlIHave)return e;var t=new i.RPC.ControlIHave;if(null!=e.topicID&&(t.topicID=String(e.topicID)),e.messageIDs){if(!Array.isArray(e.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");t.messageIDs=[];for(var r=0;r<e.messageIDs.length;++r)"string"===typeof e.messageIDs[r]?n.base64.decode(e.messageIDs[r],t.messageIDs[r]=n.newBuffer(n.base64.length(e.messageIDs[r])),0):e.messageIDs[r].length&&(t.messageIDs[r]=e.messageIDs[r])}return t},a.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.messageIDs=[]),null!=e.topicID&&e.hasOwnProperty("topicID")&&(r.topicID=e.topicID,t.oneofs&&(r._topicID="topicID")),e.messageIDs&&e.messageIDs.length){r.messageIDs=[];for(var i=0;i<e.messageIDs.length;++i)r.messageIDs[i]=t.bytes===String?n.base64.encode(e.messageIDs[i],0,e.messageIDs[i].length):t.bytes===Array?Array.prototype.slice.call(e.messageIDs[i]):e.messageIDs[i]}return r},a.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},a}(),a.ControlIWant=function(){function a(e){if(this.messageIDs=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return a.prototype.messageIDs=n.emptyArray,a.encode=function(e,t){if(t||(t=r.create()),null!=e.messageIDs&&e.messageIDs.length)for(var n=0;n<e.messageIDs.length;++n)t.uint32(10).bytes(e.messageIDs[n]);return t},a.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,a=new i.RPC.ControlIWant;e.pos<n;){var s=e.uint32();s>>>3===1?(a.messageIDs&&a.messageIDs.length||(a.messageIDs=[]),a.messageIDs.push(e.bytes())):e.skipType(7&s)}return a},a.fromObject=function(e){if(e instanceof i.RPC.ControlIWant)return e;var t=new i.RPC.ControlIWant;if(e.messageIDs){if(!Array.isArray(e.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");t.messageIDs=[];for(var r=0;r<e.messageIDs.length;++r)"string"===typeof e.messageIDs[r]?n.base64.decode(e.messageIDs[r],t.messageIDs[r]=n.newBuffer(n.base64.length(e.messageIDs[r])),0):e.messageIDs[r].length&&(t.messageIDs[r]=e.messageIDs[r])}return t},a.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.messageIDs=[]),e.messageIDs&&e.messageIDs.length){r.messageIDs=[];for(var i=0;i<e.messageIDs.length;++i)r.messageIDs[i]=t.bytes===String?n.base64.encode(e.messageIDs[i],0,e.messageIDs[i].length):t.bytes===Array?Array.prototype.slice.call(e.messageIDs[i]):e.messageIDs[i]}return r},a.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},a}(),a.ControlGraft=function(){function a(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var s;return a.prototype.topicID=null,Object.defineProperty(a.prototype,"_topicID",{get:n.oneOfGetter(s=["topicID"]),set:n.oneOfSetter(s)}),a.encode=function(e,t){return t||(t=r.create()),null!=e.topicID&&Object.hasOwnProperty.call(e,"topicID")&&t.uint32(10).string(e.topicID),t},a.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,a=new i.RPC.ControlGraft;e.pos<n;){var s=e.uint32();s>>>3===1?a.topicID=e.string():e.skipType(7&s)}return a},a.fromObject=function(e){if(e instanceof i.RPC.ControlGraft)return e;var t=new i.RPC.ControlGraft;return null!=e.topicID&&(t.topicID=String(e.topicID)),t},a.toObject=function(e,t){t||(t={});var r={};return null!=e.topicID&&e.hasOwnProperty("topicID")&&(r.topicID=e.topicID,t.oneofs&&(r._topicID="topicID")),r},a.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},a}(),a.ControlPrune=function(){function a(e){if(this.peers=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var s;return a.prototype.topicID=null,a.prototype.peers=n.emptyArray,a.prototype.backoff=null,Object.defineProperty(a.prototype,"_topicID",{get:n.oneOfGetter(s=["topicID"]),set:n.oneOfSetter(s)}),Object.defineProperty(a.prototype,"_backoff",{get:n.oneOfGetter(s=["backoff"]),set:n.oneOfSetter(s)}),a.encode=function(e,t){if(t||(t=r.create()),null!=e.topicID&&Object.hasOwnProperty.call(e,"topicID")&&t.uint32(10).string(e.topicID),null!=e.peers&&e.peers.length)for(var n=0;n<e.peers.length;++n)i.RPC.PeerInfo.encode(e.peers[n],t.uint32(18).fork()).ldelim();return null!=e.backoff&&Object.hasOwnProperty.call(e,"backoff")&&t.uint32(24).uint64(e.backoff),t},a.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,a=new i.RPC.ControlPrune;e.pos<n;){var s=e.uint32();switch(s>>>3){case 1:a.topicID=e.string();break;case 2:a.peers&&a.peers.length||(a.peers=[]),a.peers.push(i.RPC.PeerInfo.decode(e,e.uint32()));break;case 3:a.backoff=e.uint64();break;default:e.skipType(7&s)}}return a},a.fromObject=function(e){if(e instanceof i.RPC.ControlPrune)return e;var t=new i.RPC.ControlPrune;if(null!=e.topicID&&(t.topicID=String(e.topicID)),e.peers){if(!Array.isArray(e.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");t.peers=[];for(var r=0;r<e.peers.length;++r){if("object"!==typeof e.peers[r])throw TypeError(".RPC.ControlPrune.peers: object expected");t.peers[r]=i.RPC.PeerInfo.fromObject(e.peers[r])}}return null!=e.backoff&&(n.Long?(t.backoff=n.Long.fromValue(e.backoff)).unsigned=!0:"string"===typeof e.backoff?t.backoff=parseInt(e.backoff,10):"number"===typeof e.backoff?t.backoff=e.backoff:"object"===typeof e.backoff&&(t.backoff=new n.LongBits(e.backoff.low>>>0,e.backoff.high>>>0).toNumber(!0))),t},a.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.peers=[]),null!=e.topicID&&e.hasOwnProperty("topicID")&&(r.topicID=e.topicID,t.oneofs&&(r._topicID="topicID")),e.peers&&e.peers.length){r.peers=[];for(var a=0;a<e.peers.length;++a)r.peers[a]=i.RPC.PeerInfo.toObject(e.peers[a],t)}return null!=e.backoff&&e.hasOwnProperty("backoff")&&("number"===typeof e.backoff?r.backoff=t.longs===String?String(e.backoff):e.backoff:r.backoff=t.longs===String?n.Long.prototype.toString.call(e.backoff):t.longs===Number?new n.LongBits(e.backoff.low>>>0,e.backoff.high>>>0).toNumber(!0):e.backoff,t.oneofs&&(r._backoff="backoff")),r},a.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},a}(),a.PeerInfo=function(){function a(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}var s;return a.prototype.peerID=null,a.prototype.signedPeerRecord=null,Object.defineProperty(a.prototype,"_peerID",{get:n.oneOfGetter(s=["peerID"]),set:n.oneOfSetter(s)}),Object.defineProperty(a.prototype,"_signedPeerRecord",{get:n.oneOfGetter(s=["signedPeerRecord"]),set:n.oneOfSetter(s)}),a.encode=function(e,t){return t||(t=r.create()),null!=e.peerID&&Object.hasOwnProperty.call(e,"peerID")&&t.uint32(10).bytes(e.peerID),null!=e.signedPeerRecord&&Object.hasOwnProperty.call(e,"signedPeerRecord")&&t.uint32(18).bytes(e.signedPeerRecord),t},a.decode=function(e,r){e instanceof t||(e=t.create(e));for(var n=void 0===r?e.len:e.pos+r,a=new i.RPC.PeerInfo;e.pos<n;){var s=e.uint32();switch(s>>>3){case 1:a.peerID=e.bytes();break;case 2:a.signedPeerRecord=e.bytes();break;default:e.skipType(7&s)}}return a},a.fromObject=function(e){if(e instanceof i.RPC.PeerInfo)return e;var t=new i.RPC.PeerInfo;return null!=e.peerID&&("string"===typeof e.peerID?n.base64.decode(e.peerID,t.peerID=n.newBuffer(n.base64.length(e.peerID)),0):e.peerID.length&&(t.peerID=e.peerID)),null!=e.signedPeerRecord&&("string"===typeof e.signedPeerRecord?n.base64.decode(e.signedPeerRecord,t.signedPeerRecord=n.newBuffer(n.base64.length(e.signedPeerRecord)),0):e.signedPeerRecord.length&&(t.signedPeerRecord=e.signedPeerRecord)),t},a.toObject=function(e,t){t||(t={});var r={};return null!=e.peerID&&e.hasOwnProperty("peerID")&&(r.peerID=t.bytes===String?n.base64.encode(e.peerID,0,e.peerID.length):t.bytes===Array?Array.prototype.slice.call(e.peerID):e.peerID,t.oneofs&&(r._peerID="peerID")),null!=e.signedPeerRecord&&e.hasOwnProperty("signedPeerRecord")&&(r.signedPeerRecord=t.bytes===String?n.base64.encode(e.signedPeerRecord,0,e.signedPeerRecord.length):t.bytes===Array?Array.prototype.slice.call(e.signedPeerRecord):e.signedPeerRecord,t.oneofs&&(r._signedPeerRecord="signedPeerRecord")),r},a.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},a}(),a}(),i})?n.apply(t,i):n)||(e.exports=a)},8974:function(e){!function(){e.exports=g;var t=86400,r=3200,n=146097*r/400,i=t*n,a=1e3*i,s=864e13,o=4294967296,u=1e6,c="000000000",l=Math.trunc||function(e){var t=e-e%1;return 0==t&&(e<0||0===e&&1/e!=1/0)?-0:t},h=g.prototype,f=(g.fromDate=function(e){return new g(+e)},g.fromInt64BE=w(0,1,2,3,0,4),g.fromInt64LE=w(3,2,1,0,4,0),g.fromString=function(e){var t,r=new g;e=(e+="").replace(/^\s*[+\-]?\d+/,(function(e){var t=1970+((e=+e)-1970)%400;return r.year=e-t,t})).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,(function(e,r,n){return r<0&&(n*=-1),t=6e4*(60*+r+ +n),""})).replace(/\.\d+$/,(function(e){return r.nano=+(e+c).substr(1,9),""})).split(/\D+/);if(1<e.length?e[1]--:e[1]=0,r.time=t=Date.UTC.apply(Date,e)-(t||0),isNaN(t))throw new TypeError("Invalid Date");return y(r)},g.fromTimeT=function(e){return b(e,0)},h.year=0,h.time=0,h.nano=0,h.addNano=function(e){return this.nano+=+e||0,this},h.getNano=function(){var e=y(this);return(e.time%1e3*u+ +e.nano+1e9)%1e9},h.getTimeT=function(){var e=y(this),i=Math.floor(e.time/1e3);return(e=e.year)&&(i+=e*n*t/r),i},h.getYear=function(){return this.toDate().getUTCFullYear()+this.year},h.toDate=function(){return m(y(this).time)},h.toJSON=function(){return this.toString().replace(/0{1,6}Z$/,"Z")},h.toString=function(e){var t=this,r=t.toDate(),n={H:function(){return x(r.getUTCHours())},L:function(){return E(r.getUTCMilliseconds(),3)},M:function(){return x(r.getUTCMinutes())},N:function(){return E(t.getNano(),9)},S:function(){return x(r.getUTCSeconds())},Y:function(){var e=t.getYear();return 999999<e?"+"+e:9999<e?"+"+E(e,6):0<=e?E(e,4):-999999<=e?"-"+E(-e,6):e},a:function(){return p[r.getUTCDay()]},b:function(){return d[r.getUTCMonth()]},d:function(){return x(r.getUTCDate())},e:function(){return function(e){return(9<e?"":" ")+(0|e)}(r.getUTCDate())},m:function(){return x(r.getUTCMonth()+1)}};return function e(t){return t.replace(/%./g,(function(t){var r=t[1],i=v[r];r=n[r];return i?e(i):r?r():t}))}(e||f)},h.writeInt64BE=_(0,1,2,3,0,4),h.writeInt64LE=_(3,2,1,0,4,0),"%Y-%m-%dT%H:%M:%S.%NZ"),d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],p=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],v={"%":"%",F:"%Y-%m-%d",n:"\n",R:"%H:%M",T:"%H:%M:%S",t:"\t",X:"%T",Z:"GMT",z:"+0000"};return g;function g(e,t,r){var n=this;if(!(n instanceof g))return new g(e,t,r);n.time=+e||0,n.nano=+t||0,n.year=+r||0,y(n)}function y(e){var t,n,i,o=e.year,c=e.time,h=e.nano,f=((h<0||u<=h)&&(h-=(n=Math.floor(h/u))*u,c+=n,n=1),o%r);return(c<-s||s<c||f)&&((t=l(c/a))&&(o+=t*r,c-=t*a),(i=m(c)).setUTCFullYear(f+i.getUTCFullYear()),i=(c=+i)+(t=l((o-=f)/r))*a,t&&-s<=i&&i<=s&&(o-=t*r,c=i),n=1),n&&(e.year=o,e.time=c,e.nano=h),e}function m(e){var t=new Date(0);return t.setTime(e),t}function b(e,t){e=+e||0;var n=l((t=(0|t)*o)/i)+l(e/i);return(e=l((t=t%i+e%i)/i))&&(n+=e,t-=e*i),new g(1e3*t,0,n*r)}function _(e,i,a,s,u,c){return function(e,i){var a=y(this);k(e=e||new Array(8),i|=0);var s=Math.floor(a.time/1e3),f=(a=a.year*(n*t/r),l(a/o)+l(s/o));a=a%o+s%o;return(s=Math.floor(a/o))&&(f+=s,a-=s*o),h(e,i+u,f),h(e,i+c,a),e};function h(t,r,n){t[r+e]=n>>24&255,t[r+i]=n>>16&255,t[r+a]=n>>8&255,t[r+s]=255&n}}function w(e,t,r,n,i,a){return function(e,t){k(e,t|=0);var r=s(e,t+i);return b(s(e,t+a),r)};function s(i,a){return 16777216*i[a+e]+(i[a+t]<<16|i[a+r]<<8|i[a+n])}}function k(e,t){if(null==(e=e&&e.length))throw new TypeError("Invalid Buffer");if(e<t+8)throw new RangeError("Out of range")}function x(e){return(9<e?"":"0")+(0|e)}function E(e,t){return(c+(0|e)).substr(-t)}}()},907:function(e,t,r){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r.d(t,{Z:function(){return n}})},5861:function(e,t,r){"use strict";function n(e,t,r,n,i,a,s){try{var o=e[a](s),u=o.value}catch(c){return void r(c)}o.done?t(u):Promise.resolve(u).then(n,i)}function i(e){return function(){var t=this,r=arguments;return new Promise((function(i,a){var s=e.apply(t,r);function o(e){n(s,i,a,o,u,"next",e)}function u(e){n(s,i,a,o,u,"throw",e)}o(void 0)}))}}r.d(t,{Z:function(){return i}})},5671:function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.d(t,{Z:function(){return n}})},3144:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(9142);function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(0,n.Z)(i.key),i)}}function a(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}},7762:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(181);function i(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=(0,n.Z)(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){u=!0,s=e},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw s}}}}},4942:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(9142);function i(e,t,r){return(t=(0,n.Z)(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},1413:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(4942);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}},4165:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(1002);function i(){i=function(){return t};var e,t={},r=Object.prototype,a=r.hasOwnProperty,s=Object.defineProperty||function(e,t,r){e[t]=r.value},o="function"==typeof Symbol?Symbol:{},u=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function h(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(e){h=function(e,t,r){return e[t]=r}}function f(e,t,r,n){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),o=new I(n||[]);return s(a,"_invoke",{value:D(e,r,o)}),a}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=f;var p="suspendedStart",v="suspendedYield",g="executing",y="completed",m={};function b(){}function _(){}function w(){}var k={};h(k,u,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(P([])));E&&E!==r&&a.call(E,u)&&(k=E);var S=w.prototype=b.prototype=Object.create(k);function C(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){function r(i,s,o,u){var c=d(e[i],e,s);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==(0,n.Z)(h)&&a.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,o,u)}),(function(e){r("throw",e,o,u)})):t.resolve(h).then((function(e){l.value=e,o(l)}),(function(e){return r("throw",e,o,u)}))}u(c.arg)}var i;s(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,i){r(e,n,t,i)}))}return i=i?i.then(a,a):a()}})}function D(t,r,n){var i=p;return function(a,s){if(i===g)throw new Error("Generator is already running");if(i===y){if("throw"===a)throw s;return{value:e,done:!0}}for(n.method=a,n.arg=s;;){var o=n.delegate;if(o){var u=R(o,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===p)throw i=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=g;var c=d(t,r,n);if("normal"===c.type){if(i=n.done?y:v,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=y,n.method="throw",n.arg=c.arg)}}}function R(t,r){var n=r.method,i=t.iterator[n];if(i===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,R(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var a=d(i,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var s=a.arg;return s?s.done?(r[t.resultName]=s.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function Z(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(t){if(t||""===t){var r=t[u];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,s=function r(){for(;++i<t.length;)if(a.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return s.next=s}}throw new TypeError((0,n.Z)(t)+" is not iterable")}return _.prototype=w,s(S,"constructor",{value:w,configurable:!0}),s(w,"constructor",{value:_,configurable:!0}),_.displayName=h(w,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,h(e,l,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},C(A.prototype),h(A.prototype,c,(function(){return this})),t.AsyncIterator=A,t.async=function(e,r,n,i,a){void 0===a&&(a=Promise);var s=new A(f(e,r,n,i),a);return t.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},C(S),h(S,l,"Generator"),h(S,u,(function(){return this})),h(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=P,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(Z),!t)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,i){return o.type="throw",o.arg=t,r.next=n,i&&(r.method="next",r.arg=e),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var u=a.call(s,"catchLoc"),c=a.call(s,"finallyLoc");if(u&&c){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(u){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),Z(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;Z(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:P(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),m}},t}},885:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(181);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a,s,o=[],u=!0,c=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(o.push(n.value),o.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw i}}return o}}(e,t)||(0,n.Z)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},9142:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(1002);function i(e){var t=function(e,t){if("object"!==(0,n.Z)(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!==(0,n.Z)(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===(0,n.Z)(t)?t:String(t)}},1002:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r.d(t,{Z:function(){return n}})},181:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(907);function i(e,t){if(e){if("string"===typeof e)return(0,n.Z)(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?(0,n.Z)(e,t):void 0}}},4180:function(e,t,r){"use strict";r.d(t,{E:function(){return i}});var n=r(4244);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?(0,n.P)(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}},3568:function(e,t,r){"use strict";r.r(t),r.d(t,{concat:function(){return s}});var n=r(7762),i=r(4180),a=r(4244);function s(e,t){t||(t=e.reduce((function(e,t){return e+t.length}),0));var r,s=(0,i.E)(t),o=0,u=(0,n.Z)(e);try{for(u.s();!(r=u.n()).done;){var c=r.value;s.set(c,o),o+=c.length}}catch(l){u.e(l)}finally{u.f()}return(0,a.P)(s)}},8347:function(e,t,r){"use strict";r.r(t),r.d(t,{fromString:function(){return a}});var n=r(5607),i=r(4244);function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",r=n.Z[t];if(!r)throw new Error('Unsupported encoding "'.concat(t,'"'));return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode("".concat(r.prefix).concat(e)):(0,i.P)(globalThis.Buffer.from(e,"utf-8"))}},4634:function(e,t,r){"use strict";r.r(t),r.d(t,{toString:function(){return i}});var n=r(5607);function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",r=n.Z[t];if(!r)throw new Error('Unsupported encoding "'.concat(t,'"'));return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}},4244:function(e,t,r){"use strict";function n(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}r.d(t,{P:function(){return n}})},5607:function(e,t,r){"use strict";r.d(t,{Z:function(){return lt}});var n={};r.r(n),r.d(n,{identity:function(){return I}});var i={};r.r(i),r.d(i,{base2:function(){return P}});var a={};r.r(a),r.d(a,{base8:function(){return L}});var s={};r.r(s),r.d(s,{base10:function(){return M}});var o={};r.r(o),r.d(o,{base16:function(){return B},base16upper:function(){return O}});var u={};r.r(u),r.d(u,{base32:function(){return N},base32hex:function(){return j},base32hexpad:function(){return W},base32hexpadupper:function(){return q},base32hexupper:function(){return H},base32pad:function(){return U},base32padupper:function(){return z},base32upper:function(){return F},base32z:function(){return V}});var c={};r.r(c),r.d(c,{base36:function(){return K},base36upper:function(){return Y}});var l={};r.r(l),r.d(l,{base58btc:function(){return G},base58flickr:function(){return Q}});var h={};r.r(h),r.d(h,{base64:function(){return X},base64pad:function(){return J},base64url:function(){return $},base64urlpad:function(){return ee}});var f={};r.r(f),r.d(f,{base256emoji:function(){return ae}});var d={};r.r(d),r.d(d,{sha256:function(){return Le},sha512:function(){return Me}});var p={};r.r(p),r.d(p,{identity:function(){return Oe}});var v={};r.r(v),r.d(v,{code:function(){return Fe},decode:function(){return ze},encode:function(){return Ue},name:function(){return Ne}});var g={};r.r(g),r.d(g,{code:function(){return qe},decode:function(){return Ke},encode:function(){return Ve},name:function(){return We}});var y=r(1413),m=r(4942),b=r(5671),_=r(3144);var w=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var a=e.charAt(i),s=a.charCodeAt(0);if(255!==r[s])throw new TypeError(a+" is ambiguous");r[s]=i}var o=e.length,u=e.charAt(0),c=Math.log(o)/Math.log(256),l=Math.log(256)/Math.log(o);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===u;)n++,t++;for(var a=(e.length-t)*c+1>>>0,s=new Uint8Array(a);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var h=0,f=a-1;(0!==l||h<i)&&-1!==f;f--,h++)l+=o*s[f]>>>0,s[f]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var d=a-i;d!==a&&0===s[d];)d++;for(var p=new Uint8Array(n+(a-d)),v=n;d!==a;)p[v++]=s[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,a=t.length;i!==a&&0===t[i];)i++,r++;for(var s=(a-i)*l+1>>>0,c=new Uint8Array(s);i!==a;){for(var h=t[i],f=0,d=s-1;(0!==h||f<n)&&-1!==d;d--,f++)h+=256*c[d]>>>0,c[d]=h%o>>>0,h=h/o>>>0;if(0!==h)throw new Error("Non-zero carry");n=f,i++}for(var p=s-n;p!==s&&0===c[p];)p++;for(var v=u.repeat(r);p<s;++p)v+=e.charAt(c[p]);return v},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error("Non-".concat(t," character"))}}},k=w,x=(new Uint8Array(0),function(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}),E=function(){function e(t,r,n){(0,b.Z)(this,e),this.name=t,this.prefix=r,this.baseEncode=n}return(0,_.Z)(e,[{key:"encode",value:function(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}]),e}(),S=function(){function e(t,r,n){if((0,b.Z)(this,e),this.name=t,this.prefix=r,void 0===r.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}return(0,_.Z)(e,[{key:"decode",value:function(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}},{key:"or",value:function(e){return A(this,e)}}]),e}(),C=function(){function e(t){(0,b.Z)(this,e),this.decoders=t}return(0,_.Z)(e,[{key:"or",value:function(e){return A(this,e)}},{key:"decode",value:function(e){var t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}]),e}(),A=function(e,t){return new C((0,y.Z)((0,y.Z)({},e.decoders||(0,m.Z)({},e.prefix,e)),t.decoders||(0,m.Z)({},t.prefix,t)))},D=function(){function e(t,r,n,i){(0,b.Z)(this,e),this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new E(t,r,n),this.decoder=new S(t,r,i)}return(0,_.Z)(e,[{key:"encode",value:function(e){return this.encoder.encode(e)}},{key:"decode",value:function(e){return this.decoder.decode(e)}}]),e}(),R=function(e){var t=e.name,r=e.prefix,n=e.encode,i=e.decode;return new D(t,r,n,i)},T=function(e){var t=e.prefix,r=e.name,n=e.alphabet,i=k(n,r),a=i.encode,s=i.decode;return R({prefix:t,name:r,encode:a,decode:function(e){return x(s(e))}})},Z=function(e){var t=e.name,r=e.prefix,n=e.bitsPerChar,i=e.alphabet;return R({prefix:r,name:t,encode:function(e){return function(e,t,r){for(var n="="===t[t.length-1],i=(1<<r)-1,a="",s=0,o=0,u=0;u<e.length;++u)for(o=o<<8|e[u],s+=8;s>r;)a+=t[i&o>>(s-=r)];if(s&&(a+=t[i&o<<r-s]),n)for(;a.length*r&7;)a+="=";return a}(e,i,n)},decode:function(e){return function(e,t,r,n){for(var i={},a=0;a<t.length;++a)i[t[a]]=a;for(var s=e.length;"="===e[s-1];)--s;for(var o=new Uint8Array(s*r/8|0),u=0,c=0,l=0,h=0;h<s;++h){var f=i[e[h]];if(void 0===f)throw new SyntaxError("Non-".concat(n," character"));c=c<<r|f,(u+=r)>=8&&(u-=8,o[l++]=255&c>>u)}if(u>=r||255&c<<8-u)throw new SyntaxError("Unexpected end of data");return o}(e,i,n,t)}})},I=R({prefix:"\0",name:"identity",encode:function(e){return t=e,(new TextDecoder).decode(t);var t},decode:function(e){return function(e){return(new TextEncoder).encode(e)}(e)}}),P=Z({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),L=Z({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),M=T({prefix:"9",name:"base10",alphabet:"0123456789"}),B=Z({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),O=Z({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),N=Z({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),F=Z({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),U=Z({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),z=Z({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),j=Z({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),H=Z({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),W=Z({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),q=Z({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),V=Z({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),K=T({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Y=T({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),G=T({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Q=T({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),X=Z({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),J=Z({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),$=Z({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ee=Z({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),te=r(7762),re=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),ne=re.reduce((function(e,t,r){return e[r]=t,e}),[]),ie=re.reduce((function(e,t,r){return e[t.codePointAt(0)]=r,e}),[]);var ae=R({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce((function(e,t){return e+=ne[t]}),"")},decode:function(e){var t,r=[],n=(0,te.Z)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=ie[i.codePointAt(0)];if(void 0===a)throw new Error("Non-base256emoji character: ".concat(i));r.push(a)}}catch(s){n.e(s)}finally{n.f()}return new Uint8Array(r)}}),se=r(4165),oe=r(5861),ue=r(885),ce=function e(t,r,n){r=r||[];var i=n=n||0;for(;t>=fe;)r[n++]=255&t|le,t/=128;for(;t&he;)r[n++]=255&t|le,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},le=128,he=-128,fe=Math.pow(2,31);var de=function e(t,r){var n,i=0,a=0,s=r=r||0,o=t.length;do{if(s>=o)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],i+=a<28?(n&ve)<<a:(n&ve)*Math.pow(2,a),a+=7}while(n>=pe);return e.bytes=s-r,i},pe=128,ve=127;var ge=Math.pow(2,7),ye=Math.pow(2,14),me=Math.pow(2,21),be=Math.pow(2,28),_e=Math.pow(2,35),we=Math.pow(2,42),ke=Math.pow(2,49),xe=Math.pow(2,56),Ee=Math.pow(2,63),Se={encode:ce,decode:de,encodingLength:function(e){return e<ge?1:e<ye?2:e<me?3:e<be?4:e<_e?5:e<we?6:e<ke?7:e<xe?8:e<Ee?9:10}},Ce=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[Se.decode(e,t),Se.decode.bytes]},Ae=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Se.encode(e,t,r),t},De=function(e){return Se.encodingLength(e)},Re=function(e,t){var r=t.byteLength,n=De(e),i=n+De(r),a=new Uint8Array(i+r);return Ae(e,a,0),Ae(r,a,n),a.set(t,i),new Te(e,r,t,a)},Te=(0,_.Z)((function e(t,r,n,i){(0,b.Z)(this,e),this.code=t,this.size=r,this.digest=n,this.bytes=i})),Ze=function(e){var t=e.name,r=e.code,n=e.encode;return new Ie(t,r,n)},Ie=function(){function e(t,r,n){(0,b.Z)(this,e),this.name=t,this.code=r,this.encode=n}return(0,_.Z)(e,[{key:"digest",value:function(e){var t=this;if(e instanceof Uint8Array){var r=this.encode(e);return r instanceof Uint8Array?Re(this.code,r):r.then((function(e){return Re(t.code,e)}))}throw Error("Unknown type, must be binary type")}}]),e}(),Pe=function(e){return function(){var t=(0,oe.Z)((0,se.Z)().mark((function t(r){return(0,se.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Uint8Array,t.next=3,crypto.subtle.digest(e,r);case 3:return t.t1=t.sent,t.abrupt("return",new t.t0(t.t1));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},Le=Ze({name:"sha2-256",code:18,encode:Pe("SHA-256")}),Me=Ze({name:"sha2-512",code:19,encode:Pe("SHA-512")}),Be=x,Oe={code:0,name:"identity",encode:Be,digest:function(e){return Re(0,Be(e))}},Ne="raw",Fe=85,Ue=function(e){return x(e)},ze=function(e){return x(e)},je=new TextEncoder,He=new TextDecoder,We="json",qe=512,Ve=function(e){return je.encode(JSON.stringify(e))},Ke=function(e){return JSON.parse(He.decode(e))},Ye=(Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom"),function(e,t){switch(e[0]){case"Q":var r=t||G;return[G.prefix,r.decode("".concat(G.prefix).concat(e))];case G.prefix:var n=t||G;return[G.prefix,n.decode(e)];case N.prefix:var i=t||N;return[N.prefix,i.decode(e)];default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}),Ge=function(e,t,r){var n=r.prefix;if(n!==G.prefix)throw Error("Cannot string encode V0 in ".concat(r.name," encoding"));var i=t.get(n);if(null==i){var a=r.encode(e).slice(1);return t.set(n,a),a}return i},Qe=function(e,t,r){var n=r.prefix,i=t.get(n);if(null==i){var a=r.encode(e);return t.set(n,a),a}return i},Xe=112,Je=18,$e=function(e,t,r){var n=De(e),i=n+De(t),a=new Uint8Array(i+r.byteLength);return Ae(e,a,0),Ae(t,a,n),a.set(r,i),a},et=Symbol.for("@ipld/js-cid/CID"),tt={writable:!1,configurable:!1,enumerable:!0},rt={writable:!1,enumerable:!1,configurable:!1},nt=function(e,t){if(!e.test("0.0.0-dev"))throw new Error(t);console.warn(t)},it="CID.isCID(v) is deprecated and will be removed in the next major release.\nFollowing code pattern:\n\nif (CID.isCID(value)) {\n  doSomethingWithCID(value)\n}\n\nIs replaced with:\n\nconst cid = CID.asCID(value)\nif (cid) {\n  // Make sure to use cid instead of value\n  doSomethingWithCID(cid)\n}\n",at=(0,y.Z)((0,y.Z)((0,y.Z)((0,y.Z)((0,y.Z)((0,y.Z)((0,y.Z)((0,y.Z)((0,y.Z)((0,y.Z)({},n),i),a),s),o),u),c),l),h),f),st=((0,y.Z)((0,y.Z)({},d),p),r(4180));function ot(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var ut=ot("utf8","u",(function(e){return"u"+new TextDecoder("utf8").decode(e)}),(function(e){return(new TextEncoder).encode(e.substring(1))})),ct=ot("ascii","a",(function(e){for(var t="a",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(function(e){e=e.substring(1);for(var t=(0,st.E)(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),lt=(0,y.Z)({utf8:ut,"utf-8":ut,hex:at.base16,latin1:ct,ascii:ct,binary:ct},at)}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.loaded=!0,r.exports}__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,{a:t}),t},function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};__webpack_require__.t=function(r,n){if(1&n&&(r=this(r)),8&n)return r;if("object"===typeof r&&r){if(4&n&&r.__esModule)return r;if(16&n&&"function"===typeof r.then)return r}var i=Object.create(null);__webpack_require__.r(i);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&n&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((function(e){a[e]=function(){return r[e]}}));return a.default=function(){return r},__webpack_require__.d(i,a),i}}(),__webpack_require__.d=function(e,t){for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e};var __webpack_exports__={};!function(){"use strict";var e={};__webpack_require__.r(e),__webpack_require__.d(e,{base32:function(){return Ci},base32hex:function(){return Ti},base32hexpad:function(){return Ii},base32hexpadupper:function(){return Pi},base32hexupper:function(){return Zi},base32pad:function(){return Di},base32padupper:function(){return Ri},base32upper:function(){return Ai},base32z:function(){return Li}});var t={};__webpack_require__.r(t),__webpack_require__.d(t,{base58btc:function(){return Mi},base58flickr:function(){return Bi}});var r={};__webpack_require__.r(r),__webpack_require__.d(r,{base64:function(){return Oi},base64pad:function(){return Ni},base64url:function(){return Fi},base64urlpad:function(){return Ui}});var n={};__webpack_require__.r(n),__webpack_require__.d(n,{abortedError:function(){return Qi},closeFailedError:function(){return Wi},deleteFailedError:function(){return Ki},getFailedError:function(){return Vi},hasFailedError:function(){return Yi},notFoundError:function(){return Gi},openFailedError:function(){return Hi},putFailedError:function(){return qi}});var i={};__webpack_require__.r(i),__webpack_require__.d(i,{code:function(){return qa},decode:function(){return Ka},encode:function(){return Va},name:function(){return Wa}});var a={};__webpack_require__.r(a),__webpack_require__.d(a,{base10:function(){return ls}});var s={};__webpack_require__.r(s),__webpack_require__.d(s,{base16:function(){return hs},base16upper:function(){return fs}});var o={};__webpack_require__.r(o),__webpack_require__.d(o,{base2:function(){return ds}});var u={};__webpack_require__.r(u),__webpack_require__.d(u,{base256emoji:function(){return ys}});var c={};__webpack_require__.r(c),__webpack_require__.d(c,{base36:function(){return ms},base36upper:function(){return bs}});var l={};__webpack_require__.r(l),__webpack_require__.d(l,{base8:function(){return _s}});var h={};__webpack_require__.r(h),__webpack_require__.d(h,{identity:function(){return ws}});var f={};__webpack_require__.r(f),__webpack_require__.d(f,{code:function(){return Ss},decode:function(){return As},encode:function(){return Cs},name:function(){return Es}});var d={};__webpack_require__.r(d),__webpack_require__.d(d,{identity:function(){return Rs}});var p={};__webpack_require__.r(p),__webpack_require__.d(p,{sha256:function(){return Ps},sha512:function(){return Ls}});var v={};__webpack_require__.r(v),__webpack_require__.d(v,{Token:function(){return lc},Type:function(){return cc},decode:function(){return Gl},decodeFirst:function(){return Yl},encode:function(){return jl}});var g={};__webpack_require__.r(g),__webpack_require__.d(g,{code:function(){return Uh},decode:function(){return jh},encode:function(){return zh},name:function(){return Fh}});var y={};__webpack_require__.r(y),__webpack_require__.d(y,{code:function(){return $h},decode:function(){return tf},encode:function(){return ef},format:function(){return rf},name:function(){return Jh},parse:function(){return af},stringify:function(){return rf}});var m={};__webpack_require__.r(m),__webpack_require__.d(m,{code:function(){return If},createLink:function(){return Tf},createNode:function(){return Rf},decode:function(){return Lf},encode:function(){return Pf},name:function(){return Zf},prepare:function(){return Af},validate:function(){return Df}});var b={};__webpack_require__.r(b),__webpack_require__.d(b,{bitGet:function(){return Sp},bitLen:function(){return Ep},bitMask:function(){return Ap},bitSet:function(){return Cp},bytesToHex:function(){return hp},bytesToNumberBE:function(){return vp},bytesToNumberLE:function(){return gp},concatBytes:function(){return wp},createHmacDrbg:function(){return Tp},ensureBytes:function(){return _p},equalBytes:function(){return kp},hexToBytes:function(){return pp},hexToNumber:function(){return dp},numberToBytesBE:function(){return yp},numberToBytesLE:function(){return mp},numberToHexUnpadded:function(){return fp},numberToVarBytesBE:function(){return bp},utf8ToBytes:function(){return xp},validateObject:function(){return Ip}});var _={};__webpack_require__.r(_),__webpack_require__.d(_,{Ed25519PrivateKey:function(){return Qv},Ed25519PublicKey:function(){return Gv},generateKeyPair:function(){return $v},generateKeyPairFromSeed:function(){return tg},unmarshalEd25519PrivateKey:function(){return Xv},unmarshalEd25519PublicKey:function(){return Jv}});var w={};__webpack_require__.r(w),__webpack_require__.d(w,{MAX_KEY_SIZE:function(){return Dg},RsaPrivateKey:function(){return Tg},RsaPublicKey:function(){return Rg},fromJwk:function(){return Lg},generateKeyPair:function(){return Bg},unmarshalRsaPrivateKey:function(){return Zg},unmarshalRsaPublicKey:function(){return Pg}});var k={};__webpack_require__.r(k),__webpack_require__.d(k,{Secp256k1PrivateKey:function(){return py},Secp256k1PublicKey:function(){return dy},generateKeyPair:function(){return yy},unmarshalSecp256k1PrivateKey:function(){return vy},unmarshalSecp256k1PublicKey:function(){return gy}});var x={};__webpack_require__.r(x),__webpack_require__.d(x,{code:function(){return XL},decode:function(){return rM},encode:function(){return tM},name:function(){return QL},toGeneral:function(){return eM}});var E={};__webpack_require__.r(E),__webpack_require__.d(E,{identity:function(){return RM}});var S={};__webpack_require__.r(S),__webpack_require__.d(S,{identity:function(){return UM}});var C={};__webpack_require__.r(C),__webpack_require__.d(C,{base2:function(){return zM}});var A={};__webpack_require__.r(A),__webpack_require__.d(A,{base8:function(){return jM}});var D={};__webpack_require__.r(D),__webpack_require__.d(D,{base10:function(){return HM}});var R={};__webpack_require__.r(R),__webpack_require__.d(R,{base16:function(){return WM},base16upper:function(){return qM}});var T={};__webpack_require__.r(T),__webpack_require__.d(T,{base32:function(){return VM},base32hex:function(){return QM},base32hexpad:function(){return JM},base32hexpadupper:function(){return $M},base32hexupper:function(){return XM},base32pad:function(){return YM},base32padupper:function(){return GM},base32upper:function(){return KM},base32z:function(){return eB}});var Z={};__webpack_require__.r(Z),__webpack_require__.d(Z,{base36:function(){return tB},base36upper:function(){return rB}});var I={};__webpack_require__.r(I),__webpack_require__.d(I,{base58btc:function(){return nB},base58flickr:function(){return iB}});var P={};__webpack_require__.r(P),__webpack_require__.d(P,{base64:function(){return aB},base64pad:function(){return sB},base64url:function(){return oB},base64urlpad:function(){return uB}});var L={};__webpack_require__.r(L),__webpack_require__.d(L,{base256emoji:function(){return fB}});var M={};__webpack_require__.r(M),__webpack_require__.d(M,{sha256:function(){return gB},sha512:function(){return yB}});var B={};__webpack_require__.r(B),__webpack_require__.d(B,{code:function(){return bB},decode:function(){return wB},encode:function(){return _B},name:function(){return mB}});var O={};__webpack_require__.r(O),__webpack_require__.d(O,{code:function(){return SB},decode:function(){return AB},encode:function(){return CB},name:function(){return EB}});var N={};__webpack_require__.r(N),__webpack_require__.d(N,{base58btc:function(){return DN},base58flickr:function(){return RN}});var F={};__webpack_require__.r(F),__webpack_require__.d(F,{base32:function(){return TN},base32hex:function(){return LN},base32hexpad:function(){return BN},base32hexpadupper:function(){return ON},base32hexupper:function(){return MN},base32pad:function(){return IN},base32padupper:function(){return PN},base32upper:function(){return ZN},base32z:function(){return NN}});var U={};__webpack_require__.r(U),__webpack_require__.d(U,{identity:function(){return QN}});var z={};__webpack_require__.r(z),__webpack_require__.d(z,{base2:function(){return XN}});var j={};__webpack_require__.r(j),__webpack_require__.d(j,{base8:function(){return JN}});var H={};__webpack_require__.r(H),__webpack_require__.d(H,{base10:function(){return $N}});var W={};__webpack_require__.r(W),__webpack_require__.d(W,{base16:function(){return eF},base16upper:function(){return tF}});var q={};__webpack_require__.r(q),__webpack_require__.d(q,{base36:function(){return rF},base36upper:function(){return nF}});var V={};__webpack_require__.r(V),__webpack_require__.d(V,{base64:function(){return iF},base64pad:function(){return aF},base64url:function(){return sF},base64urlpad:function(){return oF}});var K={};__webpack_require__.r(K),__webpack_require__.d(K,{base256emoji:function(){return hF}});var Y={};__webpack_require__.r(Y),__webpack_require__.d(Y,{sha256:function(){return vF},sha512:function(){return gF}});var G={};__webpack_require__.r(G),__webpack_require__.d(G,{identity:function(){return mF}});var Q={};__webpack_require__.r(Q),__webpack_require__.d(Q,{code:function(){return _F},decode:function(){return kF},encode:function(){return wF},name:function(){return bF}});var X={};__webpack_require__.r(X),__webpack_require__.d(X,{code:function(){return CF},decode:function(){return DF},encode:function(){return AF},name:function(){return SF}});var J={};__webpack_require__.r(J),__webpack_require__.d(J,{base58btc:function(){return VW},base58flickr:function(){return KW}});var $={};__webpack_require__.r($),__webpack_require__.d($,{base32:function(){return YW},base32hex:function(){return JW},base32hexpad:function(){return eq},base32hexpadupper:function(){return tq},base32hexupper:function(){return $W},base32pad:function(){return QW},base32padupper:function(){return XW},base32upper:function(){return GW},base32z:function(){return rq}});var ee={};__webpack_require__.r(ee),__webpack_require__.d(ee,{base64:function(){return nq},base64pad:function(){return iq},base64url:function(){return aq},base64urlpad:function(){return sq}});var te={};__webpack_require__.r(te),__webpack_require__.d(te,{Decoder:function(){return CV},Encoder:function(){return EV},PacketType:function(){return wV},protocol:function(){return xV}});var re={};__webpack_require__.r(re),__webpack_require__.d(re,{identity:function(){return CK}});var ne={};__webpack_require__.r(ne),__webpack_require__.d(ne,{base2:function(){return AK}});var ie={};__webpack_require__.r(ie),__webpack_require__.d(ie,{base8:function(){return DK}});var ae={};__webpack_require__.r(ae),__webpack_require__.d(ae,{base10:function(){return RK}});var se={};__webpack_require__.r(se),__webpack_require__.d(se,{base16:function(){return TK},base16upper:function(){return ZK}});var oe={};__webpack_require__.r(oe),__webpack_require__.d(oe,{base36:function(){return IK},base36upper:function(){return PK}});var ue={};__webpack_require__.r(ue),__webpack_require__.d(ue,{base256emoji:function(){return OK}});var ce={};__webpack_require__.r(ce),__webpack_require__.d(ce,{sha256:function(){return fY},sha512:function(){return dY}});var le={};__webpack_require__.r(le),__webpack_require__.d(le,{identity:function(){return vY}});var he={};__webpack_require__.r(he),__webpack_require__.d(he,{code:function(){return yY},decode:function(){return bY},encode:function(){return mY},name:function(){return gY}});var fe={};__webpack_require__.r(fe),__webpack_require__.d(fe,{code:function(){return xY},decode:function(){return SY},encode:function(){return EY},name:function(){return kY}});var de=__webpack_require__(2791),pe=__webpack_require__.t(de,2),ve=__webpack_require__(1250),ge=__webpack_require__(7762),ye=__webpack_require__(907);var me=__webpack_require__(181);function be(e){return function(e){if(Array.isArray(e))return(0,ye.Z)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||(0,me.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var _e=__webpack_require__(1413),we=__webpack_require__(4942),ke=__webpack_require__(885);function xe(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}function Ee(){return Ee=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ee.apply(this,arguments)}function Se(e){var t=Object.create(null);return function(r){return void 0===t[r]&&(t[r]=e(r)),t[r]}}var Ce=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,Ae=Se((function(e){return Ce.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91}));var De=function(){function e(e){var t=this;this._insertTag=function(e){var r;r=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,r),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var r=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{r.insertRule(e,r.cssRules.length)}catch(n){0}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){return e.parentNode&&e.parentNode.removeChild(e)})),this.tags=[],this.ctr=0},e}(),Re=Math.abs,Te=String.fromCharCode,Ze=Object.assign;function Ie(e){return e.trim()}function Pe(e,t,r){return e.replace(t,r)}function Le(e,t){return e.indexOf(t)}function Me(e,t){return 0|e.charCodeAt(t)}function Be(e,t,r){return e.slice(t,r)}function Oe(e){return e.length}function Ne(e){return e.length}function Fe(e,t){return t.push(e),e}var Ue=1,ze=1,je=0,He=0,We=0,qe="";function Ve(e,t,r,n,i,a,s){return{value:e,root:t,parent:r,type:n,props:i,children:a,line:Ue,column:ze,length:s,return:""}}function Ke(e,t){return Ze(Ve("",null,null,"",null,null,0),e,{length:-e.length},t)}function Ye(){return We=He>0?Me(qe,--He):0,ze--,10===We&&(ze=1,Ue--),We}function Ge(){return We=He<je?Me(qe,He++):0,ze++,10===We&&(ze=1,Ue++),We}function Qe(){return Me(qe,He)}function Xe(){return He}function Je(e,t){return Be(qe,e,t)}function $e(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function et(e){return Ue=ze=1,je=Oe(qe=e),He=0,[]}function tt(e){return qe="",e}function rt(e){return Ie(Je(He-1,at(91===e?e+2:40===e?e+1:e)))}function nt(e){for(;(We=Qe())&&We<33;)Ge();return $e(e)>2||$e(We)>3?"":" "}function it(e,t){for(;--t&&Ge()&&!(We<48||We>102||We>57&&We<65||We>70&&We<97););return Je(e,Xe()+(t<6&&32==Qe()&&32==Ge()))}function at(e){for(;Ge();)switch(We){case e:return He;case 34:case 39:34!==e&&39!==e&&at(We);break;case 40:41===e&&at(e);break;case 92:Ge()}return He}function st(e,t){for(;Ge()&&e+We!==57&&(e+We!==84||47!==Qe()););return"/*"+Je(t,He-1)+"*"+Te(47===e?e:Ge())}function ot(e){for(;!$e(Qe());)Ge();return Je(e,He)}var ut="-ms-",ct="-moz-",lt="-webkit-",ht="comm",ft="rule",dt="decl",pt="@keyframes";function vt(e,t){for(var r="",n=Ne(e),i=0;i<n;i++)r+=t(e[i],i,e,t)||"";return r}function gt(e,t,r,n){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case dt:return e.return=e.return||e.value;case ht:return"";case pt:return e.return=e.value+"{"+vt(e.children,n)+"}";case ft:e.value=e.props.join(",")}return Oe(r=vt(e.children,n))?e.return=e.value+"{"+r+"}":""}function yt(e){return tt(mt("",null,null,null,[""],e=et(e),0,[0],e))}function mt(e,t,r,n,i,a,s,o,u){for(var c=0,l=0,h=s,f=0,d=0,p=0,v=1,g=1,y=1,m=0,b="",_=i,w=a,k=n,x=b;g;)switch(p=m,m=Ge()){case 40:if(108!=p&&58==Me(x,h-1)){-1!=Le(x+=Pe(rt(m),"&","&\f"),"&\f")&&(y=-1);break}case 34:case 39:case 91:x+=rt(m);break;case 9:case 10:case 13:case 32:x+=nt(p);break;case 92:x+=it(Xe()-1,7);continue;case 47:switch(Qe()){case 42:case 47:Fe(_t(st(Ge(),Xe()),t,r),u);break;default:x+="/"}break;case 123*v:o[c++]=Oe(x)*y;case 125*v:case 59:case 0:switch(m){case 0:case 125:g=0;case 59+l:-1==y&&(x=Pe(x,/\f/g,"")),d>0&&Oe(x)-h&&Fe(d>32?wt(x+";",n,r,h-1):wt(Pe(x," ","")+";",n,r,h-2),u);break;case 59:x+=";";default:if(Fe(k=bt(x,t,r,c,l,i,o,b,_=[],w=[],h),a),123===m)if(0===l)mt(x,t,k,k,_,a,h,o,w);else switch(99===f&&110===Me(x,3)?100:f){case 100:case 108:case 109:case 115:mt(e,k,k,n&&Fe(bt(e,k,k,0,0,i,o,b,i,_=[],h),w),i,w,h,o,n?_:w);break;default:mt(x,k,k,k,[""],w,0,o,w)}}c=l=d=0,v=y=1,b=x="",h=s;break;case 58:h=1+Oe(x),d=p;default:if(v<1)if(123==m)--v;else if(125==m&&0==v++&&125==Ye())continue;switch(x+=Te(m),m*v){case 38:y=l>0?1:(x+="\f",-1);break;case 44:o[c++]=(Oe(x)-1)*y,y=1;break;case 64:45===Qe()&&(x+=rt(Ge())),f=Qe(),l=h=Oe(b=x+=ot(Xe())),m++;break;case 45:45===p&&2==Oe(x)&&(v=0)}}return a}function bt(e,t,r,n,i,a,s,o,u,c,l){for(var h=i-1,f=0===i?a:[""],d=Ne(f),p=0,v=0,g=0;p<n;++p)for(var y=0,m=Be(e,h+1,h=Re(v=s[p])),b=e;y<d;++y)(b=Ie(v>0?f[y]+" "+m:Pe(m,/&\f/g,f[y])))&&(u[g++]=b);return Ve(e,t,r,0===i?ft:o,u,c,l)}function _t(e,t,r){return Ve(e,t,r,ht,Te(We),Be(e,2,-2),0)}function wt(e,t,r,n){return Ve(e,t,r,dt,Be(e,0,n),Be(e,n+1,-1),n)}var kt=function(e,t,r){for(var n=0,i=0;n=i,i=Qe(),38===n&&12===i&&(t[r]=1),!$e(i);)Ge();return Je(e,He)},xt=function(e,t){return tt(function(e,t){var r=-1,n=44;do{switch($e(n)){case 0:38===n&&12===Qe()&&(t[r]=1),e[r]+=kt(He-1,t,r);break;case 2:e[r]+=rt(n);break;case 4:if(44===n){e[++r]=58===Qe()?"&\f":"",t[r]=e[r].length;break}default:e[r]+=Te(n)}}while(n=Ge());return e}(et(e),t))},Et=new WeakMap,St=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,r=e.parent,n=e.column===r.column&&e.line===r.line;"rule"!==r.type;)if(!(r=r.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||Et.get(r))&&!n){Et.set(e,!0);for(var i=[],a=xt(t,i),s=r.props,o=0,u=0;o<a.length;o++)for(var c=0;c<s.length;c++,u++)e.props[u]=i[o]?a[o].replace(/&\f/g,s[c]):s[c]+" "+a[o]}}},Ct=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function At(e,t){switch(function(e,t){return 45^Me(e,0)?(((t<<2^Me(e,0))<<2^Me(e,1))<<2^Me(e,2))<<2^Me(e,3):0}(e,t)){case 5103:return lt+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return lt+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return lt+e+ct+e+ut+e+e;case 6828:case 4268:return lt+e+ut+e+e;case 6165:return lt+e+ut+"flex-"+e+e;case 5187:return lt+e+Pe(e,/(\w+).+(:[^]+)/,lt+"box-$1$2"+ut+"flex-$1$2")+e;case 5443:return lt+e+ut+"flex-item-"+Pe(e,/flex-|-self/,"")+e;case 4675:return lt+e+ut+"flex-line-pack"+Pe(e,/align-content|flex-|-self/,"")+e;case 5548:return lt+e+ut+Pe(e,"shrink","negative")+e;case 5292:return lt+e+ut+Pe(e,"basis","preferred-size")+e;case 6060:return lt+"box-"+Pe(e,"-grow","")+lt+e+ut+Pe(e,"grow","positive")+e;case 4554:return lt+Pe(e,/([^-])(transform)/g,"$1"+lt+"$2")+e;case 6187:return Pe(Pe(Pe(e,/(zoom-|grab)/,lt+"$1"),/(image-set)/,lt+"$1"),e,"")+e;case 5495:case 3959:return Pe(e,/(image-set\([^]*)/,lt+"$1$`$1");case 4968:return Pe(Pe(e,/(.+:)(flex-)?(.*)/,lt+"box-pack:$3"+ut+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+lt+e+e;case 4095:case 3583:case 4068:case 2532:return Pe(e,/(.+)-inline(.+)/,lt+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Oe(e)-1-t>6)switch(Me(e,t+1)){case 109:if(45!==Me(e,t+4))break;case 102:return Pe(e,/(.+:)(.+)-([^]+)/,"$1"+lt+"$2-$3$1"+ct+(108==Me(e,t+3)?"$3":"$2-$3"))+e;case 115:return~Le(e,"stretch")?At(Pe(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==Me(e,t+1))break;case 6444:switch(Me(e,Oe(e)-3-(~Le(e,"!important")&&10))){case 107:return Pe(e,":",":"+lt)+e;case 101:return Pe(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+lt+(45===Me(e,14)?"inline-":"")+"box$3$1"+lt+"$2$3$1"+ut+"$2box$3")+e}break;case 5936:switch(Me(e,t+11)){case 114:return lt+e+ut+Pe(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return lt+e+ut+Pe(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return lt+e+ut+Pe(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return lt+e+ut+e+e}return e}var Dt=[function(e,t,r,n){if(e.length>-1&&!e.return)switch(e.type){case dt:e.return=At(e.value,e.length);break;case pt:return vt([Ke(e,{value:Pe(e.value,"@","@"+lt)})],n);case ft:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return vt([Ke(e,{props:[Pe(t,/:(read-\w+)/,":-moz-$1")]})],n);case"::placeholder":return vt([Ke(e,{props:[Pe(t,/:(plac\w+)/,":"+lt+"input-$1")]}),Ke(e,{props:[Pe(t,/:(plac\w+)/,":-moz-$1")]}),Ke(e,{props:[Pe(t,/:(plac\w+)/,ut+"input-$1")]})],n)}return""}))}}],Rt=function(e){var t=e.key;if("css"===t){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var n=e.stylisPlugins||Dt;var i,a,s={},o=[];i=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),r=1;r<t.length;r++)s[t[r]]=!0;o.push(e)}));var u,c,l=[gt,(c=function(e){u.insert(e)},function(e){e.root||(e=e.return)&&c(e)})],h=function(e){var t=Ne(e);return function(r,n,i,a){for(var s="",o=0;o<t;o++)s+=e[o](r,n,i,a)||"";return s}}([St,Ct].concat(n,l));a=function(e,t,r,n){u=r,vt(yt(e?e+"{"+t.styles+"}":t.styles),h),n&&(f.inserted[t.name]=!0)};var f={key:t,sheet:new De({key:t,container:i,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:s,registered:{},insert:a};return f.sheet.hydrate(o),f};var Tt={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Zt=/[A-Z]|^ms/g,It=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Pt=function(e){return 45===e.charCodeAt(1)},Lt=function(e){return null!=e&&"boolean"!==typeof e},Mt=Se((function(e){return Pt(e)?e:e.replace(Zt,"-$&").toLowerCase()})),Bt=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(It,(function(e,t,r){return Nt={name:t,styles:r,next:Nt},t}))}return 1===Tt[e]||Pt(e)||"number"!==typeof t||0===t?t:t+"px"};function Ot(e,t,r){if(null==r)return"";if(void 0!==r.__emotion_styles)return r;switch(typeof r){case"boolean":return"";case"object":if(1===r.anim)return Nt={name:r.name,styles:r.styles,next:Nt},r.name;if(void 0!==r.styles){var n=r.next;if(void 0!==n)for(;void 0!==n;)Nt={name:n.name,styles:n.styles,next:Nt},n=n.next;return r.styles+";"}return function(e,t,r){var n="";if(Array.isArray(r))for(var i=0;i<r.length;i++)n+=Ot(e,t,r[i])+";";else for(var a in r){var s=r[a];if("object"!==typeof s)null!=t&&void 0!==t[s]?n+=a+"{"+t[s]+"}":Lt(s)&&(n+=Mt(a)+":"+Bt(a,s)+";");else if(!Array.isArray(s)||"string"!==typeof s[0]||null!=t&&void 0!==t[s[0]]){var o=Ot(e,t,s);switch(a){case"animation":case"animationName":n+=Mt(a)+":"+o+";";break;default:n+=a+"{"+o+"}"}}else for(var u=0;u<s.length;u++)Lt(s[u])&&(n+=Mt(a)+":"+Bt(a,s[u])+";")}return n}(e,t,r);case"function":if(void 0!==e){var i=Nt,a=r(e);return Nt=i,Ot(e,t,a)}}if(null==t)return r;var s=t[r];return void 0!==s?s:r}var Nt,Ft=/label:\s*([^\s;\n{]+)\s*(;|$)/g;var Ut=!!pe.useInsertionEffect&&pe.useInsertionEffect,zt=Ut||function(e){return e()},jt=(Ut||de.useLayoutEffect,de.createContext("undefined"!==typeof HTMLElement?Rt({key:"css"}):null));jt.Provider;var Ht=function(e){return(0,de.forwardRef)((function(t,r){var n=(0,de.useContext)(jt);return e(t,n,r)}))};var Wt=de.createContext({});var qt=function(e,t,r){var n=e.key+"-"+t.name;!1===r&&void 0===e.registered[n]&&(e.registered[n]=t.styles)},Vt=Ae,Kt=function(e){return"theme"!==e},Yt=function(e){return"string"===typeof e&&e.charCodeAt(0)>96?Vt:Kt},Gt=function(e,t,r){var n;if(t){var i=t.shouldForwardProp;n=e.__emotion_forwardProp&&i?function(t){return e.__emotion_forwardProp(t)&&i(t)}:i}return"function"!==typeof n&&r&&(n=e.__emotion_forwardProp),n},Qt=function(e){var t=e.cache,r=e.serialized,n=e.isStringTag;return qt(t,r,n),zt((function(){return function(e,t,r){qt(e,t,r);var n=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var i=t;do{e.insert(t===i?"."+n:"",i,e.sheet,!0),i=i.next}while(void 0!==i)}}(t,r,n)})),null},Xt=function e(t,r){var n,i,a=t.__emotion_real===t,s=a&&t.__emotion_base||t;void 0!==r&&(n=r.label,i=r.target);var o=Gt(t,r,a),u=o||Yt(s),c=!u("as");return function(){var l=arguments,h=a&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==n&&h.push("label:"+n+";"),null==l[0]||void 0===l[0].raw)h.push.apply(h,l);else{0,h.push(l[0][0]);for(var f=l.length,d=1;d<f;d++)h.push(l[d],l[0][d])}var p=Ht((function(e,t,r){var n=c&&e.as||s,a="",l=[],f=e;if(null==e.theme){for(var d in f={},e)f[d]=e[d];f.theme=de.useContext(Wt)}"string"===typeof e.className?a=function(e,t,r){var n="";return r.split(" ").forEach((function(r){void 0!==e[r]?t.push(e[r]+";"):n+=r+" "})),n}(t.registered,l,e.className):null!=e.className&&(a=e.className+" ");var p=function(e,t,r){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var n=!0,i="";Nt=void 0;var a=e[0];null==a||void 0===a.raw?(n=!1,i+=Ot(r,t,a)):i+=a[0];for(var s=1;s<e.length;s++)i+=Ot(r,t,e[s]),n&&(i+=a[s]);Ft.lastIndex=0;for(var o,u="";null!==(o=Ft.exec(i));)u+="-"+o[1];var c=function(e){for(var t,r=0,n=0,i=e.length;i>=4;++n,i-=4)t=1540483477*(65535&(t=255&e.charCodeAt(n)|(255&e.charCodeAt(++n))<<8|(255&e.charCodeAt(++n))<<16|(255&e.charCodeAt(++n))<<24))+(59797*(t>>>16)<<16),r=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&r)+(59797*(r>>>16)<<16);switch(i){case 3:r^=(255&e.charCodeAt(n+2))<<16;case 2:r^=(255&e.charCodeAt(n+1))<<8;case 1:r=1540483477*(65535&(r^=255&e.charCodeAt(n)))+(59797*(r>>>16)<<16)}return(((r=1540483477*(65535&(r^=r>>>13))+(59797*(r>>>16)<<16))^r>>>15)>>>0).toString(36)}(i)+u;return{name:c,styles:i,next:Nt}}(h.concat(l),t.registered,f);a+=t.key+"-"+p.name,void 0!==i&&(a+=" "+i);var v=c&&void 0===o?Yt(n):u,g={};for(var y in e)c&&"as"===y||v(y)&&(g[y]=e[y]);return g.className=a,g.ref=r,de.createElement(de.Fragment,null,de.createElement(Qt,{cache:t,serialized:p,isStringTag:"string"===typeof n}),de.createElement(n,g))}));return p.displayName=void 0!==n?n:"Styled("+("string"===typeof s?s:s.displayName||s.name||"Component")+")",p.defaultProps=t.defaultProps,p.__emotion_real=p,p.__emotion_base=s,p.__emotion_styles=h,p.__emotion_forwardProp=o,Object.defineProperty(p,"toString",{value:function(){return"."+i}}),p.withComponent=function(t,n){return e(t,Ee({},r,n,{shouldForwardProp:Gt(p,n,!0)})).apply(void 0,h)},p}}.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){Xt[e]=Xt(e)}));function Jt(e){return null!==e&&"object"===typeof e&&e.constructor===Object}function $t(e){if(!Jt(e))return e;var t={};return Object.keys(e).forEach((function(r){t[r]=$t(e[r])})),t}function er(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0},n=r.clone?Ee({},e):e;return Jt(e)&&Jt(t)&&Object.keys(t).forEach((function(i){"__proto__"!==i&&(Jt(t[i])&&i in e&&Jt(e[i])?n[i]=er(e[i],t[i],r):r.clone?n[i]=Jt(t[i])?$t(t[i]):t[i]:n[i]=t[i])})),n}var tr=["values","unit","step"],rr=function(e){var t=Object.keys(e).map((function(t){return{key:t,val:e[t]}}))||[];return t.sort((function(e,t){return e.val-t.val})),t.reduce((function(e,t){return Ee({},e,(0,we.Z)({},t.key,t.val))}),{})};var nr={borderRadius:4},ir={xs:0,sm:600,md:900,lg:1200,xl:1536},ar={keys:["xs","sm","md","lg","xl"],up:function(e){return"@media (min-width:".concat(ir[e],"px)")}};function sr(e,t,r){var n=e.theme||{};if(Array.isArray(t)){var i=n.breakpoints||ar;return t.reduce((function(e,n,a){return e[i.up(i.keys[a])]=r(t[a]),e}),{})}if("object"===typeof t){var a=n.breakpoints||ar;return Object.keys(t).reduce((function(e,n){if(-1!==Object.keys(a.values||ir).indexOf(n)){e[a.up(n)]=r(t[n],n)}else{var i=n;e[i]=t[i]}return e}),{})}return r(t)}function or(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(null==(e=t.keys)?void 0:e.reduce((function(e,r){return e[t.up(r)]={},e}),{}))||{}}function ur(e,t){return e.reduce((function(e,t){var r=e[t];return(!r||0===Object.keys(r).length)&&delete e[t],e}),t)}function cr(e){for(var t="https://mui.com/production-error/?code="+e,r=1;r<arguments.length;r+=1)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified MUI error #"+e+"; visit "+t+" for the full message."}function lr(e){if("string"!==typeof e)throw new Error(cr(7));return e.charAt(0).toUpperCase()+e.slice(1)}function hr(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t||"string"!==typeof t)return null;if(e&&e.vars&&r){var n="vars.".concat(t).split(".").reduce((function(e,t){return e&&e[t]?e[t]:null}),e);if(null!=n)return n}return t.split(".").reduce((function(e,t){return e&&null!=e[t]?e[t]:null}),e)}function fr(e,t,r){var n,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r;return n="function"===typeof e?e(r):Array.isArray(e)?e[r]||i:hr(e,r)||i,t&&(n=t(n,i,e)),n}var dr=function(e){var t=e.prop,r=e.cssProperty,n=void 0===r?e.prop:r,i=e.themeKey,a=e.transform,s=function(e){if(null==e[t])return null;var r=e[t],s=hr(e.theme,i)||{};return sr(e,r,(function(e){var r=fr(s,a,e);return e===r&&"string"===typeof e&&(r=fr(s,a,"".concat(t).concat("default"===e?"":lr(e)),e)),!1===n?r:(0,we.Z)({},n,r)}))};return s.propTypes={},s.filterProps=[t],s};var pr=function(e,t){return t?er(e,t,{clone:!1}):e};var vr={m:"margin",p:"padding"},gr={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},yr={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},mr=function(e){var t={};return function(r){return void 0===t[r]&&(t[r]=e(r)),t[r]}}((function(e){if(e.length>2){if(!yr[e])return[e];e=yr[e]}var t=e.split(""),r=(0,ke.Z)(t,2),n=r[0],i=r[1],a=vr[n],s=gr[i]||"";return Array.isArray(s)?s.map((function(e){return a+e})):[a+s]})),br=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],_r=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],wr=[].concat(br,_r);function kr(e,t,r,n){var i,a=null!=(i=hr(e,t,!1))?i:r;return"number"===typeof a?function(e){return"string"===typeof e?e:a*e}:Array.isArray(a)?function(e){return"string"===typeof e?e:a[e]}:"function"===typeof a?a:function(){}}function xr(e){return kr(e,"spacing",8)}function Er(e,t){if("string"===typeof t||null==t)return t;var r=e(Math.abs(t));return t>=0?r:"number"===typeof r?-r:"-".concat(r)}function Sr(e,t,r,n){if(-1===t.indexOf(r))return null;var i=function(e,t){return function(r){return e.reduce((function(e,n){return e[n]=Er(t,r),e}),{})}}(mr(r),n);return sr(e,e[r],i)}function Cr(e,t){var r=xr(e.theme);return Object.keys(e).map((function(n){return Sr(e,t,n,r)})).reduce(pr,{})}function Ar(e){return Cr(e,br)}function Dr(e){return Cr(e,_r)}function Rr(e){return Cr(e,wr)}Ar.propTypes={},Ar.filterProps=br,Dr.propTypes={},Dr.filterProps=_r,Rr.propTypes={},Rr.filterProps=wr;var Tr=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.reduce((function(e,t){return t.filterProps.forEach((function(r){e[r]=t})),e}),{}),i=function(e){return Object.keys(e).reduce((function(t,r){return n[r]?pr(t,n[r](e)):t}),{})};return i.propTypes={},i.filterProps=t.reduce((function(e,t){return e.concat(t.filterProps)}),[]),i};function Zr(e){return"number"!==typeof e?e:"".concat(e,"px solid")}var Ir=dr({prop:"border",themeKey:"borders",transform:Zr}),Pr=dr({prop:"borderTop",themeKey:"borders",transform:Zr}),Lr=dr({prop:"borderRight",themeKey:"borders",transform:Zr}),Mr=dr({prop:"borderBottom",themeKey:"borders",transform:Zr}),Br=dr({prop:"borderLeft",themeKey:"borders",transform:Zr}),Or=dr({prop:"borderColor",themeKey:"palette"}),Nr=dr({prop:"borderTopColor",themeKey:"palette"}),Fr=dr({prop:"borderRightColor",themeKey:"palette"}),Ur=dr({prop:"borderBottomColor",themeKey:"palette"}),zr=dr({prop:"borderLeftColor",themeKey:"palette"}),jr=function(e){if(void 0!==e.borderRadius&&null!==e.borderRadius){var t=kr(e.theme,"shape.borderRadius",4);return sr(e,e.borderRadius,(function(e){return{borderRadius:Er(t,e)}}))}return null};jr.propTypes={},jr.filterProps=["borderRadius"];Tr(Ir,Pr,Lr,Mr,Br,Or,Nr,Fr,Ur,zr,jr);var Hr=function(e){if(void 0!==e.gap&&null!==e.gap){var t=kr(e.theme,"spacing",8);return sr(e,e.gap,(function(e){return{gap:Er(t,e)}}))}return null};Hr.propTypes={},Hr.filterProps=["gap"];var Wr=function(e){if(void 0!==e.columnGap&&null!==e.columnGap){var t=kr(e.theme,"spacing",8);return sr(e,e.columnGap,(function(e){return{columnGap:Er(t,e)}}))}return null};Wr.propTypes={},Wr.filterProps=["columnGap"];var qr=function(e){if(void 0!==e.rowGap&&null!==e.rowGap){var t=kr(e.theme,"spacing",8);return sr(e,e.rowGap,(function(e){return{rowGap:Er(t,e)}}))}return null};qr.propTypes={},qr.filterProps=["rowGap"];Tr(Hr,Wr,qr,dr({prop:"gridColumn"}),dr({prop:"gridRow"}),dr({prop:"gridAutoFlow"}),dr({prop:"gridAutoColumns"}),dr({prop:"gridAutoRows"}),dr({prop:"gridTemplateColumns"}),dr({prop:"gridTemplateRows"}),dr({prop:"gridTemplateAreas"}),dr({prop:"gridArea"}));function Vr(e,t){return"grey"===t?t:e}Tr(dr({prop:"color",themeKey:"palette",transform:Vr}),dr({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Vr}),dr({prop:"backgroundColor",themeKey:"palette",transform:Vr}));function Kr(e){return e<=1&&0!==e?"".concat(100*e,"%"):e}var Yr=dr({prop:"width",transform:Kr}),Gr=function(e){if(void 0!==e.maxWidth&&null!==e.maxWidth){return sr(e,e.maxWidth,(function(t){var r,n,i=(null==(r=e.theme)||null==(r=r.breakpoints)||null==(r=r.values)?void 0:r[t])||ir[t];return i?"px"!==(null==(n=e.theme)||null==(n=n.breakpoints)?void 0:n.unit)?{maxWidth:"".concat(i).concat(e.theme.breakpoints.unit)}:{maxWidth:i}:{maxWidth:Kr(t)}}))}return null};Gr.filterProps=["maxWidth"];var Qr=dr({prop:"minWidth",transform:Kr}),Xr=dr({prop:"height",transform:Kr}),Jr=dr({prop:"maxHeight",transform:Kr}),$r=dr({prop:"minHeight",transform:Kr}),en=(dr({prop:"size",cssProperty:"width",transform:Kr}),dr({prop:"size",cssProperty:"height",transform:Kr}),Tr(Yr,Gr,Qr,Xr,Jr,$r,dr({prop:"boxSizing"})),{border:{themeKey:"borders",transform:Zr},borderTop:{themeKey:"borders",transform:Zr},borderRight:{themeKey:"borders",transform:Zr},borderBottom:{themeKey:"borders",transform:Zr},borderLeft:{themeKey:"borders",transform:Zr},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:jr},color:{themeKey:"palette",transform:Vr},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Vr},backgroundColor:{themeKey:"palette",transform:Vr},p:{style:Dr},pt:{style:Dr},pr:{style:Dr},pb:{style:Dr},pl:{style:Dr},px:{style:Dr},py:{style:Dr},padding:{style:Dr},paddingTop:{style:Dr},paddingRight:{style:Dr},paddingBottom:{style:Dr},paddingLeft:{style:Dr},paddingX:{style:Dr},paddingY:{style:Dr},paddingInline:{style:Dr},paddingInlineStart:{style:Dr},paddingInlineEnd:{style:Dr},paddingBlock:{style:Dr},paddingBlockStart:{style:Dr},paddingBlockEnd:{style:Dr},m:{style:Ar},mt:{style:Ar},mr:{style:Ar},mb:{style:Ar},ml:{style:Ar},mx:{style:Ar},my:{style:Ar},margin:{style:Ar},marginTop:{style:Ar},marginRight:{style:Ar},marginBottom:{style:Ar},marginLeft:{style:Ar},marginX:{style:Ar},marginY:{style:Ar},marginInline:{style:Ar},marginInlineStart:{style:Ar},marginInlineEnd:{style:Ar},marginBlock:{style:Ar},marginBlockStart:{style:Ar},marginBlockEnd:{style:Ar},displayPrint:{cssProperty:!1,transform:function(e){return{"@media print":{display:e}}}},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:Hr},rowGap:{style:qr},columnGap:{style:Wr},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Kr},maxWidth:{style:Gr},minWidth:{transform:Kr},height:{transform:Kr},maxHeight:{transform:Kr},minHeight:{transform:Kr},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}}),tn=en;var rn=function(){function e(e,t,r,n){var i,a=(i={},(0,we.Z)(i,e,t),(0,we.Z)(i,"theme",r),i),s=n[e];if(!s)return(0,we.Z)({},e,t);var o=s.cssProperty,u=void 0===o?e:o,c=s.themeKey,l=s.transform,h=s.style;if(null==t)return null;if("typography"===c&&"inherit"===t)return(0,we.Z)({},e,t);var f=hr(r,c)||{};if(h)return h(a);return sr(a,t,(function(t){var r=fr(f,l,t);return t===r&&"string"===typeof t&&(r=fr(f,l,"".concat(e).concat("default"===t?"":lr(t)),t)),!1===u?r:(0,we.Z)({},u,r)}))}return function t(r){var n,i=r||{},a=i.sx,s=i.theme,o=void 0===s?{}:s;if(!a)return null;var u=null!=(n=o.unstable_sxConfig)?n:tn;function c(r){var n=r;if("function"===typeof r)n=r(o);else if("object"!==typeof r)return r;if(!n)return null;var i=or(o.breakpoints),a=Object.keys(i),s=i;return Object.keys(n).forEach((function(r){var i,a,c=(i=n[r],a=o,"function"===typeof i?i(a):i);if(null!==c&&void 0!==c)if("object"===typeof c)if(u[r])s=pr(s,e(r,c,o,u));else{var l=sr({theme:o},c,(function(e){return(0,we.Z)({},r,e)}));!function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.reduce((function(e,t){return e.concat(Object.keys(t))}),[]),i=new Set(n);return t.every((function(e){return i.size===Object.keys(e).length}))}(l,c)?s=pr(s,l):s[r]=t({sx:c,theme:o})}else s=pr(s,e(r,c,o,u))})),ur(a,s)}return Array.isArray(a)?a.map(c):c(a)}}();rn.filterProps=["sx"];var nn=rn,an=["breakpoints","palette","spacing","shape"];var sn=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.breakpoints,r=void 0===t?{}:t,n=e.palette,i=void 0===n?{}:n,a=e.spacing,s=e.shape,o=void 0===s?{}:s,u=xe(e,an),c=function(e){var t=e.values,r=void 0===t?{xs:0,sm:600,md:900,lg:1200,xl:1536}:t,n=e.unit,i=void 0===n?"px":n,a=e.step,s=void 0===a?5:a,o=xe(e,tr),u=rr(r),c=Object.keys(u);function l(e){var t="number"===typeof r[e]?r[e]:e;return"@media (min-width:".concat(t).concat(i,")")}function h(e){var t="number"===typeof r[e]?r[e]:e;return"@media (max-width:".concat(t-s/100).concat(i,")")}function f(e,t){var n=c.indexOf(t);return"@media (min-width:".concat("number"===typeof r[e]?r[e]:e).concat(i,") and ")+"(max-width:".concat((-1!==n&&"number"===typeof r[c[n]]?r[c[n]]:t)-s/100).concat(i,")")}return Ee({keys:c,values:u,up:l,down:h,between:f,only:function(e){return c.indexOf(e)+1<c.length?f(e,c[c.indexOf(e)+1]):l(e)},not:function(e){var t=c.indexOf(e);return 0===t?l(c[1]):t===c.length-1?h(c[t]):f(e,c[c.indexOf(e)+1]).replace("@media","@media not all and")},unit:i},o)}(r),l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(e.mui)return e;var t=xr({spacing:e}),r=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(0===r.length?[1]:r).map((function(e){var r=t(e);return"number"===typeof r?"".concat(r,"px"):r})).join(" ")};return r.mui=!0,r}(a),h=er({breakpoints:c,direction:"ltr",components:{},palette:Ee({mode:"light"},i),spacing:l,shape:Ee({},nr,o)},u),f=arguments.length,d=new Array(f>1?f-1:0),p=1;p<f;p++)d[p-1]=arguments[p];return(h=d.reduce((function(e,t){return er(e,t)}),h)).unstable_sxConfig=Ee({},tn,null==u?void 0:u.unstable_sxConfig),h.unstable_sx=function(e){return nn({sx:e,theme:this})},h},on=["variant"];function un(e){return 0===e.length}function cn(e){var t=e.variant,r=xe(e,on),n=t||"";return Object.keys(r).sort().forEach((function(t){n+="color"===t?un(n)?e[t]:lr(e[t]):"".concat(un(n)?t:lr(t)).concat(lr(e[t].toString()))})),n}var ln=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];var hn=function(e){var t={};return e&&e.forEach((function(e){var r=cn(e.props);t[r]=e.style})),t},fn=function(e,t,r){var n=e.ownerState,i=void 0===n?{}:n,a=[];return r&&r.forEach((function(r){var n=!0;Object.keys(r.props).forEach((function(t){i[t]!==r.props[t]&&e[t]!==r.props[t]&&(n=!1)})),n&&a.push(t[cn(r.props)])})),a};function dn(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}var pn=sn();function vn(e){var t,r=e.defaultTheme,n=e.theme,i=e.themeId;return t=n,0===Object.keys(t).length?r:n[i]||n}var gn=function(e){var t,r=e.styledArg,n=e.props,i=r(Ee({},n,{theme:vn(Ee({},n,{defaultTheme:e.defaultTheme,themeId:e.themeId}))}));if(i&&i.variants&&(t=i.variants,delete i.variants),t){var a=fn(n,hn(t),t);return[i].concat(be(a))}return i};function yn(e,t){var r;return Ee({toolbar:(r={minHeight:56},(0,we.Z)(r,e.up("xs"),{"@media (orientation: landscape)":{minHeight:48}}),(0,we.Z)(r,e.up("sm"),{minHeight:64}),r)},t)}function mn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(t,e),r)}function bn(e){if(e.type)return e;if("#"===e.charAt(0))return bn(function(e){e=e.slice(1);var t=new RegExp(".{1,".concat(e.length>=6?2:1,"}"),"g"),r=e.match(t);return r&&1===r[0].length&&(r=r.map((function(e){return e+e}))),r?"rgb".concat(4===r.length?"a":"","(").concat(r.map((function(e,t){return t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3})).join(", "),")"):""}(e));var t=e.indexOf("("),r=e.substring(0,t);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(r))throw new Error(cr(9,e));var n,i=e.substring(t+1,e.length-1);if("color"===r){if(n=(i=i.split(" ")).shift(),4===i.length&&"/"===i[3].charAt(0)&&(i[3]=i[3].slice(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(n))throw new Error(cr(10,n))}else i=i.split(",");return i=i.map((function(e){return parseFloat(e)})),{type:r,values:i,colorSpace:n}}function _n(e){var t=e.type,r=e.colorSpace,n=e.values;return-1!==t.indexOf("rgb")?n=n.map((function(e,t){return t<3?parseInt(e,10):e})):-1!==t.indexOf("hsl")&&(n[1]="".concat(n[1],"%"),n[2]="".concat(n[2],"%")),n=-1!==t.indexOf("color")?"".concat(r," ").concat(n.join(" ")):"".concat(n.join(", ")),"".concat(t,"(").concat(n,")")}function wn(e){var t="hsl"===(e=bn(e)).type||"hsla"===e.type?bn(function(e){var t=(e=bn(e)).values,r=t[0],n=t[1]/100,i=t[2]/100,a=n*Math.min(i,1-i),s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+r/30)%12;return i-a*Math.max(Math.min(t-3,9-t,1),-1)},o="rgb",u=[Math.round(255*s(0)),Math.round(255*s(8)),Math.round(255*s(4))];return"hsla"===e.type&&(o+="a",u.push(t[3])),_n({type:o,values:u})}(e)).values:e.values;return t=t.map((function(t){return"color"!==e.type&&(t/=255),t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)})),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function kn(e,t){if(e=bn(e),t=mn(t),-1!==e.type.indexOf("hsl"))e.values[2]*=1-t;else if(-1!==e.type.indexOf("rgb")||-1!==e.type.indexOf("color"))for(var r=0;r<3;r+=1)e.values[r]*=1-t;return _n(e)}function xn(e,t){if(e=bn(e),t=mn(t),-1!==e.type.indexOf("hsl"))e.values[2]+=(100-e.values[2])*t;else if(-1!==e.type.indexOf("rgb"))for(var r=0;r<3;r+=1)e.values[r]+=(255-e.values[r])*t;else if(-1!==e.type.indexOf("color"))for(var n=0;n<3;n+=1)e.values[n]+=(1-e.values[n])*t;return _n(e)}var En={black:"#000",white:"#fff"},Sn={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Cn={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},An={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Dn={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},Rn={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Tn={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Zn={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},In=["mode","contrastThreshold","tonalOffset"],Pn={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:En.white,default:En.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},Ln={text:{primary:En.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:En.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function Mn(e,t,r,n){var i=n.light||n,a=n.dark||1.5*n;e[t]||(e.hasOwnProperty(r)?e[t]=e[r]:"light"===t?e.light=xn(e.main,i):"dark"===t&&(e.dark=kn(e.main,a)))}function Bn(e){var t=e.mode,r=void 0===t?"light":t,n=e.contrastThreshold,i=void 0===n?3:n,a=e.tonalOffset,s=void 0===a?.2:a,o=xe(e,In),u=e.primary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:Rn[200],light:Rn[50],dark:Rn[400]}:{main:Rn[700],light:Rn[400],dark:Rn[800]}}(r),c=e.secondary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:Cn[200],light:Cn[50],dark:Cn[400]}:{main:Cn[500],light:Cn[300],dark:Cn[700]}}(r),l=e.error||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:An[500],light:An[300],dark:An[700]}:{main:An[700],light:An[400],dark:An[800]}}(r),h=e.info||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:Tn[400],light:Tn[300],dark:Tn[700]}:{main:Tn[700],light:Tn[500],dark:Tn[900]}}(r),f=e.success||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:Zn[400],light:Zn[300],dark:Zn[700]}:{main:Zn[800],light:Zn[500],dark:Zn[900]}}(r),d=e.warning||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:Dn[400],light:Dn[300],dark:Dn[700]}:{main:"#ed6c02",light:Dn[500],dark:Dn[900]}}(r);function p(e){var t=function(e,t){var r=wn(e),n=wn(t);return(Math.max(r,n)+.05)/(Math.min(r,n)+.05)}(e,Ln.text.primary)>=i?Ln.text.primary:Pn.text.primary;return t}var v=function(e){var t=e.color,r=e.name,n=e.mainShade,i=void 0===n?500:n,a=e.lightShade,o=void 0===a?300:a,u=e.darkShade,c=void 0===u?700:u;if(!(t=Ee({},t)).main&&t[i]&&(t.main=t[i]),!t.hasOwnProperty("main"))throw new Error(cr(11,r?" (".concat(r,")"):"",i));if("string"!==typeof t.main)throw new Error(cr(12,r?" (".concat(r,")"):"",JSON.stringify(t.main)));return Mn(t,"light",o,s),Mn(t,"dark",c,s),t.contrastText||(t.contrastText=p(t.main)),t},g={dark:Ln,light:Pn};return er(Ee({common:Ee({},En),mode:r,primary:v({color:u,name:"primary"}),secondary:v({color:c,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:v({color:l,name:"error"}),warning:v({color:d,name:"warning"}),info:v({color:h,name:"info"}),success:v({color:f,name:"success"}),grey:Sn,contrastThreshold:i,getContrastText:p,augmentColor:v,tonalOffset:s},g[r]),o)}var On=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function Nn(e){return Math.round(1e5*e)/1e5}var Fn={textTransform:"uppercase"},Un='"Roboto", "Helvetica", "Arial", sans-serif';function zn(e,t){var r="function"===typeof t?t(e):t,n=r.fontFamily,i=void 0===n?Un:n,a=r.fontSize,s=void 0===a?14:a,o=r.fontWeightLight,u=void 0===o?300:o,c=r.fontWeightRegular,l=void 0===c?400:c,h=r.fontWeightMedium,f=void 0===h?500:h,d=r.fontWeightBold,p=void 0===d?700:d,v=r.htmlFontSize,g=void 0===v?16:v,y=r.allVariants,m=r.pxToRem,b=xe(r,On);var _=s/14,w=m||function(e){return"".concat(e/g*_,"rem")},k=function(e,t,r,n,a){return Ee({fontFamily:i,fontWeight:e,fontSize:w(t),lineHeight:r},i===Un?{letterSpacing:"".concat(Nn(n/t),"em")}:{},a,y)},x={h1:k(u,96,1.167,-1.5),h2:k(u,60,1.2,-.5),h3:k(l,48,1.167,0),h4:k(l,34,1.235,.25),h5:k(l,24,1.334,0),h6:k(f,20,1.6,.15),subtitle1:k(l,16,1.75,.15),subtitle2:k(f,14,1.57,.1),body1:k(l,16,1.5,.15),body2:k(l,14,1.43,.15),button:k(f,14,1.75,.4,Fn),caption:k(l,12,1.66,.4),overline:k(l,12,2.66,1,Fn),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return er(Ee({htmlFontSize:g,pxToRem:w,fontFamily:i,fontSize:s,fontWeightLight:u,fontWeightRegular:l,fontWeightMedium:f,fontWeightBold:p},x),b,{clone:!1})}function jn(){return["".concat(arguments.length<=0?void 0:arguments[0],"px ").concat(arguments.length<=1?void 0:arguments[1],"px ").concat(arguments.length<=2?void 0:arguments[2],"px ").concat(arguments.length<=3?void 0:arguments[3],"px rgba(0,0,0,").concat(.2,")"),"".concat(arguments.length<=4?void 0:arguments[4],"px ").concat(arguments.length<=5?void 0:arguments[5],"px ").concat(arguments.length<=6?void 0:arguments[6],"px ").concat(arguments.length<=7?void 0:arguments[7],"px rgba(0,0,0,").concat(.14,")"),"".concat(arguments.length<=8?void 0:arguments[8],"px ").concat(arguments.length<=9?void 0:arguments[9],"px ").concat(arguments.length<=10?void 0:arguments[10],"px ").concat(arguments.length<=11?void 0:arguments[11],"px rgba(0,0,0,").concat(.12,")")].join(",")}var Hn=["none",jn(0,2,1,-1,0,1,1,0,0,1,3,0),jn(0,3,1,-2,0,2,2,0,0,1,5,0),jn(0,3,3,-2,0,3,4,0,0,1,8,0),jn(0,2,4,-1,0,4,5,0,0,1,10,0),jn(0,3,5,-1,0,5,8,0,0,1,14,0),jn(0,3,5,-1,0,6,10,0,0,1,18,0),jn(0,4,5,-2,0,7,10,1,0,2,16,1),jn(0,5,5,-3,0,8,10,1,0,3,14,2),jn(0,5,6,-3,0,9,12,1,0,3,16,2),jn(0,6,6,-3,0,10,14,1,0,4,18,3),jn(0,6,7,-4,0,11,15,1,0,4,20,3),jn(0,7,8,-4,0,12,17,2,0,5,22,4),jn(0,7,8,-4,0,13,19,2,0,5,24,4),jn(0,7,9,-4,0,14,21,2,0,5,26,4),jn(0,8,9,-5,0,15,22,2,0,6,28,5),jn(0,8,10,-5,0,16,24,2,0,6,30,5),jn(0,8,11,-5,0,17,26,2,0,6,32,5),jn(0,9,11,-5,0,18,28,2,0,7,34,6),jn(0,9,12,-6,0,19,29,2,0,7,36,6),jn(0,10,13,-6,0,20,31,3,0,8,38,7),jn(0,10,13,-6,0,21,33,3,0,8,40,7),jn(0,10,14,-6,0,22,35,3,0,8,42,7),jn(0,11,14,-7,0,23,36,3,0,9,44,8),jn(0,11,15,-7,0,24,38,3,0,9,46,8)],Wn=["duration","easing","delay"],qn={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},Vn={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function Kn(e){return"".concat(Math.round(e),"ms")}function Yn(e){if(!e)return 0;var t=e/36;return Math.round(10*(4+15*Math.pow(t,.25)+t/5))}function Gn(e){var t=Ee({},qn,e.easing),r=Ee({},Vn,e.duration);return Ee({getAutoHeightDuration:Yn,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.duration,a=void 0===i?r.standard:i,s=n.easing,o=void 0===s?t.easeInOut:s,u=n.delay,c=void 0===u?0:u;xe(n,Wn);return(Array.isArray(e)?e:[e]).map((function(e){return"".concat(e," ").concat("string"===typeof a?a:Kn(a)," ").concat(o," ").concat("string"===typeof c?c:Kn(c))})).join(",")}},e,{easing:t,duration:r})}var Qn={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},Xn=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function Jn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.mixins,r=void 0===t?{}:t,n=e.palette,i=void 0===n?{}:n,a=e.transitions,s=void 0===a?{}:a,o=e.typography,u=void 0===o?{}:o,c=xe(e,Xn);if(e.vars)throw new Error(cr(18));var l=Bn(i),h=sn(e),f=er(h,{mixins:yn(h.breakpoints,r),palette:l,shadows:Hn.slice(),typography:zn(l,u),transitions:Gn(s),zIndex:Ee({},Qn)});f=er(f,c);for(var d=arguments.length,p=new Array(d>1?d-1:0),v=1;v<d;v++)p[v-1]=arguments[v];return(f=p.reduce((function(e,t){return er(e,t)}),f)).unstable_sxConfig=Ee({},tn,null==c?void 0:c.unstable_sxConfig),f.unstable_sx=function(e){return nn({sx:e,theme:this})},f}var $n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.themeId,r=e.defaultTheme,n=void 0===r?pn:r,i=e.rootShouldForwardProp,a=void 0===i?dn:i,s=e.slotShouldForwardProp,o=void 0===s?dn:s,u=function(e){return nn(Ee({},e,{theme:vn(Ee({},e,{defaultTheme:n,themeId:t}))}))};return u.__mui_systemSx=!0,function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}(e,(function(e){return e.filter((function(e){return!(null!=e&&e.__mui_systemSx)}))}));var i,s=r.name,c=r.slot,l=r.skipVariantsResolver,h=r.skipSx,f=r.overridesResolver,d=void 0===f?(i=function(e){return e?e.charAt(0).toLowerCase()+e.slice(1):e}(c),i?function(e,t){return t[i]}:null):f,p=xe(r,ln),v=void 0!==l?l:c&&"Root"!==c&&"root"!==c||!1,g=h||!1;var y=dn;"Root"===c||"root"===c?y=a:c?y=o:function(e){return"string"===typeof e&&e.charCodeAt(0)>96}(e)&&(y=void 0);var m=function(e,t){return Xt(e,t)}(e,Ee({shouldForwardProp:y,label:undefined},p)),b=function(r){for(var i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];var c,l=a?a.map((function(e){if("function"===typeof e&&e.__emotion_real!==e)return function(r){return gn({styledArg:e,props:r,defaultTheme:n,themeId:t})};if(Jt(e)){var r,i=e;return e&&e.variants&&(r=e.variants,delete i.variants,i=function(t){var n=e;return fn(t,hn(r),r).forEach((function(e){n=er(n,e)})),n}),i}return e})):[],h=r;Jt(r)?r&&r.variants&&(c=r.variants,delete h.variants,h=function(e){var t=r;return fn(e,hn(c),c).forEach((function(e){t=er(t,e)})),t}):"function"===typeof r&&r.__emotion_real!==r&&(h=function(e){return gn({styledArg:r,props:e,defaultTheme:n,themeId:t})});s&&d&&l.push((function(e){var r=vn(Ee({},e,{defaultTheme:n,themeId:t})),i=function(e,t){return t.components&&t.components[e]&&t.components[e].styleOverrides?t.components[e].styleOverrides:null}(s,r);if(i){var a={};return Object.entries(i).forEach((function(t){var n=(0,ke.Z)(t,2),i=n[0],s=n[1];a[i]="function"===typeof s?s(Ee({},e,{theme:r})):s})),d(e,a)}return null})),s&&!v&&l.push((function(e){var r=vn(Ee({},e,{defaultTheme:n,themeId:t}));return function(e,t,r,n){var i,a=null==r||null==(i=r.components)||null==(i=i[n])?void 0:i.variants;return fn(e,t,a)}(e,function(e,t){var r=[];return t&&t.components&&t.components[e]&&t.components[e].variants&&(r=t.components[e].variants),hn(r)}(s,r),r,s)})),g||l.push(u);var f=l.length-a.length;if(Array.isArray(r)&&f>0){var p=new Array(f).fill("");(h=[].concat(be(r),be(p))).raw=[].concat(be(r.raw),be(p))}var y=m.apply(void 0,[h].concat(be(l)));return e.muiName&&(y.muiName=e.muiName),y};return m.withConfig&&(b.withConfig=m.withConfig),b}}({themeId:"$$material",defaultTheme:Jn(),rootShouldForwardProp:function(e){return dn(e)&&"classes"!==e}}),ei=$n,ti=__webpack_require__(2699),ri=__webpack_require__(3531),ni=__webpack_require__(3737),ii=__webpack_require__(4165),ai=__webpack_require__(5861),si=__webpack_require__(2426),oi=__webpack_require__.n(si);function ui(e){var t,r,n,i=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);i--;){if(r&&null!=(t=e[r]))return t.call(e);if(n&&null!=(t=e[n]))return new ci(t.call(e));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function ci(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return ci=function(e){this.s=e,this.n=e.next},ci.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var r=this.s.return;return void 0===r?Promise.resolve({value:e,done:!0}):t(r.apply(this.s,arguments))},throw:function(e){var r=this.s.return;return void 0===r?Promise.reject(e):t(r.apply(this.s,arguments))}},new ci(e)}var li=__webpack_require__(8392),hi=__webpack_require__(5671),fi=__webpack_require__(3144);var di=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var a=e.charAt(i),s=a.charCodeAt(0);if(255!==r[s])throw new TypeError(a+" is ambiguous");r[s]=i}var o=e.length,u=e.charAt(0),c=Math.log(o)/Math.log(256),l=Math.log(256)/Math.log(o);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===u;)n++,t++;for(var a=(e.length-t)*c+1>>>0,s=new Uint8Array(a);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var h=0,f=a-1;(0!==l||h<i)&&-1!==f;f--,h++)l+=o*s[f]>>>0,s[f]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var d=a-i;d!==a&&0===s[d];)d++;for(var p=new Uint8Array(n+(a-d)),v=n;d!==a;)p[v++]=s[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,a=t.length;i!==a&&0===t[i];)i++,r++;for(var s=(a-i)*l+1>>>0,c=new Uint8Array(s);i!==a;){for(var h=t[i],f=0,d=s-1;(0!==h||f<n)&&-1!==d;d--,f++)h+=256*c[d]>>>0,c[d]=h%o>>>0,h=h/o>>>0;if(0!==h)throw new Error("Non-zero carry");n=f,i++}for(var p=s-n;p!==s&&0===c[p];)p++;for(var v=u.repeat(r);p<s;++p)v+=e.charAt(c[p]);return v},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error("Non-".concat(t," character"))}}},pi=di,vi=new Uint8Array(0),gi=function(e){var t=e.match(/../g);return t?new Uint8Array(t.map((function(e){return parseInt(e,16)}))):vi},yi=function(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},mi=function(){function e(t,r,n){(0,hi.Z)(this,e),this.name=t,this.prefix=r,this.baseEncode=n}return(0,fi.Z)(e,[{key:"encode",value:function(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}]),e}(),bi=function(){function e(t,r,n){if((0,hi.Z)(this,e),this.name=t,this.prefix=r,void 0===r.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}return(0,fi.Z)(e,[{key:"decode",value:function(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}},{key:"or",value:function(e){return wi(this,e)}}]),e}(),_i=function(){function e(t){(0,hi.Z)(this,e),this.decoders=t}return(0,fi.Z)(e,[{key:"or",value:function(e){return wi(this,e)}},{key:"decode",value:function(e){var t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}]),e}(),wi=function(e,t){return new _i((0,_e.Z)((0,_e.Z)({},e.decoders||(0,we.Z)({},e.prefix,e)),t.decoders||(0,we.Z)({},t.prefix,t)))},ki=function(){function e(t,r,n,i){(0,hi.Z)(this,e),this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new mi(t,r,n),this.decoder=new bi(t,r,i)}return(0,fi.Z)(e,[{key:"encode",value:function(e){return this.encoder.encode(e)}},{key:"decode",value:function(e){return this.decoder.decode(e)}}]),e}(),xi=function(e){var t=e.name,r=e.prefix,n=e.encode,i=e.decode;return new ki(t,r,n,i)},Ei=function(e){var t=e.prefix,r=e.name,n=e.alphabet,i=pi(n,r),a=i.encode,s=i.decode;return xi({prefix:t,name:r,encode:a,decode:function(e){return yi(s(e))}})},Si=function(e){var t=e.name,r=e.prefix,n=e.bitsPerChar,i=e.alphabet;return xi({prefix:r,name:t,encode:function(e){return function(e,t,r){for(var n="="===t[t.length-1],i=(1<<r)-1,a="",s=0,o=0,u=0;u<e.length;++u)for(o=o<<8|e[u],s+=8;s>r;)a+=t[i&o>>(s-=r)];if(s&&(a+=t[i&o<<r-s]),n)for(;a.length*r&7;)a+="=";return a}(e,i,n)},decode:function(e){return function(e,t,r,n){for(var i={},a=0;a<t.length;++a)i[t[a]]=a;for(var s=e.length;"="===e[s-1];)--s;for(var o=new Uint8Array(s*r/8|0),u=0,c=0,l=0,h=0;h<s;++h){var f=i[e[h]];if(void 0===f)throw new SyntaxError("Non-".concat(n," character"));c=c<<r|f,(u+=r)>=8&&(u-=8,o[l++]=255&c>>u)}if(u>=r||255&c<<8-u)throw new SyntaxError("Unexpected end of data");return o}(e,i,n,t)}})},Ci=Si({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ai=Si({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Di=Si({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ri=Si({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ti=Si({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Zi=Si({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ii=Si({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Pi=Si({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Li=Si({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Mi=Ei({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Bi=Ei({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Oi=Si({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Ni=Si({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Fi=Si({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Ui=Si({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function zi(e){var t=function(e){var t=function(){};return t.enabled=!1,t.color="",t.diff=0,t.log=function(){},t.namespace=e,t.destroy=function(){return!0},t.extend=function(){return t},t}("".concat(e,":trace"));return li.enabled("".concat(e,":trace"))&&null!=li.names.map((function(e){return e.toString()})).find((function(e){return e.includes(":trace")}))&&(t=li("".concat(e,":trace"))),Object.assign(li(e),{error:li("".concat(e,":error")),trace:t})}li.formatters.b=function(e){return null==e?"undefined":Mi.baseEncode(e)},li.formatters.t=function(e){return null==e?"undefined":Ci.baseEncode(e)},li.formatters.m=function(e){return null==e?"undefined":Oi.baseEncode(e)},li.formatters.p=function(e){return null==e?"undefined":e.toString()},li.formatters.c=function(e){return null==e?"undefined":e.toString()},li.formatters.k=function(e){return null==e?"undefined":e.toString()},li.formatters.a=function(e){return null==e?"undefined":e.toString()};var ji=__webpack_require__(7963);function Hi(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Open failed"),ji(e,"ERR_OPEN_FAILED")}function Wi(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Close failed"),ji(e,"ERR_CLOSE_FAILED")}function qi(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Put failed"),ji(e,"ERR_PUT_FAILED")}function Vi(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Get failed"),ji(e,"ERR_GET_FAILED")}function Ki(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Delete failed"),ji(e,"ERR_DELETE_FAILED")}function Yi(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Has failed"),ji(e,"ERR_HAS_FAILED")}function Gi(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Not Found"),ji(e,"ERR_NOT_FOUND")}function Qi(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Aborted"),ji(e,"ERR_ABORTED")}function Xi(e,t){this.v=e,this.k=t}function Ji(e){return new Xi(e,0)}function $i(e){var t,r;function n(t,r){try{var a=e[t](r),s=a.value,o=s instanceof Xi;Promise.resolve(o?s.v:s).then((function(r){if(o){var u="return"===t?"return":"next";if(!s.k||r.done)return n(u,r);r=e[u](r).value}i(a.done?"return":"normal",r)}),(function(e){n("throw",e)}))}catch(e){i("throw",e)}}function i(e,i){switch(e){case"return":t.resolve({value:i,done:!0});break;case"throw":t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?n(t.key,t.arg):r=null}this._invoke=function(e,i){return new Promise((function(a,s){var o={key:e,arg:i,resolve:a,reject:s,next:null};r?r=r.next=o:(t=r=o,n(e,i))}))},"function"!=typeof e.return&&(this.return=void 0)}function ea(e){return function(){return new $i(e.apply(this,arguments))}}$i.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},$i.prototype.next=function(e){return this._invoke("next",e)},$i.prototype.throw=function(e){return this._invoke("throw",e)},$i.prototype.return=function(e){return this._invoke("return",e)};var ta=function(){function e(){(0,hi.Z)(this,e)}return(0,fi.Z)(e,[{key:"has",value:function(e,t){return Promise.reject(new Error(".has is not implemented"))}},{key:"put",value:function(e,t,r){return Promise.reject(new Error(".put is not implemented"))}},{key:"putMany",value:function(e,t){var r=this;return ea((0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l,h;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=!1,a=!1,n.prev=2,o=ui(e);case 4:return n.next=6,Ji(o.next());case 6:if(!(i=!(u=n.sent).done)){n.next=15;break}return c=u.value,l=c.cid,h=c.block,n.next=10,Ji(r.put(l,h,t));case 10:return n.next=12,l;case 12:i=!1,n.next=4;break;case 15:n.next=21;break;case 17:n.prev=17,n.t0=n.catch(2),a=!0,s=n.t0;case 21:if(n.prev=21,n.prev=22,!i||null==o.return){n.next=26;break}return n.next=26,Ji(o.return());case 26:if(n.prev=26,!a){n.next=29;break}throw s;case 29:return n.finish(26);case 30:return n.finish(21);case 31:case"end":return n.stop()}}),n,null,[[2,17,21,31],[22,,26,30]])})))()}},{key:"get",value:function(e,t){return Promise.reject(new Error(".get is not implemented"))}},{key:"getMany",value:function(e,t){var r=this;return ea((0,ii.Z)().mark((function n(){var i,a,s,o,u,c;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=!1,a=!1,n.prev=2,o=ui(e);case 4:return n.next=6,Ji(o.next());case 6:if(!(i=!(u=n.sent).done)){n.next=17;break}return c=u.value,n.t0=c,n.next=11,Ji(r.get(c,t));case 11:return n.t1=n.sent,n.next=14,{cid:n.t0,block:n.t1};case 14:i=!1,n.next=4;break;case 17:n.next=23;break;case 19:n.prev=19,n.t2=n.catch(2),a=!0,s=n.t2;case 23:if(n.prev=23,n.prev=24,!i||null==o.return){n.next=28;break}return n.next=28,Ji(o.return());case 28:if(n.prev=28,!a){n.next=31;break}throw s;case 31:return n.finish(28);case 32:return n.finish(23);case 33:case"end":return n.stop()}}),n,null,[[2,19,23,33],[24,,28,32]])})))()}},{key:"delete",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.reject(new Error(".delete is not implemented"));case 2:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"deleteMany",value:function(e,t){var r=this;return ea((0,ii.Z)().mark((function n(){var i,a,s,o,u,c;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=!1,a=!1,n.prev=2,o=ui(e);case 4:return n.next=6,Ji(o.next());case 6:if(!(i=!(u=n.sent).done)){n.next=15;break}return c=u.value,n.next=10,Ji(r.delete(c,t));case 10:return n.next=12,c;case 12:i=!1,n.next=4;break;case 15:n.next=21;break;case 17:n.prev=17,n.t0=n.catch(2),a=!0,s=n.t0;case 21:if(n.prev=21,n.prev=22,!i||null==o.return){n.next=26;break}return n.next=26,Ji(o.return());case 26:if(n.prev=26,!a){n.next=29;break}throw s;case 29:return n.finish(26);case 30:return n.finish(21);case 31:case"end":return n.stop()}}),n,null,[[2,17,21,31],[22,,26,30]])})))()}},{key:"getAll",value:function(e){return ea((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error(".getAll is not implemented");case 1:case"end":return e.stop()}}),e)})))()}}]),e}();function ra(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function na(e,t){return na=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},na(e,t)}function ia(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&na(e,t)}function aa(e){return aa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},aa(e)}function sa(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var oa=__webpack_require__(1002);function ua(e){var t=sa();return function(){var r,n=aa(e);if(t){var i=aa(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===(0,oa.Z)(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ra(e)}(this,r)}}var ca=function e(t,r,n){r=r||[];var i=n=n||0;for(;t>=fa;)r[n++]=255&t|la,t/=128;for(;t&ha;)r[n++]=255&t|la,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},la=128,ha=-128,fa=Math.pow(2,31);var da=function e(t,r){var n,i=0,a=0,s=r=r||0,o=t.length;do{if(s>=o)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],i+=a<28?(n&va)<<a:(n&va)*Math.pow(2,a),a+=7}while(n>=pa);return e.bytes=s-r,i},pa=128,va=127;var ga=Math.pow(2,7),ya=Math.pow(2,14),ma=Math.pow(2,21),ba=Math.pow(2,28),_a=Math.pow(2,35),wa=Math.pow(2,42),ka=Math.pow(2,49),xa=Math.pow(2,56),Ea=Math.pow(2,63),Sa={encode:ca,decode:da,encodingLength:function(e){return e<ga?1:e<ya?2:e<ma?3:e<ba?4:e<_a?5:e<wa?6:e<ka?7:e<xa?8:e<Ea?9:10}},Ca=Sa,Aa=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[Ca.decode(e,t),Ca.decode.bytes]},Da=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Ca.encode(e,t,r),t},Ra=function(e){return Ca.encodingLength(e)},Ta=function(e,t){var r=t.byteLength,n=Ra(e),i=n+Ra(r),a=new Uint8Array(i+r);return Da(e,a,0),Da(r,a,n),a.set(t,i),new Ia(e,r,t,a)},Za=function(e){var t=yi(e),r=Aa(t),n=(0,ke.Z)(r,2),i=n[0],a=n[1],s=Aa(t.subarray(a)),o=(0,ke.Z)(s,2),u=o[0],c=o[1],l=t.subarray(a+c);if(l.byteLength!==u)throw new Error("Incorrect length");return new Ia(i,u,l,t)},Ia=(0,fi.Z)((function e(t,r,n,i){(0,hi.Z)(this,e),this.code=t,this.size=r,this.digest=n,this.bytes=i})),Pa=function(e,t){var r=e.bytes;return 0===e.version?Na(r,Ma(e),t||Mi.encoder):Fa(r,Ma(e),t||Ci.encoder)},La=new WeakMap,Ma=function(e){var t=La.get(e);if(null==t){var r=new Map;return La.set(e,r),r}return t},Ba=function(e,t){function r(e,t,n,i){(0,hi.Z)(this,r),this.code=t,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}return(0,fi.Z)(r,[{key:"asCID",get:function(){return this}},{key:"byteOffset",get:function(){return this.bytes.byteOffset}},{key:"byteLength",get:function(){return this.bytes.byteLength}},{key:"toV0",value:function(){switch(this.version){case 0:return this;case 1:var e=this.code,t=this.multihash;if(e!==Ua)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==za)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return r.createV0(t);default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}},{key:"toV1",value:function(){switch(this.version){case 0:var e=this.multihash,t=e.code,n=e.digest,i=Ta(t,n);return r.createV1(this.code,i);case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}},{key:"equals",value:function(e){return r.equals(this,e)}},{key:"toString",value:function(e){return Pa(this,e)}},{key:"toJSON",value:function(){return{"/":Pa(this)}}},{key:"link",value:function(){return this}},{key:e,get:function(){return"CID"}},{key:t,value:function(){return"CID(".concat(this.toString(),")")}}],[{key:"equals",value:function(e,t){var r=t;return r&&e.code===r.code&&e.version===r.version&&function(e,t){if(e===t)return!0;var r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(var r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}(e.bytes,r.bytes)}(e.multihash,r.multihash)}},{key:"asCID",value:function(e){if(null==e)return null;var t=e;if(t instanceof r)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){var n=t.version,i=t.code,a=t.multihash;return new r(n,i,a,t.bytes||ja(n,i,a.bytes))}if(!0===t[Ha]){var s=t.version,o=t.multihash,u=t.code,c=Za(o);return r.create(s,u,c)}return null}},{key:"create",value:function(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Ua)throw new Error("Version 0 CID must use dag-pb (code: ".concat(Ua,") block encoding"));return new r(e,t,n,n.bytes);case 1:return new r(e,t,n,ja(e,t,n.bytes));default:throw new Error("Invalid version")}}},{key:"createV0",value:function(e){return r.create(0,Ua,e)}},{key:"createV1",value:function(e,t){return r.create(1,e,t)}},{key:"decode",value:function(e){var t=r.decodeFirst(e),n=(0,ke.Z)(t,2),i=n[0];if(n[1].length)throw new Error("Incorrect length");return i}},{key:"decodeFirst",value:function(e){var t=r.inspectBytes(e),n=t.size-t.multihashSize,i=yi(e.subarray(n,n+t.multihashSize));if(i.byteLength!==t.multihashSize)throw new Error("Incorrect length");var a=i.subarray(t.multihashSize-t.digestSize),s=new Ia(t.multihashCode,t.digestSize,a,i);return[0===t.version?r.createV0(s):r.createV1(t.codec,s),e.subarray(t.size)]}},{key:"inspectBytes",value:function(e){var t=0,r=function(){var r=Aa(e.subarray(t)),n=(0,ke.Z)(r,2),i=n[0],a=n[1];return t+=a,i},n=r(),i=Ua;if(18===n?(n=0,t=0):i=r(),0!==n&&1!==n)throw new RangeError("Invalid CID version ".concat(n));var a=t,s=r(),o=r(),u=t+o;return{version:n,codec:i,multihashCode:s,digestSize:o,multihashSize:u-a,size:u}}},{key:"parse",value:function(e,t){var n=Oa(e,t),i=(0,ke.Z)(n,2),a=i[0],s=i[1],o=r.decode(s);if(0===o.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return Ma(o).set(a,e),o}}]),r}(Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom")),Oa=function(e,t){switch(e[0]){case"Q":var r=t||Mi;return[Mi.prefix,r.decode("".concat(Mi.prefix).concat(e))];case Mi.prefix:var n=t||Mi;return[Mi.prefix,n.decode(e)];case Ci.prefix:var i=t||Ci;return[Ci.prefix,i.decode(e)];default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},Na=function(e,t,r){var n=r.prefix;if(n!==Mi.prefix)throw Error("Cannot string encode V0 in ".concat(r.name," encoding"));var i=t.get(n);if(null==i){var a=r.encode(e).slice(1);return t.set(n,a),a}return i},Fa=function(e,t,r){var n=r.prefix,i=t.get(n);if(null==i){var a=r.encode(e);return t.set(n,a),a}return i},Ua=112,za=18,ja=function(e,t,r){var n=Ra(e),i=n+Ra(t),a=new Uint8Array(i+r.byteLength);return Da(e,a,0),Da(t,a,n),a.set(r,i),a},Ha=Symbol.for("@ipld/js-cid/CID"),Wa="raw",qa=85,Va=function(e){return yi(e)},Ka=function(e){return yi(e)},Ya=function(e){ia(r,e);var t=ua(r);function r(){var e;return(0,hi.Z)(this,r),e=t.call(this),(0,we.Z)(ra(e),"data",void 0),e.data=new Map,e}return(0,fi.Z)(r,[{key:"put",value:function(e,t){return this.data.set(Ci.encode(e.multihash.bytes),t),e}},{key:"get",value:function(e){var t=this.data.get(Ci.encode(e.multihash.bytes));if(null==t)throw Gi();return t}},{key:"has",value:function(e){return this.data.has(Ci.encode(e.multihash.bytes))}},{key:"delete",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.data.delete(Ci.encode(t.multihash.bytes));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAll",value:function(){var e=this;return ea((0,ii.Z)().mark((function t(){var r,n,i,a,s;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=(0,ge.Z)(e.data.entries()),t.prev=1,r.s();case 3:if((n=r.n()).done){t.next=9;break}return i=(0,ke.Z)(n.value,2),a=i[0],s=i[1],t.next=7,{cid:Ba.createV1(qa,Za(Ci.decode(a))),block:s};case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),r.e(t.t0);case 14:return t.prev=14,r.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[1,11,14,17]])})))()}}]),r}(ta);var Ga=function(e){var t=null!=e[Symbol.asyncIterator]?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],r=(0,ke.Z)(t,2),n=r[0],i=r[1],a=[];return(0,we.Z)({peek:function(){return n.next()},push:function(e){a.push(e)},next:function(){return a.length>0?{done:!1,value:a.shift()}:n.next()}},i,(function(){return this}))};var Qa=function(e,t){if(null!=e[Symbol.asyncIterator])return ea((0,ii.Z)().mark((function r(){var n,i,a,s,o,u;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=!1,i=!1,r.prev=2,s=ui(e);case 4:return r.next=6,Ji(s.next());case 6:if(!(n=!(o=r.sent).done)){r.next=16;break}return u=o.value,r.next=10,Ji(t(u));case 10:if(!r.sent){r.next=13;break}return r.next=13,u;case 13:n=!1,r.next=4;break;case 16:r.next=22;break;case 18:r.prev=18,r.t0=r.catch(2),i=!0,a=r.t0;case 22:if(r.prev=22,r.prev=23,!n||null==s.return){r.next=27;break}return r.next=27,Ji(s.return());case 27:if(r.prev=27,!i){r.next=30;break}throw a;case 30:return r.finish(27);case 31:return r.finish(22);case 32:case"end":return r.stop()}}),r,null,[[2,18,22,32],[23,,27,31]])})))();var r=Ga(e),n=r.next(),i=n.value;if(!0===n.done)return(0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))();var a=t(i);if("function"===typeof a.then)return ea((0,ii.Z)().mark((function e(){var n,s,o,u,c,l;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ji(a);case 2:if(!e.sent){e.next=5;break}return e.next=5,i;case 5:n=!1,s=!1,e.prev=7,u=ui(r);case 9:return e.next=11,Ji(u.next());case 11:if(!(n=!(c=e.sent).done)){e.next=21;break}return l=c.value,e.next=15,Ji(t(l));case 15:if(!e.sent){e.next=18;break}return e.next=18,l;case 18:n=!1,e.next=9;break;case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(7),s=!0,o=e.t0;case 27:if(e.prev=27,e.prev=28,!n||null==u.return){e.next=32;break}return e.next=32,Ji(u.return());case 32:if(e.prev=32,!s){e.next=35;break}throw o;case 35:return e.finish(32);case 36:return e.finish(27);case 37:case"end":return e.stop()}}),e,null,[[7,23,27,37],[28,,32,36]])})))();var s=t;return(0,ii.Z)().mark((function e(){var t,n,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==a){e.next=3;break}return e.next=3,i;case 3:t=(0,ge.Z)(r),e.prev=4,t.s();case 6:if((n=t.n()).done){e.next=13;break}if(o=n.value,!s(o)){e.next=11;break}return e.next=11,o;case 11:e.next=6;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(4),t.e(e.t0);case 18:return e.prev=18,t.f(),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[4,15,18,21]])}))()};function Xa(e){var t={},r=!1;function n(t,n){return r=!0,n=new Promise((function(r){r(e[t](n))})),{done:!1,value:new Xi(n,1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return r?(r=!1,e):n("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(r)throw r=!1,e;return n("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return r?(r=!1,e):n("return",e)}),t}function Ja(e,t,r,n){var i={configurable:!0,enumerable:!0};return i[e]=n,Object.defineProperty(t,r,i)}function $a(e,t,r){return $a=sa()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&na(i,r.prototype),i},$a.apply(null,arguments)}function es(e){var t="function"===typeof Map?new Map:void 0;return es=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"===typeof e}}(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return $a(e,arguments,aa(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),na(r,e)},es(e)}function ts(){var e={};return e.promise=new Promise((function(t,r){e.resolve=t,e.reject=r})),e}var rs=function(){function e(t){if((0,hi.Z)(this,e),(0,we.Z)(this,"buffer",void 0),(0,we.Z)(this,"mask",void 0),(0,we.Z)(this,"top",void 0),(0,we.Z)(this,"btm",void 0),(0,we.Z)(this,"next",void 0),!(t>0)||0!==(t-1&t))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(t),this.mask=t-1,this.top=0,this.btm=0,this.next=null}return(0,fi.Z)(e,[{key:"push",value:function(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}},{key:"shift",value:function(){var e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}},{key:"isEmpty",value:function(){return void 0===this.buffer[this.btm]}}]),e}(),ns=function(){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,hi.Z)(this,e),(0,we.Z)(this,"size",void 0),(0,we.Z)(this,"hwm",void 0),(0,we.Z)(this,"head",void 0),(0,we.Z)(this,"tail",void 0),this.hwm=null!==(t=r.splitLimit)&&void 0!==t?t:16,this.head=new rs(this.hwm),this.tail=this.head,this.size=0}return(0,fi.Z)(e,[{key:"calculateSize",value:function(e){return null!=(null===e||void 0===e?void 0:e.byteLength)?e.byteLength:1}},{key:"push",value:function(e){if(null!=(null===e||void 0===e?void 0:e.value)&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){var t=this.head;this.head=t.next=new rs(2*this.head.buffer.length),this.head.push(e)}}},{key:"shift",value:function(){var e,t=this.tail.shift();if(void 0===t&&null!=this.tail.next){var r=this.tail.next;this.tail.next=null,this.tail=r,t=this.tail.shift()}return null!=(null===(e=t)||void 0===e?void 0:e.value)&&(this.size-=this.calculateSize(t.value)),t}},{key:"isEmpty",value:function(){return this.head.isEmpty()}}]),e}(),is=function(e){ia(r,e);var t=ua(r);function r(e,n){var i;return(0,hi.Z)(this,r),i=t.call(this,null!==e&&void 0!==e?e:"The operation was aborted"),(0,we.Z)(ra(i),"type",void 0),(0,we.Z)(ra(i),"code",void 0),i.type="aborted",i.code=null!==n&&void 0!==n?n:"ABORT_ERR",i}return(0,fi.Z)(r)}(es(Error));function as(){return ss((function(e){var t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function ss(e,t){var r,n,i,a,s,o,u=(t=null!==(r=t)&&void 0!==r?r:{}).onEnd,c=new ns,l=ts(),h=function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(){return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,c.isEmpty()){t.next=3;break}return t.abrupt("return",e(c));case 3:if(!o){t.next=5;break}return t.abrupt("return",{done:!0});case 5:return t.next=7,new Promise((function(t,r){s=function(n){s=null,c.push(n);try{t(e(c))}catch(i){r(i)}return a}}));case 7:return t.abrupt("return",t.sent);case 8:return t.prev=8,c.isEmpty()&&queueMicrotask((function(){l.resolve(),l=ts()})),t.finish(8);case 11:case"end":return t.stop()}}),t,null,[[0,,8,11]])})));return function(){return t.apply(this,arguments)}}(),f=function(e){return null!=s?s(e):(c.push(e),a)},d=function(e){var r;if(o)return a;if(!0!==(null===(r=t)||void 0===r?void 0:r.objectMode)&&null==(null===e||void 0===e?void 0:e.byteLength))throw new Error("objectMode was not true but tried to push non-Uint8Array value");return f({done:!1,value:e})},p=function(e){return o?a:(o=!0,null!=e?function(e){return c=new ns,null!=s?s({error:e}):(c.push({error:e}),a)}(e):f({done:!0}))};if(n={},(0,we.Z)(n,Symbol.asyncIterator,(function(){return this})),(0,we.Z)(n,"next",h),(0,we.Z)(n,"return",(function(){return c=new ns,p(),{done:!0}})),(0,we.Z)(n,"throw",(function(e){return p(e),{done:!0}})),(0,we.Z)(n,"push",d),(0,we.Z)(n,"end",p),Ja("get",n,"readableLength",(function(){return c.size})),(0,we.Z)(n,"onEmpty",function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(r=null===t||void 0===t?void 0:t.signal)||void 0===r||r.throwIfAborted(),!c.isEmpty()){e.next=4;break}return e.abrupt("return");case 4:return null!=r&&(n=new Promise((function(e,t){i=function(){t(new is)},r.addEventListener("abort",i)}))),e.prev=5,e.next=8,Promise.race([l.promise,n]);case 8:return e.prev=8,null!=i&&null!=r&&(null===r||void 0===r||r.removeEventListener("abort",i)),e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[5,,8,11]])})));return function(t){return e.apply(this,arguments)}}()),a=n,null==u)return a;var v=a;return i={},(0,we.Z)(i,Symbol.asyncIterator,(function(){return this})),(0,we.Z)(i,"next",(function(){return v.next()})),(0,we.Z)(i,"throw",(function(e){return v.throw(e),null!=u&&(u(e),u=void 0),{done:!0}})),(0,we.Z)(i,"return",(function(){return v.return(),null!=u&&(u(),u=void 0),{done:!0}})),(0,we.Z)(i,"push",d),(0,we.Z)(i,"end",(function(e){return v.end(e),null!=u&&(u(e),u=void 0),a})),Ja("get",i,"readableLength",(function(){return v.readableLength})),a=i}var os=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=[],i=0,a=t;i<a.length;i++){var s=a[i];null==s[Symbol.asyncIterator]&&n.push(s)}return n.length===t.length?(0,ii.Z)().mark((function e(){var t,r,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,ge.Z)(n),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=8;break}return i=r.value,e.delegateYield(i,"t0",6);case 6:e.next=3;break;case 8:e.next=13;break;case 10:e.prev=10,e.t1=e.catch(1),t.e(e.t1);case 13:return e.prev=13,t.f(),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[1,10,13,16]])}))():ea((0,ii.Z)().mark((function e(){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=as({objectMode:!0}),Promise.resolve().then((0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all(t.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var n,i,a,s,o,u;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!1,i=!1,e.prev=2,s=ui(t);case 4:return e.next=6,s.next();case 6:if(!(n=!(o=e.sent).done)){e.next=12;break}u=o.value,r.push(u);case 9:n=!1,e.next=4;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(2),i=!0,a=e.t0;case 18:if(e.prev=18,e.prev=19,!n||null==s.return){e.next=23;break}return e.next=23,s.return();case 23:if(e.prev=23,!i){e.next=26;break}throw a;case 26:return e.finish(23);case 27:return e.finish(18);case 28:case"end":return e.stop()}}),e,null,[[2,14,18,28],[19,,23,27]])})));return function(t){return e.apply(this,arguments)}}()));case 3:r.end(),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),r.end(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))),e.delegateYield(Xa(ui(r)),"t0",3);case 3:case"end":return e.stop()}}),e)})))()};zi("blockstore:core:tiered"),(0,_e.Z)({},n);var us=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;return crypto.getRandomValues(new Uint8Array(e)).reduce((function(e,t){return e+=(t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_"}),"")};function cs(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}var ls=Ei({prefix:"9",name:"base10",alphabet:"0123456789"}),hs=Si({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),fs=Si({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),ds=Si({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),ps=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),vs=ps.reduce((function(e,t,r){return e[r]=t,e}),[]),gs=ps.reduce((function(e,t,r){return e[t.codePointAt(0)]=r,e}),[]);var ys=xi({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce((function(e,t){return e+=vs[t]}),"")},decode:function(e){var t,r=[],n=(0,ge.Z)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=gs[i.codePointAt(0)];if(void 0===a)throw new Error("Non-base256emoji character: ".concat(i));r.push(a)}}catch(s){n.e(s)}finally{n.f()}return new Uint8Array(r)}}),ms=Ei({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),bs=Ei({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),_s=Si({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),ws=xi({prefix:"\0",name:"identity",encode:function(e){return t=e,(new TextDecoder).decode(t);var t},decode:function(e){return function(e){return(new TextEncoder).encode(e)}(e)}}),ks=new TextEncoder,xs=new TextDecoder,Es="json",Ss=512,Cs=function(e){return ks.encode(JSON.stringify(e))},As=function(e){return JSON.parse(xs.decode(e))},Ds=yi,Rs={code:0,name:"identity",encode:Ds,digest:function(e){return Ta(0,Ds(e))}},Ts=function(e){var t=e.name,r=e.code,n=e.encode;return new Zs(t,r,n)},Zs=function(){function e(t,r,n){(0,hi.Z)(this,e),this.name=t,this.code=r,this.encode=n}return(0,fi.Z)(e,[{key:"digest",value:function(e){var t=this;if(e instanceof Uint8Array){var r=this.encode(e);return r instanceof Uint8Array?Ta(this.code,r):r.then((function(e){return Ta(t.code,e)}))}throw Error("Unknown type, must be binary type")}}]),e}(),Is=function(e){return function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(r){return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Uint8Array,t.next=3,crypto.subtle.digest(e,r);case 3:return t.t1=t.sent,t.abrupt("return",new t.t0(t.t1));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},Ps=Ts({name:"sha2-256",code:18,encode:Is("SHA-256")}),Ls=Ts({name:"sha2-512",code:19,encode:Is("SHA-512")}),Ms=(0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)({},h),o),l),a),s),e),c),t),r),u);(0,_e.Z)((0,_e.Z)({},p),d);function Bs(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.alloc)?cs(globalThis.Buffer.alloc(t)):new Uint8Array(t)}function Os(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null!=(null===(e=globalThis.Buffer)||void 0===e?void 0:e.allocUnsafe)?cs(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Ns(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var Fs,Us=Ns("utf8","u",(function(e){return"u"+new TextDecoder("utf8").decode(e)}),(function(e){return(new TextEncoder).encode(e.substring(1))})),zs=Ns("ascii","a",(function(e){for(var t="a",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(function(e){for(var t=Os((e=e.substring(1)).length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),js=(0,_e.Z)({utf8:Us,"utf-8":Us,hex:Ms.base16,latin1:zs,ascii:zs,binary:zs},Ms);function Hs(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",r=js[t];if(null==r)throw new Error('Unsupported encoding "'.concat(t,'"'));return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode("".concat(r.prefix).concat(e)):cs(globalThis.Buffer.from(e,"utf-8"))}function Ws(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8",r=js[t];if(null==r)throw new Error('Unsupported encoding "'.concat(t,'"'));return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}var qs="/",Vs=(new TextEncoder).encode(qs),Ks=Vs[0];Fs=Symbol.toStringTag;var Ys=function(){function e(t,r){if((0,hi.Z)(this,e),(0,we.Z)(this,"_buf",void 0),"string"===typeof t)this._buf=Hs(t);else{if(!(t instanceof Uint8Array))throw new Error("Invalid key, should be String of Uint8Array");this._buf=t}if(null==r&&(r=!0),r&&this.clean(),0===this._buf.byteLength||this._buf[0]!==Ks)throw new Error("Invalid key")}return(0,fi.Z)(e,[{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"utf8";return Ws(this._buf,e)}},{key:"uint8Array",value:function(){return this._buf}},{key:Fs,get:function(){return"Key(".concat(this.toString(),")")}},{key:"clean",value:function(){if(null!=this._buf&&0!==this._buf.byteLength||(this._buf=Vs),this._buf[0]!==Ks){var e=new Uint8Array(this._buf.byteLength+1);e.fill(Ks,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===Ks;)this._buf=this._buf.subarray(0,-1)}},{key:"less",value:function(e){for(var t=this.list(),r=e.list(),n=0;n<t.length;n++){if(r.length<n+1)return!1;var i=t[n],a=r[n];if(i<a)return!0;if(i>a)return!1}return t.length<r.length}},{key:"reverse",value:function(){return e.withNamespaces(this.list().slice().reverse())}},{key:"namespaces",value:function(){return this.list()}},{key:"baseNamespace",value:function(){var e=this.namespaces();return e[e.length-1]}},{key:"list",value:function(){return this.toString().split(qs).slice(1)}},{key:"type",value:function(){return function(e){var t=e.split(":");if(t.length<2)return"";return t.slice(0,-1).join(":")}(this.baseNamespace())}},{key:"name",value:function(){return function(e){var t=e.split(":");return t[t.length-1]}(this.baseNamespace())}},{key:"instance",value:function(t){return new e(this.toString()+":"+t)}},{key:"path",value:function(){var t=this.parent().toString();return t.endsWith(qs)||(t+=qs),new e(t+=this.type())}},{key:"parent",value:function(){var t=this.list();return 1===t.length?new e(qs):new e(t.slice(0,-1).join(qs))}},{key:"child",value:function(t){return this.toString()===qs?t:t.toString()===qs?this:new e(this.toString()+t.toString(),!1)}},{key:"isAncestorOf",value:function(e){return e.toString()!==this.toString()&&e.toString().startsWith(this.toString())}},{key:"isDecendantOf",value:function(e){return e.toString()!==this.toString()&&this.toString().startsWith(e.toString())}},{key:"isTopLevel",value:function(){return 1===this.list().length}},{key:"concat",value:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.withNamespaces([].concat(be(this.namespaces()),be(function(e){var t;return(t=[]).concat.apply(t,be(e))}(r.map((function(e){return e.namespaces()}))))))}}],[{key:"withNamespaces",value:function(t){return new e(t.join(qs))}},{key:"random",value:function(){return new e(us().replace(/-/g,""))}},{key:"asKey",value:function(t){return t instanceof Uint8Array||"string"===typeof t?new e(t):"function"===typeof t.uint8Array?new e(t.uint8Array()):null}}]),e}();var Gs="SHARDING";var Qs=function(e){if(null!=e[Symbol.asyncIterator])return(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i,a,s;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=!1,n=!1,t.prev=2,a=ui(e);case 4:return t.next=6,a.next();case 6:if(!(r=!(s=t.sent).done)){t.next=11;break}s.value;case 8:r=!1,t.next=4;break;case 11:t.next=17;break;case 13:t.prev=13,t.t0=t.catch(2),n=!0,i=t.t0;case 17:if(t.prev=17,t.prev=18,!r||null==a.return){t.next=22;break}return t.next=22,a.return();case 22:if(t.prev=22,!n){t.next=25;break}throw i;case 25:return t.finish(22);case 26:return t.finish(17);case 27:case"end":return t.stop()}}),t,null,[[2,13,17,27],[18,,22,26]])})))();var t,r=(0,ge.Z)(e);try{for(r.s();!(t=r.n()).done;)t.value}catch(n){r.e(n)}finally{r.f()}};var Xs=function(e){if(null!=e[Symbol.asyncIterator])return(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i,a,s,o,u;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=[],n=!1,i=!1,t.prev=3,s=ui(e);case 5:return t.next=7,s.next();case 7:if(!(n=!(o=t.sent).done)){t.next=13;break}u=o.value,r.push(u);case 10:n=!1,t.next=5;break;case 13:t.next=19;break;case 15:t.prev=15,t.t0=t.catch(3),i=!0,a=t.t0;case 19:if(t.prev=19,t.prev=20,!n||null==s.return){t.next=24;break}return t.next=24,s.return();case 24:if(t.prev=24,!i){t.next=27;break}throw a;case 27:return t.finish(24);case 28:return t.finish(19);case 29:return t.abrupt("return",r);case 30:case"end":return t.stop()}}),t,null,[[3,15,19,29],[20,,24,28]])})))();var t,r=[],n=(0,ge.Z)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;r.push(i)}}catch(a){n.e(a)}finally{n.f()}return r};var Js=function(e,t){return null!=e[Symbol.asyncIterator]?ea((0,ii.Z)().mark((function r(){var n;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Ji(Xs(e));case 2:return n=r.sent,r.delegateYield(Xa(ui(n.sort(t))),"t0",4);case 4:case"end":return r.stop()}}),r)})))():(0,ii.Z)().mark((function r(){var n;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=Xs(e),r.delegateYield(n.sort(t),"t0",2);case 2:case"end":return r.stop()}}),r)}))()};var $s=function(e,t){return null!=e[Symbol.asyncIterator]?ea((0,ii.Z)().mark((function r(){var n,i,a,s,o,u,c;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=0,!(t<1)){r.next=3;break}return r.abrupt("return");case 3:i=!1,a=!1,r.prev=5,o=ui(e);case 7:return r.next=9,Ji(o.next());case 9:if(!(i=!(u=r.sent).done)){r.next=19;break}return c=u.value,r.next=13,c;case 13:if(++n!==t){r.next=16;break}return r.abrupt("return");case 16:i=!1,r.next=7;break;case 19:r.next=25;break;case 21:r.prev=21,r.t0=r.catch(5),a=!0,s=r.t0;case 25:if(r.prev=25,r.prev=26,!i||null==o.return){r.next=30;break}return r.next=30,Ji(o.return());case 30:if(r.prev=30,!a){r.next=33;break}throw s;case 33:return r.finish(30);case 34:return r.finish(25);case 35:case"end":return r.stop()}}),r,null,[[5,21,25,35],[26,,30,34]])})))():(0,ii.Z)().mark((function r(){var n,i,a,s;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=0,!(t<1)){r.next=3;break}return r.abrupt("return");case 3:i=(0,ge.Z)(e),r.prev=4,i.s();case 6:if((a=i.n()).done){r.next=15;break}return s=a.value,r.next=10,s;case 10:if(++n!==t){r.next=13;break}return r.abrupt("return");case 13:r.next=6;break;case 15:r.next=20;break;case 17:r.prev=17,r.t0=r.catch(4),i.e(r.t0);case 20:return r.prev=20,i.f(),r.finish(20);case 23:case"end":return r.stop()}}),r,null,[[4,17,20,23]])}))()},eo=function(){function e(){(0,hi.Z)(this,e)}return(0,fi.Z)(e,[{key:"put",value:function(e,t,r){return Promise.reject(new Error(".put is not implemented"))}},{key:"get",value:function(e,t){return Promise.reject(new Error(".get is not implemented"))}},{key:"has",value:function(e,t){return Promise.reject(new Error(".has is not implemented"))}},{key:"delete",value:function(e,t){return Promise.reject(new Error(".delete is not implemented"))}},{key:"putMany",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l,h;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=!1,a=!1,n.prev=2,o=ui(e);case 4:return n.next=6,Ji(o.next());case 6:if(!(i=!(u=n.sent).done)){n.next=15;break}return c=u.value,l=c.key,h=c.value,n.next=10,Ji(t.put(l,h,r));case 10:return n.next=12,l;case 12:i=!1,n.next=4;break;case 15:n.next=21;break;case 17:n.prev=17,n.t0=n.catch(2),a=!0,s=n.t0;case 21:if(n.prev=21,n.prev=22,!i||null==o.return){n.next=26;break}return n.next=26,Ji(o.return());case 26:if(n.prev=26,!a){n.next=29;break}throw s;case 29:return n.finish(26);case 30:return n.finish(21);case 31:case"end":return n.stop()}}),n,null,[[2,17,21,31],[22,,26,30]])})))()}},{key:"getMany",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){var i,a,s,o,u,c;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=!1,a=!1,n.prev=2,o=ui(e);case 4:return n.next=6,Ji(o.next());case 6:if(!(i=!(u=n.sent).done)){n.next=17;break}return c=u.value,n.t0=c,n.next=11,Ji(t.get(c,r));case 11:return n.t1=n.sent,n.next=14,{key:n.t0,value:n.t1};case 14:i=!1,n.next=4;break;case 17:n.next=23;break;case 19:n.prev=19,n.t2=n.catch(2),a=!0,s=n.t2;case 23:if(n.prev=23,n.prev=24,!i||null==o.return){n.next=28;break}return n.next=28,Ji(o.return());case 28:if(n.prev=28,!a){n.next=31;break}throw s;case 31:return n.finish(28);case 32:return n.finish(23);case 33:case"end":return n.stop()}}),n,null,[[2,19,23,33],[24,,28,32]])})))()}},{key:"deleteMany",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){var i,a,s,o,u,c;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=!1,a=!1,n.prev=2,o=ui(e);case 4:return n.next=6,Ji(o.next());case 6:if(!(i=!(u=n.sent).done)){n.next=15;break}return c=u.value,n.next=10,Ji(t.delete(c,r));case 10:return n.next=12,c;case 12:i=!1,n.next=4;break;case 15:n.next=21;break;case 17:n.prev=17,n.t0=n.catch(2),a=!0,s=n.t0;case 21:if(n.prev=21,n.prev=22,!i||null==o.return){n.next=26;break}return n.next=26,Ji(o.return());case 26:if(n.prev=26,!a){n.next=29;break}throw s;case 29:return n.finish(26);case 30:return n.finish(21);case 31:case"end":return n.stop()}}),n,null,[[2,17,21,31],[22,,26,30]])})))()}},{key:"batch",value:function(){var e=this,t=[],r=[];return{put:function(e,r){t.push({key:e,value:r})},delete:function(e){r.push(e)},commit:function(){var n=(0,ai.Z)((0,ii.Z)().mark((function n(i){return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Qs(e.putMany(t,i));case 2:return t=[],n.next=5,Qs(e.deleteMany(r,i));case 5:r=[];case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}}},{key:"_all",value:function(e,t){return ea((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("._all is not implemented");case 1:case"end":return e.stop()}}),e)})))()}},{key:"_allKeys",value:function(e,t){return ea((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("._allKeys is not implemented");case 1:case"end":return e.stop()}}),e)})))()}},{key:"query",value:function(e,t){var r=this._all(e,t);if(null!=e.prefix){var n=e.prefix;r=Qa(r,(function(e){return e.key.toString().startsWith(n)}))}if(Array.isArray(e.filters)&&(r=e.filters.reduce((function(e,t){return Qa(e,t)}),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((function(e,t){return Js(e,t)}),r)),null!=e.offset){var i=0,a=e.offset;r=Qa(r,(function(){return i++>=a}))}return null!=e.limit&&(r=$s(r,e.limit)),r}},{key:"queryKeys",value:function(e,t){var r=this._allKeys(e,t);if(null!=e.prefix){var n=e.prefix;r=Qa(r,(function(e){return e.toString().startsWith(n)}))}if(Array.isArray(e.filters)&&(r=e.filters.reduce((function(e,t){return Qa(e,t)}),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((function(e,t){return Js(e,t)}),r)),null!=e.offset){var i=e.offset,a=0;r=Qa(r,(function(){return a++>=i}))}return null!=e.limit&&(r=$s(r,e.limit)),r}}]),e}(),to=function(e){ia(r,e);var t=ua(r);function r(){var e;return(0,hi.Z)(this,r),e=t.call(this),(0,we.Z)(ra(e),"data",void 0),e.data=new Map,e}return(0,fi.Z)(r,[{key:"put",value:function(e,t){return this.data.set(e.toString(),t),e}},{key:"get",value:function(e){var t=this.data.get(e.toString());if(null==t)throw function(e){var t;return e=null!==(t=e)&&void 0!==t?t:new Error("Not Found"),ji(e,"ERR_NOT_FOUND")}();return t}},{key:"has",value:function(e){return this.data.has(e.toString())}},{key:"delete",value:function(e){this.data.delete(e.toString())}},{key:"_all",value:(0,ii.Z)().mark((function e(){var t,r,n,i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,ge.Z)(this.data.entries()),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=9;break}return n=(0,ke.Z)(r.value,2),i=n[0],a=n[1],e.next=7,{key:new Ys(i),value:a};case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"_allKeys",value:(0,ii.Z)().mark((function e(){var t,r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,ge.Z)(this.data.keys()),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=9;break}return n=r.value,e.next=7,new Ys(n);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))}]),r}(eo);var ro=function(e,t){if(null!=e[Symbol.asyncIterator])return ea((0,ii.Z)().mark((function r(){var n,i,a,s,o,u;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=!1,i=!1,r.prev=2,s=ui(e);case 4:return r.next=6,Ji(s.next());case 6:if(!(n=!(o=r.sent).done)){r.next=13;break}return u=o.value,r.next=10,t(u);case 10:n=!1,r.next=4;break;case 13:r.next=19;break;case 15:r.prev=15,r.t0=r.catch(2),i=!0,a=r.t0;case 19:if(r.prev=19,r.prev=20,!n||null==s.return){r.next=24;break}return r.next=24,Ji(s.return());case 24:if(r.prev=24,!i){r.next=27;break}throw a;case 27:return r.finish(24);case 28:return r.finish(19);case 29:case"end":return r.stop()}}),r,null,[[2,15,19,29],[20,,24,28]])})))();var r=Ga(e),n=r.next(),i=n.value;if(!0===n.done)return(0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))();var a=t(i);if("function"===typeof a.then)return ea((0,ii.Z)().mark((function e(){var n,i,s,o,u,c;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ji(a);case 2:return e.next=4,e.sent;case 4:n=!1,i=!1,e.prev=6,o=ui(r);case 8:return e.next=10,Ji(o.next());case 10:if(!(n=!(u=e.sent).done)){e.next=17;break}return c=u.value,e.next=14,t(c);case 14:n=!1,e.next=8;break;case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(6),i=!0,s=e.t0;case 23:if(e.prev=23,e.prev=24,!n||null==o.return){e.next=28;break}return e.next=28,Ji(o.return());case 28:if(e.prev=28,!i){e.next=31;break}throw s;case 31:return e.finish(28);case 32:return e.finish(23);case 33:case"end":return e.stop()}}),e,null,[[6,19,23,33],[24,,28,32]])})))();var s=t;return(0,ii.Z)().mark((function e(){var t,n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a;case 2:t=(0,ge.Z)(r),e.prev=3,t.s();case 5:if((n=t.n()).done){e.next=11;break}return i=n.value,e.next=9,s(i);case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),t.e(e.t0);case 16:return e.prev=16,t.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[3,13,16,19]])}))()};function no(e){if(null==e)throw new Error("Empty pipeline");if(oo(e)){var t=e;e=function(){return t.source}}else if(so(e)||ao(e)){var r=e;e=function(){return r}}for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];var s=[e].concat(i);if(s.length>1&&oo(s[s.length-1])&&(s[s.length-1]=s[s.length-1].sink),s.length>2)for(var o=1;o<s.length-1;o++)oo(s[o])&&(s[o]=uo(s[o]));return io.apply(void 0,be(s))}var io=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(;r.length>0;)e=r.shift()(e);return e},ao=function(e){return null!=(null===e||void 0===e?void 0:e[Symbol.asyncIterator])},so=function(e){return null!=(null===e||void 0===e?void 0:e[Symbol.iterator])},oo=function(e){return null!=e&&(null!=e.sink&&null!=e.source)},uo=function(e){return function(t){var r=e.sink(t);if(null!=(null===r||void 0===r?void 0:r.then)){var n,i=as({objectMode:!0});r.then((function(){i.end()}),(function(e){i.end(e)}));var a=e.source;if(ao(a))n=function(){var e=ea((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(Xa(ui(a)),"t0",1);case 1:i.end();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();else{if(!so(a))throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");n=(0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(a,"t0",1);case 1:i.end();case 2:case"end":return e.stop()}}),e)}))}return os(i,n())}return e.source}};new Ys(Gs),zi("datastore:core:tiered");function co(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lo(e,t,r){co(e,t),t.set(e,r)}function ho(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function fo(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,ho(e,t,"get"))}function po(e,t,r){return function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,ho(e,t,"set"),r),r}function vo(e){var t=new globalThis.AbortController;function r(){t.abort();var n,i=(0,ge.Z)(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;null!=(null===a||void 0===a?void 0:a.removeEventListener)&&a.removeEventListener("abort",r)}}catch(s){i.e(s)}finally{i.f()}}var n,i=(0,ge.Z)(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(!0===(null===a||void 0===a?void 0:a.aborted)){r();break}null!=(null===a||void 0===a?void 0:a.addEventListener)&&a.addEventListener("abort",r)}}catch(o){i.e(o)}finally{i.f()}var s=t.signal;return s.clear=function(){var t,n=(0,ge.Z)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;null!=(null===i||void 0===i?void 0:i.removeEventListener)&&i.removeEventListener("abort",r)}}catch(o){n.e(o)}finally{n.f()}},s}var go=function(e,t){if(null!=e[Symbol.asyncIterator])return ea((0,ii.Z)().mark((function r(){var n,i,a,s,o,u;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=!1,i=!1,r.prev=2,s=ui(e);case 4:return r.next=6,Ji(s.next());case 6:if(!(n=!(o=r.sent).done)){r.next=15;break}return u=o.value,r.next=10,Ji(t(u));case 10:return r.next=12,u;case 12:n=!1,r.next=4;break;case 15:r.next=21;break;case 17:r.prev=17,r.t0=r.catch(2),i=!0,a=r.t0;case 21:if(r.prev=21,r.prev=22,!n||null==s.return){r.next=26;break}return r.next=26,Ji(s.return());case 26:if(r.prev=26,!i){r.next=29;break}throw a;case 29:return r.finish(26);case 30:return r.finish(21);case 31:case"end":return r.stop()}}),r,null,[[2,17,21,31],[22,,26,30]])})))();var r=Ga(e),n=r.next(),i=n.value;if(!0===n.done)return(0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))();var a=t(i);if("function"===typeof(null===a||void 0===a?void 0:a.then))return ea((0,ii.Z)().mark((function e(){var n,a,s,o,u,c;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i;case 2:n=!1,a=!1,e.prev=4,o=ui(r);case 6:return e.next=8,Ji(o.next());case 8:if(!(n=!(u=e.sent).done)){e.next=17;break}return c=u.value,e.next=12,Ji(t(c));case 12:return e.next=14,c;case 14:n=!1,e.next=6;break;case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(4),a=!0,s=e.t0;case 23:if(e.prev=23,e.prev=24,!n||null==o.return){e.next=28;break}return e.next=28,Ji(o.return());case 28:if(e.prev=28,!a){e.next=31;break}throw s;case 31:return e.finish(28);case 32:return e.finish(23);case 33:case"end":return e.stop()}}),e,null,[[4,19,23,33],[24,,28,32]])})))();var s=t;return(0,ii.Z)().mark((function e(){var t,n,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i;case 2:t=(0,ge.Z)(r),e.prev=3,t.s();case 5:if((n=t.n()).done){e.next=12;break}return a=n.value,s(a),e.next=10,a;case 10:e.next=5;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),t.e(e.t0);case 17:return e.prev=17,t.f(),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[3,14,17,20]])}))()};function yo(){return yo="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=aa(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},yo.apply(this,arguments)}var mo=function(e){ia(r,e);var t=ua(r);function r(e){var n;(0,hi.Z)(this,r),n=t.call(this),(0,we.Z)(ra(n),"metric",void 0);var i=e.name,a=e.metrics;return n.metric=a.registerMetric(i),n.updateComponentMetric(),n}return(0,fi.Z)(r,[{key:"set",value:function(e,t){return yo(aa(r.prototype),"set",this).call(this,e,t),this.updateComponentMetric(),this}},{key:"delete",value:function(e){var t=yo(aa(r.prototype),"delete",this).call(this,e);return this.updateComponentMetric(),t}},{key:"clear",value:function(){yo(aa(r.prototype),"clear",this).call(this),this.updateComponentMetric()}},{key:"updateComponentMetric",value:function(){this.metric.update(this.size)}}]),r}(es(Map));function bo(e){var t=e.name,r=e.metrics;return null!=r?new mo({name:t,metrics:r}):new Map}var _o=function(e){ia(r,e);var t=ua(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The operation was aborted";return(0,hi.Z)(this,r),e=t.call(this,n),(0,we.Z)(ra(e),"code",void 0),(0,we.Z)(ra(e),"type",void 0),e.code=r.code,e.type=r.type,e}return(0,fi.Z)(r)}(es(Error));(0,we.Z)(_o,"code","ABORT_ERR"),(0,we.Z)(_o,"type","aborted");var wo=function(e){ia(r,e);var t=ua(r);function r(e,n,i){var a,s;return(0,hi.Z)(this,r),s=t.call(this,e),(0,we.Z)(ra(s),"code",void 0),(0,we.Z)(ra(s),"props",void 0),s.code=n,s.name=null!==(a=null===i||void 0===i?void 0:i.name)&&void 0!==a?a:"CodeError",s.props=null!==i&&void 0!==i?i:{},s}return(0,fi.Z)(r)}(es(Error)),ko=function(e){ia(r,e);var t=ua(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected Peer";return(0,hi.Z)(this,r),e=t.call(this,n),(0,we.Z)(ra(e),"code",void 0),e.code=r.code,e}return(0,fi.Z)(r)}(es(Error));(0,we.Z)(ko,"code","ERR_UNEXPECTED_PEER");var xo=function(e){ia(r,e);var t=ua(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto exchange";return(0,hi.Z)(this,r),e=t.call(this,n),(0,we.Z)(ra(e),"code",void 0),e.code=r.code,e}return(0,fi.Z)(r)}(es(Error));(0,we.Z)(xo,"code","ERR_INVALID_CRYPTO_EXCHANGE");var Eo=function(e){ia(r,e);var t=ua(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto transmission";return(0,hi.Z)(this,r),e=t.call(this,n),(0,we.Z)(ra(e),"code",void 0),e.code=r.code,e}return(0,fi.Z)(r)}(es(Error));(0,we.Z)(Eo,"code","ERR_INVALID_CRYPTO_TRANSMISSION");var So,Co=__webpack_require__(9806);function Ao(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(var r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}So=Symbol.toStringTag;var Do,Ro=function(){function e(t,r,n){(0,hi.Z)(this,e),(0,we.Z)(this,"_refCounter",void 0),(0,we.Z)(this,"cid",void 0),(0,we.Z)(this,"priority",void 0),(0,we.Z)(this,"wantType",void 0),this._refCounter=1,this.cid=t,this.priority=null!==r&&void 0!==r?r:1,this.wantType=n}return(0,fi.Z)(e,[{key:"inc",value:function(){this._refCounter+=1}},{key:"dec",value:function(){this._refCounter=Math.max(0,this._refCounter-1)}},{key:"hasRefs",value:function(){return this._refCounter>0}},{key:So,get:function(){var e=this.cid.toString(Mi);return"WantlistEntry <key: ".concat(e,", priority: ").concat(this.priority,", refs: ").concat(this._refCounter,">")}},{key:"equals",value:function(e){return this._refCounter===e._refCounter&&this.cid.equals(e.cid)&&this.priority===e.priority&&this.wantType===e.wantType}}]),e}();Do=Symbol.toStringTag;var To=function(){function e(t,r,n,i,a){(0,hi.Z)(this,e),(0,we.Z)(this,"entry",void 0),(0,we.Z)(this,"cancel",void 0),(0,we.Z)(this,"sendDontHave",void 0),this.entry=new Ro(t,r,n),this.cancel=Boolean(i),this.sendDontHave=Boolean(a)}return(0,fi.Z)(e,[{key:"cid",get:function(){return this.entry.cid},set:function(e){this.entry.cid=e}},{key:"priority",get:function(){return this.entry.priority},set:function(e){this.entry.priority=e}},{key:"wantType",get:function(){return this.entry.wantType},set:function(e){this.entry.wantType=e}},{key:Do,get:function(){var e=this.cid.toString(Mi);return"BitswapMessageEntry ".concat(e," <cancel: ").concat(this.cancel,", priority: ").concat(this.priority,">")}},{key:"equals",value:function(e){return this.cancel===e.cancel&&this.sendDontHave===e.sendDontHave&&this.wantType===e.wantType&&this.entry.equals(e.entry)}}]),e}(),Zo=function(e,t){var r=["bitswap"];return null!=t&&r.push(t),null!=e&&r.push("".concat(e.toString().slice(0,8))),zi(r.join(":"))},Io=function(e,t){if(e.size!==t.size)return!1;var r,n=(0,ge.Z)(e);try{for(n.s();!(r=n.n()).done;){var i=(0,ke.Z)(r.value,2),a=i[0],s=i[1],o=t.get(a);if(void 0===o)return!1;if(s instanceof Uint8Array&&o instanceof Uint8Array&&!Ao(s,o))return!1;if(s instanceof To&&o instanceof To&&!s.equals(o))return!1}}catch(u){n.e(u)}finally{n.f()}return!0},Po=__webpack_require__(4561);var Lo=function(e){var t,r=new Uint8Array(e.reduce((function(e,t){return e+Po.encodingLength(t)}),0)),n=0,i=(0,ge.Z)(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;r=Po.encode(a,r,n),n+=Po.encodingLength(a)}}catch(s){i.e(s)}finally{i.f()}return r},Mo=__webpack_require__(6216),Bo=__webpack_require__(3557),Oo=__webpack_require__(3097),No=__webpack_require__(7063),Fo=__webpack_require__(2815);Oo._configure(),Mo._configure(Bo),No._configure(Fo);var Uo,zo,jo,Ho,Wo=["uint64","int64","sint64","fixed64","sfixed64"];function qo(e){return function(e){var t,r=(0,ge.Z)(Wo);try{var n=function(){var r=t.value;if(null==e[r])return 1;var n=e[r];e[r]=function(){return BigInt(n.call(this).toString())}};for(r.s();!(t=r.n()).done;)n()}catch(i){r.e(i)}finally{r.f()}return e}(new Mo(e))}function Vo(){return function(e){var t,r=(0,ge.Z)(Wo);try{var n=function(){var r=t.value;if(null==e[r])return 1;var n=e[r];e[r]=function(e){return n.call(this,e.toString())}};for(r.s();!(t=r.n()).done;)n()}catch(i){r.e(i)}finally{r.f()}return e}(No.create())}function Ko(e,t){var r=qo(e instanceof Uint8Array?e:e.subarray());return t.decode(r)}function Yo(e,t){var r=Vo();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}function Go(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function Qo(e){function t(t){if(null==e[t.toString()])throw new Error("Invalid enum value");return e[t]}return Go("enum",Uo.VARINT,(function(e,r){var n=t(e);r.int32(n)}),(function(e){return t(e.int32())}))}function Xo(e,t){return Go("message",Uo.LENGTH_DELIMITED,e,t)}!function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"}(Uo||(Uo={})),function(e){var t,r,n;!function(t){var r,n,i;!function(e){e.Block="Block",e.Have="Have"}(t.WantType||(t.WantType={})),function(e){e[e.Block=0]="Block",e[e.Have=1]="Have"}(n||(n={})),function(e){e.codec=function(){return Qo(n)}}(r=t.WantType||(t.WantType={})),function(t){var i;t.codec=function(){return null==i&&(i=Xo((function(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==i.lengthDelimited&&r.fork(),null!=t.block&&t.block.byteLength>0&&(r.uint32(10),r.bytes(t.block)),null!=t.priority&&0!==t.priority&&(r.uint32(16),r.int32(t.priority)),null!=t.cancel&&!1!==t.cancel&&(r.uint32(24),r.bool(t.cancel)),null!=t.wantType&&0!==n[t.wantType]&&(r.uint32(32),e.Wantlist.WantType.codec().encode(t.wantType,r)),null!=t.sendDontHave&&!1!==t.sendDontHave&&(r.uint32(40),r.bool(t.sendDontHave)),!1!==i.lengthDelimited&&r.ldelim()}),(function(t,n){for(var i={block:new Uint8Array(0),priority:0,cancel:!1,wantType:r.Block,sendDontHave:!1},a=null==n?t.len:t.pos+n;t.pos<a;){var s=t.uint32();switch(s>>>3){case 1:i.block=t.bytes();break;case 2:i.priority=t.int32();break;case 3:i.cancel=t.bool();break;case 4:i.wantType=e.Wantlist.WantType.codec().decode(t);break;case 5:i.sendDontHave=t.bool();break;default:t.skipType(7&s)}}return i}))),i},t.encode=function(e){return Yo(e,t.codec())},t.decode=function(e){return Ko(e,t.codec())}}(t.Entry||(t.Entry={})),t.codec=function(){return null==i&&(i=Xo((function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&r.fork(),null!=t.entries){var i,a=(0,ge.Z)(t.entries);try{for(a.s();!(i=a.n()).done;){var s=i.value;r.uint32(10),e.Wantlist.Entry.codec().encode(s,r)}}catch(o){a.e(o)}finally{a.f()}}null!=t.full&&!1!==t.full&&(r.uint32(16),r.bool(t.full)),!1!==n.lengthDelimited&&r.ldelim()}),(function(t,r){for(var n={entries:[],full:!1},i=null==r?t.len:t.pos+r;t.pos<i;){var a=t.uint32();switch(a>>>3){case 1:n.entries.push(e.Wantlist.Entry.codec().decode(t,t.uint32()));break;case 2:n.full=t.bool();break;default:t.skipType(7&a)}}return n}))),i},t.encode=function(e){return Yo(e,t.codec())},t.decode=function(e){return Ko(e,t.codec())}}(e.Wantlist||(e.Wantlist={})),function(e){var t;e.codec=function(){return null==t&&(t=Xo((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&t.fork(),null!=e.prefix&&e.prefix.byteLength>0&&(t.uint32(10),t.bytes(e.prefix)),null!=e.data&&e.data.byteLength>0&&(t.uint32(18),t.bytes(e.data)),!1!==r.lengthDelimited&&t.ldelim()}),(function(e,t){for(var r={prefix:new Uint8Array(0),data:new Uint8Array(0)},n=null==t?e.len:e.pos+t;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.prefix=e.bytes();break;case 2:r.data=e.bytes();break;default:e.skipType(7&i)}}return r}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(e.Block||(e.Block={})),function(e){e.Have="Have",e.DontHave="DontHave"}(e.BlockPresenceType||(e.BlockPresenceType={})),function(e){e[e.Have=0]="Have",e[e.DontHave=1]="DontHave"}(r||(r={})),function(e){e.codec=function(){return Qo(r)}}(t=e.BlockPresenceType||(e.BlockPresenceType={})),function(n){var i;n.codec=function(){return null==i&&(i=Xo((function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==i.lengthDelimited&&n.fork(),null!=t.cid&&t.cid.byteLength>0&&(n.uint32(10),n.bytes(t.cid)),null!=t.type&&0!==r[t.type]&&(n.uint32(16),e.BlockPresenceType.codec().encode(t.type,n)),!1!==i.lengthDelimited&&n.ldelim()}),(function(r,n){for(var i={cid:new Uint8Array(0),type:t.Have},a=null==n?r.len:r.pos+n;r.pos<a;){var s=r.uint32();switch(s>>>3){case 1:i.cid=r.bytes();break;case 2:i.type=e.BlockPresenceType.codec().decode(r);break;default:r.skipType(7&s)}}return i}))),i},n.encode=function(e){return Yo(e,n.codec())},n.decode=function(e){return Ko(e,n.codec())}}(e.BlockPresence||(e.BlockPresence={})),e.codec=function(){return null==n&&(n=Xo((function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&r.fork(),null!=t.wantlist&&(r.uint32(10),e.Wantlist.codec().encode(t.wantlist,r)),null!=t.blocks){var i,a=(0,ge.Z)(t.blocks);try{for(a.s();!(i=a.n()).done;){var s=i.value;r.uint32(18),r.bytes(s)}}catch(d){a.e(d)}finally{a.f()}}if(null!=t.payload){var o,u=(0,ge.Z)(t.payload);try{for(u.s();!(o=u.n()).done;){var c=o.value;r.uint32(26),e.Block.codec().encode(c,r)}}catch(d){u.e(d)}finally{u.f()}}if(null!=t.blockPresences){var l,h=(0,ge.Z)(t.blockPresences);try{for(h.s();!(l=h.n()).done;){var f=l.value;r.uint32(34),e.BlockPresence.codec().encode(f,r)}}catch(d){h.e(d)}finally{h.f()}}null!=t.pendingBytes&&0!==t.pendingBytes&&(r.uint32(40),r.int32(t.pendingBytes)),!1!==n.lengthDelimited&&r.ldelim()}),(function(t,r){for(var n={blocks:[],payload:[],blockPresences:[],pendingBytes:0},i=null==r?t.len:t.pos+r;t.pos<i;){var a=t.uint32();switch(a>>>3){case 1:n.wantlist=e.Wantlist.codec().decode(t,t.uint32());break;case 2:n.blocks.push(t.bytes());break;case 3:n.payload.push(e.Block.codec().decode(t,t.uint32()));break;case 4:n.blockPresences.push(e.BlockPresence.codec().decode(t,t.uint32()));break;case 5:n.pendingBytes=t.int32();break;default:t.skipType(7&a)}}return n}))),n},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(zo||(zo={})),Ho=Symbol.toStringTag;var Jo=function(){function e(t){(0,hi.Z)(this,e),(0,we.Z)(this,"full",void 0),(0,we.Z)(this,"wantlist",void 0),(0,we.Z)(this,"blocks",void 0),(0,we.Z)(this,"blockPresences",void 0),(0,we.Z)(this,"pendingBytes",void 0),this.full=t,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}return(0,fi.Z)(e,[{key:"empty",get:function(){return 0===this.blocks.size&&0===this.wantlist.size&&0===this.blockPresences.size}},{key:"addEntry",value:function(t,r,n,i,a){null==n&&(n=e.WantType.Block);var s=t.toString(Mi),o=this.wantlist.get(s);null!=o?(o.wantType===n&&(o.priority=r),!0===i&&(o.cancel=Boolean(i)),!0===a&&(o.sendDontHave=Boolean(a)),n===e.WantType.Block&&o.wantType===e.WantType.Have&&(o.wantType=n)):this.wantlist.set(s,new To(t,r,n,i,a))}},{key:"addBlock",value:function(e,t){var r=e.toString(Mi);this.blocks.set(r,t)}},{key:"addHave",value:function(t){var r=t.toString(Mi);this.blockPresences.has(r)||this.blockPresences.set(r,e.BlockPresenceType.Have)}},{key:"addDontHave",value:function(t){var r=t.toString(Mi);this.blockPresences.has(r)||this.blockPresences.set(r,e.BlockPresenceType.DontHave)}},{key:"cancel",value:function(t){var r=t.toString(Mi);this.wantlist.delete(r),this.addEntry(t,0,e.WantType.Block,!0,!1)}},{key:"setPendingBytes",value:function(e){this.pendingBytes=e}},{key:"serializeToBitswap100",value:function(){return zo.encode({wantlist:{entries:Array.from(this.wantlist.values()).map((function(e){return{block:e.cid.bytes,priority:Number(e.priority),cancel:Boolean(e.cancel),wantType:zo.Wantlist.WantType.Block,sendDontHave:!1}})),full:Boolean(this.full)},blocks:Array.from(this.blocks.values())})}},{key:"serializeToBitswap110",value:function(){var e,t={wantlist:{entries:Array.from(this.wantlist.values()).map((function(e){return{block:e.cid.bytes,priority:Number(e.priority),wantType:e.wantType,cancel:Boolean(e.cancel),sendDontHave:Boolean(e.sendDontHave)}})),full:Boolean(this.full)},blockPresences:[],payload:[],pendingBytes:this.pendingBytes,blocks:[]},r=(0,ge.Z)(this.blocks.entries());try{for(r.s();!(e=r.n()).done;){var n=(0,ke.Z)(e.value,2),i=n[0],a=n[1],s=Ba.parse(i),o=s.version,u=s.code,c=s.multihash.code,l=s.multihash.digest.length,h=Lo([o,u,c,l]);t.payload.push({prefix:h,data:a})}}catch(y){r.e(y)}finally{r.f()}var f,d=(0,ge.Z)(this.blockPresences);try{for(d.s();!(f=d.n()).done;){var p=(0,ke.Z)(f.value,2),v=p[0],g=p[1];t.blockPresences.push({cid:Ba.parse(v).bytes,type:g})}}catch(y){d.e(y)}finally{d.f()}return this.pendingBytes>0&&(t.pendingBytes=this.pendingBytes),zo.encode(t)}},{key:"equals",value:function(e){return!!(this.full===e.full&&this.pendingBytes===e.pendingBytes&&Io(this.wantlist,e.wantlist)&&Io(this.blocks,e.blocks)&&Io(this.blockPresences,e.blockPresences))}},{key:Ho,get:function(){var e=Array.from(this.wantlist.keys()),t=Array.from(this.blocks.keys());return"BitswapMessage <full: ".concat(this.full,", list: ").concat(e,", blocks: ").concat(t,">")}}]),e}();jo=Jo,(0,we.Z)(Jo,"Entry",To),(0,we.Z)(Jo,"WantType",{Block:zo.Wantlist.WantType.Block,Have:zo.Wantlist.WantType.Have}),(0,we.Z)(Jo,"BlockPresenceType",{Have:zo.BlockPresenceType.Have,DontHave:zo.BlockPresenceType.DontHave}),(0,we.Z)(Jo,"deserialize",function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=zo.decode(t),s=!0===(null===(n=a.wantlist)||void 0===n?void 0:n.full),o=new jo(s),null===(i=a.wantlist)||void 0===i||i.entries.forEach((function(e){var t;if(null!=e.block){var r=Ba.decode(e.block);o.addEntry(r,null!==(t=e.priority)&&void 0!==t?t:0,e.wantType,Boolean(e.cancel),Boolean(e.sendDontHave))}})),a.blockPresences.forEach((function(e){if(null!=e.cid){var t=Ba.decode(e.cid);e.type===jo.BlockPresenceType.Have?o.addHave(t):o.addDontHave(t)}})),!(a.blocks.length>0)){e.next=9;break}return e.next=8,Promise.all(a.blocks.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ps.digest(t);case 2:r=e.sent,n=Ba.createV0(r),o.addBlock(n,t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 8:case 14:return e.abrupt("return",o);case 9:if(!(a.payload.length>0)){e.next=14;break}return e.next=12,Promise.all(a.payload.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var n,i,a,s,u,c,l;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.prefix&&null!=t.data){e.next=2;break}return e.abrupt("return");case 2:if(n=Co(t.prefix),i=n[0],a=n[1],(s=n[2])!==Ps.code){e.next=10;break}e.t0=Ps,e.next=13;break;case 10:return e.next=12,null===r||void 0===r?void 0:r.getHasher(s);case 12:e.t0=e.sent;case 13:if(null!=(u=e.t0)){e.next=16;break}throw new wo("Unknown hash algorithm","ERR_UNKNOWN_HASH_ALG");case 16:return e.next=18,u.digest(t.data);case 18:c=e.sent,l=Ba.create(i,a,c),o.addBlock(l,t.data);case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 12:return o.setPendingBytes(a.pendingBytes),e.abrupt("return",o);case 15:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),(0,we.Z)(Jo,"blockPresenceSize",(function(e){return e.bytes.length+1}));var $o=zo.Wantlist.WantType.Block,eu=zo.Wantlist.WantType.Have,tu=function(){function e(t,r){(0,hi.Z)(this,e),(0,we.Z)(this,"set",void 0),(0,we.Z)(this,"_stats",void 0),this.set=null!=r?bo({name:"ipfs_bitswap_wantlist",metrics:r.metrics}):new Map,this._stats=t}return(0,fi.Z)(e,[{key:"length",get:function(){return this.set.size}},{key:"add",value:function(e,t,r){var n=e.toString(Mi),i=this.set.get(n);null!=i?(i.inc(),i.priority=t,i.wantType===eu&&r===$o&&(i.wantType=r)):(this.set.set(n,new Ro(e,t,r)),null!=this._stats&&this._stats.push(void 0,"wantListSize",1))}},{key:"remove",value:function(e){var t=e.toString(Mi),r=this.set.get(t);null!=r&&(r.dec(),r.hasRefs()||(this.set.delete(t),null!=this._stats&&this._stats.push(void 0,"wantListSize",-1)))}},{key:"removeForce",value:function(e){this.set.has(e)&&this.set.delete(e)}},{key:"forEach",value:function(e){this.set.forEach(e)}},{key:"entries",value:function(){return this.set.entries()}},{key:"sortedEntries",value:function(){return new Map((e=function(e){return e[1].key},t=Array.from(this.set.entries()),Array.prototype.slice.call(t,0).sort((function(t,r){var n=e(t),i=e(r);return n<i?-1:n>i?1:0}))));var e,t}},{key:"contains",value:function(e){var t=e.toString(Mi);return this.set.has(t)}},{key:"get",value:function(e){var t=e.toString(Mi);return this.set.get(t)}}]),e}();(0,we.Z)(tu,"Entry",Ro);var ru,nu=function(){function e(t){(0,hi.Z)(this,e),(0,we.Z)(this,"partner",void 0),(0,we.Z)(this,"wantlist",void 0),(0,we.Z)(this,"exchangeCount",void 0),(0,we.Z)(this,"accounting",void 0),(0,we.Z)(this,"lastExchange",void 0),this.partner=t,this.wantlist=new tu,this.exchangeCount=0,this.accounting={bytesSent:0,bytesRecv:0}}return(0,fi.Z)(e,[{key:"sentBytes",value:function(e){this.exchangeCount++,this.lastExchange=(new Date).getTime(),this.accounting.bytesSent+=e}},{key:"receivedBytes",value:function(e){this.exchangeCount++,this.lastExchange=(new Date).getTime(),this.accounting.bytesRecv+=e}},{key:"wants",value:function(e,t,r){this.wantlist.add(e,t,r)}},{key:"cancelWant",value:function(e){this.wantlist.remove(e)}},{key:"wantlistContains",value:function(e){return this.wantlist.get(e)}},{key:"debtRatio",value:function(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}}]),e}();ru=Symbol.iterator;var iu=function(e){ia(r,e);var t=ua(r);function r(e,n){var i;(0,hi.Z)(this,r),i=t.call(this),(0,we.Z)(ra(i),"_cmp",void 0),(0,we.Z)(ra(i),"_keys",void 0),i._cmp=null!==n&&void 0!==n?n:i._defaultSort,i._keys=[];var a,s=(0,ge.Z)(null!==e&&void 0!==e?e:[]);try{for(s.s();!(a=s.n()).done;){var o=(0,ke.Z)(a.value,2),u=o[0],c=o[1];i.set(u,c)}}catch(l){s.e(l)}finally{s.f()}return i}return(0,fi.Z)(r,[{key:"update",value:function(e){if(!(e<0||e>=this._keys.length)){var t=this._keys[e];this._keys.splice(e,1);var r=this._find(t);this._keys.splice(r,0,t)}}},{key:"set",value:function(e,t){if(this.has(e)){var n=this.indexOf(e);this._keys.splice(n,1)}yo(aa(r.prototype),"set",this).call(this,e,t);var i=this._find(e);return this._keys.splice(i,0,e),this}},{key:"clear",value:function(){yo(aa(r.prototype),"clear",this).call(this),this._keys=[]}},{key:"delete",value:function(e){if(!this.has(e))return!1;var t=this.indexOf(e);return this._keys.splice(t,1),yo(aa(r.prototype),"delete",this).call(this,e)}},{key:"indexOf",value:function(e){if(!this.has(e))return-1;var t=this._find(e);if(this._keys[t]===e)return t;for(var r=1;r<this._keys.length;r++){if(this._keys[t+r]===e)return t+r;if(this._keys[t-r]===e)return t-r}return-1}},{key:"_find",value:function(e){for(var t=0,r=this._keys.length;t<r;){var n=t+r>>>1,i=this._kCmp(this._keys[n],e);if(i<0)t=n+1;else{if(!(i>0))return n;r=n}}return t}},{key:"keys",value:(0,ii.Z)().mark((function e(){var t,r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,ge.Z)(this._keys),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=9;break}return n=r.value,e.next=7,n;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:return e.abrupt("return",void 0);case 18:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"values",value:(0,ii.Z)().mark((function e(){var t,r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,ge.Z)(this._keys),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=9;break}return n=r.value,e.next=7,this.get(n);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:return e.abrupt("return",void 0);case 18:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"entries",value:(0,ii.Z)().mark((function e(){var t,r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,ge.Z)(this._keys),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=9;break}return n=r.value,e.next=7,[n,this.get(n)];case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:return e.abrupt("return",void 0);case 18:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:ru,value:(0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.entries(),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"forEach",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;if(null!=e){var r,n=(0,ge.Z)(this._keys);try{for(n.s();!(r=n.n()).done;){var i=r.value,a=this.get(i);if(null==a)throw new Error("Value cannot be undefined");e.apply(t,[[i,a]])}}catch(s){n.e(s)}finally{n.f()}}}},{key:"_defaultSort",value:function(e,t){return e[0]<t[0]?-1:t[0]<e[0]?1:0}},{key:"_kCmp",value:function(e,t){return this._cmp([e,this.get(e)],[t,this.get(t)])}}]),r}(es(Map)),au={hasNewInfo:function(){return!1},merge:function(){}},su=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:au;(0,hi.Z)(this,e),(0,we.Z)(this,"_taskMerger",void 0),(0,we.Z)(this,"_byPeer",void 0),this._taskMerger=t,this._byPeer=new iu([],ou.compare)}return(0,fi.Z)(e,[{key:"pushTasks",value:function(e,t){var r=this._byPeer.get(e.toString());null==r&&(r=new ou(e,this._taskMerger)),r.pushTasks(t),this._byPeer.set(e.toString(),r)}},{key:"popTasks",value:function(e){var t=this._head();if(void 0===t)return{tasks:[],pendingSize:0};var r=t.popTasks(e),n=r.tasks,i=r.pendingSize;if(0===n.length)return{tasks:n,pendingSize:i};var a=t.peerId;return t.isIdle()?this._byPeer.delete(a.toString()):this._byPeer.update(0),{peerId:a,tasks:n,pendingSize:i}}},{key:"_head",value:function(){if(0!==this._byPeer.size){var e,t=(0,ge.Z)(this._byPeer);try{for(t.s();!(e=t.n()).done;){return(0,ke.Z)(e.value,2)[1]}}catch(r){t.e(r)}finally{t.f()}}}},{key:"remove",value:function(e,t){var r=this._byPeer.get(t.toString());null===r||void 0===r||r.remove(e)}},{key:"tasksDone",value:function(e,t){var r=this._byPeer.get(e.toString());if(null!=r){var n,i=this._byPeer.indexOf(e.toString()),a=(0,ge.Z)(t);try{for(a.s();!(n=a.n()).done;){var s=n.value;r.taskDone(s)}}catch(o){a.e(o)}finally{a.f()}this._byPeer.update(i)}}}]),e}(),ou=function(){function e(t,r){(0,hi.Z)(this,e),(0,we.Z)(this,"peerId",void 0),(0,we.Z)(this,"_taskMerger",void 0),(0,we.Z)(this,"_activeTotalSize",void 0),(0,we.Z)(this,"_pending",void 0),(0,we.Z)(this,"_active",void 0),this.peerId=t,this._taskMerger=r,this._activeTotalSize=0,this._pending=new uu,this._active=new Set}return(0,fi.Z)(e,[{key:"pushTasks",value:function(e){var t,r=(0,ge.Z)(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;this._pushTask(n)}}catch(i){r.e(i)}finally{r.f()}}},{key:"_pushTask",value:function(e){if(this._taskHasMoreInfoThanActiveTasks(e)){var t=this._pending.get(e.topic);if(null!=t)return e.priority>t.priority&&this._pending.updatePriority(e.topic,e.priority),void this._taskMerger.merge(e,t);this._pending.add(e)}}},{key:"_taskHasMoreInfoThanActiveTasks",value:function(e){var t,r=[],n=(0,ge.Z)(this._active);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.topic===e.topic&&r.push(i)}}catch(a){n.e(a)}finally{n.f()}return 0===r.length||this._taskMerger.hasNewInfo(e,r)}},{key:"popTasks",value:function(e){for(var t=0,r=[],n=this._pending.tasks(),i=0;i<n.length&&t<e;i++){var a=n[i];r.push(a),t+=a.size,this._pending.delete(a.topic),this._activeTotalSize+=a.size,this._active.add(a)}return{tasks:r,pendingSize:this._pending.totalSize}}},{key:"taskDone",value:function(e){this._active.has(e)&&(this._activeTotalSize-=e.size,this._active.delete(e))}},{key:"remove",value:function(e){this._pending.delete(e)}},{key:"isIdle",value:function(){return 0===this._pending.length&&0===this._active.size}}],[{key:"compare",value:function(e,t){return 0===e[1]._pending.length?1:0===t[1]._pending.length?-1:e[1]._activeTotalSize===t[1]._activeTotalSize?t[1]._pending.length-e[1]._pending.length:e[1]._activeTotalSize-t[1]._activeTotalSize}}]),e}(),uu=function(){function e(){(0,hi.Z)(this,e),(0,we.Z)(this,"_tasks",void 0),this._tasks=new iu([],this._compare)}return(0,fi.Z)(e,[{key:"length",get:function(){return this._tasks.size}},{key:"totalSize",get:function(){return be(this._tasks.values()).reduce((function(e,t){return e+t.task.size}),0)}},{key:"get",value:function(e){var t;return null===(t=this._tasks)||void 0===t||null===(t=t.get(e))||void 0===t?void 0:t.task}},{key:"add",value:function(e){this._tasks.set(e.topic,{created:Date.now(),task:e})}},{key:"delete",value:function(e){this._tasks.delete(e)}},{key:"tasks",value:function(){return be(this._tasks.values()).map((function(e){return e.task}))}},{key:"updatePriority",value:function(e,t){var r=this._tasks.get(e);if(null!=r){var n=this._tasks.indexOf(e);r.task.priority=t,this._tasks.update(n)}}},{key:"_compare",value:function(e,t){return e[1].task.priority===t[1].task.priority?e[1].created-t[1].created:t[1].task.priority-e[1].task.priority}}]),e}(),cu={hasNewInfo:function(e,t){var r,n=!1,i=!1,a=(0,ge.Z)(t);try{for(a.s();!(r=a.n()).done;){var s=r.value;s.data.haveBlock&&(n=!0),s.data.isWantBlock&&(i=!0)}}catch(o){a.e(o)}finally{a.f()}return!(i||!e.data.isWantBlock)||!(n||!e.data.haveBlock)},merge:function(e,t){var r=e.data,n=t.data;!n.haveBlock&&r.haveBlock&&(n.haveBlock=r.haveBlock,n.blockSize=r.blockSize),!n.isWantBlock&&r.isWantBlock&&(n.isWantBlock=!0,n.haveBlock&&!r.haveBlock||(n.haveBlock=r.haveBlock,t.size=e.size)),n.isWantBlock&&n.haveBlock&&(t.size=n.blockSize)}},lu=Jo.WantType,hu=function(){function e(t,r,n,i,a){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};(0,hi.Z)(this,e),(0,we.Z)(this,"_log",void 0),(0,we.Z)(this,"blockstore",void 0),(0,we.Z)(this,"network",void 0),(0,we.Z)(this,"_stats",void 0),(0,we.Z)(this,"_opts",void 0),(0,we.Z)(this,"ledgerMap",void 0),(0,we.Z)(this,"_running",void 0),(0,we.Z)(this,"_requestQueue",void 0),this._log=Zo(t,"engine"),this.blockstore=r,this.network=n,this._stats=i,this._opts=this._processOpts(s),this.ledgerMap=bo({name:"ipfs_bitswap_ledger_map",metrics:a.metrics}),this._running=!1,this._requestQueue=new su(cu)}return(0,fi.Z)(e,[{key:"_processOpts",value:function(e){return(0,_e.Z)({maxSizeReplaceHasWithBlock:1024,targetMessageSize:16384},e)}},{key:"_scheduleProcessTasks",value:function(){var e=this;setTimeout((function(){e._processTasks().catch((function(t){e._log.error("error processing stats",t)}))}))}},{key:"_processTasks",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i,a,s,o,u,c,l,h,f,d,p,v,g,y,m,b,_,w,k,x,E;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._running){e.next=2;break}return e.abrupt("return");case 2:if(t=this._requestQueue.popTasks(this._opts.targetMessageSize),r=t.peerId,n=t.tasks,i=t.pendingSize,0!==n.length){e.next=5;break}return e.abrupt("return");case 5:(a=new Jo(!1)).setPendingBytes(i),s=[],o=new Map,u=(0,ge.Z)(n);try{for(u.s();!(c=u.n()).done;)l=c.value,h=Ba.parse(l.topic),l.data.haveBlock?l.data.isWantBlock?(s.push(h),o.set(l.topic,l.data)):a.addHave(h):a.addDontHave(h)}catch(S){u.e(S)}finally{u.f()}return e.next=13,this._getBlocks(s);case 13:f=e.sent,d=(0,ge.Z)(o);try{for(d.s();!(p=d.n()).done;)v=(0,ke.Z)(p.value,2),g=v[0],y=v[1],m=Ba.parse(g),null!=(b=f.get(g))?a.addBlock(m,b):y.sendDontHave&&a.addDontHave(m)}catch(S){d.e(S)}finally{d.f()}if(!a.empty){e.next=20;break}return null!=r&&this._requestQueue.tasksDone(r,n),this._scheduleProcessTasks(),e.abrupt("return");case 20:if(e.prev=20,e.t0=null!=r,!e.t0){e.next=25;break}return e.next=25,this.network.sendMessage(r,a);case 25:_=(0,ge.Z)(f.entries());try{for(_.s();!(w=_.n()).done;)k=(0,ke.Z)(w.value,2),x=k[0],E=k[1],null!=r&&this.messageSent(r,Ba.parse(x),E)}catch(S){_.e(S)}finally{_.f()}e.next=32;break;case 29:e.prev=29,e.t1=e.catch(20),this._log.error(e.t1);case 32:null!=r&&this._requestQueue.tasksDone(r,n),this._scheduleProcessTasks();case 34:case"end":return e.stop()}}),e,this,[[20,29]])})));return function(){return e.apply(this,arguments)}}()},{key:"wantlistForPeer",value:function(e){var t=e.toString(),r=this.ledgerMap.get(t);return null!=r?r.wantlist.sortedEntries():new Map}},{key:"ledgerForPeer",value:function(e){var t=e.toString(),r=this.ledgerMap.get(t);if(null!=r)return{peer:r.partner,value:r.debtRatio(),sent:r.accounting.bytesSent,recv:r.accounting.bytesRecv,exchanged:r.exchangeCount}}},{key:"peers",value:function(){return Array.from(this.ledgerMap.values()).map((function(e){return e.partner}))}},{key:"receivedBlocks",value:function(e){if(0!==e.length){var t,r=(0,ge.Z)(this.ledgerMap.values());try{for(r.s();!(t=r.n()).done;){var n,i=t.value,a=(0,ge.Z)(e);try{for(a.s();!(n=a.n()).done;){var s=n.value,o=s.cid,u=s.block,c=i.wantlistContains(o);if(null!=c){var l=u.length,h=this._sendAsBlock(c.wantType,l),f=l;h||(f=Jo.blockPresenceSize(c.cid)),this._requestQueue.pushTasks(i.partner,[{topic:c.cid.toString(Mi),priority:c.priority,size:f,data:{blockSize:l,isWantBlock:h,haveBlock:!0,sendDontHave:!1}}])}}}catch(d){a.e(d)}finally{a.f()}}}catch(d){r.e(d)}finally{r.f()}this._scheduleProcessTasks()}}},{key:"messageReceived",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._findOrCreate(t),!r.empty){e.next=3;break}return e.abrupt("return");case 3:if(r.full&&(n.wantlist=new tu),this._updateBlockAccounting(r.blocks,n),0!==r.wantlist.size){e.next=8;break}return this._scheduleProcessTasks(),e.abrupt("return");case 8:return i=[],a=[],r.wantlist.forEach((function(e){e.cancel?(n.cancelWant(e.cid),i.push(e.cid)):(n.wants(e.cid,e.priority,e.wantType),a.push(e))})),this._cancelWants(t,i),e.next=14,this._addWants(t,a);case 14:this._scheduleProcessTasks();case 15:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_cancelWants",value:function(e,t){var r,n=(0,ge.Z)(t);try{for(n.s();!(r=n.n()).done;){var i=r.value;this._requestQueue.remove(i.toString(Mi),e)}}catch(a){n.e(a)}finally{n.f()}}},{key:"_addWants",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c,l,h;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getBlockSizes(r.map((function(e){return e.cid})));case 2:n=e.sent,i=[],a=(0,ge.Z)(r);try{for(a.s();!(s=a.n()).done;)o=s.value,u=o.cid.toString(Mi),null==(c=n.get(u))?o.sendDontHave&&i.push({topic:u,priority:o.priority,size:Jo.blockPresenceSize(o.cid),data:{isWantBlock:o.wantType===lu.Block,blockSize:0,haveBlock:!1,sendDontHave:o.sendDontHave}}):(l=this._sendAsBlock(o.wantType,c),h=c,l||(h=Jo.blockPresenceSize(o.cid)),i.push({topic:u,priority:o.priority,size:h,data:{isWantBlock:l,blockSize:c,haveBlock:!0,sendDontHave:o.sendDontHave}})),this._requestQueue.pushTasks(t,i)}catch(f){a.e(f)}finally{a.f()}case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_sendAsBlock",value:function(e,t){return e===lu.Block||t<=this._opts.maxSizeReplaceHasWithBlock}},{key:"_getBlockSizes",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getBlocks(t);case 2:return r=e.sent,e.abrupt("return",new Map(be(r).map((function(e){var t=(0,ke.Z)(e,2);return[t[0],t[1].length]}))));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getBlocks",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Map,e.next=3,Promise.all(t.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.blockstore.get(t);case 3:i=e.sent,r.set(t.toString(Mi),i),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),"ERR_NOT_FOUND"!==e.t0.code&&n._log.error("failed to query blockstore for %s: %s",t,e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()));case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateBlockAccounting",value:function(e,t){var r,n=(0,ge.Z)(e.values());try{for(n.s();!(r=n.n()).done;){var i=r.value;this._log("got block (%s bytes)",i.length),t.receivedBytes(i.length)}}catch(a){n.e(a)}finally{n.f()}}},{key:"messageSent",value:function(e,t,r){var n=this._findOrCreate(e);n.sentBytes(r.length),n.wantlist.remove(t)}},{key:"numBytesSentTo",value:function(e){return this._findOrCreate(e).accounting.bytesSent}},{key:"numBytesReceivedFrom",value:function(e){return this._findOrCreate(e).accounting.bytesRecv}},{key:"peerDisconnected",value:function(e){this.ledgerMap.delete(e.toString())}},{key:"_findOrCreate",value:function(e){var t=e.toString(),r=this.ledgerMap.get(t);if(null!=r)return r;var n=new nu(e);return this.ledgerMap.set(t,n),null!=this._stats&&this._stats.push(t,"peerCount",1),n}},{key:"start",value:function(){this._running=!0}},{key:"stop",value:function(){this._running=!1}}]),e}(),fu=Math.pow(2,7),du=Math.pow(2,14),pu=Math.pow(2,21),vu=Math.pow(2,28),gu=Math.pow(2,35),yu=Math.pow(2,42),mu=Math.pow(2,49),bu=128,_u=127;function wu(e){if(e<fu)return 1;if(e<du)return 2;if(e<pu)return 3;if(e<vu)return 4;if(e<gu)return 5;if(e<yu)return 6;if(e<mu)return 7;if(null!=Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function ku(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null==t&&(t=Os(wu(e))),t instanceof Uint8Array?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;switch(wu(e)){case 8:t[r++]=255&e|bu,e/=128;case 7:t[r++]=255&e|bu,e/=128;case 6:t[r++]=255&e|bu,e/=128;case 5:t[r++]=255&e|bu,e/=128;case 4:t[r++]=255&e|bu,e>>>=7;case 3:t[r++]=255&e|bu,e>>>=7;case 2:t[r++]=255&e|bu,e>>>=7;case 1:t[r++]=255&e,e>>>=7;break;default:throw new Error("unreachable")}return t}(e,t,r):function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;switch(wu(e)){case 8:t.set(r++,255&e|bu),e/=128;case 7:t.set(r++,255&e|bu),e/=128;case 6:t.set(r++,255&e|bu),e/=128;case 5:t.set(r++,255&e|bu),e/=128;case 4:t.set(r++,255&e|bu),e>>>=7;case 3:t.set(r++,255&e|bu),e>>>=7;case 2:t.set(r++,255&e|bu),e>>>=7;case 1:t.set(r++,255&e),e>>>=7;break;default:throw new Error("unreachable")}return t}(e,t,r)}function xu(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e instanceof Uint8Array?function(e,t){var r=e[t],n=0;if(n+=r&_u,r<bu)return n;if(n+=((r=e[t+1])&_u)<<7,r<bu)return n;if(n+=((r=e[t+2])&_u)<<14,r<bu)return n;if(n+=((r=e[t+3])&_u)<<21,r<bu)return n;if(n+=((r=e[t+4])&_u)*vu,r<bu)return n;if(n+=((r=e[t+5])&_u)*gu,r<bu)return n;if(n+=((r=e[t+6])&_u)*yu,r<bu)return n;if(n+=((r=e[t+7])&_u)*mu,r<bu)return n;throw new RangeError("Could not decode varint")}(e,t):function(e,t){var r=e.get(t),n=0;if(n+=r&_u,r<bu)return n;if(n+=((r=e.get(t+1))&_u)<<7,r<bu)return n;if(n+=((r=e.get(t+2))&_u)<<14,r<bu)return n;if(n+=((r=e.get(t+3))&_u)<<21,r<bu)return n;if(n+=((r=e.get(t+4))&_u)*vu,r<bu)return n;if(n+=((r=e.get(t+5))&_u)*gu,r<bu)return n;if(n+=((r=e.get(t+6))&_u)*yu,r<bu)return n;if(n+=((r=e.get(t+7))&_u)*mu,r<bu)return n;throw new RangeError("Could not decode varint")}(e,t)}function Eu(e,t){null==t&&(t=e.reduce((function(e,t){return e+t.length}),0));var r,n=Os(t),i=0,a=(0,ge.Z)(e);try{for(a.s();!(r=a.n()).done;){var s=r.value;n.set(s,i),i+=s.length}}catch(o){a.e(o)}finally{a.f()}return cs(n)}var Su=Symbol.for("@achingbrain/uint8arraylist");function Cu(e,t){if(null==t||t<0)throw new RangeError("index is out of bounds");var r,n=0,i=(0,ge.Z)(e);try{for(i.s();!(r=i.n()).done;){var a=r.value,s=n+a.byteLength;if(t<s)return{buf:a,index:t-n};n=s}}catch(o){i.e(o)}finally{i.f()}throw new RangeError("index is out of bounds")}function Au(e){return Boolean(null===e||void 0===e?void 0:e[Su])}var Du=function(e){function t(){(0,hi.Z)(this,t),Object.defineProperty(this,Su,{value:!0}),this.bufs=[],this.length=0;for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];r.length>0&&this.appendAll(r)}return(0,fi.Z)(t,[{key:e,value:(0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.bufs,"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"byteLength",get:function(){return this.length}},{key:"append",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.appendAll(t)}},{key:"appendAll",value:function(e){var t,r=0,n=(0,ge.Z)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i instanceof Uint8Array)r+=i.byteLength,this.bufs.push(i);else{if(!Au(i))throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");var a;r+=i.byteLength,(a=this.bufs).push.apply(a,be(i.bufs))}}}catch(s){n.e(s)}finally{n.f()}this.length+=r}},{key:"prepend",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.prependAll(t)}},{key:"prependAll",value:function(e){var t,r=0,n=(0,ge.Z)(e.reverse());try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i instanceof Uint8Array)r+=i.byteLength,this.bufs.unshift(i);else{if(!Au(i))throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");var a;r+=i.byteLength,(a=this.bufs).unshift.apply(a,be(i.bufs))}}}catch(s){n.e(s)}finally{n.f()}this.length+=r}},{key:"get",value:function(e){var t=Cu(this.bufs,e);return t.buf[t.index]}},{key:"set",value:function(e,t){var r=Cu(this.bufs,e);r.buf[r.index]=t}},{key:"write",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e instanceof Uint8Array)for(var r=0;r<e.length;r++)this.set(t+r,e[r]);else{if(!Au(e))throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList");for(var n=0;n<e.length;n++)this.set(t+n,e.get(n))}}},{key:"consume",value:function(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0)){if(e===this.byteLength)return this.bufs=[],void(this.length=0);for(;this.bufs.length>0;){if(!(e>=this.bufs[0].byteLength)){this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift()}}}},{key:"slice",value:function(e,t){var r=this._subList(e,t);return Eu(r.bufs,r.length)}},{key:"subarray",value:function(e,t){var r=this._subList(e,t),n=r.bufs,i=r.length;return 1===n.length?n[0]:Eu(n,i)}},{key:"sublist",value:function(e,r){var n=this._subList(e,r),i=n.bufs,a=n.length,s=new t;return s.length=a,s.bufs=i,s}},{key:"_subList",value:function(e,t){var r,n;if(e=null!==(r=e)&&void 0!==r?r:0,t=null!==(n=t)&&void 0!==n?n:this.length,e<0&&(e=this.length+e),t<0&&(t=this.length+t),e<0||t>this.length)throw new RangeError("index is out of bounds");if(e===t)return{bufs:[],length:0};if(0===e&&t===this.length)return{bufs:be(this.bufs),length:this.length};for(var i=[],a=0,s=0;s<this.bufs.length;s++){var o=this.bufs[s],u=a,c=u+o.byteLength;if(a=c,!(e>=c)){var l=e>=u&&e<c,h=t>u&&t<=c;if(l&&h){if(e===u&&t===c){i.push(o);break}var f=e-u;i.push(o.subarray(f,f+(t-e)));break}if(l){if(0===e){i.push(o);continue}i.push(o.subarray(e-u))}else{if(h){if(t===c){i.push(o);break}i.push(o.subarray(0,t-u));break}i.push(o)}}}return{bufs:i,length:t-e}}},{key:"indexOf",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!Au(e)&&!(e instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');var n=e instanceof Uint8Array?e:e.subarray();if(r=Number(null!==(t=r)&&void 0!==t?t:0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),0===e.length)return r>this.length?this.length:r;var i=n.byteLength;if(0===i)throw new TypeError("search must be at least 1 byte long");for(var a=new Int32Array(256),s=0;s<256;s++)a[s]=-1;for(var o=0;o<i;o++)a[n[o]]=o;for(var u,c=a,l=this.byteLength-n.byteLength,h=n.byteLength-1,f=r;f<=l;f+=u){u=0;for(var d=h;d>=0;d--){var p=this.get(f+d);if(n[d]!==p){u=Math.max(1,d-c[p]);break}}if(0===u)return f}return-1}},{key:"getInt8",value:function(e){var t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getInt8(0)}},{key:"setInt8",value:function(e,t){var r=Os(1);new DataView(r.buffer,r.byteOffset,r.byteLength).setInt8(0,t),this.write(r,e)}},{key:"getInt16",value:function(e,t){var r=this.subarray(e,e+2);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt16(0,t)}},{key:"setInt16",value:function(e,t,r){var n=Bs(2);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt16(0,t,r),this.write(n,e)}},{key:"getInt32",value:function(e,t){var r=this.subarray(e,e+4);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt32(0,t)}},{key:"setInt32",value:function(e,t,r){var n=Bs(4);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt32(0,t,r),this.write(n,e)}},{key:"getBigInt64",value:function(e,t){var r=this.subarray(e,e+8);return new DataView(r.buffer,r.byteOffset,r.byteLength).getBigInt64(0,t)}},{key:"setBigInt64",value:function(e,t,r){var n=Bs(8);new DataView(n.buffer,n.byteOffset,n.byteLength).setBigInt64(0,t,r),this.write(n,e)}},{key:"getUint8",value:function(e){var t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getUint8(0)}},{key:"setUint8",value:function(e,t){var r=Os(1);new DataView(r.buffer,r.byteOffset,r.byteLength).setUint8(0,t),this.write(r,e)}},{key:"getUint16",value:function(e,t){var r=this.subarray(e,e+2);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint16(0,t)}},{key:"setUint16",value:function(e,t,r){var n=Bs(2);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint16(0,t,r),this.write(n,e)}},{key:"getUint32",value:function(e,t){var r=this.subarray(e,e+4);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint32(0,t)}},{key:"setUint32",value:function(e,t,r){var n=Bs(4);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint32(0,t,r),this.write(n,e)}},{key:"getBigUint64",value:function(e,t){var r=this.subarray(e,e+8);return new DataView(r.buffer,r.byteOffset,r.byteLength).getBigUint64(0,t)}},{key:"setBigUint64",value:function(e,t,r){var n=Bs(8);new DataView(n.buffer,n.byteOffset,n.byteLength).setBigUint64(0,t,r),this.write(n,e)}},{key:"getFloat32",value:function(e,t){var r=this.subarray(e,e+4);return new DataView(r.buffer,r.byteOffset,r.byteLength).getFloat32(0,t)}},{key:"setFloat32",value:function(e,t,r){var n=Bs(4);new DataView(n.buffer,n.byteOffset,n.byteLength).setFloat32(0,t,r),this.write(n,e)}},{key:"getFloat64",value:function(e,t){var r=this.subarray(e,e+8);return new DataView(r.buffer,r.byteOffset,r.byteLength).getFloat64(0,t)}},{key:"setFloat64",value:function(e,t,r){var n=Bs(8);new DataView(n.buffer,n.byteOffset,n.byteLength).setFloat64(0,t,r),this.write(n,e)}},{key:"equals",value:function(e){if(null==e)return!1;if(!(e instanceof t))return!1;if(e.bufs.length!==this.bufs.length)return!1;for(var r=0;r<this.bufs.length;r++)if(!Ao(this.bufs[r],e.bufs[r]))return!1;return!0}}],[{key:"fromUint8Arrays",value:function(e,r){var n=new t;return n.bufs=e,null==r&&(r=e.reduce((function(e,t){return e+t.byteLength}),0)),n.length=r,n}}]),t}(Symbol.iterator);function Ru(e){return null!=e[Symbol.asyncIterator]}var Tu=function e(t){var r=wu(t),n=Os(r);return ku(t,n),e.bytes=r,n};function Zu(e,t){var r,n,i=(0,ii.Z)().mark(s),a=null!==(n=(t=null!==(r=t)&&void 0!==r?r:{}).lengthEncoder)&&void 0!==n?n:Tu;function s(e){var t;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!((t=a(e.byteLength))instanceof Uint8Array)){r.next=6;break}return r.next=4,t;case 4:r.next=7;break;case 6:return r.delegateYield(t,"t0",7);case 7:if(!(e instanceof Uint8Array)){r.next=12;break}return r.next=10,e;case 10:r.next=13;break;case 12:return r.delegateYield(e,"t1",13);case 13:case"end":return r.stop()}}),i)}return Ru(e)?ea((0,ii.Z)().mark((function t(){var r,n,i,a,o,u;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=!1,n=!1,t.prev=2,a=ui(e);case 4:return t.next=6,Ji(a.next());case 6:if(!(r=!(o=t.sent).done)){t.next=12;break}return u=o.value,t.delegateYield(Xa(ui(s(u))),"t0",9);case 9:r=!1,t.next=4;break;case 12:t.next=18;break;case 14:t.prev=14,t.t1=t.catch(2),n=!0,i=t.t1;case 18:if(t.prev=18,t.prev=19,!r||null==a.return){t.next=23;break}return t.next=23,Ji(a.return());case 23:if(t.prev=23,!n){t.next=26;break}throw i;case 26:return t.finish(23);case 27:return t.finish(18);case 28:case"end":return t.stop()}}),t,null,[[2,14,18,28],[19,,23,27]])})))():(0,ii.Z)().mark((function t(){var r,n,i;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=(0,ge.Z)(e),t.prev=1,r.s();case 3:if((n=r.n()).done){t.next=8;break}return i=n.value,t.delegateYield(s(i),"t0",6);case 6:t.next=3;break;case 8:t.next=13;break;case 10:t.prev=10,t.t1=t.catch(1),r.e(t.t1);case 13:return t.prev=13,r.f(),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,10,13,16]])}))()}Tu.bytes=0,Zu.single=function(e,t){var r,n,i=null!==(n=(t=null!==(r=t)&&void 0!==r?r:{}).lengthEncoder)&&void 0!==n?n:Tu;return new Du(i(e.byteLength),e)};var Iu,Pu=8,Lu=4194304;!function(e){e[e.LENGTH=0]="LENGTH",e[e.DATA=1]="DATA"}(Iu||(Iu={}));var Mu=function e(t){var r=xu(t);return e.bytes=wu(r),r};function Bu(e,t){var r,n,i,a=(0,ii.Z)().mark(f),s=new Du,o=Iu.LENGTH,u=-1,c=null!==(r=null===t||void 0===t?void 0:t.lengthDecoder)&&void 0!==r?r:Mu,l=null!==(n=null===t||void 0===t?void 0:t.maxLengthLength)&&void 0!==n?n:Pu,h=null!==(i=null===t||void 0===t?void 0:t.maxDataLength)&&void 0!==i?i:Lu;function f(){var e,r;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(s.byteLength>0)){n.next=32;break}if(o!==Iu.LENGTH){n.next=21;break}if(n.prev=2,!((u=c(s))<0)){n.next=6;break}throw ji(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");case 6:if(!(u>h)){n.next=8;break}throw ji(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");case 8:e=c.bytes,s.consume(e),null!=(null===t||void 0===t?void 0:t.onLength)&&t.onLength(u),o=Iu.DATA,n.next=21;break;case 14:if(n.prev=14,n.t0=n.catch(2),!(n.t0 instanceof RangeError)){n.next=20;break}if(!(s.byteLength>l)){n.next=19;break}throw ji(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");case 19:return n.abrupt("break",32);case 20:throw n.t0;case 21:if(o!==Iu.DATA){n.next=30;break}if(!(s.byteLength<u)){n.next=24;break}return n.abrupt("break",32);case 24:return r=s.sublist(0,u),s.consume(u),null!=(null===t||void 0===t?void 0:t.onData)&&t.onData(r),n.next=29,r;case 29:o=Iu.LENGTH;case 30:n.next=0;break;case 32:case"end":return n.stop()}}),a,null,[[2,14]])}return Ru(e)?ea((0,ii.Z)().mark((function t(){var r,n,i,a,o,u;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=!1,n=!1,t.prev=2,a=ui(e);case 4:return t.next=6,Ji(a.next());case 6:if(!(r=!(o=t.sent).done)){t.next=13;break}return u=o.value,s.append(u),t.delegateYield(Xa(ui(f())),"t0",10);case 10:r=!1,t.next=4;break;case 13:t.next=19;break;case 15:t.prev=15,t.t1=t.catch(2),n=!0,i=t.t1;case 19:if(t.prev=19,t.prev=20,!r||null==a.return){t.next=24;break}return t.next=24,Ji(a.return());case 24:if(t.prev=24,!n){t.next=27;break}throw i;case 27:return t.finish(24);case 28:return t.finish(19);case 29:if(!(s.byteLength>0)){t.next=31;break}throw ji(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF");case 31:case"end":return t.stop()}}),t,null,[[2,15,19,29],[20,,24,28]])})))():(0,ii.Z)().mark((function t(){var r,n,i;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=(0,ge.Z)(e),t.prev=1,r.s();case 3:if((n=r.n()).done){t.next=9;break}return i=n.value,s.append(i),t.delegateYield(f(),"t0",7);case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t1=t.catch(1),r.e(t.t1);case 14:return t.prev=14,r.f(),t.finish(14);case 17:if(!(s.byteLength>0)){t.next=19;break}throw ji(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF");case 19:case"end":return t.stop()}}),t,null,[[1,11,14,17]])}))()}Mu.bytes=0,Bu.fromReader=function(e,t){var r=1,n=ea((0,ii.Z)().mark((function t(){var n,i,a;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=1,t.next=4,Ji(e.next(r));case 4:if(n=t.sent,i=n.done,a=n.value,!0!==i){t.next=9;break}return t.abrupt("return");case 9:if(null==a){t.next=12;break}return t.next=12,a;case 12:t.next=19;break;case 14:if(t.prev=14,t.t0=t.catch(1),"ERR_UNDER_READ"!==t.t0.code){t.next=18;break}return t.abrupt("return",{done:!0,value:null});case 18:throw t.t0;case 19:return t.prev=19,r=1,t.finish(19);case 22:t.next=0;break;case 24:case"end":return t.stop()}}),t,null,[[1,14,19,22]])})))();return Bu(n,(0,_e.Z)((0,_e.Z)({},null!==t&&void 0!==t?t:{}),{},{onLength:function(e){r=e}}))};var Ou=function(e){ia(r,e);var t=ua(r);function r(e,n){var i;return(0,hi.Z)(this,r),(i=t.call(this,e)).detail=n,i}return(0,fi.Z)(r)}(es(Event)),Nu=__webpack_require__(7683),Fu=Math.pow(2,31)-1,Uu="/ipfs/bitswap/1.0.0",zu="/ipfs/bitswap/1.1.0",ju="/ipfs/bitswap/1.2.0",Hu=function(){function e(t,r,n){var i,a,s,o,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(0,hi.Z)(this,e),(0,we.Z)(this,"_log",void 0),(0,we.Z)(this,"_libp2p",void 0),(0,we.Z)(this,"_bitswap",void 0),(0,we.Z)(this,"_protocols",void 0),(0,we.Z)(this,"_stats",void 0),(0,we.Z)(this,"_running",void 0),(0,we.Z)(this,"_hashLoader",void 0),(0,we.Z)(this,"_maxInboundStreams",void 0),(0,we.Z)(this,"_maxOutboundStreams",void 0),(0,we.Z)(this,"_incomingStreamTimeout",void 0),(0,we.Z)(this,"_registrarIds",void 0),this._log=Zo(t.peerId,"network"),this._libp2p=t,this._bitswap=r,this._protocols=[Uu],!0!==u.b100Only&&(this._protocols.unshift(zu),this._protocols.unshift(ju)),this._stats=n,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this._hashLoader=null!==(i=u.hashLoader)&&void 0!==i?i:{getHasher:function(){return(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented");case 1:case"end":return e.stop()}}),e)})))()}},this._maxInboundStreams=null!==(a=u.maxInboundStreams)&&void 0!==a?a:1024,this._maxOutboundStreams=null!==(s=u.maxOutboundStreams)&&void 0!==s?s:1024,this._incomingStreamTimeout=null!==(o=u.incomingStreamTimeout)&&void 0!==o?o:3e4}return(0,fi.Z)(e,[{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i,a=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._running=!0,e.next=3,this._libp2p.handle(this._protocols,this._onConnection,{maxInboundStreams:this._maxInboundStreams,maxOutboundStreams:this._maxOutboundStreams});case 3:t={onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect},this._registrarIds=[],r=(0,ge.Z)(this._protocols),e.prev=6,r.s();case 8:if((n=r.n()).done){e.next=17;break}return i=n.value,e.t0=this._registrarIds,e.next=13,this._libp2p.register(i,t);case 13:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 15:e.next=8;break;case 17:e.next=22;break;case 19:e.prev=19,e.t2=e.catch(6),r.e(e.t2);case 22:return e.prev=22,r.f(),e.finish(22);case 25:this._libp2p.getConnections().forEach((function(e){a._onPeerConnect(e.remotePeer)}));case 26:case"end":return e.stop()}}),e,this,[[6,19,22,25]])})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._running=!1,e.next=3,this._libp2p.unhandle(this._protocols);case 3:if(null!=this._registrarIds){t=(0,ge.Z)(this._registrarIds);try{for(t.s();!(r=t.n()).done;)n=r.value,this._libp2p.unregister(n)}catch(i){t.e(i)}finally{t.f()}this._registrarIds=[]}case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_onConnection",value:function(e){var t=this;if(this._running){var r=e.stream,n=e.connection,i=new Nu.TimeoutController(this._incomingStreamTimeout);Promise.resolve().then((0,ai.Z)((0,ii.Z)().mark((function e(){var i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._log("incoming new bitswap %s connection from %p",r.protocol,n.remotePeer),i=function(){r.abort(new wo("Incoming Bitswap stream timed out","ERR_TIMEOUT"))},(a=AbortSignal.timeout(t._incomingStreamTimeout)).addEventListener("abort",i),e.next=6,no(r,(function(e){return Bu(e)}),function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(r){var s,o,u,c,l,h,f;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=!1,o=!1,e.prev=2,c=ui(r);case 4:return e.next=6,c.next();case 6:if(!(s=!(l=e.sent).done)){e.next=26;break}return h=l.value,e.prev=8,e.next=11,Jo.deserialize(h.subarray(),t._hashLoader);case 11:return f=e.sent,e.next=14,t._bitswap._receiveMessage(n.remotePeer,f);case 14:e.next=20;break;case 16:return e.prev=16,e.t0=e.catch(8),t._bitswap._receiveError(e.t0),e.abrupt("break",26);case 20:a.removeEventListener("abort",i),(a=AbortSignal.timeout(t._incomingStreamTimeout)).addEventListener("abort",i);case 23:s=!1,e.next=4;break;case 26:e.next=32;break;case 28:e.prev=28,e.t1=e.catch(2),o=!0,u=e.t1;case 32:if(e.prev=32,e.prev=33,!s||null==c.return){e.next=37;break}return e.next=37,c.return();case 37:if(e.prev=37,!o){e.next=40;break}throw u;case 40:return e.finish(37);case 41:return e.finish(32);case 42:case"end":return e.stop()}}),e,null,[[2,28,32,42],[8,16],[33,,37,41]])})));return function(t){return e.apply(this,arguments)}}());case 6:return e.next=8,r.close({signal:a});case 8:case"end":return e.stop()}}),e)})))).catch((function(e){t._log(e),r.abort(e)})).finally((function(){i.clear()}))}}},{key:"_onPeerConnect",value:function(e){this._bitswap._onPeerConnected(e)}},{key:"_onPeerDisconnect",value:function(e){this._bitswap._onPeerDisconnected(e)}},{key:"findProviders",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null===(t=r.onProgress)||void 0===t||t.call(r,new Ou("bitswap:network:find-providers",e)),this._libp2p.contentRouting.findProviders(e,r)}},{key:"findAndConnect",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qs($s(ro(this.findProviders(t,r),function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.connectTo(t.id,r).catch((function(e){n._log.error(e)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),3)).catch((function(e){n._log.error(e)}));case 2:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"provide",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(r=(n=i.length>1&&void 0!==i[1]?i[1]:{}).onProgress)||void 0===r||r.call(n,new Ou("bitswap:network:provide",t)),e.next=4,this._libp2p.contentRouting.provide(t,n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendMessage",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=s.length>2&&void 0!==s[2]?s[2]:{},this._running){e.next=3;break}throw new Error("network isn't running");case 3:return a=t.toString(),this._log("sendMessage to %s",a,r),null===(n=i.onProgress)||void 0===n||n.call(i,new Ou("bitswap:network:send-wantlist",t)),e.next=8,this._writeMessage(t,r,i);case 8:this._updateSentStats(t,r.blocks);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"connectTo",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:{},this._running){e.next=3;break}throw new Error("network isn't running");case 3:return null===(r=n.onProgress)||void 0===r||r.call(n,new Ou("bitswap:network:dial",t)),e.abrupt("return",this._libp2p.dial(t,n));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateSentStats",value:function(e,t){var r=e.toString();if(null!=this._stats){var n,i=(0,ge.Z)(t.values());try{for(i.s();!(n=i.n()).done;){var a=n.value;this._stats.push(r,"dataSent",a.length)}}catch(s){i.e(s)}finally{i.f()}this._stats.push(r,"blocksSent",t.size)}}},{key:"_writeMessage",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>2&&void 0!==o[2]?o[2]:{},e.next=3,this._libp2p.dialProtocol(t,[ju,zu,Uu]);case 3:i=e.sent,e.prev=4,e.t0=i.protocol,e.next=e.t0===Uu?8:e.t0===zu||e.t0===ju?10:12;break;case 8:return a=r.serializeToBitswap100(),e.abrupt("break",13);case 10:return a=r.serializeToBitswap110(),e.abrupt("break",13);case 12:throw new Error("Unknown protocol: ".concat(i.protocol));case 13:return e.next=15,no([a],(function(e){return Zu(e)}),i);case 15:return e.next=17,i.close();case 17:e.next=24;break;case 19:e.prev=19,e.t1=e.catch(4),null===(s=n.onProgress)||void 0===s||s.call(n,new Ou("bitswap:network:send-wantlist:error",{peer:t,error:e.t1})),this._log(e.t1),i.abort(e.t1);case 24:case"end":return e.stop()}}),e,this,[[4,19]])})));return function(t,r){return e.apply(this,arguments)}}()}]),e}(),Wu=__webpack_require__(7465),qu=function(e){return"unwant:".concat(Ws(e.multihash.bytes,"base64"))},Vu=function(e){return"block:".concat(Ws(e.multihash.bytes,"base64"))},Ku=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),n=t.call(this),(0,we.Z)(ra(n),"_log",void 0),n.setMaxListeners(1e3),n._log=Zo(e,"notif"),n}return(0,fi.Z)(r,[{key:"hasBlock",value:function(e,t){var r=Vu(e);this._log(r),this.emit(r,t)}},{key:"wantBlock",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a=this,s=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.length>1&&void 0!==s[1]?s[1]:{},null!=t){e.next=3;break}throw new Error("Not a valid cid");case 3:return n=Vu(t),i=qu(t),this._log("wantBlock:".concat(t)),e.abrupt("return",new Promise((function(e,s){var o,u=function(){var e;a.removeListener(n,c),null===(e=r.onProgress)||void 0===e||e.call(r,new Ou("bitswap:want-block:unwant",t)),s(new Error("Block for ".concat(t," unwanted")))},c=function(n){var s;a.removeListener(i,u),null===(s=r.onProgress)||void 0===s||s.call(r,new Ou("bitswap:want-block:block",t)),e(n)};a.once(i,u),a.once(n,c),null===(o=r.signal)||void 0===o||o.addEventListener("abort",(function(){a.removeListener(n,c),a.removeListener(i,u),s(new Error("Want for ".concat(t," aborted")))}))})));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"unwantBlock",value:function(e){var t=qu(e);this._log(t),this.emit(t)}}]),r}(Wu.EventEmitter),Yu=__webpack_require__(6755),Gu=function(e){ia(r,e);var t=ua(r);function r(e,n){var i;return(0,hi.Z)(this,r),i=t.call(this),(0,we.Z)(ra(i),"_options",void 0),(0,we.Z)(ra(i),"_queue",void 0),(0,we.Z)(ra(i),"_stats",void 0),(0,we.Z)(ra(i),"_frequencyLastTime",void 0),(0,we.Z)(ra(i),"_frequencyAccumulators",void 0),(0,we.Z)(ra(i),"_movingAverages",void 0),(0,we.Z)(ra(i),"_enabled",void 0),(0,we.Z)(ra(i),"_timeout",void 0),i._options=n,i._queue=[],i._stats={},i._frequencyLastTime=Date.now(),i._frequencyAccumulators={},i._movingAverages={},i._update=i._update.bind(ra(i)),e.forEach((function(e){i._stats[e]=BigInt(0),i._movingAverages[e]={},i._options.movingAverageIntervals.forEach((function(t){(i._movingAverages[e][t]=Yu(t)).push(i._frequencyLastTime,0)}))})),i._enabled=i._options.enabled,i}return(0,fi.Z)(r,[{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1}},{key:"stop",value:function(){null!=this._timeout&&clearTimeout(this._timeout)}},{key:"snapshot",get:function(){return Object.assign({},this._stats)}},{key:"movingAverages",get:function(){return Object.assign({},this._movingAverages)}},{key:"push",value:function(e,t){this._enabled&&(this._queue.push([e,t,Date.now()]),this._resetComputeTimeout())}},{key:"_resetComputeTimeout",value:function(){null!=this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}},{key:"_nextTimeout",value:function(){var e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}},{key:"_update",value:function(){if(this._timeout=void 0,this._queue.length>0){for(var e;this._queue.length>0;){var t=e=this._queue.shift();null!=t&&this._applyOp(t)}null!=e&&this._updateFrequency(e[2]),this.emit("update",this._stats)}}},{key:"_updateFrequency",value:function(e){var t=this,r=e-this._frequencyLastTime;r>0&&Object.keys(this._stats).forEach((function(n){t._updateFrequencyFor(n,r,e)})),this._frequencyLastTime=e}},{key:"_updateFrequencyFor",value:function(e,t,r){var n,i=null!==(n=this._frequencyAccumulators[e])&&void 0!==n?n:0;this._frequencyAccumulators[e]=0;var a=i/t*1e3,s=this._movingAverages[e];null==s&&(s=this._movingAverages[e]={}),this._options.movingAverageIntervals.forEach((function(e){var t=s[e];null==t&&(t=s[e]=Yu(e)),t.push(r,a)}))}},{key:"_applyOp",value:function(e){var t=e[0],r=e[1];if("number"!==typeof r)throw new Error("invalid increment number: ".concat(r));Object.prototype.hasOwnProperty.call(this._stats,t)||(this._stats[t]=BigInt(0)),this._stats[t]=BigInt(this._stats[t])+BigInt(r),null==this._frequencyAccumulators[t]&&(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=r}}]),r}(Wu.EventEmitter),Qu={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[6e4,3e5,9e5]},Xu=function(e){ia(r,e);var t=ua(r);function r(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qu;(0,hi.Z)(this,r),n=t.call(this),(0,we.Z)(ra(n),"_initialCounters",void 0),(0,we.Z)(ra(n),"_options",void 0),(0,we.Z)(ra(n),"_enabled",void 0),(0,we.Z)(ra(n),"_global",void 0),(0,we.Z)(ra(n),"_peers",void 0);var s=Object.assign({},Qu,a);if("number"!==typeof s.computeThrottleTimeout)throw new Error("need computeThrottleTimeout");if("number"!==typeof s.computeThrottleMaxQueueSize)throw new Error("need computeThrottleMaxQueueSize");return n._initialCounters=i,n._options=s,n._enabled=n._options.enabled,n._global=new Gu(i,s),n._global.on("update",(function(e){return n.emit("update",e)})),n._peers=bo({name:"ipfs_bitswap_stats_peers",metrics:e.metrics}),n}return(0,fi.Z)(r,[{key:"enable",value:function(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}},{key:"disable",value:function(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}},{key:"stop",value:function(){this._enabled=!1,this._global.stop();var e,t=(0,ge.Z)(this._peers);try{for(t.s();!(e=t.n()).done;){e.value[1].stop()}}catch(r){t.e(r)}finally{t.f()}}},{key:"snapshot",get:function(){return this._global.snapshot}},{key:"movingAverages",get:function(){return this._global.movingAverages}},{key:"forPeer",value:function(e){var t=e.toString();return this._peers.get(t)}},{key:"push",value:function(e,t,r){if(this._enabled&&(this._global.push(t,r),null!=e)){var n=this._peers.get(e);null==n&&(n=new Gu(this._initialCounters,this._options),this._peers.set(e,n)),n.push(t,r)}}},{key:"disconnected",value:function(e){var t=e.toString(),r=this._peers.get(t);null!=r&&(r.stop(),this._peers.delete(t))}}]),r}(Wu.EventEmitter),Ju=function(e,t,r){var n=null,i=null,a=function(){n&&(clearTimeout(n),i=null,n=null)},s=function(){if(!t)return e.apply(this,arguments);var s=this,o=arguments,u=r&&!n;return a(),i=function(){e.apply(s,o)},n=setTimeout((function(){if(n=null,!u){var e=i;return i=null,e()}}),t),u?i():void 0};return s.cancel=a,s.flush=function(){var e=i;a(),e&&e()},s};var $u=function(){function e(t,r,n){(0,hi.Z)(this,e),(0,we.Z)(this,"peerId",void 0),(0,we.Z)(this,"refcnt",void 0),(0,we.Z)(this,"network",void 0),(0,we.Z)(this,"_entries",void 0),(0,we.Z)(this,"_log",void 0),this.peerId=r,this.network=n,this.refcnt=1,this._entries=[],this._log=Zo(t,"msgqueue"),this.sendEntries=Ju(this.sendEntries.bind(this),1)}return(0,fi.Z)(e,[{key:"addMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.empty||this.send(e,t)}},{key:"addEntries",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._entries=this._entries.concat(e),this.sendEntries(t)}},{key:"sendEntries",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(0!==this._entries.length){var t=new Jo(!1);this._entries.forEach((function(e){!0===e.cancel?t.cancel(e.cid):t.addEntry(e.cid,e.priority)})),this._entries=[],this.addMessage(t,e)}}},{key:"send",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n=this,i=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{},e.prev=1,e.next=4,this.network.connectTo(this.peerId,r);case 4:e.next=10;break;case 6:return e.prev=6,e.t0=e.catch(1),this._log.error("cant connect to peer %p: %s",this.peerId,e.t0.message),e.abrupt("return");case 10:this._log("sending message to peer %p",this.peerId),this.network.sendMessage(this.peerId,t,r).catch((function(e){n._log.error("send error",e)}));case 12:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),ec=function(){function e(t,r,n,i){(0,hi.Z)(this,e),(0,we.Z)(this,"peers",void 0),(0,we.Z)(this,"wantlist",void 0),(0,we.Z)(this,"network",void 0),(0,we.Z)(this,"_peerId",void 0),(0,we.Z)(this,"_log",void 0),this.peers=bo({name:"ipfs_bitswap_want_manager_peers",metrics:i.metrics}),this.wantlist=new tu(n,i),this.network=r,this._peerId=t,this._log=Zo(t,"want")}return(0,fi.Z)(e,[{key:"_addEntries",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=e.map((function(e,r){return new Jo.Entry(e,Fu-r,Jo.WantType.Block,t)}));a.forEach((function(e){e.cancel?!0===r?n.wantlist.removeForce(e.cid.toString(Mi)):n.wantlist.remove(e.cid):(n._log("adding to wantlist"),n.wantlist.add(e.cid,e.priority))}));var s,o=(0,ge.Z)(this.peers.values());try{for(o.s();!(s=o.n()).done;){s.value.addEntries(a,i)}}catch(u){o.e(u)}finally{o.f()}}},{key:"_startPeerHandler",value:function(e){var t=this.peers.get(e.toString());if(null==t){t=new $u(this._peerId,e,this.network);var r,n=new Jo(!0),i=(0,ge.Z)(this.wantlist.entries());try{for(i.s();!(r=i.n()).done;){var a=r.value;n.addEntry(a[1].cid,a[1].priority)}}catch(s){i.e(s)}finally{i.f()}return t.addMessage(n),this.peers.set(e.toString(),t),t}t.refcnt++}},{key:"_stopPeerHandler",value:function(e){var t=this.peers.get(e.toString());null!=t&&(t.refcnt--,t.refcnt>0||this.peers.delete(e.toString()))}},{key:"wantBlocks",value:function(e){var t,r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._addEntries(e,!1,!1,n),null===(t=n.signal)||void 0===t||t.addEventListener("abort",(function(){r.cancelWants(e)}))}},{key:"unwantBlocks",value:function(e){this._log("unwant blocks: %s",e.length),this._addEntries(e,!0,!0)}},{key:"cancelWants",value:function(e){this._log("cancel wants: %s",e.length),this._addEntries(e,!0)}},{key:"connectedPeers",value:function(){return Array.from(this.peers.keys())}},{key:"connected",value:function(e){this._startPeerHandler(e)}},{key:"disconnected",value:function(e){this._stopPeerHandler(e)}},{key:"start",value:function(){}},{key:"stop",value:function(){var e=this;this.peers.forEach((function(t){e.disconnected(t.peerId)}))}}]),e}(),tc={maxInboundStreams:1024,maxOutboundStreams:1024,incomingStreamTimeout:3e4,hashLoader:{getHasher:function(){return(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Not implemented");case 1:case"end":return e.stop()}}),e)})))()}},statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},rc=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"],nc=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,hi.Z)(this,e),(0,we.Z)(this,"_libp2p",void 0),(0,we.Z)(this,"_log",void 0),(0,we.Z)(this,"stats",void 0),(0,we.Z)(this,"network",void 0),(0,we.Z)(this,"blockstore",void 0),(0,we.Z)(this,"engine",void 0),(0,we.Z)(this,"wm",void 0),(0,we.Z)(this,"notifications",void 0),(0,we.Z)(this,"started",void 0),this._libp2p=t,this._log=Zo(this.peerId),n=Object.assign({},tc,n),this.stats=new Xu(t,rc,{enabled:n.statsEnabled,computeThrottleTimeout:n.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:n.statsComputeThrottleMaxQueueSize}),this.network=new Hu(t,this,this.stats,{hashLoader:n.hashLoader,maxInboundStreams:n.maxInboundStreams,maxOutboundStreams:n.maxOutboundStreams,incomingStreamTimeout:n.incomingStreamTimeout}),this.blockstore=r,this.engine=new hu(this.peerId,r,this.network,this.stats,t),this.wm=new ec(this.peerId,this.network,this.stats,t),this.notifications=new Ku(this.peerId),this.started=!1}return(0,fi.Z)(e,[{key:"isStarted",value:function(){return this.started}},{key:"peerId",get:function(){return this._libp2p.peerId}},{key:"_receiveMessage",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c,l=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.engine.messageReceived(t,r);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),this._log("failed to receive message",r);case 8:if(0!==r.blocks.size){e.next=10;break}return e.abrupt("return");case 10:n=[],i=(0,ge.Z)(r.blocks.entries());try{for(i.s();!(a=i.n()).done;)s=(0,ke.Z)(a.value,2),o=s[0],u=s[1],c=Ba.parse(o),n.push({wasWanted:this.wm.wantlist.contains(c),cid:c,data:u})}catch(h){i.e(h)}finally{i.f()}return this.wm.cancelWants(n.filter((function(e){return e.wasWanted})).map((function(e){return e.cid}))),e.next=16,Promise.all(n.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(r){var n,i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.cid,i=r.wasWanted,a=r.data,e.next=3,l._handleReceivedBlock(t,n,a,i);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 16:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_handleReceivedBlock",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i){var a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._log("received block"),e.next=3,this.blockstore.has(r);case 3:if(a=e.sent,this._updateReceiveCounters(t.toString(),r,n,a),i){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.put(r,n);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i){return e.apply(this,arguments)}}()},{key:"_updateReceiveCounters",value:function(e,t,r,n){this.stats.push(e,"blocksReceived",1),this.stats.push(e,"dataReceived",r.length),n&&(this.stats.push(e,"dupBlksReceived",1),this.stats.push(e,"dupDataReceived",r.length))}},{key:"_receiveError",value:function(e){this._log.error("ReceiveError",e)}},{key:"_onPeerConnected",value:function(e){this.wm.connected(e)}},{key:"_onPeerDisconnected",value:function(e){this.wm.disconnected(e),this.engine.peerDisconnected(e),this.stats.disconnected(e)}},{key:"enableStats",value:function(){this.stats.enable()}},{key:"disableStats",value:function(){this.stats.disable()}},{key:"wantlistForPeer",value:function(e,t){return this.engine.wantlistForPeer(e)}},{key:"ledgerForPeer",value:function(e){return this.engine.ledgerForPeer(e)}},{key:"want",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c=this,l=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>1&&void 0!==l[1]?l[1]:{},n=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.wm.wantBlocks([t],r),e.abrupt("return",c.notifications.wantBlock(t,r));case 2:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),i=!1,a=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.blockstore.get(t,r);case 3:return a=e.sent,e.abrupt("return",a);case 7:if(e.prev=7,e.t0=e.catch(0),"ERR_NOT_FOUND"===e.t0.code){e.next=11;break}throw e.t0;case 11:return i||(i=!0,c.network.findAndConnect(t,r).catch((function(e){c._log.error(e)}))),e.next=14,n(t,r);case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r){return e.apply(this,arguments)}}(),s=new AbortController,o=vo([s.signal,r.signal]),e.prev=6,e.next=9,Promise.race([this.notifications.wantBlock(t,(0,_e.Z)((0,_e.Z)({},r),{},{signal:o})),a(t,(0,_e.Z)((0,_e.Z)({},r),{},{signal:o}))]);case 9:return u=e.sent,e.abrupt("return",u);case 11:return e.prev=11,s.abort(),o.clear(),e.finish(11);case 15:case"end":return e.stop()}}),e,this,[[6,,11,15]])})));return function(t){return e.apply(this,arguments)}}()},{key:"unwant",value:function(e){var t=this,r=Array.isArray(e)?e:[e];this.wm.unwantBlocks(r),r.forEach((function(e){t.notifications.unwantBlock(e)}))}},{key:"cancelWants",value:function(e){this.wm.cancelWants(Array.isArray(e)?e:[e])}},{key:"put",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.blockstore.put(t,r);case 2:this.notify(t,r);case 3:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"putMany",value:function(e,t){var r=this;return ea((0,ii.Z)().mark((function n(){return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.delegateYield(Xa(ui(r.blockstore.putMany(go(e,(function(e){var t=e.cid,n=e.block;r.notify(t,n)})),t))),"t0",1);case 1:case"end":return n.stop()}}),n)})))()}},{key:"notify",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.notifications.hasBlock(e,t),this.engine.receivedBlocks([{cid:e,block:t}]),this.network.provide(e,n).catch((function(e){r._log.error("Failed to provide: %s",e.message)}))}},{key:"getWantlist",value:function(){return this.wm.wantlist.entries()}},{key:"peers",get:function(){return this.engine.peers()}},{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.wm.start(),e.next=3,this.network.start();case 3:this.engine.start(),this.started=!0;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.stats.stop(),this.wm.stop(),e.next=4,this.network.stop();case 4:this.engine.stop(),this.started=!1;case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function ic(e,t){co(e,t),t.add(e)}function ac(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var sc=["string","number","bigint","symbol"],oc=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function uc(e){if(null===e)return"null";if(void 0===e)return"undefined";if(!0===e||!1===e)return"boolean";var t=typeof e;if(sc.includes(t))return t;if("function"===t)return"Function";if(Array.isArray(e))return"Array";if(function(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}(e))return"Buffer";var r=function(e){var t=Object.prototype.toString.call(e).slice(8,-1);if(oc.includes(t))return t;return}(e);return r||"Object"}var cc=function(){function e(t,r,n){(0,hi.Z)(this,e),this.major=t,this.majorEncoded=t<<5,this.name=r,this.terminal=n}return(0,fi.Z)(e,[{key:"toString",value:function(){return"Type[".concat(this.major,"].").concat(this.name)}},{key:"compare",value:function(e){return this.major<e.major?-1:this.major>e.major?1:0}}]),e}();cc.uint=new cc(0,"uint",!0),cc.negint=new cc(1,"negint",!0),cc.bytes=new cc(2,"bytes",!0),cc.string=new cc(3,"string",!0),cc.array=new cc(4,"array",!1),cc.map=new cc(5,"map",!1),cc.tag=new cc(6,"tag",!1),cc.float=new cc(7,"float",!0),cc.false=new cc(7,"false",!0),cc.true=new cc(7,"true",!0),cc.null=new cc(7,"null",!0),cc.undefined=new cc(7,"undefined",!0),cc.break=new cc(7,"break",!0);var lc=function(){function e(t,r,n){(0,hi.Z)(this,e),this.type=t,this.value=r,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}return(0,fi.Z)(e,[{key:"toString",value:function(){return"Token[".concat(this.type,"].").concat(this.value)}}]),e}(),hc=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"===typeof globalThis.Buffer.isBuffer,fc=new TextDecoder,dc=new TextEncoder;function pc(e){return hc&&globalThis.Buffer.isBuffer(e)}function vc(e){return e instanceof Uint8Array?pc(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}var gc=hc?function(e,t,r){return r-t>64?globalThis.Buffer.from(e.subarray(t,r)).toString("utf8"):xc(e,t,r)}:function(e,t,r){return r-t>64?fc.decode(e.subarray(t,r)):xc(e,t,r)},yc=hc?function(e){return e.length>64?globalThis.Buffer.from(e):kc(e)}:function(e){return e.length>64?dc.encode(e):kc(e)},mc=function(e){return Uint8Array.from(e)},bc=hc?function(e,t,r){return pc(e)?new Uint8Array(e.subarray(t,r)):e.slice(t,r)}:function(e,t,r){return e.slice(t,r)},_c=hc?function(e,t){return e=e.map((function(e){return e instanceof Uint8Array?e:globalThis.Buffer.from(e)})),vc(globalThis.Buffer.concat(e,t))}:function(e,t){var r,n=new Uint8Array(t),i=0,a=(0,ge.Z)(e);try{for(a.s();!(r=a.n()).done;){var s=r.value;i+s.length>n.length&&(s=s.subarray(0,n.length-i)),n.set(s,i),i+=s.length}}catch(o){a.e(o)}finally{a.f()}return n},wc=hc?function(e){return globalThis.Buffer.allocUnsafe(e)}:function(e){return new Uint8Array(e)};function kc(e){for(var t=[],r=0,n=0;n<e.length;n++){var i=e.charCodeAt(n);i<128?t[r++]=i:i<2048?(t[r++]=i>>6|192,t[r++]=63&i|128):55296===(64512&i)&&n+1<e.length&&56320===(64512&e.charCodeAt(n+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++n)),t[r++]=i>>18|240,t[r++]=i>>12&63|128,t[r++]=i>>6&63|128,t[r++]=63&i|128):(t[r++]=i>>12|224,t[r++]=i>>6&63|128,t[r++]=63&i|128)}return t}function xc(e,t,r){for(var n=[];t<r;){var i=e[t],a=null,s=i>239?4:i>223?3:i>191?2:1;if(t+s<=r){var o=void 0,u=void 0,c=void 0,l=void 0;switch(s){case 1:i<128&&(a=i);break;case 2:128===(192&(o=e[t+1]))&&(l=(31&i)<<6|63&o)>127&&(a=l);break;case 3:o=e[t+1],u=e[t+2],128===(192&o)&&128===(192&u)&&(l=(15&i)<<12|(63&o)<<6|63&u)>2047&&(l<55296||l>57343)&&(a=l);break;case 4:o=e[t+1],u=e[t+2],c=e[t+3],128===(192&o)&&128===(192&u)&&128===(192&c)&&(l=(15&i)<<18|(63&o)<<12|(63&u)<<6|63&c)>65535&&l<1114112&&(a=l)}}null===a?(a=65533,s=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),t+=s}return Sc(n)}var Ec=4096;function Sc(e){var t=e.length;if(t<=Ec)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=Ec));return r}var Cc=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256;(0,hi.Z)(this,e),this.chunkSize=t,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}return(0,fi.Z)(e,[{key:"reset",value:function(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}},{key:"push",value:function(e){var t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){var r=t.length-(this.maxCursor-this.cursor)-1;t.set(e,r)}else{if(t){var n=t.length-(this.maxCursor-this.cursor)-1;n<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,n),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=wc(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,null===this._initReuseChunk&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}},{key:"toBytes",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(1===this.chunks.length){var r=this.chunks[0];t&&this.cursor>r.length/2?(e=this.cursor===r.length?r:r.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):e=bc(r,0,this.cursor)}else e=_c(this.chunks,this.cursor);return t&&this.reset(),e}}]),e}(),Ac="CBOR decode error:",Dc="CBOR encode error:",Rc=[];function Tc(e,t,r){if(e.length-t<r)throw new Error("".concat(Ac," not enough data for type"))}Rc[23]=1,Rc[24]=2,Rc[25]=3,Rc[26]=5,Rc[27]=9;var Zc=[24,256,65536,4294967296,BigInt("18446744073709551616")];function Ic(e,t,r){Tc(e,t,1);var n=e[t];if(!0===r.strict&&n<Zc[0])throw new Error("".concat(Ac," integer encoded in more bytes than necessary (strict decode)"));return n}function Pc(e,t,r){Tc(e,t,2);var n=e[t]<<8|e[t+1];if(!0===r.strict&&n<Zc[1])throw new Error("".concat(Ac," integer encoded in more bytes than necessary (strict decode)"));return n}function Lc(e,t,r){Tc(e,t,4);var n=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(!0===r.strict&&n<Zc[2])throw new Error("".concat(Ac," integer encoded in more bytes than necessary (strict decode)"));return n}function Mc(e,t,r){Tc(e,t,8);var n=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],i=16777216*e[t+4]+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],a=(BigInt(n)<<BigInt(32))+BigInt(i);if(!0===r.strict&&a<Zc[3])throw new Error("".concat(Ac," integer encoded in more bytes than necessary (strict decode)"));if(a<=Number.MAX_SAFE_INTEGER)return Number(a);if(!0===r.allowBigInt)return a;throw new Error("".concat(Ac," integers outside of the safe integer range are not supported"))}function Bc(e,t){return Oc(e,0,t.value)}function Oc(e,t,r){if(r<Zc[0]){var n=Number(r);e.push([t|n])}else if(r<Zc[1]){var i=Number(r);e.push([24|t,i])}else if(r<Zc[2]){var a=Number(r);e.push([25|t,a>>>8,255&a])}else if(r<Zc[3]){var s=Number(r);e.push([26|t,s>>>24&255,s>>>16&255,s>>>8&255,255&s])}else{var o=BigInt(r);if(!(o<Zc[4]))throw new Error("".concat(Ac," encountered BigInt larger than allowable range"));var u=[27|t,0,0,0,0,0,0,0],c=Number(o&BigInt(4294967295)),l=Number(o>>BigInt(32)&BigInt(4294967295));u[8]=255&c,c>>=8,u[7]=255&c,c>>=8,u[6]=255&c,c>>=8,u[5]=255&c,u[4]=255&l,l>>=8,u[3]=255&l,l>>=8,u[2]=255&l,l>>=8,u[1]=255&l,e.push(u)}}Bc.encodedSize=function(e){return Oc.encodedSize(e.value)},Oc.encodedSize=function(e){return e<Zc[0]?1:e<Zc[1]?2:e<Zc[2]?3:e<Zc[3]?5:9},Bc.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};var Nc=BigInt(-1),Fc=BigInt(1);function Uc(e,t){var r=t.value,n="bigint"===typeof r?r*Nc-Fc:-1*r-1;Oc(e,t.type.majorEncoded,n)}function zc(e,t,r,n){Tc(e,t,r+n);var i=bc(e,t+r,t+r+n);return new lc(cc.bytes,i,r+n)}function jc(e,t,r,n){return zc(e,t,1,r)}function Hc(e){return void 0===e.encodedBytes&&(e.encodedBytes=e.type===cc.string?yc(e.value):e.value),e.encodedBytes}function Wc(e,t){var r=Hc(t);Oc(e,t.type.majorEncoded,r.length),e.push(r)}function qc(e,t,r,n,i){var a=r+n;Tc(e,t,a);var s=new lc(cc.string,gc(e,t+r,t+a),a);return!0===i.retainStringBytes&&(s.byteValue=bc(e,t+r,t+a)),s}function Vc(e,t,r,n){return qc(e,t,1,r,n)}Uc.encodedSize=function(e){var t=e.value,r="bigint"===typeof t?t*Nc-Fc:-1*t-1;return r<Zc[0]?1:r<Zc[1]?2:r<Zc[2]?3:r<Zc[3]?5:9},Uc.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0},Wc.encodedSize=function(e){var t=Hc(e);return Oc.encodedSize(t.length)+t.length},Wc.compareTokens=function(e,t){return r=Hc(e),n=Hc(t),r.length<n.length?-1:r.length>n.length?1:function(e,t){if(pc(e)&&pc(t))return e.compare(t);for(var r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return 0}(r,n);var r,n};var Kc=Wc;function Yc(e,t,r,n){return new lc(cc.array,n,r)}function Gc(e,t,r,n){return Yc(0,0,1,r)}function Qc(e,t){Oc(e,cc.array.majorEncoded,t.value)}function Xc(e,t,r,n){return new lc(cc.map,n,r)}function Jc(e,t,r,n){return Xc(0,0,1,r)}function $c(e,t){Oc(e,cc.map.majorEncoded,t.value)}function el(e,t,r,n){return new lc(cc.tag,r,1)}function tl(e,t){Oc(e,cc.tag.majorEncoded,t.value)}Qc.compareTokens=Bc.compareTokens,Qc.encodedSize=function(e){return Oc.encodedSize(e.value)},$c.compareTokens=Bc.compareTokens,$c.encodedSize=function(e){return Oc.encodedSize(e.value)},tl.compareTokens=Bc.compareTokens,tl.encodedSize=function(e){return Oc.encodedSize(e.value)};var rl=20,nl=21,il=22,al=23;function sl(e,t,r){if(r){if(!1===r.allowNaN&&Number.isNaN(e))throw new Error("".concat(Ac," NaN values are not supported"));if(!1===r.allowInfinity&&(e===1/0||e===-1/0))throw new Error("".concat(Ac," Infinity values are not supported"))}return new lc(cc.float,e,t)}function ol(e,t,r){var n,i=t.value;if(!1===i)e.push([cc.float.majorEncoded|rl]);else if(!0===i)e.push([cc.float.majorEncoded|nl]);else if(null===i)e.push([cc.float.majorEncoded|il]);else if(void 0===i)e.push([cc.float.majorEncoded|al]);else{var a=!1;r&&!0===r.float64||(hl(i),i===fl(ll,1)||Number.isNaN(i)?(ll[0]=249,e.push(ll.slice(0,3)),a=!0):(dl(i),i===pl(ll,1)&&(ll[0]=250,e.push(ll.slice(0,5)),a=!0))),a||(n=i,cl.setFloat64(0,n,!1),vl(ll,1),ll[0]=251,e.push(ll.slice(0,9)))}}ol.encodedSize=function(e,t){var r=e.value;if(!1===r||!0===r||null===r||void 0===r)return 1;if(!t||!0!==t.float64){hl(r);var n=fl(ll,1);if(r===n||Number.isNaN(r))return 3;if(dl(r),r===(n=pl(ll,1)))return 5}return 9};var ul=new ArrayBuffer(9),cl=new DataView(ul,1),ll=new Uint8Array(ul,0);function hl(e){if(e===1/0)cl.setUint16(0,31744,!1);else if(e===-1/0)cl.setUint16(0,64512,!1);else if(Number.isNaN(e))cl.setUint16(0,32256,!1);else{cl.setFloat32(0,e);var t=cl.getUint32(0),r=(2139095040&t)>>23,n=8388607&t;if(255===r)cl.setUint16(0,31744,!1);else if(0===r)cl.setUint16(0,(2147483648&e)>>16|n>>13,!1);else{var i=r-127;i<-24?cl.setUint16(0,0):i<-14?cl.setUint16(0,(2147483648&t)>>16|1<<24+i,!1):cl.setUint16(0,(2147483648&t)>>16|i+15<<10|n>>13,!1)}}}function fl(e,t){if(e.length-t<2)throw new Error("".concat(Ac," not enough data for float16"));var r=(e[t]<<8)+e[t+1];if(31744===r)return 1/0;if(64512===r)return-1/0;if(32256===r)return NaN;var n,i=r>>10&31,a=1023&r;return n=0===i?a*Math.pow(2,-24):31!==i?(a+1024)*Math.pow(2,i-25):0===a?1/0:NaN,32768&r?-n:n}function dl(e){cl.setFloat32(0,e,!1)}function pl(e,t){if(e.length-t<4)throw new Error("".concat(Ac," not enough data for float32"));var r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,4).getFloat32(0,!1)}function vl(e,t){if(e.length-t<8)throw new Error("".concat(Ac," not enough data for float64"));var r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,8).getFloat64(0,!1)}function gl(e,t,r){throw new Error("".concat(Ac," encountered invalid minor (").concat(r,") for major ").concat(e[t]>>>5))}function yl(e){return function(){throw new Error("".concat(Ac," ").concat(e))}}ol.compareTokens=Bc.compareTokens;for(var ml=[],bl=0;bl<=23;bl++)ml[bl]=gl;ml[24]=function(e,t,r,n){return new lc(cc.uint,Ic(e,t+1,n),2)},ml[25]=function(e,t,r,n){return new lc(cc.uint,Pc(e,t+1,n),3)},ml[26]=function(e,t,r,n){return new lc(cc.uint,Lc(e,t+1,n),5)},ml[27]=function(e,t,r,n){return new lc(cc.uint,Mc(e,t+1,n),9)},ml[28]=gl,ml[29]=gl,ml[30]=gl,ml[31]=gl;for(var _l=32;_l<=55;_l++)ml[_l]=gl;ml[56]=function(e,t,r,n){return new lc(cc.negint,-1-Ic(e,t+1,n),2)},ml[57]=function(e,t,r,n){return new lc(cc.negint,-1-Pc(e,t+1,n),3)},ml[58]=function(e,t,r,n){return new lc(cc.negint,-1-Lc(e,t+1,n),5)},ml[59]=function(e,t,r,n){var i=Mc(e,t+1,n);if("bigint"!==typeof i){var a=-1-i;if(a>=Number.MIN_SAFE_INTEGER)return new lc(cc.negint,a,9)}if(!0!==n.allowBigInt)throw new Error("".concat(Ac," integers outside of the safe integer range are not supported"));return new lc(cc.negint,Nc-BigInt(i),9)},ml[60]=gl,ml[61]=gl,ml[62]=gl,ml[63]=gl;for(var wl=64;wl<=87;wl++)ml[wl]=jc;ml[88]=function(e,t,r,n){return zc(e,t,2,Ic(e,t+1,n))},ml[89]=function(e,t,r,n){return zc(e,t,3,Pc(e,t+1,n))},ml[90]=function(e,t,r,n){return zc(e,t,5,Lc(e,t+1,n))},ml[91]=function(e,t,r,n){var i=Mc(e,t+1,n);if("bigint"===typeof i)throw new Error("".concat(Ac," 64-bit integer bytes lengths not supported"));return zc(e,t,9,i)},ml[92]=gl,ml[93]=gl,ml[94]=gl,ml[95]=yl("indefinite length bytes/strings are not supported");for(var kl=96;kl<=119;kl++)ml[kl]=Vc;ml[120]=function(e,t,r,n){return qc(e,t,2,Ic(e,t+1,n),n)},ml[121]=function(e,t,r,n){return qc(e,t,3,Pc(e,t+1,n),n)},ml[122]=function(e,t,r,n){return qc(e,t,5,Lc(e,t+1,n),n)},ml[123]=function(e,t,r,n){var i=Mc(e,t+1,n);if("bigint"===typeof i)throw new Error("".concat(Ac," 64-bit integer string lengths not supported"));return qc(e,t,9,i,n)},ml[124]=gl,ml[125]=gl,ml[126]=gl,ml[127]=yl("indefinite length bytes/strings are not supported");for(var xl=128;xl<=151;xl++)ml[xl]=Gc;ml[152]=function(e,t,r,n){return Yc(0,0,2,Ic(e,t+1,n))},ml[153]=function(e,t,r,n){return Yc(0,0,3,Pc(e,t+1,n))},ml[154]=function(e,t,r,n){return Yc(0,0,5,Lc(e,t+1,n))},ml[155]=function(e,t,r,n){var i=Mc(e,t+1,n);if("bigint"===typeof i)throw new Error("".concat(Ac," 64-bit integer array lengths not supported"));return Yc(0,0,9,i)},ml[156]=gl,ml[157]=gl,ml[158]=gl,ml[159]=function(e,t,r,n){if(!1===n.allowIndefinite)throw new Error("".concat(Ac," indefinite length items not allowed"));return Yc(0,0,1,1/0)};for(var El=160;El<=183;El++)ml[El]=Jc;ml[184]=function(e,t,r,n){return Xc(0,0,2,Ic(e,t+1,n))},ml[185]=function(e,t,r,n){return Xc(0,0,3,Pc(e,t+1,n))},ml[186]=function(e,t,r,n){return Xc(0,0,5,Lc(e,t+1,n))},ml[187]=function(e,t,r,n){var i=Mc(e,t+1,n);if("bigint"===typeof i)throw new Error("".concat(Ac," 64-bit integer map lengths not supported"));return Xc(0,0,9,i)},ml[188]=gl,ml[189]=gl,ml[190]=gl,ml[191]=function(e,t,r,n){if(!1===n.allowIndefinite)throw new Error("".concat(Ac," indefinite length items not allowed"));return Xc(0,0,1,1/0)};for(var Sl=192;Sl<=215;Sl++)ml[Sl]=el;ml[216]=function(e,t,r,n){return new lc(cc.tag,Ic(e,t+1,n),2)},ml[217]=function(e,t,r,n){return new lc(cc.tag,Pc(e,t+1,n),3)},ml[218]=function(e,t,r,n){return new lc(cc.tag,Lc(e,t+1,n),5)},ml[219]=function(e,t,r,n){return new lc(cc.tag,Mc(e,t+1,n),9)},ml[220]=gl,ml[221]=gl,ml[222]=gl,ml[223]=gl;for(var Cl=224;Cl<=243;Cl++)ml[Cl]=yl("simple values are not supported");ml[244]=gl,ml[245]=gl,ml[246]=gl,ml[247]=function(e,t,r,n){if(!1===n.allowUndefined)throw new Error("".concat(Ac," undefined values are not supported"));return!0===n.coerceUndefinedToNull?new lc(cc.null,null,1):new lc(cc.undefined,void 0,1)},ml[248]=yl("simple values are not supported"),ml[249]=function(e,t,r,n){return sl(fl(e,t+1),3,n)},ml[250]=function(e,t,r,n){return sl(pl(e,t+1),5,n)},ml[251]=function(e,t,r,n){return sl(vl(e,t+1),9,n)},ml[252]=gl,ml[253]=gl,ml[254]=gl,ml[255]=function(e,t,r,n){if(!1===n.allowIndefinite)throw new Error("".concat(Ac," indefinite length items not allowed"));return new lc(cc.break,void 0,1)};for(var Al=[],Dl=0;Dl<24;Dl++)Al[Dl]=new lc(cc.uint,Dl,1);for(var Rl=-1;Rl>=-24;Rl--)Al[31-Rl]=new lc(cc.negint,Rl,1);Al[64]=new lc(cc.bytes,new Uint8Array(0),1),Al[96]=new lc(cc.string,"",1),Al[128]=new lc(cc.array,0,1),Al[160]=new lc(cc.map,0,1),Al[244]=new lc(cc.false,!1,1),Al[245]=new lc(cc.true,!0,1),Al[246]=new lc(cc.null,null,1);var Tl={float64:!1,mapSorter:function(e,t){var r=Array.isArray(e[0])?e[0][0]:e[0],n=Array.isArray(t[0])?t[0][0]:t[0];if(r.type!==n.type)return r.type.compare(n.type);var i=r.type.major,a=Zl[i].compareTokens(r,n);0===a&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone");return a},quickEncodeToken:function(e){switch(e.type){case cc.false:return mc([244]);case cc.true:return mc([245]);case cc.null:return mc([246]);case cc.bytes:return e.value.length?void 0:mc([64]);case cc.string:return""===e.value?mc([96]):void 0;case cc.array:return 0===e.value?mc([128]):void 0;case cc.map:return 0===e.value?mc([160]):void 0;case cc.uint:return e.value<24?mc([Number(e.value)]):void 0;case cc.negint:if(e.value>=-24)return mc([31-Number(e.value)])}}};var Zl=function(){var e=[];return e[cc.uint.major]=Bc,e[cc.negint.major]=Uc,e[cc.bytes.major]=Wc,e[cc.string.major]=Kc,e[cc.array.major]=Qc,e[cc.map.major]=$c,e[cc.tag.major]=tl,e[cc.float.major]=ol,e}(),Il=new Cc,Pl=function(){function e(t,r){(0,hi.Z)(this,e),this.obj=t,this.parent=r}return(0,fi.Z)(e,[{key:"includes",value:function(e){var t=this;do{if(t.obj===e)return!0}while(t=t.parent);return!1}}],[{key:"createCheck",value:function(t,r){if(t&&t.includes(r))throw new Error("".concat(Dc," object contains circular references"));return new e(r,t)}}]),e}(),Ll={null:new lc(cc.null,null),undefined:new lc(cc.undefined,void 0),true:new lc(cc.true,!0),false:new lc(cc.false,!1),emptyArray:new lc(cc.array,0),emptyMap:new lc(cc.map,0)},Ml={number:function(e,t,r,n){return Number.isInteger(e)&&Number.isSafeInteger(e)?new lc(e>=0?cc.uint:cc.negint,e):new lc(cc.float,e)},bigint:function(e,t,r,n){return e>=BigInt(0)?new lc(cc.uint,e):new lc(cc.negint,e)},Uint8Array:function(e,t,r,n){return new lc(cc.bytes,e)},string:function(e,t,r,n){return new lc(cc.string,e)},boolean:function(e,t,r,n){return e?Ll.true:Ll.false},null:function(e,t,r,n){return Ll.null},undefined:function(e,t,r,n){return Ll.undefined},ArrayBuffer:function(e,t,r,n){return new lc(cc.bytes,new Uint8Array(e))},DataView:function(e,t,r,n){return new lc(cc.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array:function(e,t,r,n){if(!e.length)return!0===r.addBreakTokens?[Ll.emptyArray,new lc(cc.break)]:Ll.emptyArray;n=Pl.createCheck(n,e);var i,a=[],s=0,o=(0,ge.Z)(e);try{for(o.s();!(i=o.n()).done;){var u=i.value;a[s++]=Fl(u,r,n)}}catch(c){o.e(c)}finally{o.f()}return r.addBreakTokens?[new lc(cc.array,e.length),a,new lc(cc.break)]:[new lc(cc.array,e.length),a]},Object:function(e){function t(t,r,n,i){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,r,n){var i="Object"!==t,a=i?e.keys():Object.keys(e),s=i?e.size:a.length;if(!s)return!0===r.addBreakTokens?[Ll.emptyMap,new lc(cc.break)]:Ll.emptyMap;n=Pl.createCheck(n,e);var o,u=[],c=0,l=(0,ge.Z)(a);try{for(l.s();!(o=l.n()).done;){var h=o.value;u[c++]=[Fl(h,r,n),Fl(i?e.get(h):e[h],r,n)]}}catch(f){l.e(f)}finally{l.f()}return function(e,t){t.mapSorter&&e.sort(t.mapSorter)}(u,r),r.addBreakTokens?[new lc(cc.map,s),u,new lc(cc.break)]:[new lc(cc.map,s),u]}))};Ml.Map=Ml.Object,Ml.Buffer=Ml.Uint8Array;var Bl,Ol=(0,ge.Z)("Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "));try{for(Ol.s();!(Bl=Ol.n()).done;){var Nl=Bl.value;Ml["".concat(Nl,"Array")]=Ml.DataView}}catch(S$){Ol.e(S$)}finally{Ol.f()}function Fl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=uc(e),i=t&&t.typeEncoders&&t.typeEncoders[n]||Ml[n];if("function"===typeof i){var a=i(e,n,t,r);if(null!=a)return a}var s=Ml[n];if(!s)throw new Error("".concat(Dc," unsupported type: ").concat(n));return s(e,n,t,r)}function Ul(e,t,r,n){if(Array.isArray(t)){var i,a=(0,ge.Z)(t);try{for(a.s();!(i=a.n()).done;){Ul(e,i.value,r,n)}}catch(S$){a.e(S$)}finally{a.f()}}else r[t.type.major](e,t,n)}function zl(e,t,r){var n=Fl(e,r);if(!Array.isArray(n)&&r.quickEncodeToken){var i=r.quickEncodeToken(n);if(i)return i;var a=t[n.type.major];if(a.encodedSize){var s=a.encodedSize(n,r),o=new Cc(s);if(a(o,n,r),1!==o.chunks.length)throw new Error("Unexpected error: pre-calculated length for ".concat(n," was wrong"));return vc(o.chunks[0])}}return Il.reset(),Ul(Il,n,t,r),Il.toBytes(!0)}function jl(e,t){return t=Object.assign({},Tl,t),zl(e,Zl,t)}var Hl={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},Wl=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,hi.Z)(this,e),this._pos=0,this.data=t,this.options=r}return(0,fi.Z)(e,[{key:"pos",value:function(){return this._pos}},{key:"done",value:function(){return this._pos>=this.data.length}},{key:"next",value:function(){var e=this.data[this._pos],t=Al[e];if(void 0===t){var r=ml[e];if(!r)throw new Error("".concat(Ac," no decoder for major type ").concat(e>>>5," (byte 0x").concat(e.toString(16).padStart(2,"0"),")"));var n=31&e;t=r(this.data,this._pos,n,this.options)}return this._pos+=t.encodedLength,t}}]),e}(),ql=Symbol.for("DONE"),Vl=Symbol.for("BREAK");function Kl(e,t){if(e.done())return ql;var r=e.next();if(r.type===cc.break)return Vl;if(r.type.terminal)return r.value;if(r.type===cc.array)return function(e,t,r){for(var n=[],i=0;i<e.value;i++){var a=Kl(t,r);if(a===Vl){if(e.value===1/0)break;throw new Error("".concat(Ac," got unexpected break to lengthed array"))}if(a===ql)throw new Error("".concat(Ac," found array but not enough entries (got ").concat(i,", expected ").concat(e.value,")"));n[i]=a}return n}(r,e,t);if(r.type===cc.map)return function(e,t,r){for(var n=!0===r.useMaps,i=n?void 0:{},a=n?new Map:void 0,s=0;s<e.value;s++){var o=Kl(t,r);if(o===Vl){if(e.value===1/0)break;throw new Error("".concat(Ac," got unexpected break to lengthed map"))}if(o===ql)throw new Error("".concat(Ac," found map but not enough entries (got ").concat(s," [no key], expected ").concat(e.value,")"));if(!0!==n&&"string"!==typeof o)throw new Error("".concat(Ac," non-string keys not supported (got ").concat(typeof o,")"));if(!0===r.rejectDuplicateMapKeys&&(n&&a.has(o)||!n&&o in i))throw new Error("".concat(Ac,' found repeat map key "').concat(o,'"'));var u=Kl(t,r);if(u===ql)throw new Error("".concat(Ac," found map but not enough entries (got ").concat(s," [no value], expected ").concat(e.value,")"));n?a.set(o,u):i[o]=u}return n?a:i}(r,e,t);if(r.type===cc.tag){if(t.tags&&"function"===typeof t.tags[r.value]){var n=Kl(e,t);return t.tags[r.value](n)}throw new Error("".concat(Ac," tag not supported (").concat(r.value,")"))}throw new Error("unsupported")}function Yl(e,t){if(!(e instanceof Uint8Array))throw new Error("".concat(Ac," data to decode must be a Uint8Array"));var r=(t=Object.assign({},Hl,t)).tokenizer||new Wl(e,t),n=Kl(r,t);if(n===ql)throw new Error("".concat(Ac," did not find any content to decode"));if(n===Vl)throw new Error("".concat(Ac," got unexpected break"));return[n,e.subarray(r.pos())]}function Gl(e,t){var r=Yl(e,t),n=(0,ke.Z)(r,2),i=n[0];if(n[1].length>0)throw new Error("".concat(Ac," too many terminals, data makes no sense"));return i}var Ql=__webpack_require__(7143),Xl=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),(n=t.call(this,e)).name="TimeoutError",n}return(0,fi.Z)(r)}(es(Error)),Jl=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),(n=t.call(this)).name="AbortError",n.message=e,n}return(0,fi.Z)(r)}(es(Error)),$l=function(e){return void 0===globalThis.DOMException?new Jl(e):new DOMException(e)},eh=function(e){var t=void 0===e.reason?$l("This operation was aborted."):e.reason;return t instanceof Error?t:$l(t)};function th(e,t,r,n){var i,a=new Promise((function(a,s){if("number"!==typeof t||1!==Math.sign(t))throw new TypeError("Expected `milliseconds` to be a positive number, got `".concat(t,"`"));if(t!==Number.POSITIVE_INFINITY){if((n=(0,_e.Z)({customTimers:{setTimeout:setTimeout,clearTimeout:clearTimeout}},n)).signal){var o=n.signal;o.aborted&&s(eh(o)),o.addEventListener("abort",(function(){s(eh(o))}))}i=n.customTimers.setTimeout.call(void 0,(function(){if("function"!==typeof r){var n="string"===typeof r?r:"Promise timed out after ".concat(t," milliseconds"),i=r instanceof Error?r:new Xl(n);"function"===typeof e.cancel&&e.cancel(),s(i)}else try{a(r())}catch(o){s(o)}}),t),(0,ai.Z)((0,ii.Z)().mark((function t(){return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=a,t.next=4,e;case 4:t.t1=t.sent,(0,t.t0)(t.t1),t.next=11;break;case 8:t.prev=8,t.t2=t.catch(0),s(t.t2);case 11:return t.prev=11,n.customTimers.clearTimeout.call(void 0,i),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})))()}else a(e)}));return a.clear=function(){clearTimeout(i),i=void 0},a}var rh,nh=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},ih=function(){function e(){(0,hi.Z)(this,e),rh.set(this,[])}return(0,fi.Z)(e,[{key:"enqueue",value:function(e,t){var r={priority:(t=(0,_e.Z)({priority:0},t)).priority,run:e};if(this.size&&nh(this,rh,"f")[this.size-1].priority>=t.priority)nh(this,rh,"f").push(r);else{var n=function(e,t,r){for(var n=0,i=e.length;i>0;){var a=Math.trunc(i/2),s=n+a;r(e[s],t)<=0?(n=++s,i-=a+1):i=a}return n}(nh(this,rh,"f"),r,(function(e,t){return t.priority-e.priority}));nh(this,rh,"f").splice(n,0,r)}}},{key:"dequeue",value:function(){var e=nh(this,rh,"f").shift();return null===e||void 0===e?void 0:e.run}},{key:"filter",value:function(e){return nh(this,rh,"f").filter((function(t){return t.priority===e.priority})).map((function(e){return e.run}))}},{key:"size",get:function(){return nh(this,rh,"f").length}}]),e}();rh=new WeakMap;var ah,sh,oh,uh,ch,lh,hh,fh,dh,ph,vh,gh,yh,mh,bh,_h,wh,kh,xh,Eh,Sh,Ch,Ah,Dh,Rh,Th,Zh=ih,Ih=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},Ph=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},Lh=function(e){ia(r,e);var t=ua(r);function r(){return(0,hi.Z)(this,r),t.apply(this,arguments)}return(0,fi.Z)(r)}(es(Error)),Mh=function(e){ia(r,e);var t=ua(r);function r(e){var n,i,a,s,o;if((0,hi.Z)(this,r),n=t.call(this),ah.add(ra(n)),sh.set(ra(n),void 0),oh.set(ra(n),void 0),uh.set(ra(n),0),ch.set(ra(n),void 0),lh.set(ra(n),void 0),hh.set(ra(n),0),fh.set(ra(n),void 0),dh.set(ra(n),void 0),ph.set(ra(n),void 0),vh.set(ra(n),void 0),gh.set(ra(n),0),yh.set(ra(n),void 0),mh.set(ra(n),void 0),bh.set(ra(n),void 0),Object.defineProperty(ra(n),"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!("number"===typeof(e=(0,_e.Z)({carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Zh},e)).intervalCap&&e.intervalCap>=1))throw new TypeError("Expected `intervalCap` to be a number from 1 and up, got `".concat(null!==(a=null===(i=e.intervalCap)||void 0===i?void 0:i.toString())&&void 0!==a?a:"","` (").concat(typeof e.intervalCap,")"));if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError("Expected `interval` to be a finite number >= 0, got `".concat(null!==(o=null===(s=e.interval)||void 0===s?void 0:s.toString())&&void 0!==o?o:"","` (").concat(typeof e.interval,")"));return Ih(ra(n),sh,e.carryoverConcurrencyCount,"f"),Ih(ra(n),oh,e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval,"f"),Ih(ra(n),ch,e.intervalCap,"f"),Ih(ra(n),lh,e.interval,"f"),Ih(ra(n),ph,new e.queueClass,"f"),Ih(ra(n),vh,e.queueClass,"f"),n.concurrency=e.concurrency,n.timeout=e.timeout,Ih(ra(n),bh,!0===e.throwOnTimeout,"f"),Ih(ra(n),mh,!1===e.autoStart,"f"),n}return(0,fi.Z)(r,[{key:"concurrency",get:function(){return Ph(this,yh,"f")},set:function(e){if(!("number"===typeof e&&e>=1))throw new TypeError("Expected `concurrency` to be a number from 1 and up, got `".concat(e,"` (").concat(typeof e,")"));Ih(this,yh,e,"f"),Ph(this,ah,"m",Dh).call(this)}},{key:"add",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n=this,i=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{},r=(0,_e.Z)({timeout:this.timeout,throwOnTimeout:Ph(this,bh,"f")},r),e.abrupt("return",new Promise((function(e,i){Ph(n,ph,"f").enqueue((0,ai.Z)((0,ii.Z)().mark((function a(){var s,o,u,c,l;return(0,ii.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(Ih(n,gh,(o=Ph(n,gh,"f"),++o),"f"),Ih(n,uh,(u=Ph(n,uh,"f"),++u),"f"),a.prev=2,!(null===(s=r.signal)||void 0===s?void 0:s.aborted)){a.next=5;break}throw new Lh("The task was aborted.");case 5:return c=t({signal:r.signal}),r.timeout&&(c=th(Promise.resolve(c),r.timeout)),r.signal&&(c=Promise.race([c,Ph(n,ah,"m",Rh).call(n,r.signal)])),a.next=10,c;case 10:l=a.sent,e(l),n.emit("completed",l),a.next=22;break;case 15:if(a.prev=15,a.t0=a.catch(2),!(a.t0 instanceof Xl)||r.throwOnTimeout){a.next=20;break}return e(),a.abrupt("return");case 20:i(a.t0),n.emit("error",a.t0);case 22:return a.prev=22,Ph(n,ah,"m",kh).call(n),a.finish(22);case 25:case"end":return a.stop()}}),a,null,[[2,15,22,25]])}))),r),n.emit("add"),Ph(n,ah,"m",Sh).call(n)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addAll",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(t.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.add(t,r));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())));case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"start",value:function(){return Ph(this,mh,"f")?(Ih(this,mh,!1,"f"),Ph(this,ah,"m",Dh).call(this),this):this}},{key:"pause",value:function(){Ih(this,mh,!0,"f")}},{key:"clear",value:function(){Ih(this,ph,new(Ph(this,vh,"f")),"f")}},{key:"onEmpty",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==Ph(this,ph,"f").size){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Ph(this,ah,"m",Th).call(this,"empty");case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onSizeLessThan",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Ph(this,ph,"f").size<t)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Ph(this,ah,"m",Th).call(this,"next",(function(){return Ph(r,ph,"f").size<t}));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onIdle",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==Ph(this,gh,"f")||0!==Ph(this,ph,"f").size){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Ph(this,ah,"m",Th).call(this,"idle");case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"size",get:function(){return Ph(this,ph,"f").size}},{key:"sizeBy",value:function(e){return Ph(this,ph,"f").filter(e).length}},{key:"pending",get:function(){return Ph(this,gh,"f")}},{key:"isPaused",get:function(){return Ph(this,mh,"f")}}]),r}(Ql);sh=new WeakMap,oh=new WeakMap,uh=new WeakMap,ch=new WeakMap,lh=new WeakMap,hh=new WeakMap,fh=new WeakMap,dh=new WeakMap,ph=new WeakMap,vh=new WeakMap,gh=new WeakMap,yh=new WeakMap,mh=new WeakMap,bh=new WeakMap,ah=new WeakSet,_h=function(){return Ph(this,oh,"f")||Ph(this,uh,"f")<Ph(this,ch,"f")},wh=function(){return Ph(this,gh,"f")<Ph(this,yh,"f")},kh=function(){var e;Ih(this,gh,(e=Ph(this,gh,"f"),--e),"f"),Ph(this,ah,"m",Sh).call(this),this.emit("next")},xh=function(){Ph(this,ah,"m",Ah).call(this),Ph(this,ah,"m",Ch).call(this),Ih(this,dh,void 0,"f")},Eh=function(){var e=this,t=Date.now();if(void 0===Ph(this,fh,"f")){var r=Ph(this,hh,"f")-t;if(!(r<0))return void 0===Ph(this,dh,"f")&&Ih(this,dh,setTimeout((function(){Ph(e,ah,"m",xh).call(e)}),r),"f"),!0;Ih(this,uh,Ph(this,sh,"f")?Ph(this,gh,"f"):0,"f")}return!1},Sh=function(){if(0===Ph(this,ph,"f").size)return Ph(this,fh,"f")&&clearInterval(Ph(this,fh,"f")),Ih(this,fh,void 0,"f"),this.emit("empty"),0===Ph(this,gh,"f")&&this.emit("idle"),!1;if(!Ph(this,mh,"f")){var e=!Ph(this,ah,"a",Eh);if(Ph(this,ah,"a",_h)&&Ph(this,ah,"a",wh)){var t=Ph(this,ph,"f").dequeue();return!!t&&(this.emit("active"),t(),e&&Ph(this,ah,"m",Ch).call(this),!0)}}return!1},Ch=function(){var e=this;Ph(this,oh,"f")||void 0!==Ph(this,fh,"f")||(Ih(this,fh,setInterval((function(){Ph(e,ah,"m",Ah).call(e)}),Ph(this,lh,"f")),"f"),Ih(this,hh,Date.now()+Ph(this,lh,"f"),"f"))},Ah=function(){0===Ph(this,uh,"f")&&0===Ph(this,gh,"f")&&Ph(this,fh,"f")&&(clearInterval(Ph(this,fh,"f")),Ih(this,fh,void 0,"f")),Ih(this,uh,Ph(this,sh,"f")?Ph(this,gh,"f"):0,"f"),Ph(this,ah,"m",Dh).call(this)},Dh=function(){for(;Ph(this,ah,"m",Sh).call(this););},Rh=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){t.addEventListener("abort",(function(){r(new Lh("The task was aborted."))}),{once:!0})})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Th=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){n.on(t,(function i(){r&&!r()||(n.off(t,i),e())}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();var Bh=Mh;var Oh={float64:!0,typeEncoders:{Object:function(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;var t=Ba.asCID(e);if(!t)return null;var r=new Uint8Array(t.bytes.byteLength+1);return r.set(t.bytes,1),[new lc(cc.tag,42),new lc(cc.bytes,r)]},undefined:function(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")},number:function(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}}};var Nh={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};Nh.tags[42]=function(e){if(0!==e[0])throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return Ba.decode(e.subarray(1))};var Fh="dag-cbor",Uh=113,zh=function(e){return jl(e,Oh)},jh=function(e){return Gl(e,Nh)},Hh=function(e,t,r,n,i,a,s,o,u){ia(l,e);var c=ua(l);function l(){var e;return(0,hi.Z)(this,l),(e=c.call(this)).inRecursive=[],e}return(0,fi.Z)(l,[{key:"prefix",value:function(e){var t=this.inRecursive[this.inRecursive.length-1];t&&(t.type===cc.array&&(t.elements++,1!==t.elements&&e.push([44])),t.type===cc.map&&(t.elements++,1!==t.elements&&(t.elements%2===1?e.push([44]):e.push([58]))))}},{key:t,value:function(e,t){this.prefix(e);for(var r=String(t.value),n=[],i=0;i<r.length;i++)n[i]=r.charCodeAt(i);e.push(n)}},{key:r,value:function(e,t){this[cc.uint.major](e,t)}},{key:n,value:function(e,t){throw new Error("".concat(Dc," unsupported type: Uint8Array"))}},{key:i,value:function(e,t){this.prefix(e);var r=yc(JSON.stringify(t.value));e.push(r.length>32?vc(r):r)}},{key:a,value:function(e,t){this.prefix(e),this.inRecursive.push({type:cc.array,elements:0}),e.push([91])}},{key:s,value:function(e,t){this.prefix(e),this.inRecursive.push({type:cc.map,elements:0}),e.push([123])}},{key:o,value:function(e,t){}},{key:u,value:function(e,t){if("break"===t.type.name){var r=this.inRecursive.pop();if(r){if(r.type===cc.array)e.push([93]);else{if(r.type!==cc.map)throw new Error("Unexpected recursive type; this should not happen!");e.push([125])}return}throw new Error("Unexpected break; this should not happen!")}if(void 0===t.value)throw new Error("".concat(Dc," unsupported type: undefined"));if(this.prefix(e),"true"!==t.type.name)if("false"!==t.type.name)if("null"!==t.type.name){for(var n=String(t.value),i=[],a=!1,s=0;s<n.length;s++)i[s]=n.charCodeAt(s),a||46!==i[s]&&101!==i[s]&&69!==i[s]||(a=!0);a||(i.push(46),i.push(48)),e.push(i)}else e.push([110,117,108,108]);else e.push([102,97,108,115,101]);else e.push([116,114,117,101])}}]),l}(es(Array),cc.uint.major,cc.negint.major,cc.bytes.major,cc.string.major,cc.array.major,cc.map.major,cc.tag.major,cc.float.major);var Wh={addBreakTokens:!0,mapSorter:function(e,t){if(Array.isArray(e[0])||Array.isArray(t[0]))throw new Error("".concat(Dc," complex map keys are not supported"));var r=e[0],n=t[0];if(r.type!==cc.string||n.type!==cc.string)throw new Error("".concat(Dc," non-string map keys are not supported"));if(r<n)return-1;if(r>n)return 1;throw new Error("".concat(Dc," unexpected duplicate map keys, this is not supported"))}};var qh=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,hi.Z)(this,e),this._pos=0,this.data=t,this.options=r,this.modeStack=["value"],this.lastToken=""}return(0,fi.Z)(e,[{key:"pos",value:function(){return this._pos}},{key:"done",value:function(){return this._pos>=this.data.length}},{key:"ch",value:function(){return this.data[this._pos]}},{key:"currentMode",value:function(){return this.modeStack[this.modeStack.length-1]}},{key:"skipWhitespace",value:function(){for(var e=this.ch();32===e||9===e||13===e||10===e;)e=this.data[++this._pos]}},{key:"expect",value:function(e){if(this.data.length-this._pos<e.length)throw new Error("".concat(Ac," unexpected end of input at position ").concat(this._pos));for(var t=0;t<e.length;t++)if(this.data[this._pos++]!==e[t])throw new Error("".concat(Ac," unexpected token at position ").concat(this._pos,", expected to find '").concat(String.fromCharCode.apply(String,be(e)),"'"))}},{key:"parseNumber",value:function(){var e=this,t=this._pos,r=!1,n=!1,i=function(t){for(;!e.done();){var r=e.ch();if(!t.includes(r))break;e._pos++}};if(45===this.ch()&&(r=!0,this._pos++),48===this.ch()){if(this._pos++,46!==this.ch())return new lc(cc.uint,0,this._pos-t);this._pos++,n=!0}if(i([48,49,50,51,52,53,54,55,56,57]),r&&this._pos===t+1)throw new Error("".concat(Ac," unexpected token at position ").concat(this._pos));if(!this.done()&&46===this.ch()){if(n)throw new Error("".concat(Ac," unexpected token at position ").concat(this._pos));n=!0,this._pos++,i([48,49,50,51,52,53,54,55,56,57])}this.done()||101!==this.ch()&&69!==this.ch()||(n=!0,this._pos++,this.done()||43!==this.ch()&&45!==this.ch()||this._pos++,i([48,49,50,51,52,53,54,55,56,57]));var a=String.fromCharCode.apply(null,this.data.subarray(t,this._pos)),s=parseFloat(a);return n?new lc(cc.float,s,this._pos-t):!0!==this.options.allowBigInt||Number.isSafeInteger(s)?new lc(s>=0?cc.uint:cc.negint,s,this._pos-t):new lc(s>=0?cc.uint:cc.negint,BigInt(a),this._pos-t)}},{key:"parseString",value:function(){var e=this;if(34!==this.ch())throw new Error("".concat(Ac," unexpected character at position ").concat(this._pos,"; this shouldn't happen"));this._pos++;for(var t=this._pos,r=0;t<this.data.length&&r<65536;t++,r++){var n=this.data[t];if(92===n||n<32||n>=128)break;if(34===n){var i=String.fromCharCode.apply(null,this.data.subarray(this._pos,t));return this._pos=t+1,new lc(cc.string,i,r)}}for(var a=this._pos,s=[],o=function(){if(e._pos+4>=e.data.length)throw new Error("".concat(Ac," unexpected end of unicode escape sequence at position ").concat(e._pos));for(var t=0,r=0;r<4;r++){var n=e.ch();if(n>=48&&n<=57)n-=48;else if(n>=97&&n<=102)n=n-97+10;else{if(!(n>=65&&n<=70))throw new Error("".concat(Ac," unexpected unicode escape character at position ").concat(e._pos));n=n-65+10}t=16*t+n,e._pos++}return t},u=function(){var t,r,n,i,a=e.ch(),o=null,u=a>239?4:a>223?3:a>191?2:1;if(e._pos+u>e.data.length)throw new Error("".concat(Ac," unexpected unicode sequence at position ").concat(e._pos));switch(u){case 1:a<128&&(o=a);break;case 2:128===(192&(t=e.data[e._pos+1]))&&(i=(31&a)<<6|63&t)>127&&(o=i);break;case 3:t=e.data[e._pos+1],r=e.data[e._pos+2],128===(192&t)&&128===(192&r)&&(i=(15&a)<<12|(63&t)<<6|63&r)>2047&&(i<55296||i>57343)&&(o=i);break;case 4:t=e.data[e._pos+1],r=e.data[e._pos+2],n=e.data[e._pos+3],128===(192&t)&&128===(192&r)&&128===(192&n)&&(i=(15&a)<<18|(63&t)<<12|(63&r)<<6|63&n)>65535&&i<1114112&&(o=i)}null===o?(o=65533,u=1):o>65535&&(o-=65536,s.push(o>>>10&1023|55296),o=56320|1023&o),s.push(o),e._pos+=u};!this.done();){var c=this.ch(),l=void 0;switch(c){case 92:if(this._pos++,this.done())throw new Error("".concat(Ac," unexpected string termination at position ").concat(this._pos));switch(l=this.ch(),this._pos++,l){case 34:case 39:case 92:case 47:s.push(l);break;case 98:s.push(8);break;case 116:s.push(9);break;case 110:s.push(10);break;case 102:s.push(12);break;case 114:s.push(13);break;case 117:s.push(o());break;default:throw new Error("".concat(Ac," unexpected string escape character at position ").concat(this._pos))}break;case 34:return this._pos++,new lc(cc.string,Sc(s),this._pos-a);default:if(c<32)throw new Error("".concat(Ac," invalid control character at position ").concat(this._pos));c<128?(s.push(c),this._pos++):u()}}throw new Error("".concat(Ac," unexpected end of string at position ").concat(this._pos))}},{key:"parseValue",value:function(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this._pos++,new lc(cc.map,1/0,1);case 91:return this.modeStack.push("array-start"),this._pos++,new lc(cc.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new lc(cc.null,null,4);case 102:return this.expect([102,97,108,115,101]),new lc(cc.false,!1,5);case 116:return this.expect([116,114,117,101]),new lc(cc.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error("".concat(Ac," unexpected character at position ").concat(this._pos))}}},{key:"next",value:function(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":if(this.modeStack.pop(),93===this.ch())return this._pos++,this.skipWhitespace(),new lc(cc.break,void 0,1);if(44!==this.ch())throw new Error("".concat(Ac," unexpected character at position ").concat(this._pos,", was expecting array delimiter but found '").concat(String.fromCharCode(this.ch()),"'"));return this._pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue();case"array-start":return this.modeStack.pop(),93===this.ch()?(this._pos++,this.skipWhitespace(),new lc(cc.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(125===this.ch())return this.modeStack.pop(),this._pos++,this.skipWhitespace(),new lc(cc.break,void 0,1);if(44!==this.ch())throw new Error("".concat(Ac," unexpected character at position ").concat(this._pos,", was expecting object delimiter but found '").concat(String.fromCharCode(this.ch()),"'"));this._pos++,this.skipWhitespace();case"obj-start":if(this.modeStack.pop(),125===this.ch())return this._pos++,this.skipWhitespace(),new lc(cc.break,void 0,1);var e=this.parseString();if(this.skipWhitespace(),58!==this.ch())throw new Error("".concat(Ac," unexpected character at position ").concat(this._pos,", was expecting key/value delimiter ':' but found '").concat(String.fromCharCode(this.ch()),"'"));return this._pos++,this.modeStack.push("obj-value"),e;case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error("".concat(Ac," unexpected parse state at position ").concat(this._pos,"; this shouldn't happen"))}}}]),e}();function Vh(e,t){return Gl(e,t=Object.assign({tokenizer:new qh(e,t)},t))}function Kh(e){var t=Oi.encode(e).slice(1);return[new lc(cc.map,1/0,1),new lc(cc.string,"/",1),new lc(cc.map,1/0,1),new lc(cc.string,"bytes",5),new lc(cc.string,t,t.length),new lc(cc.break,void 0,1),new lc(cc.break,void 0,1)]}function Yh(e){return Kh(new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}var Gh={typeEncoders:{Object:function(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;var t=Ba.asCID(e);if(!t)return null;var r=t.toString();return[new lc(cc.map,1/0,1),new lc(cc.string,"/",1),new lc(cc.string,r,r.length),new lc(cc.break,void 0,1)]},Buffer:Kh,Uint8Array:Kh,Int8Array:Yh,Uint16Array:Yh,Int16Array:Yh,Uint32Array:Yh,Int32Array:Yh,Float32Array:Yh,Float64Array:Yh,Uint8ClampedArray:Yh,BigInt64Array:Yh,BigUint64Array:Yh,DataView:Yh,ArrayBuffer:function(e){return Kh(new Uint8Array(e))},undefined:function(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")},number:function(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}}},Qh=function(e){ia(r,e);var t=ua(r);function r(e,n){var i;return(0,hi.Z)(this,r),(i=t.call(this,e,n)).tokenBuffer=[],i}return(0,fi.Z)(r,[{key:"done",value:function(){return 0===this.tokenBuffer.length&&yo(aa(r.prototype),"done",this).call(this)}},{key:"_next",value:function(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():yo(aa(r.prototype),"next",this).call(this)}},{key:"next",value:function(){var e=this._next();if(e.type===cc.map){var t=this._next();if(t.type===cc.string&&"/"===t.value){var r=this._next();if(r.type===cc.string){if(this._next().type!==cc.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(r),new lc(cc.tag,42,0)}if(r.type===cc.map){var n=this._next();if(n.type===cc.string&&"bytes"===n.value){var i=this._next();if(i.type===cc.string){for(var a=0;a<2;a++){if(this._next().type!==cc.break)throw new Error("Invalid encoded Bytes form")}var s=Oi.decode("m".concat(i.value));return new lc(cc.bytes,s,i.value.length)}this.tokenBuffer.push(i)}this.tokenBuffer.push(n)}this.tokenBuffer.push(r)}this.tokenBuffer.push(t)}return e}}]),r}(qh),Xh={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};Xh.tags[42]=Ba.parse;var Jh="dag-json",$h=297,ef=function(e){return t=e,r=Gh,r=Object.assign({},Wh,r),zl(t,new Hh,r);var t,r},tf=function(e){return Vh(e,Object.assign(Xh,{tokenizer:new Qh(e,Xh)}))},rf=function(e){return nf.decode(ef(e))},nf=new TextDecoder,af=function(e){return tf(sf.encode(e))},sf=new TextEncoder,of=new TextDecoder;function uf(e,t){for(var r=0,n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(t>=e.length)throw new Error("protobuf: unexpected end of data");var i=e[t++];if(r+=n<28?(127&i)<<n:(127&i)*Math.pow(2,n),i<128)break}return[r,t]}function cf(e,t){var r,n=uf(e,t),i=(0,ke.Z)(n,2);r=i[0];var a=(t=i[1])+r;if(r<0||a<0)throw new Error("protobuf: invalid length");if(a>e.length)throw new Error("protobuf: unexpected end of data");return[e.subarray(t,a),a]}function lf(e,t){var r,n=uf(e,t),i=(0,ke.Z)(n,2);return[7&(r=i[0]),r>>3,t=i[1]]}function hf(e){for(var t={},r=e.length,n=0;n<r;){var i,a,s=lf(e,n),o=(0,ke.Z)(s,3);if(i=o[0],a=o[1],n=o[2],1===a){if(t.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(2!==i)throw new Error("protobuf: (PBLink) wrong wireType (".concat(i,") for Hash"));if(void 0!==t.Name)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");var u=cf(e,n),c=(0,ke.Z)(u,2);t.Hash=c[0],n=c[1]}else if(2===a){if(void 0!==t.Name)throw new Error("protobuf: (PBLink) duplicate Name section");if(2!==i)throw new Error("protobuf: (PBLink) wrong wireType (".concat(i,") for Name"));if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");var l,h=cf(e,n),f=(0,ke.Z)(h,2);l=f[0],n=f[1],t.Name=of.decode(l)}else{if(3!==a)throw new Error("protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ".concat(a));if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(0!==i)throw new Error("protobuf: (PBLink) wrong wireType (".concat(i,") for Tsize"));var d=uf(e,n),p=(0,ke.Z)(d,2);t.Tsize=p[0],n=p[1]}}if(n>r)throw new Error("protobuf: (PBLink) unexpected end of data");return t}var ff=new TextEncoder,df=Math.pow(2,32),pf=Math.pow(2,31);function vf(e,t){var r=t.length;if("number"===typeof e.Tsize){if(e.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(e.Tsize))throw new Error("Tsize too large for encoding");t[r=mf(t,r,e.Tsize)-1]=24}if("string"===typeof e.Name){var n=ff.encode(e.Name);r-=n.length,t.set(n,r),t[r=mf(t,r,n.length)-1]=18}return e.Hash&&(r-=e.Hash.length,t.set(e.Hash,r),t[r=mf(t,r,e.Hash.length)-1]=10),t.length-r}function gf(e){var t=function(e){var t=0;if(e.Data){var r=e.Data.length;t+=1+r+bf(r)}if(e.Links){var n,i=(0,ge.Z)(e.Links);try{for(i.s();!(n=i.n()).done;){var a=yf(n.value);t+=1+a+bf(a)}}catch(S$){i.e(S$)}finally{i.f()}}return t}(e),r=new Uint8Array(t),n=t;if(e.Data&&(n-=e.Data.length,r.set(e.Data,n),r[n=mf(r,n,e.Data.length)-1]=10),e.Links)for(var i=e.Links.length-1;i>=0;i--){var a=vf(e.Links[i],r.subarray(0,n));r[n=mf(r,n-=a,a)-1]=18}return r}function yf(e){var t=0;if(e.Hash){var r=e.Hash.length;t+=1+r+bf(r)}if("string"===typeof e.Name){var n=ff.encode(e.Name).length;t+=1+n+bf(n)}return"number"===typeof e.Tsize&&(t+=1+bf(e.Tsize)),t}function mf(e,t,r){for(var n=t-=bf(r);r>=pf;)e[t++]=127&r|128,r/=128;for(;r>=128;)e[t++]=127&r|128,r>>>=7;return e[t]=r,n}function bf(e){return e%2===0&&e++,Math.floor((function(e){var t=0;e>=df&&(e=Math.floor(e/df),t=32);e>=65536&&(e>>>=16,t+=16);e>=256&&(e>>>=8,t+=8);return t+_f[e]}(e)+6)/7)}var _f=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],wf=["Data","Links"],kf=["Hash","Name","Tsize"],xf=new TextEncoder;function Ef(e,t){if(e===t)return 0;for(var r=e.Name?xf.encode(e.Name):[],n=t.Name?xf.encode(t.Name):[],i=r.length,a=n.length,s=0,o=Math.min(i,a);s<o;++s)if(r[s]!==n[s]){i=r[s],a=n[s];break}return i<a?-1:a<i?1:0}function Sf(e,t){return!Object.keys(e).some((function(e){return!t.includes(e)}))}function Cf(e){if("object"===typeof e.asCID){var t=Ba.asCID(e);if(!t)throw new TypeError("Invalid DAG-PB form");return{Hash:t}}if("object"!==typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");var r={};if(e.Hash){var n=Ba.asCID(e.Hash);try{n||("string"===typeof e.Hash?n=Ba.parse(e.Hash):e.Hash instanceof Uint8Array&&(n=Ba.decode(e.Hash)))}catch(i){throw new TypeError("Invalid DAG-PB form: ".concat(i.message))}n&&(r.Hash=n)}if(!r.Hash)throw new TypeError("Invalid DAG-PB form");return"string"===typeof e.Name&&(r.Name=e.Name),"number"===typeof e.Tsize&&(r.Tsize=e.Tsize),r}function Af(e){if((e instanceof Uint8Array||"string"===typeof e)&&(e={Data:e}),"object"!==typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");var t={};if(void 0!==e.Data)if("string"===typeof e.Data)t.Data=xf.encode(e.Data);else{if(!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form");t.Data=e.Data}if(void 0!==e.Links){if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form");t.Links=e.Links.map(Cf),t.Links.sort(Ef)}else t.Links=[];return t}function Df(e){if(!e||"object"!==typeof e||Array.isArray(e)||e instanceof Uint8Array||e["/"]&&e["/"]===e.bytes)throw new TypeError("Invalid DAG-PB form");if(!Sf(e,wf))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(void 0!==e.Data&&!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(var t=0;t<e.Links.length;t++){var r=e.Links[t];if(!r||"object"!==typeof r||Array.isArray(r)||r instanceof Uint8Array||r["/"]&&r["/"]===r.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!Sf(r,kf))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(void 0===r.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(null==r.Hash||!r.Hash["/"]||r.Hash["/"]!==r.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(void 0!==r.Name&&"string"!==typeof r.Name)throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(void 0!==r.Tsize){if("number"!==typeof r.Tsize||r.Tsize%1!==0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(r.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(t>0&&-1===Ef(r,e.Links[t-1]))throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function Rf(e){return Af({Data:e,Links:arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]})}function Tf(e,t,r){return Cf({Hash:r,Name:e,Tsize:t})}var Zf="dag-pb",If=112;function Pf(e){Df(e);var t={};return e.Links&&(t.Links=e.Links.map((function(e){var t={};return e.Hash&&(t.Hash=e.Hash.bytes),void 0!==e.Name&&(t.Name=e.Name),void 0!==e.Tsize&&(t.Tsize=e.Tsize),t}))),e.Data&&(t.Data=e.Data),gf(t)}function Lf(e){var t=function(e){for(var t=e.length,r=0,n=void 0,i=!1,a=void 0;r<t;){var s,o,u=lf(e,r),c=(0,ke.Z)(u,3);if(s=c[0],o=c[1],r=c[2],2!==s)throw new Error("protobuf: (PBNode) invalid wireType, expected 2, got ".concat(s));if(1===o){if(a)throw new Error("protobuf: (PBNode) duplicate Data section");var l=cf(e,r),h=(0,ke.Z)(l,2);a=h[0],r=h[1],n&&(i=!0)}else{if(2!==o)throw new Error("protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ".concat(o));if(i)throw new Error("protobuf: (PBNode) duplicate Links section");n||(n=[]);var f,d=cf(e,r),p=(0,ke.Z)(d,2);f=p[0],r=p[1],n.push(hf(f))}}if(r>t)throw new Error("protobuf: (PBNode) unexpected end of data");var v={};return a&&(v.Data=a),v.Links=n||[],v}(e),r={};return t.Data&&(r.Data=t.Data),t.Links&&(r.Links=t.Links.map((function(e){var t={};try{t.Hash=Ba.decode(e.Hash)}catch(r){}if(!t.Hash)throw new Error("Invalid Hash field found in link, expected CID");return void 0!==e.Name&&(t.Name=e.Name),void 0!==e.Tsize&&(t.Tsize=e.Tsize),t}))),r}var Mf={codec:If,walk:function(e){return ea((0,ii.Z)().mark((function t(){var r;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Lf(e),t.delegateYield(Xa(ui(r.Links.map((function(e){return e.Hash})))),"t0",2);case 2:case"end":return t.stop()}}),t)})))()}},Bf={codec:qa,walk:function(){return ea((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()}},Of={codec:Uh,walk:function(e){return ea((0,ii.Z)().mark((function t(){var r,n;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=[],(n=[])[42]=function(e){if(0!==e[0])throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");var t=Ba.decode(e.subarray(1));return r.push(t),t},Gl(e,{tags:n}),t.delegateYield(Xa(ui(r)),"t0",5);case 5:case"end":return t.stop()}}),t)})))()}},Nf=function(e){ia(r,e);var t=ua(r);function r(e,n){var i;return(0,hi.Z)(this,r),i=t.call(this,e,n),(0,we.Z)(ra(i),"tokenBuffer",void 0),i.tokenBuffer=[],i}return(0,fi.Z)(r,[{key:"done",value:function(){return 0===this.tokenBuffer.length&&yo(aa(r.prototype),"done",this).call(this)}},{key:"_next",value:function(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():yo(aa(r.prototype),"next",this).call(this)}},{key:"next",value:function(){var e=this._next();if(e.type===cc.map){var t=this._next();if(t.type===cc.string&&"/"===t.value){var r=this._next();if(r.type===cc.string){if(this._next().type!==cc.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(r),new lc(cc.tag,42,0)}if(r.type===cc.map){var n=this._next();if(n.type===cc.string&&"bytes"===n.value){var i=this._next();if(i.type===cc.string){for(var a=0;a<2;a++){if(this._next().type!==cc.break)throw new Error("Invalid encoded Bytes form")}var s=Oi.decode("m".concat(i.value));return new lc(cc.bytes,s,i.value.length)}this.tokenBuffer.push(i)}this.tokenBuffer.push(n)}this.tokenBuffer.push(r)}this.tokenBuffer.push(t)}return e}}]),r}(qh),Ff={codec:$h,walk:function(e){return ea((0,ii.Z)().mark((function t(){var r,n;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=[],(n=[])[42]=function(e){var t=Ba.parse(e);return r.push(t),t},Vh(e,{tags:n,tokenizer:new Nf(e,{tags:n,allowIndefinite:!0,allowUndefined:!0,allowNaN:!0,allowInfinity:!0,allowBigInt:!0,strict:!1,rejectDuplicateMapKeys:!1})}),t.delegateYield(Xa(ui(r)),"t0",5);case 5:case"end":return t.stop()}}),t)})))()}},Uf=[Bf,Mf,Of,Ff,{codec:Ss,walk:function(){return ea((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()}}],zf="/pin/",jf="/pinned-block/",Hf=ms;function Wf(e){return 0===e.version&&(e=e.toV1()),new Ys("".concat(zf).concat(e.toString(Hf)))}var qf=new WeakSet,Vf=new WeakSet,Kf=function(){function e(t,r,n){var i=this;(0,hi.Z)(this,e),ic(this,Vf),ic(this,qf),(0,we.Z)(this,"datastore",void 0),(0,we.Z)(this,"blockstore",void 0),(0,we.Z)(this,"dagWalkers",void 0),this.datastore=t,this.blockstore=r,this.dagWalkers={},[].concat(Uf,be(n)).forEach((function(e){i.dagWalkers[e.codec]=e}))}return(0,fi.Z)(e,[{key:"add",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c,l=this,h=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=h.length>1&&void 0!==h[1]?h[1]:{},a=Wf(t),e.next=4,this.datastore.has(a);case 4:if(!e.sent){e.next=6;break}throw new Error("Already pinned");case 6:if(!((s=Math.round(null!==(r=i.depth)&&void 0!==r?r:1/0))<0)){e.next=9;break}throw new Error("Depth must be greater than or equal to 0");case 9:return(o=new Bh({concurrency:1})).add((0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ac(l,qf,Yf).call(l,t,o,(function(e){null==e.pinnedBy.find((function(e){return Ao(e,t.bytes)}))&&(e.pinCount++,e.pinnedBy.push(t.bytes))}),(0,_e.Z)((0,_e.Z)({},i),{},{depth:s}));case 2:case"end":return e.stop()}}),e)})))),u=ts(),o.on("error",(function(e){o.clear(),u.reject(e)})),e.next=15,Promise.race([o.onIdle(),u.promise]);case 15:return c={depth:s,metadata:null!==(n=i.metadata)&&void 0!==n?n:{}},e.next=18,this.datastore.put(a,jl(c),i);case 18:return e.abrupt("return",(0,_e.Z)({cid:t},c));case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rm",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o=this,u=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>1&&void 0!==u[1]?u[1]:{},n=Wf(t),e.next=4,this.datastore.get(n,r);case 4:return i=e.sent,a=Gl(i),e.next=8,this.datastore.delete(n,r);case 8:return(s=new Bh({concurrency:1})).add((0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ac(o,qf,Yf).call(o,t,s,(function(e){e.pinCount--,e.pinnedBy=e.pinnedBy.filter((function(e){return Ao(e,t.bytes)}))}),(0,_e.Z)((0,_e.Z)({},r),{},{depth:a.depth}));case 2:case"end":return e.stop()}}),e)})))),e.next=12,s.onIdle();case 12:return e.abrupt("return",(0,_e.Z)({cid:t},a));case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"ls",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ea((0,ii.Z)().mark((function r(){var n,i,a,s,o,u,c,l,h,f;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=!1,i=!1,r.prev=2,s=ui(e.datastore.query({prefix:zf+(null!=t.cid?"".concat(t.cid.toString(ms)):"")},t));case 4:return r.next=6,Ji(s.next());case 6:if(!(n=!(o=r.sent).done)){r.next=15;break}return u=o.value,c=u.key,l=u.value,h=Ba.parse(c.toString().substring(5),ms),f=Gl(l),r.next=12,(0,_e.Z)({cid:h},f);case 12:n=!1,r.next=4;break;case 15:r.next=21;break;case 17:r.prev=17,r.t0=r.catch(2),i=!0,a=r.t0;case 21:if(r.prev=21,r.prev=22,!n||null==s.return){r.next=26;break}return r.next=26,Ji(s.return());case 26:if(r.prev=26,!i){r.next=29;break}throw a;case 29:return r.finish(26);case 30:return r.finish(21);case 31:case"end":return r.stop()}}),r,null,[[2,17,21,31],[22,,26,30]])})))()}},{key:"isPinned",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{},n=new Ys("".concat(jf).concat(Hf.encode(t.multihash.bytes))),e.abrupt("return",this.datastore.has(n,r));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function Yf(e,t,r,n){return Gf.apply(this,arguments)}function Gf(){return Gf=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i){var a,s,o,u,c,l,h,f,d=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1!==i.depth){e.next=2;break}return e.abrupt("return");case 2:if(null!=(a=this.dagWalkers[t.code])){e.next=5;break}throw new Error("No dag walker found for cid codec ".concat(t.code));case 5:return e.next=7,this.blockstore.get(t,i);case 7:return s=e.sent,e.next=10,ac(this,Vf,Qf).call(this,t,n,i);case 10:o=!1,u=!1,e.prev=12,l=(0,ii.Z)().mark((function e(){var t;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=f.value,r.add((0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ac(d,qf,Yf).call(d,t,r,n,(0,_e.Z)((0,_e.Z)({},i),{},{depth:i.depth-1}));case 2:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e)})),h=ui(a.walk(s));case 15:return e.next=17,h.next();case 17:if(!(o=!(f=e.sent).done)){e.next=22;break}return e.delegateYield(l(),"t0",19);case 19:o=!1,e.next=15;break;case 22:e.next=28;break;case 24:e.prev=24,e.t1=e.catch(12),u=!0,c=e.t1;case 28:if(e.prev=28,e.prev=29,!o||null==h.return){e.next=33;break}return e.next=33,h.return();case 33:if(e.prev=33,!u){e.next=36;break}throw c;case 36:return e.finish(33);case 37:return e.finish(28);case 38:case"end":return e.stop()}}),e,this,[[12,24,28,38],[29,,33,37]])}))),Gf.apply(this,arguments)}function Qf(e,t,r){return Xf.apply(this,arguments)}function Xf(){return Xf=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new Ys("".concat(jf).concat(Hf.encode(t.multihash.bytes))),s={pinCount:0,pinnedBy:[]},e.prev=2,e.t0=v,e.next=6,this.datastore.get(a,n);case 6:e.t1=e.sent,s=e.t0.decode.call(e.t0,e.t1),e.next=14;break;case 10:if(e.prev=10,e.t2=e.catch(2),"ERR_NOT_FOUND"===e.t2.code){e.next=14;break}throw e.t2;case 14:if(r(s),0!==s.pinCount){e.next=22;break}return e.next=18,this.datastore.has(a);case 18:if(!e.sent){e.next=22;break}return e.next=21,this.datastore.delete(a);case 21:return e.abrupt("return");case 22:return e.next=24,this.datastore.put(a,jl(s),n);case 24:null===(i=n.onProgress)||void 0===i||i.call(n,new Ou("helia:pin:add",{detail:t}));case 25:case"end":return e.stop()}}),e,this,[[2,10]])}))),Xf.apply(this,arguments)}var Jf=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),(n=t.call(this,e)).name="TimeoutError",n}return(0,fi.Z)(r)}(es(Error)),$f=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),(n=t.call(this)).name="AbortError",n.message=e,n}return(0,fi.Z)(r)}(es(Error)),ed=function(e){return void 0===globalThis.DOMException?new $f(e):new DOMException(e)},td=function(e){var t=void 0===e.reason?ed("This operation was aborted."):e.reason;return t instanceof Error?t:ed(t)};function rd(e,t){var r,n=t.milliseconds,i=t.fallback,a=t.message,s=t.customTimers,o=void 0===s?{setTimeout:setTimeout,clearTimeout:clearTimeout}:s,u=new Promise((function(s,u){if("number"!==typeof n||1!==Math.sign(n))throw new TypeError("Expected `milliseconds` to be a positive number, got `".concat(n,"`"));if(t.signal){var c=t.signal;c.aborted&&u(td(c)),c.addEventListener("abort",(function(){u(td(c))}))}if(n!==Number.POSITIVE_INFINITY){var l=new Jf;r=o.setTimeout.call(void 0,(function(){if(i)try{s(i())}catch(t){u(t)}else"function"===typeof e.cancel&&e.cancel(),!1===a?s():a instanceof Error?u(a):(l.message=null!==a&&void 0!==a?a:"Promise timed out after ".concat(n," milliseconds"),u(l))}),n),(0,ai.Z)((0,ii.Z)().mark((function t(){return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=s,t.next=4,e;case 4:t.t1=t.sent,(0,t.t0)(t.t1),t.next=11;break;case 8:t.prev=8,t.t2=t.catch(0),u(t.t2);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()}else e.then(s,u)})),c=u.finally((function(){c.clear()}));return c.clear=function(){o.clearTimeout.call(void 0,r),r=void 0},c}var nd="lock:worker:request-read",id="lock:worker:release-read",ad="lock:master:grant-read",sd="lock:worker:request-write",od="lock:worker:release-write",ud="lock:master:grant-write",cd={},ld=function e(t){t.addEventListener("message",(function(r){e.dispatchEvent("message",t,r)})),null!=t.port&&t.port.addEventListener("message",(function(r){e.dispatchEvent("message",t,r)}))};ld.addEventListener=function(e,t){null==cd[e]&&(cd[e]=[]),cd[e].push(t)},ld.removeEventListener=function(e,t){null!=cd[e]&&(cd[e]=cd[e].filter((function(e){return e===t})))},ld.dispatchEvent=function(e,t,r){null!=cd[e]&&cd[e].forEach((function(e){return e(t,r)}))};var hd,fd=ld,dd=function(e,t,r,n,i){return function(a,s){if(s.data.type===r){var o={type:s.data.type,name:s.data.name,identifier:s.data.identifier};e.dispatchEvent(new MessageEvent(t,{data:{name:o.name,handler:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.postMessage({type:i,name:o.name,identifier:o.identifier}),e.next=3,new Promise((function(e){a.addEventListener("message",(function t(r){if(null!=r&&null!=r.data){var i=r.data.type,s=(r.data.name,r.data.identifier);i===n&&s===o.identifier&&(a.removeEventListener("message",t),e())}}))}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}))}}},pd=function(e,t,r,n){return(0,ai.Z)((0,ii.Z)().mark((function i(){var a;return(0,ii.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return a=us(),globalThis.postMessage({type:t,identifier:a,name:e}),i.next=4,new Promise((function(t){globalThis.addEventListener("message",(function i(s){if(null!=s&&null!=s.data){var o=s.data.type,u=s.data.identifier;o===r&&u===a&&(globalThis.removeEventListener("message",i),t((function(){globalThis.postMessage({type:n,identifier:a,name:e})})))}}))}));case 4:return i.abrupt("return",i.sent);case 5:case"end":return i.stop()}}),i)})))},vd={singleProcess:!1},gd={};function yd(e,t){return md.apply(this,arguments)}function md(){return md=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new Promise((function(e){n=e})),t.add((0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rd((0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){n((function(){e()}))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))(),{milliseconds:r.timeout});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))),e.next=4,i;case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)}))),md.apply(this,arguments)}var bd={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function _d(e){var t=Object.assign({},bd,e);return null==hd&&(hd=function(e){if(e=Object.assign({},vd,e),Boolean(globalThis.document)||e.singleProcess){var t=new EventTarget;return fd.addEventListener("message",dd(t,"requestReadLock",nd,id,ad)),fd.addEventListener("message",dd(t,"requestWriteLock",sd,od,ud)),t}return{isWorker:!0,readLock:function(e){return pd(e,nd,ad,id)},writeLock:function(e){return pd(e,sd,ud,od)}}}(t),!0!==hd.isWorker&&(hd.addEventListener("requestReadLock",(function(e){null!=gd[e.data.name]&&gd[e.data.name].readLock().then(function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(r){return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.data.handler().finally((function(){return r()}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())})),hd.addEventListener("requestWriteLock",function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=gd[t.data.name]){e.next=2;break}return e.abrupt("return");case 2:gd[t.data.name].writeLock().then(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(r){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.data.handler().finally((function(){return r()}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))),null==gd[t.name]&&(gd[t.name]=function(e,t){if(!0===hd.isWorker)return{readLock:hd.readLock(e,t),writeLock:hd.writeLock(e,t)};var r,n=new Bh({concurrency:1});return{readLock:function(){return(0,ai.Z)((0,ii.Z)().mark((function e(){var i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==r){e.next=4;break}return e.next=3,yd(r,t);case 3:case 10:return e.abrupt("return",e.sent);case 4:return r=new Bh({concurrency:t.concurrency,autoStart:!1}),i=r,a=yd(r,t),n.add((0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.start(),e.next=3,i.onIdle().then((function(){r===i&&(r=null)}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))),e.next=10,a;case 11:case"end":return e.stop()}}),e)})))()},writeLock:function(){return(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,e.next=3,yd(n,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))()}}}(t.name,t)),gd[t.name]}var wd=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,hi.Z)(this,e),(0,we.Z)(this,"lock",void 0),(0,we.Z)(this,"child",void 0),(0,we.Z)(this,"pins",void 0),this.child=t,this.pins=r,this.lock=_d({singleProcess:n.holdGcLock})}return(0,fi.Z)(e,[{key:"unwrap",value:function(){return this.child}},{key:"put",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>2&&void 0!==a[2]?a[2]:{},e.next=3,this.lock.readLock();case 3:return i=e.sent,e.prev=4,e.next=7,this.child.put(t,r,n);case 7:return e.abrupt("return",e.sent);case 8:return e.prev=8,i(),e.finish(8);case 11:case"end":return e.stop()}}),e,this,[[4,,8,11]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"putMany",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){var i;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Ji(t.lock.readLock());case 2:return i=n.sent,n.prev=3,n.delegateYield(Xa(ui(t.child.putMany(e,r))),"t0",5);case 5:return n.prev=5,i(),n.finish(5);case 8:case"end":return n.stop()}}),n,null,[[3,,5,8]])})))()}},{key:"get",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{},e.next=3,this.lock.readLock();case 3:return n=e.sent,e.prev=4,e.next=7,this.child.get(t,r);case 7:return e.abrupt("return",e.sent);case 8:return e.prev=8,n(),e.finish(8);case 11:case"end":return e.stop()}}),e,this,[[4,,8,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getMany",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){var i;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Ji(t.lock.readLock());case 2:return i=n.sent,n.prev=3,n.delegateYield(Xa(ui(t.child.getMany(e,r))),"t0",5);case 5:return n.prev=5,i(),n.finish(5);case 8:case"end":return n.stop()}}),n,null,[[3,,5,8]])})))()}},{key:"delete",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{},e.next=3,this.lock.writeLock();case 3:return n=e.sent,e.prev=4,e.next=7,this.pins.isPinned(t);case 7:if(!e.sent){e.next=9;break}throw new Error("CID was pinned");case 9:return e.next=11,this.child.delete(t,r);case 11:return e.prev=11,n(),e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[4,,11,14]])})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteMany",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){var i,a;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Ji(t.lock.writeLock());case 2:return i=n.sent,n.prev=3,a=t,n.delegateYield(Xa(ui(t.child.deleteMany(ea((0,ii.Z)().mark((function t(){var r,n,i,s,o,u;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=!1,n=!1,t.prev=2,s=ui(e);case 4:return t.next=6,Ji(s.next());case 6:if(!(r=!(o=t.sent).done)){t.next=17;break}return u=o.value,t.next=10,Ji(a.pins.isPinned(u));case 10:if(!t.sent){t.next=12;break}throw new Error("CID was pinned");case 12:return t.next=14,u;case 14:r=!1,t.next=4;break;case 17:t.next=23;break;case 19:t.prev=19,t.t0=t.catch(2),n=!0,i=t.t0;case 23:if(t.prev=23,t.prev=24,!r||null==s.return){t.next=28;break}return t.next=28,Ji(s.return());case 28:if(t.prev=28,!n){t.next=31;break}throw i;case 31:return t.finish(28);case 32:return t.finish(23);case 33:case"end":return t.stop()}}),t,null,[[2,19,23,33],[24,,28,32]])})))(),r))),"t0",6);case 6:return n.prev=6,i(),n.finish(6);case 9:case"end":return n.stop()}}),n,null,[[3,,6,9]])})))()}},{key:"has",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{},e.next=3,this.lock.readLock();case 3:return n=e.sent,e.prev=4,e.next=7,this.child.has(t,r);case 7:return e.abrupt("return",e.sent);case 8:return e.prev=8,n(),e.finish(8);case 11:case"end":return e.stop()}}),e,this,[[4,,8,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getAll",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ea((0,ii.Z)().mark((function r(){var n;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Ji(e.lock.readLock());case 2:return n=r.sent,r.prev=3,r.delegateYield(Xa(ui(e.child.getAll(t))),"t0",5);case 5:return r.prev=5,n(),r.finish(5);case 8:case"end":return r.stop()}}),r,null,[[3,,5,8]])})))()}}]),e}(),kd=new Ys("/version"),xd=1;function Ed(e){return Sd.apply(this,arguments)}function Sd(){return Sd=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.has(kd);case 2:if(e.sent){e.next=6;break}return e.next=5,t.put(kd,Hs("".concat(xd)));case 5:return e.abrupt("return");case 6:return e.next=8,t.get(kd);case 8:if(r=e.sent,n=Ws(r),parseInt(n,10)===xd){e.next=13;break}throw new Error("Unknown datastore version, a datastore migration may be required");case 13:case"end":return e.stop()}}),e)}))),Sd.apply(this,arguments)}var Cd=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,hi.Z)(this,e),(0,we.Z)(this,"child",void 0),(0,we.Z)(this,"bitswap",void 0),this.child=t,this.bitswap=r.bitswap}return(0,fi.Z)(e,[{key:"unwrap",value:function(){return this.child}},{key:"put",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=u.length>2&&void 0!==u[2]?u[2]:{},e.next=3,this.child.has(t);case 3:if(!e.sent){e.next=6;break}return null===(s=a.onProgress)||void 0===s||s.call(a,new Ou("blocks:put:duplicate",t)),e.abrupt("return",t);case 6:return!0===(null===(n=this.bitswap)||void 0===n?void 0:n.isStarted())&&(null===(o=a.onProgress)||void 0===o||o.call(a,new Ou("blocks:put:bitswap:notify",t)),this.bitswap.notify(t,r,a)),null===(i=a.onProgress)||void 0===i||i.call(a,new Ou("blocks:put:blockstore:put",t)),e.abrupt("return",this.child.put(t,r,a));case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"putMany",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){var i,a,s;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=Qa(e,function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(n){var i,a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.cid,e.next=3,t.child.has(i);case 3:return(a=e.sent)&&(null===(s=r.onProgress)||void 0===s||s.call(r,new Ou("blocks:put-many:duplicate",i))),e.abrupt("return",!a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),s=go(a,(function(e){var n,i,a=e.cid,s=e.block;null===(n=r.onProgress)||void 0===n||n.call(r,new Ou("blocks:put-many:bitswap:notify",a)),null===(i=t.bitswap)||void 0===i||i.notify(a,s,r)})),null===(i=r.onProgress)||void 0===i||i.call(r,new Ou("blocks:put-many:blockstore:put-many")),n.delegateYield(Xa(ui(t.child.putMany(s,r))),"t0",4);case 4:case"end":return n.stop()}}),n)})))()}},{key:"get",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=u.length>1&&void 0!==u[1]?u[1]:{},e.t0=!0!==i.offline&&null!=(null===(r=this.bitswap)||void 0===r?void 0:r.isStarted()),!e.t0){e.next=6;break}return e.next=5,this.child.has(t);case 5:e.t0=!e.sent;case 6:if(!e.t0){e.next=15;break}return null===(a=i.onProgress)||void 0===a||a.call(i,new Ou("blocks:get:bitswap:get",t)),e.next=10,this.bitswap.want(t,i);case 10:return o=e.sent,null===(s=i.onProgress)||void 0===s||s.call(i,new Ou("blocks:get:blockstore:put",t)),e.next=14,this.child.put(t,o,i);case 14:return e.abrupt("return",o);case 15:return null===(n=i.onProgress)||void 0===n||n.call(i,new Ou("blocks:get:blockstore:get",t)),e.abrupt("return",this.child.get(t,i));case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getMany",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){var i;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return null===(i=r.onProgress)||void 0===i||i.call(r,new Ou("blocks:get-many:blockstore:get-many")),n.delegateYield(Xa(ui(t.child.getMany(go(e,function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(n){var i,a,s,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!0!==r.offline&&!0===(null===(i=t.bitswap)||void 0===i?void 0:i.isStarted()),!e.t0){e.next=5;break}return e.next=4,t.child.has(n);case 4:e.t0=!e.sent;case 5:if(!e.t0){e.next=13;break}return null===(a=r.onProgress)||void 0===a||a.call(r,new Ou("blocks:get-many:bitswap:get",n)),e.next=9,t.bitswap.want(n,r);case 9:return o=e.sent,null===(s=r.onProgress)||void 0===s||s.call(r,new Ou("blocks:get-many:blockstore:put",n)),e.next=13,t.child.put(n,o,r);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())))),"t0",2);case 2:case"end":return n.stop()}}),n)})))()}},{key:"delete",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(r=(n=i.length>1&&void 0!==i[1]?i[1]:{}).onProgress)||void 0===r||r.call(n,new Ou("blocks:delete:blockstore:delete",t)),e.next=4,this.child.delete(t,n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteMany",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){var i;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return null===(i=r.onProgress)||void 0===i||i.call(r,new Ou("blocks:delete-many:blockstore:delete-many")),n.delegateYield(Xa(ui(t.child.deleteMany(ea((0,ii.Z)().mark((function t(){var r,n,i,a,s,o;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=!1,n=!1,t.prev=2,a=ui(e);case 4:return t.next=6,Ji(a.next());case 6:if(!(r=!(s=t.sent).done)){t.next=13;break}return o=s.value,t.next=10,o;case 10:r=!1,t.next=4;break;case 13:t.next=19;break;case 15:t.prev=15,t.t0=t.catch(2),n=!0,i=t.t0;case 19:if(t.prev=19,t.prev=20,!r||null==a.return){t.next=24;break}return t.next=24,Ji(a.return());case 24:if(t.prev=24,!n){t.next=27;break}throw i;case 27:return t.finish(24);case 28:return t.finish(19);case 29:case"end":return t.stop()}}),t,null,[[2,15,19,29],[20,,24,28]])})))(),r))),"t0",2);case 2:case"end":return n.stop()}}),n)})))()}},{key:"has",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:{},e.abrupt("return",this.child.has(t,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAll",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ea((0,ii.Z)().mark((function r(){var n;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return null===(n=t.onProgress)||void 0===n||n.call(t,new Ou("blocks:get-all:blockstore:get-many")),r.delegateYield(Xa(ui(e.child.getAll(t))),"t0",2);case 2:case"end":return r.stop()}}),r)})))()}}]),e}(),Ad=zi("helia"),Dd=new WeakMap,Rd=function(){function e(t){var r,n;(0,hi.Z)(this,e),(0,we.Z)(this,"libp2p",void 0),(0,we.Z)(this,"blockstore",void 0),(0,we.Z)(this,"datastore",void 0),(0,we.Z)(this,"pins",void 0),lo(this,Dd,{writable:!0,value:void 0});var i=[Ps,Ls,Rs].concat(be(null!==(r=t.hashers)&&void 0!==r?r:[]));po(this,Dd,function(e,t){return new nc(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}(t.libp2p,t.blockstore,{hashLoader:{getHasher:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(r=i.find((function(e){return e.code===t||e.name===t})))){e.next=3;break}return e.abrupt("return",r);case 3:throw new Error('Could not load hasher for code/name "'.concat(t,'"'));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}));var a=new Cd(t.blockstore,{bitswap:fo(this,Dd)});this.pins=new Kf(t.datastore,a,null!==(n=t.dagWalkers)&&void 0!==n?n:[]),this.libp2p=t.libp2p,this.blockstore=new wd(a,this.pins,{holdGcLock:t.holdGcLock}),this.datastore=t.datastore}return(0,fi.Z)(e,[{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ed(this.datastore);case 2:return e.next=4,null===(t=fo(this,Dd))||void 0===t?void 0:t.start();case 4:return e.next=6,this.libp2p.start();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.libp2p.stop();case 2:return e.next=4,null===(t=fo(this,Dd))||void 0===t?void 0:t.stop();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"gc",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i,a=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},e.next=3,this.blockstore.lock.writeLock();case 3:return r=e.sent,e.prev=4,n=this,i=this.blockstore.unwrap(),Ad("gc start"),e.next=10,Qs(i.deleteMany(ea((0,ii.Z)().mark((function e(){var r,a,s,o,u,c,l,h;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!1,a=!1,e.prev=2,o=ui(i.getAll());case 4:return e.next=6,Ji(o.next());case 6:if(!(r=!(u=e.sent).done)){e.next=25;break}return c=u.value.cid,e.prev=8,e.next=11,Ji(n.pins.isPinned(c,t));case 11:if(!e.sent){e.next=13;break}return e.abrupt("continue",22);case 13:return e.next=15,c;case 15:null===(l=t.onProgress)||void 0===l||l.call(t,new Ou("helia:gc:deleted",c)),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(8),Ad.error("Error during gc",e.t0),null===(h=t.onProgress)||void 0===h||h.call(t,new Ou("helia:gc:error",e.t0));case 22:r=!1,e.next=4;break;case 25:e.next=31;break;case 27:e.prev=27,e.t1=e.catch(2),a=!0,s=e.t1;case 31:if(e.prev=31,e.prev=32,!r||null==o.return){e.next=36;break}return e.next=36,Ji(o.return());case 36:if(e.prev=36,!a){e.next=39;break}throw s;case 39:return e.finish(36);case 40:return e.finish(31);case 41:case"end":return e.stop()}}),e,null,[[2,27,31,41],[8,18],[32,,36,40]])})))()));case 10:return e.prev=10,r(),e.finish(10);case 13:Ad("gc finished");case 14:case"end":return e.stop()}}),e,this,[[4,,10,13]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),Td=(__webpack_require__(5049),__webpack_require__(9835),__webpack_require__(392));function Zd(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("Wrong positive integer: ".concat(e))}function Id(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(r.length>0&&!r.includes(e.length))throw new Error("Expected Uint8Array of length ".concat(r,", not of length=").concat(e.length))}function Pd(e){if("function"!==typeof e||"function"!==typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");Zd(e.outputLen),Zd(e.blockLen)}function Ld(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Md(e,t){Id(e);var r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least ".concat(r))}var Bd="object"===typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,Od=function(e){return e instanceof Uint8Array},Nd=function(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)},Fd=function(e,t){return e<<32-t|e>>>t};if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");function Ud(e){if("string"!==typeof e)throw new Error("utf8ToBytes expected string, got ".concat(typeof e));return new Uint8Array((new TextEncoder).encode(e))}function zd(e){if("string"===typeof e&&(e=Ud(e)),!Od(e))throw new Error("expected Uint8Array, got ".concat(typeof e));return e}function jd(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=new Uint8Array(t.reduce((function(e,t){return e+t.length}),0)),i=0;return t.forEach((function(e){if(!Od(e))throw new Error("Uint8Array expected");n.set(e,i),i+=e.length})),n}var Hd=function(){function e(){(0,hi.Z)(this,e)}return(0,fi.Z)(e,[{key:"clone",value:function(){return this._cloneInto()}}]),e}();function Wd(e){var t=function(t){return e().update(zd(t)).digest()},r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=function(){return e()},t}function qd(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(Bd&&"function"===typeof Bd.getRandomValues)return Bd.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}var Vd=function(e){ia(r,e);var t=ua(r);function r(e,n,i,a){var s;return(0,hi.Z)(this,r),(s=t.call(this)).blockLen=e,s.outputLen=n,s.padOffset=i,s.isLE=a,s.finished=!1,s.length=0,s.pos=0,s.destroyed=!1,s.buffer=new Uint8Array(e),s.view=Nd(s.buffer),s}return(0,fi.Z)(r,[{key:"update",value:function(e){Ld(this);for(var t=this.view,r=this.buffer,n=this.blockLen,i=(e=zd(e)).length,a=0;a<i;){var s=Math.min(n-this.pos,i-a);if(s!==n)r.set(e.subarray(a,a+s),this.pos),this.pos+=s,a+=s,this.pos===n&&(this.process(t,0),this.pos=0);else for(var o=Nd(e);n<=i-a;a+=n)this.process(o,a)}return this.length+=e.length,this.roundClean(),this}},{key:"digestInto",value:function(e){Ld(this),Md(e,this),this.finished=!0;var t=this.buffer,r=this.view,n=this.blockLen,i=this.isLE,a=this.pos;t[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>n-a&&(this.process(r,0),a=0);for(var s=a;s<n;s++)t[s]=0;!function(e,t,r,n){if("function"===typeof e.setBigUint64)return e.setBigUint64(t,r,n);var i=BigInt(32),a=BigInt(4294967295),s=Number(r>>i&a),o=Number(r&a),u=n?4:0,c=n?0:4;e.setUint32(t+u,s,n),e.setUint32(t+c,o,n)}(r,n-8,BigInt(8*this.length),i),this.process(r,0);var o=Nd(e),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");var c=u/4,l=this.get();if(c>l.length)throw new Error("_sha2: outputLen bigger than state");for(var h=0;h<c;h++)o.setUint32(4*h,l[h],i)}},{key:"digest",value:function(){var e=this.buffer,t=this.outputLen;this.digestInto(e);var r=e.slice(0,t);return this.destroy(),r}},{key:"_cloneInto",value:function(e){var t;e||(e=new this.constructor),(t=e).set.apply(t,be(this.get()));var r=this.blockLen,n=this.buffer,i=this.length,a=this.finished,s=this.destroyed,o=this.pos;return e.length=i,e.pos=o,e.finished=a,e.destroyed=s,i%r&&e.buffer.set(n),e}}]),r}(Hd),Kd=BigInt(Math.pow(2,32)-1),Yd=BigInt(32);function Gd(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?{h:Number(e&Kd),l:Number(e>>Yd&Kd)}:{h:0|Number(e>>Yd&Kd),l:0|Number(e&Kd)}}var Qd={fromBig:Gd,split:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=new Uint32Array(e.length),n=new Uint32Array(e.length),i=0;i<e.length;i++){var a=Gd(e[i],t),s=[a.h,a.l];r[i]=s[0],n[i]=s[1]}return[r,n]},toBig:function(e,t){return BigInt(e>>>0)<<Yd|BigInt(t>>>0)},shrSH:function(e,t,r){return e>>>r},shrSL:function(e,t,r){return e<<32-r|t>>>r},rotrSH:function(e,t,r){return e>>>r|t<<32-r},rotrSL:function(e,t,r){return e<<32-r|t>>>r},rotrBH:function(e,t,r){return e<<64-r|t>>>r-32},rotrBL:function(e,t,r){return e>>>r-32|t<<64-r},rotr32H:function(e,t){return t},rotr32L:function(e,t){return e},rotlSH:function(e,t,r){return e<<r|t>>>32-r},rotlSL:function(e,t,r){return t<<r|e>>>32-r},rotlBH:function(e,t,r){return t<<r-32|e>>>64-r},rotlBL:function(e,t,r){return e<<r-32|t>>>64-r},add:function(e,t,r,n){var i=(t>>>0)+(n>>>0);return{h:e+r+(i/Math.pow(2,32)|0)|0,l:0|i}},add3L:function(e,t,r){return(e>>>0)+(t>>>0)+(r>>>0)},add3H:function(e,t,r,n){return t+r+n+(e/Math.pow(2,32)|0)|0},add4L:function(e,t,r,n){return(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)},add4H:function(e,t,r,n,i){return t+r+n+i+(e/Math.pow(2,32)|0)|0},add5H:function(e,t,r,n,i,a){return t+r+n+i+a+(e/Math.pow(2,32)|0)|0},add5L:function(e,t,r,n,i){return(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0)}},Xd=Qd,Jd=function(){return Xd.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((function(e){return BigInt(e)})))}(),$d=(0,ke.Z)(Jd,2),ep=$d[0],tp=$d[1],rp=new Uint32Array(80),np=new Uint32Array(80),ip=function(e){ia(r,e);var t=ua(r);function r(){var e;return(0,hi.Z)(this,r),(e=t.call(this,128,64,16,!1)).Ah=1779033703,e.Al=-205731576,e.Bh=-1150833019,e.Bl=-2067093701,e.Ch=1013904242,e.Cl=-23791573,e.Dh=-1521486534,e.Dl=1595750129,e.Eh=1359893119,e.El=-1377402159,e.Fh=-1694144372,e.Fl=725511199,e.Gh=528734635,e.Gl=-79577749,e.Hh=1541459225,e.Hl=327033209,e}return(0,fi.Z)(r,[{key:"get",value:function(){return[this.Ah,this.Al,this.Bh,this.Bl,this.Ch,this.Cl,this.Dh,this.Dl,this.Eh,this.El,this.Fh,this.Fl,this.Gh,this.Gl,this.Hh,this.Hl]}},{key:"set",value:function(e,t,r,n,i,a,s,o,u,c,l,h,f,d,p,v){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|a,this.Dh=0|s,this.Dl=0|o,this.Eh=0|u,this.El=0|c,this.Fh=0|l,this.Fl=0|h,this.Gh=0|f,this.Gl=0|d,this.Hh=0|p,this.Hl=0|v}},{key:"process",value:function(e,t){for(var r=0;r<16;r++,t+=4)rp[r]=e.getUint32(t),np[r]=e.getUint32(t+=4);for(var n=16;n<80;n++){var i=0|rp[n-15],a=0|np[n-15],s=Xd.rotrSH(i,a,1)^Xd.rotrSH(i,a,8)^Xd.shrSH(i,a,7),o=Xd.rotrSL(i,a,1)^Xd.rotrSL(i,a,8)^Xd.shrSL(i,a,7),u=0|rp[n-2],c=0|np[n-2],l=Xd.rotrSH(u,c,19)^Xd.rotrBH(u,c,61)^Xd.shrSH(u,c,6),h=Xd.rotrSL(u,c,19)^Xd.rotrBL(u,c,61)^Xd.shrSL(u,c,6),f=Xd.add4L(o,h,np[n-7],np[n-16]),d=Xd.add4H(f,s,l,rp[n-7],rp[n-16]);rp[n]=0|d,np[n]=0|f}for(var p=this.Ah,v=this.Al,g=this.Bh,y=this.Bl,m=this.Ch,b=this.Cl,_=this.Dh,w=this.Dl,k=this.Eh,x=this.El,E=this.Fh,S=this.Fl,C=this.Gh,A=this.Gl,D=this.Hh,R=this.Hl,T=0;T<80;T++){var Z=Xd.rotrSH(k,x,14)^Xd.rotrSH(k,x,18)^Xd.rotrBH(k,x,41),I=Xd.rotrSL(k,x,14)^Xd.rotrSL(k,x,18)^Xd.rotrBL(k,x,41),P=k&E^~k&C,L=x&S^~x&A,M=Xd.add5L(R,I,L,tp[T],np[T]),B=Xd.add5H(M,D,Z,P,ep[T],rp[T]),O=0|M,N=Xd.rotrSH(p,v,28)^Xd.rotrBH(p,v,34)^Xd.rotrBH(p,v,39),F=Xd.rotrSL(p,v,28)^Xd.rotrBL(p,v,34)^Xd.rotrBL(p,v,39),U=p&g^p&m^g&m,z=v&y^v&b^y&b;D=0|C,R=0|A,C=0|E,A=0|S,E=0|k,S=0|x;var j=Xd.add(0|_,0|w,0|B,0|O);k=j.h,x=j.l,_=0|m,w=0|b,m=0|g,b=0|y,g=0|p,y=0|v;var H=Xd.add3L(O,F,z);p=Xd.add3H(H,B,N,U),v=0|H}var W=Xd.add(0|this.Ah,0|this.Al,0|p,0|v);p=W.h,v=W.l;var q=Xd.add(0|this.Bh,0|this.Bl,0|g,0|y);g=q.h,y=q.l;var V=Xd.add(0|this.Ch,0|this.Cl,0|m,0|b);m=V.h,b=V.l;var K=Xd.add(0|this.Dh,0|this.Dl,0|_,0|w);_=K.h,w=K.l;var Y=Xd.add(0|this.Eh,0|this.El,0|k,0|x);k=Y.h,x=Y.l;var G=Xd.add(0|this.Fh,0|this.Fl,0|E,0|S);E=G.h,S=G.l;var Q=Xd.add(0|this.Gh,0|this.Gl,0|C,0|A);C=Q.h,A=Q.l;var X=Xd.add(0|this.Hh,0|this.Hl,0|D,0|R);D=X.h,R=X.l,this.set(p,v,g,y,m,b,_,w,k,x,E,S,C,A,D,R)}},{key:"roundClean",value:function(){rp.fill(0),np.fill(0)}},{key:"destroy",value:function(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}]),r}(Vd),ap=Wd((function(){return new ip})),sp=BigInt(0),op=BigInt(1),up=BigInt(2),cp=function(e){return e instanceof Uint8Array},lp=Array.from({length:256},(function(e,t){return t.toString(16).padStart(2,"0")}));function hp(e){if(!cp(e))throw new Error("Uint8Array expected");for(var t="",r=0;r<e.length;r++)t+=lp[e[r]];return t}function fp(e){var t=e.toString(16);return 1&t.length?"0".concat(t):t}function dp(e){if("string"!==typeof e)throw new Error("hex string expected, got "+typeof e);return BigInt(""===e?"0":"0x".concat(e))}function pp(e){if("string"!==typeof e)throw new Error("hex string expected, got "+typeof e);var t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);for(var r=new Uint8Array(t/2),n=0;n<r.length;n++){var i=2*n,a=e.slice(i,i+2),s=Number.parseInt(a,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");r[n]=s}return r}function vp(e){return dp(hp(e))}function gp(e){if(!cp(e))throw new Error("Uint8Array expected");return dp(hp(Uint8Array.from(e).reverse()))}function yp(e,t){return pp(e.toString(16).padStart(2*t,"0"))}function mp(e,t){return yp(e,t).reverse()}function bp(e){return pp(fp(e))}function _p(e,t,r){var n;if("string"===typeof t)try{n=pp(t)}catch(a){throw new Error("".concat(e,' must be valid hex string, got "').concat(t,'". Cause: ').concat(a))}else{if(!cp(t))throw new Error("".concat(e," must be hex string or Uint8Array"));n=Uint8Array.from(t)}var i=n.length;if("number"===typeof r&&i!==r)throw new Error("".concat(e," expected ").concat(r," bytes, got ").concat(i));return n}function wp(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=new Uint8Array(t.reduce((function(e,t){return e+t.length}),0)),i=0;return t.forEach((function(e){if(!cp(e))throw new Error("Uint8Array expected");n.set(e,i),i+=e.length})),n}function kp(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function xp(e){if("string"!==typeof e)throw new Error("utf8ToBytes expected string, got ".concat(typeof e));return new Uint8Array((new TextEncoder).encode(e))}function Ep(e){var t;for(t=0;e>sp;e>>=op,t+=1);return t}function Sp(e,t){return e>>BigInt(t)&op}var Cp=function(e,t,r){return e|(r?op:sp)<<BigInt(t)},Ap=function(e){return(up<<BigInt(e-1))-op},Dp=function(e){return new Uint8Array(e)},Rp=function(e){return Uint8Array.from(e)};function Tp(e,t,r){if("number"!==typeof e||e<2)throw new Error("hashLen must be a number");if("number"!==typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!==typeof r)throw new Error("hmacFn must be a function");var n=Dp(e),i=Dp(e),a=0,s=function(){n.fill(1),i.fill(0),a=0},o=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return r.apply(void 0,[i,n].concat(t))},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Dp();i=o(Rp([0]),e),n=o(),0!==e.length&&(i=o(Rp([1]),e),n=o())},c=function(){if(a++>=1e3)throw new Error("drbg: tried 1000 values");for(var e=0,r=[];e<t;){var i=(n=o()).slice();r.push(i),e+=n.length}return wp.apply(void 0,r)};return function(e,t){s(),u(e);for(var r=void 0;!(r=t(c()));)u();return s(),r}}var Zp={bigint:function(e){return"bigint"===typeof e},function:function(e){return"function"===typeof e},boolean:function(e){return"boolean"===typeof e},string:function(e){return"string"===typeof e},stringOrUint8Array:function(e){return"string"===typeof e||e instanceof Uint8Array},isSafeInteger:function(e){return Number.isSafeInteger(e)},array:function(e){return Array.isArray(e)},field:function(e,t){return t.Fp.isValid(e)},hash:function(e){return"function"===typeof e&&Number.isSafeInteger(e.outputLen)}};function Ip(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=function(t,r,n){var i=Zp[r];if("function"!==typeof i)throw new Error('Invalid validator "'.concat(r,'", expected function'));var a=e[t];if((!n||void 0!==a)&&!i(a,e))throw new Error("Invalid param ".concat(String(t),"=").concat(a," (").concat(typeof a,"), expected ").concat(r))},i=0,a=Object.entries(t);i<a.length;i++){var s=(0,ke.Z)(a[i],2);n(s[0],s[1],!1)}for(var o=0,u=Object.entries(r);o<u.length;o++){var c=(0,ke.Z)(u[o],2);n(c[0],c[1],!0)}return e}var Pp=BigInt(0),Lp=BigInt(1),Mp=BigInt(2),Bp=BigInt(3),Op=BigInt(4),Np=BigInt(5),Fp=BigInt(8);BigInt(9),BigInt(16);function Up(e,t){var r=e%t;return r>=Pp?r:t+r}function zp(e,t,r){if(r<=Pp||t<Pp)throw new Error("Expected power/modulo > 0");if(r===Lp)return Pp;for(var n=Lp;t>Pp;)t&Lp&&(n=n*e%r),e=e*e%r,t>>=Lp;return n}function jp(e,t,r){for(var n=e;t-- >Pp;)n*=n,n%=r;return n}function Hp(e,t){if(e===Pp||t<=Pp)throw new Error("invert: expected positive integers, got n=".concat(e," mod=").concat(t));for(var r=Up(e,t),n=t,i=Pp,a=Lp,s=Lp,o=Pp;r!==Pp;){var u=n/r,c=n%r,l=i-s*u,h=a-o*u;n=r,r=c,i=s,a=o,s=l,o=h}if(n!==Lp)throw new Error("invert: does not exist");return Up(i,t)}function Wp(e){if(e%Op===Bp){var t=(e+Lp)/Op;return function(e,r){var n=e.pow(r,t);if(!e.eql(e.sqr(n),r))throw new Error("Cannot find square root");return n}}if(e%Fp===Np){var r=(e-Np)/Fp;return function(e,t){var n=e.mul(t,Mp),i=e.pow(n,r),a=e.mul(t,i),s=e.mul(e.mul(a,Mp),i),o=e.mul(a,e.sub(s,e.ONE));if(!e.eql(e.sqr(o),t))throw new Error("Cannot find square root");return o}}return function(e){var t,r,n,i=(e-Lp)/Mp;for(t=e-Lp,r=0;t%Mp===Pp;t/=Mp,r++);for(n=Mp;n<e&&zp(n,i,e)!==e-Lp;n++);if(1===r){var a=(e+Lp)/Op;return function(e,t){var r=e.pow(t,a);if(!e.eql(e.sqr(r),t))throw new Error("Cannot find square root");return r}}var s=(t+Lp)/Mp;return function(e,a){if(e.pow(a,i)===e.neg(e.ONE))throw new Error("Cannot find square root");for(var o=r,u=e.pow(e.mul(e.ONE,n),t),c=e.pow(a,s),l=e.pow(a,t);!e.eql(l,e.ONE);){if(e.eql(l,e.ZERO))return e.ZERO;for(var h=1,f=e.sqr(l);h<o&&!e.eql(f,e.ONE);h++)f=e.sqr(f);var d=e.pow(u,Lp<<BigInt(o-h-1));u=e.sqr(d),c=e.mul(c,d),l=e.mul(l,u),o=h}return c}}(e)}var qp=function(e,t){return(Up(e,t)&Lp)===Lp},Vp=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Kp(e,t){var r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function Yp(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(e<=Pp)throw new Error("Expected Field ORDER > 0, got ".concat(e));var i=Kp(e,t),a=i.nBitLength,s=i.nByteLength;if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");var o=Wp(e),u=Object.freeze({ORDER:e,BITS:a,BYTES:s,MASK:Ap(a),ZERO:Pp,ONE:Lp,create:function(t){return Up(t,e)},isValid:function(t){if("bigint"!==typeof t)throw new Error("Invalid field element: expected bigint, got ".concat(typeof t));return Pp<=t&&t<e},is0:function(e){return e===Pp},isOdd:function(e){return(e&Lp)===Lp},neg:function(t){return Up(-t,e)},eql:function(e,t){return e===t},sqr:function(t){return Up(t*t,e)},add:function(t,r){return Up(t+r,e)},sub:function(t,r){return Up(t-r,e)},mul:function(t,r){return Up(t*r,e)},pow:function(e,t){return function(e,t,r){if(r<Pp)throw new Error("Expected power > 0");if(r===Pp)return e.ONE;if(r===Lp)return t;for(var n=e.ONE,i=t;r>Pp;)r&Lp&&(n=e.mul(n,i)),i=e.sqr(i),r>>=Lp;return n}(u,e,t)},div:function(t,r){return Up(t*Hp(r,e),e)},sqrN:function(e){return e*e},addN:function(e,t){return e+t},subN:function(e,t){return e-t},mulN:function(e,t){return e*t},inv:function(t){return Hp(t,e)},sqrt:n.sqrt||function(e){return o(u,e)},invertBatch:function(e){return function(e,t){var r=new Array(t.length),n=t.reduce((function(t,n,i){return e.is0(n)?t:(r[i]=t,e.mul(t,n))}),e.ONE),i=e.inv(n);return t.reduceRight((function(t,n,i){return e.is0(n)?t:(r[i]=e.mul(t,r[i]),e.mul(t,n))}),i),r}(u,e)},cmov:function(e,t,r){return r?t:e},toBytes:function(e){return r?mp(e,s):yp(e,s)},fromBytes:function(e){if(e.length!==s)throw new Error("Fp.fromBytes: expected ".concat(s,", got ").concat(e.length));return r?gp(e):vp(e)}});return Object.freeze(u)}function Gp(e){if("bigint"!==typeof e)throw new Error("field order must be bigint");var t=e.toString(2).length;return Math.ceil(t/8)}function Qp(e){var t=Gp(e);return t+Math.ceil(t/2)}var Xp=BigInt(0),Jp=BigInt(1);function $p(e,t){var r=function(e,t){var r=t.negate();return e?r:t},n=function(e){return{windows:Math.ceil(t/e)+1,windowSize:Math.pow(2,e-1)}};return{constTimeNegate:r,unsafeLadder:function(t,r){for(var n=e.ZERO,i=t;r>Xp;)r&Jp&&(n=n.add(i)),i=i.double(),r>>=Jp;return n},precomputeWindow:function(e,t){for(var r=n(t),i=r.windows,a=r.windowSize,s=[],o=e,u=o,c=0;c<i;c++){u=o,s.push(u);for(var l=1;l<a;l++)u=u.add(o),s.push(u);o=u.double()}return s},wNAF:function(t,i,a){for(var s=n(t),o=s.windows,u=s.windowSize,c=e.ZERO,l=e.BASE,h=BigInt(Math.pow(2,t)-1),f=Math.pow(2,t),d=BigInt(t),p=0;p<o;p++){var v=p*u,g=Number(a&h);a>>=d,g>u&&(g-=f,a+=Jp);var y=v,m=v+Math.abs(g)-1,b=p%2!==0,_=g<0;0===g?l=l.add(r(b,i[y])):c=c.add(r(_,i[m]))}return{p:c,f:l}},wNAFCached:function(e,t,r,n){var i=e._WINDOW_SIZE||1,a=t.get(e);return a||(a=this.precomputeWindow(e,i),1!==i&&t.set(e,n(a))),this.wNAF(i,a,r)}}}function ev(e){return Ip(e.Fp,Vp.reduce((function(e,t){return e[t]="function",e}),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),Ip(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze((0,_e.Z)((0,_e.Z)((0,_e.Z)({},Kp(e.n,e.nBitLength)),e),{p:e.Fp.ORDER}))}var tv=BigInt(0),rv=BigInt(1),nv=BigInt(2),iv=BigInt(8),av={zip215:!0};function sv(e){var t=function(e){var t=ev(e);return Ip(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze((0,_e.Z)({},t))}(e),r=t.Fp,n=t.n,i=t.prehash,a=t.hash,s=t.randomBytes,o=t.nByteLength,u=t.h,c=nv<<BigInt(8*o)-rv,l=r.create,h=t.uvRatio||function(e,t){try{return{isValid:!0,value:r.sqrt(e*r.inv(t))}}catch(n){return{isValid:!1,value:tv}}},f=t.adjustScalarBytes||function(e){return e},d=t.domain||function(e,t,r){if(t.length||r)throw new Error("Contexts/pre-hash are not supported");return e},p=function(e){return"bigint"===typeof e&&tv<e},v=function(e,t){return p(e)&&p(t)&&e<t},g=function(e){return e===tv||v(e,c)};function y(e,t){if(v(e,t))return e;throw new Error("Expected valid scalar < ".concat(t,", got ").concat(typeof e," ").concat(e))}function m(e){return e===tv?e:y(e,n)}var _=new Map;function w(e){if(!(e instanceof k))throw new Error("ExtendedPoint expected")}var k=function(){function e(t,r,n,i){if((0,hi.Z)(this,e),this.ex=t,this.ey=r,this.ez=n,this.et=i,!g(t))throw new Error("x required");if(!g(r))throw new Error("y required");if(!g(n))throw new Error("z required");if(!g(i))throw new Error("t required")}return(0,fi.Z)(e,[{key:"x",get:function(){return this.toAffine().x}},{key:"y",get:function(){return this.toAffine().y}},{key:"_setWindowSize",value:function(e){this._WINDOW_SIZE=e,_.delete(this)}},{key:"assertValidity",value:function(){var e=t.a,r=t.d;if(this.is0())throw new Error("bad point: ZERO");var n=this.ex,i=this.ey,a=this.ez,s=this.et,o=l(n*n),u=l(i*i),c=l(a*a),h=l(c*c),f=l(o*e);if(l(c*l(f+u))!==l(h+l(r*l(o*u))))throw new Error("bad point: equation left != right (1)");if(l(n*i)!==l(a*s))throw new Error("bad point: equation left != right (2)")}},{key:"equals",value:function(e){w(e);var t=this.ex,r=this.ey,n=this.ez,i=e.ex,a=e.ey,s=e.ez,o=l(t*s),u=l(i*n),c=l(r*s),h=l(a*n);return o===u&&c===h}},{key:"is0",value:function(){return this.equals(e.ZERO)}},{key:"negate",value:function(){return new e(l(-this.ex),this.ey,this.ez,l(-this.et))}},{key:"double",value:function(){var r=t.a,n=this.ex,i=this.ey,a=this.ez,s=l(n*n),o=l(i*i),u=l(nv*l(a*a)),c=l(r*s),h=n+i,f=l(l(h*h)-s-o),d=c+o,p=d-u,v=c-o,g=l(f*p),y=l(d*v),m=l(f*v);return new e(g,y,l(p*d),m)}},{key:"add",value:function(r){w(r);var n=t.a,i=t.d,a=this.ex,s=this.ey,o=this.ez,u=this.et,c=r.ex,h=r.ey,f=r.ez,d=r.et;if(n===BigInt(-1)){var p=l((s-a)*(h+c)),v=l((s+a)*(h-c)),g=l(v-p);if(g===tv)return this.double();var y=l(o*nv*d),m=l(u*nv*f),b=m+y,_=v+p,k=m-y,x=l(b*g),E=l(_*k),S=l(b*k);return new e(x,E,l(g*_),S)}var C=l(a*c),A=l(s*h),D=l(u*i*d),R=l(o*f),T=l((a+s)*(c+h)-C-A),Z=R-D,I=R+D,P=l(A-n*C),L=l(T*Z),M=l(I*P),B=l(T*P);return new e(L,M,l(Z*I),B)}},{key:"subtract",value:function(e){return this.add(e.negate())}},{key:"wNAF",value:function(t){return S.wNAFCached(this,_,t,e.normalizeZ)}},{key:"multiply",value:function(t){var r=this.wNAF(y(t,n)),i=r.p,a=r.f;return e.normalizeZ([i,a])[0]}},{key:"multiplyUnsafe",value:function(e){var t=m(e);return t===tv?E:this.equals(E)||t===rv?this:this.equals(x)?this.wNAF(t).p:S.unsafeLadder(this,t)}},{key:"isSmallOrder",value:function(){return this.multiplyUnsafe(u).is0()}},{key:"isTorsionFree",value:function(){return S.unsafeLadder(this,n).is0()}},{key:"toAffine",value:function(e){var t=this.ex,n=this.ey,i=this.ez,a=this.is0();null==e&&(e=a?iv:r.inv(i));var s=l(t*e),o=l(n*e),u=l(i*e);if(a)return{x:tv,y:rv};if(u!==rv)throw new Error("invZ was invalid");return{x:s,y:o}}},{key:"clearCofactor",value:function(){var e=t.h;return e===rv?this:this.multiplyUnsafe(e)}},{key:"toRawBytes",value:function(){var e=this.toAffine(),t=e.x,n=mp(e.y,r.BYTES);return n[n.length-1]|=t&rv?128:0,n}},{key:"toHex",value:function(){return hp(this.toRawBytes())}}],[{key:"fromAffine",value:function(t){if(t instanceof e)throw new Error("extended point not allowed");var r=t||{},n=r.x,i=r.y;if(!g(n)||!g(i))throw new Error("invalid affine point");return new e(n,i,rv,l(n*i))}},{key:"normalizeZ",value:function(t){var n=r.invertBatch(t.map((function(e){return e.ez})));return t.map((function(e,t){return e.toAffine(n[t])})).map(e.fromAffine)}},{key:"fromHex",value:function(n){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=t.d,s=t.a,o=r.BYTES,u=(n=_p("pointHex",n,o)).slice(),f=n[o-1];u[o-1]=-129&f;var d=gp(u);d===tv||y(d,i?c:r.ORDER);var p=l(d*d),v=l(p-rv),g=l(a*p-s),m=h(v,g),b=m.isValid,_=m.value;if(!b)throw new Error("Point.fromHex: invalid y coordinate");var w=(_&rv)===rv,k=0!==(128&f);if(!i&&_===tv&&k)throw new Error("Point.fromHex: x=0 and x_0=1");return k!==w&&(_=l(-_)),e.fromAffine({x:_,y:d})}},{key:"fromPrivateKey",value:function(e){return D(e).point}}]),e}();k.BASE=new k(t.Gx,t.Gy,rv,l(t.Gx*t.Gy)),k.ZERO=new k(tv,rv,rv,tv);var x=k.BASE,E=k.ZERO,S=$p(k,8*o);function C(e){return Up(e,n)}function A(e){return C(gp(e))}function D(e){var t=o;e=_p("private key",e,t);var r=_p("hashed private key",a(e),2*t),n=f(r.slice(0,t)),i=r.slice(t,2*t),s=A(n),u=x.multiply(s),c=u.toRawBytes();return{head:n,prefix:i,scalar:s,point:u,pointBytes:c}}function R(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Uint8Array,t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var s=wp.apply(b,r);return A(a(d(s,_p("context",e),!!i)))}var T=av;x._setWindowSize(8);var Z={getExtendedPublicKey:D,randomPrivateKey:function(){return s(r.BYTES)},precompute:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:k.BASE;return t._setWindowSize(e),t.multiply(BigInt(3)),t}};return{CURVE:t,getPublicKey:function(e){return D(e).pointBytes},sign:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e=_p("message",e),i&&(e=i(e));var a=D(t),s=a.prefix,u=a.scalar,c=a.pointBytes,l=R(n.context,s,e),h=x.multiply(l).toRawBytes(),f=C(l+R(n.context,h,c,e)*u);return m(f),_p("result",wp(h,mp(f,r.BYTES)),2*o)},verify:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:T,s=a.context,o=a.zip215,u=r.BYTES;e=_p("signature",e,2*u),t=_p("message",t),i&&(t=i(t));var c,l,h,f=gp(e.slice(u,2*u));try{c=k.fromHex(n,o),l=k.fromHex(e.slice(0,u),o),h=x.multiplyUnsafe(f)}catch(p){return!1}if(!o&&c.isSmallOrder())return!1;var d=R(s,l.toRawBytes(),c.toRawBytes(),t);return l.add(c.multiplyUnsafe(d)).subtract(h).clearCofactor().equals(k.ZERO)},ExtendedPoint:k,utils:Z}}var ov=BigInt(0),uv=BigInt(1);function cv(e){var t,r=(Ip(t=e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze((0,_e.Z)({},t))),n=r.P,i=function(e){return Up(e,n)},a=r.montgomeryBits,s=Math.ceil(a/8),o=r.nByteLength,u=r.adjustScalarBytes||function(e){return e},c=r.powPminus2||function(e){return zp(e,n-BigInt(2),n)};function l(e,t,r){var n=i(e*(t-r));return[t=i(t-n),r=i(r+n)]}function h(e){if("bigint"===typeof e&&ov<=e&&e<n)return e;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}var f=(r.a-BigInt(2))/BigInt(4);function d(e){return mp(i(e),s)}function p(e,t){var r=function(e){var t=_p("u coordinate",e,s);return o===s&&(t[o-1]&=127),gp(t)}(t),n=function(e){var t=_p("scalar",e);if(t.length!==s&&t.length!==o)throw new Error("Expected ".concat(s," or ").concat(o," bytes, got ").concat(t.length));return gp(u(t))}(e),p=function(e,t){for(var r,n=h(e),s=h(t),o=n,u=uv,d=ov,p=n,v=uv,g=ov,y=BigInt(a-1);y>=ov;y--){var m=s>>y&uv;u=(r=l(g^=m,u,p))[0],p=r[1],d=(r=l(g,d,v))[0],v=r[1],g=m;var b=u+d,_=i(b*b),w=u-d,k=i(w*w),x=_-k,E=p+v,S=i((p-v)*b),C=i(E*w),A=S+C,D=S-C;p=i(A*A),v=i(o*i(D*D)),u=i(_*k),d=i(x*(_+i(f*x)))}u=(r=l(g,u,p))[0],p=r[1],d=(r=l(g,d,v))[0],v=r[1];var R=c(d);return i(u*R)}(r,n);if(p===ov)throw new Error("Invalid private or public key received");return d(p)}var v=d(r.Gu);function g(e){return p(e,v)}return{scalarMult:p,scalarMultBase:g,getSharedSecret:function(e,t){return p(e,t)},getPublicKey:function(e){return g(e)},utils:{randomPrivateKey:function(){return r.randomBytes(r.nByteLength)}},GuBytes:v}}var lv=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),hv=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),fv=(BigInt(0),BigInt(1)),dv=BigInt(2),pv=BigInt(5),vv=BigInt(10),gv=BigInt(20),yv=BigInt(40),mv=BigInt(80);function bv(e){var t=lv,r=e*e%t*e%t,n=jp(r,dv,t)*r%t,i=jp(n,fv,t)*e%t,a=jp(i,pv,t)*i%t,s=jp(a,vv,t)*a%t,o=jp(s,gv,t)*s%t,u=jp(o,yv,t)*o%t,c=jp(u,mv,t)*u%t,l=jp(c,mv,t)*u%t,h=jp(l,vv,t)*a%t;return{pow_p_5_8:jp(h,dv,t)*e%t,b2:r}}function _v(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function wv(e,t){var r=lv,n=Up(t*t*t,r),i=Up(n*n*t,r),a=Up(e*n*bv(e*i).pow_p_5_8,r),s=Up(t*a*a,r),o=a,u=Up(a*hv,r),c=s===e,l=s===Up(-e,r),h=s===Up(-e*hv,r);return c&&(a=o),(l||h)&&(a=u),qp(a,r)&&(a=Up(-a,r)),{isValid:c||l,value:a}}var kv=Yp(lv,void 0,!0),xv={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:kv,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:ap,randomBytes:qd,adjustScalarBytes:_v,uvRatio:wv},Ev=sv(xv);function Sv(e,t,r){if(t.length>255)throw new Error("Context is too big");return jd(Ud("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,t.length]),t,e)}(0,_e.Z)((0,_e.Z)({},xv),{},{domain:Sv}),(0,_e.Z)((0,_e.Z)({},xv),{},{domain:Sv,prehash:ap});var Cv=function(){return cv({P:lv,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:function(e){var t=lv,r=bv(e),n=r.pow_p_5_8,i=r.b2;return Up(jp(n,BigInt(3),t)*i,t)},adjustScalarBytes:_v,randomBytes:qd})}();var Av=(kv.ORDER+BigInt(3))/BigInt(8);kv.pow(dv,Av),kv.sqrt(kv.neg(kv.ONE)),kv.ORDER,BigInt(5),BigInt(8),BigInt(486662);!function(e,t){if(!e.isOdd)throw new Error("Field doesn't have isOdd");var r=e.sqrt(t);e.isOdd(r)&&e.neg(r)}(kv,kv.neg(BigInt(486664)));BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var Dv=32,Rv=64,Tv=32;function Zv(){return Iv.apply(this,arguments)}function Iv(){return(Iv=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Ev.utils.randomPrivateKey(),r=Ev.getPublicKey(t),n=Fv(t,r),e.abrupt("return",{privateKey:n,publicKey:r});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pv(e){return Lv.apply(this,arguments)}function Lv(){return Lv=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.length===Tv){e.next=4;break}throw new TypeError('"seed" must be 32 bytes in length.');case 4:if(t instanceof Uint8Array){e.next=6;break}throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');case 6:return r=t,n=Ev.getPublicKey(r),i=Fv(r,n),e.abrupt("return",{privateKey:i,publicKey:n});case 10:case"end":return e.stop()}}),e)}))),Lv.apply(this,arguments)}function Mv(e,t){return Bv.apply(this,arguments)}function Bv(){return(Bv=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.subarray(0,Tv),e.abrupt("return",Ev.sign(r,n));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ov(e,t,r){return Nv.apply(this,arguments)}function Nv(){return(Nv=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ev.verify(r,n,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Fv(e,t){for(var r=new Uint8Array(Rv),n=0;n<Tv;n++)r[n]=e[n],r[Tv+n]=t[n];return r}var Uv,zv,jv,Hv,Wv={get:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:globalThis).crypto;if(null==e||null==e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}},qv={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function Vv(e){var t,r,n,i,a,s,o=null!==(t=null===e||void 0===e?void 0:e.algorithm)&&void 0!==t?t:"AES-GCM",u=null!==(r=null===e||void 0===e?void 0:e.keyLength)&&void 0!==r?r:16,c=null!==(n=null===e||void 0===e?void 0:e.nonceLength)&&void 0!==n?n:12,l=null!==(i=null===e||void 0===e?void 0:e.digest)&&void 0!==i?i:"SHA-256",h=null!==(a=null===e||void 0===e?void 0:e.saltLength)&&void 0!==a?a:16,f=null!==(s=null===e||void 0===e?void 0:e.iterations)&&void 0!==s?s:32767,d=Wv.get();function p(){return(p=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,p,v,g,y,m;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=d.getRandomValues(new Uint8Array(h)),i=d.getRandomValues(new Uint8Array(c)),a={name:o,iv:i},"string"===typeof r&&(r=Hs(r)),0!==r.length){e.next=25;break}return e.next=7,d.subtle.importKey("jwk",qv,{name:"AES-GCM"},!0,["encrypt"]);case 7:return s=e.sent,e.prev=8,p={name:"PBKDF2",salt:n,iterations:f,hash:{name:l}},e.next=12,d.subtle.importKey("raw",r,{name:"PBKDF2"},!1,["deriveKey"]);case 12:return v=e.sent,e.next=15,d.subtle.deriveKey(p,v,{name:o,length:u},!0,["encrypt"]);case 15:s=e.sent,e.next=23;break;case 18:return e.prev=18,e.t0=e.catch(8),e.next=22,d.subtle.importKey("jwk",qv,{name:"AES-GCM"},!0,["encrypt"]);case 22:s=e.sent;case 23:e.next=32;break;case 25:return g={name:"PBKDF2",salt:n,iterations:f,hash:{name:l}},e.next=28,d.subtle.importKey("raw",r,{name:"PBKDF2"},!1,["deriveKey"]);case 28:return y=e.sent,e.next=31,d.subtle.deriveKey(g,y,{name:o,length:u},!0,["encrypt"]);case 31:s=e.sent;case 32:return e.next=34,d.subtle.encrypt(a,s,t);case 34:return m=e.sent,e.abrupt("return",Eu([n,a.iv,new Uint8Array(m)]));case 36:case"end":return e.stop()}}),e,null,[[8,18]])})))).apply(this,arguments)}function v(){return(v=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,p,v,g,y,m,b;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.subarray(0,h),i=t.subarray(h,h+c),a=t.subarray(h+c),s={name:o,iv:i},"string"===typeof r&&(r=Hs(r)),0!==r.length){e.next=23;break}return e.prev=6,v={name:"PBKDF2",salt:n,iterations:f,hash:{name:l}},e.next=10,d.subtle.importKey("raw",r,{name:"PBKDF2"},!1,["deriveKey"]);case 10:return g=e.sent,e.next=13,d.subtle.deriveKey(v,g,{name:o,length:u},!0,["decrypt"]);case 13:p=e.sent,e.next=21;break;case 16:return e.prev=16,e.t0=e.catch(6),e.next=20,d.subtle.importKey("jwk",qv,{name:"AES-GCM"},!0,["decrypt"]);case 20:p=e.sent;case 21:e.next=30;break;case 23:return y={name:"PBKDF2",salt:n,iterations:f,hash:{name:l}},e.next=26,d.subtle.importKey("raw",r,{name:"PBKDF2"},!1,["deriveKey"]);case 26:return m=e.sent,e.next=29,d.subtle.deriveKey(y,m,{name:o,length:u},!0,["decrypt"]);case 29:p=e.sent;case 30:return e.next=32,d.subtle.decrypt(s,p,a);case 32:return b=e.sent,e.abrupt("return",new Uint8Array(b));case 34:case"end":return e.stop()}}),e,null,[[6,16]])})))).apply(this,arguments)}u*=8;var g={encrypt:function(e,t){return p.apply(this,arguments)},decrypt:function(e,t){return v.apply(this,arguments)}};return g}function Kv(e,t){return Yv.apply(this,arguments)}function Yv(){return(Yv=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Vv(),e.next=3,n.encrypt(t,r);case 3:return i=e.sent,e.abrupt("return",Oi.encode(i));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"}(Uv||(Uv={})),function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"}(zv||(zv={})),function(e){e.codec=function(){return Qo(zv)}}(Uv||(Uv={})),function(e){var t;e.codec=function(){return null==t&&(t=Xo((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),Uv.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==r.lengthDelimited&&t.ldelim()}),(function(e,t){for(var r={},n=null==t?e.len:e.pos+t;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.Type=Uv.codec().decode(e);break;case 2:r.Data=e.bytes();break;default:e.skipType(7&i)}}return r}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(jv||(jv={})),function(e){var t;e.codec=function(){return null==t&&(t=Xo((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),Uv.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==r.lengthDelimited&&t.ldelim()}),(function(e,t){for(var r={},n=null==t?e.len:e.pos+t;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.Type=Uv.codec().decode(e);break;case 2:r.Data=e.bytes();break;default:e.skipType(7&i)}}return r}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(Hv||(Hv={}));var Gv=function(){function e(t){(0,hi.Z)(this,e),(0,we.Z)(this,"_key",void 0),this._key=ng(t,Dv)}return(0,fi.Z)(e,[{key:"verify",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ov(this._key,r,t));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"marshal",value:function(){return this._key}},{key:"bytes",get:function(){return jv.encode({Type:Uv.Ed25519,Data:this.marshal()}).subarray()}},{key:"equals",value:function(e){return Ao(this.bytes,e.bytes)}},{key:"hash",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ps.digest(this.bytes);case 2:return t=e.sent,r=t.bytes,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Qv=function(){function e(t,r){(0,hi.Z)(this,e),(0,we.Z)(this,"_key",void 0),(0,we.Z)(this,"_publicKey",void 0),this._key=ng(t,Rv),this._publicKey=ng(r,Dv)}return(0,fi.Z)(e,[{key:"sign",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Mv(this._key,t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"public",get:function(){return new Gv(this._publicKey)}},{key:"marshal",value:function(){return this._key}},{key:"bytes",get:function(){return Hv.encode({Type:Uv.Ed25519,Data:this.marshal()}).subarray()}},{key:"equals",value:function(e){return Ao(this.bytes,e.bytes)}},{key:"hash",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ps.digest(this.bytes);case 2:return t=e.sent,r=t.bytes,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"id",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Rs.digest(this.public.bytes),e.abrupt("return",Mi.encode(t.bytes).substring(1));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"export",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("libp2p-key"!==(r=n.length>1&&void 0!==n[1]?n[1]:"libp2p-key")){e.next=5;break}return e.abrupt("return",Kv(this.bytes,t));case 5:throw new wo("export format '".concat(r,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT");case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function Xv(e){if(e.length>Rv){var t=(e=ng(e,Rv+Dv)).subarray(0,Rv),r=e.subarray(Rv,e.length);return new Qv(t,r)}var n=(e=ng(e,Rv)).subarray(0,Rv),i=e.subarray(Dv);return new Qv(n,i)}function Jv(e){return e=ng(e,Dv),new Gv(e)}function $v(){return eg.apply(this,arguments)}function eg(){return(eg=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Zv();case 2:return t=e.sent,r=t.privateKey,n=t.publicKey,e.abrupt("return",new Qv(r,n));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function tg(e){return rg.apply(this,arguments)}function rg(){return rg=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pv(t);case 2:return r=e.sent,n=r.privateKey,i=r.publicKey,e.abrupt("return",new Qv(n,i));case 6:case"end":return e.stop()}}),e)}))),rg.apply(this,arguments)}function ng(e,t){var r;if((e=Uint8Array.from(null!==(r=e)&&void 0!==r?r:[])).length!==t)throw new wo("Key must be a Uint8Array of length ".concat(t,", got ").concat(e.length),"ERR_INVALID_KEY_TYPE");return e}var ig=__webpack_require__(3877);__webpack_require__(3055);function ag(e,t){var r=Uint8Array.from(e.abs().toByteArray());if(r=0===r[0]?r.subarray(1):r,null!=t){if(r.length>t)throw new Error("byte array longer than desired length");r=Eu([new Uint8Array(t-r.length),r])}return Ws(r,"base64url")}function sg(e){var t=og(e);return new Td.jsbn.BigInteger(Ws(t,"base16"),16)}function og(e,t){var r=Hs(e,"base64urlpad");if(null!=t){if(r.length>t)throw new Error("byte array longer than desired length");r=Eu([new Uint8Array(t-r.length),r])}return r}var ug={"P-256":256,"P-384":384,"P-521":521};Object.keys(ug).join(" / ");function cg(e,t){return lg.apply(this,arguments)}function lg(){return(lg=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Oi.decode(t),i=Vv(),e.abrupt("return",i.decrypt(n,r));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}__webpack_require__(4770);function hg(e){if(isNaN(e)||e<=0)throw new wo("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return qd(e)}__webpack_require__(5493);function fg(e,t){return t.map((function(t){return sg(e[t])}))}function dg(e){var t=Td.asn1.fromDer(Ws(e,"ascii")),r=Td.pki.privateKeyFromAsn1(t);return{kty:"RSA",n:ag(r.n),e:ag(r.e),d:ag(r.d),p:ag(r.p),q:ag(r.q),dp:ag(r.dP),dq:ag(r.dQ),qi:ag(r.qInv),alg:"RS256"}}function pg(e){return vg.apply(this,arguments)}function vg(){return vg=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Wv.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]);case 2:return r=e.sent,e.next=5,kg(r);case 5:return n=e.sent,e.abrupt("return",{privateKey:n[0],publicKey:n[1]});case 7:case"end":return e.stop()}}),e)}))),vg.apply(this,arguments)}function gg(e){return yg.apply(this,arguments)}function yg(){return yg=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Wv.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]);case 2:return r=e.sent,e.t0=r,e.next=6,Eg(t);case 6:return e.t1=e.sent,n=[e.t0,e.t1],e.next=10,kg({privateKey:n[0],publicKey:n[1]});case 10:return i=e.sent,e.abrupt("return",{privateKey:i[0],publicKey:i[1]});case 12:case"end":return e.stop()}}),e)}))),yg.apply(this,arguments)}function mg(e,t){return bg.apply(this,arguments)}function bg(){return(bg=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Wv.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]);case 2:return n=e.sent,e.next=5,Wv.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},n,Uint8Array.from(r));case 5:return i=e.sent,e.abrupt("return",new Uint8Array(i,0,i.byteLength));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _g(e,t,r){return wg.apply(this,arguments)}function wg(){return(wg=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Wv.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);case 2:return i=e.sent,e.abrupt("return",Wv.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},i,r,n));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function kg(e){return xg.apply(this,arguments)}function xg(){return xg=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.privateKey&&null!=t.publicKey){e.next=2;break}throw new wo("Private and public key are required","ERR_INVALID_PARAMETERS");case 2:return e.abrupt("return",Promise.all([Wv.get().subtle.exportKey("jwk",t.privateKey),Wv.get().subtle.exportKey("jwk",t.publicKey)]));case 3:case"end":return e.stop()}}),e)}))),xg.apply(this,arguments)}function Eg(e){return Sg.apply(this,arguments)}function Sg(){return(Sg=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Wv.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"]));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Cg(e,t,r,n){var i=t?function(e){var t;return(t=Td.pki).setRsaPublicKey.apply(t,be(fg(e,["n","e"])))}(e):function(e){var t;return(t=Td.pki).setRsaPrivateKey.apply(t,be(fg(e,["n","e","d","p","q","dp","dq","qi"])))}(e);return Hs(n(Ws(Uint8Array.from(r),"ascii"),i),"ascii")}function Ag(e){if("RSA"!==e.kty)throw new wo("invalid key type","ERR_INVALID_KEY_TYPE");if(null==e.n)throw new wo("invalid key modulus","ERR_INVALID_KEY_MODULUS");return 8*Hs(e.n,"base64url").length}var Dg=8192,Rg=function(){function e(t){(0,hi.Z)(this,e),(0,we.Z)(this,"_key",void 0),this._key=t}return(0,fi.Z)(e,[{key:"verify",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_g(this._key,r,t));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"marshal",value:function(){return function(e){if(null==e.n||null==e.e)throw new wo("JWK was missing components","ERR_INVALID_PARAMETERS");var t=Td.pki.publicKeyToAsn1({n:sg(e.n),e:sg(e.e)});return Hs(Td.asn1.toDer(t).getBytes(),"ascii")}(this._key)}},{key:"bytes",get:function(){return jv.encode({Type:Uv.RSA,Data:this.marshal()}).subarray()}},{key:"encrypt",value:function(e){return Cg(this._key,!0,e,(function(e,t){return t.encrypt(e)}))}},{key:"equals",value:function(e){return Ao(this.bytes,e.bytes)}},{key:"hash",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ps.digest(this.bytes);case 2:return t=e.sent,r=t.bytes,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Tg=function(){function e(t,r){(0,hi.Z)(this,e),(0,we.Z)(this,"_key",void 0),(0,we.Z)(this,"_publicKey",void 0),this._key=t,this._publicKey=r}return(0,fi.Z)(e,[{key:"genSecret",value:function(){return hg(16)}},{key:"sign",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",mg(this._key,t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"public",get:function(){if(null==this._publicKey)throw new wo("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new Rg(this._publicKey)}},{key:"decrypt",value:function(e){return Cg(this._key,!1,e,(function(e,t){return t.decrypt(e)}))}},{key:"marshal",value:function(){return function(e){if(null==e.n||null==e.e||null==e.d||null==e.p||null==e.q||null==e.dp||null==e.dq||null==e.qi)throw new wo("JWK was missing components","ERR_INVALID_PARAMETERS");var t=Td.pki.privateKeyToAsn1({n:sg(e.n),e:sg(e.e),d:sg(e.d),p:sg(e.p),q:sg(e.q),dP:sg(e.dp),dQ:sg(e.dq),qInv:sg(e.qi)});return Hs(Td.asn1.toDer(t).getBytes(),"ascii")}(this._key)}},{key:"bytes",get:function(){return Hv.encode({Type:Uv.RSA,Data:this.marshal()}).subarray()}},{key:"equals",value:function(e){return Ao(this.bytes,e.bytes)}},{key:"hash",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ps.digest(this.bytes);case 2:return t=e.sent,r=t.bytes,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"id",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.public.hash();case 2:return t=e.sent,e.abrupt("return",Ws(t,"base58btc"));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"export",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("pkcs-8"!==(r=o.length>1&&void 0!==o[1]?o[1]:"pkcs-8")){e.next=9;break}return n=new Td.util.ByteBuffer(this.marshal()),i=Td.asn1.fromDer(n),a=Td.pki.privateKeyFromAsn1(i),s={algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"},e.abrupt("return",Td.pki.encryptRsaPrivateKey(a,t,s));case 9:if("libp2p-key"!==r){e.next=13;break}return e.abrupt("return",Kv(this.bytes,t));case 13:throw new wo("export format '".concat(r,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT");case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function Zg(e){return Ig.apply(this,arguments)}function Ig(){return Ig=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Ag(r=dg(t))>Dg)){e.next=3;break}throw new wo("key size is too large","ERR_KEY_SIZE_TOO_LARGE");case 3:return e.next=5,gg(r);case 5:return n=e.sent,e.abrupt("return",new Tg(n.privateKey,n.publicKey));case 7:case"end":return e.stop()}}),e)}))),Ig.apply(this,arguments)}function Pg(e){var t=function(e){var t=Td.asn1.fromDer(Ws(e,"ascii")),r=Td.pki.publicKeyFromAsn1(t);return{kty:"RSA",n:ag(r.n),e:ag(r.e)}}(e);if(Ag(t)>Dg)throw new wo("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new Rg(t)}function Lg(e){return Mg.apply(this,arguments)}function Mg(){return(Mg=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Ag(t)>Dg)){e.next=2;break}throw new wo("key size is too large","ERR_KEY_SIZE_TOO_LARGE");case 2:return e.next=4,gg(t);case 4:return r=e.sent,e.abrupt("return",new Tg(r.privateKey,r.publicKey));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Bg(e){return Og.apply(this,arguments)}function Og(){return Og=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t>Dg)){e.next=2;break}throw new wo("key size is too large","ERR_KEY_SIZE_TOO_LARGE");case 2:return e.next=4,pg(t);case 4:return r=e.sent,e.abrupt("return",new Tg(r.privateKey,r.publicKey));case 6:case"end":return e.stop()}}),e)}))),Og.apply(this,arguments)}var Ng=function(e,t,r){return e&t^e&r^t&r},Fg=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ug=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),zg=new Uint32Array(64),jg=function(e){ia(r,e);var t=ua(r);function r(){var e;return(0,hi.Z)(this,r),(e=t.call(this,64,32,8,!1)).A=0|Ug[0],e.B=0|Ug[1],e.C=0|Ug[2],e.D=0|Ug[3],e.E=0|Ug[4],e.F=0|Ug[5],e.G=0|Ug[6],e.H=0|Ug[7],e}return(0,fi.Z)(r,[{key:"get",value:function(){return[this.A,this.B,this.C,this.D,this.E,this.F,this.G,this.H]}},{key:"set",value:function(e,t,r,n,i,a,s,o){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|a,this.G=0|s,this.H=0|o}},{key:"process",value:function(e,t){for(var r=0;r<16;r++,t+=4)zg[r]=e.getUint32(t,!1);for(var n=16;n<64;n++){var i=zg[n-15],a=zg[n-2],s=Fd(i,7)^Fd(i,18)^i>>>3,o=Fd(a,17)^Fd(a,19)^a>>>10;zg[n]=o+zg[n-7]+s+zg[n-16]|0}for(var u,c=this.A,l=this.B,h=this.C,f=this.D,d=this.E,p=this.F,v=this.G,g=this.H,y=0;y<64;y++){var m=g+(Fd(d,6)^Fd(d,11)^Fd(d,25))+((u=d)&p^~u&v)+Fg[y]+zg[y]|0,b=(Fd(c,2)^Fd(c,13)^Fd(c,22))+Ng(c,l,h)|0;g=v,v=p,p=d,d=f+m|0,f=h,h=l,l=c,c=m+b|0}c=c+this.A|0,l=l+this.B|0,h=h+this.C|0,f=f+this.D|0,d=d+this.E|0,p=p+this.F|0,v=v+this.G|0,g=g+this.H|0,this.set(c,l,h,f,d,p,v,g)}},{key:"roundClean",value:function(){zg.fill(0)}},{key:"destroy",value:function(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}]),r}(Vd),Hg=Wd((function(){return new jg})),Wg=function(e){ia(r,e);var t=ua(r);function r(e,n){var i;(0,hi.Z)(this,r),(i=t.call(this)).finished=!1,i.destroyed=!1,Pd(e);var a=zd(n);if(i.iHash=e.create(),"function"!==typeof i.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");i.blockLen=i.iHash.blockLen,i.outputLen=i.iHash.outputLen;var s=i.blockLen,o=new Uint8Array(s);o.set(a.length>s?e.create().update(a).digest():a);for(var u=0;u<o.length;u++)o[u]^=54;i.iHash.update(o),i.oHash=e.create();for(var c=0;c<o.length;c++)o[c]^=106;return i.oHash.update(o),o.fill(0),i}return(0,fi.Z)(r,[{key:"update",value:function(e){return Ld(this),this.iHash.update(e),this}},{key:"digestInto",value:function(e){Ld(this),Id(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}},{key:"digest",value:function(){var e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}},{key:"_cloneInto",value:function(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));var t=this.oHash,r=this.iHash,n=this.finished,i=this.destroyed,a=this.blockLen,s=this.outputLen;return e.finished=n,e.destroyed=i,e.blockLen=a,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}},{key:"destroy",value:function(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}]),r}(Hd),qg=function(e,t,r){return new Wg(e,t).update(r).digest()};qg.create=function(e,t){return new Wg(e,t)};var Vg=vp,Kg=pp,Yg={Err:function(e){ia(r,e);var t=ua(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(0,hi.Z)(this,r),t.call(this,e)}return(0,fi.Z)(r)}(es(Error)),_parseInt:function(e){var t=Yg.Err;if(e.length<2||2!==e[0])throw new t("Invalid signature integer tag");var r=e[1],n=e.subarray(2,r+2);if(!r||n.length!==r)throw new t("Invalid signature integer: wrong length");if(128&n[0])throw new t("Invalid signature integer: negative");if(0===n[0]&&!(128&n[1]))throw new t("Invalid signature integer: unnecessary leading zero");return{d:Vg(n),l:e.subarray(r+2)}},toSig:function(e){var t=Yg.Err,r="string"===typeof e?Kg(e):e;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");var n=r.length;if(n<2||48!=r[0])throw new t("Invalid signature tag");if(r[1]!==n-2)throw new t("Invalid signature: incorrect length");var i=Yg._parseInt(r.subarray(2)),a=i.d,s=i.l,o=Yg._parseInt(s),u=o.d;if(o.l.length)throw new t("Invalid signature: left bytes after parsing");return{r:a,s:u}},hexFromSig:function(e){var t=function(e){return 8&Number.parseInt(e[0],16)?"00"+e:e},r=function(e){var t=e.toString(16);return 1&t.length?"0".concat(t):t},n=t(r(e.s)),i=t(r(e.r)),a=n.length/2,s=i.length/2,o=r(a),u=r(s);return"30".concat(r(s+a+4),"02").concat(u).concat(i,"02").concat(o).concat(n)}},Gg=BigInt(0),Qg=BigInt(1),Xg=(BigInt(2),BigInt(3));BigInt(4);function Jg(e){var t=function(e){var t=ev(e);Ip(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});var r=t.endo,n=t.Fp,i=t.a;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!==typeof r||"bigint"!==typeof r.beta||"function"!==typeof r.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze((0,_e.Z)({},t))}(e),r=t.Fp,n=t.toBytes||function(e,t,n){var i=t.toAffine();return wp(Uint8Array.from([4]),r.toBytes(i.x),r.toBytes(i.y))},i=t.fromBytes||function(e){var t=e.subarray(1);return{x:r.fromBytes(t.subarray(0,r.BYTES)),y:r.fromBytes(t.subarray(r.BYTES,2*r.BYTES))}};function a(e){var n=t.a,i=t.b,a=r.sqr(e),s=r.mul(a,e);return r.add(r.add(s,r.mul(e,n)),i)}if(!r.eql(r.sqr(t.Gy),a(t.Gx)))throw new Error("bad generator point: equation left != right");function s(e){return"bigint"===typeof e&&Gg<e&&e<t.n}function o(e){if(!s(e))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function u(e){var r,n=t.allowedPrivateKeyLengths,i=t.nByteLength,a=t.wrapPrivateKey,s=t.n;if(n&&"bigint"!==typeof e){if(e instanceof Uint8Array&&(e=hp(e)),"string"!==typeof e||!n.includes(e.length))throw new Error("Invalid key");e=e.padStart(2*i,"0")}try{r="bigint"===typeof e?e:vp(_p("private key",e,i))}catch(u){throw new Error("private key must be ".concat(i," bytes, hex or bigint, not ").concat(typeof e))}return a&&(r=Up(r,s)),o(r),r}var c=new Map;function l(e){if(!(e instanceof h))throw new Error("ProjectivePoint expected")}var h=function(){function e(t,n,i){if((0,hi.Z)(this,e),this.px=t,this.py=n,this.pz=i,null==t||!r.isValid(t))throw new Error("x required");if(null==n||!r.isValid(n))throw new Error("y required");if(null==i||!r.isValid(i))throw new Error("z required")}return(0,fi.Z)(e,[{key:"x",get:function(){return this.toAffine().x}},{key:"y",get:function(){return this.toAffine().y}},{key:"_setWindowSize",value:function(e){this._WINDOW_SIZE=e,c.delete(this)}},{key:"assertValidity",value:function(){if(this.is0()){if(t.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}var e=this.toAffine(),n=e.x,i=e.y;if(!r.isValid(n)||!r.isValid(i))throw new Error("bad point: x or y not FE");var s=r.sqr(i),o=a(n);if(!r.eql(s,o))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}},{key:"hasEvenY",value:function(){var e=this.toAffine().y;if(r.isOdd)return!r.isOdd(e);throw new Error("Field doesn't support isOdd")}},{key:"equals",value:function(e){l(e);var t=this.px,n=this.py,i=this.pz,a=e.px,s=e.py,o=e.pz,u=r.eql(r.mul(t,o),r.mul(a,i)),c=r.eql(r.mul(n,o),r.mul(s,i));return u&&c}},{key:"negate",value:function(){return new e(this.px,r.neg(this.py),this.pz)}},{key:"double",value:function(){var n=t.a,i=t.b,a=r.mul(i,Xg),s=this.px,o=this.py,u=this.pz,c=r.ZERO,l=r.ZERO,h=r.ZERO,f=r.mul(s,s),d=r.mul(o,o),p=r.mul(u,u),v=r.mul(s,o);return v=r.add(v,v),h=r.mul(s,u),h=r.add(h,h),c=r.mul(n,h),l=r.mul(a,p),l=r.add(c,l),c=r.sub(d,l),l=r.add(d,l),l=r.mul(c,l),c=r.mul(v,c),h=r.mul(a,h),p=r.mul(n,p),v=r.sub(f,p),v=r.mul(n,v),v=r.add(v,h),h=r.add(f,f),f=r.add(h,f),f=r.add(f,p),f=r.mul(f,v),l=r.add(l,f),p=r.mul(o,u),p=r.add(p,p),f=r.mul(p,v),c=r.sub(c,f),h=r.mul(p,d),h=r.add(h,h),new e(c,l,h=r.add(h,h))}},{key:"add",value:function(n){l(n);var i=this.px,a=this.py,s=this.pz,o=n.px,u=n.py,c=n.pz,h=r.ZERO,f=r.ZERO,d=r.ZERO,p=t.a,v=r.mul(t.b,Xg),g=r.mul(i,o),y=r.mul(a,u),m=r.mul(s,c),b=r.add(i,a),_=r.add(o,u);b=r.mul(b,_),_=r.add(g,y),b=r.sub(b,_),_=r.add(i,s);var w=r.add(o,c);return _=r.mul(_,w),w=r.add(g,m),_=r.sub(_,w),w=r.add(a,s),h=r.add(u,c),w=r.mul(w,h),h=r.add(y,m),w=r.sub(w,h),d=r.mul(p,_),h=r.mul(v,m),d=r.add(h,d),h=r.sub(y,d),d=r.add(y,d),f=r.mul(h,d),y=r.add(g,g),y=r.add(y,g),m=r.mul(p,m),_=r.mul(v,_),y=r.add(y,m),m=r.sub(g,m),m=r.mul(p,m),_=r.add(_,m),g=r.mul(y,_),f=r.add(f,g),g=r.mul(w,_),h=r.mul(b,h),h=r.sub(h,g),g=r.mul(b,y),d=r.mul(w,d),new e(h,f,d=r.add(d,g))}},{key:"subtract",value:function(e){return this.add(e.negate())}},{key:"is0",value:function(){return this.equals(e.ZERO)}},{key:"wNAF",value:function(t){return d.wNAFCached(this,c,t,(function(t){var n=r.invertBatch(t.map((function(e){return e.pz})));return t.map((function(e,t){return e.toAffine(n[t])})).map(e.fromAffine)}))}},{key:"multiplyUnsafe",value:function(n){var i=e.ZERO;if(n===Gg)return i;if(o(n),n===Qg)return this;var a=t.endo;if(!a)return d.unsafeLadder(this,n);for(var s=a.splitScalar(n),u=s.k1neg,c=s.k1,l=s.k2neg,h=s.k2,f=i,p=i,v=this;c>Gg||h>Gg;)c&Qg&&(f=f.add(v)),h&Qg&&(p=p.add(v)),v=v.double(),c>>=Qg,h>>=Qg;return u&&(f=f.negate()),l&&(p=p.negate()),p=new e(r.mul(p.px,a.beta),p.py,p.pz),f.add(p)}},{key:"multiply",value:function(n){o(n);var i,a,s=n,u=t.endo;if(u){var c=u.splitScalar(s),l=c.k1neg,h=c.k1,f=c.k2neg,p=c.k2,v=this.wNAF(h),g=v.p,y=v.f,m=this.wNAF(p),b=m.p,_=m.f;g=d.constTimeNegate(l,g),b=d.constTimeNegate(f,b),b=new e(r.mul(b.px,u.beta),b.py,b.pz),i=g.add(b),a=y.add(_)}else{var w=this.wNAF(s);i=w.p,a=w.f}return e.normalizeZ([i,a])[0]}},{key:"multiplyAndAddUnsafe",value:function(t,r,n){var i=e.BASE,a=function(e,t){return t!==Gg&&t!==Qg&&e.equals(i)?e.multiply(t):e.multiplyUnsafe(t)},s=a(this,r).add(a(t,n));return s.is0()?void 0:s}},{key:"toAffine",value:function(e){var t=this.px,n=this.py,i=this.pz,a=this.is0();null==e&&(e=a?r.ONE:r.inv(i));var s=r.mul(t,e),o=r.mul(n,e),u=r.mul(i,e);if(a)return{x:r.ZERO,y:r.ZERO};if(!r.eql(u,r.ONE))throw new Error("invZ was invalid");return{x:s,y:o}}},{key:"isTorsionFree",value:function(){var r=t.h,n=t.isTorsionFree;if(r===Qg)return!0;if(n)return n(e,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}},{key:"clearCofactor",value:function(){var r=t.h,n=t.clearCofactor;return r===Qg?this:n?n(e,this):this.multiplyUnsafe(t.h)}},{key:"toRawBytes",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.assertValidity(),n(e,this,t)}},{key:"toHex",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return hp(this.toRawBytes(e))}}],[{key:"fromAffine",value:function(t){var n=t||{},i=n.x,a=n.y;if(!t||!r.isValid(i)||!r.isValid(a))throw new Error("invalid affine point");if(t instanceof e)throw new Error("projective point not allowed");var s=function(e){return r.eql(e,r.ZERO)};return s(i)&&s(a)?e.ZERO:new e(i,a,r.ONE)}},{key:"normalizeZ",value:function(t){var n=r.invertBatch(t.map((function(e){return e.pz})));return t.map((function(e,t){return e.toAffine(n[t])})).map(e.fromAffine)}},{key:"fromHex",value:function(t){var r=e.fromAffine(i(_p("pointHex",t)));return r.assertValidity(),r}},{key:"fromPrivateKey",value:function(t){return e.BASE.multiply(u(t))}}]),e}();h.BASE=new h(t.Gx,t.Gy,r.ONE),h.ZERO=new h(r.ZERO,r.ONE,r.ZERO);var f=t.nBitLength,d=$p(h,t.endo?Math.ceil(f/2):f);return{CURVE:t,ProjectivePoint:h,normPrivateKeyToScalar:u,weierstrassEquation:a,isWithinCurveOrder:s}}function $g(e){var t=function(e){var t=ev(e);return Ip(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze((0,_e.Z)({lowS:!0},t))}(e),r=t.Fp,n=t.n,i=r.BYTES+1,a=2*r.BYTES+1;function s(e){return Up(e,n)}function o(e){return Hp(e,n)}var u=Jg((0,_e.Z)((0,_e.Z)({},t),{},{toBytes:function(e,t,n){var i=t.toAffine(),a=r.toBytes(i.x),s=wp;return n?s(Uint8Array.from([t.hasEvenY()?2:3]),a):s(Uint8Array.from([4]),a,r.toBytes(i.y))},fromBytes:function(e){var t=e.length,n=e[0],s=e.subarray(1);if(t!==i||2!==n&&3!==n){if(t===a&&4===n)return{x:r.fromBytes(s.subarray(0,r.BYTES)),y:r.fromBytes(s.subarray(r.BYTES,2*r.BYTES))};throw new Error("Point of length ".concat(t," was invalid. Expected ").concat(i," compressed bytes or ").concat(a," uncompressed bytes"))}var o=vp(s);if(!(Gg<(u=o)&&u<r.ORDER))throw new Error("Point is not on curve");var u,c=h(o),l=r.sqrt(c);return 1===(1&n)!==((l&Qg)===Qg)&&(l=r.neg(l)),{x:o,y:l}}})),c=u.ProjectivePoint,l=u.normPrivateKeyToScalar,h=u.weierstrassEquation,f=u.isWithinCurveOrder,d=function(e){return hp(yp(e,t.nByteLength))};function p(e){return e>n>>Qg}var v=function(e,t,r){return vp(e.slice(t,r))},g=function(){function e(t,r,n){(0,hi.Z)(this,e),this.r=t,this.s=r,this.recovery=n,this.assertValidity()}return(0,fi.Z)(e,[{key:"assertValidity",value:function(){if(!f(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!f(this.s))throw new Error("s must be 0 < s < CURVE.n")}},{key:"addRecoveryBit",value:function(t){return new e(this.r,this.s,t)}},{key:"recoverPublicKey",value:function(e){var n=this.r,i=this.s,a=this.recovery,u=w(_p("msgHash",e));if(null==a||![0,1,2,3].includes(a))throw new Error("recovery id invalid");var l=2===a||3===a?n+t.n:n;if(l>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");var h=0===(1&a)?"02":"03",f=c.fromHex(h+d(l)),p=o(l),v=s(-u*p),g=s(i*p),y=c.BASE.multiplyAndAddUnsafe(f,v,g);if(!y)throw new Error("point at infinify");return y.assertValidity(),y}},{key:"hasHighS",value:function(){return p(this.s)}},{key:"normalizeS",value:function(){return this.hasHighS()?new e(this.r,s(-this.s),this.recovery):this}},{key:"toDERRawBytes",value:function(){return pp(this.toDERHex())}},{key:"toDERHex",value:function(){return Yg.hexFromSig({r:this.r,s:this.s})}},{key:"toCompactRawBytes",value:function(){return pp(this.toCompactHex())}},{key:"toCompactHex",value:function(){return d(this.r)+d(this.s)}}],[{key:"fromCompact",value:function(r){var n=t.nByteLength;return r=_p("compactSignature",r,2*n),new e(v(r,0,n),v(r,n,2*n))}},{key:"fromDER",value:function(t){var r=Yg.toSig(_p("DER",t));return new e(r.r,r.s)}}]),e}(),y={isValidPrivateKey:function(e){try{return l(e),!0}catch(t){return!1}},normPrivateKeyToScalar:l,randomPrivateKey:function(){var e=Qp(t.n);return function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e.length,i=Gp(t),a=Qp(t);if(n<16||n<a||n>1024)throw new Error("expected ".concat(a,"-1024 bytes of input, got ").concat(n));var s=Up(r?vp(e):gp(e),t-Lp)+Lp;return r?mp(s,i):yp(s,i)}(t.randomBytes(e),t.n)},precompute:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.BASE;return t._setWindowSize(e),t.multiply(BigInt(3)),t}};function m(e){var t=e instanceof Uint8Array,r="string"===typeof e,n=(t||r)&&e.length;return t?n===i||n===a:r?n===2*i||n===2*a:e instanceof c}var _=t.bits2int||function(e){var r=vp(e),n=8*e.length-t.nBitLength;return n>0?r>>BigInt(n):r},w=t.bits2int_modN||function(e){return s(_(e))},k=Ap(t.nBitLength);function x(e){if("bigint"!==typeof e)throw new Error("bigint expected");if(!(Gg<=e&&e<k))throw new Error("bigint expected < 2^".concat(t.nBitLength));return yp(e,t.nByteLength)}function E(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:S;if(["recovered","canonical"].some((function(e){return e in i})))throw new Error("sign() legacy options not supported");var a=t.hash,u=t.randomBytes,h=i.lowS,d=i.prehash,v=i.extraEntropy;null==h&&(h=!0),e=_p("msgHash",e),d&&(e=_p("prehashed msgHash",a(e)));var y=w(e),m=l(n),k=[x(m),x(y)];if(null!=v){var E=!0===v?u(r.BYTES):v;k.push(_p("extraEntropy",E))}var C=wp.apply(b,k),A=y;return{seed:C,k2sig:function(e){var t=_(e);if(f(t)){var r=o(t),n=c.BASE.multiply(t).toAffine(),i=s(n.x);if(i!==Gg){var a=s(r*s(A+i*m));if(a!==Gg){var u=(n.x===i?0:2)|Number(n.y&Qg),l=a;return h&&p(a)&&(l=function(e){return p(e)?s(-e):e}(a),u^=1),new g(i,l,u)}}}}}}var S={lowS:t.lowS,prehash:!1},C={lowS:t.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return c.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(m(e))throw new Error("first arg must be private key");if(!m(t))throw new Error("second arg must be public key");return c.fromHex(t).multiply(l(e)).toRawBytes(r)},sign:function(e,r){var n=E(e,r,arguments.length>2&&void 0!==arguments[2]?arguments[2]:S),i=n.seed,a=n.k2sig,s=t;return Tp(s.hash.outputLen,s.nByteLength,s.hmac)(i,a)},verify:function(e,r,n){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:C,u=e;if(r=_p("msgHash",r),n=_p("publicKey",n),"strict"in a)throw new Error("options.strict was renamed to lowS");var l,h=a.lowS,f=a.prehash,d=void 0;try{if("string"===typeof u||u instanceof Uint8Array)try{d=g.fromDER(u)}catch(A){if(!(A instanceof Yg.Err))throw A;d=g.fromCompact(u)}else{if("object"!==typeof u||"bigint"!==typeof u.r||"bigint"!==typeof u.s)throw new Error("PARSE");var p=u.r,v=u.s;d=new g(p,v)}l=c.fromHex(n)}catch(D){if("PARSE"===D.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(h&&d.hasHighS())return!1;f&&(r=t.hash(r));var y=d,m=y.r,b=y.s,_=w(r),k=o(b),x=s(_*k),E=s(m*k),S=null===(i=c.BASE.multiplyAndAddUnsafe(l,x,E))||void 0===i?void 0:i.toAffine();return!!S&&s(S.x)===m},ProjectivePoint:c,Signature:g,utils:y}}var ey=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),ty=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),ry=BigInt(1),ny=BigInt(2),iy=function(e,t){return(e+t/ny)/t};function ay(e){var t=ey,r=BigInt(3),n=BigInt(6),i=BigInt(11),a=BigInt(22),s=BigInt(23),o=BigInt(44),u=BigInt(88),c=e*e*e%t,l=c*c*e%t,h=jp(l,r,t)*l%t,f=jp(h,r,t)*l%t,d=jp(f,ny,t)*c%t,p=jp(d,i,t)*d%t,v=jp(p,a,t)*p%t,g=jp(v,o,t)*v%t,y=jp(g,u,t)*g%t,m=jp(y,o,t)*v%t,b=jp(m,r,t)*l%t,_=jp(b,s,t)*p%t,w=jp(_,n,t)*c%t,k=jp(w,ny,t);if(!sy.eql(sy.sqr(k),e))throw new Error("Cannot find square root");return k}var sy=Yp(ey,void 0,void 0,{sqrt:ay}),oy=function(e,t){var r=function(t){return $g((0,_e.Z)((0,_e.Z)({},e),function(e){return{hash:e,hmac:function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return qg(e,t,jd.apply(void 0,n))},randomBytes:qd}}(t)))};return Object.freeze((0,_e.Z)((0,_e.Z)({},r(t)),{},{create:r}))}({a:BigInt(0),b:BigInt(7),Fp:sy,n:ty,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:function(e){var t=ty,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-ry*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),a=r,s=BigInt("0x100000000000000000000000000000000"),o=iy(a*e,t),u=iy(-n*e,t),c=Up(e-o*r-u*i,t),l=Up(-o*n-u*a,t),h=c>s,f=l>s;if(h&&(c=t-c),f&&(l=t-l),c>s||l>s)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:h,k1:c,k2neg:f,k2:l}}}},Hg);BigInt(0);oy.ProjectivePoint;function uy(e,t){return cy.apply(this,arguments)}function cy(){return cy=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ps.digest(r);case 2:return n=e.sent,i=n.digest,e.prev=4,a=oy.sign(i,t),e.abrupt("return",a.toDERRawBytes());case 9:throw e.prev=9,e.t0=e.catch(4),new wo(String(e.t0),"ERR_INVALID_INPUT");case 12:case"end":return e.stop()}}),e,null,[[4,9]])}))),cy.apply(this,arguments)}function ly(e,t,r){return hy.apply(this,arguments)}function hy(){return hy=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ps.digest(n);case 3:return i=e.sent,a=i.digest,e.abrupt("return",oy.verify(r,a,t));case 8:throw e.prev=8,e.t0=e.catch(0),new wo(String(e.t0),"ERR_INVALID_INPUT");case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),hy.apply(this,arguments)}function fy(e){try{oy.ProjectivePoint.fromHex(e)}catch(S$){throw new wo(String(S$),"ERR_INVALID_PUBLIC_KEY")}}var dy=function(){function e(t){(0,hi.Z)(this,e),(0,we.Z)(this,"_key",void 0),fy(t),this._key=t}return(0,fi.Z)(e,[{key:"verify",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ly(this._key,r,t));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"marshal",value:function(){return e=this._key,oy.ProjectivePoint.fromHex(e).toRawBytes(!0);var e}},{key:"bytes",get:function(){return jv.encode({Type:Uv.Secp256k1,Data:this.marshal()}).subarray()}},{key:"equals",value:function(e){return Ao(this.bytes,e.bytes)}},{key:"hash",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ps.digest(this.bytes);case 2:return t=e.sent,r=t.bytes,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),py=function(){function e(t,r){(0,hi.Z)(this,e),(0,we.Z)(this,"_key",void 0),(0,we.Z)(this,"_publicKey",void 0),this._key=t,this._publicKey=null!==r&&void 0!==r?r:function(e){try{return oy.getPublicKey(e,!0)}catch(S$){throw new wo(String(S$),"ERR_INVALID_PRIVATE_KEY")}}(t),function(e){try{oy.getPublicKey(e,!0)}catch(S$){throw new wo(String(S$),"ERR_INVALID_PRIVATE_KEY")}}(this._key),fy(this._publicKey)}return(0,fi.Z)(e,[{key:"sign",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",uy(this._key,t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"public",get:function(){return new dy(this._publicKey)}},{key:"marshal",value:function(){return this._key}},{key:"bytes",get:function(){return Hv.encode({Type:Uv.Secp256k1,Data:this.marshal()}).subarray()}},{key:"equals",value:function(e){return Ao(this.bytes,e.bytes)}},{key:"hash",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ps.digest(this.bytes);case 2:return t=e.sent,r=t.bytes,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"id",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.public.hash();case 2:return t=e.sent,e.abrupt("return",Ws(t,"base58btc"));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"export",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("libp2p-key"!==(r=n.length>1&&void 0!==n[1]?n[1]:"libp2p-key")){e.next=5;break}return e.abrupt("return",Kv(this.bytes,t));case 5:throw new wo("export format '".concat(r,"' is not supported"),"ERR_INVALID_EXPORT_FORMAT");case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function vy(e){return new py(e)}function gy(e){return new dy(e)}function yy(){return my.apply(this,arguments)}function my(){return(my=(0,ai.Z)((0,ii.Z)().mark((function e(){var t;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=oy.utils.randomPrivateKey(),e.abrupt("return",new py(t));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var by={rsa:w,ed25519:_,secp256k1:k};function _y(e){var t=Object.keys(by).join(" / ");return new wo("invalid or unsupported key type ".concat(e,". Must be ").concat(t),"ERR_UNSUPPORTED_KEY_TYPE")}function wy(e){if("rsa"===(e=e.toLowerCase())||"ed25519"===e||"secp256k1"===e)return by[e];throw _y(e)}function ky(e,t){return xy.apply(this,arguments)}function xy(){return xy=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",wy(t).generateKeyPair(null!==r&&void 0!==r?r:2048));case 1:case"end":return e.stop()}}),e)}))),xy.apply(this,arguments)}function Ey(e){var t,r,n=jv.decode(e),i=null!==(t=n.Data)&&void 0!==t?t:new Uint8Array;switch(n.Type){case Uv.RSA:return by.rsa.unmarshalRsaPublicKey(i);case Uv.Ed25519:return by.ed25519.unmarshalEd25519PublicKey(i);case Uv.Secp256k1:return by.secp256k1.unmarshalSecp256k1PublicKey(i);default:throw _y(null!==(r=n.Type)&&void 0!==r?r:"unknown")}}function Sy(e,t){var r;return wy(t=(null!==(r=t)&&void 0!==r?r:"rsa").toLowerCase()),e.bytes}function Cy(e){return Ay.apply(this,arguments)}function Ay(){return Ay=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=Hv.decode(t),a=null!==(r=i.Data)&&void 0!==r?r:new Uint8Array,e.t0=i.Type,e.next=e.t0===Uv.RSA?5:e.t0===Uv.Ed25519?6:e.t0===Uv.Secp256k1?7:8;break;case 5:return e.abrupt("return",by.rsa.unmarshalRsaPrivateKey(a));case 6:return e.abrupt("return",by.ed25519.unmarshalEd25519PrivateKey(a));case 7:return e.abrupt("return",by.secp256k1.unmarshalSecp256k1PrivateKey(a));case 8:throw _y(null!==(n=i.Type)&&void 0!==n?n:"RSA");case 9:case"end":return e.stop()}}),e)}))),Ay.apply(this,arguments)}function Dy(e,t){var r;return wy(t=(null!==(r=t)&&void 0!==r?r:"rsa").toLowerCase()),e.bytes}function Ry(e,t){return Ty.apply(this,arguments)}function Ty(){return(Ty=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,cg(t,r);case 3:return n=e.sent,e.next=6,Cy(n);case 6:return e.abrupt("return",e.sent);case 9:e.prev=9,e.t0=e.catch(0);case 11:if(null!==(i=Td.pki.decryptRsaPrivateKey(t,r))){e.next=14;break}throw new wo("Cannot read the key, most likely the password is wrong or not a RSA key","ERR_CANNOT_DECRYPT_PEM");case 14:return a=Hs((a=Td.asn1.toDer(Td.pki.privateKeyToAsn1(i))).getBytes(),"ascii"),e.abrupt("return",by.rsa.unmarshalRsaPrivateKey(a));case 17:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}var Zy,Iy=Symbol.for("@libp2p/content-routing"),Py=new WeakMap,Ly=function(e){ia(r,e);var t=ua(r);function r(){var e;(0,hi.Z)(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return lo(ra(e=t.call.apply(t,[this].concat(i))),Py,{writable:!0,value:new Map}),e}return(0,fi.Z)(r,[{key:"listenerCount",value:function(e){var t=fo(this,Py).get(e);return null==t?0:t.length}},{key:"addEventListener",value:function(e,t,n){var i;yo(aa(r.prototype),"addEventListener",this).call(this,e,t,n);var a=fo(this,Py).get(e);null==a&&(a=[],fo(this,Py).set(e,a)),a.push({callback:t,once:null!==(i=!0!==n&&!1!==n&&(null===n||void 0===n?void 0:n.once))&&void 0!==i&&i})}},{key:"removeEventListener",value:function(e,t,n){yo(aa(r.prototype),"removeEventListener",this).call(this,e.toString(),null!==t&&void 0!==t?t:null,n);var i=fo(this,Py).get(e);null!=i&&(i=i.filter((function(e){return e.callback!==t})),fo(this,Py).set(e,i))}},{key:"dispatchEvent",value:function(e){var t=yo(aa(r.prototype),"dispatchEvent",this).call(this,e),n=fo(this,Py).get(e.type);return null==n||(n=n.filter((function(e){return!e.once})),fo(this,Py).set(e.type,n)),t}},{key:"safeDispatchEvent",value:function(e,t){return this.dispatchEvent(new By(e,t))}}]),r}(es(EventTarget)),My=function(e){ia(r,e);var t=ua(r);function r(e,n){var i;return(0,hi.Z)(this,r),i=t.call(this,e,n),(0,we.Z)(ra(i),"detail",void 0),i.detail=null===n||void 0===n?void 0:n.detail,i}return(0,fi.Z)(r)}(es(Event)),By=null!==(Zy=globalThis.CustomEvent)&&void 0!==Zy?Zy:My,Oy=Symbol.for("@libp2p/peer-discovery"),Ny=Symbol.for("@libp2p/peer-routing");__webpack_require__(8605);var Fy=__webpack_require__(6019),Uy={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function zy(e,t,r,n,i){if("sha1"!==i&&"sha2-256"!==i&&"sha2-512"!==i){var a=Object.keys(Uy).join(" / ");throw new wo("Hash '".concat(i,"' is unknown or not supported. Must be ").concat(a),"ERR_UNSUPPORTED_HASH_TYPE")}var s=Fy(e,t,r,n,Uy[i]);return ig.encode64(s,null)}var jy,Hy=Symbol.for("@libp2p/peer-id");function Wy(e){return null!=e&&Boolean(e[Hy])}var qy=Symbol.for("nodejs.util.inspect.custom"),Vy=Object.values(Ms).map((function(e){return e.decoder})).reduce((function(e,t){return e.or(t)}),Ms.identity.decoder),Ky=114,Yy=36,Gy=37;jy=Symbol.toStringTag;var Qy=function(){function e(t){(0,hi.Z)(this,e),(0,we.Z)(this,"type",void 0),(0,we.Z)(this,"multihash",void 0),(0,we.Z)(this,"privateKey",void 0),(0,we.Z)(this,"publicKey",void 0),(0,we.Z)(this,"string",void 0),(0,we.Z)(this,Hy,!0),this.type=t.type,this.multihash=t.multihash,this.privateKey=t.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}return(0,fi.Z)(e,[{key:jy,get:function(){return"PeerId(".concat(this.toString(),")")}},{key:"toString",value:function(){return null==this.string&&(this.string=Mi.encode(this.multihash.bytes).slice(1)),this.string}},{key:"toCID",value:function(){return Ba.createV1(Ky,this.multihash)}},{key:"toBytes",value:function(){return this.multihash.bytes}},{key:"toJSON",value:function(){return this.toString()}},{key:"equals",value:function(e){var t;if(e instanceof Uint8Array)return Ao(this.multihash.bytes,e);if("string"===typeof e)return em(e).equals(this);if(null!=(null===e||void 0===e||null===(t=e.multihash)||void 0===t?void 0:t.bytes))return Ao(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}},{key:qy,value:function(){return"PeerId(".concat(this.toString(),")")}}]),e}(),Xy=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),n=t.call(this,(0,_e.Z)((0,_e.Z)({},e),{},{type:"RSA"})),(0,we.Z)(ra(n),"type","RSA"),(0,we.Z)(ra(n),"publicKey",void 0),n.publicKey=e.publicKey,n}return(0,fi.Z)(r)}(Qy),Jy=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),n=t.call(this,(0,_e.Z)((0,_e.Z)({},e),{},{type:"Ed25519"})),(0,we.Z)(ra(n),"type","Ed25519"),(0,we.Z)(ra(n),"publicKey",void 0),n.publicKey=e.multihash.digest,n}return(0,fi.Z)(r)}(Qy),$y=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),n=t.call(this,(0,_e.Z)((0,_e.Z)({},e),{},{type:"secp256k1"})),(0,we.Z)(ra(n),"type","secp256k1"),(0,we.Z)(ra(n),"publicKey",void 0),n.publicKey=e.multihash.digest,n}return(0,fi.Z)(r)}(Qy);function em(e,t){var r;if(t=null!==(r=t)&&void 0!==r?r:Vy,"1"===e.charAt(0)||"Q"===e.charAt(0)){var n=Za(Mi.decode("z".concat(e)));return e.startsWith("12D")?new Jy({multihash:n}):e.startsWith("16U")?new $y({multihash:n}):new Xy({multihash:n})}return tm(Vy.decode(e))}function tm(e){try{var t=Za(e);if(t.code===Rs.code){if(t.digest.length===Yy)return new Jy({multihash:t});if(t.digest.length===Gy)return new $y({multihash:t})}if(t.code===Ps.code)return new Xy({multihash:t})}catch(r){return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==Ky)throw new Error("Supplied PeerID CID is invalid");var t=e.multihash;if(t.code===Ps.code)return new Xy({multihash:e.multihash});if(t.code===Rs.code){if(t.digest.length===Yy)return new Jy({multihash:e.multihash});if(t.digest.length===Gy)return new $y({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(Ba.decode(e))}throw new Error("Supplied PeerID CID is invalid")}function rm(e,t){return nm.apply(this,arguments)}function nm(){return(nm=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.length!==Yy){e.next=2;break}return e.abrupt("return",new Jy({multihash:Ta(Rs.code,t),privateKey:r}));case 2:if(t.length!==Gy){e.next=4;break}return e.abrupt("return",new $y({multihash:Ta(Rs.code,t),privateKey:r}));case 4:return e.t0=Xy,e.next=7,Ps.digest(t);case 7:return e.t1=e.sent,e.t2=t,e.t3=r,e.t4={multihash:e.t1,publicKey:e.t2,privateKey:e.t3},e.abrupt("return",new e.t0(e.t4));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var im,am=__webpack_require__(9842),sm=__webpack_require__(6327);!function(e){e.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",e.ERR_INVALID_KEY_NAME="ERR_INVALID_KEY_NAME",e.ERR_INVALID_KEY_TYPE="ERR_INVALID_KEY_TYPE",e.ERR_KEY_ALREADY_EXISTS="ERR_KEY_ALREADY_EXISTS",e.ERR_INVALID_KEY_SIZE="ERR_INVALID_KEY_SIZE",e.ERR_KEY_NOT_FOUND="ERR_KEY_NOT_FOUND",e.ERR_OLD_KEY_NAME_INVALID="ERR_OLD_KEY_NAME_INVALID",e.ERR_NEW_KEY_NAME_INVALID="ERR_NEW_KEY_NAME_INVALID",e.ERR_PASSWORD_REQUIRED="ERR_PASSWORD_REQUIRED",e.ERR_PEM_REQUIRED="ERR_PEM_REQUIRED",e.ERR_CANNOT_READ_KEY="ERR_CANNOT_READ_KEY",e.ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY",e.ERR_INVALID_OLD_PASS_TYPE="ERR_INVALID_OLD_PASS_TYPE",e.ERR_INVALID_NEW_PASS_TYPE="ERR_INVALID_NEW_PASS_TYPE",e.ERR_INVALID_PASS_LENGTH="ERR_INVALID_PASS_LENGTH"}(im||(im={}));var om=zi("libp2p:keychain"),um="/info/",cm=new WeakMap,lm=14,hm=16,fm=1e3,dm={dek:{keyLength:64,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function pm(e){return null!=e&&("string"===typeof e&&(e===sm(e.trim())&&e.length>0))}function vm(){return gm.apply(this,arguments)}function gm(){return gm=(0,ai.Z)((0,ii.Z)().mark((function e(){var t;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 200,1e3,t=800*Math.random()+200,e.next=5,new Promise((function(e){return setTimeout(e,t)}));case 5:case"end":return e.stop()}}),e)}))),gm.apply(this,arguments)}function ym(e){return new Ys("/pkcs8/"+e)}function mm(e){return new Ys(um+e)}var bm,_m=function(){function e(t,r){var n,i,a,s,o,u,c,l,h;if((0,hi.Z)(this,e),(0,we.Z)(this,"components",void 0),(0,we.Z)(this,"init",void 0),this.components=t,this.init=am(dm,r),null!=this.init.pass&&(null===(n=this.init.pass)||void 0===n?void 0:n.length)<20)throw new Error("pass must be least 20 characters");if(null!=(null===(i=this.init.dek)||void 0===i?void 0:i.keyLength)&&this.init.dek.keyLength<lm)throw new Error("dek.keyLength must be least ".concat(lm," bytes"));if(null!=(null===(a=this.init.dek)||void 0===a||null===(a=a.salt)||void 0===a?void 0:a.length)&&this.init.dek.salt.length<hm)throw new Error("dek.saltLength must be least ".concat(hm," bytes"));if(null!=(null===(s=this.init.dek)||void 0===s?void 0:s.iterationCount)&&this.init.dek.iterationCount<fm)throw new Error("dek.iterationCount must be least ".concat(fm));var f=null!=this.init.pass&&null!=(null===(o=this.init.dek)||void 0===o?void 0:o.salt)?zy(this.init.pass,null===(u=this.init.dek)||void 0===u?void 0:u.salt,null===(c=this.init.dek)||void 0===c?void 0:c.iterationCount,null===(l=this.init.dek)||void 0===l?void 0:l.keyLength,null===(h=this.init.dek)||void 0===h?void 0:h.hash):"";cm.set(this,{dek:f})}return(0,fi.Z)(e,[{key:"createKey",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c,l,h,f=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=f.length>2&&void 0!==f[2]?f[2]:2048,pm(t)&&"self"!==t){e.next=5;break}return e.next=4,vm();case 4:throw new wo("Invalid key name",im.ERR_INVALID_KEY_NAME);case 5:if("string"===typeof r){e.next=9;break}return e.next=8,vm();case 8:throw new wo("Invalid key type",im.ERR_INVALID_KEY_TYPE);case 9:return i=ym(t),e.next=12,this.components.datastore.has(i);case 12:if(!e.sent){e.next=17;break}return e.next=16,vm();case 16:throw new wo("Key name already exists",im.ERR_KEY_ALREADY_EXISTS);case 17:e.t0=r.toLowerCase(),e.next="rsa"===e.t0?20:25;break;case 20:if(Number.isSafeInteger(n)&&!(n<2048)){e.next=24;break}return e.next=23,vm();case 23:throw new wo("Invalid RSA key size",im.ERR_INVALID_KEY_SIZE);case 24:case 25:return e.abrupt("break",26);case 26:return e.prev=26,e.next=29,ky(r,n);case 29:return s=e.sent,e.next=32,s.id();case 32:if(o=e.sent,null!=(u=cm.get(this))){e.next=36;break}throw new wo("dek missing",im.ERR_INVALID_PARAMETERS);case 36:return c=u.dek,e.next=39,s.export(c);case 39:return l=e.sent,a={name:t,id:o},(h=this.components.datastore.batch()).put(i,Hs(l)),h.put(mm(t),Hs(JSON.stringify(a))),e.next=46,h.commit();case 46:e.next=53;break;case 48:return e.prev=48,e.t1=e.catch(26),e.next=52,vm();case 52:throw e.t1;case 53:return e.abrupt("return",a);case 54:case"end":return e.stop()}}),e,this,[[26,48]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"listKeys",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i,a,s,o,u;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={prefix:um},r=[],n=!1,i=!1,e.prev=4,s=ui(this.components.datastore.query(t));case 6:return e.next=8,s.next();case 8:if(!(n=!(o=e.sent).done)){e.next=14;break}u=o.value,r.push(JSON.parse(Ws(u.value)));case 11:n=!1,e.next=6;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(4),i=!0,a=e.t0;case 20:if(e.prev=20,e.prev=21,!n||null==s.return){e.next=25;break}return e.next=25,s.return();case 25:if(e.prev=25,!i){e.next=28;break}throw a;case 28:return e.finish(25);case 29:return e.finish(20);case 30:return e.abrupt("return",r);case 31:case"end":return e.stop()}}),e,this,[[4,16,20,30],[21,,25,29]])})));return function(){return e.apply(this,arguments)}}()},{key:"findKeyById",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.listKeys();case 3:if(r=e.sent,null!=(n=r.find((function(e){return e.id===t})))){e.next=7;break}throw new wo("Key with id '".concat(t,"' does not exist."),im.ERR_KEY_NOT_FOUND);case 7:return e.abrupt("return",n);case 10:return e.prev=10,e.t0=e.catch(0),e.next=14,vm();case 14:throw e.t0;case 15:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"findKeyByName",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pm(t)){e.next=4;break}return e.next=3,vm();case 3:throw new wo("Invalid key name '".concat(t,"'"),im.ERR_INVALID_KEY_NAME);case 4:return r=mm(t),e.prev=5,e.next=8,this.components.datastore.get(r);case 8:return n=e.sent,e.abrupt("return",JSON.parse(Ws(n)));case 12:return e.prev=12,e.t0=e.catch(5),e.next=16,vm();case 16:throw om.error(e.t0),new wo("Key '".concat(t,"' does not exist."),im.ERR_KEY_NOT_FOUND);case 18:case"end":return e.stop()}}),e,this,[[5,12]])})));return function(t){return e.apply(this,arguments)}}()},{key:"removeKey",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pm(t)&&"self"!==t){e.next=4;break}return e.next=3,vm();case 3:throw new wo("Invalid key name '".concat(t,"'"),im.ERR_INVALID_KEY_NAME);case 4:return r=ym(t),e.next=7,this.findKeyByName(t);case 7:return n=e.sent,(i=this.components.datastore.batch()).delete(r),i.delete(mm(t)),e.next=13,i.commit();case 13:return e.abrupt("return",n);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"renameKey",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c,l;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pm(t)&&"self"!==t){e.next=4;break}return e.next=3,vm();case 3:throw new wo("Invalid old key name '".concat(t,"'"),im.ERR_OLD_KEY_NAME_INVALID);case 4:if(pm(r)&&"self"!==r){e.next=8;break}return e.next=7,vm();case 7:throw new wo("Invalid new key name '".concat(r,"'"),im.ERR_NEW_KEY_NAME_INVALID);case 8:return n=ym(t),i=ym(r),a=mm(t),s=mm(r),e.next=14,this.components.datastore.has(i);case 14:if(!e.sent){e.next=19;break}return e.next=18,vm();case 18:throw new wo("Key '".concat(r,"' already exists"),im.ERR_KEY_ALREADY_EXISTS);case 19:return e.prev=19,e.next=22,this.components.datastore.get(n);case 22:return o=e.sent,e.next=25,this.components.datastore.get(a);case 25:return u=e.sent,(c=JSON.parse(Ws(u))).name=r,(l=this.components.datastore.batch()).put(i,o),l.put(s,Hs(JSON.stringify(c))),l.delete(n),l.delete(a),e.next=35,l.commit();case 35:return e.abrupt("return",c);case 38:return e.prev=38,e.t0=e.catch(19),e.next=42,vm();case 42:throw e.t0;case 43:case"end":return e.stop()}}),e,this,[[19,38]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"exportKey",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pm(t)){e.next=4;break}return e.next=3,vm();case 3:throw new wo("Invalid key name '".concat(t,"'"),im.ERR_INVALID_KEY_NAME);case 4:if(null!=r){e.next=8;break}return e.next=7,vm();case 7:throw new wo("Password is required",im.ERR_PASSWORD_REQUIRED);case 8:return n=ym(t),e.prev=9,e.next=12,this.components.datastore.get(n);case 12:if(i=e.sent,a=Ws(i),null!=(s=cm.get(this))){e.next=17;break}throw new wo("dek missing",im.ERR_INVALID_PARAMETERS);case 17:return o=s.dek,e.next=20,Ry(a,o);case 20:return u=e.sent,e.next=23,u.export(r);case 23:return c=e.sent,e.abrupt("return",c);case 27:return e.prev=27,e.t0=e.catch(9),e.next=31,vm();case 31:throw e.t0;case 32:case"end":return e.stop()}}),e,this,[[9,27]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"exportPeerId",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="temporary-password",e.next=3,this.exportKey(t,r);case 3:return n=e.sent,e.next=6,Ry(n,r);case 6:return i=e.sent,e.abrupt("return",rm(i.public.bytes,i.bytes));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"importKey",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a,s,o,u,c,l;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pm(t)&&"self"!==t){e.next=4;break}return e.next=3,vm();case 3:throw new wo("Invalid key name '".concat(t,"'"),im.ERR_INVALID_KEY_NAME);case 4:if(null!=r){e.next=8;break}return e.next=7,vm();case 7:throw new wo("PEM encoded key is required",im.ERR_PEM_REQUIRED);case 8:return i=ym(t),e.next=11,this.components.datastore.has(i);case 11:if(!e.sent){e.next=16;break}return e.next=15,vm();case 15:throw new wo("Key '".concat(t,"' already exists"),im.ERR_KEY_ALREADY_EXISTS);case 16:return e.prev=16,e.next=19,Ry(r,n);case 19:a=e.sent,e.next=27;break;case 22:return e.prev=22,e.t0=e.catch(16),e.next=26,vm();case 26:throw new wo("Cannot read the key, most likely the password is wrong",im.ERR_CANNOT_READ_KEY);case 27:return e.prev=27,e.next=30,a.id();case 30:if(s=e.sent,null!=(o=cm.get(this))){e.next=34;break}throw new wo("dek missing",im.ERR_INVALID_PARAMETERS);case 34:return u=o.dek,e.next=37,a.export(u);case 37:r=e.sent,e.next=45;break;case 40:return e.prev=40,e.t1=e.catch(27),e.next=44,vm();case 44:throw e.t1;case 45:return c={name:t,id:s},(l=this.components.datastore.batch()).put(i,Hs(r)),l.put(mm(t),Hs(JSON.stringify(c))),e.next=51,l.commit();case 51:return e.abrupt("return",c);case 52:case"end":return e.stop()}}),e,this,[[16,22],[27,40]])})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"importPeer",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,pm(t)){e.next=3;break}throw new wo("Invalid key name '".concat(t,"'"),im.ERR_INVALID_KEY_NAME);case 3:if(null!=r){e.next=5;break}throw new wo("PeerId is required",im.ERR_MISSING_PRIVATE_KEY);case 5:if(null!=r.privateKey){e.next=7;break}throw new wo("PeerId.privKey is required",im.ERR_MISSING_PRIVATE_KEY);case 7:return e.next=9,Cy(r.privateKey);case 9:return n=e.sent,i=ym(t),e.next=13,this.components.datastore.has(i);case 13:if(!e.sent){e.next=18;break}return e.next=17,vm();case 17:throw new wo("Key '".concat(t,"' already exists"),im.ERR_KEY_ALREADY_EXISTS);case 18:if(null!=(a=cm.get(this))){e.next=21;break}throw new wo("dek missing",im.ERR_INVALID_PARAMETERS);case 21:return s=a.dek,e.next=24,n.export(s);case 24:return o=e.sent,u={name:t,id:r.toString()},(c=this.components.datastore.batch()).put(i,Hs(o)),c.put(mm(t),Hs(JSON.stringify(u))),e.next=31,c.commit();case 31:return e.abrupt("return",u);case 34:return e.prev=34,e.t0=e.catch(0),e.next=38,vm();case 38:throw e.t0;case 39:case"end":return e.stop()}}),e,this,[[0,34]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getPrivateKey",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pm(t)){e.next=4;break}return e.next=3,vm();case 3:throw new wo("Invalid key name '".concat(t,"'"),im.ERR_INVALID_KEY_NAME);case 4:return e.prev=4,r=ym(t),e.next=8,this.components.datastore.get(r);case 8:return n=e.sent,e.abrupt("return",Ws(n));case 12:return e.prev=12,e.t0=e.catch(4),e.next=16,vm();case 16:throw om.error(e.t0),new wo("Key '".concat(t,"' does not exist."),im.ERR_KEY_NOT_FOUND);case 18:case"end":return e.stop()}}),e,this,[[4,12]])})));return function(t){return e.apply(this,arguments)}}()},{key:"rotateKeychainPass",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c,l,h,f,d,p,v,g,y,m,b,_;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"===typeof t){e.next=4;break}return e.next=3,vm();case 3:throw new wo("Invalid old pass type '".concat(typeof t,"'"),im.ERR_INVALID_OLD_PASS_TYPE);case 4:if("string"===typeof r){e.next=8;break}return e.next=7,vm();case 7:throw new wo("Invalid new pass type '".concat(typeof r,"'"),im.ERR_INVALID_NEW_PASS_TYPE);case 8:if(!(r.length<20)){e.next=12;break}return e.next=11,vm();case 11:throw new wo("Invalid pass length ".concat(r.length),im.ERR_INVALID_PASS_LENGTH);case 12:if(om("recreating keychain"),null!=(o=cm.get(this))){e.next=16;break}throw new wo("dek missing",im.ERR_INVALID_PARAMETERS);case 16:return u=o.dek,this.init.pass=r,c=null!=r&&null!=(null===(n=this.init.dek)||void 0===n?void 0:n.salt)?zy(r,this.init.dek.salt,null===(i=this.init.dek)||void 0===i?void 0:i.iterationCount,null===(a=this.init.dek)||void 0===a?void 0:a.keyLength,null===(s=this.init.dek)||void 0===s?void 0:s.hash):"",cm.set(this,{dek:c}),e.next=22,this.listKeys();case 22:l=e.sent,h=(0,ge.Z)(l),e.prev=24,h.s();case 26:if((f=h.n()).done){e.next=47;break}return d=f.value,e.next=30,this.components.datastore.get(ym(d.name));case 30:return p=e.sent,v=Ws(p),e.next=34,Ry(v,u);case 34:return g=e.sent,y=c.toString(),e.next=38,g.export(y);case 38:return m=e.sent,b=this.components.datastore.batch(),_={name:d.name,id:d.id},b.put(ym(d.name),Hs(m)),b.put(mm(d.name),Hs(JSON.stringify(_))),e.next=45,b.commit();case 45:e.next=26;break;case 47:e.next=52;break;case 49:e.prev=49,e.t0=e.catch(24),h.e(e.t0);case 52:return e.prev=52,h.f(),e.finish(52);case 55:om("keychain reconstructed");case 56:case"end":return e.stop()}}),e,this,[[24,49,52,55]])})));return function(t,r){return e.apply(this,arguments)}}()}],[{key:"generateOptions",value:function(){var e=Object.assign({},dm),t=3*Math.ceil(hm/3);return e.dek.salt=Ws(hg(t),"base64"),e}},{key:"options",get:function(){return dm}}]),e}();function wm(e,t){var r,n=(r={},(0,we.Z)(r,Symbol.iterator,(function(){return n})),(0,we.Z)(r,"next",(function(){var r=e.next(),n=r.value;return!0===r.done||null==n?{done:!0,value:void 0}:{done:!1,value:t(n)}})),r);return n}bm=Symbol.iterator;var km,xm=function(){function e(t){if((0,hi.Z)(this,e),(0,we.Z)(this,"map",void 0),this.map=new Map,null!=t){var r,n=(0,ge.Z)(t.entries());try{for(n.s();!(r=n.n()).done;){var i=(0,ke.Z)(r.value,2),a=i[0],s=i[1];this.map.set(a.toString(),s)}}catch(S$){n.e(S$)}finally{n.f()}}}return(0,fi.Z)(e,[{key:bm,value:function(){return this.entries()}},{key:"clear",value:function(){this.map.clear()}},{key:"delete",value:function(e){this.map.delete(e.toString())}},{key:"entries",value:function(){return wm(this.map.entries(),(function(e){return[em(e[0]),e[1]]}))}},{key:"forEach",value:function(e){var t=this;this.map.forEach((function(r,n){e(r,em(n),t)}))}},{key:"get",value:function(e){return this.map.get(e.toString())}},{key:"has",value:function(e){return this.map.has(e.toString())}},{key:"set",value:function(e,t){this.map.set(e.toString(),t)}},{key:"keys",value:function(){return wm(this.map.keys(),(function(e){return em(e)}))}},{key:"values",value:function(){return this.map.values()}},{key:"size",get:function(){return this.map.size}}]),e}();km=Symbol.iterator;var Em=function(){function e(t){if((0,hi.Z)(this,e),(0,we.Z)(this,"set",void 0),this.set=new Set,null!=t){var r,n=(0,ge.Z)(t);try{for(n.s();!(r=n.n()).done;){var i=r.value;this.set.add(i.toString())}}catch(S$){n.e(S$)}finally{n.f()}}}return(0,fi.Z)(e,[{key:"size",get:function(){return this.set.size}},{key:km,value:function(){return this.values()}},{key:"add",value:function(e){this.set.add(e.toString())}},{key:"clear",value:function(){this.set.clear()}},{key:"delete",value:function(e){this.set.delete(e.toString())}},{key:"entries",value:function(){return wm(this.set.entries(),(function(e){var t=em(e[0]);return[t,t]}))}},{key:"forEach",value:function(e){var t=this;this.set.forEach((function(r){var n=em(r);e(n,n,t)}))}},{key:"has",value:function(e){return this.set.has(e.toString())}},{key:"values",value:function(){return wm(this.set.values(),(function(e){return em(e)}))}},{key:"intersection",value:function(t){var r,n=new e,i=(0,ge.Z)(t);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.has(a)&&n.add(a)}}catch(S$){i.e(S$)}finally{i.f()}return n}},{key:"difference",value:function(t){var r,n=new e,i=(0,ge.Z)(this);try{for(i.s();!(r=i.n()).done;){var a=r.value;t.has(a)||n.add(a)}}catch(S$){i.e(S$)}finally{i.f()}return n}},{key:"union",value:function(t){var r,n=new e,i=(0,ge.Z)(t);try{for(i.s();!(r=i.n()).done;){var a=r.value;n.add(a)}}catch(S$){i.e(S$)}finally{i.f()}var s,o=(0,ge.Z)(this);try{for(o.s();!(s=o.n()).done;){var u=s.value;n.add(u)}}catch(S$){o.e(S$)}finally{o.f()}return n}}]),e}();Symbol.iterator;var Sm;!function(e){var t;e.codec=function(){return null==t&&(t=Xo((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&t.fork(),null!=e.id&&(t.uint32(10),t.bytes(e.id)),null!=e.pubKey&&(t.uint32(18),t.bytes(e.pubKey)),null!=e.privKey&&(t.uint32(26),t.bytes(e.privKey)),!1!==r.lengthDelimited&&t.ldelim()}),(function(e,t){for(var r={},n=null==t?e.len:e.pos+t;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.id=e.bytes();break;case 2:r.pubKey=e.bytes();break;case 3:r.privKey=e.bytes();break;default:e.skipType(7&i)}}return r}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(Sm||(Sm={}));var Cm=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ky("Ed25519");case 2:return t=e.sent,e.next=5,Am(t);case 5:if("Ed25519"!==(r=e.sent).type){e.next=8;break}return e.abrupt("return",r);case 8:throw new Error('Generated unexpected PeerId type "'.concat(r.type,'"'));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function Am(e){return Dm.apply(this,arguments)}function Dm(){return(Dm=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",rm(Sy(t.public),Dy(t)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Rm,Tm,Zm="ERR_SIGNATURE_NOT_VALID";!function(e){var t;e.codec=function(){return null==t&&(t=Xo((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&t.fork(),null!=e.publicKey&&e.publicKey.byteLength>0&&(t.uint32(10),t.bytes(e.publicKey)),null!=e.payloadType&&e.payloadType.byteLength>0&&(t.uint32(18),t.bytes(e.payloadType)),null!=e.payload&&e.payload.byteLength>0&&(t.uint32(26),t.bytes(e.payload)),null!=e.signature&&e.signature.byteLength>0&&(t.uint32(42),t.bytes(e.signature)),!1!==r.lengthDelimited&&t.ldelim()}),(function(e,t){for(var r={publicKey:new Uint8Array(0),payloadType:new Uint8Array(0),payload:new Uint8Array(0),signature:new Uint8Array(0)},n=null==t?e.len:e.pos+t;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.publicKey=e.bytes();break;case 2:r.payloadType=e.bytes();break;case 3:r.payload=e.bytes();break;case 5:r.signature=e.bytes();break;default:e.skipType(7&i)}}return r}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(Rm||(Rm={}));var Im=function(){function e(t){(0,hi.Z)(this,e),(0,we.Z)(this,"peerId",void 0),(0,we.Z)(this,"payloadType",void 0),(0,we.Z)(this,"payload",void 0),(0,we.Z)(this,"signature",void 0),(0,we.Z)(this,"marshaled",void 0);var r=t.peerId,n=t.payloadType,i=t.payload,a=t.signature;this.peerId=r,this.payloadType=n,this.payload=i,this.signature=a}return(0,fi.Z)(e,[{key:"marshal",value:function(){if(null==this.peerId.publicKey)throw new Error("Missing public key");return null==this.marshaled&&(this.marshaled=Rm.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}},{key:"equals",value:function(e){return Ao(this.marshal(),e.marshal())}},{key:"validate",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Pm(t,this.payloadType,this.payload),null!=this.peerId.publicKey){e.next=3;break}throw new Error("Missing public key");case 3:return n=Ey(this.peerId.publicKey),e.abrupt("return",n.verify(r.subarray(),this.signature));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();Tm=Im,(0,we.Z)(Im,"createFromProtobuf",function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Rm.decode(t),e.next=3,rm(r.publicKey);case 3:return n=e.sent,e.abrupt("return",new Tm({peerId:n,payloadType:r.payloadType,payload:r.payload,signature:r.signature}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,we.Z)(Im,"seal",function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=r.privateKey){e.next=2;break}throw new Error("Missing private key");case 2:return n=t.domain,i=t.codec,a=t.marshal(),s=Pm(n,i,a),e.next=8,Cy(r.privateKey);case 8:return o=e.sent,e.next=11,o.sign(s.subarray());case 11:return u=e.sent,e.abrupt("return",new Tm({peerId:r,payloadType:i,payload:a,signature:u}));case 13:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),(0,we.Z)(Im,"openAndCertify",function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Tm.createFromProtobuf(t);case 2:return n=e.sent,e.next=5,n.validate(r);case 5:if(e.sent){e.next=8;break}throw new wo("envelope signature is not valid for the given domain",Zm);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}());var Pm=function(e,t,r){var n=Hs(e),i=ku(n.byteLength),a=ku(t.length),s=ku(r.length);return new Du(i,n,a,t,s,r)};var Lm=function(){function e(){(0,hi.Z)(this,e),(0,we.Z)(this,"index",0),(0,we.Z)(this,"input","")}return(0,fi.Z)(e,[{key:"new",value:function(e){return this.index=0,this.input=e,this}},{key:"readAtomically",value:function(e){var t=this.index,r=e();return void 0===r&&(this.index=t),r}},{key:"parseWith",value:function(e){var t=e();if(this.index===this.input.length)return t}},{key:"peekChar",value:function(){if(!(this.index>=this.input.length))return this.input[this.index]}},{key:"readChar",value:function(){if(!(this.index>=this.input.length))return this.input[this.index++]}},{key:"readGivenChar",value:function(e){var t=this;return this.readAtomically((function(){var r=t.readChar();if(r===e)return r}))}},{key:"readSeparator",value:function(e,t,r){var n=this;return this.readAtomically((function(){if(!(t>0&&void 0===n.readGivenChar(e)))return r()}))}},{key:"readNumber",value:function(e,t,r,n){var i=this;return this.readAtomically((function(){var a=0,s=0,o=i.peekChar();if(void 0!==o){for(var u="0"===o,c=Math.pow(2,8*n)-1;;){var l=i.readAtomically((function(){var t=i.readChar();if(void 0!==t){var r=Number.parseInt(t,e);if(!Number.isNaN(r))return r}}));if(void 0===l)break;if(a*=e,(a+=l)>c)return;if(s+=1,void 0!==t&&s>t)return}return 0===s||!r&&u&&s>1?void 0:a}}))}},{key:"readIPv4Addr",value:function(){var e=this;return this.readAtomically((function(){for(var t=new Uint8Array(4),r=0;r<t.length;r++){var n=e.readSeparator(".",r,(function(){return e.readNumber(10,3,!1,1)}));if(void 0===n)return;t[r]=n}return t}))}},{key:"readIPv6Addr",value:function(){var e=this,t=function(t){for(var r=0;r<t.length/2;r++){var n=2*r;if(r<t.length-3){var i=e.readSeparator(":",r,(function(){return e.readIPv4Addr()}));if(void 0!==i)return t[n]=i[0],t[n+1]=i[1],t[n+2]=i[2],t[n+3]=i[3],[n+4,!0]}var a=e.readSeparator(":",r,(function(){return e.readNumber(16,4,!0,2)}));if(void 0===a)return[n,!1];t[n]=a>>8,t[n+1]=255&a}return[t.length,!1]};return this.readAtomically((function(){var r=new Uint8Array(16),n=t(r),i=(0,ke.Z)(n,2),a=i[0],s=i[1];if(16===a)return r;if(!s&&void 0!==e.readGivenChar(":")&&void 0!==e.readGivenChar(":")){var o=new Uint8Array(14),u=16-(a+2),c=t(o.subarray(0,u)),l=(0,ke.Z)(c,1)[0];return r.set(o.subarray(0,l),16-l),r}}))}},{key:"readIPAddr",value:function(){var e;return null!==(e=this.readIPv4Addr())&&void 0!==e?e:this.readIPv6Addr()}}]),e}(),Mm=45,Bm=15,Om=new Lm;parseInt("0xFFFF",16),new Uint8Array([0,0,0,0,0,0,0,0,0,0,255,255]);function Nm(e){return Boolean(function(e){if(!(e.length>Bm))return Om.new(e).parseWith((function(){return Om.readIPv4Addr()}))}(e))}function Fm(e){return Boolean(function(e){if(e.includes("%")&&(e=e.split("%")[0]),!(e.length>Mm))return Om.new(e).parseWith((function(){return Om.readIPv6Addr()}))}(e))}function Um(e){return Boolean(function(e){if(e.includes("%")&&(e=e.split("%")[0]),!(e.length>Mm))return Om.new(e).parseWith((function(){return Om.readIPAddr()}))}(e))}var zm=Nm,jm=Fm,Hm=function e(t){var r=0;if(t=t.toString().trim(),zm(t)){var n=new Uint8Array(r+4);return t.split(/\./g).forEach((function(e){n[r++]=255&parseInt(e,10)})),n}if(jm(t)){var i,a=t.split(":",8);for(i=0;i<a.length;i++){var s=void 0;zm(a[i])&&(s=e(a[i]),a[i]=Ws(s.slice(0,2),"base16")),null!=s&&++i<8&&a.splice(i,0,Ws(s.slice(2,4),"base16"))}if(""===a[0])for(;a.length<8;)a.unshift("0");else if(""===a[a.length-1])for(;a.length<8;)a.push("0");else if(a.length<8){for(i=0;i<a.length&&""!==a[i];i++);var o=[i,1];for(i=9-a.length;i>0;i--)o.push("0");a.splice.apply(a,o)}var u=new Uint8Array(r+16);for(i=0;i<a.length;i++){var c=parseInt(a[i],16);u[r++]=c>>8&255,u[r++]=255&c}return u}throw new Error("invalid ip address")},Wm=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;r=~~r,n=null!==(t=n)&&void 0!==t?t:e.length-r;var i=new DataView(e.buffer);if(4===n){for(var a=[],s=0;s<n;s++)a.push(e[r+s]);return a.join(".")}if(16===n){for(var o=[],u=0;u<n;u+=2)o.push(i.getUint16(r+u).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},qm=-1,Vm={},Km={};function Ym(e,t,r,n,i){return{code:e,size:t,name:r,resolvable:Boolean(n),path:Boolean(i)}}function Gm(e){if("number"===typeof e){if(null!=Km[e])return Km[e];throw new Error("no protocol with code: ".concat(e))}if("string"===typeof e){if(null!=Vm[e])return Vm[e];throw new Error("no protocol with name: ".concat(e))}throw new Error("invalid protocol id type: ".concat(typeof e))}[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,qm,"ip6zone"],[43,8,"ipcidr"],[53,qm,"dns",!0],[54,qm,"dns4",!0],[55,qm,"dns6",!0],[56,qm,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,qm,"unix",!1,!0],[421,qm,"ipfs"],[421,qm,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,qm,"garlic64"],[448,0,"tls"],[449,qm,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,qm,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,qm,"memory"]].forEach((function(e){var t=Ym.apply(void 0,be(e));Km[t.code]=t,Vm[t.name]=t}));Gm("ip4"),Gm("ip6"),Gm("ipcidr");function Qm(e,t){switch(Gm(e).code){case 4:case 41:return function(e){var t=Wm(e,0,e.length);if(null==t)throw new Error("ipBuff is required");if(!Um(t))throw new Error("invalid ip address");return t}(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return ib(t);case 6:case 273:case 33:case 132:return rb(t).toString();case 421:return function(e){var t=xu(e),r=e.slice(wu(t));if(r.length!==t)throw new Error("inconsistent lengths");return Ws(r,"base58btc")}(t);case 444:case 445:return ab(t);case 466:return function(e){var t=xu(e),r=e.slice(wu(t));if(r.length!==t)throw new Error("inconsistent lengths");return"u"+Ws(r,"base64url")}(t);default:return Ws(t,"base16")}}function Xm(e,t){switch(Gm(e).code){case 4:case 41:return eb(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return nb(t);case 6:case 273:case 33:case 132:return tb(parseInt(t,10));case 421:return function(e){var t;t="Q"===e[0]||"1"===e[0]?Za(Mi.decode("z".concat(e))).bytes:Ba.parse(e).multihash.bytes;var r=Uint8Array.from(ku(t.length));return Eu([r,t],r.length+t.length)}(t);case 444:return function(e){var t=e.split(":");if(2!==t.length)throw new Error("failed to parse onion addr: [\"'".concat(t.join('", "'),"'\"]' does not contain a port number"));if(16!==t[0].length)throw new Error("failed to parse onion addr: ".concat(t[0]," not a Tor onion address."));var r=Ci.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");var i=tb(n);return Eu([r,i],r.length+i.length)}(t);case 445:return function(e){var t=e.split(":");if(2!==t.length)throw new Error("failed to parse onion addr: [\"'".concat(t.join('", "'),"'\"]' does not contain a port number"));if(56!==t[0].length)throw new Error("failed to parse onion addr: ".concat(t[0]," not a Tor onion3 address."));var r=Ci.decode("b".concat(t[0])),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");var i=tb(n);return Eu([r,i],r.length+i.length)}(t);case 466:return function(e){var t=$m.decode(e),r=Uint8Array.from(ku(t.length));return Eu([r,t],r.length+t.length)}(t);default:return Hs(t,"base16")}}var Jm=Object.values(Ms).map((function(e){return e.decoder})),$m=function(){var e=Jm[0].or(Jm[1]);return Jm.slice(2).forEach((function(t){return e=e.or(t)})),e}();function eb(e){if(!Um(e))throw new Error("invalid ip address");return Hm(e)}function tb(e){var t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function rb(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function nb(e){var t=Hs(e),r=Uint8Array.from(ku(t.length));return Eu([r,t],r.length+t.length)}function ib(e){var t=xu(e);if((e=e.slice(wu(t))).length!==t)throw new Error("inconsistent lengths");return Ws(e)}function ab(e){var t=e.slice(0,e.length-2),r=e.slice(e.length-2),n=Ws(t,"base32"),i=rb(r);return"".concat(n,":").concat(i)}function sb(e){for(var t=[],r=[],n=null,i=0;i<e.length;){var a=xu(e,i),s=wu(a),o=Gm(a),u=cb(o,e.slice(i+s));if(0!==u){var c=e.slice(i+s,i+s+u);if((i+=u+s)>e.length)throw hb("Invalid address Uint8Array: "+Ws(e,"base16"));t.push([a,c]);var l=Qm(a,c);if(r.push([a,l]),!0===o.path){n=l;break}}else t.push([a]),r.push([a]),i+=s}return{bytes:Uint8Array.from(e),string:ob(r),tuples:t,stringTuples:r,path:n}}function ob(e){var t=[];return e.map((function(e){var r=Gm(e[0]);return t.push(r.name),e.length>1&&null!=e[1]&&t.push(e[1]),null})),lb(t.join("/"))}function ub(e){return Eu(e.map((function(e){var t=Gm(e[0]),r=Uint8Array.from(ku(t.code));return e.length>1&&null!=e[1]&&(r=Eu([r,e[1]])),r})))}function cb(e,t){if(e.size>0)return e.size/8;if(0===e.size)return 0;var r=xu(t instanceof Uint8Array?t:Uint8Array.from(t));return r+wu(r)}function lb(e){return"/"+e.trim().split("/").filter((function(e){return e})).join("/")}function hb(e){return new Error("Error parsing address: "+e)}var fb=Symbol.for("nodejs.util.inspect.custom"),db=[Gm("dns").code,Gm("dns4").code,Gm("dns6").code,Gm("dnsaddr").code],pb=new Map,vb=Symbol.for("@multiformats/js-multiaddr/multiaddr");function gb(e){return Boolean(null===e||void 0===e?void 0:e[vb])}var yb=new WeakMap,mb=new WeakMap,bb=new WeakMap,_b=new WeakMap,wb=function(){function e(t){var r;if((0,hi.Z)(this,e),(0,we.Z)(this,"bytes",void 0),lo(this,yb,{writable:!0,value:void 0}),lo(this,mb,{writable:!0,value:void 0}),lo(this,bb,{writable:!0,value:void 0}),lo(this,_b,{writable:!0,value:void 0}),(0,we.Z)(this,vb,!0),null==t&&(t=""),t instanceof Uint8Array)r=sb(t);else if("string"===typeof t){if(t.length>0&&"/"!==t.charAt(0))throw new Error('multiaddr "'.concat(t,'" must start with a "/"'));r=function(e){var t=[],r=[],n=null,i=(e=lb(e)).split("/").slice(1);if(1===i.length&&""===i[0])return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(var a=0;a<i.length;a++){var s=Gm(i[a]);if(0!==s.size){if(++a>=i.length)throw hb("invalid address: "+e);if(!0===s.path){n=lb(i.slice(a).join("/")),t.push([s.code,Xm(s.code,n)]),r.push([s.code,n]);break}var o=Xm(s.code,i[a]);t.push([s.code,o]),r.push([s.code,Qm(s.code,o)])}else t.push([s.code]),r.push([s.code])}return{string:ob(r),bytes:ub(t),tuples:t,stringTuples:r,path:n}}(t)}else{if(!gb(t))throw new Error("addr must be a string, Buffer, or another Multiaddr");r=sb(t.bytes)}this.bytes=r.bytes,po(this,yb,r.string),po(this,mb,r.tuples),po(this,bb,r.stringTuples),po(this,_b,r.path)}return(0,fi.Z)(e,[{key:"toString",value:function(){return fo(this,yb)}},{key:"toJSON",value:function(){return this.toString()}},{key:"toOptions",value:function(){var e,t,r,n,i,a="",s=Gm("tcp"),o=Gm("udp"),u=Gm("ip4"),c=Gm("ip6"),l=Gm("dns6"),h=Gm("ip6zone"),f=(0,ge.Z)(this.stringTuples());try{for(f.s();!(i=f.n()).done;){var d=(0,ke.Z)(i.value,2),p=d[0],v=d[1];p===h.code&&(a="%".concat(null!==v&&void 0!==v?v:"")),db.includes(p)&&(t=s.name,n=443,r="".concat(null!==v&&void 0!==v?v:"").concat(a),e=p===l.code?6:4),p!==s.code&&p!==o.code||(t=Gm(p).name,n=parseInt(null!==v&&void 0!==v?v:"")),p!==u.code&&p!==c.code||(t=Gm(p).name,r="".concat(null!==v&&void 0!==v?v:"").concat(a),e=p===c.code?6:4)}}catch(S$){f.e(S$)}finally{f.f()}if(null==e||null==t||null==r||null==n)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:r,transport:t,port:n}}},{key:"protos",value:function(){return fo(this,mb).map((function(e){var t=(0,ke.Z)(e,1)[0];return Object.assign({},Gm(t))}))}},{key:"protoCodes",value:function(){return fo(this,mb).map((function(e){return(0,ke.Z)(e,1)[0]}))}},{key:"protoNames",value:function(){return fo(this,mb).map((function(e){return Gm((0,ke.Z)(e,1)[0]).name}))}},{key:"tuples",value:function(){return fo(this,mb)}},{key:"stringTuples",value:function(){return fo(this,bb)}},{key:"encapsulate",value:function(t){return t=new e(t),new e(this.toString()+t.toString())}},{key:"decapsulate",value:function(t){var r=t.toString(),n=this.toString(),i=n.lastIndexOf(r);if(i<0)throw new Error("Address ".concat(this.toString()," does not contain subaddress: ").concat(t.toString()));return new e(n.slice(0,i))}},{key:"decapsulateCode",value:function(t){for(var r=this.tuples(),n=r.length-1;n>=0;n--)if(r[n][0]===t)return new e(ub(r.slice(0,n)));return this}},{key:"getPeerId",value:function(){try{var e=[];this.stringTuples().forEach((function(t){var r=(0,ke.Z)(t,2),n=r[0],i=r[1];n===Vm.p2p.code&&e.push([n,i]),n===Vm["p2p-circuit"].code&&(e=[])}));var t=e.pop();if(null!=(null===t||void 0===t?void 0:t[1])){var r=t[1];return"Q"===r[0]||"1"===r[0]?Ws(Mi.decode("z".concat(r)),"base58btc"):Ws(Ba.parse(r).multihash.bytes,"base58btc")}return null}catch(n){return null}}},{key:"getPath",value:function(){return fo(this,_b)}},{key:"equals",value:function(e){return Ao(this.bytes,e.bytes)}},{key:"resolve",value:function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(n=this.protos().find((function(e){return e.resolvable})))){t.next=3;break}return t.abrupt("return",[this]);case 3:if(null!=(i=pb.get(n.name))){t.next=6;break}throw new wo("no available resolver for ".concat(n.name),"ERR_NO_AVAILABLE_RESOLVER");case 6:return t.next=8,i(this,r);case 8:return a=t.sent,t.abrupt("return",a.map((function(t){return new e(t)})));case 10:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"nodeAddress",value:function(){var e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error('multiaddr must have a valid format - no protocol with name: "'.concat(e.transport,'". Must have a valid transport protocol: "{tcp, udp}"'));return{family:e.family,address:e.host,port:e.port}}},{key:"isThinWaistAddress",value:function(e){var t=(null!==e&&void 0!==e?e:this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))}},{key:fb,value:function(){return"Multiaddr(".concat(fo(this,yb),")")}}]),e}();function kb(e){return new wb(e)}var xb,Eb,Sb=Uint8Array.from([3,1]);!function(e){var t;!function(e){var t;e.codec=function(){return null==t&&(t=Xo((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&t.fork(),null!=e.multiaddr&&e.multiaddr.byteLength>0&&(t.uint32(10),t.bytes(e.multiaddr)),!1!==r.lengthDelimited&&t.ldelim()}),(function(e,t){for(var r={multiaddr:new Uint8Array(0)},n=null==t?e.len:e.pos+t;e.pos<n;){var i=e.uint32();if(i>>>3===1)r.multiaddr=e.bytes();else e.skipType(7&i)}return r}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(e.AddressInfo||(e.AddressInfo={})),e.codec=function(){return null==t&&(t=Xo((function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&r.fork(),null!=t.peerId&&t.peerId.byteLength>0&&(r.uint32(10),r.bytes(t.peerId)),null!=t.seq&&0n!==t.seq&&(r.uint32(16),r.uint64(t.seq)),null!=t.addresses){var i,a=(0,ge.Z)(t.addresses);try{for(a.s();!(i=a.n()).done;){var s=i.value;r.uint32(26),e.AddressInfo.codec().encode(s,r)}}catch(S$){a.e(S$)}finally{a.f()}}!1!==n.lengthDelimited&&r.ldelim()}),(function(t,r){for(var n={peerId:new Uint8Array(0),seq:0n,addresses:[]},i=null==r?t.len:t.pos+r;t.pos<i;){var a=t.uint32();switch(a>>>3){case 1:n.peerId=t.bytes();break;case 2:n.seq=t.uint64();break;case 3:n.addresses.push(e.AddressInfo.codec().decode(t,t.uint32()));break;default:t.skipType(7&a)}}return n}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(xb||(xb={}));var Cb=function(){function e(t){(0,hi.Z)(this,e),(0,we.Z)(this,"peerId",void 0),(0,we.Z)(this,"multiaddrs",void 0),(0,we.Z)(this,"seqNumber",void 0),(0,we.Z)(this,"domain",e.DOMAIN),(0,we.Z)(this,"codec",e.CODEC),(0,we.Z)(this,"marshaled",void 0);var r=t.peerId,n=t.multiaddrs,i=t.seqNumber;this.peerId=r,this.multiaddrs=null!==n&&void 0!==n?n:[],this.seqNumber=null!==i&&void 0!==i?i:BigInt(Date.now())}return(0,fi.Z)(e,[{key:"marshal",value:function(){return null==this.marshaled&&(this.marshaled=xb.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map((function(e){return{multiaddr:e.bytes}}))})),this.marshaled}},{key:"equals",value:function(t){return t instanceof e&&(!!this.peerId.equals(t.peerId)&&(this.seqNumber===t.seqNumber&&!!function(e,t){var r=function(e,t){return e.toString().localeCompare(t.toString())};return e.length===t.length&&(t.sort(r),e.sort(r).every((function(e,r){return t[r].equals(e)})))}(this.multiaddrs,t.multiaddrs)))}}]),e}();Eb=Cb,(0,we.Z)(Cb,"createFromProtobuf",(function(e){var t,r=xb.decode(e),n=tm(r.peerId),i=(null!==(t=r.addresses)&&void 0!==t?t:[]).map((function(e){return kb(e.multiaddr)})),a=r.seq;return new Eb({peerId:n,multiaddrs:i,seqNumber:a})})),(0,we.Z)(Cb,"DOMAIN","libp2p-peer-record"),(0,we.Z)(Cb,"CODEC",Sb);var Ab,Db,Rb,Tb={ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS"};function Zb(e,t){var r,n=Ab.decode(t);null!=n.publicKey&&null==e.publicKey&&(e=function(e){if("RSA"===e.type)return new Xy(e);if("Ed25519"===e.type)return new Jy(e);if("secp256k1"===e.type)return new $y(e);throw new wo("Not a PeerId","ERR_INVALID_PARAMETERS")}((0,_e.Z)((0,_e.Z)({},e),{},{publicKey:e.publicKey})));var i,a=new Map,s=BigInt(Date.now()),o=(0,ge.Z)(n.tags.entries());try{for(o.s();!(i=o.n()).done;){var u=(0,ke.Z)(i.value,2),c=u[0],l=u[1];null!=l.expiry&&l.expiry<s||a.set(c,l)}}catch(S$){o.e(S$)}finally{o.f()}return(0,_e.Z)((0,_e.Z)({},n),{},{id:e,addresses:n.addresses.map((function(e){var t=e.multiaddr,r=e.isCertified;return{multiaddr:kb(t),isCertified:null!==r&&void 0!==r&&r}})),metadata:n.metadata,peerRecordEnvelope:null!==(r=n.peerRecordEnvelope)&&void 0!==r?r:void 0,tags:a})}!function(e){var t;!function(e){var t;e.codec=function(){return null==t&&(t=Xo((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&t.fork(),null!=e.key&&""!==e.key&&(t.uint32(10),t.string(e.key)),null!=e.value&&e.value.byteLength>0&&(t.uint32(18),t.bytes(e.value)),!1!==r.lengthDelimited&&t.ldelim()}),(function(e,t){for(var r={key:"",value:new Uint8Array(0)},n=null==t?e.len:e.pos+t;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.key=e.string();break;case 2:r.value=e.bytes();break;default:e.skipType(7&i)}}return r}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(e.Peer$metadataEntry||(e.Peer$metadataEntry={})),function(e){var t;e.codec=function(){return null==t&&(t=Xo((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&t.fork(),null!=e.key&&""!==e.key&&(t.uint32(10),t.string(e.key)),null!=e.value&&(t.uint32(18),Rb.codec().encode(e.value,t)),!1!==r.lengthDelimited&&t.ldelim()}),(function(e,t){for(var r={key:""},n=null==t?e.len:e.pos+t;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.key=e.string();break;case 2:r.value=Rb.codec().decode(e,e.uint32());break;default:e.skipType(7&i)}}return r}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(e.Peer$tagsEntry||(e.Peer$tagsEntry={})),e.codec=function(){return null==t&&(t=Xo((function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&r.fork(),null!=t.addresses){var i,a=(0,ge.Z)(t.addresses);try{for(a.s();!(i=a.n()).done;){var s=i.value;r.uint32(10),Db.codec().encode(s,r)}}catch(S$){a.e(S$)}finally{a.f()}}if(null!=t.protocols){var o,u=(0,ge.Z)(t.protocols);try{for(u.s();!(o=u.n()).done;){var c=o.value;r.uint32(18),r.string(c)}}catch(S$){u.e(S$)}finally{u.f()}}if(null!=t.publicKey&&(r.uint32(34),r.bytes(t.publicKey)),null!=t.peerRecordEnvelope&&(r.uint32(42),r.bytes(t.peerRecordEnvelope)),null!=t.metadata&&0!==t.metadata.size){var l,h=(0,ge.Z)(t.metadata.entries());try{for(h.s();!(l=h.n()).done;){var f=(0,ke.Z)(l.value,2),d=f[0],p=f[1];r.uint32(50),e.Peer$metadataEntry.codec().encode({key:d,value:p},r)}}catch(S$){h.e(S$)}finally{h.f()}}if(null!=t.tags&&0!==t.tags.size){var v,g=(0,ge.Z)(t.tags.entries());try{for(g.s();!(v=g.n()).done;){var y=(0,ke.Z)(v.value,2),m=y[0],b=y[1];r.uint32(58),e.Peer$tagsEntry.codec().encode({key:m,value:b},r)}}catch(S$){g.e(S$)}finally{g.f()}}!1!==n.lengthDelimited&&r.ldelim()}),(function(t,r){for(var n={addresses:[],protocols:[],metadata:new Map,tags:new Map},i=null==r?t.len:t.pos+r;t.pos<i;){var a=t.uint32();switch(a>>>3){case 1:n.addresses.push(Db.codec().decode(t,t.uint32()));break;case 2:n.protocols.push(t.string());break;case 4:n.publicKey=t.bytes();break;case 5:n.peerRecordEnvelope=t.bytes();break;case 6:var s=e.Peer$metadataEntry.codec().decode(t,t.uint32());n.metadata.set(s.key,s.value);break;case 7:var o=e.Peer$tagsEntry.codec().decode(t,t.uint32());n.tags.set(o.key,o.value);break;default:t.skipType(7&a)}}return n}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(Ab||(Ab={})),function(e){var t;e.codec=function(){return null==t&&(t=Xo((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&t.fork(),null!=e.multiaddr&&e.multiaddr.byteLength>0&&(t.uint32(10),t.bytes(e.multiaddr)),null!=e.isCertified&&(t.uint32(16),t.bool(e.isCertified)),!1!==r.lengthDelimited&&t.ldelim()}),(function(e,t){for(var r={multiaddr:new Uint8Array(0)},n=null==t?e.len:e.pos+t;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.multiaddr=e.bytes();break;case 2:r.isCertified=e.bool();break;default:e.skipType(7&i)}}return r}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(Db||(Db={})),function(e){var t;e.codec=function(){return null==t&&(t=Xo((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&t.fork(),null!=e.value&&0!==e.value&&(t.uint32(8),t.uint32(e.value)),null!=e.expiry&&(t.uint32(16),t.uint64(e.expiry)),!1!==r.lengthDelimited&&t.ldelim()}),(function(e,t){for(var r={value:0},n=null==t?e.len:e.pos+t;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.value=e.uint32();break;case 2:r.expiry=e.uint64();break;default:e.skipType(7&i)}}return r}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(Rb||(Rb={}));var Ib="/peers/";function Pb(e){if(!Wy(e)||null==e.type)throw new wo("Invalid PeerId",Tb.ERR_INVALID_PARAMETERS);var t=e.toCID().toString();return new Ys("".concat(Ib).concat(t))}function Lb(e,t,r){return Mb.apply(this,arguments)}function Mb(){return Mb=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a,s,o,u,c,l,h;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=new Map,a=(0,ge.Z)(n),e.prev=2,a.s();case 4:if((s=a.n()).done){e.next=21;break}if(null!=(u=s.value)){e.next=8;break}return e.abrupt("continue",19);case 8:if(u.multiaddr instanceof Uint8Array&&(u.multiaddr=kb(u.multiaddr)),gb(u.multiaddr)){e.next=11;break}throw new wo("Multiaddr was invalid",Tb.ERR_INVALID_PARAMETERS);case 11:return e.next=13,r(t,u.multiaddr);case 13:if(e.sent){e.next=15;break}return e.abrupt("continue",19);case 15:c=null!==(o=u.isCertified)&&void 0!==o&&o,l=u.multiaddr.toString(),null!=(h=i.get(l))?u.isCertified=h.isCertified||c:i.set(l,{multiaddr:u.multiaddr,isCertified:c});case 19:e.next=4;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(2),a.e(e.t0);case 26:return e.prev=26,a.f(),e.finish(26);case 29:return e.abrupt("return",be(i.values()).sort((function(e,t){return e.multiaddr.toString().localeCompare(t.multiaddr.toString())})).map((function(e){return{isCertified:e.isCertified,multiaddr:e.multiaddr.bytes}})));case 30:case"end":return e.stop()}}),e,null,[[2,23,26,29]])}))),Mb.apply(this,arguments)}function Bb(e,t,r,n){return Ob.apply(this,arguments)}function Ob(){return Ob=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i){var a,s,o,u,c,l,h,f,d,p,v,g,y,m,b,_,w,k,x,E,S,C,A,D,R,T,Z,I,P,L,M,B,O;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=r){e.next=2;break}throw new wo("Invalid PeerData",Tb.ERR_INVALID_PARAMETERS);case 2:if(null==r.publicKey||null==t.publicKey||Ao(r.publicKey,t.publicKey)){e.next=4;break}throw new wo("publicKey bytes do not match peer id publicKey bytes",Tb.ERR_INVALID_PARAMETERS);case 4:if(null==(f=i.existingPeer)||t.equals(f.id)){e.next=7;break}throw new wo("peer id did not match existing peer id",Tb.ERR_INVALID_PARAMETERS);case 7:if(d=null!==(a=null===f||void 0===f?void 0:f.addresses)&&void 0!==a?a:[],p=new Set(null!==(s=null===f||void 0===f?void 0:f.protocols)&&void 0!==s?s:[]),v=null!==(o=null===f||void 0===f?void 0:f.metadata)&&void 0!==o?o:new Map,g=null!==(u=null===f||void 0===f?void 0:f.tags)&&void 0!==u?u:new Map,y=null===f||void 0===f?void 0:f.peerRecordEnvelope,"patch"===n&&(null==r.multiaddrs&&null==r.addresses||(d=[],null!=r.multiaddrs&&(m=d).push.apply(m,be(r.multiaddrs.map((function(e){return{isCertified:!1,multiaddr:e}})))),null!=r.addresses&&(b=d).push.apply(b,be(r.addresses))),null!=r.protocols&&(p=new Set(r.protocols)),null!=r.metadata&&(_=r.metadata instanceof Map?be(r.metadata.entries()):Object.entries(r.metadata),v=Nb(_,{validate:Fb})),null!=r.tags&&(w=r.tags instanceof Map?be(r.tags.entries()):Object.entries(r.tags),g=Nb(w,{validate:Ub,map:zb})),null!=r.peerRecordEnvelope&&(y=r.peerRecordEnvelope)),"merge"===n){if(null!=r.multiaddrs&&(k=d).push.apply(k,be(r.multiaddrs.map((function(e){return{isCertified:!1,multiaddr:e}})))),null!=r.addresses&&(x=d).push.apply(x,be(r.addresses)),null!=r.protocols&&(p=new Set([].concat(be(p),be(r.protocols)))),null!=r.metadata){E=r.metadata instanceof Map?be(r.metadata.entries()):Object.entries(r.metadata),S=(0,ge.Z)(E);try{for(S.s();!(C=S.n()).done;)A=(0,ke.Z)(C.value,2),D=A[0],null==(R=A[1])?v.delete(D):v.set(D,R)}catch(S$){S.e(S$)}finally{S.f()}v=Nb(be(v.entries()),{validate:Fb})}if(null!=r.tags){T=r.tags instanceof Map?be(r.tags.entries()):Object.entries(r.tags),Z=new Map(g),I=(0,ge.Z)(T);try{for(I.s();!(P=I.n()).done;)L=(0,ke.Z)(P.value,2),M=L[0],null==(B=L[1])?Z.delete(M):Z.set(M,B)}catch(S$){I.e(S$)}finally{I.f()}g=Nb(be(Z.entries()),{validate:Ub,map:zb})}null!=r.peerRecordEnvelope&&(y=r.peerRecordEnvelope)}return e.next=16,Lb(t,null!==(c=i.addressFilter)&&void 0!==c?c:(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)}))),d);case 16:return e.t0=e.sent,e.t1=be(p.values()).sort((function(e,t){return e.localeCompare(t)})),e.t2=v,e.t3=g,e.t4=null!==(l=null!==(h=null===f||void 0===f?void 0:f.id.publicKey)&&void 0!==h?h:r.publicKey)&&void 0!==l?l:t.publicKey,e.t5=y,O={addresses:e.t0,protocols:e.t1,metadata:e.t2,tags:e.t3,publicKey:e.t4,peerRecordEnvelope:e.t5},"RSA"!==t.type&&delete O.publicKey,e.abrupt("return",O);case 25:case"end":return e.stop()}}),e)}))),Ob.apply(this,arguments)}function Nb(e,t){var r,n=new Map,i=(0,ge.Z)(e);try{for(i.s();!(r=i.n()).done;){var a=(0,ke.Z)(r.value,2),s=a[0],o=a[1];null!=o&&t.validate(s,o)}}catch(S$){i.e(S$)}finally{i.f()}var u,c=(0,ge.Z)(e.sort((function(e,t){var r=(0,ke.Z)(e,1)[0],n=(0,ke.Z)(t,1)[0];return r.localeCompare(n)})));try{for(c.s();!(u=c.n()).done;){var l,h,f=(0,ke.Z)(u.value,2),d=f[0],p=f[1];if(null!=p)n.set(d,null!==(l=null===(h=t.map)||void 0===h?void 0:h.call(t,d,p))&&void 0!==l?l:p)}}catch(S$){c.e(S$)}finally{c.f()}return n}function Fb(e,t){if("string"!==typeof e)throw new wo("Metadata key must be a string",Tb.ERR_INVALID_PARAMETERS);if(!(t instanceof Uint8Array))throw new wo("Metadata value must be a Uint8Array",Tb.ERR_INVALID_PARAMETERS)}function Ub(e,t){if("string"!==typeof e)throw new wo("Tag name must be a string",Tb.ERR_INVALID_PARAMETERS);if(null!=t.value){if(parseInt("".concat(t.value),10)!==t.value)throw new wo("Tag value must be an integer",Tb.ERR_INVALID_PARAMETERS);if(t.value<0||t.value>100)throw new wo("Tag value must be between 0-100",Tb.ERR_INVALID_PARAMETERS)}if(null!=t.ttl){if(parseInt("".concat(t.ttl),10)!==t.ttl)throw new wo("Tag ttl must be an integer",Tb.ERR_INVALID_PARAMETERS);if(t.ttl<0)throw new wo("Tag ttl must be between greater than 0",Tb.ERR_INVALID_PARAMETERS)}}function zb(e,t){var r,n;return null!=t.expiry&&(n=t.expiry),null!=t.ttl&&(n=BigInt(Date.now()+Number(t.ttl))),{value:null!==(r=t.value)&&void 0!==r?r:0,expiry:n}}function jb(e,t,r){var n=e.toString().split("/")[2],i=tm(Ci.decode(n)),a=r.get(i);if(null!=a)return a;var s=Zb(i,t);return r.set(i,s),s}function Hb(e,t){var r,n;return null==e?{}:{prefix:Ib,filters:(null!==(r=e.filters)&&void 0!==r?r:[]).map((function(e){return function(r){var n=r.key,i=r.value;return e(jb(n,i,t))}})),orders:(null!==(n=e.orders)&&void 0!==n?n:[]).map((function(e){return function(r,n){return e(jb(r.key,r.value,t),jb(n.key,n.value,t))}}))}}var Wb=new WeakSet,qb=new WeakSet,Vb=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,hi.Z)(this,e),ic(this,qb),ic(this,Wb),(0,we.Z)(this,"peerId",void 0),(0,we.Z)(this,"datastore",void 0),(0,we.Z)(this,"lock",void 0),(0,we.Z)(this,"addressFilter",void 0),this.peerId=t.peerId,this.datastore=t.datastore,this.addressFilter=r.addressFilter,this.lock=_d({name:"peer-store",singleProcess:!0})}return(0,fi.Z)(e,[{key:"has",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.datastore.has(Pb(t)));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.peerId.equals(t)){e.next=2;break}throw new wo("Cannot delete self peer",Tb.ERR_INVALID_PARAMETERS);case 2:return e.next=4,this.datastore.delete(Pb(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.datastore.get(Pb(t));case 2:return r=e.sent,e.abrupt("return",Zb(t,r));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ac(this,Wb,Kb).call(this,t);case 2:return n=e.sent,i=n.existingBuf,a=n.existingPeer,e.next=7,Bb(t,r,"patch",{addressFilter:this.addressFilter});case 7:return s=e.sent,e.abrupt("return",ac(this,qb,Gb).call(this,t,s,i,a));case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"patch",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ac(this,Wb,Kb).call(this,t);case 2:return n=e.sent,i=n.existingBuf,a=n.existingPeer,e.next=7,Bb(t,r,"patch",{addressFilter:this.addressFilter,existingPeer:a});case 7:return s=e.sent,e.abrupt("return",ac(this,qb,Gb).call(this,t,s,i,a));case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"merge",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ac(this,Wb,Kb).call(this,t);case 2:return n=e.sent,i=n.existingBuf,a=n.existingPeer,e.next=7,Bb(t,r,"merge",{addressFilter:this.addressFilter,existingPeer:a});case 7:return s=e.sent,e.abrupt("return",ac(this,qb,Gb).call(this,t,s,i,a));case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"all",value:function(e){var t=this;return ea((0,ii.Z)().mark((function r(){var n,i,a,s,o,u,c,l,h,f;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=new xm,i=!1,a=!1,r.prev=3,o=ui(t.datastore.query(Hb(null!==e&&void 0!==e?e:{},n)));case 5:return r.next=7,Ji(o.next());case 7:if(!(i=!(u=r.sent).done)){r.next=17;break}if(c=u.value,l=c.key,h=c.value,!(f=jb(l,h,n)).id.equals(t.peerId)){r.next=12;break}return r.abrupt("continue",14);case 12:return r.next=14,f;case 14:i=!1,r.next=5;break;case 17:r.next=23;break;case 19:r.prev=19,r.t0=r.catch(3),a=!0,s=r.t0;case 23:if(r.prev=23,r.prev=24,!i||null==o.return){r.next=28;break}return r.next=28,Ji(o.return());case 28:if(r.prev=28,!a){r.next=31;break}throw s;case 31:return r.finish(28);case 32:return r.finish(23);case 33:case"end":return r.stop()}}),r,null,[[3,19,23,33],[24,,28,32]])})))()}}]),e}();function Kb(e){return Yb.apply(this,arguments)}function Yb(){return Yb=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.datastore.get(Pb(t));case 3:return r=e.sent,n=Zb(t,r),e.abrupt("return",{existingBuf:r,existingPeer:n});case 8:if(e.prev=8,e.t0=e.catch(0),"ERR_NOT_FOUND"===e.t0.code){e.next=12;break}throw e.t0;case 12:return e.abrupt("return",{});case 13:case"end":return e.stop()}}),e,this,[[0,8]])}))),Yb.apply(this,arguments)}function Gb(e,t,r,n){return Qb.apply(this,arguments)}function Qb(){return Qb=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i){var a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Ab.encode(r),null==n||!Ao(a,n)){e.next=3;break}return e.abrupt("return",{peer:Zb(t,a),previous:i,updated:!1});case 3:return e.next=5,this.datastore.put(Pb(t),a);case 5:return e.abrupt("return",{peer:Zb(t,a),previous:i,updated:!0});case 6:case"end":return e.stop()}}),e,this)}))),Qb.apply(this,arguments)}var Xb=zi("libp2p:peer-store"),Jb=new WeakSet,$b=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,hi.Z)(this,e),ic(this,Jb),(0,we.Z)(this,"store",void 0),(0,we.Z)(this,"events",void 0),(0,we.Z)(this,"peerId",void 0),this.events=t.events,this.peerId=t.peerId,this.store=new Vb(t,r)}return(0,fi.Z)(e,[{key:"forEach",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Xb.trace("forEach await read lock"),e.next=3,this.store.lock.readLock();case 3:n=e.sent,Xb.trace("forEach got read lock"),e.prev=5,i=!1,a=!1,e.prev=8,o=ui(this.store.all(r));case 10:return e.next=12,o.next();case 12:if(!(i=!(u=e.sent).done)){e.next=18;break}c=u.value,t(c);case 15:i=!1,e.next=10;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(8),a=!0,s=e.t0;case 24:if(e.prev=24,e.prev=25,!i||null==o.return){e.next=29;break}return e.next=29,o.return();case 29:if(e.prev=29,!a){e.next=32;break}throw s;case 32:return e.finish(29);case 33:return e.finish(24);case 34:return e.prev=34,Xb.trace("forEach release read lock"),n(),e.finish(34);case 38:case"end":return e.stop()}}),e,this,[[5,,34,38],[8,20,24,34],[25,,29,33]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"all",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Xb.trace("all await read lock"),e.next=3,this.store.lock.readLock();case 3:return r=e.sent,Xb.trace("all got read lock"),e.prev=5,e.next=8,Xs(this.store.all(t));case 8:return e.abrupt("return",e.sent);case 9:return e.prev=9,Xb.trace("all release read lock"),r(),e.finish(9);case 13:case"end":return e.stop()}}),e,this,[[5,,9,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Xb.trace("delete await write lock"),e.next=3,this.store.lock.writeLock();case 3:return r=e.sent,Xb.trace("delete got write lock"),e.prev=5,e.next=8,this.store.delete(t);case 8:return e.prev=8,Xb.trace("delete release write lock"),r(),e.finish(8);case 12:case"end":return e.stop()}}),e,this,[[5,,8,12]])})));return function(t){return e.apply(this,arguments)}}()},{key:"has",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Xb.trace("has await read lock"),e.next=3,this.store.lock.readLock();case 3:return r=e.sent,Xb.trace("has got read lock"),e.prev=5,e.next=8,this.store.has(t);case 8:return e.abrupt("return",e.sent);case 9:return e.prev=9,Xb.trace("has release read lock"),r(),e.finish(9);case 13:case"end":return e.stop()}}),e,this,[[5,,9,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Xb.trace("get await read lock"),e.next=3,this.store.lock.readLock();case 3:return r=e.sent,Xb.trace("get got read lock"),e.prev=5,e.next=8,this.store.load(t);case 8:return e.abrupt("return",e.sent);case 9:return e.prev=9,Xb.trace("get release read lock"),r(),e.finish(9);case 13:case"end":return e.stop()}}),e,this,[[5,,9,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Xb.trace("save await write lock"),e.next=3,this.store.lock.writeLock();case 3:return n=e.sent,Xb.trace("save got write lock"),e.prev=5,e.next=8,this.store.save(t,r);case 8:return i=e.sent,ac(this,Jb,e_).call(this,t,i),e.abrupt("return",i.peer);case 11:return e.prev=11,Xb.trace("save release write lock"),n(),e.finish(11);case 15:case"end":return e.stop()}}),e,this,[[5,,11,15]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"patch",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Xb.trace("patch await write lock"),e.next=3,this.store.lock.writeLock();case 3:return n=e.sent,Xb.trace("patch got write lock"),e.prev=5,e.next=8,this.store.patch(t,r);case 8:return i=e.sent,ac(this,Jb,e_).call(this,t,i),e.abrupt("return",i.peer);case 11:return e.prev=11,Xb.trace("patch release write lock"),n(),e.finish(11);case 15:case"end":return e.stop()}}),e,this,[[5,,11,15]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"merge",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Xb.trace("merge await write lock"),e.next=3,this.store.lock.writeLock();case 3:return n=e.sent,Xb.trace("merge got write lock"),e.prev=5,e.next=8,this.store.merge(t,r);case 8:return i=e.sent,ac(this,Jb,e_).call(this,t,i),e.abrupt("return",i.peer);case 11:return e.prev=11,Xb.trace("merge release write lock"),n(),e.finish(11);case 15:case"end":return e.stop()}}),e,this,[[5,,11,15]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"consumePeerRecord",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Im.openAndCertify(t,Cb.DOMAIN);case 2:if(i=e.sent,!1!==(null===r||void 0===r?void 0:r.equals(i.peerId))){e.next=6;break}return Xb("envelope peer id was not the expected peer id - expected: %p received: %p",r,i.peerId),e.abrupt("return",!1);case 6:return a=Cb.createFromProtobuf(i.payload),e.prev=7,e.next=10,this.get(i.peerId);case 10:s=e.sent,e.next=17;break;case 13:if(e.prev=13,e.t0=e.catch(7),"ERR_NOT_FOUND"===e.t0.code){e.next=17;break}throw e.t0;case 17:if(null==(null===(n=s)||void 0===n?void 0:n.peerRecordEnvelope)){e.next=25;break}return e.next=20,Im.createFromProtobuf(s.peerRecordEnvelope);case 20:if(o=e.sent,!((u=Cb.createFromProtobuf(o.payload)).seqNumber>=a.seqNumber)){e.next=25;break}return Xb("sequence number was lower or equal to existing sequence number - stored: %d received: %d",u.seqNumber,a.seqNumber),e.abrupt("return",!1);case 25:return e.next=27,this.patch(a.peerId,{peerRecordEnvelope:t,addresses:a.multiaddrs.map((function(e){return{isCertified:!0,multiaddr:e}}))});case 27:return e.abrupt("return",!0);case 28:case"end":return e.stop()}}),e,this,[[7,13]])})));return function(t,r){return e.apply(this,arguments)}}()}]),e}();function e_(e,t){t.updated&&(this.peerId.equals(e)?this.events.safeDispatchEvent("self:peer:update",{detail:t}):this.events.safeDispatchEvent("peer:update",{detail:t}))}var t_=zi("libp2p:address-manager"),r_=function(e){return e};function n_(e,t){var r=e.getPeerId();null!=r&&(em(r).equals(t)&&(e=e.decapsulate(kb("/p2p/".concat(t.toString())))));return e}var i_=function(){function e(t){var r,n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,hi.Z)(this,e),(0,we.Z)(this,"components",void 0),(0,we.Z)(this,"listen",void 0),(0,we.Z)(this,"announce",void 0),(0,we.Z)(this,"observed",void 0),(0,we.Z)(this,"announceFilter",void 0);var a=i.listen,s=void 0===a?[]:a,o=i.announce,u=void 0===o?[]:o;this.components=t,this.listen=s.map((function(e){return e.toString()})),this.announce=new Set(u.map((function(e){return e.toString()}))),this.observed=new Map,this.announceFilter=null!==(r=i.announceFilter)&&void 0!==r?r:r_,this._updatePeerStoreAddresses=function(e,t){var r;return function(){clearTimeout(r),r=setTimeout((function(){r=void 0,e()}),t)}}(this._updatePeerStoreAddresses.bind(this),1e3),t.events.addEventListener("transport:listening",(function(){n._updatePeerStoreAddresses()})),t.events.addEventListener("transport:close",(function(){n._updatePeerStoreAddresses()}))}return(0,fi.Z)(e,[{key:"_updatePeerStoreAddresses",value:function(){var e=this,t=this.getAnnounceAddrs().concat(this.components.transportManager.getAddrs()).concat(be(this.observed.entries()).filter((function(e){var t=(0,ke.Z)(e,2);t[0];return t[1].confident})).map((function(e){return kb((0,ke.Z)(e,1)[0])}))).map((function(t){return t.getPeerId()===e.components.peerId.toString()?t.decapsulate("/p2p/".concat(e.components.peerId.toString())):t}));this.components.peerStore.patch(this.components.peerId,{multiaddrs:t}).catch((function(e){t_.error("error updating addresses",e)}))}},{key:"getListenAddrs",value:function(){return Array.from(this.listen).map((function(e){return kb(e)}))}},{key:"getAnnounceAddrs",value:function(){return Array.from(this.announce).map((function(e){return kb(e)}))}},{key:"getObservedAddrs",value:function(){return Array.from(this.observed).map((function(e){return kb((0,ke.Z)(e,1)[0])}))}},{key:"addObservedAddr",value:function(e){var t=(e=n_(e,this.components.peerId)).toString();this.observed.has(t)||this.observed.set(t,{confident:!1})}},{key:"confirmObservedAddr",value:function(e){var t,r=(e=n_(e,this.components.peerId)).toString(),n=(null!==(t=this.observed.get(r))&&void 0!==t?t:{confident:!1}).confident;this.observed.set(r,{confident:!0}),n||this._updatePeerStoreAddresses()}},{key:"removeObservedAddr",value:function(e){var t=(e=n_(e,this.components.peerId)).toString();this.observed.delete(t)}},{key:"getAddresses",value:function(){var e=this,t=this.getAnnounceAddrs().map((function(e){return e.toString()}));0===t.length&&(t=this.components.transportManager.getAddrs().map((function(e){return e.toString()}))),t=t.concat(Array.from(this.observed).filter((function(e){var t=(0,ke.Z)(e,2);t[0];return t[1].confident})).map((function(e){return(0,ke.Z)(e,1)[0]})));var r=new Set(t);return this.announceFilter(Array.from(r).map((function(e){return kb(e)}))).map((function(t){var r;return!0===(null===(r=t.protos().pop())||void 0===r?void 0:r.path)||t.getPeerId()===e.components.peerId.toString()?t:t.encapsulate("/p2p/".concat(e.components.peerId.toString()))}))}}]),e}();function a_(e){return null!=e&&"function"===typeof e.start&&"function"===typeof e.stop}var s_=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,hi.Z)(this,e),(0,we.Z)(this,"components",{}),(0,we.Z)(this,"_started",!1),this.components={};for(var r=0,n=Object.entries(t);r<n.length;r++){var i=(0,ke.Z)(n[r],2),a=i[0],s=i[1];this.components[a]=s}}return(0,fi.Z)(e,[{key:"isStarted",value:function(){return this._started}},{key:"_invokeStartableMethod",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(Object.values(this.components).filter((function(e){return a_(e)})).map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(r){var n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=r[t])||void 0===n?void 0:n.call(r);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"beforeStart",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._invokeStartableMethod("beforeStart");case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._invokeStartableMethod("start");case 2:this._started=!0;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"afterStart",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._invokeStartableMethod("afterStart");case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"beforeStop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._invokeStartableMethod("beforeStop");case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._invokeStartableMethod("stop");case 2:this._started=!1;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"afterStop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._invokeStartableMethod("afterStop");case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),o_=["metrics","connectionProtector"],u_=["components","isStarted","beforeStart","start","afterStart","beforeStop","stop","afterStop","then","_invokeStartableMethod"];var c_=__webpack_require__(7922),l_="[a-fA-F\\d:]",h_=function(e){return e&&e.includeBoundaries?"(?:(?<=\\s|^)(?=".concat(l_,")|(?<=").concat(l_,")(?=\\s|$))"):""},f_="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",d_="[a-fA-F\\d]{1,4}",p_="\n(?:\n(?:".concat(d_,":){7}(?:").concat(d_,"|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:").concat(d_,":){6}(?:").concat(f_,"|:").concat(d_,"|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:").concat(d_,":){5}(?::").concat(f_,"|(?::").concat(d_,"){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:").concat(d_,":){4}(?:(?::").concat(d_,"){0,1}:").concat(f_,"|(?::").concat(d_,"){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:").concat(d_,":){3}(?:(?::").concat(d_,"){0,2}:").concat(f_,"|(?::").concat(d_,"){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:").concat(d_,":){2}(?:(?::").concat(d_,"){0,3}:").concat(f_,"|(?::").concat(d_,"){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:").concat(d_,":){1}(?:(?::").concat(d_,"){0,4}:").concat(f_,"|(?::").concat(d_,"){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::").concat(d_,"){0,5}:").concat(f_,"|(?::").concat(d_,"){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n").replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),v_=new RegExp("(?:^".concat(f_,"$)|(?:^").concat(p_,"$)")),g_=new RegExp("^".concat(f_,"$")),y_=new RegExp("^".concat(p_,"$")),m_=function(e){return e&&e.exact?v_:new RegExp("(?:".concat(h_(e)).concat(f_).concat(h_(e),")|(?:").concat(h_(e)).concat(p_).concat(h_(e),")"),"g")};m_.v4=function(e){return e&&e.exact?g_:new RegExp("".concat(h_(e)).concat(f_).concat(h_(e)),"g")},m_.v6=function(e){return e&&e.exact?y_:new RegExp("".concat(h_(e)).concat(p_).concat(h_(e)),"g")};var b_=m_,__=__webpack_require__(7201),w_=__.isValid,k_=__.parse,x_=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"].map((function(e){return new c_.Netmask(e)}));function E_(e){return/^::$/.test(e)||/^::1$/.test(e)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(e)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(e)||/^ff([0-9a-fA-F]{2,2}):/i.test(e)}var S_=function(e){if(w_(e)){var t=k_(e);if("ipv4"===t.kind())return function(e){var t,r=(0,ge.Z)(x_);try{for(r.s();!(t=r.n()).done;)if(t.value.contains(e))return!0}catch(S$){r.e(S$)}finally{r.f()}return!1}(t.toNormalizedString());if("ipv6"===t.kind())return E_(e)}else if(Um(e)&&b_.v6().test(e))return E_(e)};function C_(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,_e.Z)({denyDialPeer:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),denyDialMultiaddr:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(4!==(r=t.stringTuples())[0][0]&&41!==r[0][0]){e.next=3;break}return e.abrupt("return",Boolean(S_("".concat(r[0][1]))));case 3:return e.abrupt("return",!1);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),denyInboundConnection:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),denyOutboundConnection:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),denyInboundEncryptedConnection:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),denyOutboundEncryptedConnection:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),denyInboundUpgradedConnection:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),denyOutboundUpgradedConnection:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),filterMultiaddrForPeer:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},e)}var A_,D_=Symbol.for("@libp2p/transport");!function(e){e[e.FATAL_ALL=0]="FATAL_ALL",e[e.NO_FATAL=1]="NO_FATAL"}(A_||(A_={}));var R_=function(e){return{match:function(t){return!(t.length<1)&&(!!e(t[0])&&t.slice(1))},pattern:"fn"}},T_=function(e){return{match:function(t){return R_((function(t){return t===e})).match(t)},pattern:e}},Z_=function(){return{match:function(e){return R_((function(e){return"string"===typeof e})).match(e)},pattern:"{string}"}},I_=function(){return{match:function(e){return R_((function(e){return!isNaN(parseInt(e))})).match(e)},pattern:"{number}"}},P_=function(){return{match:function(e){if(e.length<2)return!1;if("p2p"!==e[0]&&"ipfs"!==e[0])return!1;if(!e[1].startsWith("Q")&&!e[1].startsWith("1"))return!1;try{Mi.decode("z".concat(e[1]))}catch(S$){return!1}return e.slice(2)},pattern:"/p2p/{peerid}"}},L_=function(){return{match:function(e){if(e.length<2)return!1;if("certhash"!==e[0])return!1;try{Fi.decode(e[1])}catch(t){return!1}return e.slice(2)},pattern:"/certhash/{certhash}"}},M_=function(e){return{match:function(t){var r=e.match(t);return!1===r?t:r},pattern:"optional(".concat(e.pattern,")")}},B_=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return{match:function(e){for(var r,n=0,i=t;n<i.length;n++){var a=i[n].match(e);!1!==a&&((null==r||a.length<r.length)&&(r=a))}return null!=r&&r},pattern:"or(".concat(t.map((function(e){return e.pattern})).join(", "),")")}},O_=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return{match:function(e){for(var r=0,n=t;r<n.length;r++){var i=n[r].match(e);if(!1===i)return!1;e=i}return e},pattern:"and(".concat(t.map((function(e){return e.pattern})).join(", "),")")}};function N_(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];function n(e){var r,n=function(e){return e.toString().split("/").slice(1)}(e),i=(0,ge.Z)(t);try{for(i.s();!(r=i.n()).done;){var a=r.value.match(n);if(!1===a)return!1;n=a}}catch(S$){i.e(S$)}finally{i.f()}return n}return{matches:function(e){return!1!==n(e)},exactMatch:function(e){var t=n(e);return!1!==t&&0===t.length}}}var F_=O_(T_("dns4"),Z_()),U_=O_(T_("dns6"),Z_()),z_=O_(T_("dnsaddr"),Z_()),j_=O_(T_("dns"),Z_()),H_=(N_(F_),N_(U_),N_(z_),N_(B_(j_,z_,F_,U_))),W_=O_(T_("ip4"),R_(Nm)),q_=O_(T_("ip6"),R_(Fm)),V_=B_(W_,q_),K_=B_(V_,j_,F_,U_,z_),Y_=(N_(W_),N_(q_),N_(V_)),G_=O_(K_,T_("tcp"),I_()),Q_=O_(K_,T_("udp"),I_()),X_=B_(G_,Q_),J_=(N_(G_),N_(Q_),O_(Q_,T_("quic"))),$_=O_(Q_,T_("quic-v1")),ew=B_(J_,$_),tw=(N_(J_),N_($_),B_(K_,G_,Q_,J_,$_)),rw=B_(O_(tw,T_("ws"),M_(P_()))),nw=(N_(rw),B_(O_(tw,T_("wss"),M_(P_())),O_(tw,T_("tls"),T_("ws"),M_(P_())))),iw=(N_(nw),O_(X_,T_("webrtc-direct"),L_(),M_(L_()),M_(P_()))),aw=N_(iw),sw=O_($_,T_("webtransport"),L_(),L_(),M_(P_())),ow=N_(sw),uw=B_(rw,nw,O_(G_,M_(P_())),O_(ew,M_(P_())),O_(K_,M_(P_())),iw,sw,P_()),cw=(N_(uw),N_(O_(uw,T_("p2p-circuit"),P_()))),lw=N_(B_(O_(uw,T_("p2p-circuit"),T_("webrtc"),P_()),O_(uw,T_("webrtc"),M_(P_())),T_("webrtc")));function hw(e){try{var t=e.nodeAddress().address;return Boolean(S_(t))}catch(r){return!0}}function fw(e,t){var r=function(e,t){var r=hw(e.multiaddr),n=hw(t.multiaddr);return r&&!n?1:!r&&n?-1:0}(e,t);if(0!==r)return r;var n=function(e,t){var r=cw.exactMatch(e.multiaddr),n=cw.exactMatch(t.multiaddr);return r&&!n?1:!r&&n?-1:0}(e,t);if(0!==n)return n;var i=function(e,t){return e.isCertified&&!t.isCertified?-1:!e.isCertified&&t.isCertified?1:0}(e,t);return i}var dw=__webpack_require__(449),pw=globalThis.fetch,vw=globalThis.Headers;globalThis.Request,globalThis.Response;function gw(e,t,r){return"".concat(e,"?name=").concat(t,"&type=").concat(r)}function yw(e,t){return mw.apply(this,arguments)}function mw(){return(mw=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pw(t,{headers:new vw({accept:"application/dns-json"}),signal:r});case 2:return n=e.sent,e.next=5,n.json();case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bw(e,t){return"".concat(t,"_").concat(e)}var _w,ww,kw=Object.assign(li("dns-over-http-resolver"),{error:li("dns-over-http-resolver:error")}),xw=function(){function e(){var t,r,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,hi.Z)(this,e),this._cache=new dw({max:null!==(t=null===i||void 0===i?void 0:i.maxCache)&&void 0!==t?t:100}),this._TXTcache=new dw({max:null!==(r=null===i||void 0===i?void 0:i.maxCache)&&void 0!==r?r:100}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"],this._request=null!==(n=i.request)&&void 0!==n?n:yw,this._abortControllers=[]}return(0,fi.Z)(e,[{key:"cancel",value:function(){this._abortControllers.forEach((function(e){return e.abort()}))}},{key:"getServers",value:function(){return this._servers}},{key:"_getShuffledServers",value:function(){for(var e=be(this._servers),t=e.length-1;t>0;t--){var r=Math.floor(Math.random()*t),n=e[t];e[t]=e[r],e[r]=n}return e}},{key:"setServers",value:function(e){this._servers=e}},{key:"resolve",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.length>1&&void 0!==n[1]?n[1]:"A",e.t0=r,e.next="A"===e.t0?4:"AAAA"===e.t0?7:"TXT"===e.t0?10:13;break;case 4:return e.next=6,this.resolve4(t);case 6:case 9:case 12:return e.abrupt("return",e.sent);case 7:return e.next=9,this.resolve6(t);case 10:return e.next=12,this.resolveTxt(t);case 13:throw new Error("".concat(r," is not supported"));case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resolve4",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r="A",null==(n=this._cache.get(bw(t,r)))){e.next=4;break}return e.abrupt("return",n);case 4:i=!1,a=(0,ge.Z)(this._getShuffledServers()),e.prev=6,o=(0,ii.Z)().mark((function e(){var n,a,o,u,l;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.value,a=new AbortController,c._abortControllers.push(a),e.prev=3,e.next=6,c._request(gw(n,t,r),a.signal);case 6:return o=e.sent,u=o.Answer.map((function(e){return e.data})),l=Math.min.apply(Math,be(o.Answer.map((function(e){return e.TTL})))),c._cache.set(bw(t,r),u,{ttl:l}),e.abrupt("return",{v:u});case 13:e.prev=13,e.t0=e.catch(3),a.signal.aborted&&(i=!0),kw.error("".concat(n," could not resolve ").concat(t," record ").concat(r));case 17:return e.prev=17,c._abortControllers=c._abortControllers.filter((function(e){return e!==a})),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[3,13,17,20]])})),a.s();case 9:if((s=a.n()).done){e.next=16;break}return e.delegateYield(o(),"t0",11);case 11:if(!(u=e.t0)){e.next=14;break}return e.abrupt("return",u.v);case 14:e.next=9;break;case 16:e.next=21;break;case 18:e.prev=18,e.t1=e.catch(6),a.e(e.t1);case 21:return e.prev=21,a.f(),e.finish(21);case 24:if(!i){e.next=26;break}throw Object.assign(new Error("queryA ECANCELLED"),{code:"ECANCELLED"});case 26:throw new Error("Could not resolve ".concat(t," record ").concat(r));case 27:case"end":return e.stop()}}),e,this,[[6,18,21,24]])})));return function(t){return e.apply(this,arguments)}}()},{key:"resolve6",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r="AAAA",null==(n=this._cache.get(bw(t,r)))){e.next=4;break}return e.abrupt("return",n);case 4:i=!1,a=(0,ge.Z)(this._getShuffledServers()),e.prev=6,o=(0,ii.Z)().mark((function e(){var n,a,o,u,l;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.value,a=new AbortController,c._abortControllers.push(a),e.prev=3,e.next=6,c._request(gw(n,t,r),a.signal);case 6:return o=e.sent,u=o.Answer.map((function(e){return e.data})),l=Math.min.apply(Math,be(o.Answer.map((function(e){return e.TTL})))),c._cache.set(bw(t,r),u,{ttl:l}),e.abrupt("return",{v:u});case 13:e.prev=13,e.t0=e.catch(3),a.signal.aborted&&(i=!0),kw.error("".concat(n," could not resolve ").concat(t," record ").concat(r));case 17:return e.prev=17,c._abortControllers=c._abortControllers.filter((function(e){return e!==a})),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[3,13,17,20]])})),a.s();case 9:if((s=a.n()).done){e.next=16;break}return e.delegateYield(o(),"t0",11);case 11:if(!(u=e.t0)){e.next=14;break}return e.abrupt("return",u.v);case 14:e.next=9;break;case 16:e.next=21;break;case 18:e.prev=18,e.t1=e.catch(6),a.e(e.t1);case 21:return e.prev=21,a.f(),e.finish(21);case 24:if(!i){e.next=26;break}throw Object.assign(new Error("queryAaaa ECANCELLED"),{code:"ECANCELLED"});case 26:throw new Error("Could not resolve ".concat(t," record ").concat(r));case 27:case"end":return e.stop()}}),e,this,[[6,18,21,24]])})));return function(t){return e.apply(this,arguments)}}()},{key:"resolveTxt",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r="TXT",null==(n=this._TXTcache.get(bw(t,r)))){e.next=4;break}return e.abrupt("return",n);case 4:i=!1,a=(0,ge.Z)(this._getShuffledServers()),e.prev=6,o=(0,ii.Z)().mark((function e(){var n,a,o,u,l;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.value,a=new AbortController,c._abortControllers.push(a),e.prev=3,e.next=6,c._request(gw(n,t,r),a.signal);case 6:return o=e.sent,u=o.Answer.map((function(e){return[e.data.replace(/['"]+/g,"")]})),l=Math.min.apply(Math,be(o.Answer.map((function(e){return e.TTL})))),c._TXTcache.set(bw(t,r),u,{ttl:l}),e.abrupt("return",{v:u});case 13:e.prev=13,e.t0=e.catch(3),a.signal.aborted&&(i=!0),kw.error("".concat(n," could not resolve ").concat(t," record ").concat(r));case 17:return e.prev=17,c._abortControllers=c._abortControllers.filter((function(e){return e!==a})),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[3,13,17,20]])})),a.s();case 9:if((s=a.n()).done){e.next=16;break}return e.delegateYield(o(),"t0",11);case 11:if(!(u=e.t0)){e.next=14;break}return e.abrupt("return",u.v);case 14:e.next=9;break;case 16:e.next=21;break;case 18:e.prev=18,e.t1=e.catch(6),a.e(e.t1);case 21:return e.prev=21,a.f(),e.finish(21);case 24:if(!i){e.next=26;break}throw Object.assign(new Error("queryTxt ECANCELLED"),{code:"ECANCELLED"});case 26:throw new Error("Could not resolve ".concat(t," record ").concat(r));case 27:case"end":return e.stop()}}),e,this,[[6,18,21,24]])})));return function(t){return e.apply(this,arguments)}}()},{key:"clearCache",value:function(){this._cache.clear(),this._TXTcache.clear()}}]),e}(),Ew=xw,Sw=Gm("dnsaddr").code;function Cw(e){return Aw.apply(this,arguments)}function Aw(){return Aw=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c,l,h=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=h.length>1&&void 0!==h[1]?h[1]:{},i=new Ew,null!=n.signal&&n.signal.addEventListener("abort",(function(){i.cancel()})),a=t.getPeerId(),s=null!==(r=t.stringTuples().find((function(e){return(0,ke.Z)(e,1)[0]===Sw})))&&void 0!==r?r:[],o=(0,ke.Z)(s,2),null!=(u=o[1])){e.next=7;break}throw new Error("No hostname found in multiaddr");case 7:return e.next=9,i.resolveTxt("_dnsaddr.".concat(u));case 9:return c=e.sent,l=c.flat().map((function(e){return e.split("=")[1]})).filter(Boolean),null!=a&&(l=l.filter((function(e){return e.includes(a)}))),e.abrupt("return",l);case 13:case"end":return e.stop()}}),e)}))),Aw.apply(this,arguments)}!function(e){e.NOT_STARTED_YET="The libp2p node is not started yet",e.DHT_DISABLED="DHT is not available",e.PUBSUB_DISABLED="PubSub is not available",e.CONN_ENCRYPTION_REQUIRED="At least one connection encryption module is required",e.ERR_TRANSPORTS_REQUIRED="At least one transport module is required",e.ERR_PROTECTOR_REQUIRED="Private network is enforced, but no protector was provided",e.NOT_FOUND="Not found"}(_w||(_w={})),function(e){e.DHT_DISABLED="ERR_DHT_DISABLED",e.ERR_PUBSUB_DISABLED="ERR_PUBSUB_DISABLED",e.PUBSUB_NOT_STARTED="ERR_PUBSUB_NOT_STARTED",e.DHT_NOT_STARTED="ERR_DHT_NOT_STARTED",e.CONN_ENCRYPTION_REQUIRED="ERR_CONN_ENCRYPTION_REQUIRED",e.ERR_TRANSPORTS_REQUIRED="ERR_TRANSPORTS_REQUIRED",e.ERR_PROTECTOR_REQUIRED="ERR_PROTECTOR_REQUIRED",e.ERR_PEER_DIAL_INTERCEPTED="ERR_PEER_DIAL_INTERCEPTED",e.ERR_CONNECTION_INTERCEPTED="ERR_CONNECTION_INTERCEPTED",e.ERR_INVALID_PROTOCOLS_FOR_STREAM="ERR_INVALID_PROTOCOLS_FOR_STREAM",e.ERR_CONNECTION_ENDED="ERR_CONNECTION_ENDED",e.ERR_CONNECTION_FAILED="ERR_CONNECTION_FAILED",e.ERR_NODE_NOT_STARTED="ERR_NODE_NOT_STARTED",e.ERR_ALREADY_ABORTED="ERR_ALREADY_ABORTED",e.ERR_TOO_MANY_ADDRESSES="ERR_TOO_MANY_ADDRESSES",e.ERR_NO_VALID_ADDRESSES="ERR_NO_VALID_ADDRESSES",e.ERR_RELAYED_DIAL="ERR_RELAYED_DIAL",e.ERR_DIALED_SELF="ERR_DIALED_SELF",e.ERR_DISCOVERED_SELF="ERR_DISCOVERED_SELF",e.ERR_DUPLICATE_TRANSPORT="ERR_DUPLICATE_TRANSPORT",e.ERR_ENCRYPTION_FAILED="ERR_ENCRYPTION_FAILED",e.ERR_HOP_REQUEST_FAILED="ERR_HOP_REQUEST_FAILED",e.ERR_INVALID_KEY="ERR_INVALID_KEY",e.ERR_INVALID_MESSAGE="ERR_INVALID_MESSAGE",e.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",e.ERR_INVALID_PEER="ERR_INVALID_PEER",e.ERR_MUXER_UNAVAILABLE="ERR_MUXER_UNAVAILABLE",e.ERR_NOT_FOUND="ERR_NOT_FOUND",e.ERR_TIMEOUT="ERR_TIMEOUT",e.ERR_TRANSPORT_UNAVAILABLE="ERR_TRANSPORT_UNAVAILABLE",e.ERR_TRANSPORT_DIAL_FAILED="ERR_TRANSPORT_DIAL_FAILED",e.ERR_UNSUPPORTED_PROTOCOL="ERR_UNSUPPORTED_PROTOCOL",e.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED="ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED",e.ERR_INVALID_MULTIADDR="ERR_INVALID_MULTIADDR",e.ERR_SIGNATURE_NOT_VALID="ERR_SIGNATURE_NOT_VALID",e.ERR_FIND_SELF="ERR_FIND_SELF",e.ERR_NO_ROUTERS_AVAILABLE="ERR_NO_ROUTERS_AVAILABLE",e.ERR_CONNECTION_NOT_MULTIPLEXED="ERR_CONNECTION_NOT_MULTIPLEXED",e.ERR_NO_DIAL_TOKENS="ERR_NO_DIAL_TOKENS",e.ERR_KEYCHAIN_REQUIRED="ERR_KEYCHAIN_REQUIRED",e.ERR_INVALID_CMS="ERR_INVALID_CMS",e.ERR_MISSING_KEYS="ERR_MISSING_KEYS",e.ERR_NO_KEY="ERR_NO_KEY",e.ERR_INVALID_KEY_NAME="ERR_INVALID_KEY_NAME",e.ERR_INVALID_KEY_TYPE="ERR_INVALID_KEY_TYPE",e.ERR_KEY_ALREADY_EXISTS="ERR_KEY_ALREADY_EXISTS",e.ERR_INVALID_KEY_SIZE="ERR_INVALID_KEY_SIZE",e.ERR_KEY_NOT_FOUND="ERR_KEY_NOT_FOUND",e.ERR_OLD_KEY_NAME_INVALID="ERR_OLD_KEY_NAME_INVALID",e.ERR_NEW_KEY_NAME_INVALID="ERR_NEW_KEY_NAME_INVALID",e.ERR_PASSWORD_REQUIRED="ERR_PASSWORD_REQUIRED",e.ERR_PEM_REQUIRED="ERR_PEM_REQUIRED",e.ERR_CANNOT_READ_KEY="ERR_CANNOT_READ_KEY",e.ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY",e.ERR_MISSING_PUBLIC_KEY="ERR_MISSING_PUBLIC_KEY",e.ERR_INVALID_OLD_PASS_TYPE="ERR_INVALID_OLD_PASS_TYPE",e.ERR_INVALID_NEW_PASS_TYPE="ERR_INVALID_NEW_PASS_TYPE",e.ERR_INVALID_PASS_LENGTH="ERR_INVALID_PASS_LENGTH",e.ERR_NOT_IMPLEMENTED="ERR_NOT_IMPLEMENTED",e.ERR_WRONG_PING_ACK="ERR_WRONG_PING_ACK",e.ERR_INVALID_RECORD="ERR_INVALID_RECORD",e.ERR_ALREADY_SUCCEEDED="ERR_ALREADY_SUCCEEDED",e.ERR_NO_HANDLER_FOR_PROTOCOL="ERR_NO_HANDLER_FOR_PROTOCOL",e.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS",e.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS",e.ERR_CONNECTION_DENIED="ERR_CONNECTION_DENIED",e.ERR_TRANSFER_LIMIT_EXCEEDED="ERR_TRANSFER_LIMIT_EXCEEDED"}(ww||(ww={}));var Dw={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:function(e){return e}},connectionManager:{resolvers:{dnsaddr:Cw},addressSorter:fw},transportManager:{faultTolerance:A_.FATAL_ALL}};function Rw(e){var t,r=am(Dw,e);if(null==r.transports||r.transports.length<1)throw new wo(_w.ERR_TRANSPORTS_REQUIRED,ww.ERR_TRANSPORTS_REQUIRED);if(null===r.connectionProtector&&null!=(null===(t=globalThis.process)||void 0===t||null===(t=t.env)||void 0===t?void 0:t.LIBP2P_FORCE_PNET))throw new wo(_w.ERR_PROTECTOR_REQUIRED,ww.ERR_PROTECTOR_REQUIRED);return r}var Tw=__webpack_require__(7896),Zw=zi("libp2p:get-peer");function Iw(e){if(Wy(e))return{peerId:e,multiaddrs:[]};var t;if(Array.isArray(e)||(e=[e]),e.length>0){var r=e[0].getPeerId();t=null==r?void 0:em(r),e.forEach((function(e){if(!gb(e))throw Zw.error("multiaddr %s was invalid",e),new wo("Invalid Multiaddr",ww.ERR_INVALID_MULTIADDR);var r=e.getPeerId();if(null==r){if(null!=t)throw new wo("Multiaddrs must all have the same peer id or have no peer id",ww.ERR_INVALID_PARAMETERS)}else{var n=em(r);if(null==t||!t.equals(n))throw new wo("Multiaddrs must all have the same peer id or have no peer id",ww.ERR_INVALID_PARAMETERS)}}))}return{peerId:t,multiaddrs:e}}var Pw=new WeakMap,Lw=function(){function e(){(0,hi.Z)(this,e),lo(this,Pw,{writable:!0,value:[]})}return(0,fi.Z)(e,[{key:"enqueue",value:function(e,t){var r,n=null===t||void 0===t?void 0:t.peerId,i=null!==(r=null===t||void 0===t?void 0:t.priority)&&void 0!==r?r:0;if(null==n)throw new wo("missing peer id",ww.ERR_INVALID_PARAMETERS);var a={priority:i,peerId:n,run:e};if(this.size>0&&fo(this,Pw)[this.size-1].priority>=i)fo(this,Pw).push(a);else{var s=function(e,t,r){for(var n=0,i=e.length;i>0;){var a=Math.trunc(i/2),s=n+a;r(e[s],t)<=0?(n=++s,i-=a+1):i=a}return n}(fo(this,Pw),a,(function(e,t){return t.priority-e.priority}));fo(this,Pw).splice(s,0,a)}}},{key:"dequeue",value:function(){var e=fo(this,Pw).shift();return null===e||void 0===e?void 0:e.run}},{key:"filter",value:function(e){if(null!=e.peerId){var t=e.peerId;return fo(this,Pw).filter((function(e){return t.equals(e.peerId)})).map((function(e){return e.run}))}return fo(this,Pw).filter((function(t){return t.priority===e.priority})).map((function(e){return e.run}))}},{key:"size",get:function(){return fo(this,Pw).length}}]),e}(),Mw=function(e){ia(r,e);var t=ua(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,hi.Z)(this,r),t.call(this,(0,_e.Z)((0,_e.Z)({},e),{},{queueClass:Lw}))}return(0,fi.Z)(r,[{key:"hasJob",value:function(e){return this.sizeBy({peerId:e})>0}}]),r}(Bh),Bw=100,Ow="last-dial-failure",Nw=zi("libp2p:connection-manager:auto-dial"),Fw={minConnections:5,maxQueueLength:100,autoDialConcurrency:25,autoDialPriority:0,autoDialInterval:5e3,autoDialPeerRetryThreshold:42e4,autoDialDiscoveredPeersDebounce:10},Uw=function(){function e(t,r){var n,i,a,s,o,u,c,l,h=this;(0,hi.Z)(this,e),(0,we.Z)(this,"connectionManager",void 0),(0,we.Z)(this,"peerStore",void 0),(0,we.Z)(this,"queue",void 0),(0,we.Z)(this,"minConnections",void 0),(0,we.Z)(this,"autoDialPriority",void 0),(0,we.Z)(this,"autoDialIntervalMs",void 0),(0,we.Z)(this,"autoDialMaxQueueLength",void 0),(0,we.Z)(this,"autoDialPeerRetryThresholdMs",void 0),(0,we.Z)(this,"autoDialDiscoveredPeersDebounce",void 0),(0,we.Z)(this,"autoDialInterval",void 0),(0,we.Z)(this,"started",void 0),(0,we.Z)(this,"running",void 0),this.connectionManager=t.connectionManager,this.peerStore=t.peerStore,this.minConnections=null!==(n=r.minConnections)&&void 0!==n?n:Fw.minConnections,this.autoDialPriority=null!==(i=r.autoDialPriority)&&void 0!==i?i:Fw.autoDialPriority,this.autoDialIntervalMs=null!==(a=r.autoDialInterval)&&void 0!==a?a:Fw.autoDialInterval,this.autoDialMaxQueueLength=null!==(s=r.maxQueueLength)&&void 0!==s?s:Fw.maxQueueLength,this.autoDialPeerRetryThresholdMs=null!==(o=r.autoDialPeerRetryThreshold)&&void 0!==o?o:Fw.autoDialPeerRetryThreshold,this.autoDialDiscoveredPeersDebounce=null!==(u=r.autoDialDiscoveredPeersDebounce)&&void 0!==u?u:Fw.autoDialDiscoveredPeersDebounce,this.started=!1,this.running=!1,this.queue=new Mw({concurrency:null!==(c=r.autoDialConcurrency)&&void 0!==c?c:Fw.autoDialConcurrency}),this.queue.addListener("error",(function(e){Nw.error("error during auto-dial",e)})),t.events.addEventListener("connection:close",(function(){h.autoDial().catch((function(e){Nw.error(e)}))})),t.events.addEventListener("peer:discovery",(function(){clearTimeout(l),l=setTimeout((function(){h.autoDial().catch((function(e){Nw.error(e)}))}),h.autoDialDiscoveredPeersDebounce)}))}return(0,fi.Z)(e,[{key:"isStarted",value:function(){return this.started}},{key:"start",value:function(){var e=this;this.autoDialInterval=setTimeout((function(){e.autoDial().catch((function(e){Nw.error("error while autodialing",e)}))}),this.autoDialIntervalMs),this.started=!0}},{key:"afterStart",value:function(){this.autoDial().catch((function(e){Nw.error("error while autodialing",e)}))}},{key:"stop",value:function(){this.queue.clear(),clearTimeout(this.autoDialInterval),this.started=!1,this.running=!1}},{key:"autoDial",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i,a,s,o,u,c,l,h,f,d,p,v=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.started){e.next=2;break}return e.abrupt("return");case 2:if(t=this.connectionManager.getConnectionsMap(),!((r=t.size)>=this.minConnections)){e.next=7;break}return this.minConnections>0&&Nw.trace("have enough connections %d/%d",r,this.minConnections),e.abrupt("return");case 7:if(!(this.queue.size>this.autoDialMaxQueueLength)){e.next=10;break}return Nw("not enough connections %d/%d but auto dial queue is full",r,this.minConnections),e.abrupt("return");case 10:if(!this.running){e.next=13;break}return Nw("not enough connections %d/%d - but skipping autodial as it is already running",r,this.minConnections),e.abrupt("return");case 13:return this.running=!0,Nw("not enough connections %d/%d - will dial peers to increase the number of connections",r,this.minConnections),n=new Em(this.connectionManager.getDialQueue().map((function(e){return e.peerId})).filter(Boolean)),e.next=18,this.peerStore.all({filters:[function(e){return 0===e.addresses.length?(Nw.trace("not autodialing %p because they have no addresses",e.id),!1):t.has(e.id)?(Nw.trace("not autodialing %p because they are already connected",e.id),!1):n.has(e.id)?(Nw.trace("not autodialing %p because they are already being dialed",e.id),!1):!v.queue.hasJob(e.id)||(Nw.trace("not autodialing %p because they are already being autodialed",e.id),!1)}]});case 18:i=e.sent,a=i.sort((function(){return Math.random()>.5?1:-1})),s=new xm,o=(0,ge.Z)(a),e.prev=22,o.s();case 24:if((u=o.n()).done){e.next=31;break}if(c=u.value,!s.has(c.id)){e.next=28;break}return e.abrupt("continue",29);case 28:s.set(c.id,be(c.tags.values()).reduce((function(e,t){return e+t.value}),0));case 29:e.next=24;break;case 31:e.next=36;break;case 33:e.prev=33,e.t0=e.catch(22),o.e(e.t0);case 36:return e.prev=36,o.f(),e.finish(36);case 39:l=a.sort((function(e,t){var r,n,i=null!==(r=s.get(e.id))&&void 0!==r?r:0,a=null!==(n=s.get(t.id))&&void 0!==n?n:0;return i>a?-1:i<a?1:0})),h=l.filter((function(e){var t=e.metadata.get(Ow);if(null==t)return!0;var r=parseInt(Ws(t));return!!isNaN(r)||Date.now()-r>v.autoDialPeerRetryThresholdMs})),Nw("selected %d/%d peers to dial",h.length,i.length),f=(0,ge.Z)(h),e.prev=43,p=(0,ii.Z)().mark((function e(){var t;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=d.value,v.queue.add((0,ai.Z)((0,ii.Z)().mark((function e(){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((r=v.connectionManager.getConnectionsMap().size)>=v.minConnections)){e.next=5;break}return Nw("got enough connections now %d/%d",r,v.minConnections),v.queue.clear(),e.abrupt("return");case 5:return Nw("connecting to a peerStore stored peer %p",t.id),e.next=8,v.connectionManager.openConnection(t.id,{priority:v.autoDialPriority});case 8:case"end":return e.stop()}}),e)}))),{peerId:t.id}).catch((function(e){Nw.error("could not connect to peerStore stored peer",e)}));case 2:case"end":return e.stop()}}),e)})),f.s();case 46:if((d=f.n()).done){e.next=50;break}return e.delegateYield(p(),"t1",48);case 48:e.next=46;break;case 50:e.next=55;break;case 52:e.prev=52,e.t2=e.catch(43),f.e(e.t2);case 55:return e.prev=55,f.f(),e.finish(55);case 58:this.running=!1,this.started&&(this.autoDialInterval=setTimeout((function(){v.autoDial().catch((function(e){Nw.error("error while autodialing",e)}))}),this.autoDialIntervalMs));case 60:case"end":return e.stop()}}),e,this,[[22,33,36,39],[43,52,55,58]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),zw=zi("libp2p:connection-manager:connection-pruner"),jw={maxConnections:Bw,allow:[]},Hw=function(){function e(t){var r,n,i=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,hi.Z)(this,e),(0,we.Z)(this,"maxConnections",void 0),(0,we.Z)(this,"connectionManager",void 0),(0,we.Z)(this,"peerStore",void 0),(0,we.Z)(this,"allow",void 0),(0,we.Z)(this,"events",void 0),this.maxConnections=null!==(r=a.maxConnections)&&void 0!==r?r:jw.maxConnections,this.allow=null!==(n=a.allow)&&void 0!==n?n:jw.allow,this.connectionManager=t.connectionManager,this.peerStore=t.peerStore,this.events=t.events,t.events.addEventListener("connection:open",(function(){i.maybePruneConnections().catch((function(e){zw.error(e)}))}))}return(0,fi.Z)(e,[{key:"maybePruneConnections",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i,a,s,o,u,c,l,h,f,d,p,v=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.connectionManager.getConnections(),r=t.length,n=Math.max(r-this.maxConnections,0),zw("checking max connections limit %d/%d",r,this.maxConnections),!(r<=this.maxConnections)){e.next=6;break}return e.abrupt("return");case 6:zw("max connections limit exceeded %d/%d, pruning %d connection(s)",r,this.maxConnections,n),i=new xm,a=(0,ge.Z)(t),e.prev=9,a.s();case 11:if((s=a.n()).done){e.next=29;break}if(o=s.value,u=o.remotePeer,!i.has(u)){e.next=16;break}return e.abrupt("continue",27);case 16:return i.set(u,0),e.prev=17,e.next=20,this.peerStore.get(u);case 20:c=e.sent,i.set(u,be(c.tags.values()).reduce((function(e,t){return e+t.value}),0)),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(17),"ERR_NOT_FOUND"!==e.t0.code&&zw.error("error loading peer tags",e.t0);case 27:e.next=11;break;case 29:e.next=34;break;case 31:e.prev=31,e.t1=e.catch(9),a.e(e.t1);case 34:return e.prev=34,a.f(),e.finish(34);case 37:l=t.sort((function(e,t){var r,n,a=null!==(r=i.get(e.remotePeer))&&void 0!==r?r:0,s=null!==(n=i.get(t.remotePeer))&&void 0!==n?n:0;if(a>s)return 1;if(a<s)return-1;var o=e.timeline.open,u=t.timeline.open;return o<u?1:o>u?-1:0})),h=[],f=(0,ge.Z)(l),e.prev=40,p=(0,ii.Z)().mark((function e(){var t;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.value,zw("too many connections open - closing a connection to %p",t.remotePeer),v.allow.some((function(e){return t.remoteAddr.toString().startsWith(e.toString())}))||h.push(t),h.length!==n){e.next=6;break}return e.abrupt("return",1);case 6:case"end":return e.stop()}}),e)})),f.s();case 43:if((d=f.n()).done){e.next=49;break}return e.delegateYield(p(),"t2",45);case 45:if(!e.t2){e.next=47;break}return e.abrupt("break",49);case 47:e.next=43;break;case 49:e.next=54;break;case 51:e.prev=51,e.t3=e.catch(40),f.e(e.t3);case 54:return e.prev=54,f.f(),e.finish(54);case 57:return e.next=59,Promise.all(h.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.close();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),zw.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()));case 59:this.events.safeDispatchEvent("connection:prune",{detail:h});case 60:case"end":return e.stop()}}),e,this,[[9,31,34,37],[17,24],[40,51,54,57]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),Ww=zi("libp2p:connection-manager:utils");function qw(e,t){return Vw.apply(this,arguments)}function Vw(){return Vw=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.protoNames().includes("dnsaddr")){e.next=3;break}return e.abrupt("return",[t]);case 3:return e.next=5,Kw(t,r);case 5:return n=e.sent,e.next=8,Promise.all(n.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",qw(t,r));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 8:return i=e.sent,a=i.flat(),s=a.reduce((function(e,t){return null==e.find((function(e){return e.equals(t)}))&&e.push(t),e}),[]),Ww("resolved %s to",t,s.map((function(e){return e.toString()}))),e.abrupt("return",s);case 13:case"end":return e.stop()}}),e)}))),Vw.apply(this,arguments)}function Kw(e,t){return Yw.apply(this,arguments)}function Yw(){return(Yw=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=kb(t.toString()),e.next=4,t.resolve(r);case 4:return n=e.sent,e.abrupt("return",n);case 8:return e.prev=8,e.t0=e.catch(0),Ww.error("multiaddr ".concat(t.toString()," could not be resolved"),e.t0),e.abrupt("return",[]);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function Gw(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var i=0,a=r;i<a.length;i++){var s=a[i];if(null!=s){try{null===Wu.setMaxListeners||void 0===Wu.setMaxListeners||(0,Wu.setMaxListeners)(1/0,s)}catch(u){}e.push(s)}}var o=vo(e);try{null===Wu.setMaxListeners||void 0===Wu.setMaxListeners||(0,Wu.setMaxListeners)(1/0,o)}catch(c){}return o}var Qw=zi("libp2p:connection-manager:dial-queue"),Xw={addressSorter:fw,maxParallelDials:50,maxPeerAddrsToDial:25,maxParallelDialsPerPeer:1,dialTimeout:3e4,resolvers:{dnsaddr:Cw}},Jw=function(){function e(t){var r,n,i,a,s,o,u,c=this,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,hi.Z)(this,e),(0,we.Z)(this,"pendingDials",void 0),(0,we.Z)(this,"queue",void 0),(0,we.Z)(this,"peerId",void 0),(0,we.Z)(this,"peerStore",void 0),(0,we.Z)(this,"connectionGater",void 0),(0,we.Z)(this,"transportManager",void 0),(0,we.Z)(this,"addressSorter",void 0),(0,we.Z)(this,"maxPeerAddrsToDial",void 0),(0,we.Z)(this,"maxParallelDialsPerPeer",void 0),(0,we.Z)(this,"dialTimeout",void 0),(0,we.Z)(this,"inProgressDialCount",void 0),(0,we.Z)(this,"pendingDialCount",void 0),(0,we.Z)(this,"shutDownController",void 0),this.addressSorter=null!==(r=l.addressSorter)&&void 0!==r?r:Xw.addressSorter,this.maxPeerAddrsToDial=null!==(n=l.maxPeerAddrsToDial)&&void 0!==n?n:Xw.maxPeerAddrsToDial,this.maxParallelDialsPerPeer=null!==(i=l.maxParallelDialsPerPeer)&&void 0!==i?i:Xw.maxParallelDialsPerPeer,this.dialTimeout=null!==(a=l.dialTimeout)&&void 0!==a?a:Xw.dialTimeout,this.peerId=t.peerId,this.peerStore=t.peerStore,this.connectionGater=t.connectionGater,this.transportManager=t.transportManager,this.shutDownController=new AbortController;try{null===Wu.setMaxListeners||void 0===Wu.setMaxListeners||(0,Wu.setMaxListeners)(1/0,this.shutDownController.signal)}catch(y){}this.pendingDialCount=null===(s=t.metrics)||void 0===s?void 0:s.registerMetric("libp2p_dialler_pending_dials"),this.inProgressDialCount=null===(o=t.metrics)||void 0===o?void 0:o.registerMetric("libp2p_dialler_in_progress_dials"),this.pendingDials=[];for(var h=0,f=Object.entries(null!==(d=l.resolvers)&&void 0!==d?d:{});h<f.length;h++){var d,p=(0,ke.Z)(f[h],2),v=p[0],g=p[1];pb.set(v,g)}this.queue=new Bh({concurrency:null!==(u=l.maxParallelDials)&&void 0!==u?u:Xw.maxParallelDials}),this.queue.on("add",(function(){var e,t;null===(e=c.pendingDialCount)||void 0===e||e.update(c.queue.size),null===(t=c.inProgressDialCount)||void 0===t||t.update(c.queue.pending)})),this.queue.on("active",(function(){var e,t;null===(e=c.pendingDialCount)||void 0===e||e.update(c.queue.size),null===(t=c.inProgressDialCount)||void 0===t||t.update(c.queue.pending)})),this.queue.on("completed",(function(){var e,t;null===(e=c.pendingDialCount)||void 0===e||e.update(c.queue.size),null===(t=c.inProgressDialCount)||void 0===t||t.update(c.queue.pending)})),this.queue.on("error",(function(e){var t,r;Qw.error("error in dial queue",e),null===(t=c.pendingDialCount)||void 0===t||t.update(c.queue.size),null===(r=c.inProgressDialCount)||void 0===r||r.update(c.queue.pending)})),this.queue.on("empty",(function(){var e,t;null===(e=c.pendingDialCount)||void 0===e||e.update(c.queue.size),null===(t=c.inProgressDialCount)||void 0===t||t.update(c.queue.pending)})),this.queue.on("idle",(function(){var e,t;null===(e=c.pendingDialCount)||void 0===e||e.update(c.queue.size),null===(t=c.inProgressDialCount)||void 0===t||t.update(c.queue.pending)}))}return(0,fi.Z)(e,[{key:"stop",value:function(){this.shutDownController.abort()}},{key:"dial",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c,l,h=this,f=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=f.length>1&&void 0!==f[1]?f[1]:{},n=Iw(t),i=n.peerId,a=n.multiaddrs,s=a.map((function(e){return{multiaddr:e,isCertified:!1}})),o=this.createDialAbortControllers(r.signal),e.prev=4,e.next=7,this.calculateMultiaddrs(i,s,(0,_e.Z)((0,_e.Z)({},r),{},{signal:o}));case 7:u=e.sent,e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(4),o.clear(),e.t0;case 14:if(c=this.pendingDials.find((function(e){return!(null==e.peerId||null==i||!e.peerId.equals(i))||u.map((function(e){return e.multiaddr.toString()})).join()===e.multiaddrs.map((function(e){return e.toString()})).join()})),null==c){e.next=19;break}return Qw("joining existing dial target for %p",i),o.clear(),e.abrupt("return",c.promise);case 19:return Qw("creating dial target for",u.map((function(e){return e.multiaddr.toString()}))),(l={id:"".concat(parseInt(String(1e9*Math.random()),10).toString()).concat(Date.now()),status:"queued",peerId:i,multiaddrs:u.map((function(e){return e.multiaddr}))}).promise=this.performDial(l,(0,_e.Z)((0,_e.Z)({},r),{},{signal:o})).finally((function(){h.pendingDials=h.pendingDials.filter((function(e){return e.id!==l.id})),o.clear()})).catch(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Qw.error("dial failed to %s",l.multiaddrs.map((function(e){return e.toString()})).join(", "),t),null==i){e.next=10;break}return e.prev=2,e.next=5,h.peerStore.patch(i,{metadata:(0,we.Z)({},Ow,Hs(Date.now().toString()))});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),Qw.error("could not update last dial failure key for %p",i,e.t0);case 10:if(!o.aborted){e.next=13;break}throw new wo(t.message,ww.ERR_TIMEOUT);case 13:throw t;case 14:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t){return e.apply(this,arguments)}}()),this.pendingDials.push(l),e.abrupt("return",l.promise);case 24:case"end":return e.stop()}}),e,this,[[4,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"createDialAbortControllers",value:function(e){var t=vo([AbortSignal.timeout(this.dialTimeout),this.shutDownController.signal,e]);try{null===Wu.setMaxListeners||void 0===Wu.setMaxListeners||(0,Wu.setMaxListeners)(1/0,t)}catch(r){}return t}},{key:"calculateMultiaddrs",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c,l,h,f,d,p,v,g,y,m,b,_,w,k=this,x=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=x.length>1&&void 0!==x[1]?x[1]:[],n=x.length>2&&void 0!==x[2]?x[2]:{},null==t){e.next=24;break}if(!this.peerId.equals(t)){e.next=5;break}throw new wo("Tried to dial self",ww.ERR_DIALED_SELF);case 5:return e.next=7,null===(i=(a=this.connectionGater).denyDialPeer)||void 0===i?void 0:i.call(a,t);case 7:if(e.t0=e.sent,!0!==e.t0){e.next=10;break}throw new wo("The dial request is blocked by gater.allowDialPeer",ww.ERR_PEER_DIAL_INTERCEPTED);case 10:if(0!==r.length){e.next=24;break}return Qw("loading multiaddrs for %p",t),e.prev=12,e.next=15,this.peerStore.get(t);case 15:s=e.sent,r.push.apply(r,be(s.addresses)),Qw("loaded multiaddrs for %p",t,r.map((function(e){return e.multiaddr.toString()}))),e.next=24;break;case 20:if(e.prev=20,e.t1=e.catch(12),e.t1.code===ww.ERR_NOT_FOUND){e.next=24;break}throw e.t1;case 24:return e.next=26,Promise.all(r.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qw(t.multiaddr,n);case 2:if(1!==(r=e.sent).length||!r[0].equals(t.multiaddr)){e.next=5;break}return e.abrupt("return",t);case 5:return e.abrupt("return",r.map((function(e){return{multiaddr:e,isCertified:!1}})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 26:o=e.sent.flat(),u=o.filter((function(e){if(null==k.transportManager.transportForMultiaddr(e.multiaddr))return!1;var r=e.multiaddr.getPeerId();return null==t||null==r||t.equals(r)})),c=new Map,l=(0,ge.Z)(u),e.prev=30,l.s();case 32:if((h=l.n()).done){e.next=42;break}if(f=h.value,d=f.multiaddr.toString(),null==(p=c.get(d))){e.next=39;break}return p.isCertified=p.isCertified||f.isCertified||!1,e.abrupt("continue",40);case 39:c.set(d,f);case 40:e.next=32;break;case 42:e.next=47;break;case 44:e.prev=44,e.t2=e.catch(30),l.e(e.t2);case 47:return e.prev=47,l.f(),e.finish(47);case 50:if((0===(v=be(c.values())).length||v.length>this.maxPeerAddrsToDial)&&(Qw("addresses for %p before filtering",null!==t&&void 0!==t?t:"unknown peer",o.map((function(e){return e.multiaddr.toString()}))),Qw("addresses for %p after filtering",null!==t&&void 0!==t?t:"unknown peer",v.map((function(e){return e.multiaddr.toString()})))),0!==v.length){e.next=54;break}throw new wo("The dial request has no valid addresses",ww.ERR_NO_VALID_ADDRESSES);case 54:if(!(v.length>this.maxPeerAddrsToDial)){e.next=56;break}throw new wo("dial with more addresses than allowed",ww.ERR_TOO_MANY_ADDRESSES);case 56:null!=t&&(g="/p2p/".concat(t.toString()),v=v.map((function(e){var r=e.multiaddr.getPeerId(),n=e.multiaddr.protos().pop();return!0===(null===n||void 0===n?void 0:n.path)?e:r!==t.toString()?{multiaddr:e.multiaddr.encapsulate(g),isCertified:e.isCertified}:e}))),y=[],m=(0,ge.Z)(v),e.prev=59,m.s();case 61:if((b=m.n()).done){e.next=73;break}if(_=b.value,e.t3=null!=this.connectionGater.denyDialMultiaddr,!e.t3){e.next=68;break}return e.next=67,this.connectionGater.denyDialMultiaddr(_.multiaddr);case 67:e.t3=e.sent;case 68:if(!e.t3){e.next=70;break}return e.abrupt("continue",71);case 70:y.push(_);case 71:e.next=61;break;case 73:e.next=78;break;case 75:e.prev=75,e.t4=e.catch(59),m.e(e.t4);case 78:return e.prev=78,m.f(),e.finish(78);case 81:if(0!==(w=y.sort(this.addressSorter)).length){e.next=84;break}throw new wo("The connection gater denied all addresses in the dial request",ww.ERR_NO_VALID_ADDRESSES);case 84:return e.abrupt("return",w);case 85:case"end":return e.stop()}}),e,this,[[12,20],[30,44,47,50],[59,75,78,81]])})));return function(t){return e.apply(this,arguments)}}()},{key:"performDial",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s=this,o=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:{},n=t.multiaddrs.map((function(){return new AbortController})),e.prev=2,(i=new Bh({concurrency:this.maxParallelDialsPerPeer})).on("error",(function(e){Qw.error("error dialling",e)})),e.next=7,Promise.any(t.multiaddrs.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(a,o){var u,c,l;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(u=n[o])){e.next=3;break}throw new wo("dialAction did not come with an AbortController",ww.ERR_INVALID_PARAMETERS);case 3:return(c=Gw(u.signal,r.signal)).addEventListener("abort",(function(){Qw("dial to %a aborted",a)})),l=ts(),e.next=8,i.add((0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.aborted){e.next=4;break}return Qw("dial to %a was aborted before reaching the head of the peer dial queue",a),l.reject(new _o),e.abrupt("return");case 4:return e.next=6,s.queue.add((0,ai.Z)((0,ii.Z)().mark((function e(){var i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!c.aborted){e.next=5;break}return Qw("dial to %a was aborted before reaching the head of the dial queue",a),l.reject(new _o),e.abrupt("return");case 5:return t.status="active",e.next=8,s.transportManager.dial(a,(0,_e.Z)((0,_e.Z)({},r),{},{signal:c}));case 8:if(i=e.sent,!u.signal.aborted){e.next=14;break}return Qw("multiple dials succeeded, closing superfluous connection"),i.close().catch((function(e){Qw.error("error closing superfluous connection",e)})),l.reject(new _o),e.abrupt("return");case 14:n[o]=void 0,n.forEach((function(e){void 0!==e&&e.abort()})),Qw("dial to %a succeeded",a),l.resolve(i),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(0),Qw.error("error during dial of %a",a,e.t0),l.reject(e.t0);case 24:case"end":return e.stop()}}),e,null,[[0,20]])}))),(0,_e.Z)((0,_e.Z)({},r),{},{signal:c})).catch((function(e){l.reject(e)}));case 6:case"end":return e.stop()}}),e)}))),{signal:c}).catch((function(e){l.reject(e)})).finally((function(){c.clear()}));case 8:return e.abrupt("return",l.promise);case 9:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()));case 7:if(null!=(a=e.sent)){e.next=10;break}throw new wo("successful dial led to empty object returned from peer dial queue",ww.ERR_TRANSPORT_DIAL_FAILED);case 10:return t.status="success",e.abrupt("return",a);case 14:if(e.prev=14,e.t0=e.catch(2),t.status="error",1!==t.multiaddrs.length||"AggregateError"!==e.t0.name){e.next=19;break}throw e.t0.errors[0];case 19:throw e.t0;case 20:case"end":return e.stop()}}),e,this,[[2,14]])})));return function(t){return e.apply(this,arguments)}}()}]),e}();var $w=zi("libp2p:connection-manager"),ek=5,tk=Bw,rk=5,nk=10,ik=25,ak=0,sk=100,ok=function(){function e(t){var r,n,i,a,s,o,u,c,l,h,f,d,p,v,g,y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,hi.Z)(this,e),(0,we.Z)(this,"started",void 0),(0,we.Z)(this,"connections",void 0),(0,we.Z)(this,"allow",void 0),(0,we.Z)(this,"deny",void 0),(0,we.Z)(this,"maxIncomingPendingConnections",void 0),(0,we.Z)(this,"incomingPendingConnections",void 0),(0,we.Z)(this,"maxConnections",void 0),(0,we.Z)(this,"dialQueue",void 0),(0,we.Z)(this,"autoDial",void 0),(0,we.Z)(this,"connectionPruner",void 0),(0,we.Z)(this,"inboundConnectionRateLimiter",void 0),(0,we.Z)(this,"peerStore",void 0),(0,we.Z)(this,"metrics",void 0),(0,we.Z)(this,"events",void 0),this.maxConnections=null!==(r=y.maxConnections)&&void 0!==r?r:tk;var m=null!==(n=y.minConnections)&&void 0!==n?n:ek;if(this.maxConnections<m)throw new wo("Connection Manager maxConnections must be greater than minConnections",ww.ERR_INVALID_PARAMETERS);this.connections=new xm,this.started=!1,this.peerStore=t.peerStore,this.metrics=t.metrics,this.events=t.events,this.onConnect=this.onConnect.bind(this),this.onDisconnect=this.onDisconnect.bind(this),this.events.addEventListener("connection:open",this.onConnect),this.events.addEventListener("connection:close",this.onDisconnect),this.allow=(null!==(i=y.allow)&&void 0!==i?i:[]).map((function(e){return kb(e)})),this.deny=(null!==(a=y.deny)&&void 0!==a?a:[]).map((function(e){return kb(e)})),this.incomingPendingConnections=0,this.maxIncomingPendingConnections=null!==(s=y.maxIncomingPendingConnections)&&void 0!==s?s:nk,this.inboundConnectionRateLimiter=new Tw.RateLimiterMemory({points:null!==(o=y.inboundConnectionThreshold)&&void 0!==o?o:rk,duration:1}),this.autoDial=new Uw({connectionManager:this,peerStore:t.peerStore,events:t.events},{minConnections:m,autoDialConcurrency:null!==(u=y.autoDialConcurrency)&&void 0!==u?u:ik,autoDialPriority:null!==(c=y.autoDialPriority)&&void 0!==c?c:ak,maxQueueLength:null!==(l=y.autoDialMaxQueueLength)&&void 0!==l?l:sk}),this.connectionPruner=new Hw({connectionManager:this,peerStore:t.peerStore,events:t.events},{maxConnections:this.maxConnections,allow:this.allow}),this.dialQueue=new Jw({peerId:t.peerId,metrics:t.metrics,peerStore:t.peerStore,transportManager:t.transportManager,connectionGater:t.connectionGater},{addressSorter:null!==(h=y.addressSorter)&&void 0!==h?h:fw,maxParallelDials:null!==(f=y.maxParallelDials)&&void 0!==f?f:50,maxPeerAddrsToDial:null!==(d=y.maxPeerAddrsToDial)&&void 0!==d?d:25,maxParallelDialsPerPeer:null!==(p=y.maxParallelDialsPerPeer)&&void 0!==p?p:1,dialTimeout:null!==(v=y.dialTimeout)&&void 0!==v?v:3e4,resolvers:null!==(g=y.resolvers)&&void 0!==g?g:{dnsaddr:Cw}})}return(0,fi.Z)(e,[{key:"isStarted",value:function(){return this.started}},{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null===(t=this.metrics)||void 0===t||t.registerMetricGroup("libp2p_connection_manager_connections",{calculate:function(){var e,t={inbound:0,outbound:0},r=(0,ge.Z)(i.connections.values());try{for(r.s();!(e=r.n()).done;){var n,a=e.value,s=(0,ge.Z)(a);try{for(s.s();!(n=s.n()).done;){"inbound"===n.value.direction?t.inbound++:t.outbound++}}catch(S$){s.e(S$)}finally{s.f()}}}catch(S$){r.e(S$)}finally{r.f()}return t}}),null===(r=this.metrics)||void 0===r||r.registerMetricGroup("libp2p_protocol_streams_total",{label:"protocol",calculate:function(){var e,t={},r=(0,ge.Z)(i.connections.values());try{for(r.s();!(e=r.n()).done;){var n,a=e.value,s=(0,ge.Z)(a);try{for(s.s();!(n=s.n()).done;){var o,u=n.value,c=(0,ge.Z)(u.streams);try{for(c.s();!(o=c.n()).done;){var l,h,f=o.value,d="".concat(f.direction," ").concat(null!==(l=f.protocol)&&void 0!==l?l:"unnegotiated");t[d]=(null!==(h=t[d])&&void 0!==h?h:0)+1}}catch(S$){c.e(S$)}finally{c.f()}}}catch(S$){s.e(S$)}finally{s.f()}}}catch(S$){r.e(S$)}finally{r.f()}return t}}),null===(n=this.metrics)||void 0===n||n.registerMetricGroup("libp2p_connection_manager_protocol_streams_per_connection_90th_percentile",{label:"protocol",calculate:function(){var e,t={},r=(0,ge.Z)(i.connections.values());try{for(r.s();!(e=r.n()).done;){var n,a=e.value,s=(0,ge.Z)(a);try{for(s.s();!(n=s.n()).done;){var o,u=n.value,c={},l=(0,ge.Z)(u.streams);try{for(l.s();!(o=l.n()).done;){var h,f,d=o.value,p="".concat(d.direction," ").concat(null!==(h=d.protocol)&&void 0!==h?h:"unnegotiated");c[p]=(null!==(f=c[p])&&void 0!==f?f:0)+1}}catch(S$){l.e(S$)}finally{l.f()}for(var v=0,g=Object.entries(c);v<g.length;v++){var y,m=(0,ke.Z)(g[v],2),b=m[0],_=m[1];t[b]=null!==(y=t[b])&&void 0!==y?y:[],t[b].push(_)}}}catch(S$){s.e(S$)}finally{s.f()}}}catch(S$){r.e(S$)}finally{r.f()}for(var w={},k=0,x=Object.entries(t);k<x.length;k++){var E=(0,ke.Z)(x[k],2),S=E[0],C=E[1];C=C.sort((function(e,t){return e-t}));var A=Math.floor(.9*C.length);w[S]=C[A]}return w}}),this.autoDial.start(),this.started=!0,$w("started");case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"afterStart",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Promise.resolve().then((0,ai.Z)((0,ii.Z)().mark((function e(){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.peerStore.all({filters:[function(e){return e.tags.has("keep-alive")}]});case 2:return r=e.sent,e.next=5,Promise.all(r.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(r){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.openConnection(r.id).catch((function(e){$w.error(e)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:case"end":return e.stop()}}),e)})))).catch((function(e){$w.error(e)})),this.autoDial.afterStart();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i,a,s,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.dialQueue.stop(),this.autoDial.stop(),t=[],r=(0,ge.Z)(this.connections.values()),e.prev=4,r.s();case 6:if((n=r.n()).done){e.next=26;break}i=n.value,a=(0,ge.Z)(i),e.prev=9,o=(0,ii.Z)().mark((function e(){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=s.value,t.push((0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.close();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),$w.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))());case 2:case"end":return e.stop()}}),e)})),a.s();case 12:if((s=a.n()).done){e.next=16;break}return e.delegateYield(o(),"t0",14);case 14:e.next=12;break;case 16:e.next=21;break;case 18:e.prev=18,e.t1=e.catch(9),a.e(e.t1);case 21:return e.prev=21,a.f(),e.finish(21);case 24:e.next=6;break;case 26:e.next=31;break;case 28:e.prev=28,e.t2=e.catch(4),r.e(e.t2);case 31:return e.prev=31,r.f(),e.finish(31);case 34:return $w("closing %d connections",t.length),e.next=37,Promise.all(t);case 37:this.connections.clear(),$w("stopped");case 39:case"end":return e.stop()}}),e,this,[[4,28,31,34],[9,18,21,24]])})));return function(){return e.apply(this,arguments)}}()},{key:"onConnect",value:function(e){this._onConnect(e).catch((function(e){$w.error(e)}))}},{key:"_onConnect",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.detail,this.started){e.next=5;break}return e.next=4,r.close();case 4:return e.abrupt("return");case 5:if(n=r.remotePeer,i=this.connections.get(n),a=!1,null!=i?i.push(r):(a=!0,this.connections.set(n,[r])),null==n.publicKey||"RSA"!==n.type){e.next=12;break}return e.next=12,this.peerStore.patch(n,{publicKey:n.publicKey});case 12:a&&this.events.safeDispatchEvent("peer:connect",{detail:r.remotePeer});case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onDisconnect",value:function(e){var t=e.detail;if(this.started){var r=t.remotePeer,n=this.connections.get(r);null!=n&&n.length>1?(n=n.filter((function(e){return e.id!==t.id})),this.connections.set(r,n)):null!=n&&(this.connections.delete(r),this.events.safeDispatchEvent("peer:disconnect",{detail:t.remotePeer}))}}},{key:"getConnections",value:function(e){var t;if(null!=e)return null!==(t=this.connections.get(e))&&void 0!==t?t:[];var r,n=[],i=(0,ge.Z)(this.connections.values());try{for(i.s();!(r=i.n()).done;){var a=r.value;n=n.concat(a)}}catch(S$){i.e(S$)}finally{i.f()}return n}},{key:"getConnectionsMap",value:function(){return this.connections}},{key:"openConnection",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c,l,h,f,d=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=d.length>1&&void 0!==d[1]?d[1]:{},this.isStarted()){e.next=3;break}throw new wo("Not started",ww.ERR_NODE_NOT_STARTED);case 3:if(null===(r=i.signal)||void 0===r||r.throwIfAborted(),a=Iw(t),null==(s=a.peerId)||!0===i.force){e.next=11;break}if($w("dial %p",s),!((o=this.getConnections(s)).length>0)){e.next=11;break}return $w("had an existing connection to %p",s),e.abrupt("return",o[0]);case 11:return e.next=13,this.dialQueue.dial(t,(0,_e.Z)((0,_e.Z)({},i),{},{priority:null!==(n=i.priority)&&void 0!==n?n:50}));case 13:u=e.sent,null==(c=this.connections.get(u.remotePeer))&&(c=[],this.connections.set(u.remotePeer,c)),l=!1,h=(0,ge.Z)(c);try{for(h.s();!(f=h.n()).done;)f.value.id===u.id&&(l=!0)}catch(S$){h.e(S$)}finally{h.f()}return l||c.push(u),e.abrupt("return",u);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"closeConnections",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:{},i=null!==(r=this.connections.get(t))&&void 0!==r?r:[],e.next=4,Promise.all(i.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.close(n);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),t.abort(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"acceptIncomingConnection",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.deny.some((function(e){return t.remoteAddr.toString().startsWith(e.toString())}))){e.next=4;break}return $w("connection from %a refused - connection remote address was in deny list",t.remoteAddr),e.abrupt("return",!1);case 4:if(!this.allow.some((function(e){return t.remoteAddr.toString().startsWith(e.toString())}))){e.next=8;break}return this.incomingPendingConnections++,e.abrupt("return",!0);case 8:if(this.incomingPendingConnections!==this.maxIncomingPendingConnections){e.next=11;break}return $w("connection from %a refused - incomingPendingConnections exceeded by host",t.remoteAddr),e.abrupt("return",!1);case 11:if(!t.remoteAddr.isThinWaistAddress()){e.next=22;break}return r=t.remoteAddr.nodeAddress().address,e.prev=13,e.next=16,this.inboundConnectionRateLimiter.consume(r,1);case 16:e.next=22;break;case 18:return e.prev=18,e.t0=e.catch(13),$w("connection from %a refused - inboundConnectionThreshold exceeded by host %s",t.remoteAddr,r),e.abrupt("return",!1);case 22:if(!(this.getConnections().length<this.maxConnections)){e.next=25;break}return this.incomingPendingConnections++,e.abrupt("return",!0);case 25:return $w("connection from %a refused - maxConnections exceeded",t.remoteAddr),e.abrupt("return",!1);case 27:case"end":return e.stop()}}),e,this,[[13,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"afterUpgradeInbound",value:function(){this.incomingPendingConnections--}},{key:"getDialQueue",value:function(){return this.dialQueue.pendingDials}}]),e}();function uk(e,t){return ck.apply(this,arguments)}function ck(){return ck=ea((0,ii.Z)().mark((function e(t,r){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(Xa(ui(ro(t,function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.merge(t.id,{multiaddrs:t.multiaddrs});case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))),"t0",1);case 1:case"end":return e.stop()}}),e)}))),ck.apply(this,arguments)}function lk(e){var t=new Set;return Qa(e,(function(e){return!t.has(e.id.toString())&&(t.add(e.id.toString()),!0)}))}function hk(e){return fk.apply(this,arguments)}function fk(){return fk=ea((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,ii.Z)().mark((function r(){var n,i,a,s,o,u,c;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=0,i=!1,a=!1,r.prev=3,o=ui(e);case 5:return r.next=7,Ji(o.next());case 7:if(!(i=!(u=r.sent).done)){r.next=15;break}return c=u.value,n++,r.next=12,c;case 12:i=!1,r.next=5;break;case 15:r.next=21;break;case 17:r.prev=17,r.t0=r.catch(3),a=!0,s=r.t0;case 21:if(r.prev=21,r.prev=22,!i||null==o.return){r.next=26;break}return r.next=26,Ji(o.return());case 26:if(r.prev=26,!a){r.next=29;break}throw s;case 29:return r.finish(26);case 30:return r.finish(21);case 31:if(!(n<t)){r.next=33;break}throw new wo("more peers required, seen: ".concat(n,"  min: ").concat(t),"NOT_FOUND");case 33:case"end":return r.stop()}}),r,null,[[3,17,21,31],[22,,26,30]])}))()})),fk.apply(this,arguments)}var dk=function(){function e(t,r){var n;(0,hi.Z)(this,e),(0,we.Z)(this,"routers",void 0),(0,we.Z)(this,"started",void 0),(0,we.Z)(this,"components",void 0),this.routers=null!==(n=r.routers)&&void 0!==n?n:[],this.started=!1,this.components=t}return(0,fi.Z)(e,[{key:"isStarted",value:function(){return this.started}},{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.started=!0;case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.started=!1;case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"findProviders",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(0!==t.routers.length){n.next=2;break}throw new wo("No content routers available",ww.ERR_NO_ROUTERS_AVAILABLE);case 2:return n.delegateYield(Xa(ui(no(os.apply(void 0,be(t.routers.map((function(t){return t.findProviders(e,r)})))),(function(e){return uk(e,t.components.peerStore)}),(function(e){return lk(e)}),(function(e){return hk(e)})))),"t0",3);case 3:case"end":return n.stop()}}),n)})))()}},{key:"provide",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.length>1&&void 0!==n[1]?n[1]:{},0!==this.routers.length){e.next=3;break}throw new wo("No content routers available",ww.ERR_NO_ROUTERS_AVAILABLE);case 3:return e.next=5,Promise.all(this.routers.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(n){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.provide(t,r);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"put",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isStarted()){e.next=2;break}throw new wo(_w.NOT_STARTED_YET,ww.DHT_NOT_STARTED);case 2:return e.next=4,Promise.all(this.routers.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(i){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.put(t,r,n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isStarted()){e.next=2;break}throw new wo(_w.NOT_STARTED_YET,ww.DHT_NOT_STARTED);case 2:return e.abrupt("return",Promise.any(this.routers.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(n){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.get(t,r));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}();var pk=function(e){if(null!=e[Symbol.asyncIterator])return(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i,a,s,o;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=!1,n=!1,t.prev=2,a=ui(e);case 4:return t.next=6,a.next();case 6:if(!(r=!(s=t.sent).done)){t.next=12;break}return o=s.value,t.abrupt("return",o);case 9:r=!1,t.next=4;break;case 12:t.next=18;break;case 14:t.prev=14,t.t0=t.catch(2),n=!0,i=t.t0;case 18:if(t.prev=18,t.prev=19,!r||null==a.return){t.next=23;break}return t.next=23,a.return();case 23:if(t.prev=23,!n){t.next=26;break}throw i;case 26:return t.finish(23);case 27:return t.finish(18);case 28:return t.abrupt("return",void 0);case 29:case"end":return t.stop()}}),t,null,[[2,14,18,28],[19,,23,27]])})))();var t,r=(0,ge.Z)(e);try{for(r.s();!(t=r.n()).done;){return t.value}}catch(S$){r.e(S$)}finally{r.f()}},vk=zi("libp2p:peer-routing"),gk=function(){function e(t,r){var n;(0,hi.Z)(this,e),(0,we.Z)(this,"components",void 0),(0,we.Z)(this,"routers",void 0),this.components=t,this.routers=null!==(n=r.routers)&&void 0!==n?n:[]}return(0,fi.Z)(e,[{key:"findPeer",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.routers.length){e.next=2;break}throw new wo("No peer routers available",ww.ERR_NO_ROUTERS_AVAILABLE);case 2:if(t.toString()!==this.components.peerId.toString()){e.next=4;break}throw new wo("Should not try to find self",ww.ERR_FIND_SELF);case 4:return e.next=6,no(os.apply(void 0,be(this.routers.map((function(e){return ea((0,ii.Z)().mark((function n(){return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Ji(e.findPeer(t,r));case 3:return n.next=5,n.sent;case 5:n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),vk.error(n.t0);case 10:case"end":return n.stop()}}),n,null,[[0,7]])})))()})))),(function(e){return Qa(e,Boolean)}),(function(e){return uk(e,i.components.peerStore)}),function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",pk(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:if(null==(n=e.sent)){e.next=9;break}return e.abrupt("return",n);case 9:throw new wo(_w.NOT_FOUND,ww.ERR_NOT_FOUND);case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getClosestPeers",value:function(e,t){var r=this;return ea((0,ii.Z)().mark((function n(){return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(0!==r.routers.length){n.next=2;break}throw new wo("No peer routers available",ww.ERR_NO_ROUTERS_AVAILABLE);case 2:return n.delegateYield(Xa(ui(no(os.apply(void 0,be(r.routers.map((function(r){return r.getClosestPeers(e,t)})))),(function(e){return uk(e,r.components.peerStore)}),(function(e){return lk(e)}),(function(e){return hk(e)})))),"t0",3);case 3:case"end":return n.stop()}}),n)})))()}}]),e}(),yk=zi("libp2p:registrar"),mk=function(){function e(t){(0,hi.Z)(this,e),(0,we.Z)(this,"topologies",void 0),(0,we.Z)(this,"handlers",void 0),(0,we.Z)(this,"components",void 0),this.topologies=new Map,this.handlers=new Map,this.components=t,this._onDisconnect=this._onDisconnect.bind(this),this._onPeerUpdate=this._onPeerUpdate.bind(this),this._onConnect=this._onConnect.bind(this),this.components.events.addEventListener("peer:disconnect",this._onDisconnect),this.components.events.addEventListener("peer:connect",this._onConnect),this.components.events.addEventListener("peer:update",this._onPeerUpdate)}return(0,fi.Z)(e,[{key:"getProtocols",value:function(){return Array.from(new Set(be(this.handlers.keys()))).sort()}},{key:"getHandler",value:function(e){var t=this.handlers.get(e);if(null==t)throw new wo("No handler registered for protocol ".concat(e),ww.ERR_NO_HANDLER_FOR_PROTOCOL);return t}},{key:"getTopologies",value:function(e){var t=this.topologies.get(e);return null==t?[]:be(t.values())}},{key:"handle",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.handlers.has(t)){e.next=2;break}throw new wo("Handler already registered for protocol ".concat(t),ww.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED);case 2:return i=am.bind({ignoreUndefined:!0})({maxInboundStreams:32,maxOutboundStreams:64},n),this.handlers.set(t,{handler:r,options:i}),e.next=6,this.components.peerStore.merge(this.components.peerId,{protocols:[t]});case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"unhandle",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(Array.isArray(t)?t:[t]).forEach((function(e){r.handlers.delete(e)})),e.next=4,this.components.peerStore.patch(this.components.peerId,{protocols:this.getProtocols()});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"register",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=r){e.next=2;break}throw new wo("invalid topology",ww.ERR_INVALID_PARAMETERS);case 2:return n="".concat((1e9*Math.random()).toString(36)).concat(Date.now()),null==(i=this.topologies.get(t))&&(i=new Map,this.topologies.set(t,i)),i.set(n,r),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"unregister",value:function(e){var t,r=(0,ge.Z)(this.topologies.entries());try{for(r.s();!(t=r.n()).done;){var n=(0,ke.Z)(t.value,2),i=n[0],a=n[1];a.has(e)&&(a.delete(e),0===a.size&&this.topologies.delete(i))}}catch(S$){r.e(S$)}finally{r.f()}}},{key:"_onDisconnect",value:function(e){var t=this,r=e.detail;this.components.peerStore.get(r).then((function(e){var n,i=(0,ge.Z)(e.protocols);try{for(i.s();!(n=i.n()).done;){var a=n.value,s=t.topologies.get(a);if(null!=s){var o,u=(0,ge.Z)(s.values());try{for(u.s();!(o=u.n()).done;){var c,l=o.value;null===(c=l.onDisconnect)||void 0===c||c.call(l,r)}}catch(S$){u.e(S$)}finally{u.f()}}}}catch(S$){i.e(S$)}finally{i.f()}})).catch((function(e){e.code!==ww.ERR_NOT_FOUND&&yk.error("could not inform topologies of disconnecting peer %p",r,e)}))}},{key:"_onConnect",value:function(e){var t=this,r=e.detail;this.components.peerStore.get(r).then((function(e){var n=t.components.connectionManager.getConnections(e.id)[0];if(null!=n){var i,a=(0,ge.Z)(e.protocols);try{for(a.s();!(i=a.n()).done;){var s=i.value,o=t.topologies.get(s);if(null!=o){var u,c=(0,ge.Z)(o.values());try{for(c.s();!(u=c.n()).done;){var l,h=u.value;null===(l=h.onConnect)||void 0===l||l.call(h,r,n)}}catch(S$){c.e(S$)}finally{c.f()}}}}catch(S$){a.e(S$)}finally{a.f()}}else yk("peer %p connected but the connection manager did not have a connection",e)})).catch((function(e){e.code!==ww.ERR_NOT_FOUND&&yk.error("could not inform topologies of connecting peer %p",r,e)}))}},{key:"_onPeerUpdate",value:function(e){var t,r,n=e.detail,i=n.peer,a=n.previous,s=(null!==(t=null===a||void 0===a?void 0:a.protocols)&&void 0!==t?t:[]).filter((function(e){return!i.protocols.includes(e)})),o=i.protocols.filter((function(e){var t;return!(null!==(t=null===a||void 0===a?void 0:a.protocols)&&void 0!==t?t:[]).includes(e)})),u=(0,ge.Z)(s);try{for(u.s();!(r=u.n()).done;){var c=r.value,l=this.topologies.get(c);if(null!=l){var h,f=(0,ge.Z)(l.values());try{for(f.s();!(h=f.n()).done;){var d,p=h.value;null===(d=p.onDisconnect)||void 0===d||d.call(p,i.id)}}catch(S$){f.e(S$)}finally{f.f()}}}}catch(S$){u.e(S$)}finally{u.f()}var v,g=(0,ge.Z)(o);try{for(g.s();!(v=g.n()).done;){var y=v.value,m=this.topologies.get(y);if(null!=m){var b,_=(0,ge.Z)(m.values());try{for(_.s();!(b=_.n()).done;){var w,k=b.value,x=this.components.connectionManager.getConnections(i.id)[0];null!=x&&(null===(w=k.onConnect)||void 0===w||w.call(k,i.id,x))}}catch(S$){_.e(S$)}finally{_.f()}}}}catch(S$){g.e(S$)}finally{g.f()}}}]),e}(),bk=zi("libp2p:transports"),_k=function(){function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,hi.Z)(this,e),(0,we.Z)(this,"components",void 0),(0,we.Z)(this,"transports",void 0),(0,we.Z)(this,"listeners",void 0),(0,we.Z)(this,"faultTolerance",void 0),(0,we.Z)(this,"started",void 0),this.components=t,this.started=!1,this.transports=new Map,this.listeners=bo({name:"libp2p_transport_manager_listeners",metrics:this.components.metrics}),this.faultTolerance=null!==(r=n.faultTolerance)&&void 0!==r?r:A_.FATAL_ALL}return(0,fi.Z)(e,[{key:"add",value:function(e){var t=e[Symbol.toStringTag];if(null==t)throw new wo("Transport must have a valid tag",ww.ERR_INVALID_KEY);if(this.transports.has(t))throw new wo("There is already a transport with the tag ".concat(t),ww.ERR_DUPLICATE_TRANSPORT);bk("adding transport %s",t),this.transports.set(t,e),this.listeners.has(t)||this.listeners.set(t,[])}},{key:"isStarted",value:function(){return this.started}},{key:"start",value:function(){this.started=!0}},{key:"afterStart",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.components.addressManager.getListenAddrs(),e.next=3,this.listen(t);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i,a,s,o,u,c,l;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],r=(0,ge.Z)(this.listeners),e.prev=2,r.s();case 4:if((n=r.n()).done){e.next=16;break}i=(0,ke.Z)(n.value,2),a=i[0],s=i[1],bk("closing listeners for %s",a);case 7:if(!(s.length>0)){e.next=14;break}if(null!=(o=s.pop())){e.next=11;break}return e.abrupt("continue",7);case 11:t.push(o.close()),e.next=7;break;case 14:e.next=4;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(2),r.e(e.t0);case 21:return e.prev=21,r.f(),e.finish(21);case 24:return e.next=26,Promise.all(t);case 26:bk("all listeners closed"),u=(0,ge.Z)(this.listeners.keys());try{for(u.s();!(c=u.n()).done;)l=c.value,this.listeners.set(l,[])}catch(S$){u.e(S$)}finally{u.f()}this.started=!1;case 30:case"end":return e.stop()}}),e,this,[[2,18,21,24]])})));return function(){return e.apply(this,arguments)}}()},{key:"dial",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(n=this.transportForMultiaddr(t))){e.next=3;break}throw new wo("No transport available for address ".concat(String(t)),ww.ERR_TRANSPORT_UNAVAILABLE);case 3:return e.prev=3,e.next=6,n.dial(t,(0,_e.Z)((0,_e.Z)({},r),{},{upgrader:this.components.upgrader}));case 6:return e.abrupt("return",e.sent);case 9:throw e.prev=9,e.t0=e.catch(3),null==e.t0.code&&(e.t0.code=ww.ERR_TRANSPORT_DIAL_FAILED),e.t0;case 13:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getAddrs",value:function(){var e,t=[],r=(0,ge.Z)(this.listeners.values());try{for(r.s();!(e=r.n()).done;){var n,i=e.value,a=(0,ge.Z)(i);try{for(a.s();!(n=a.n()).done;){var s=n.value;t=[].concat(be(t),be(s.getAddrs()))}}catch(S$){a.e(S$)}finally{a.f()}}}catch(S$){r.e(S$)}finally{r.f()}return t}},{key:"getTransports",value:function(){return Array.of.apply(Array,be(this.transports.values()))}},{key:"getListeners",value:function(){return Array.of.apply(Array,be(this.listeners.values())).flat()}},{key:"transportForMultiaddr",value:function(e){var t,r=(0,ge.Z)(this.transports.values());try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.filter([e]).length>0)return n}}catch(S$){r.e(S$)}finally{r.f()}}},{key:"listen",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c,l,h,f,d,p,v=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isStarted()){e.next=2;break}throw new wo("Not started",ww.ERR_NODE_NOT_STARTED);case 2:if(null!=t&&0!==t.length){e.next=5;break}return bk("no addresses were provided for listening, this node is dial only"),e.abrupt("return");case 5:r=[],n=(0,ge.Z)(this.transports.entries()),e.prev=7,n.s();case 9:if((i=n.n()).done){e.next=40;break}a=(0,ke.Z)(i.value,2),s=a[0],o=a[1],u=o.filter(t),c=[],l=(0,ge.Z)(u),e.prev=14,f=(0,ii.Z)().mark((function e(){var t,r,n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=h.value,bk("creating listener for %s on %a",s,r),n=o.createListener({upgrader:v.components.upgrader}),null==(i=null!==(t=v.listeners.get(s))&&void 0!==t?t:[])&&(i=[],v.listeners.set(s,i)),i.push(n),n.addEventListener("listening",(function(){v.components.events.safeDispatchEvent("transport:listening",{detail:n})})),n.addEventListener("close",(function(){var e=i.findIndex((function(e){return e===n}));i.splice(e,1),v.components.events.safeDispatchEvent("transport:close",{detail:n})})),c.push(n.listen(r));case 9:case"end":return e.stop()}}),e)})),l.s();case 17:if((h=l.n()).done){e.next=21;break}return e.delegateYield(f(),"t0",19);case 19:e.next=17;break;case 21:e.next=26;break;case 23:e.prev=23,e.t1=e.catch(14),l.e(e.t1);case 26:return e.prev=26,l.f(),e.finish(26);case 29:if(0!==c.length){e.next=32;break}return r.push(s),e.abrupt("continue",38);case 32:return e.next=34,Promise.allSettled(c);case 34:if(d=e.sent,null!=d.find((function(e){return"fulfilled"===e.status}))||this.faultTolerance===A_.NO_FATAL){e.next=38;break}throw new wo("Transport (".concat(s,") could not listen on any available address"),ww.ERR_NO_VALID_ADDRESSES);case 38:e.next=9;break;case 40:e.next=45;break;case 42:e.prev=42,e.t2=e.catch(7),n.e(e.t2);case 45:return e.prev=45,n.f(),e.finish(45);case 48:if(r.length!==this.transports.size){e.next=53;break}if(p="no valid addresses were provided for transports [".concat(r.join(", "),"]"),this.faultTolerance!==A_.FATAL_ALL){e.next=52;break}throw new wo(p,ww.ERR_NO_VALID_ADDRESSES);case 52:bk("libp2p in dial mode only: ".concat(p));case 53:case"end":return e.stop()}}),e,this,[[7,42,45,48],[14,23,26,29]])})));return function(t){return e.apply(this,arguments)}}()},{key:"remove",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=null!==(r=this.listeners.get(t))&&void 0!==r?r:[],bk.trace("removing transport %s",t),i=[],bk.trace("closing listeners for %s",t);case 4:if(!(n.length>0)){e.next=11;break}if(null!=(a=n.pop())){e.next=8;break}return e.abrupt("continue",4);case 8:i.push(a.close()),e.next=4;break;case 11:return e.next=13,Promise.all(i);case 13:this.transports.delete(t),this.listeners.delete(t);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"removeAll",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],r=(0,ge.Z)(this.transports.keys());try{for(r.s();!(n=r.n()).done;)i=n.value,t.push(this.remove(i))}catch(S$){r.e(S$)}finally{r.f()}return e.next=5,Promise.all(t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),wk="/multistream/1.0.0",kk=1024;function xk(e){var t,r=as(),n=function(e){var t=ea((0,ii.Z)().mark((function t(){var r,n,i,a,s,o,u,c,l;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void(t.next=2);case 2:r=t.sent,n=new Du,i=!1,a=!1,t.prev=6,o=ui(e);case 8:return t.next=10,Ji(o.next());case 10:if(!(i=!(u=t.sent).done)){t.next=38;break}if(c=u.value,null!=r){t.next=19;break}return n.append(c),t.next=16,n;case 16:return r=t.sent,n=new Du,t.abrupt("continue",35);case 19:n.append(c);case 20:if(!(n.length>=r)){t.next=35;break}return l=n.sublist(0,r),n.consume(r),t.next=25,l;case 25:if(null!=(r=t.sent)){t.next=33;break}if(!(n.length>0)){t.next=32;break}return t.next=30,n;case 30:r=t.sent,n=new Du;case 32:return t.abrupt("break",35);case 33:t.next=20;break;case 35:i=!1,t.next=8;break;case 38:t.next=44;break;case 40:t.prev=40,t.t0=t.catch(6),a=!0,s=t.t0;case 44:if(t.prev=44,t.prev=45,!i||null==o.return){t.next=49;break}return t.next=49,Ji(o.return());case 49:if(t.prev=49,!a){t.next=52;break}throw s;case 52:return t.finish(49);case 53:return t.finish(44);case 54:if(null==r){t.next=56;break}throw Object.assign(new Error("stream ended before ".concat(r," bytes became available")),{code:"ERR_UNDER_READ",buffer:n});case 56:case"end":return t.stop()}}),t,null,[[6,40,44,54],[45,,49,53]])})))();return t.next(),t}(e.source),i=ts(),a=e.sink(ea((0,ii.Z)().mark((function e(){var t;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(Xa(ui(r)),"t0",1);case 1:return e.next=3,Ji(i.promise);case 3:return t=e.sent,e.delegateYield(Xa(ui(t)),"t1",5);case 5:case"end":return e.stop()}}),e)})))());a.catch((function(e){t=e}));var s={sink:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(r){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==t){e.next=4;break}return e.next=3,Promise.reject(t);case 3:return e.abrupt("return");case 4:return i.resolve(r),e.next=7,a;case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),source:n};return{reader:n,writer:r,stream:s,rest:function(){return r.end()},write:r.push,read:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.next();case 2:if(null==(t=e.sent).value){e.next=5;break}return e.abrupt("return",t.value);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}var Ek=function(e){ia(r,e);var t=ua(r);function r(e,n){var i;return(0,hi.Z)(this,r),(i=t.call(this,null!==e&&void 0!==e?e:"The operation was aborted")).type="aborted",i.code=null!==n&&void 0!==n?n:"ABORT_ERR",i}return(0,fi.Z)(r)}(es(Error));function Sk(e,t,r){var n=null!==r&&void 0!==r?r:{},i=function(e){if(null!=e){if("function"===typeof e[Symbol.iterator])return e[Symbol.iterator]();if("function"===typeof e[Symbol.asyncIterator])return e[Symbol.asyncIterator]();if("function"===typeof e.next)return e}throw new Error("argument is not an iterator or iterable")}(e);function a(){return(a=ea((0,ii.Z)().mark((function r(){var a,s,o,u,c,l,h,f;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:s=function(){null!=a&&a()},t.addEventListener("abort",s);case 2:if(o=void 0,r.prev=4,!t.aborted){r.next=8;break}throw u=n.abortMessage,c=n.abortCode,new Ek(u,c);case 8:return l=new Promise((function(e,t){a=function(){var e=n.abortMessage,r=n.abortCode;t(new Ek(e,r))}})),r.next=11,Ji(Promise.race([l,i.next()]));case 11:o=r.sent,a=null,r.next=24;break;case 15:if(r.prev=15,r.t0=r.catch(4),t.removeEventListener("abort",s),(h="aborted"===r.t0.type&&t.aborted)&&null!=n.onAbort&&n.onAbort(e),"function"===typeof i.return)try{(f=i.return())instanceof Promise&&f.catch((function(e){null!=n.onReturnError&&n.onReturnError(e)}))}catch(S$){null!=n.onReturnError&&n.onReturnError(S$)}if(!h||!0!==n.returnOnAbort){r.next=23;break}return r.abrupt("return");case 23:throw r.t0;case 24:if(!0!==o.done){r.next=26;break}return r.abrupt("break",30);case 26:return r.next=28,o.value;case 28:r.next=2;break;case 30:t.removeEventListener("abort",s);case 31:case"end":return r.stop()}}),r,null,[[4,15]])})))).apply(this,arguments)}return function(){return a.apply(this,arguments)}()}function Ck(e,t,r){return function(n){return e(Sk(n,t,r))}}function Ak(e,t,r){return{sink:Ck(e.sink,t,(0,_e.Z)((0,_e.Z)({},r),{},{onAbort:void 0})),source:Sk(e.source,t,r)}}var Dk=zi("libp2p:mss"),Rk=Hs("\n");function Tk(e){var t=new Du(e,Rk);return Zu.single(t)}function Zk(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=Tk(t);!0===r.writeBytes?e.push(n.subarray()):e.push(n)}function Ik(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=new Du,a=(0,ge.Z)(t);try{for(a.s();!(r=a.n()).done;){var s=r.value;i.append(Tk(s))}}catch(S$){a.e(S$)}finally{a.f()}!0===n.writeBytes?e.push(i.subarray()):e.push(i)}function Pk(e,t){return Lk.apply(this,arguments)}function Lk(){return Lk=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=1,n={},(0,we.Z)(n,Symbol.asyncIterator,(function(){return a})),(0,we.Z)(n,"next",function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.next(i));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),s=a=n,null!=(null===r||void 0===r?void 0:r.signal)&&(s=Sk(a,r.signal)),o=function(e){i=e},e.next=7,no(s,(function(e){return Bu(e,{onLength:o,maxDataLength:kk})}),function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",pk(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:if(null!=(u=e.sent)&&0!==u.length){e.next=10;break}throw new wo("no buffer returned","ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");case 10:if(u.get(u.byteLength-1)===Rk[0]){e.next=13;break}throw Dk.error("Invalid mss message - missing newline - %s",u.subarray()),new wo("missing newline","ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");case 13:return e.abrupt("return",u.sublist(0,-1));case 14:case"end":return e.stop()}}),e)}))),Lk.apply(this,arguments)}function Mk(e,t){return Bk.apply(this,arguments)}function Bk(){return Bk=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pk(t,r);case 2:return n=e.sent,e.abrupt("return",Ws(n.subarray()));case 4:case"end":return e.stop()}}),e)}))),Bk.apply(this,arguments)}var Ok=zi("libp2p:mss:select");function Nk(e,t){return Fk.apply(this,arguments)}function Fk(){return Fk=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c,l,h,f,d,p,v,g,y=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=y.length>2&&void 0!==y[2]?y[2]:{},r=Array.isArray(r)?be(r):[r],i=xk(t),a=i.reader,s=i.writer,o=i.rest,u=i.stream,null!=(c=r.shift())){e.next=6;break}throw new Error("At least one protocol must be specified");case 6:return Ok.trace('select: write ["%s", "%s"]',wk,c),l=Hs(wk),h=Hs(c),Ik(s,[l,h],n),e.next=12,Mk(a,n);case 12:if(f=e.sent,Ok.trace('select: read "%s"',f),f!==wk){e.next=19;break}return e.next=17,Mk(a,n);case 17:f=e.sent,Ok.trace('select: read "%s"',f);case 19:if(f!==c){e.next=22;break}return o(),e.abrupt("return",{stream:u,protocol:c});case 22:d=(0,ge.Z)(r),e.prev=23,d.s();case 25:if((p=d.n()).done){e.next=38;break}return v=p.value,Ok.trace('select: write "%s"',v),Zk(s,Hs(v),n),e.next=31,Mk(a,n);case 31:if(g=e.sent,Ok.trace('select: read "%s" for "%s"',g,v),g!==v){e.next=36;break}return o(),e.abrupt("return",{stream:u,protocol:v});case 36:e.next=25;break;case 38:e.next=43;break;case 40:e.prev=40,e.t0=e.catch(23),d.e(e.t0);case 43:return e.prev=43,d.f(),e.finish(43);case 46:throw o(),new wo("protocol selection failed","ERR_UNSUPPORTED_PROTOCOL");case 48:case"end":return e.stop()}}),e,null,[[23,40,43,46]])}))),Fk.apply(this,arguments)}var Uk=zi("libp2p:mss:handle");function zk(e,t,r){return jk.apply(this,arguments)}function jk(){return jk=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a,s,o,u,c;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=Array.isArray(r)?r:[r],i=xk(t),a=i.writer,s=i.reader,o=i.rest,u=i.stream;case 2:return e.next=5,Mk(s,n);case 5:if(c=e.sent,Uk.trace('read "%s"',c),c!==wk){e.next=11;break}return Uk.trace('respond with "%s" for "%s"',wk,c),Zk(a,Hs(wk),n),e.abrupt("continue",2);case 11:if(!r.includes(c)){e.next=16;break}return Zk(a,Hs(c),n),Uk.trace('respond with "%s" for "%s"',c,c),o(),e.abrupt("return",{stream:u,protocol:c});case 16:if("ls"!==c){e.next=20;break}return Zk(a,$a(Du,be(r.map((function(e){return Tk(Hs(e))})))),n),Uk.trace('respond with "%s" for %s',r,c),e.abrupt("continue",2);case 20:Zk(a,Hs("na"),n),Uk('respond with "na" for "%s"',c),e.next=2;break;case 24:case"end":return e.stop()}}),e)}))),jk.apply(this,arguments)}var Hk,Wk=Symbol.for("@libp2p/connection");var qk=zi("libp2p:connection");Hk=Symbol.toStringTag;var Vk=function(){function e(t){var r;(0,hi.Z)(this,e),(0,we.Z)(this,"id",void 0),(0,we.Z)(this,"remoteAddr",void 0),(0,we.Z)(this,"remotePeer",void 0),(0,we.Z)(this,"direction",void 0),(0,we.Z)(this,"timeline",void 0),(0,we.Z)(this,"multiplexer",void 0),(0,we.Z)(this,"encryption",void 0),(0,we.Z)(this,"status",void 0),(0,we.Z)(this,"transient",void 0),(0,we.Z)(this,"tags",void 0),(0,we.Z)(this,"_newStream",void 0),(0,we.Z)(this,"_close",void 0),(0,we.Z)(this,"_abort",void 0),(0,we.Z)(this,"_getStreams",void 0),(0,we.Z)(this,Hk,"Connection"),(0,we.Z)(this,Wk,!0);var n=t.remoteAddr,i=t.remotePeer,a=t.newStream,s=t.close,o=t.abort,u=t.getStreams;this.id="".concat(parseInt(String(1e9*Math.random())).toString(36)).concat(Date.now()),this.remoteAddr=n,this.remotePeer=i,this.direction=t.direction,this.status="open",this.timeline=t.timeline,this.multiplexer=t.multiplexer,this.encryption=t.encryption,this.transient=null!==(r=t.transient)&&void 0!==r&&r,this._newStream=a,this._close=s,this._abort=o,this._getStreams=u,this.tags=[]}return(0,fi.Z)(e,[{key:"streams",get:function(){return this._getStreams()}},{key:"newStream",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("closing"!==this.status){e.next=2;break}throw new wo("the connection is being closed","ERR_CONNECTION_BEING_CLOSED");case 2:if("closed"!==this.status){e.next=4;break}throw new wo("the connection is closed","ERR_CONNECTION_CLOSED");case 4:if(Array.isArray(t)||(t=[t]),!this.transient||!0===(null===r||void 0===r?void 0:r.runOnTransientConnection)){e.next=7;break}throw new wo("Cannot open protocol stream on transient connection","ERR_TRANSIENT_CONNECTION");case 7:return e.next=9,this._newStream(t,r);case 9:return(n=e.sent).direction="outbound",e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"close",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.length>0&&void 0!==n[0]?n[0]:{},"closed"!==this.status&&"closing"!==this.status){e.next=3;break}return e.abrupt("return");case 3:qk("closing connection to %a",this.remoteAddr),this.status="closing",r.signal=null!==(t=null===r||void 0===r?void 0:r.signal)&&void 0!==t?t:AbortSignal.timeout(500);try{null===Wu.setMaxListeners||void 0===Wu.setMaxListeners||(0,Wu.setMaxListeners)(1/0,r.signal)}catch(i){}return e.prev=7,qk.trace("closing all streams"),e.next=11,Promise.all(this.streams.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.close(r));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 11:return qk.trace("closing underlying transport"),e.next=14,this._close(r);case 14:qk.trace("updating timeline with close time"),this.status="closed",this.timeline.close=Date.now(),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(7),qk.error("error encountered during graceful close of connection to %a",this.remoteAddr,e.t0),this.abort(e.t0);case 23:case"end":return e.stop()}}),e,this,[[7,19]])})));return function(){return e.apply(this,arguments)}}()},{key:"abort",value:function(e){qk.error("aborting connection to %a due to error",this.remoteAddr,e),this.status="closing",this.streams.forEach((function(t){t.abort(e)})),qk.error("all streams aborted",this.streams.length),this._abort(e),this.timeline.close=Date.now(),this.status="closed"}}]),e}();var Kk=zi("libp2p:upgrader");function Yk(e,t){try{return t.getHandler(e).options.maxInboundStreams}catch(S$){if(S$.code!==ww.ERR_NO_HANDLER_FOR_PROTOCOL)throw S$}return 32}function Gk(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{var i=t.getHandler(e).options;if(null!=i.maxOutboundStreams)return i.maxOutboundStreams}catch(S$){if(S$.code!==ww.ERR_NO_HANDLER_FOR_PROTOCOL)throw S$}return null!==(r=n.maxOutboundStreams)&&void 0!==r?r:64}function Qk(e,t,r){var n=0;return r.streams.forEach((function(r){r.direction===t&&r.protocol===e&&n++})),n}var Xk=function(){function e(t,r){var n,i=this;(0,hi.Z)(this,e),(0,we.Z)(this,"components",void 0),(0,we.Z)(this,"connectionEncryption",void 0),(0,we.Z)(this,"muxers",void 0),(0,we.Z)(this,"inboundUpgradeTimeout",void 0),(0,we.Z)(this,"events",void 0),this.components=t,this.connectionEncryption=new Map,r.connectionEncryption.forEach((function(e){i.connectionEncryption.set(e.protocol,e)})),this.muxers=new Map,r.muxers.forEach((function(e){i.muxers.set(e.protocol,e)})),this.inboundUpgradeTimeout=null!==(n=r.inboundUpgradeTimeout)&&void 0!==n?n:3e4,this.events=t.events}return(0,fi.Z)(e,[{key:"shouldBlockConnection",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(i=this.components.connectionGater[n])){e.next=6;break}return e.next=4,i(t,r);case 4:if(!e.sent){e.next=6;break}throw new wo("The multiaddr connection is blocked by gater.".concat(n),ww.ERR_CONNECTION_INTERCEPTED);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"upgradeInbound",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c,l,h,f,d,p,v,g,y,m,b;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.components.connectionManager.acceptIncomingConnection(t);case 2:if(e.sent){e.next=5;break}throw new wo("connection denied",ww.ERR_CONNECTION_DENIED);case 5:u=AbortSignal.timeout(this.inboundUpgradeTimeout),c=function(){t.abort(new wo("inbound upgrade timeout",ww.ERR_TIMEOUT))},u.addEventListener("abort",c,{once:!0});try{null===Wu.setMaxListeners||void 0===Wu.setMaxListeners||(0,Wu.setMaxListeners)(1/0,u)}catch(_){}return e.prev=9,e.next=12,null===(l=(h=this.components.connectionGater).denyInboundConnection)||void 0===l?void 0:l.call(h,t);case 12:if(e.t0=e.sent,!0!==e.t0){e.next=15;break}throw new wo("The multiaddr connection is blocked by gater.acceptConnection",ww.ERR_CONNECTION_INTERCEPTED);case 15:if(null===(f=this.components.metrics)||void 0===f||f.trackMultiaddrConnection(t),Kk("starting the inbound connection upgrade"),d=t,!0===(null===r||void 0===r?void 0:r.skipProtection)){e.next=25;break}if(null==(p=this.components.connectionProtector)){e.next=25;break}return Kk("protecting the inbound connection"),e.next=24,p.protect(t);case 24:d=e.sent;case 25:if(e.prev=25,n=d,!0===(null===r||void 0===r?void 0:r.skipEncryption)){e.next=39;break}return e.next=30,this._encryptInbound(d);case 30:return v=e.sent,n=v.conn,i=v.remotePeer,o=v.protocol,g=(0,_e.Z)((0,_e.Z)({},d),n),e.next=37,this.shouldBlockConnection(i,g,"denyInboundEncryptedConnection");case 37:e.next=45;break;case 39:if(null!=(y=t.remoteAddr.getPeerId())){e.next=42;break}throw new wo("inbound connection that skipped encryption must have a peer id",ww.ERR_INVALID_MULTIADDR);case 42:m=em(y),o="native",i=m;case 45:if(a=n,null==(null===r||void 0===r?void 0:r.muxerFactory)){e.next=50;break}s=r.muxerFactory,e.next=56;break;case 50:if(!(this.muxers.size>0)){e.next=56;break}return e.next=53,this._multiplexInbound((0,_e.Z)((0,_e.Z)({},d),n),this.muxers);case 53:b=e.sent,s=b.muxerFactory,a=b.stream;case 56:e.next=62;break;case 58:throw e.prev=58,e.t1=e.catch(25),Kk.error("Failed to upgrade inbound connection",e.t1),e.t1;case 62:return e.next=64,this.shouldBlockConnection(i,t,"denyInboundUpgradedConnection");case 64:return Kk("Successfully upgraded inbound connection"),e.abrupt("return",this._createConnection({cryptoProtocol:o,direction:"inbound",maConn:t,upgradedConn:a,muxerFactory:s,remotePeer:i,transient:null===r||void 0===r?void 0:r.transient}));case 66:return e.prev=66,u.removeEventListener("abort",c),this.components.connectionManager.afterUpgradeInbound(),e.finish(66);case 70:case"end":return e.stop()}}),e,this,[[9,,66,70],[25,58]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"upgradeOutbound",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c,l,h,f,d,p,v;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(i=t.remoteAddr.getPeerId())){e.next=5;break}return a=em(i),e.next=5,this.shouldBlockConnection(a,t,"denyOutboundConnection");case 5:if(null===(n=this.components.metrics)||void 0===n||n.trackMultiaddrConnection(t),Kk("Starting the outbound connection upgrade"),h=t,!0===(null===r||void 0===r?void 0:r.skipProtection)){e.next=14;break}if(null==(f=this.components.connectionProtector)){e.next=14;break}return e.next=13,f.protect(t);case 13:h=e.sent;case 14:if(e.prev=14,s=h,!0===(null===r||void 0===r?void 0:r.skipEncryption)){e.next=28;break}return e.next=19,this._encryptOutbound(h,a);case 19:return d=e.sent,s=d.conn,o=d.remotePeer,c=d.protocol,p=(0,_e.Z)((0,_e.Z)({},h),s),e.next=26,this.shouldBlockConnection(o,p,"denyOutboundEncryptedConnection");case 26:e.next=32;break;case 28:if(null!=a){e.next=30;break}throw new wo("Encryption was skipped but no peer id was passed",ww.ERR_INVALID_PEER);case 30:c="native",o=a;case 32:if(u=s,null==(null===r||void 0===r?void 0:r.muxerFactory)){e.next=37;break}l=r.muxerFactory,e.next=43;break;case 37:if(!(this.muxers.size>0)){e.next=43;break}return e.next=40,this._multiplexOutbound((0,_e.Z)((0,_e.Z)({},h),s),this.muxers);case 40:v=e.sent,l=v.muxerFactory,u=v.stream;case 43:e.next=51;break;case 45:return e.prev=45,e.t0=e.catch(14),Kk.error("Failed to upgrade outbound connection",e.t0),e.next=50,t.close(e.t0);case 50:throw e.t0;case 51:return e.next=53,this.shouldBlockConnection(o,t,"denyOutboundUpgradedConnection");case 53:return Kk("Successfully upgraded outbound connection"),e.abrupt("return",this._createConnection({cryptoProtocol:c,direction:"outbound",maConn:t,upgradedConn:u,muxerFactory:l,remotePeer:o,transient:null===r||void 0===r?void 0:r.transient}));case 55:case"end":return e.stop()}}),e,this,[[14,45]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_createConnection",value:function(e){var t,r,n,i,a,s=this,o=e.cryptoProtocol,u=e.direction,c=e.maConn,l=e.upgradedConn,h=e.remotePeer,f=e.muxerFactory,d=e.transient;null!=f&&(n=f.createStreamMuxer({direction:u,onIncomingStream:function(e){null!=a&&Promise.resolve().then((0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i,o,c,l,f;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=s.components.registrar.getProtocols(),t.next=3,zk(e,n);case 3:if(i=t.sent,o=i.stream,c=i.protocol,Kk("%s: incoming stream opened on %s",u,c),null!=a){t.next=9;break}return t.abrupt("return");case 9:if(l=Yk(c,s.components.registrar),Qk(c,"inbound",a)!==l){t.next=15;break}throw f=new wo('Too many inbound protocol streams for protocol "'.concat(c,'" - limit ').concat(l),ww.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS),e.abort(f),f;case 15:return e.source=o.source,e.sink=o.sink,e.protocol=c,t.next=20,s.components.peerStore.merge(h,{protocols:[c]});case 20:null===(r=s.components.metrics)||void 0===r||r.trackProtocolStream(e,a),s._onStream({connection:a,stream:e,protocol:c});case 22:case"end":return t.stop()}}),t)})))).catch(function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(r){return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Kk.error(r),null!=e.timeline.close){t.next=4;break}return t.next=4,e.close();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}),i=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,i,o,c,l,f,d,p,v=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=v.length>1&&void 0!==v[1]?v[1]:{},null!=n){e.next=3;break}throw new wo("Stream is not multiplexed",ww.ERR_MUXER_UNAVAILABLE);case 3:return Kk("%s: starting new stream on %s",u,t),e.next=6,n.newStream();case 6:if(i=e.sent,e.prev=7,null==r.signal){Kk("No abort signal was passed while trying to negotiate protocols %s falling back to default timeout",t),r.signal=AbortSignal.timeout(3e4);try{null===Wu.setMaxListeners||void 0===Wu.setMaxListeners||(0,Wu.setMaxListeners)(1/0,r.signal)}catch(g){}}return e.next=11,Nk(i,t,r);case 11:if(c=e.sent,l=c.stream,f=c.protocol,d=Gk(f,s.components.registrar,r),!(Qk(f,"outbound",a)>=d)){e.next=20;break}throw p=new wo('Too many outbound protocol streams for protocol "'.concat(f,'" - limit ').concat(d),ww.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS),i.abort(p),p;case 20:return e.next=22,s.components.peerStore.merge(h,{protocols:[f]});case 22:return i.source=l.source,i.sink=l.sink,i.protocol=f,null===(o=s.components.metrics)||void 0===o||o.trackProtocolStream(i,a),e.abrupt("return",i);case 29:if(e.prev=29,e.t0=e.catch(7),Kk.error("could not create new stream for protocols %s on connection with address %a",t,a.remoteAddr,e.t0),null==i.timeline.close&&i.abort(e.t0),null==e.t0.code){e.next=35;break}throw e.t0;case 35:throw new wo(String(e.t0),ww.ERR_UNSUPPORTED_PROTOCOL);case 36:case"end":return e.stop()}}),e,null,[[7,29]])})));return function(t){return e.apply(this,arguments)}}(),Promise.all([n.sink(l.source),l.sink(n.source)]).catch((function(e){Kk.error(e)})));var p=c.timeline;c.timeline=new Proxy(p,{set:function(){return null!=a&&"close"===(arguments.length<=1?void 0:arguments[1])&&null!=(arguments.length<=2?void 0:arguments[2])&&null==p.close&&(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"open"!==a.status){e.next=4;break}return e.next=4,a.close();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),Kk.error(e.t0);case 9:return e.prev=9,s.events.safeDispatchEvent("connection:close",{detail:a}),e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[0,6,9,12]])})))().catch((function(e){Kk.error(e)})),Reflect.set.apply(Reflect,arguments)}}),c.timeline.upgraded=Date.now();var v;return v={remoteAddr:c.remoteAddr,remotePeer:h,status:"open",direction:u,timeline:c.timeline,multiplexer:null===(t=n)||void 0===t?void 0:t.protocol,encryption:o,transient:d,newStream:null!==(r=i)&&void 0!==r?r:function(){throw new wo("connection is not multiplexed",ww.ERR_CONNECTION_NOT_MULTIPLEXED)},getStreams:function(){return null!=n?n.streams:[]},close:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n){e.next=4;break}return Kk.trace("close muxer"),e.next=4,n.close(t);case 4:return Kk.trace("close maconn"),e.next=7,c.close(t);case 7:Kk.trace("closed maconn");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),abort:function(e){c.abort(e),null!=n&&n.abort(e)}},a=new Vk(v),this.events.safeDispatchEvent("connection:open",{detail:a}),a}},{key:"_onStream",value:function(e){var t=e.connection,r=e.stream,n=e.protocol,i=this.components.registrar.getHandler(n),a=i.handler,s=i.options;if(t.transient&&!0!==s.runOnTransientConnection)throw new wo("Cannot open protocol stream on transient connection","ERR_TRANSIENT_CONNECTION");a({connection:t,stream:r})}},{key:"_encryptInbound",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Array.from(this.connectionEncryption.keys()),Kk("handling inbound crypto protocol selection",r),e.prev=2,e.next=5,zk(t,r,{writeBytes:!0});case 5:if(n=e.sent,i=n.stream,a=n.protocol,null!=(s=this.connectionEncryption.get(a))){e.next=11;break}throw new Error("no crypto module found for ".concat(a));case 11:return Kk("encrypting inbound connection..."),e.t0=_e.Z,e.t1=_e.Z,e.t2={},e.next=17,s.secureInbound(this.components.peerId,i);case 17:return e.t3=e.sent,e.t4=(0,e.t1)(e.t2,e.t3),e.t5={},e.t6={protocol:a},e.abrupt("return",(0,e.t0)(e.t4,e.t5,e.t6));case 24:throw e.prev=24,e.t7=e.catch(2),new wo(String(e.t7),ww.ERR_ENCRYPTION_FAILED);case 27:case"end":return e.stop()}}),e,this,[[2,24]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_encryptOutbound",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Array.from(this.connectionEncryption.keys()),Kk("selecting outbound crypto protocol",n),e.prev=2,e.next=5,Nk(t,n,{writeBytes:!0});case 5:if(i=e.sent,a=i.stream,s=i.protocol,null!=(o=this.connectionEncryption.get(s))){e.next=11;break}throw new Error("no crypto module found for ".concat(s));case 11:return Kk("encrypting outbound connection to %p",r),e.t0=_e.Z,e.t1=_e.Z,e.t2={},e.next=17,o.secureOutbound(this.components.peerId,a,r);case 17:return e.t3=e.sent,e.t4=(0,e.t1)(e.t2,e.t3),e.t5={},e.t6={protocol:s},e.abrupt("return",(0,e.t0)(e.t4,e.t5,e.t6));case 24:throw e.prev=24,e.t7=e.catch(2),new wo(String(e.t7),ww.ERR_ENCRYPTION_FAILED);case 27:case"end":return e.stop()}}),e,this,[[2,24]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_multiplexOutbound",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Array.from(r.keys()),Kk("outbound selecting muxer %s",n),e.prev=2,e.next=5,Nk(t,n,{writeBytes:!0});case 5:return i=e.sent,a=i.stream,s=i.protocol,Kk("%s selected as muxer protocol",s),o=r.get(s),e.abrupt("return",{stream:a,muxerFactory:o});case 13:throw e.prev=13,e.t0=e.catch(2),Kk.error("error multiplexing outbound stream",e.t0),new wo(String(e.t0),ww.ERR_MUXER_UNAVAILABLE);case 17:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_multiplexInbound",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Array.from(r.keys()),Kk("inbound handling muxers %s",n),e.prev=2,e.next=5,zk(t,n,{writeBytes:!0});case 5:return i=e.sent,a=i.stream,s=i.protocol,o=r.get(s),e.abrupt("return",{stream:a,muxerFactory:o});case 12:throw e.prev=12,e.t0=e.catch(2),Kk.error("error multiplexing inbound stream",e.t0),new wo(String(e.t0),ww.ERR_MUXER_UNAVAILABLE);case 16:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(t,r){return e.apply(this,arguments)}}()}]),e}(),Jk=zi("libp2p"),$k=new WeakMap,ex=new WeakSet,tx=function(e){ia(r,e);var t=ua(r);function r(e){var n,i,a,s,o,u,c;(0,hi.Z)(this,r),ic(ra(c=t.call(this)),ex),(0,we.Z)(ra(c),"peerId",void 0),(0,we.Z)(ra(c),"peerStore",void 0),(0,we.Z)(ra(c),"contentRouting",void 0),(0,we.Z)(ra(c),"peerRouting",void 0),(0,we.Z)(ra(c),"keychain",void 0),(0,we.Z)(ra(c),"metrics",void 0),(0,we.Z)(ra(c),"services",void 0),(0,we.Z)(ra(c),"components",void 0),lo(ra(c),$k,{writable:!0,value:void 0});var l=new Ly,h=l.dispatchEvent.bind(l);l.dispatchEvent=function(e){var t=h(e),r=c.dispatchEvent(new By(e.type,{detail:e.detail}));return t||r};try{null===Wu.setMaxListeners||void 0===Wu.setMaxListeners||(0,Wu.setMaxListeners)(1/0,l)}catch(_){}po(ra(c),$k,!1),c.peerId=e.peerId,c.services={};var f=c.components=function(){var e=new s_(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),t=new Proxy(e,{get:function(t,r,n){if("string"===typeof r&&!u_.includes(r)){var i=e.components[r];if(null==i&&!o_.includes(r))throw new wo("".concat(r," not set"),"ERR_SERVICE_MISSING");return i}return Reflect.get(t,r,n)},set:function(t,r,n){return"string"===typeof r?e.components[r]=n:Reflect.set(t,r,n),!0}});return t}({peerId:e.peerId,events:l,datastore:null!==(n=e.datastore)&&void 0!==n?n:new to,connectionGater:C_(e.connectionGater)});c.peerStore=c.configureComponent("peerStore",new $b(f,(0,_e.Z)({addressFilter:c.components.connectionGater.filterMultiaddrForPeer},e.peerStore))),null!=e.metrics&&(c.metrics=c.configureComponent("metrics",e.metrics(c.components))),f.events.addEventListener("peer:update",(function(e){if(null==e.detail.previous){var t={id:e.detail.peer.id,multiaddrs:e.detail.peer.addresses.map((function(e){return e.multiaddr})),protocols:e.detail.peer.protocols};f.events.safeDispatchEvent("peer:discovery",{detail:t})}})),null!=e.connectionProtector&&c.configureComponent("connectionProtector",e.connectionProtector(f)),c.components.upgrader=new Xk(c.components,{connectionEncryption:(null!==(i=e.connectionEncryption)&&void 0!==i?i:[]).map((function(e,t){return c.configureComponent("connection-encryption-".concat(t),e(c.components))})),muxers:(null!==(a=e.streamMuxers)&&void 0!==a?a:[]).map((function(e,t){return c.configureComponent("stream-muxers-".concat(t),e(c.components))})),inboundUpgradeTimeout:e.connectionManager.inboundUpgradeTimeout}),c.configureComponent("transportManager",new _k(c.components,e.transportManager)),c.configureComponent("connectionManager",new ok(c.components,e.connectionManager)),c.configureComponent("registrar",new mk(c.components)),c.configureComponent("addressManager",new i_(c.components,e.addresses));var d=_m.generateOptions();c.keychain=c.configureComponent("keyChain",new _m(c.components,(0,_e.Z)((0,_e.Z)({},d),e.keychain)));var p=(null!==(s=e.peerRouters)&&void 0!==s?s:[]).map((function(e,t){return c.configureComponent("peer-router-".concat(t),e(c.components))}));c.peerRouting=c.components.peerRouting=c.configureComponent("peerRouting",new gk(c.components,{routers:p}));var v=(null!==(o=e.contentRouters)&&void 0!==o?o:[]).map((function(e,t){return c.configureComponent("content-router-".concat(t),e(c.components))}));if(c.contentRouting=c.components.contentRouting=c.configureComponent("contentRouting",new dk(c.components,{routers:v})),(null!==(u=e.peerDiscovery)&&void 0!==u?u:[]).forEach((function(e,t){c.configureComponent("peer-discovery-".concat(t),e(c.components)).addEventListener("peer",(function(e){ac(ra(c),ex,rx).call(ra(c),e)}))})),e.transports.forEach((function(e,t){c.components.transportManager.add(c.configureComponent("transport-".concat(t),e(c.components)))})),null!=e.services)for(var g=0,y=Object.keys(e.services);g<y.length;g++){var m=y[g],b=(0,e.services[m])(c.components);null!=b?(c.services[m]=b,c.configureComponent(m,b),null!=b[Iy]&&(Jk("registering service %s for content routing",m),v.push(b[Iy])),null!=b[Ny]&&(Jk("registering service %s for peer routing",m),p.push(b[Ny])),null!=b[Oy]&&(Jk("registering service %s for peer discovery",m),b[Oy].addEventListener("peer",(function(e){ac(ra(c),ex,rx).call(ra(c),e)})))):Jk.error("service factory %s returned null or undefined instance",m)}return c}return(0,fi.Z)(r,[{key:"configureComponent",value:function(e,t){return null==t&&Jk.error("component %s was null or undefined",e),this.components[e]=t,t}},{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!fo(this,$k)){e.next=2;break}return e.abrupt("return");case 2:return po(this,$k,!0),Jk("libp2p is starting"),e.next=6,this.keychain.listKeys();case 6:if(null!=e.sent.find((function(e){return"self"===e.name}))){e.next=11;break}return Jk("importing self key into keychain"),e.next=11,this.keychain.importPeer("self",this.components.peerId);case 11:return e.prev=11,e.next=14,null===(t=(r=this.components).beforeStart)||void 0===t?void 0:t.call(r);case 14:return e.next=16,this.components.start();case 16:return e.next=18,null===(n=(i=this.components).afterStart)||void 0===n?void 0:n.call(i);case 18:this.safeDispatchEvent("start",{detail:this}),Jk("libp2p has started"),e.next=28;break;case 22:return e.prev=22,e.t0=e.catch(11),Jk.error("An error occurred starting libp2p",e.t0),e.next=27,this.stop();case 27:throw e.t0;case 28:case"end":return e.stop()}}),e,this,[[11,22]])})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(fo(this,$k)){e.next=2;break}return e.abrupt("return");case 2:return Jk("libp2p is stopping"),po(this,$k,!1),e.next=6,null===(t=(r=this.components).beforeStop)||void 0===t?void 0:t.call(r);case 6:return e.next=8,this.components.stop();case 8:return e.next=10,null===(n=(i=this.components).afterStop)||void 0===n?void 0:n.call(i);case 10:this.safeDispatchEvent("stop",{detail:this}),Jk("libp2p has stopped");case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isStarted",value:function(){return fo(this,$k)}},{key:"getConnections",value:function(e){return this.components.connectionManager.getConnections(e)}},{key:"getDialQueue",value:function(){return this.components.connectionManager.getDialQueue()}},{key:"getPeers",value:function(){var e,t=new Em,r=(0,ge.Z)(this.components.connectionManager.getConnections());try{for(r.s();!(e=r.n()).done;){var n=e.value;t.add(n.remotePeer)}}catch(S$){r.e(S$)}finally{r.f()}return Array.from(t)}},{key:"dial",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:{},e.abrupt("return",this.components.connectionManager.openConnection(t,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"dialProtocol",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>2&&void 0!==a[2]?a[2]:{},null!=r){e.next=3;break}throw new wo("no protocols were provided to open a stream",ww.ERR_INVALID_PROTOCOLS_FOR_STREAM);case 3:if(0!==(r=Array.isArray(r)?r:[r]).length){e.next=6;break}throw new wo("no protocols were provided to open a stream",ww.ERR_INVALID_PROTOCOLS_FOR_STREAM);case 6:return e.next=8,this.dial(t,n);case 8:return i=e.sent,e.abrupt("return",i.newStream(r,n));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getMultiaddrs",value:function(){return this.components.addressManager.getAddresses()}},{key:"getProtocols",value:function(){return this.components.registrar.getProtocols()}},{key:"hangUp",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{},gb(t)&&(t=em(null!==(n=t.getPeerId())&&void 0!==n?n:"")),e.next=4,this.components.connectionManager.closeConnections(t,r);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPublicKey",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.length>1&&void 0!==s[1]?s[1]:{},Jk("getPublicKey %p",t),null==t.publicKey){e.next=4;break}return e.abrupt("return",t.publicKey);case 4:return e.next=6,this.peerStore.get(t);case 6:if(null==(n=e.sent).id.publicKey){e.next=9;break}return e.abrupt("return",n.id.publicKey);case 9:return i=Eu([Hs("/pk/"),t.multihash.digest]),e.next=12,this.contentRouting.get(i,r);case 12:return Ey(a=e.sent),e.next=16,this.peerStore.patch(t,{publicKey:a});case 16:return e.abrupt("return",a);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handle",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Array.isArray(t)||(t=[t]),e.next=3,Promise.all(t.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.components.registrar.handle(t,r,n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"unhandle",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Array.isArray(t)||(t=[t]),e.next=3,Promise.all(t.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.components.registrar.unhandle(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"register",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.components.registrar.register(t,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"unregister",value:function(e){this.components.registrar.unregister(e)}}]),r}(Ly);function rx(e){var t=e.detail;t.id.toString()!==this.peerId.toString()?this.components.peerStore.merge(t.id,{multiaddrs:t.multiaddrs,protocols:t.protocols}).catch((function(e){Jk.error(e)})):Jk.error(new Error(ww.ERR_DISCOVERED_SELF))}function nx(e){return ix.apply(this,arguments)}function ix(){return(ix=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.peerId){e.next=14;break}if(null==(r=t.datastore)){e.next=14;break}return e.prev=3,n=new _m({datastore:r},am(_m.generateOptions(),t.keychain)),e.next=7,n.exportPeerId("self");case 7:t.peerId=e.sent,e.next=14;break;case 10:if(e.prev=10,e.t0=e.catch(3),"ERR_NOT_FOUND"===e.t0.code){e.next=14;break}throw e.t0;case 14:if(null!=t.peerId){e.next=18;break}return e.next=17,Cm();case 17:t.peerId=e.sent;case 18:return e.abrupt("return",new tx(Rw(t)));case 19:case"end":return e.stop()}}),e,null,[[3,10]])})))).apply(this,arguments)}function ax(e){return sx.apply(this,arguments)}function sx(){return sx=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,nx(t);case 2:if(r=e.sent,!1===t.start){e.next=6;break}return e.next=6,r.start();case 6:return e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)}))),sx.apply(this,arguments)}var ox=function(){function e(t,r,n){(0,hi.Z)(this,e),(0,we.Z)(this,"gossip",void 0),(0,we.Z)(this,"msgs",new Map),(0,we.Z)(this,"msgIdToStrFn",void 0),(0,we.Z)(this,"history",[]),(0,we.Z)(this,"notValidatedCount",0),this.gossip=t,this.msgIdToStrFn=n;for(var i=0;i<r;i++)this.history[i]=[]}return(0,fi.Z)(e,[{key:"size",get:function(){return this.msgs.size}},{key:"put",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e.msgIdStr;return!this.msgs.has(n)&&(this.msgs.set(n,{message:t,validated:r,originatingPeers:new Set,iwantCounts:new Map}),this.history[0].push((0,_e.Z)((0,_e.Z)({},e),{},{topic:t.topic})),r||this.notValidatedCount++,!0)}},{key:"observeDuplicate",value:function(e,t){var r=this.msgs.get(e);r&&!r.validated&&r.originatingPeers.add(t)}},{key:"get",value:function(e){var t;return null===(t=this.msgs.get(this.msgIdToStrFn(e)))||void 0===t?void 0:t.message}},{key:"getWithIWantCount",value:function(e,t){var r,n=this.msgs.get(e);if(!n)return null;var i=(null!==(r=n.iwantCounts.get(t))&&void 0!==r?r:0)+1;return n.iwantCounts.set(t,i),{msg:n.message,count:i}}},{key:"getGossipIDs",value:function(e){for(var t=this,r=new Map,n=0;n<this.gossip;n++)this.history[n].forEach((function(n){var i=t.msgs.get(n.msgIdStr);if(i&&i.validated&&e.has(n.topic)){var a=r.get(n.topic);a||(a=[],r.set(n.topic,a)),a.push(n.msgId)}}));return r}},{key:"validate",value:function(e){var t=this.msgs.get(e);if(!t)return null;t.validated||this.notValidatedCount--;var r=t.message,n=t.originatingPeers;return t.validated=!0,t.originatingPeers=new Set,{message:r,originatingPeers:n}}},{key:"shift",value:function(){var e=this;this.history[this.history.length-1].forEach((function(t){var r=e.msgs.get(t.msgIdStr);r&&(e.msgs.delete(t.msgIdStr),r.validated||e.notValidatedCount--)})),this.history.pop(),this.history.unshift([])}},{key:"remove",value:function(e){var t=this.msgs.get(e);return t?(this.msgs.delete(e),t):null}}]),e}(),ux=__webpack_require__(4482).RPC,cx="/floodsub/1.0.0",lx="/meshsub/1.0.0",hx="/meshsub/1.1.0",fx=5e3;function dx(e){if(e.length<=1)return e;for(var t=0;t<e.length;t++){var r=Math.floor(Math.random()*Math.floor(e.length)),n=e[t];e[t]=e[r],e[r]=n}return e}function px(e){return Ws(e,"base64")}var vx,gx,yx,mx,bx,_x,wx="StrictSign",kx="StrictNoSign";function xx(e){switch(e){case vx.Ignore:return mx.Ignore;case vx.Reject:return mx.Reject}}function Ex(e,t){return Sx.apply(this,arguments)}function Sx(){return Sx=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next=e.t0===wx?3:e.t0===kx?13:14;break;case 3:if(r){e.next=5;break}throw Error("Must provide PeerId");case 5:if(null!=r.privateKey){e.next=7;break}throw Error("Cannot sign message, no private key present");case 7:if(null!=r.publicKey){e.next=9;break}throw Error("Cannot sign message, no public key present");case 9:return e.next=11,Cy(r.privateKey);case 11:return n=e.sent,e.abrupt("return",{type:yx.Signing,author:r,key:r.publicKey,privateKey:n});case 13:return e.abrupt("return",{type:yx.Anonymous});case 14:throw new Error('Unknown signature policy "'.concat(t,'"'));case 15:case"end":return e.stop()}}),e)}))),Sx.apply(this,arguments)}!function(e){e.Accept="accept",e.Ignore="ignore",e.Reject="reject"}(vx||(vx={})),function(e){e.StrictSign="StrictSign",e.StrictNoSign="StrictNoSign"}(gx||(gx={})),function(e){e[e.Signing=0]="Signing",e[e.Anonymous=1]="Anonymous"}(yx||(yx={})),function(e){e.Error="error",e.Ignore="ignore",e.Reject="reject",e.Blacklisted="blacklisted"}(mx||(mx={})),function(e){e.InvalidSignature="invalid_signature",e.InvalidSeqno="invalid_seqno",e.InvalidPeerId="invalid_peerid",e.SignaturePresent="signature_present",e.SeqnoPresent="seqno_present",e.FromPresent="from_present",e.TransformFailed="transform_failed"}(bx||(bx={})),function(e){e.duplicate="duplicate",e.invalid="invalid",e.valid="valid"}(_x||(_x={}));var Cx="ERR_INVALID_PEER_SCORE_PARAMS",Ax={topics:{},topicScoreCap:10,appSpecificScore:function(){return 0},appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyThreshold:0,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:36e5},Dx={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function Rx(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,_e.Z)((0,_e.Z)((0,_e.Z)({},Ax),e),{},{topics:e.topics?Object.entries(e.topics).reduce((function(e,t){var r=(0,ke.Z)(t,2),n=r[0],i=r[1];return e[n]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,_e.Z)((0,_e.Z)({},Dx),e)}(i),e}),{}):{}})}function Tx(e){if(e.topicWeight<0)throw new wo("invalid topic weight; must be >= 0",Cx);if(0===e.timeInMeshQuantum)throw new wo("invalid TimeInMeshQuantum; must be non zero",Cx);if(e.timeInMeshWeight<0)throw new wo("invalid TimeInMeshWeight; must be positive (or 0 to disable)",Cx);if(0!==e.timeInMeshWeight&&e.timeInMeshQuantum<=0)throw new wo("invalid TimeInMeshQuantum; must be positive",Cx);if(0!==e.timeInMeshWeight&&e.timeInMeshCap<=0)throw new wo("invalid TimeInMeshCap; must be positive",Cx);if(e.firstMessageDeliveriesWeight<0)throw new wo("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)",Cx);if(0!==e.firstMessageDeliveriesWeight&&(e.firstMessageDeliveriesDecay<=0||e.firstMessageDeliveriesDecay>=1))throw new wo("invalid FirstMessageDeliveriesDecay; must be between 0 and 1",Cx);if(0!==e.firstMessageDeliveriesWeight&&e.firstMessageDeliveriesCap<=0)throw new wo("invalid FirstMessageDeliveriesCap; must be positive",Cx);if(e.meshMessageDeliveriesWeight>0)throw new wo("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)",Cx);if(0!==e.meshMessageDeliveriesWeight&&(e.meshMessageDeliveriesDecay<=0||e.meshMessageDeliveriesDecay>=1))throw new wo("invalid MeshMessageDeliveriesDecay; must be between 0 and 1",Cx);if(0!==e.meshMessageDeliveriesWeight&&e.meshMessageDeliveriesCap<=0)throw new wo("invalid MeshMessageDeliveriesCap; must be positive",Cx);if(0!==e.meshMessageDeliveriesWeight&&e.meshMessageDeliveriesThreshold<=0)throw new wo("invalid MeshMessageDeliveriesThreshold; must be positive",Cx);if(e.meshMessageDeliveriesWindow<0)throw new wo("invalid MeshMessageDeliveriesWindow; must be non-negative",Cx);if(0!==e.meshMessageDeliveriesWeight&&e.meshMessageDeliveriesActivation<1e3)throw new wo("invalid MeshMessageDeliveriesActivation; must be at least 1s",Cx);if(e.meshFailurePenaltyWeight>0)throw new wo("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)",Cx);if(0!==e.meshFailurePenaltyWeight&&(e.meshFailurePenaltyDecay<=0||e.meshFailurePenaltyDecay>=1))throw new wo("invalid MeshFailurePenaltyDecay; must be between 0 and 1",Cx);if(e.invalidMessageDeliveriesWeight>0)throw new wo("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)",Cx);if(e.invalidMessageDeliveriesDecay<=0||e.invalidMessageDeliveriesDecay>=1)throw new wo("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1",Cx)}var Zx={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function Ix(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,_e.Z)((0,_e.Z)({},Zx),e)}function Px(e,t,r,n){var i=0;Object.entries(t.topics).forEach((function(e){var t=(0,ke.Z)(e,2),n=t[0],a=t[1],s=r.topics[n];if(void 0!==s){var o=0;if(a.inMesh){var u=a.meshTime/s.timeInMeshQuantum;u>s.timeInMeshCap&&(u=s.timeInMeshCap),o+=u*s.timeInMeshWeight}var c=a.firstMessageDeliveries;if(c>s.firstMessageDeliveriesCap&&(c=s.firstMessageDeliveriesCap),o+=c*s.firstMessageDeliveriesWeight,a.meshMessageDeliveriesActive&&a.meshMessageDeliveries<s.meshMessageDeliveriesThreshold){var l=s.meshMessageDeliveriesThreshold-a.meshMessageDeliveries;o+=l*l*s.meshMessageDeliveriesWeight}o+=a.meshFailurePenalty*s.meshFailurePenaltyWeight,o+=a.invalidMessageDeliveries*a.invalidMessageDeliveries*s.invalidMessageDeliveriesWeight,i+=o*s.topicWeight}})),r.topicScoreCap>0&&i>r.topicScoreCap&&(i=r.topicScoreCap);var a=r.appSpecificScore(e);if(i+=a*r.appSpecificWeight,t.knownIPs.forEach((function(e){if(!r.IPColocationFactorWhitelist.has(e)){var t=n.get(e),a=t?t.size:0;if(a>r.IPColocationFactorThreshold){var s=a-r.IPColocationFactorThreshold;i+=s*s*r.IPColocationFactorWeight}}})),t.behaviourPenalty>r.behaviourPenaltyThreshold){var s=t.behaviourPenalty-r.behaviourPenaltyThreshold;i+=s*s*r.behaviourPenaltyWeight}return i}var Lx,Mx=__webpack_require__(8718),Bx=__webpack_require__.n(Mx);!function(e){e[e.unknown=0]="unknown",e[e.valid=1]="valid",e[e.invalid=2]="invalid",e[e.ignored=3]="ignored"}(Lx||(Lx={}));var Ox=function(){function e(){(0,hi.Z)(this,e),(0,we.Z)(this,"records",void 0),(0,we.Z)(this,"queue",void 0),this.records=new Map,this.queue=new Mx}return(0,fi.Z)(e,[{key:"getRecord",value:function(e){return this.records.get(e)}},{key:"ensureRecord",value:function(e){var t=this.records.get(e);if(t)return t;t={status:Lx.unknown,firstSeenTsMs:Date.now(),validated:0,peers:new Set},this.records.set(e,t);var r={msgId:e,expire:Date.now()+12e4};return this.queue.push(r),t}},{key:"gc",value:function(){for(var e=Date.now(),t=this.queue.peekFront();t&&t.expire<e;)this.records.delete(t.msgId),this.queue.shift(),t=this.queue.peekFront()}},{key:"clear",value:function(){this.records.clear(),this.queue.clear()}}]),e}();function Nx(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!0},n=new Set;if(t<=0)return n;var i,a=(0,ge.Z)(e);try{for(a.s();!(i=a.n()).done;){var s=i.value;if(n.size>=t)break;r(s)&&(n.add(s),e.delete(s))}}catch(S$){a.e(S$)}finally{a.f()}return n}function Fx(e,t){return Nx(e,t,(function(){return!0}))}var Ux,zx,jx,Hx,Wx,qx,Vx=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),n=t.call(this),(0,we.Z)(ra(n),"getDefault",void 0),n.getDefault=e,n}return(0,fi.Z)(r,[{key:"getOrDefault",value:function(e){var t=yo(aa(r.prototype),"get",this).call(this,e);return void 0===t&&(t=this.getDefault(),this.set(e,t)),t}}]),r}(es(Map)),Kx=zi("libp2p:gossipsub:score"),Yx=function(){function e(t,r,n){var i;(0,hi.Z)(this,e),(0,we.Z)(this,"params",void 0),(0,we.Z)(this,"metrics",void 0),(0,we.Z)(this,"peerStats",new Map),(0,we.Z)(this,"peerIPs",new Vx((function(){return new Set}))),(0,we.Z)(this,"scoreCache",new Map),(0,we.Z)(this,"deliveryRecords",new Ox),(0,we.Z)(this,"_backgroundInterval",void 0),(0,we.Z)(this,"scoreCacheValidityMs",void 0),(0,we.Z)(this,"computeScore",void 0),this.params=t,this.metrics=r,function(e){for(var t=0,r=Object.entries(e.topics);t<r.length;t++){var n=(0,ke.Z)(r[t],2),i=n[0],a=n[1];try{Tx(a)}catch(s){throw new wo("invalid score parameters for topic ".concat(i,": ").concat(s.message),Cx)}}if(e.topicScoreCap<0)throw new wo("invalid topic score cap; must be positive (or 0 for no cap)",Cx);if(null===e.appSpecificScore||void 0===e.appSpecificScore)throw new wo("missing application specific score function",Cx);if(e.IPColocationFactorWeight>0)throw new wo("invalid IPColocationFactorWeight; must be negative (or 0 to disable)",Cx);if(0!==e.IPColocationFactorWeight&&e.IPColocationFactorThreshold<1)throw new wo("invalid IPColocationFactorThreshold; must be at least 1",Cx);if(e.behaviourPenaltyWeight>0)throw new wo("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)",Cx);if(0!==e.behaviourPenaltyWeight&&(e.behaviourPenaltyDecay<=0||e.behaviourPenaltyDecay>=1))throw new wo("invalid BehaviourPenaltyDecay; must be between 0 and 1",Cx);if(e.decayInterval<1e3)throw new wo("invalid DecayInterval; must be at least 1s",Cx);if(e.decayToZero<=0||e.decayToZero>=1)throw new wo("invalid DecayToZero; must be between 0 and 1",Cx)}(t),this.scoreCacheValidityMs=n.scoreCacheValidityMs,this.computeScore=null!==(i=n.computeScore)&&void 0!==i?i:Px}return(0,fi.Z)(e,[{key:"size",get:function(){return this.peerStats.size}},{key:"start",value:function(){var e=this;this._backgroundInterval?Kx("Peer score already running"):(this._backgroundInterval=setInterval((function(){return e.background()}),this.params.decayInterval),Kx("started"))}},{key:"stop",value:function(){this._backgroundInterval?(clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),Kx("stopped")):Kx("Peer score already stopped")}},{key:"background",value:function(){this.refreshScores(),this.deliveryRecords.gc()}},{key:"dumpPeerScoreStats",value:function(){return Object.fromEntries(Array.from(this.peerStats.entries()).map((function(e){var t=(0,ke.Z)(e,2);return[t[0],t[1]]})))}},{key:"messageFirstSeenTimestampMs",value:function(e){var t=this.deliveryRecords.getRecord(e);return t?t.firstSeenTsMs:null}},{key:"refreshScores",value:function(){var e=this,t=Date.now(),r=this.params.decayToZero;this.peerStats.forEach((function(n,i){n.connected?(Object.entries(n.topics).forEach((function(n){var i=(0,ke.Z)(n,2),a=i[0],s=i[1],o=e.params.topics[a];void 0!==o&&(s.firstMessageDeliveries*=o.firstMessageDeliveriesDecay,s.firstMessageDeliveries<r&&(s.firstMessageDeliveries=0),s.meshMessageDeliveries*=o.meshMessageDeliveriesDecay,s.meshMessageDeliveries<r&&(s.meshMessageDeliveries=0),s.meshFailurePenalty*=o.meshFailurePenaltyDecay,s.meshFailurePenalty<r&&(s.meshFailurePenalty=0),s.invalidMessageDeliveries*=o.invalidMessageDeliveriesDecay,s.invalidMessageDeliveries<r&&(s.invalidMessageDeliveries=0),s.inMesh&&(s.meshTime=t-s.graftTime,s.meshTime>o.meshMessageDeliveriesActivation&&(s.meshMessageDeliveriesActive=!0)))})),n.behaviourPenalty*=e.params.behaviourPenaltyDecay,n.behaviourPenalty<r&&(n.behaviourPenalty=0)):t>n.expire&&(e.removeIPsForPeer(i,n.knownIPs),e.peerStats.delete(i),e.scoreCache.delete(i))}))}},{key:"score",value:function(e){var t,r;null===(t=this.metrics)||void 0===t||t.scoreFnCalls.inc();var n=this.peerStats.get(e);if(!n)return 0;var i=Date.now(),a=this.scoreCache.get(e);if(a&&a.cacheUntil>i)return a.score;null===(r=this.metrics)||void 0===r||r.scoreFnRuns.inc();var s,o=this.computeScore(e,n,this.params,this.peerIPs),u=i+this.scoreCacheValidityMs;a?(null===(s=this.metrics)||void 0===s||s.scoreCachedDelta.observe(Math.abs(o-a.score)),a.score=o,a.cacheUntil=u):this.scoreCache.set(e,{score:o,cacheUntil:u});return o}},{key:"addPenalty",value:function(e,t,r){var n,i=this.peerStats.get(e);i&&(i.behaviourPenalty+=t,null===(n=this.metrics)||void 0===n||n.onScorePenalty(r))}},{key:"addPeer",value:function(e){var t={connected:!0,expire:0,topics:{},knownIPs:new Set,behaviourPenalty:0};this.peerStats.set(e,t)}},{key:"addIP",value:function(e,t){var r=this.peerStats.get(e);r&&r.knownIPs.add(t),this.peerIPs.getOrDefault(t).add(e)}},{key:"removeIP",value:function(e,t){var r=this.peerStats.get(e);r&&r.knownIPs.delete(t);var n=this.peerIPs.get(t);n&&(n.delete(e),0===n.size&&this.peerIPs.delete(t))}},{key:"removePeer",value:function(e){var t=this,r=this.peerStats.get(e);if(r){if(this.score(e)>0)return this.removeIPsForPeer(e,r.knownIPs),void this.peerStats.delete(e);Object.entries(r.topics).forEach((function(e){var r=(0,ke.Z)(e,2),n=r[0],i=r[1];i.firstMessageDeliveries=0;var a=t.params.topics[n].meshMessageDeliveriesThreshold;if(i.inMesh&&i.meshMessageDeliveriesActive&&i.meshMessageDeliveries<a){var s=a-i.meshMessageDeliveries;i.meshFailurePenalty+=s*s}i.inMesh=!1,i.meshMessageDeliveriesActive=!1})),r.connected=!1,r.expire=Date.now()+this.params.retainScore}}},{key:"graft",value:function(e,t){var r=this.peerStats.get(e);if(r){var n=this.getPtopicStats(r,t);n&&(n.inMesh=!0,n.graftTime=Date.now(),n.meshTime=0,n.meshMessageDeliveriesActive=!1)}}},{key:"prune",value:function(e,t){var r=this.peerStats.get(e);if(r){var n=this.getPtopicStats(r,t);if(n){var i=this.params.topics[t].meshMessageDeliveriesThreshold;if(n.meshMessageDeliveriesActive&&n.meshMessageDeliveries<i){var a=i-n.meshMessageDeliveries;n.meshFailurePenalty+=a*a}n.meshMessageDeliveriesActive=!1,n.inMesh=!1}}}},{key:"validateMessage",value:function(e){this.deliveryRecords.ensureRecord(e)}},{key:"deliverMessage",value:function(e,t,r){var n=this;this.markFirstMessageDelivery(e,r);var i=this.deliveryRecords.ensureRecord(t),a=Date.now();i.status===Lx.unknown?(i.status=Lx.valid,i.validated=a,i.peers.forEach((function(t){t!==e.toString()&&n.markDuplicateMessageDelivery(t,r)}))):Kx("unexpected delivery: message from %s was first seen %s ago and has delivery status %s",e,a-i.firstSeenTsMs,Lx[i.status])}},{key:"rejectInvalidMessage",value:function(e,t){this.markInvalidMessageDelivery(e,t)}},{key:"rejectMessage",value:function(e,t,r,n){var i=this;switch(n){case mx.Error:return void this.markInvalidMessageDelivery(e,r);case mx.Blacklisted:return}var a=this.deliveryRecords.ensureRecord(t);if(a.status===Lx.unknown){if(n===mx.Ignore)return a.status=Lx.ignored,void a.peers.clear();a.status=Lx.invalid,this.markInvalidMessageDelivery(e,r),a.peers.forEach((function(e){i.markInvalidMessageDelivery(e,r)})),a.peers.clear()}else Kx("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",e,Date.now()-a.firstSeenTsMs,Lx[a.status])}},{key:"duplicateMessage",value:function(e,t,r){var n=this.deliveryRecords.ensureRecord(t);if(!n.peers.has(e))switch(n.status){case Lx.unknown:n.peers.add(e);break;case Lx.valid:n.peers.add(e),this.markDuplicateMessageDelivery(e,r,n.validated);break;case Lx.invalid:this.markInvalidMessageDelivery(e,r);case Lx.ignored:}}},{key:"markInvalidMessageDelivery",value:function(e,t){var r=this.peerStats.get(e);if(r){var n=this.getPtopicStats(r,t);n&&(n.invalidMessageDeliveries+=1)}}},{key:"markFirstMessageDelivery",value:function(e,t){var r=this.peerStats.get(e);if(r){var n=this.getPtopicStats(r,t);if(n){var i=this.params.topics[t].firstMessageDeliveriesCap;n.firstMessageDeliveries=Math.min(i,n.firstMessageDeliveries+1),n.inMesh&&(i=this.params.topics[t].meshMessageDeliveriesCap,n.meshMessageDeliveries=Math.min(i,n.meshMessageDeliveries+1))}}}},{key:"markDuplicateMessageDelivery",value:function(e,t,r){var n=this.peerStats.get(e);if(n){var i=void 0!==r?Date.now():0,a=this.getPtopicStats(n,t);if(a&&a.inMesh){var s=this.params.topics[t];if(void 0!==r){var o,u=i-r,c=u>s.meshMessageDeliveriesWindow;if(null===(o=this.metrics)||void 0===o||o.onDuplicateMsgDelivery(t,u,c),c)return}var l=s.meshMessageDeliveriesCap;a.meshMessageDeliveries=Math.min(l,a.meshMessageDeliveries+1)}}}},{key:"removeIPsForPeer",value:function(e,t){var r,n=(0,ge.Z)(t);try{for(n.s();!(r=n.n()).done;){var i=r.value,a=this.peerIPs.get(i);a&&(a.delete(e),0===a.size&&this.peerIPs.delete(i))}}catch(S$){n.e(S$)}finally{n.f()}}},{key:"getPtopicStats",value:function(e,t){var r=e.topics[t];return void 0!==r?r:void 0!==this.params.topics[t]?(r={inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},e.topics[t]=r,r):null}}]),e}(),Gx=function(){function e(t,r,n){(0,hi.Z)(this,e),(0,we.Z)(this,"gossipsubIWantFollowupMs",void 0),(0,we.Z)(this,"msgIdToStrFn",void 0),(0,we.Z)(this,"metrics",void 0),(0,we.Z)(this,"promises",new Map),(0,we.Z)(this,"requestMsByMsg",new Map),(0,we.Z)(this,"requestMsByMsgExpire",void 0),this.gossipsubIWantFollowupMs=t,this.msgIdToStrFn=r,this.metrics=n,this.requestMsByMsgExpire=10*t}return(0,fi.Z)(e,[{key:"size",get:function(){return this.promises.size}},{key:"requestMsByMsgSize",get:function(){return this.requestMsByMsg.size}},{key:"addPromise",value:function(e,t){var r=t[Math.floor(Math.random()*t.length)],n=this.msgIdToStrFn(r),i=this.promises.get(n);i||(i=new Map,this.promises.set(n,i));var a=Date.now();i.has(e)||(i.set(e,a+this.gossipsubIWantFollowupMs),this.metrics&&(this.metrics.iwantPromiseStarted.inc(1),this.requestMsByMsg.has(n)||this.requestMsByMsg.set(n,a)))}},{key:"getBrokenPromises",value:function(){var e,t=this,r=Date.now(),n=new Map,i=0;return this.promises.forEach((function(e,a){e.forEach((function(t,a){var s;t<r&&(n.set(a,(null!==(s=n.get(a))&&void 0!==s?s:0)+1),e.delete(a),i++)})),e.size||t.promises.delete(a)})),null===(e=this.metrics)||void 0===e||e.iwantPromiseBroken.inc(i),n}},{key:"deliverMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.trackMessage(e);var r=this.promises.get(e);r&&(this.promises.delete(e),this.metrics&&(this.metrics.iwantPromiseResolved.inc(1),t&&this.metrics.iwantPromiseResolvedFromDuplicate.inc(1),this.metrics.iwantPromiseResolvedPeers.inc(r.size)))}},{key:"rejectMessage",value:function(e,t){this.trackMessage(e),t!==mx.Error&&this.promises.delete(e)}},{key:"clear",value:function(){this.promises.clear()}},{key:"prune",value:function(){var e,t,r=Date.now()-this.requestMsByMsgExpire,n=0,i=(0,ge.Z)(this.requestMsByMsg.entries());try{for(i.s();!(t=i.n()).done;){var a=(0,ke.Z)(t.value,2),s=a[0];if(!(a[1]<r))break;this.requestMsByMsg.delete(s),n++}}catch(S$){i.e(S$)}finally{i.f()}null===(e=this.metrics)||void 0===e||e.iwantMessagePruned.inc(n)}},{key:"trackMessage",value:function(e){if(this.metrics){var t=this.requestMsByMsg.get(e);void 0!==t&&(this.metrics.iwantPromiseDeliveryTime.observe((Date.now()-t)/1e3),this.requestMsByMsg.delete(e))}}}]),e}(),Qx=function(){function e(t){(0,hi.Z)(this,e),(0,we.Z)(this,"entries",new Map),(0,we.Z)(this,"validityMs",void 0),this.validityMs=t.validityMs}return(0,fi.Z)(e,[{key:"size",get:function(){return this.entries.size}},{key:"put",value:function(e,t){return!!this.entries.has(e)||(this.entries.set(e,{value:t,validUntilMs:Date.now()+this.validityMs}),!1)}},{key:"prune",value:function(){var e,t=Date.now(),r=(0,ge.Z)(this.entries.entries());try{for(r.s();!(e=r.n()).done;){var n=(0,ke.Z)(e.value,2),i=n[0];if(!(n[1].validUntilMs<t))break;this.entries.delete(i)}}catch(S$){r.e(S$)}finally{r.f()}}},{key:"has",value:function(e){return this.entries.has(e)}},{key:"get",value:function(e){var t=this.entries.get(e);return t&&t.validUntilMs>=Date.now()?t.value:void 0}},{key:"clear",value:function(){this.entries.clear()}}]),e}();!function(e){e.forward="forward",e.publish="publish"}(Ux||(Ux={})),function(e){e.Fanout="fanout",e.Random="random",e.Subscribed="subscribed",e.Outbound="outbound",e.NotEnough="not_enough",e.Opportunistic="opportunistic"}(zx||(zx={})),function(e){e.Dc="disconnected",e.BadScore="bad_score",e.Prune="prune",e.Excess="excess"}(jx||(jx={})),function(e){e.GraftBackoff="graft_backoff",e.BrokenPromise="broken_promise",e.MessageDeficit="message_deficit",e.IPColocation="IP_colocation"}(Hx||(Hx={})),function(e){e.LowScore="low_score",e.MaxIhave="max_ihave",e.MaxIasked="max_iasked"}(Wx||(Wx={})),function(e){e.graylist="graylist",e.publish="publish",e.gossip="gossip",e.mesh="mesh"}(qx||(qx={}));var Xx=Hs("libp2p-pubsub:");function Jx(e,t,r,n){return $x.apply(this,arguments)}function $x(){return $x=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i){var a,s,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next=e.t0===yx.Signing?3:e.t0===yx.Anonymous?11:12;break;case 3:return a={from:t.author.toBytes(),data:i,seqno:hg(8),topic:r,signature:void 0,key:void 0},s=Eu([Xx,ux.Message.encode(a).finish()]),e.next=7,t.privateKey.sign(s);case 7:return a.signature=e.sent,a.key=t.key,o={type:"signed",from:t.author,data:n,sequenceNumber:BigInt("0x".concat(Ws(a.seqno,"base16"))),topic:r,signature:a.signature,key:a.key},e.abrupt("return",{raw:a,msg:o});case 11:return e.abrupt("return",{raw:{from:void 0,data:i,seqno:void 0,topic:r,signature:void 0,key:void 0},msg:{type:"unsigned",data:n,topic:r}});case 12:case"end":return e.stop()}}),e)}))),$x.apply(this,arguments)}function eE(e,t){return tE.apply(this,arguments)}function tE(){return tE=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next=e.t0===kx?3:e.t0===wx?10:41;break;case 3:if(null==r.signature){e.next=5;break}return e.abrupt("return",{valid:!1,error:bx.SignaturePresent});case 5:if(null==r.seqno){e.next=7;break}return e.abrupt("return",{valid:!1,error:bx.SeqnoPresent});case 7:if(null==r.key){e.next=9;break}return e.abrupt("return",{valid:!1,error:bx.FromPresent});case 9:return e.abrupt("return",{valid:!0,message:{type:"unsigned",topic:r.topic,data:null!==(n=r.data)&&void 0!==n?n:new Uint8Array(0)}});case 10:if(null!=r.seqno){e.next=12;break}return e.abrupt("return",{valid:!1,error:bx.InvalidSeqno});case 12:if(8===r.seqno.length){e.next=14;break}return e.abrupt("return",{valid:!1,error:bx.InvalidSeqno});case 14:if(null!=r.signature){e.next=16;break}return e.abrupt("return",{valid:!1,error:bx.InvalidSignature});case 16:if(null!=r.from){e.next=18;break}return e.abrupt("return",{valid:!1,error:bx.InvalidPeerId});case 18:e.prev=18,s=tm(r.from),e.next=25;break;case 22:return e.prev=22,e.t1=e.catch(18),e.abrupt("return",{valid:!1,error:bx.InvalidPeerId});case 25:if(!r.key){e.next=31;break}if(o=Ey(r.key),void 0===s.publicKey||Ao(o.bytes,s.publicKey)){e.next=29;break}return e.abrupt("return",{valid:!1,error:bx.InvalidPeerId});case 29:e.next=34;break;case 31:if(null!=s.publicKey){e.next=33;break}return e.abrupt("return",{valid:!1,error:bx.InvalidPeerId});case 33:o=Ey(s.publicKey);case 34:return u={from:r.from,data:r.data,seqno:r.seqno,topic:r.topic,signature:void 0,key:void 0},c=Eu([Xx,ux.Message.encode(u).finish()]),e.next=38,o.verify(c,r.signature);case 38:if(e.sent){e.next=40;break}return e.abrupt("return",{valid:!1,error:bx.InvalidSignature});case 40:return e.abrupt("return",{valid:!0,message:{type:"signed",from:s,data:null!==(i=r.data)&&void 0!==i?i:new Uint8Array(0),sequenceNumber:BigInt("0x".concat(Ws(r.seqno,"base16"))),topic:r.topic,signature:r.signature,key:null!==(a=r.key)&&void 0!==a?a:Sy(o)}});case 41:case"end":return e.stop()}}),e,null,[[18,22]])}))),tE.apply(this,arguments)}function rE(e){if("signed"!==e.type)throw new Error("expected signed message type");if(null==e.sequenceNumber)throw Error("missing seqno field");return function(e,t){var r=Hs(t.toString(16).padStart(16,"0"),"base16"),n=new Uint8Array(e.length+r.length);return n.set(e,0),n.set(r,e.length),n}(e.from.toBytes(),e.sequenceNumber)}function nE(e){return iE.apply(this,arguments)}function iE(){return(iE=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ps.encode(t.data);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function aE(e,t,r,n,i){var a=0,s=new Map;if(Object.entries(t.topics).forEach((function(e){var t,n=(0,ke.Z)(e,2),o=n[0],u=n[1],c=null!==(t=i.get(o))&&void 0!==t?t:"unknown",l=r.topics[o];if(void 0!==l){var h=s.get(c);h||(h={p1w:0,p2w:0,p3w:0,p3bw:0,p4w:0},s.set(c,h));var f=0,d=0,p=0,v=0,g=0;if(u.inMesh)f+=Math.max(u.meshTime/l.timeInMeshQuantum,l.timeInMeshCap)*l.timeInMeshWeight;var y=u.firstMessageDeliveries;if(y>l.firstMessageDeliveriesCap&&(y=l.firstMessageDeliveriesCap),d+=y*l.firstMessageDeliveriesWeight,u.meshMessageDeliveriesActive&&u.meshMessageDeliveries<l.meshMessageDeliveriesThreshold){var m=l.meshMessageDeliveriesThreshold-u.meshMessageDeliveries;p+=m*m*l.meshMessageDeliveriesWeight}v+=u.meshFailurePenalty*l.meshFailurePenaltyWeight,g+=u.invalidMessageDeliveries*u.invalidMessageDeliveries*l.invalidMessageDeliveriesWeight,a+=(f+d+p+v+g)*l.topicWeight,h.p1w+=f,h.p2w+=d,h.p3w+=p,h.p3bw+=v,h.p4w+=g}})),r.topicScoreCap>0&&a>r.topicScoreCap){a=r.topicScoreCap;var o,u=r.topicScoreCap/a,c=(0,ge.Z)(s.values());try{for(c.s();!(o=c.n()).done;){var l=o.value;l.p1w*=u,l.p2w*=u,l.p3w*=u,l.p3bw*=u,l.p4w*=u}}catch(S$){c.e(S$)}finally{c.f()}}var h=0,f=0,d=0;return h+=r.appSpecificScore(e)*r.appSpecificWeight,t.knownIPs.forEach((function(e){if(!r.IPColocationFactorWhitelist.has(e)){var t=n.get(e),i=t?t.size:0;if(i>r.IPColocationFactorThreshold){var a=i-r.IPColocationFactorThreshold;f+=a*a*r.IPColocationFactorWeight}}})),d+=t.behaviourPenalty*t.behaviourPenalty*r.behaviourPenaltyWeight,{byTopic:s,p5w:h,p6w:f,p7w:d,score:a+=h+f+d}}var sE,oE=function(){function e(t,r,n){var i;(0,hi.Z)(this,e),(0,we.Z)(this,"rawStream",void 0),(0,we.Z)(this,"pushable",void 0),(0,we.Z)(this,"closeController",void 0),(0,we.Z)(this,"maxBufferSize",void 0),this.rawStream=t,this.pushable=as({objectMode:!1}),this.closeController=new AbortController,this.maxBufferSize=null!==(i=n.maxBufferSize)&&void 0!==i?i:1/0,no(Sk(this.pushable,this.closeController.signal,{returnOnAbort:!0}),(function(e){return Zu(e)}),this.rawStream).catch(r)}return(0,fi.Z)(e,[{key:"protocol",get:function(){return this.rawStream.protocol}},{key:"push",value:function(e){if(this.pushable.readableLength>this.maxBufferSize)throw Error("OutboundStream buffer full, size > ".concat(this.maxBufferSize));this.pushable.push(e)}},{key:"close",value:function(){this.closeController.abort(),this.pushable.return(),this.rawStream.close()}}]),e}(),uE=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,hi.Z)(this,e),(0,we.Z)(this,"source",void 0),(0,we.Z)(this,"rawStream",void 0),(0,we.Z)(this,"closeController",void 0),this.rawStream=t,this.closeController=new AbortController,this.source=Sk(no(this.rawStream,(function(e){return Bu(e,r)})),this.closeController.signal,{returnOnAbort:!0})}return(0,fi.Z)(e,[{key:"close",value:function(){this.closeController.abort(),this.rawStream.close()}}]),e}(),cE=__webpack_require__(886),lE={maxSubscriptions:1/0,maxMessages:1/0,maxIhaveMessageIDs:1/0,maxIwantMessageIDs:1/0,maxControlMessages:1/0,maxPeerInfos:1/0};function hE(e,t){t=(0,_e.Z)({},t);for(var r=cE.Reader.create(e),n=e.length,i=void 0===n?r.len:r.pos+n,a={};r.pos<i;){var s=r.uint32();switch(s>>>3){case 1:a.subscriptions&&a.subscriptions.length||(a.subscriptions=[]),a.subscriptions.length<t.maxSubscriptions?a.subscriptions.push(fE(r,r.uint32())):r.skipType(7&s);break;case 2:a.messages&&a.messages.length||(a.messages=[]),a.messages.length<t.maxMessages?a.messages.push(dE(r,r.uint32())):r.skipType(7&s);break;case 3:a.control=pE(r,r.uint32(),t);break;default:r.skipType(7&s)}}return a}function fE(e,t){for(var r=void 0===t?e.len:e.pos+t,n={};e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.subscribe=e.bool();break;case 2:n.topic=e.string();break;default:e.skipType(7&i)}}return n}function dE(e,t){for(var r=void 0===t?e.len:e.pos+t,n={};e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.from=e.bytes();break;case 2:n.data=e.bytes();break;case 3:n.seqno=e.bytes();break;case 4:n.topic=e.string();break;case 5:n.signature=e.bytes();break;case 6:n.key=e.bytes();break;default:e.skipType(7&i)}}if(!n.topic)throw Error("missing required 'topic'");return n}function pE(e,t,r){for(var n=void 0===t?e.len:e.pos+t,i={};e.pos<n;){var a=e.uint32();switch(a>>>3){case 1:i.ihave&&i.ihave.length||(i.ihave=[]),i.ihave.length<r.maxControlMessages?i.ihave.push(vE(e,e.uint32(),r)):e.skipType(7&a);break;case 2:i.iwant&&i.iwant.length||(i.iwant=[]),i.iwant.length<r.maxControlMessages?i.iwant.push(gE(e,e.uint32(),r)):e.skipType(7&a);break;case 3:i.graft&&i.graft.length||(i.graft=[]),i.graft.length<r.maxControlMessages?i.graft.push(yE(e,e.uint32())):e.skipType(7&a);break;case 4:i.prune&&i.prune.length||(i.prune=[]),i.prune.length<r.maxControlMessages?i.prune.push(mE(e,e.uint32(),r)):e.skipType(7&a);break;default:e.skipType(7&a)}}return i}function vE(e,t,r){for(var n=void 0===t?e.len:e.pos+t,i={};e.pos<n;){var a=e.uint32();switch(a>>>3){case 1:i.topicID=e.string();break;case 2:i.messageIDs&&i.messageIDs.length||(i.messageIDs=[]),r.maxIhaveMessageIDs-- >0?i.messageIDs.push(e.bytes()):e.skipType(7&a);break;default:e.skipType(7&a)}}return i}function gE(e,t,r){for(var n=void 0===t?e.len:e.pos+t,i={};e.pos<n;){var a=e.uint32();if(a>>>3===1)i.messageIDs&&i.messageIDs.length||(i.messageIDs=[]),r.maxIwantMessageIDs-- >0?i.messageIDs.push(e.bytes()):e.skipType(7&a);else e.skipType(7&a)}return i}function yE(e,t){for(var r=void 0===t?e.len:e.pos+t,n={};e.pos<r;){var i=e.uint32();if(i>>>3===1)n.topicID=e.string();else e.skipType(7&i)}return n}function mE(e,t,r){for(var n=void 0===t?e.len:e.pos+t,i={};e.pos<n;){var a=e.uint32();switch(a>>>3){case 1:i.topicID=e.string();break;case 2:i.peers&&i.peers.length||(i.peers=[]),r.maxPeerInfos-- >0?i.peers.push(bE(e,e.uint32())):e.skipType(7&a);break;case 3:i.backoff=e.uint64();break;default:e.skipType(7&a)}}return i}function bE(e,t){for(var r=void 0===t?e.len:e.pos+t,n={};e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.peerID=e.bytes();break;case 2:n.signedPeerRecord=e.bytes();break;default:e.skipType(7&i)}}return n}!function(e){e[e.ip4=4]="ip4",e[e.ip6=41]="ip6"}(sE||(sE={}));var _E;!function(e){e[e.started=0]="started",e[e.stopped=1]="stopped"}(_E||(_E={}));var wE=function(e){ia(r,e);var t=ua(r);function r(e){var n,i,a,s,o,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,hi.Z)(this,r),o=t.call(this),(0,we.Z)(ra(o),"globalSignaturePolicy",void 0),(0,we.Z)(ra(o),"multicodecs",[hx,lx]),(0,we.Z)(ra(o),"publishConfig",void 0),(0,we.Z)(ra(o),"dataTransform",void 0),(0,we.Z)(ra(o),"peers",new Set),(0,we.Z)(ra(o),"streamsInbound",new Map),(0,we.Z)(ra(o),"streamsOutbound",new Map),(0,we.Z)(ra(o),"outboundInflightQueue",as({objectMode:!0})),(0,we.Z)(ra(o),"direct",new Set),(0,we.Z)(ra(o),"floodsubPeers",new Set),(0,we.Z)(ra(o),"seenCache",void 0),(0,we.Z)(ra(o),"acceptFromWhitelist",new Map),(0,we.Z)(ra(o),"topics",new Map),(0,we.Z)(ra(o),"subscriptions",new Set),(0,we.Z)(ra(o),"mesh",new Map),(0,we.Z)(ra(o),"fanout",new Map),(0,we.Z)(ra(o),"fanoutLastpub",new Map),(0,we.Z)(ra(o),"gossip",new Map),(0,we.Z)(ra(o),"control",new Map),(0,we.Z)(ra(o),"peerhave",new Map),(0,we.Z)(ra(o),"iasked",new Map),(0,we.Z)(ra(o),"backoff",new Map),(0,we.Z)(ra(o),"outbound",new Map),(0,we.Z)(ra(o),"msgIdFn",void 0),(0,we.Z)(ra(o),"fastMsgIdFn",void 0),(0,we.Z)(ra(o),"msgIdToStrFn",void 0),(0,we.Z)(ra(o),"fastMsgIdCache",void 0),(0,we.Z)(ra(o),"publishedMessageIds",void 0),(0,we.Z)(ra(o),"mcache",void 0),(0,we.Z)(ra(o),"score",void 0),(0,we.Z)(ra(o),"topicValidators",new Map),(0,we.Z)(ra(o),"log",void 0),(0,we.Z)(ra(o),"heartbeatTicks",0),(0,we.Z)(ra(o),"gossipTracer",void 0),(0,we.Z)(ra(o),"components",void 0),(0,we.Z)(ra(o),"directPeerInitial",null),(0,we.Z)(ra(o),"opts",void 0),(0,we.Z)(ra(o),"decodeRpcLimits",void 0),(0,we.Z)(ra(o),"metrics",void 0),(0,we.Z)(ra(o),"status",{code:_E.stopped}),(0,we.Z)(ra(o),"maxInboundStreams",void 0),(0,we.Z)(ra(o),"maxOutboundStreams",void 0),(0,we.Z)(ra(o),"allowedTopics",void 0),(0,we.Z)(ra(o),"heartbeatTimer",null),(0,we.Z)(ra(o),"runHeartbeat",(function(){var e,t=null===(e=o.metrics)||void 0===e?void 0:e.heartbeatDuration.startTimer();o.heartbeat().catch((function(e){o.log("Error running heartbeat",e)})).finally((function(){if(null!=t&&t(),o.status.code===_E.started){clearTimeout(o.status.heartbeatTimeout);var e,r=o.opts.heartbeatInterval-(Date.now()-o.status.hearbeatStartMs)%o.opts.heartbeatInterval;if(r<.25*o.opts.heartbeatInterval)r+=o.opts.heartbeatInterval,null===(e=o.metrics)||void 0===e||e.heartbeatSkipped.inc();o.status.heartbeatTimeout=setTimeout(o.runHeartbeat,r)}}))}));var c=(0,_e.Z)((0,_e.Z)({fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:6,Dlo:4,Dhi:12,Dscore:4,Dout:2,Dlazy:6,heartbeatInterval:1e3,fanoutTTL:6e4,mcacheLength:5,mcacheGossip:3,seenTTL:12e4,gossipsubIWantFollowupMs:3e3,prunePeers:16,pruneBackoff:6e4,unsubcribeBackoff:1e4,graftFloodThreshold:1e4,opportunisticGraftPeers:2,opportunisticGraftTicks:60,directConnectTicks:300},u),{},{scoreParams:Rx(u.scoreParams),scoreThresholds:Ix(u.scoreThresholds)});if(o.components=e,o.decodeRpcLimits=null!==(n=c.decodeRpcLimits)&&void 0!==n?n:lE,o.globalSignaturePolicy=null!==(i=c.globalSignaturePolicy)&&void 0!==i?i:wx,c.fallbackToFloodsub&&o.multicodecs.push(cx),o.log=zi(null!==(a=c.debugName)&&void 0!==a?a:"libp2p:gossipsub"),o.opts=c,o.direct=new Set(c.directPeers.map((function(e){return e.id.toString()}))),o.seenCache=new Qx({validityMs:c.seenTTL}),o.publishedMessageIds=new Qx({validityMs:c.seenTTL}),u.msgIdFn)o.msgIdFn=u.msgIdFn;else switch(o.globalSignaturePolicy){case wx:o.msgIdFn=rE;break;case kx:o.msgIdFn=nE}if(u.fastMsgIdFn&&(o.fastMsgIdFn=u.fastMsgIdFn,o.fastMsgIdCache=new Qx({validityMs:c.seenTTL})),o.msgIdToStrFn=null!==(s=u.msgIdToStrFn)&&void 0!==s?s:px,o.mcache=u.messageCache||new ox(c.mcacheGossip,c.mcacheLength,o.msgIdToStrFn),u.dataTransform&&(o.dataTransform=u.dataTransform),u.metricsRegister){if(!u.metricsTopicStrToLabel)throw Error("Must set metricsTopicStrToLabel with metrics");var l=Math.max.apply(Math,be(Object.values(c.scoreParams.topics).map((function(e){return e.meshMessageDeliveriesWindow}))).concat([1e3])),h=function(e,t,r){return{protocolsEnabled:e.gauge({name:"gossipsub_protocol",help:"Status of enabled protocols",labelNames:["protocol"]}),topicSubscriptionStatus:e.gauge({name:"gossipsub_topic_subscription_status",help:"Status of our subscription to this topic",labelNames:["topicStr"]}),topicPeersCount:e.gauge({name:"gossipsub_topic_peer_count",help:"Number of peers subscribed to each topic",labelNames:["topicStr"]}),meshPeerCounts:e.gauge({name:"gossipsub_mesh_peer_count",help:"Number of peers in our mesh",labelNames:["topicStr"]}),meshPeerInclusionEventsFanout:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_fanout_total",help:"Number of times we include peers in a topic mesh for fanout reasons",labelNames:["topic"]}),meshPeerInclusionEventsRandom:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_random_total",help:"Number of times we include peers in a topic mesh for random reasons",labelNames:["topic"]}),meshPeerInclusionEventsSubscribed:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_subscribed_total",help:"Number of times we include peers in a topic mesh for subscribed reasons",labelNames:["topic"]}),meshPeerInclusionEventsOutbound:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_outbound_total",help:"Number of times we include peers in a topic mesh for outbound reasons",labelNames:["topic"]}),meshPeerInclusionEventsNotEnough:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_not_enough_total",help:"Number of times we include peers in a topic mesh for not_enough reasons",labelNames:["topic"]}),meshPeerInclusionEventsOpportunistic:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_opportunistic_total",help:"Number of times we include peers in a topic mesh for opportunistic reasons",labelNames:["topic"]}),meshPeerInclusionEventsUnknown:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_unknown_total",help:"Number of times we include peers in a topic mesh for unknown reasons",labelNames:["topic"]}),meshPeerChurnEventsDisconnected:e.gauge({name:"gossipsub_peer_churn_events_disconnected_total",help:"Number of times we remove peers in a topic mesh for disconnected reasons",labelNames:["topic"]}),meshPeerChurnEventsBadScore:e.gauge({name:"gossipsub_peer_churn_events_bad_score_total",help:"Number of times we remove peers in a topic mesh for bad_score reasons",labelNames:["topic"]}),meshPeerChurnEventsPrune:e.gauge({name:"gossipsub_peer_churn_events_prune_total",help:"Number of times we remove peers in a topic mesh for prune reasons",labelNames:["topic"]}),meshPeerChurnEventsExcess:e.gauge({name:"gossipsub_peer_churn_events_excess_total",help:"Number of times we remove peers in a topic mesh for excess reasons",labelNames:["topic"]}),meshPeerChurnEventsUnknown:e.gauge({name:"gossipsub_peer_churn_events_unknown_total",help:"Number of times we remove peers in a topic mesh for unknown reasons",labelNames:["topic"]}),peersPerProtocol:e.gauge({name:"gossipsub_peers_per_protocol_count",help:"Peers connected for each topic",labelNames:["protocol"]}),heartbeatDuration:e.histogram({name:"gossipsub_heartbeat_duration_seconds",help:"The time it takes to complete one iteration of the heartbeat",buckets:[.01,.1,1]}),heartbeatSkipped:e.gauge({name:"gossipsub_heartbeat_skipped",help:"Heartbeat run took longer than heartbeat interval so next is skipped"}),acceptedMessagesTotal:e.gauge({name:"gossipsub_accepted_messages_total",help:"Total accepted messages for each topic",labelNames:["topic"]}),ignoredMessagesTotal:e.gauge({name:"gossipsub_ignored_messages_total",help:"Total ignored messages for each topic",labelNames:["topic"]}),rejectedMessagesTotal:e.gauge({name:"gossipsub_rejected_messages_total",help:"Total rejected messages for each topic",labelNames:["topic"]}),unknownValidationResultsTotal:e.gauge({name:"gossipsub_unknown_validation_results_total",help:"Total unknown validation results for each topic",labelNames:["topic"]}),asyncValidationMcacheHit:e.gauge({name:"gossipsub_async_validation_mcache_hit_total",help:"Async validation result reported by the user layer",labelNames:["hit"]}),asyncValidationDelayFromFirstSeenSec:e.histogram({name:"gossipsub_async_validation_delay_from_first_seen",help:"Async validation report delay from first seen in second",labelNames:["topic"],buckets:[.01,.03,.1,.3,1,3,10]}),asyncValidationUnknownFirstSeen:e.gauge({name:"gossipsub_async_validation_unknown_first_seen_count_total",help:"Async validation report unknown first seen value for message"}),peerReadStreamError:e.gauge({name:"gossipsub_peer_read_stream_err_count_total",help:"Peer read stream error"}),rpcRecvBytes:e.gauge({name:"gossipsub_rpc_recv_bytes_total",help:"RPC recv"}),rpcRecvCount:e.gauge({name:"gossipsub_rpc_recv_count_total",help:"RPC recv"}),rpcRecvSubscription:e.gauge({name:"gossipsub_rpc_recv_subscription_total",help:"RPC recv"}),rpcRecvMessage:e.gauge({name:"gossipsub_rpc_recv_message_total",help:"RPC recv"}),rpcRecvControl:e.gauge({name:"gossipsub_rpc_recv_control_total",help:"RPC recv"}),rpcRecvIHave:e.gauge({name:"gossipsub_rpc_recv_ihave_total",help:"RPC recv"}),rpcRecvIWant:e.gauge({name:"gossipsub_rpc_recv_iwant_total",help:"RPC recv"}),rpcRecvGraft:e.gauge({name:"gossipsub_rpc_recv_graft_total",help:"RPC recv"}),rpcRecvPrune:e.gauge({name:"gossipsub_rpc_recv_prune_total",help:"RPC recv"}),rpcDataError:e.gauge({name:"gossipsub_rpc_data_err_count_total",help:"RPC data error"}),rpcRecvError:e.gauge({name:"gossipsub_rpc_recv_err_count_total",help:"RPC recv error"}),rpcRecvNotAccepted:e.gauge({name:"gossipsub_rpc_rcv_not_accepted_total",help:"Total count of RPC dropped because acceptFrom() == false"}),rpcSentBytes:e.gauge({name:"gossipsub_rpc_sent_bytes_total",help:"RPC sent"}),rpcSentCount:e.gauge({name:"gossipsub_rpc_sent_count_total",help:"RPC sent"}),rpcSentSubscription:e.gauge({name:"gossipsub_rpc_sent_subscription_total",help:"RPC sent"}),rpcSentMessage:e.gauge({name:"gossipsub_rpc_sent_message_total",help:"RPC sent"}),rpcSentControl:e.gauge({name:"gossipsub_rpc_sent_control_total",help:"RPC sent"}),rpcSentIHave:e.gauge({name:"gossipsub_rpc_sent_ihave_total",help:"RPC sent"}),rpcSentIWant:e.gauge({name:"gossipsub_rpc_sent_iwant_total",help:"RPC sent"}),rpcSentGraft:e.gauge({name:"gossipsub_rpc_sent_graft_total",help:"RPC sent"}),rpcSentPrune:e.gauge({name:"gossipsub_rpc_sent_prune_total",help:"RPC sent"}),msgPublishCount:e.gauge({name:"gossipsub_msg_publish_count_total",help:"Total count of msg published by topic",labelNames:["topic"]}),msgPublishPeersByTopic:e.gauge({name:"gossipsub_msg_publish_peers_total",help:"Total count of peers that we publish a msg to",labelNames:["topic"]}),directPeersPublishedTotal:e.gauge({name:"gossipsub_direct_peers_published_total",help:"Total direct peers that we publish a msg to",labelNames:["topic"]}),floodsubPeersPublishedTotal:e.gauge({name:"gossipsub_floodsub_peers_published_total",help:"Total floodsub peers that we publish a msg to",labelNames:["topic"]}),meshPeersPublishedTotal:e.gauge({name:"gossipsub_mesh_peers_published_total",help:"Total mesh peers that we publish a msg to",labelNames:["topic"]}),fanoutPeersPublishedTotal:e.gauge({name:"gossipsub_fanout_peers_published_total",help:"Total fanout peers that we publish a msg to",labelNames:["topic"]}),msgPublishBytes:e.gauge({name:"gossipsub_msg_publish_bytes_total",help:"Total count of msg publish data.length bytes",labelNames:["topic"]}),msgPublishTime:e.histogram({name:"gossipsub_msg_publish_seconds",help:"Total time in seconds to publish a message",buckets:[.001,.002,.005,.01,.1,.5,1],labelNames:["topic"]}),msgForwardCount:e.gauge({name:"gossipsub_msg_forward_count_total",help:"Total count of msg forwarded by topic",labelNames:["topic"]}),msgForwardPeers:e.gauge({name:"gossipsub_msg_forward_peers_total",help:"Total count of peers that we forward a msg to",labelNames:["topic"]}),msgReceivedPreValidation:e.gauge({name:"gossipsub_msg_received_prevalidation_total",help:"Total count of recv msgs before any validation",labelNames:["topic"]}),msgReceivedError:e.gauge({name:"gossipsub_msg_received_error_total",help:"Total count of recv msgs error",labelNames:["topic"]}),prevalidationInvalidTotal:e.gauge({name:"gossipsub_pre_validation_invalid_total",help:"Total count of invalid messages received",labelNames:["topic"]}),prevalidationValidTotal:e.gauge({name:"gossipsub_pre_validation_valid_total",help:"Total count of valid messages received",labelNames:["topic"]}),prevalidationDuplicateTotal:e.gauge({name:"gossipsub_pre_validation_duplicate_total",help:"Total count of duplicate messages received",labelNames:["topic"]}),prevalidationUnknownTotal:e.gauge({name:"gossipsub_pre_validation_unknown_status_total",help:"Total count of unknown_status messages received",labelNames:["topic"]}),msgReceivedInvalid:e.gauge({name:"gossipsub_msg_received_invalid_total",help:"Tracks specific reason of invalid",labelNames:["error"]}),msgReceivedInvalidByTopic:e.gauge({name:"gossipsub_msg_received_invalid_by_topic_total",help:"Tracks specific invalid message by topic",labelNames:["topic"]}),duplicateMsgDeliveryDelay:e.histogram({name:"gossisub_duplicate_msg_delivery_delay_seconds",help:"Time since the 1st duplicated message validated",labelNames:["topic"],buckets:[.25*r.maxMeshMessageDeliveriesWindowSec,.5*r.maxMeshMessageDeliveriesWindowSec,1*r.maxMeshMessageDeliveriesWindowSec,2*r.maxMeshMessageDeliveriesWindowSec,4*r.maxMeshMessageDeliveriesWindowSec]}),duplicateMsgLateDelivery:e.gauge({name:"gossisub_duplicate_msg_late_delivery_total",help:"Total count of late duplicate message delivery by topic, which triggers P3 penalty",labelNames:["topic"]}),duplicateMsgIgnored:e.gauge({name:"gossisub_ignored_published_duplicate_msgs_total",help:"Total count of published duplicate message ignored by topic",labelNames:["topic"]}),scoreFnCalls:e.gauge({name:"gossipsub_score_fn_calls_total",help:"Total times score() is called"}),scoreFnRuns:e.gauge({name:"gossipsub_score_fn_runs_total",help:"Total times score() call actually computed computeScore(), no cache"}),scoreCachedDelta:e.histogram({name:"gossipsub_score_cache_delta",help:"Delta of score between cached values that expired",buckets:[10,100,1e3]}),peersByScoreThreshold:e.gauge({name:"gossipsub_peers_by_score_threshold_count",help:"Current count of peers by score threshold",labelNames:["threshold"]}),score:e.avgMinMax({name:"gossipsub_score",help:"Avg min max of gossip scores"}),scoreWeights:e.avgMinMax({name:"gossipsub_score_weights",help:"Separate score weights",labelNames:["topic","p"]}),scorePerMesh:e.avgMinMax({name:"gossipsub_score_per_mesh",help:"Histogram of the scores for each mesh topic",labelNames:["topic"]}),scoringPenalties:e.gauge({name:"gossipsub_scoring_penalties_total",help:"A counter of the kind of penalties being applied to peers",labelNames:["penalty"]}),behaviourPenalty:e.histogram({name:"gossipsub_peer_stat_behaviour_penalty",help:"Current peer stat behaviour_penalty at each scrape",buckets:[.25*r.behaviourPenaltyThreshold,.5*r.behaviourPenaltyThreshold,1*r.behaviourPenaltyThreshold,2*r.behaviourPenaltyThreshold,4*r.behaviourPenaltyThreshold]}),ihaveRcvIgnored:e.gauge({name:"gossipsub_ihave_rcv_ignored_total",help:"Total received IHAVE messages that we ignore for some reason",labelNames:["reason"]}),ihaveRcvMsgids:e.gauge({name:"gossipsub_ihave_rcv_msgids_total",help:"Total received IHAVE messages by topic",labelNames:["topic"]}),ihaveRcvNotSeenMsgids:e.gauge({name:"gossipsub_ihave_rcv_not_seen_msgids_total",help:"Total messages per topic we do not have, not actual requests",labelNames:["topic"]}),iwantRcvMsgids:e.gauge({name:"gossipsub_iwant_rcv_msgids_total",help:"Total received IWANT messages by topic",labelNames:["topic"]}),iwantRcvDonthaveMsgids:e.gauge({name:"gossipsub_iwant_rcv_dont_have_msgids_total",help:"Total requested messageIDs that we do not have"}),iwantPromiseStarted:e.gauge({name:"gossipsub_iwant_promise_sent_total",help:"Total count of started IWANT promises"}),iwantPromiseResolved:e.gauge({name:"gossipsub_iwant_promise_resolved_total",help:"Total count of resolved IWANT promises"}),iwantPromiseResolvedFromDuplicate:e.gauge({name:"gossipsub_iwant_promise_resolved_from_duplicate_total",help:"Total count of resolved IWANT promises from duplicate messages"}),iwantPromiseResolvedPeers:e.gauge({name:"gossipsub_iwant_promise_resolved_peers",help:"Total count of peers we have asked IWANT promises that are resolved"}),iwantPromiseBroken:e.gauge({name:"gossipsub_iwant_promise_broken",help:"Total count of broken IWANT promises"}),iwantMessagePruned:e.gauge({name:"gossipsub_iwant_message_pruned",help:"Total count of pruned IWANT messages"}),iwantPromiseDeliveryTime:e.histogram({name:"gossipsub_iwant_promise_delivery_seconds",help:"Histogram of delivery time of resolved IWANT promises",buckets:[.5*r.gossipPromiseExpireSec,1*r.gossipPromiseExpireSec,2*r.gossipPromiseExpireSec,4*r.gossipPromiseExpireSec]}),iwantPromiseUntracked:e.gauge({name:"gossip_iwant_promise_untracked",help:"Total count of untracked IWANT promise"}),connectedPeersBackoffSec:e.histogram({name:"gossipsub_connected_peers_backoff_seconds",help:"Backoff time in seconds",buckets:[1,2,4,10,20,60,120]}),cacheSize:e.gauge({name:"gossipsub_cache_size",help:"Unbounded cache sizes",labelNames:["cache"]}),mcacheSize:e.gauge({name:"gossipsub_mcache_size",help:"Current mcache msg count"}),mcacheNotValidatedCount:e.gauge({name:"gossipsub_mcache_not_validated_count",help:"Current mcache msg count not validated"}),fastMsgIdCacheCollision:e.gauge({name:"gossipsub_fastmsgid_cache_collision_total",help:"Total count of key collisions on fastmsgid cache put"}),newConnectionCount:e.gauge({name:"gossipsub_new_connection_total",help:"Total new connection by status",labelNames:["status"]}),topicStrToLabel:t,toTopic:function(e){var t;return null!==(t=this.topicStrToLabel.get(e))&&void 0!==t?t:e},onJoin:function(e){this.topicSubscriptionStatus.set({topicStr:e},1),this.meshPeerCounts.set({topicStr:e},0)},onLeave:function(e){this.topicSubscriptionStatus.set({topicStr:e},0),this.meshPeerCounts.set({topicStr:e},0)},onAddToMesh:function(e,t,r){var n=this.toTopic(e);switch(t){case zx.Fanout:this.meshPeerInclusionEventsFanout.inc({topic:n},r);break;case zx.Random:this.meshPeerInclusionEventsRandom.inc({topic:n},r);break;case zx.Subscribed:this.meshPeerInclusionEventsSubscribed.inc({topic:n},r);break;case zx.Outbound:this.meshPeerInclusionEventsOutbound.inc({topic:n},r);break;case zx.NotEnough:this.meshPeerInclusionEventsNotEnough.inc({topic:n},r);break;case zx.Opportunistic:this.meshPeerInclusionEventsOpportunistic.inc({topic:n},r);break;default:this.meshPeerInclusionEventsUnknown.inc({topic:n},r)}},onRemoveFromMesh:function(e,t,r){var n=this.toTopic(e);switch(t){case jx.Dc:this.meshPeerChurnEventsDisconnected.inc({topic:n},r);break;case jx.BadScore:this.meshPeerChurnEventsBadScore.inc({topic:n},r);break;case jx.Prune:this.meshPeerChurnEventsPrune.inc({topic:n},r);break;case jx.Excess:this.meshPeerChurnEventsExcess.inc({topic:n},r);break;default:this.meshPeerChurnEventsUnknown.inc({topic:n},r)}},onReportValidation:function(e,t,r){if(this.asyncValidationMcacheHit.inc({hit:null!=e?"hit":"miss"}),null!=e){var n=this.toTopic(e.message.topic);switch(t){case vx.Accept:this.acceptedMessagesTotal.inc({topic:n});break;case vx.Ignore:this.ignoredMessagesTotal.inc({topic:n});break;case vx.Reject:this.rejectedMessagesTotal.inc({topic:n});break;default:this.unknownValidationResultsTotal.inc({topic:n})}}null!=r?this.asyncValidationDelayFromFirstSeenSec.observe((Date.now()-r)/1e3):this.asyncValidationUnknownFirstSeen.inc()},onScorePenalty:function(e){this.scoringPenalties.inc({penalty:e},1)},onIhaveRcv:function(e,t,r){var n=this.toTopic(e);this.ihaveRcvMsgids.inc({topic:n},t),this.ihaveRcvNotSeenMsgids.inc({topic:n},r)},onIwantRcv:function(e,t){var r,n=(0,ge.Z)(e);try{for(n.s();!(r=n.n()).done;){var i=(0,ke.Z)(r.value,2),a=i[0],s=i[1],o=this.toTopic(a);this.iwantRcvMsgids.inc({topic:o},s)}}catch(S$){n.e(S$)}finally{n.f()}this.iwantRcvDonthaveMsgids.inc(t)},onForwardMsg:function(e,t){var r=this.toTopic(e);this.msgForwardCount.inc({topic:r},1),this.msgForwardPeers.inc({topic:r},t)},onPublishMsg:function(e,t,r,n,i){var a=this.toTopic(e);this.msgPublishCount.inc({topic:a},1),this.msgPublishBytes.inc({topic:a},r*n),this.msgPublishPeersByTopic.inc({topic:a},r),this.directPeersPublishedTotal.inc({topic:a},t.direct),this.floodsubPeersPublishedTotal.inc({topic:a},t.floodsub),this.meshPeersPublishedTotal.inc({topic:a},t.mesh),this.fanoutPeersPublishedTotal.inc({topic:a},t.fanout),this.msgPublishTime.observe({topic:a},i/1e3)},onMsgRecvPreValidation:function(e){var t=this.toTopic(e);this.msgReceivedPreValidation.inc({topic:t},1)},onMsgRecvError:function(e){var t=this.toTopic(e);this.msgReceivedError.inc({topic:t},1)},onPrevalidationResult:function(e,t){var r=this.toTopic(e);switch(t){case _x.duplicate:this.prevalidationDuplicateTotal.inc({topic:r});break;case _x.invalid:this.prevalidationInvalidTotal.inc({topic:r});break;case _x.valid:this.prevalidationValidTotal.inc({topic:r});break;default:this.prevalidationUnknownTotal.inc({topic:r})}},onMsgRecvInvalid:function(e,t){var r=this.toTopic(e),n=t.reason===mx.Error?t.error:t.reason;this.msgReceivedInvalid.inc({error:n},1),this.msgReceivedInvalidByTopic.inc({topic:r},1)},onDuplicateMsgDelivery:function(e,t,r){if(this.duplicateMsgDeliveryDelay.observe(t/1e3),r){var n=this.toTopic(e);this.duplicateMsgLateDelivery.inc({topic:n},1)}},onPublishDuplicateMsg:function(e){var t=this.toTopic(e);this.duplicateMsgIgnored.inc({topic:t},1)},onPeerReadStreamError:function(){this.peerReadStreamError.inc(1)},onRpcRecvError:function(){this.rpcRecvError.inc(1)},onRpcDataError:function(){this.rpcDataError.inc(1)},onRpcRecv:function(e,t){this.rpcRecvBytes.inc(t),this.rpcRecvCount.inc(1),e.subscriptions&&this.rpcRecvSubscription.inc(e.subscriptions.length),e.messages&&this.rpcRecvMessage.inc(e.messages.length),e.control&&(this.rpcRecvControl.inc(1),e.control.ihave&&this.rpcRecvIHave.inc(e.control.ihave.length),e.control.iwant&&this.rpcRecvIWant.inc(e.control.iwant.length),e.control.graft&&this.rpcRecvGraft.inc(e.control.graft.length),e.control.prune&&this.rpcRecvPrune.inc(e.control.prune.length))},onRpcSent:function(e,t){if(this.rpcSentBytes.inc(t),this.rpcSentCount.inc(1),e.subscriptions&&this.rpcSentSubscription.inc(e.subscriptions.length),e.messages&&this.rpcSentMessage.inc(e.messages.length),e.control){var r,n,i,a,s,o,u,c,l=null!==(r=null===(n=e.control.ihave)||void 0===n?void 0:n.length)&&void 0!==r?r:0,h=null!==(i=null===(a=e.control.iwant)||void 0===a?void 0:a.length)&&void 0!==i?i:0,f=null!==(s=null===(o=e.control.graft)||void 0===o?void 0:o.length)&&void 0!==s?s:0,d=null!==(u=null===(c=e.control.prune)||void 0===c?void 0:c.length)&&void 0!==u?u:0;l>0&&this.rpcSentIHave.inc(l),h>0&&this.rpcSentIWant.inc(h),f>0&&this.rpcSentGraft.inc(f),d>0&&this.rpcSentPrune.inc(d),(l>0||h>0||f>0||d>0)&&this.rpcSentControl.inc(1)}},registerScores:function(e,t){var r,n=0,i=0,a=0,s=0,o=(0,ge.Z)(e);try{for(o.s();!(r=o.n()).done;){var u=r.value;u>=t.graylistThreshold&&n++,u>=t.publishThreshold&&i++,u>=t.gossipThreshold&&a++,u>=0&&s++}}catch(S$){o.e(S$)}finally{o.f()}this.peersByScoreThreshold.set({threshold:qx.graylist},n),this.peersByScoreThreshold.set({threshold:qx.publish},i),this.peersByScoreThreshold.set({threshold:qx.gossip},a),this.peersByScoreThreshold.set({threshold:qx.mesh},s),this.score.set(e)},registerScoreWeights:function(e){var t,r=(0,ge.Z)(e.byTopic);try{for(r.s();!(t=r.n()).done;){var n=(0,ke.Z)(t.value,2),i=n[0],a=n[1];this.scoreWeights.set({topic:i,p:"p1"},a.p1w),this.scoreWeights.set({topic:i,p:"p2"},a.p2w),this.scoreWeights.set({topic:i,p:"p3"},a.p3w),this.scoreWeights.set({topic:i,p:"p3b"},a.p3bw),this.scoreWeights.set({topic:i,p:"p4"},a.p4w)}}catch(S$){r.e(S$)}finally{r.f()}this.scoreWeights.set({p:"p5"},e.p5w),this.scoreWeights.set({p:"p6"},e.p6w),this.scoreWeights.set({p:"p7"},e.p7w)},registerScorePerMesh:function(e,t){var r=this,n=new Map;e.forEach((function(e,t){var i,a=null!==(i=r.topicStrToLabel.get(t))&&void 0!==i?i:"unknown",s=n.get(a);s||(s=new Set,n.set(a,s)),e.forEach((function(e){var t;return null===(t=s)||void 0===t?void 0:t.add(e)}))}));var i,a=(0,ge.Z)(n);try{var s=function(){var e=(0,ke.Z)(i.value,2),n=e[0],a=e[1],s=[];a.forEach((function(e){var r;s.push(null!==(r=t.get(e))&&void 0!==r?r:0)})),r.scorePerMesh.set({topic:n},s)};for(a.s();!(i=a.n()).done;)s()}catch(S$){a.e(S$)}finally{a.f()}}}}(u.metricsRegister,u.metricsTopicStrToLabel,{gossipPromiseExpireSec:o.opts.gossipsubIWantFollowupMs/1e3,behaviourPenaltyThreshold:c.scoreParams.behaviourPenaltyThreshold,maxMeshMessageDeliveriesWindowSec:l/1e3});h.mcacheSize.addCollect((function(){return o.onScrapeMetrics(h)}));var f,d=(0,ge.Z)(o.multicodecs);try{for(d.s();!(f=d.n()).done;){var p=f.value;h.protocolsEnabled.set({protocol:p},1)}}catch(S$){d.e(S$)}finally{d.f()}o.metrics=h}else o.metrics=null;return o.gossipTracer=new Gx(o.opts.gossipsubIWantFollowupMs,o.msgIdToStrFn,o.metrics),o.score=new Yx(o.opts.scoreParams,o.metrics,{scoreCacheValidityMs:c.heartbeatInterval}),o.maxInboundStreams=u.maxInboundStreams,o.maxOutboundStreams=u.maxOutboundStreams,o.allowedTopics=c.allowedTopics?new Set(c.allowedTopics):null,o}return(0,fi.Z)(r,[{key:"getPeers",value:function(){return be(this.peers.keys()).map((function(e){return em(e)}))}},{key:"isStarted",value:function(){return this.status.code===_E.started}},{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i,a=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isStarted()){e.next=2;break}return e.abrupt("return");case 2:return this.log("starting"),e.next=5,Ex(this.globalSignaturePolicy,this.components.peerId);case 5:return this.publishConfig=e.sent,this.outboundInflightQueue=as({objectMode:!0}),no(this.outboundInflightQueue,function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,s,o,u,c,l;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!1,n=!1,e.prev=2,s=ui(t);case 4:return e.next=6,s.next();case 6:if(!(r=!(o=e.sent).done)){e.next=13;break}return u=o.value,c=u.peerId,l=u.connection,e.next=10,a.createOutboundStream(c,l);case 10:r=!1,e.next=4;break;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),n=!0,i=e.t0;case 19:if(e.prev=19,e.prev=20,!r||null==s.return){e.next=24;break}return e.next=24,s.return();case 24:if(e.prev=24,!n){e.next=27;break}throw i;case 27:return e.finish(24);case 28:return e.finish(19);case 29:case"end":return e.stop()}}),e,null,[[2,15,19,29],[20,,24,28]])})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return a.log.error("outbound inflight queue error",e)})),e.next=10,Promise.all(this.opts.directPeers.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.components.peerStore.merge(t.id,{multiaddrs:t.addrs});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 10:return t=this.components.registrar,e.next=13,Promise.all(this.multicodecs.map((function(e){return t.handle(e,a.onIncomingStream.bind(a),{maxInboundStreams:a.maxInboundStreams,maxOutboundStreams:a.maxOutboundStreams})})));case 13:return r={onConnect:this.onPeerConnected.bind(this),onDisconnect:this.onPeerDisconnected.bind(this)},e.next=16,Promise.all(this.multicodecs.map((function(e){return t.register(e,r)})));case 16:n=e.sent,i=setTimeout(this.runHeartbeat,100),this.status={code:_E.started,registrarTopologyIds:n,heartbeatTimeout:i,hearbeatStartMs:Date.now()+100},this.score.start(),this.directPeerInitial=setTimeout((function(){Promise.resolve().then((0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(Array.from(a.direct).map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.connect(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e)})))).catch((function(e){a.log(e)}))}),1e3),this.log("started");case 22:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i,a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.log("stopping"),this.status.code===_E.started){e.next=3;break}return e.abrupt("return");case 3:return t=this.status.registrarTopologyIds,this.status={code:_E.stopped},r=this.components.registrar,e.next=8,Promise.all(this.multicodecs.map((function(e){return r.unhandle(e)})));case 8:t.forEach((function(e){return r.unregister(e)})),this.outboundInflightQueue.end(),n=(0,ge.Z)(this.streamsOutbound.values());try{for(n.s();!(i=n.n()).done;)i.value.close()}catch(S$){n.e(S$)}finally{n.f()}this.streamsOutbound.clear(),a=(0,ge.Z)(this.streamsInbound.values());try{for(a.s();!(s=a.n()).done;)s.value.close()}catch(S$){a.e(S$)}finally{a.f()}this.streamsInbound.clear(),this.peers.clear(),this.subscriptions.clear(),this.heartbeatTimer&&(this.heartbeatTimer.cancel(),this.heartbeatTimer=null),this.score.stop(),this.mesh.clear(),this.fanout.clear(),this.fanoutLastpub.clear(),this.gossip.clear(),this.control.clear(),this.peerhave.clear(),this.iasked.clear(),this.backoff.clear(),this.outbound.clear(),this.gossipTracer.clear(),this.seenCache.clear(),this.fastMsgIdCache&&this.fastMsgIdCache.clear(),this.directPeerInitial&&clearTimeout(this.directPeerInitial),this.log("stopped");case 34:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dumpPeerScoreStats",value:function(){return this.score.dumpPeerScoreStats()}},{key:"onIncomingStream",value:function(e){var t=e.stream,r=e.connection;if(this.isStarted()){var n=r.remotePeer;this.addPeer(n,r.direction,r.remoteAddr),this.createInboundStream(n,t),this.outboundInflightQueue.push({peerId:n,connection:r})}}},{key:"onPeerConnected",value:function(e,t){var r;null===(r=this.metrics)||void 0===r||r.newConnectionCount.inc({status:t.status}),this.isStarted()&&"open"===t.status&&(this.addPeer(e,t.direction,t.remoteAddr),this.outboundInflightQueue.push({peerId:e,connection:t}))}},{key:"onPeerDisconnected",value:function(e){this.log("connection ended %p",e),this.removePeer(e)}},{key:"createOutboundStream",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isStarted()){e.next=2;break}return e.abrupt("return");case 2:if(n=t.toString(),this.peers.has(n)){e.next=5;break}return e.abrupt("return");case 5:if(!this.streamsOutbound.has(n)){e.next=7;break}return e.abrupt("return");case 7:return e.prev=7,e.t0=oE,e.next=11,r.newStream(this.multicodecs);case 11:e.t1=e.sent,e.t2=function(e){return o.log.error("outbound pipe error",e)},e.t3={maxBufferSize:this.opts.maxOutboundBufferSize},a=new e.t0(e.t1,e.t2,e.t3),this.log("create outbound stream %p",t),this.streamsOutbound.set(n,a),(s=a.protocol)===cx&&this.floodsubPeers.add(n),null===(i=this.metrics)||void 0===i||i.peersPerProtocol.inc({protocol:s},1),this.subscriptions.size>0&&(this.log("send subscriptions to",n),this.sendSubscriptions(n,Array.from(this.subscriptions),!0)),e.next=26;break;case 23:e.prev=23,e.t4=e.catch(7),this.log.error("createOutboundStream error",e.t4);case 26:case"end":return e.stop()}}),e,this,[[7,23]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"createInboundStream",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isStarted()){e.next=2;break}return e.abrupt("return");case 2:if(n=t.toString(),this.peers.has(n)){e.next=5;break}return e.abrupt("return");case 5:void 0!==(i=this.streamsInbound.get(n))&&(this.log("replacing existing inbound steam %s",n),i.close()),this.log("create inbound stream %s",n),a=new uE(r,{maxDataLength:this.opts.maxInboundDataLength}),this.streamsInbound.set(n,a),this.pipePeerReadStream(t,a.source).catch((function(e){return s.log(e)}));case 11:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"addPeer",value:function(e,t,r){var n=e.toString();if(!this.peers.has(n)){this.log("new peer %p",e),this.peers.add(n),this.score.addPeer(n);var i=function(e){var t,r=(0,ge.Z)(e.tuples());try{for(r.s();!(t=r.n()).done;){var n=t.value;switch(n[0]){case sE.ip4:case sE.ip6:return Qm(n[0],n[1])}}}catch(S$){r.e(S$)}finally{r.f()}return null}(r);null!==i?this.score.addIP(n,i):this.log("Added peer has no IP in current address %s %s",n,r.toString()),this.outbound.has(n)||this.outbound.set(n,"outbound"===t)}}},{key:"removePeer",value:function(e){var t=e.toString();if(this.peers.has(t)){this.log("delete peer %p",e),this.peers.delete(t);var r,n=this.streamsOutbound.get(t),i=this.streamsInbound.get(t);if(n)null===(r=this.metrics)||void 0===r||r.peersPerProtocol.inc({protocol:n.protocol},-1);null===n||void 0===n||n.close(),null===i||void 0===i||i.close(),this.streamsOutbound.delete(t),this.streamsInbound.delete(t);var a,s=(0,ge.Z)(this.topics.values());try{for(s.s();!(a=s.n()).done;){a.value.delete(t)}}catch(S$){s.e(S$)}finally{s.f()}var o,u=(0,ge.Z)(this.mesh);try{for(u.s();!(o=u.n()).done;){var c,l=(0,ke.Z)(o.value,2),h=l[0];if(!0===l[1].delete(t))null===(c=this.metrics)||void 0===c||c.onRemoveFromMesh(h,jx.Dc,1)}}catch(S$){u.e(S$)}finally{u.f()}var f,d=(0,ge.Z)(this.fanout.values());try{for(d.s();!(f=d.n()).done;){f.value.delete(t)}}catch(S$){d.e(S$)}finally{d.f()}this.floodsubPeers.delete(t),this.gossip.delete(t),this.control.delete(t),this.outbound.delete(t),this.score.removePeer(t),this.acceptFromWhitelist.delete(t)}}},{key:"started",get:function(){return this.status.code===_E.started}},{key:"getMeshPeers",value:function(e){var t=this.mesh.get(e);return t?Array.from(t):[]}},{key:"getSubscribers",value:function(e){var t=this.topics.get(e);return(t?Array.from(t):[]).map((function(e){return em(e)}))}},{key:"getTopics",value:function(){return Array.from(this.subscriptions)}},{key:"pipePeerReadStream",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,no(r,function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(r){var n,a,s,o,u,c,l,h,f,d,p;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!1,a=!1,e.prev=2,o=ui(r);case 4:return e.next=6,o.next();case 6:if(!(n=!(u=e.sent).done)){e.next=34;break}if(c=u.value,e.prev=8,h=c.subarray(),f=hE(h,i.decodeRpcLimits),null===(l=i.metrics)||void 0===l||l.onRpcRecv(f,h.length),!i.opts.awaitRpcHandler){e.next=24;break}return e.prev=13,e.next=16,i.handleReceivedRpc(t,f);case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(13),null===(d=i.metrics)||void 0===d||d.onRpcRecvError(),i.log(e.t0);case 22:e.next=25;break;case 24:i.handleReceivedRpc(t,f).catch((function(e){var t;null===(t=i.metrics)||void 0===t||t.onRpcRecvError(),i.log(e)}));case 25:e.next=31;break;case 27:e.prev=27,e.t1=e.catch(8),null===(p=i.metrics)||void 0===p||p.onRpcDataError(),i.log(e.t1);case 31:n=!1,e.next=4;break;case 34:e.next=40;break;case 36:e.prev=36,e.t2=e.catch(2),a=!0,s=e.t2;case 40:if(e.prev=40,e.prev=41,!n||null==o.return){e.next=45;break}return e.next=45,o.return();case 45:if(e.prev=45,!a){e.next=48;break}throw s;case 48:return e.finish(45);case 49:return e.finish(40);case 50:case"end":return e.stop()}}),e,null,[[2,36,40,50],[8,27],[13,18],[41,,45,49]])})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),null===(n=this.metrics)||void 0===n||n.onPeerReadStreamError(),this.handlePeerReadStreamError(e.t0,t);case 9:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"handlePeerReadStreamError",value:function(e,t){this.log.error(e),this.onPeerDisconnected(t)}},{key:"handleReceivedRpc",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c,l,h,f,d,p=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.acceptFrom(t.toString())){e.next=4;break}return this.log("received message from unacceptable peer %p",t),null===(n=this.metrics)||void 0===n||n.rpcRecvNotAccepted.inc(),e.abrupt("return");case 4:if(i=r.subscriptions?r.subscriptions.length:0,a=r.messages?r.messages.length:0,s=0,o=0,u=0,c=0,r.control&&(r.control.ihave&&(s=r.control.ihave.length),r.control.iwant&&(o=r.control.iwant.length),r.control.graft&&(u=r.control.graft.length),r.control.prune&&(c=r.control.prune.length)),this.log("rpc.from ".concat(t.toString()," subscriptions ").concat(i," messages ").concat(a," ihave ").concat(s," iwant ").concat(o," graft ").concat(u," prune ").concat(c)),r.subscriptions&&r.subscriptions.length>0&&(l=[],r.subscriptions.forEach((function(e){var r=e.topic,n=!0===e.subscribe;if(null!=r){if(p.allowedTopics&&!p.allowedTopics.has(r))return;p.handleReceivedSubscription(t,r,n),l.push({topic:r,subscribe:n})}})),this.dispatchEvent(new By("subscription-change",{detail:{peerId:t,subscriptions:l}}))),!r.messages){e.next=32;break}h=(0,ge.Z)(r.messages),e.prev=15,d=(0,ii.Z)().mark((function e(){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=f.value,!p.allowedTopics||p.allowedTopics.has(r.topic)){e.next=3;break}return e.abrupt("return",1);case 3:if(n=p.handleReceivedMessage(t,r).catch((function(e){var t;null===(t=p.metrics)||void 0===t||t.onMsgRecvError(r.topic),p.log(e)})),!p.opts.awaitRpcMessageHandler){e.next=7;break}return e.next=7,n;case 7:case"end":return e.stop()}}),e)})),h.s();case 18:if((f=h.n()).done){e.next=24;break}return e.delegateYield(d(),"t0",20);case 20:if(!e.t0){e.next=22;break}return e.abrupt("continue",22);case 22:e.next=18;break;case 24:e.next=29;break;case 26:e.prev=26,e.t1=e.catch(15),h.e(e.t1);case 29:return e.prev=29,h.f(),e.finish(29);case 32:if(!r.control){e.next=35;break}return e.next=35,this.handleControlMessage(t.toString(),r.control);case 35:case"end":return e.stop()}}),e,this,[[15,26,29,32]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"handleReceivedSubscription",value:function(e,t,r){this.log("subscription update from %p topic %s",e,t);var n=this.topics.get(t);null==n&&(n=new Set,this.topics.set(t,n)),r?n.add(e.toString()):n.delete(e.toString())}},{key:"handleReceivedMessage",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,n){var i,a,s,o,u;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(i=this.metrics)||void 0===i||i.onMsgRecvPreValidation(n.topic),e.next=3,this.validateReceivedMessage(t,n);case 3:o=e.sent,null===(a=this.metrics)||void 0===a||a.onPrevalidationResult(n.topic,o.code),e.t0=o.code,e.next=e.t0===_x.duplicate?8:e.t0===_x.invalid?12:e.t0===_x.valid?15:20;break;case 8:return this.score.duplicateMessage(t.toString(),o.msgIdStr,n.topic),this.gossipTracer.deliverMessage(o.msgIdStr,!0),this.mcache.observeDuplicate(o.msgIdStr,t.toString()),e.abrupt("return");case 12:return o.msgIdStr?(u=o.msgIdStr,this.score.rejectMessage(t.toString(),u,n.topic,o.reason),this.gossipTracer.rejectMessage(u,o.reason)):this.score.rejectInvalidMessage(t.toString(),n.topic),null===(s=this.metrics)||void 0===s||s.onMsgRecvInvalid(n.topic,o),e.abrupt("return");case 15:this.score.validateMessage(o.messageId.msgIdStr),this.gossipTracer.deliverMessage(o.messageId.msgIdStr),this.mcache.put(o.messageId,n,!this.opts.asyncValidation),this.subscriptions.has(n.topic)&&(this.components.peerId.equals(t)&&!this.opts.emitSelf||(yo(aa(r.prototype),"dispatchEvent",this).call(this,new By("gossipsub:message",{detail:{propagationSource:t,msgId:o.messageId.msgIdStr,msg:o.msg}})),yo(aa(r.prototype),"dispatchEvent",this).call(this,new By("message",{detail:o.msg})))),this.opts.asyncValidation||this.forwardMessage(o.messageId.msgIdStr,n,t.toString());case 20:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"validateReceivedMessage",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c,l,h,f,d,p,v;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null===(n=this.fastMsgIdFn)||void 0===n?void 0:n.call(this,r),!(s=void 0!==a?null===(i=this.fastMsgIdCache)||void 0===i?void 0:i.get(a):void 0)){e.next=4;break}return e.abrupt("return",{code:_x.duplicate,msgIdStr:s});case 4:return e.next=6,eE(this.globalSignaturePolicy,r);case 6:if((o=e.sent).valid){e.next=9;break}return e.abrupt("return",{code:_x.invalid,reason:mx.Error,error:o.error});case 9:u=o.message,e.prev=10,this.dataTransform&&(u.data=this.dataTransform.inboundTransform(r.topic,u.data)),e.next=18;break;case 14:return e.prev=14,e.t0=e.catch(10),this.log("Invalid message, transform failed",e.t0),e.abrupt("return",{code:_x.invalid,reason:mx.Error,error:bx.TransformFailed});case 18:return e.next=20,this.msgIdFn(u);case 20:if(c=e.sent,l=this.msgIdToStrFn(c),h={msgId:c,msgIdStr:l},void 0!==a&&this.fastMsgIdCache&&this.fastMsgIdCache.put(a,l)&&(null===(f=this.metrics)||void 0===f||f.fastMsgIdCacheCollision.inc()),!this.seenCache.has(l)){e.next=28;break}return e.abrupt("return",{code:_x.duplicate,msgIdStr:l});case 28:this.seenCache.put(l);case 29:if(null==(d=this.topicValidators.get(r.topic))){e.next=44;break}return e.prev=31,e.next=34,d(t,u);case 34:p=e.sent,e.next=42;break;case 37:e.prev=37,e.t1=e.catch(31),"ERR_TOPIC_VALIDATOR_IGNORE"===(v=e.t1.code)&&(p=vx.Ignore),p="ERR_TOPIC_VALIDATOR_REJECT"===v?vx.Reject:vx.Ignore;case 42:if(p===vx.Accept){e.next=44;break}return e.abrupt("return",{code:_x.invalid,reason:xx(p),msgIdStr:l});case 44:return e.abrupt("return",{code:_x.valid,messageId:h,msg:u});case 45:case"end":return e.stop()}}),e,this,[[10,14],[31,37]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getScore",value:function(e){return this.score.score(e)}},{key:"sendSubscriptions",value:function(e,t,r){this.sendRpc(e,{subscriptions:t.map((function(e){return{topic:e,subscribe:r}}))})}},{key:"handleControlMessage",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==r){e.next=2;break}return e.abrupt("return");case 2:if(i=r.ihave?this.handleIHave(t,r.ihave):[],a=r.iwant?this.handleIWant(t,r.iwant):[],!r.graft){e.next=10;break}return e.next=7,this.handleGraft(t,r.graft);case 7:e.t0=e.sent,e.next=11;break;case 10:e.t0=[];case 11:if(s=e.t0,e.t1=r.prune,!e.t1){e.next=16;break}return e.next=16,this.handlePrune(t,r.prune);case 16:if(i.length||a.length||s.length){e.next=18;break}return e.abrupt("return");case 18:o=this.sendRpc(t,{messages:a,control:{iwant:i,prune:s}}),(u=null===(n=i[0])||void 0===n?void 0:n.messageIDs)&&(o?this.gossipTracer.addPromise(t,u):null===(c=this.metrics)||void 0===c||c.iwantPromiseUntracked.inc(1));case 21:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"acceptFrom",value:function(e){if(this.direct.has(e))return!0;var t=Date.now(),r=this.acceptFromWhitelist.get(e);if(r&&r.messagesAccepted<128&&r.acceptUntil>=t)return r.messagesAccepted+=1,!0;var n=this.score.score(e);return n>=0?this.acceptFromWhitelist.set(e,{messagesAccepted:0,acceptUntil:t+1e3}):this.acceptFromWhitelist.delete(e),n>=this.opts.scoreThresholds.graylistThreshold}},{key:"handleIHave",value:function(e,t){var r,n,i=this;if(!t.length)return[];var a,s=this.score.score(e);if(s<this.opts.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,s),null===(a=this.metrics)||void 0===a||a.ihaveRcvIgnored.inc({reason:Wx.LowScore}),[];var o,u=(null!==(r=this.peerhave.get(e))&&void 0!==r?r:0)+1;if(this.peerhave.set(e,u),u>10)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,u),null===(o=this.metrics)||void 0===o||o.ihaveRcvIgnored.inc({reason:Wx.MaxIhave}),[];var c,l=null!==(n=this.iasked.get(e))&&void 0!==n?n:0;if(l>=fx)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,l),null===(c=this.metrics)||void 0===c||c.ihaveRcvIgnored.inc({reason:Wx.MaxIasked}),[];var h=new Map;if(t.forEach((function(e){var t,r=e.topicID,n=e.messageIDs;if(r&&n&&i.mesh.has(r)){var a=0;n.forEach((function(e){var t=i.msgIdToStrFn(e);i.seenCache.has(t)||(h.set(t,e),a++)})),null===(t=i.metrics)||void 0===t||t.onIhaveRcv(r,n.length,a)}})),!h.size)return[];var f=h.size;f+l>fx&&(f=fx-l),this.log("IHAVE: Asking for %d out of %d messages from %s",f,h.size,e);var d=Array.from(h.values());return dx(d),d=d.slice(0,f),this.iasked.set(e,l+f),[{messageIDs:d}]}},{key:"handleIWant",value:function(e,t){var r,n=this;if(!t.length)return[];var i=this.score.score(e);if(i<this.opts.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,i),[];var a=new Map,s=new Map,o=0;return t.forEach((function(t){var r=t.messageIDs;r&&r.forEach((function(t){var r,i=n.msgIdToStrFn(t),u=n.mcache.getWithIWantCount(i,e);null!=u?(s.set(u.msg.topic,1+(null!==(r=s.get(u.msg.topic))&&void 0!==r?r:0)),u.count>3?n.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,t):a.set(i,u.msg)):o++}))})),null===(r=this.metrics)||void 0===r||r.onIwantRcv(s,o),a.size?(this.log("IWANT: Sending %d messages to %s",a.size,e),Array.from(a.values())):(this.log("IWANT: Could not provide any wanted messages to %s",e),[])}},{key:"handleGraft",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],i=this.score.score(t),a=Date.now(),s=this.opts.doPX,r.forEach((function(e){var r,u,c=e.topicID;if(c){var l=o.mesh.get(c);if(l){if(!l.has(t)){if(o.direct.has(t))return o.log("GRAFT: ignoring request from direct peer %s",t),n.push(c),void(s=!1);var h=null===(r=o.backoff.get(c))||void 0===r?void 0:r.get(t);if("number"===typeof h&&a<h){o.log("GRAFT: ignoring backed off peer %s",t),o.score.addPenalty(t,1,Hx.GraftBackoff),s=!1;var f=h+o.opts.graftFloodThreshold-o.opts.pruneBackoff;return a<f&&o.score.addPenalty(t,1,Hx.GraftBackoff),o.addBackoff(t,c),void n.push(c)}if(i<0)return o.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",t,i,c),n.push(c),s=!1,void o.addBackoff(t,c);if(l.size>=o.opts.Dhi&&!o.outbound.get(t))return n.push(c),void o.addBackoff(t,c);o.log("GRAFT: Add mesh link from %s in %s",t,c),o.score.graft(t,c),l.add(t),null===(u=o.metrics)||void 0===u||u.onAddToMesh(c,zx.Subscribed,1)}}else s=!1}})),n.length){e.next=7;break}return e.abrupt("return",[]);case 7:return!1,e.next=10,Promise.all(n.map((function(e){return o.makePrune(t,e,s,false)})));case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"handlePrune",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c,l,h;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.score.score(t),i=(0,ge.Z)(r),e.prev=2,i.s();case 4:if((a=i.n()).done){e.next=23;break}if(s=a.value,o=s.topicID,u=s.backoff,c=s.peers,null!=o){e.next=8;break}return e.abrupt("continue",21);case 8:if(l=this.mesh.get(o)){e.next=11;break}return e.abrupt("return");case 11:if(this.log("PRUNE: Remove mesh link to %s in %s",t,o),this.score.prune(t,o),l.has(t)&&(l.delete(t),null===(h=this.metrics)||void 0===h||h.onRemoveFromMesh(o,jx.Prune,1)),"number"===typeof u&&u>0?this.doAddBackoff(t,o,1e3*u):this.addBackoff(t,o),!c||!c.length){e.next=21;break}if(!(n<this.opts.scoreThresholds.acceptPXThreshold)){e.next=19;break}return this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",t,n,o),e.abrupt("continue",21);case 19:return e.next=21,this.pxConnect(c);case 21:e.next=4;break;case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(2),i.e(e.t0);case 28:return e.prev=28,i.f(),e.finish(28);case 31:case"end":return e.stop()}}),e,this,[[2,25,28,31]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"addBackoff",value:function(e,t){this.doAddBackoff(e,t,this.opts.pruneBackoff)}},{key:"doAddBackoff",value:function(e,t,r){var n,i=this.backoff.get(t);i||(i=new Map,this.backoff.set(t,i));var a=Date.now()+r;(null!==(n=i.get(e))&&void 0!==n?n:0)<a&&i.set(e,a)}},{key:"applyIwantPenalties",value:function(){var e=this;this.gossipTracer.getBrokenPromises().forEach((function(t,r){e.log("peer %s didn't follow up in %d IWANT requests; adding penalty",r,t),e.score.addPenalty(r,t,Hx.BrokenPromise)}))}},{key:"clearBackoff",value:function(){var e=this;if(this.heartbeatTicks%15===0){var t=Date.now();this.backoff.forEach((function(r,n){r.forEach((function(n,i){n+1*e.opts.heartbeatInterval<t&&r.delete(i)})),0===r.size&&e.backoff.delete(n)}))}}},{key:"directConnect",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],this.direct.forEach((function(e){r.streamsOutbound.has(e)||t.push(e)})),e.next=4,Promise.all(t.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.connect(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pxConnect",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.length>this.opts.prunePeers&&(dx(t),t=t.slice(0,this.opts.prunePeers)),r=[],e.next=4,Promise.all(t.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.peerID){e.next=2;break}return e.abrupt("return");case 2:if(i=tm(t.peerID),a=i.toString(),!n.peers.has(a)){e.next=6;break}return e.abrupt("return");case 6:if(t.signedPeerRecord){e.next=9;break}return r.push(a),e.abrupt("return");case 9:return e.prev=9,e.next=12,n.components.peerStore.consumePeerRecord(t.signedPeerRecord,i);case 12:if(e.sent){e.next=15;break}return n.log("bogus peer record obtained through px: could not add peer record to address book"),e.abrupt("return");case 15:r.push(a),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(9),n.log("bogus peer record obtained through px: invalid signature or not a peer record");case 21:case"end":return e.stop()}}),e,null,[[9,18]])})));return function(t){return e.apply(this,arguments)}}()));case 4:if(r.length){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,Promise.all(r.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.connect(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"connect",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c,l;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.log("Initiating connection with %s",t),r=em(t),e.next=4,this.components.connectionManager.openConnection(r);case 4:n=e.sent,i=(0,ge.Z)(this.multicodecs);try{for(i.s();!(a=i.n()).done;){s=a.value,o=(0,ge.Z)(this.components.registrar.getTopologies(s));try{for(o.s();!(u=o.n()).done;)l=u.value,null===(c=l.onConnect)||void 0===c||c.call(l,r,n)}catch(S$){o.e(S$)}finally{o.f()}}}catch(S$){i.e(S$)}finally{i.f()}case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"subscribe",value:function(e){if(this.status.code!==_E.started)throw new Error("Pubsub has not started");if(!this.subscriptions.has(e)){this.subscriptions.add(e);var t,r=(0,ge.Z)(this.peers.keys());try{for(r.s();!(t=r.n()).done;){var n=t.value;this.sendSubscriptions(n,[e],!0)}}catch(S$){r.e(S$)}finally{r.f()}}this.join(e)}},{key:"unsubscribe",value:function(e){if(this.status.code!==_E.started)throw new Error("Pubsub is not started");var t=this.subscriptions.delete(e);if(this.log("unsubscribe from %s - am subscribed %s",e,t),t){var r,n=(0,ge.Z)(this.peers.keys());try{for(n.s();!(r=n.n()).done;){var i=r.value;this.sendSubscriptions(i,[e],!1)}}catch(S$){n.e(S$)}finally{n.f()}}this.leave(e)}},{key:"join",value:function(e){var t,r=this;if(this.status.code!==_E.started)throw new Error("Gossipsub has not started");if(!this.mesh.has(e)){this.log("JOIN %s",e),null===(t=this.metrics)||void 0===t||t.onJoin(e);var n,i=new Set,a=this.backoff.get(e),s=this.fanout.get(e);if(s)this.fanout.delete(e),this.fanoutLastpub.delete(e),s.forEach((function(e){r.direct.has(e)||!(r.score.score(e)>=0)||a&&a.has(e)||i.add(e)})),null===(n=this.metrics)||void 0===n||n.onAddToMesh(e,zx.Fanout,i.size);if(i.size<this.opts.D){var o,u=i.size;this.getRandomGossipPeers(e,this.opts.D,(function(e){return!i.has(e)&&!r.direct.has(e)&&r.score.score(e)>=0&&(!a||!a.has(e))})).forEach((function(e){i.add(e)})),null===(o=this.metrics)||void 0===o||o.onAddToMesh(e,zx.Random,i.size-u)}this.mesh.set(e,i),i.forEach((function(t){r.log("JOIN: Add mesh link to %s in %s",t,e),r.sendGraft(t,e)}))}}},{key:"leave",value:function(e){var t,r=this;if(this.status.code!==_E.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e),null===(t=this.metrics)||void 0===t||t.onLeave(e);var n=this.mesh.get(e);n&&(Promise.all(Array.from(n).map(function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(n){return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.log("LEAVE: Remove mesh link to %s in %s",n,e),t.next=3,r.sendPrune(n,e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())).catch((function(e){r.log("Error sending prunes to mesh peers",e)})),this.mesh.delete(e))}},{key:"selectPeersToForward",value:function(e,t,r){var n=this,i=new Set,a=this.topics.get(e);a&&(this.direct.forEach((function(e){!a.has(e)||t===e||null!==r&&void 0!==r&&r.has(e)||i.add(e)})),this.floodsubPeers.forEach((function(e){a.has(e)&&t!==e&&(null===r||void 0===r||!r.has(e))&&n.score.score(e)>=n.opts.scoreThresholds.publishThreshold&&i.add(e)})));var s=this.mesh.get(e);return s&&s.size>0&&s.forEach((function(e){t===e||null!==r&&void 0!==r&&r.has(e)||i.add(e)})),i}},{key:"selectPeersToPublish",value:function(e){var t=this,r=new Set,n={direct:0,floodsub:0,mesh:0,fanout:0},i=this.topics.get(e);if(i)if(this.opts.floodPublish)i.forEach((function(e){t.direct.has(e)?(r.add(e),n.direct++):t.score.score(e)>=t.opts.scoreThresholds.publishThreshold&&(r.add(e),n.floodsub++)}));else{this.direct.forEach((function(e){i.has(e)&&(r.add(e),n.direct++)})),this.floodsubPeers.forEach((function(e){i.has(e)&&t.score.score(e)>=t.opts.scoreThresholds.publishThreshold&&(r.add(e),n.floodsub++)}));var a=this.mesh.get(e);if(a&&a.size>0)a.forEach((function(e){r.add(e),n.mesh++}));else{var s=this.fanout.get(e);if(s&&s.size>0)s.forEach((function(e){r.add(e),n.fanout++}));else{var o=this.getRandomGossipPeers(e,this.opts.D,(function(e){return t.score.score(e)>=t.opts.scoreThresholds.publishThreshold}));o.size>0&&(this.fanout.set(e,o),o.forEach((function(e){r.add(e),n.fanout++})))}this.fanoutLastpub.set(e,Date.now())}}return{tosend:r,tosendCount:n}}},{key:"forwardMessage",value:function(e,t,r,n){var i,a=this;r&&this.score.deliverMessage(r,e,t.topic);var s=this.selectPeersToForward(t.topic,r,n);s.forEach((function(e){a.sendRpc(e,{messages:[t]})})),null===(i=this.metrics)||void 0===i||i.onForwardMsg(t.topic,s.size)}},{key:"publish",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,n,i){var a,s,o,u,c,l,h,f,d,p,v,g,y,m,b,_,w,k,x,E,S;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=Date.now(),c=this.dataTransform?this.dataTransform.outboundTransform(t,n):n,null!=this.publishConfig){e.next=4;break}throw Error("PublishError.Uninitialized");case 4:return e.next=6,Jx(this.publishConfig,t,n,c);case 6:return l=e.sent,h=l.raw,f=l.msg,e.next=11,this.msgIdFn(f);case 11:if(d=e.sent,p=this.msgIdToStrFn(d),v=null!==(a=null===i||void 0===i?void 0:i.ignoreDuplicatePublishError)&&void 0!==a?a:this.opts.ignoreDuplicatePublishError,!this.seenCache.has(p)){e.next=19;break}if(!v){e.next=18;break}return null===(g=this.metrics)||void 0===g||g.onPublishDuplicateMsg(t),e.abrupt("return",{recipients:[]});case 18:throw Error("PublishError.Duplicate");case 19:if(y=this.selectPeersToPublish(t),m=y.tosend,b=y.tosendCount,_=!0===this.opts.emitSelf&&this.subscriptions.has(t),w=null!==(s=null===i||void 0===i?void 0:i.allowPublishToZeroPeers)&&void 0!==s?s:this.opts.allowPublishToZeroPeers,0!==m.size||w||_){e.next=24;break}throw Error("PublishError.InsufficientPeers");case 24:this.seenCache.put(p),this.mcache.put({msgId:d,msgIdStr:p},h,!0),this.publishedMessageIds.put(p),k=(0,ge.Z)(m);try{for(k.s();!(x=k.n()).done;)E=x.value,this.sendRpc(E,{messages:[h]})||m.delete(E)}catch(S$){k.e(S$)}finally{k.f()}return S=Date.now()-u,null===(o=this.metrics)||void 0===o||o.onPublishMsg(t,b,m.size,null!=h.data?h.data.length:0,S),_&&(m.add(this.components.peerId.toString()),yo(aa(r.prototype),"dispatchEvent",this).call(this,new By("gossipsub:message",{detail:{propagationSource:this.components.peerId,msgId:p,msg:f}})),yo(aa(r.prototype),"dispatchEvent",this).call(this,new By("message",{detail:f}))),e.abrupt("return",{recipients:Array.from(m.values()).map((function(e){return em(e)}))});case 33:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"reportMessageValidationResult",value:function(e,t,r){var n,i;if(r===vx.Accept){if(null!=(i=this.mcache.validate(e))){var a=i,s=a.message,o=a.originatingPeers;this.score.deliverMessage(t,e,s.topic),this.forwardMessage(e,i.message,t,o)}}else if(i=this.mcache.remove(e)){var u=xx(r),c=i,l=c.message,h=c.originatingPeers;this.score.rejectMessage(t,e,l.topic,u);var f,d=(0,ge.Z)(h);try{for(d.s();!(f=d.n()).done;){var p=f.value;this.score.rejectMessage(p,e,l.topic,u)}}catch(S$){d.e(S$)}finally{d.f()}}var v=this.score.messageFirstSeenTimestampMs(e);null===(n=this.metrics)||void 0===n||n.onReportValidation(i,r,v)}},{key:"sendGraft",value:function(e,t){var r=[{topicID:t}];this.sendRpc(e,{control:{graft:r}})}},{key:"sendPrune",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!0,e.next=3,this.makePrune(t,r,this.opts.doPX,true);case 3:e.t0=e.sent,n=[e.t0],this.sendRpc(t,{control:{prune:n}});case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"sendRpc",value:function(e,t){var r,n=this.streamsOutbound.get(e);if(!n)return this.log("Cannot send RPC to ".concat(e," as there is no open stream to it available")),!1;var i=this.control.get(e);i&&(this.piggybackControl(e,t,i),this.control.delete(e));var a=this.gossip.get(e);a&&(this.piggybackGossip(e,t,a),this.gossip.delete(e));var s=ux.encode(t).finish();try{n.push(s)}catch(o){return this.log.error("Cannot send rpc to ".concat(e),o),i&&this.control.set(e,i),a&&this.gossip.set(e,a),!1}return null===(r=this.metrics)||void 0===r||r.onRpcSent(t,s.length),!0}},{key:"piggybackControl",value:function(e,t,r){if(r.graft){t.control||(t.control={}),t.control.graft||(t.control.graft=[]);var n,i=(0,ge.Z)(r.graft);try{for(i.s();!(n=i.n()).done;){var a,s=n.value;s.topicID&&null!==(a=this.mesh.get(s.topicID))&&void 0!==a&&a.has(e)&&t.control.graft.push(s)}}catch(S$){i.e(S$)}finally{i.f()}}if(r.prune){t.control||(t.control={}),t.control.prune||(t.control.prune=[]);var o,u=(0,ge.Z)(r.prune);try{for(u.s();!(o=u.n()).done;){var c,l=o.value;!l.topicID||null!==(c=this.mesh.get(l.topicID))&&void 0!==c&&c.has(e)||t.control.prune.push(l)}}catch(S$){u.e(S$)}finally{u.f()}}}},{key:"piggybackGossip",value:function(e,t,r){t.control||(t.control={}),t.control.ihave=r}},{key:"sendGraftPrune",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a,s,o,u,c,l,h,f=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=this.opts.doPX,a=!1,s=(0,ge.Z)(t),e.prev=3,u=(0,ii.Z)().mark((function e(){var t,s,u,c,l,h;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0,ke.Z)(o.value,2),s=t[0],u=t[1],c=u.map((function(e){return{topicID:e}})),l=[],!(h=r.get(s))){e.next=9;break}return e.next=7,Promise.all(h.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.makePrune(s,t,i&&!(null!==(r=n.get(s))&&void 0!==r&&r),a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 7:l=e.sent,r.delete(s);case 9:f.sendRpc(s,{control:{graft:c,prune:l}});case 10:case"end":return e.stop()}}),e)})),s.s();case 6:if((o=s.n()).done){e.next=10;break}return e.delegateYield(u(),"t0",8);case 8:e.next=6;break;case 10:e.next=15;break;case 12:e.prev=12,e.t1=e.catch(3),s.e(e.t1);case 15:return e.prev=15,s.f(),e.finish(15);case 18:c=(0,ge.Z)(r),e.prev=19,h=(0,ii.Z)().mark((function e(){var t,r,s,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,ke.Z)(l.value,2),r=t[0],s=t[1],e.next=3,Promise.all(s.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.makePrune(r,t,i&&!(null!==(s=n.get(r))&&void 0!==s&&s),a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:o=e.sent,f.sendRpc(r,{control:{prune:o}});case 5:case"end":return e.stop()}}),e)})),c.s();case 22:if((l=c.n()).done){e.next=26;break}return e.delegateYield(h(),"t2",24);case 24:e.next=22;break;case 26:e.next=31;break;case 28:e.prev=28,e.t3=e.catch(19),c.e(e.t3);case 31:return e.prev=31,c.f(),e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[3,12,15,18],[19,28,31,34]])})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"emitGossip",value:function(e){var t,r=this.mcache.getGossipIDs(new Set(e.keys())),n=(0,ge.Z)(e);try{for(n.s();!(t=n.n()).done;){var i,a=(0,ke.Z)(t.value,2),s=a[0],o=a[1];this.doEmitGossip(s,o,null!==(i=r.get(s))&&void 0!==i?i:[])}}catch(S$){n.e(S$)}finally{n.f()}}},{key:"doEmitGossip",value:function(e,t,r){var n=this;if(r.length&&(dx(r),r.length>fx&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",r.length),t.size)){var i=this.opts.Dlazy,a=.25*t.size,s=t;a>i&&(i=a),i>s.size?i=s.size:s=dx(Array.from(s)).slice(0,i),s.forEach((function(t){var i=r;r.length>fx&&(i=dx(i.slice()).slice(0,fx)),n.pushGossip(t,{topicID:e,messageIDs:i})}))}}},{key:"flush",value:function(){var e,t=(0,ge.Z)(this.gossip.entries());try{for(t.s();!(e=t.n()).done;){var r=(0,ke.Z)(e.value,2),n=r[0],i=r[1];this.gossip.delete(n),this.sendRpc(n,{control:{ihave:i}})}}catch(S$){t.e(S$)}finally{t.f()}var a,s=(0,ge.Z)(this.control.entries());try{for(s.s();!(a=s.n()).done;){var o=(0,ke.Z)(a.value,2),u=o[0],c=o[1];this.control.delete(u),this.sendRpc(u,{control:{graft:c.graft,prune:c.prune}})}}catch(S$){s.e(S$)}finally{s.f()}}},{key:"pushGossip",value:function(e,t){this.log("Add gossip to %s",e);var r=this.gossip.get(e)||[];this.gossip.set(e,r.concat(t))}},{key:"makePrune",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i){var a,s,o,u,c=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.score.prune(t,r),this.streamsOutbound.get(t).protocol!==lx){e.next=3;break}return e.abrupt("return",{topicID:r,peers:[]});case 3:if(a=i?this.opts.unsubcribeBackoff:this.opts.pruneBackoff,s=a/1e3,this.doAddBackoff(t,r,a),n){e.next=8;break}return e.abrupt("return",{topicID:r,peers:[],backoff:s});case 8:return o=this.getRandomGossipPeers(r,this.opts.prunePeers,(function(e){return e!==t&&c.score.score(e)>=0})),e.next=11,Promise.all(Array.from(o).map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=em(t),e.prev=1,e.next=4,c.components.peerStore.get(n);case 4:i=e.sent,e.next=11;break;case 7:if(e.prev=7,e.t0=e.catch(1),"ERR_NOT_FOUND"===e.t0.code){e.next=11;break}throw e.t0;case 11:return e.abrupt("return",{peerID:n.toBytes(),signedPeerRecord:null===(r=i)||void 0===r?void 0:r.peerRecordEnvelope});case 12:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()));case 11:return u=e.sent,e.abrupt("return",{topicID:r,peers:u,backoff:s});case 13:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i){return e.apply(this,arguments)}}()},{key:"heartbeat",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i,a,s,o,u,c,l,h,f,d,p,v,g,y=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.opts,i=n.D,a=n.Dlo,s=n.Dhi,o=n.Dscore,u=n.Dout,c=n.fanoutTTL,this.heartbeatTicks++,l=new Map,h=function(e){var t=l.get(e);return void 0===t&&(t=y.score.score(e),l.set(e,t)),t},f=new Map,d=new Map,p=new Map,this.clearBackoff(),this.peerhave.clear(),null===(t=this.metrics)||void 0===t||t.cacheSize.set({cache:"iasked"},this.iasked.size),this.iasked.clear(),this.applyIwantPenalties(),this.heartbeatTicks%this.opts.directConnectTicks!==0){e.next=15;break}return e.next=15,this.directConnect();case 15:return null===(r=this.fastMsgIdCache)||void 0===r||r.prune(),this.seenCache.prune(),this.gossipTracer.prune(),this.publishedMessageIds.prune(),v=new Map,this.mesh.forEach((function(e,t){var r=y.topics.get(t),n=new Set,c=new Set;if(v.set(t,c),r){var l,g=dx(Array.from(r)),m=y.backoff.get(t),b=(0,ge.Z)(g);try{for(b.s();!(l=b.n()).done;){var _=l.value,w=y.streamsOutbound.get(_);if(w&&y.multicodecs.includes(w.protocol)&&!e.has(_)&&!y.direct.has(_)){var k=h(_);m&&m.has(_)||!(k>=0)||n.add(_),k>=y.opts.scoreThresholds.gossipThreshold&&c.add(_)}}}catch(S$){b.e(S$)}finally{b.f()}}var x=function(r,n){var i;y.log("HEARTBEAT: Remove mesh link to %s in %s",r,t),y.addBackoff(r,t),e.delete(r),h(r)>=y.opts.scoreThresholds.gossipThreshold&&c.add(r),null===(i=y.metrics)||void 0===i||i.onRemoveFromMesh(t,n,1);var a=d.get(r);a?a.push(t):d.set(r,[t])},E=function(r,n){var i;y.log("HEARTBEAT: Add mesh link to %s in %s",r,t),y.score.graft(r,t),e.add(r),c.delete(r),null===(i=y.metrics)||void 0===i||i.onAddToMesh(t,n,1);var a=f.get(r);a?a.push(t):f.set(r,[t])};(e.forEach((function(e){var r=h(e);r<0&&(y.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",e,r,t),x(e,jx.BadScore),p.set(e,!0))})),e.size<a)&&Fx(n,i-e.size).forEach((function(e){E(e,zx.NotEnough)}));if(e.size>s){var S=Array.from(e);S.sort((function(e,t){return h(t)-h(e)})),S=S.slice(0,o).concat(dx(S.slice(o)));var C=0;if(S.slice(0,i).forEach((function(e){y.outbound.get(e)&&C++})),C<u){var A=function(e){for(var t=S[e],r=e;r>0;r--)S[r]=S[r-1];S[0]=t};if(C>0)for(var D=C,R=1;R<i&&D>0;R++)y.outbound.get(S[R])&&(A(R),D--);for(var T=i-C,Z=i;Z<S.length&&T>0;Z++)y.outbound.get(S[Z])&&(A(Z),T--)}S.slice(i).forEach((function(e){x(e,jx.Excess)}))}if(e.size>=a){var I=0;if(e.forEach((function(e){y.outbound.get(e)&&I++})),I<u){var P=Nx(n,u-I,(function(e){return!0===y.outbound.get(e)}));P.forEach((function(e){E(e,zx.Outbound)}))}}if(y.heartbeatTicks%y.opts.opportunisticGraftTicks===0&&e.size>1){var L=Array.from(e).sort((function(e,t){return h(e)-h(t)})),M=Math.floor(e.size/2),B=h(L[M]);if(B<y.opts.scoreThresholds.opportunisticGraftThreshold){var O,N=Nx(n,y.opts.opportunisticGraftPeers,(function(e){return h(e)>B})),F=(0,ge.Z)(N);try{for(F.s();!(O=F.n()).done;){var U=O.value;y.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",U,t),E(U,zx.Opportunistic)}}catch(S$){F.e(S$)}finally{F.f()}}}})),g=Date.now(),this.fanoutLastpub.forEach((function(e,t){e+c<g&&(y.fanout.delete(t),y.fanoutLastpub.delete(t))})),this.fanout.forEach((function(e,t){var r=y.topics.get(t);e.forEach((function(t){(!r.has(t)||h(t)<y.opts.scoreThresholds.publishThreshold)&&e.delete(t)}));var n=y.topics.get(t),a=[],s=new Set;if(v.set(t,s),n){var o,u=dx(Array.from(n)),c=(0,ge.Z)(u);try{for(c.s();!(o=c.n()).done;){var l=o.value,f=y.streamsOutbound.get(l);if(f&&y.multicodecs.includes(f.protocol)&&!e.has(l)&&!y.direct.has(l)){var d=h(l);d>=y.opts.scoreThresholds.publishThreshold&&a.push(l),d>=y.opts.scoreThresholds.gossipThreshold&&s.add(l)}}}catch(S$){c.e(S$)}finally{c.f()}}if(e.size<i){var p=i-e.size;a.slice(0,p).forEach((function(t){e.add(t),null===s||void 0===s||s.delete(t)}))}})),this.emitGossip(v),e.next=27,this.sendGraftPrune(f,d,p);case 27:this.flush(),this.mcache.shift(),this.dispatchEvent(new By("gossipsub:heartbeat"));case 30:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getRandomGossipPeers",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!0},i=this.topics.get(e);if(!i)return new Set;var a=[];return i.forEach((function(e){var t=r.streamsOutbound.get(e);t&&r.multicodecs.includes(t.protocol)&&n(e)&&a.push(e)})),a=dx(a),t>0&&a.length>t&&(a=a.slice(0,t)),new Set(a)}},{key:"onScrapeMetrics",value:function(e){var t,r;e.mcacheSize.set(this.mcache.size),e.mcacheNotValidatedCount.set(this.mcache.notValidatedCount),e.cacheSize.set({cache:"direct"},this.direct.size),e.cacheSize.set({cache:"seenCache"},this.seenCache.size),e.cacheSize.set({cache:"fastMsgIdCache"},null!==(t=null===(r=this.fastMsgIdCache)||void 0===r?void 0:r.size)&&void 0!==t?t:0),e.cacheSize.set({cache:"publishedMessageIds"},this.publishedMessageIds.size),e.cacheSize.set({cache:"mcache"},this.mcache.size),e.cacheSize.set({cache:"score"},this.score.size),e.cacheSize.set({cache:"gossipTracer.promises"},this.gossipTracer.size),e.cacheSize.set({cache:"gossipTracer.requests"},this.gossipTracer.requestMsByMsgSize),e.cacheSize.set({cache:"topics"},this.topics.size),e.cacheSize.set({cache:"subscriptions"},this.subscriptions.size),e.cacheSize.set({cache:"mesh"},this.mesh.size),e.cacheSize.set({cache:"fanout"},this.fanout.size),e.cacheSize.set({cache:"peers"},this.peers.size),e.cacheSize.set({cache:"streamsOutbound"},this.streamsOutbound.size),e.cacheSize.set({cache:"streamsInbound"},this.streamsInbound.size),e.cacheSize.set({cache:"acceptFromWhitelist"},this.acceptFromWhitelist.size),e.cacheSize.set({cache:"gossip"},this.gossip.size),e.cacheSize.set({cache:"control"},this.control.size),e.cacheSize.set({cache:"peerhave"},this.peerhave.size),e.cacheSize.set({cache:"outbound"},this.outbound.size);var n=0,i=Date.now();e.connectedPeersBackoffSec.reset();var a,s=(0,ge.Z)(this.backoff.values());try{for(s.s();!(a=s.n()).done;){var o=a.value;n+=o.size;var u,c=(0,ge.Z)(o.entries());try{for(c.s();!(u=c.n()).done;){var l=(0,ke.Z)(u.value,2),h=l[0],f=l[1];this.peers.has(h)&&e.connectedPeersBackoffSec.observe(Math.max(0,f-i)/1e3)}}catch(S$){c.e(S$)}finally{c.f()}}}catch(S$){s.e(S$)}finally{s.f()}e.cacheSize.set({cache:"backoff"},n);var d,p=(0,ge.Z)(this.topics);try{for(p.s();!(d=p.n()).done;){var v=(0,ke.Z)(d.value,2),g=v[0],y=v[1];e.topicPeersCount.set({topicStr:g},y.size)}}catch(S$){p.e(S$)}finally{p.f()}var m,b=(0,ge.Z)(this.mesh);try{for(b.s();!(m=b.n()).done;){var _=(0,ke.Z)(m.value,2),w=_[0],k=_[1];e.meshPeerCounts.set({topicStr:w},k.size)}}catch(S$){b.e(S$)}finally{b.f()}var x=[],E=new Map;e.behaviourPenalty.reset();var S,C=(0,ge.Z)(this.peers.keys());try{for(C.s();!(S=C.n()).done;){var A,D,R=S.value,T=this.score.score(R);x.push(T),E.set(R,T),e.behaviourPenalty.observe(null!==(A=null===(D=this.score.peerStats.get(R))||void 0===D?void 0:D.behaviourPenalty)&&void 0!==A?A:0)}}catch(S$){C.e(S$)}finally{C.f()}e.registerScores(x,this.opts.scoreThresholds),e.registerScorePerMesh(this.mesh,E);var Z=function(e,t,r,n,i){var a,s={byTopic:new Map,p5w:[],p6w:[],p7w:[],score:[]},o=(0,ge.Z)(e);try{for(o.s();!(a=o.n()).done;){var u=a.value,c=t.get(u);if(c){var l,h=aE(u,c,r,n,i),f=(0,ge.Z)(h.byTopic);try{for(f.s();!(l=f.n()).done;){var d=(0,ke.Z)(l.value,2),p=d[0],v=d[1],g=s.byTopic.get(p);g||(g={p1w:[],p2w:[],p3w:[],p3bw:[],p4w:[]},s.byTopic.set(p,g)),g.p1w.push(v.p1w),g.p2w.push(v.p2w),g.p3w.push(v.p3w),g.p3bw.push(v.p3bw),g.p4w.push(v.p4w)}}catch(S$){f.e(S$)}finally{f.f()}s.p5w.push(h.p5w),s.p6w.push(h.p6w),s.p7w.push(h.p7w),s.score.push(h.score)}else s.p5w.push(0),s.p6w.push(0),s.p7w.push(0),s.score.push(0)}}catch(S$){o.e(S$)}finally{o.f()}return s}(this.peers.keys(),this.score.peerStats,this.score.params,this.score.peerIPs,e.topicStrToLabel);e.registerScoreWeights(Z)}}]),r}(Ly);function kE(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){return new wE(t,e)}}(0,we.Z)(wE,"multicodec",hx);var xE=function(e){ia(r,e);var t=ua(r);function r(e,n){var i;return(0,hi.Z)(this,r),i=t.call(this,e),(0,we.Z)(ra(i),"code",void 0),i.code=n,i}return(0,fi.Z)(r)}(es(Error)),EE=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),n=t.call(this,e,"ABORT_ERR"),(0,we.Z)(ra(n),"type",void 0),n.type="aborted",n}return(0,fi.Z)(r)}(xE);var SE,CE=function(e){ia(r,e);var t=ua(r);function r(e,n){var i;return(0,hi.Z)(this,r),i=t.call(this,e),(0,we.Z)(ra(i),"code",void 0),i.code=n,i}return(0,fi.Z)(r)}(es(Error)),AE=function(e){return xu(e)};function DE(e,t){var r=function(e){var t=as();e.sink(t).catch((function(e){t.end(e)})),e.sink=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(r){var n,i,a,s,o,u;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!1,i=!1,e.prev=2,s=ui(r);case 4:return e.next=6,s.next();case 6:if(!(n=!(o=e.sent).done)){e.next=12;break}u=o.value,t.push(u);case 9:n=!1,e.next=4;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(2),i=!0,a=e.t0;case 18:if(e.prev=18,e.prev=19,!n||null==s.return){e.next=23;break}return e.next=23,s.return();case 23:if(e.prev=23,!i){e.next=26;break}throw a;case 26:return e.finish(23);case 27:return e.finish(18);case 28:t.end();case 29:case"end":return e.stop()}}),e,null,[[2,14,18,28],[19,,23,27]])})));return function(t){return e.apply(this,arguments)}}();var r=e.source;null!=e.source[Symbol.iterator]?r=e.source[Symbol.iterator]():null!=e.source[Symbol.asyncIterator]&&(r=e.source[Symbol.asyncIterator]());var n=new Du,i={read:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,i){var a,s,o,u,c,l,h,f,d,p;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===i||void 0===i||null===(a=i.signal)||void 0===a||a.throwIfAborted(),o=new Promise((function(e,t){var r;s=function(){t(new EE("Read aborted"))},null===i||void 0===i||null===(r=i.signal)||void 0===r||r.addEventListener("abort",s)})),e.prev=2,null!=t){e.next=12;break}return e.next=6,Promise.race([r.next(),o]);case 6:if(u=e.sent,c=u.done,l=u.value,!0!==c){e.next=11;break}return e.abrupt("return",new Du);case 11:return e.abrupt("return",l);case 12:if(!(n.byteLength<t)){e.next=23;break}return e.next=15,Promise.race([r.next(),o]);case 15:if(h=e.sent,f=h.value,!0!==h.done){e.next=20;break}throw new xE("unexpected end of input","ERR_UNEXPECTED_EOF");case 20:n.append(f),e.next=12;break;case 23:return d=n.sublist(0,t),n.consume(t),e.abrupt("return",d);case 26:return e.prev=26,null!=s&&(null===i||void 0===i||null===(p=i.signal)||void 0===p||p.removeEventListener("abort",s)),e.finish(26);case 29:case"end":return e.stop()}}),e,null,[[2,,26,29]])})));return function(t,r){return e.apply(this,arguments)}}(),write:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(r,n){var i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===n||void 0===n||null===(i=n.signal)||void 0===i||i.throwIfAborted(),r instanceof Uint8Array?t.push(r):t.push(r.subarray()),e.next=4,t.onEmpty(n);case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),unwrap:function(){var t=e.source;return e.source=ea((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(Xa(ui(n)),"t0",1);case 1:return e.delegateYield(Xa(ui(t)),"t1",2);case 2:case"end":return e.stop()}}),e)})))(),e}};return i}(e),n={read:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(n){var i,a,s,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=-1,s=new Du,o=null!==(i=null===t||void 0===t?void 0:t.lengthDecoder)&&void 0!==i?i:AE;case 3:return e.t0=s,e.next=7,r.read(1,n);case 7:e.t1=e.sent,e.t0.append.call(e.t0,e.t1),e.prev=9,a=o(s),e.next=18;break;case 13:if(e.prev=13,e.t2=e.catch(9),!(e.t2 instanceof RangeError)){e.next=17;break}return e.abrupt("continue",3);case 17:throw e.t2;case 18:if(!(a>-1)){e.next=20;break}return e.abrupt("break",24);case 20:if(!(null!=(null===t||void 0===t?void 0:t.maxLengthLength)&&s.byteLength>t.maxLengthLength)){e.next=22;break}throw new CE("message length length too long","ERR_MSG_LENGTH_TOO_LONG");case 22:e.next=3;break;case 24:if(!(null!=(null===t||void 0===t?void 0:t.maxDataLength)&&a>t.maxDataLength)){e.next=26;break}throw new CE("message length too long","ERR_MSG_DATA_TOO_LONG");case 26:return e.abrupt("return",r.read(a,n));case 27:case"end":return e.stop()}}),e,null,[[9,13]])})));return function(t){return e.apply(this,arguments)}}(),write:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(n,i){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.write(Zu.single(n,t),i);case 2:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),unwrap:function(){return r.unwrap()}};return n}function RE(){var e=ts(),t=!1;return{sink:function(){var r=(0,ai.Z)((0,ii.Z)().mark((function r(n){return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t){r.next=2;break}throw new Error("already piped");case 2:t=!0,e.resolve(n);case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),source:ea((0,ii.Z)().mark((function t(){var r;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ji(e.promise);case 2:return r=t.sent,t.delegateYield(Xa(ui(r)),"t0",4);case 4:case"end":return t.stop()}}),t)})))()}}function TE(){var e=RE(),t=RE();return[{source:e.source,sink:t.sink},{source:t.source,sink:e.sink}]}AE.bytes=0;var ZE=65535,IE=Boolean(null===(SE=globalThis.process)||void 0===SE||null===(SE=SE.env)||void 0===SE?void 0:SE.DUMP_SESSION_KEYS),PE=function(e){return e instanceof Uint8Array},LE=function(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))};if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");function ME(e){if("string"!==typeof e)throw new Error("utf8ToBytes expected string, got ".concat(typeof e));return new Uint8Array((new TextEncoder).encode(e))}function BE(e){if("string"===typeof e&&(e=ME(e)),!PE(e))throw new Error("expected Uint8Array, got ".concat(typeof e));return e}function OE(e,t){if(void 0!==t&&("object"!==typeof t||(r=t,"[object Object]"!==Object.prototype.toString.call(r)||r.constructor!==Object)))throw new Error("options must be object or undefined");var r;return Object.assign(e,t)}function NE(e,t){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");if("number"===typeof t&&e.length!==t)throw new Error("Uint8Array length ".concat(t," expected"))}function FE(e,t,r,n){if("function"===typeof e.setBigUint64)return e.setBigUint64(t,r,n);var i=BigInt(32),a=BigInt(4294967295),s=Number(r>>i&a),o=Number(r&a),u=n?4:0,c=n?0:4;e.setUint32(t+u,s,n),e.setUint32(t+c,o,n)}function UE(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("Wrong positive integer: ".concat(e))}function zE(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(r.length>0&&!r.includes(e.length))throw new Error("Expected Uint8Array of length ".concat(r,", not of length=").concat(e.length))}var jE={number:UE,bool:function(e){if("boolean"!==typeof e)throw new Error("Expected boolean, not ".concat(e))},bytes:zE,hash:function(e){if("function"!==typeof e||"function"!==typeof e.create)throw new Error("hash must be wrapped by utils.wrapConstructor");UE(e.outputLen),UE(e.blockLen)},exists:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")},output:function(e,t){zE(e);var r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least ".concat(r))}},HE=jE,WE=function(e,t){return 255&e[t++]|(255&e[t++])<<8},qE=function(){function e(t){(0,hi.Z)(this,e),this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,NE(t=BE(t),32);var r=WE(t,0),n=WE(t,2),i=WE(t,4),a=WE(t,6),s=WE(t,8),o=WE(t,10),u=WE(t,12),c=WE(t,14);this.r[0]=8191&r,this.r[1]=8191&(r>>>13|n<<3),this.r[2]=7939&(n>>>10|i<<6),this.r[3]=8191&(i>>>7|a<<9),this.r[4]=255&(a>>>4|s<<12),this.r[5]=s>>>1&8190,this.r[6]=8191&(s>>>14|o<<2),this.r[7]=8065&(o>>>11|u<<5),this.r[8]=8191&(u>>>8|c<<8),this.r[9]=c>>>5&127;for(var l=0;l<8;l++)this.pad[l]=WE(t,16+2*l)}return(0,fi.Z)(e,[{key:"process",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?0:2048,n=this.h,i=this.r,a=i[0],s=i[1],o=i[2],u=i[3],c=i[4],l=i[5],h=i[6],f=i[7],d=i[8],p=i[9],v=WE(e,t+0),g=WE(e,t+2),y=WE(e,t+4),m=WE(e,t+6),b=WE(e,t+8),_=WE(e,t+10),w=WE(e,t+12),k=WE(e,t+14),x=n[0]+(8191&v),E=n[1]+(8191&(v>>>13|g<<3)),S=n[2]+(8191&(g>>>10|y<<6)),C=n[3]+(8191&(y>>>7|m<<9)),A=n[4]+(8191&(m>>>4|b<<12)),D=n[5]+(b>>>1&8191),R=n[6]+(8191&(b>>>14|_<<2)),T=n[7]+(8191&(_>>>11|w<<5)),Z=n[8]+(8191&(w>>>8|k<<8)),I=n[9]+(k>>>5|r),P=0,L=P+x*a+E*(5*p)+S*(5*d)+C*(5*f)+A*(5*h);P=L>>>13,L&=8191;var M=(P+=(L+=D*(5*l)+R*(5*c)+T*(5*u)+Z*(5*o)+I*(5*s))>>>13)+x*s+E*a+S*(5*p)+C*(5*d)+A*(5*f);P=M>>>13,M&=8191,P+=(M+=D*(5*h)+R*(5*l)+T*(5*c)+Z*(5*u)+I*(5*o))>>>13,M&=8191;var B=P+x*o+E*s+S*a+C*(5*p)+A*(5*d);P=B>>>13,B&=8191,P+=(B+=D*(5*f)+R*(5*h)+T*(5*l)+Z*(5*c)+I*(5*u))>>>13,B&=8191;var O=P+x*u+E*o+S*s+C*a+A*(5*p);P=O>>>13,O&=8191,P+=(O+=D*(5*d)+R*(5*f)+T*(5*h)+Z*(5*l)+I*(5*c))>>>13,O&=8191;var N=P+x*c+E*u+S*o+C*s+A*a;P=N>>>13,N&=8191,P+=(N+=D*(5*p)+R*(5*d)+T*(5*f)+Z*(5*h)+I*(5*l))>>>13,N&=8191;var F=P+x*l+E*c+S*u+C*o+A*s;P=F>>>13,F&=8191,P+=(F+=D*a+R*(5*p)+T*(5*d)+Z*(5*f)+I*(5*h))>>>13,F&=8191;var U=P+x*h+E*l+S*c+C*u+A*o;P=U>>>13,U&=8191,P+=(U+=D*s+R*a+T*(5*p)+Z*(5*d)+I*(5*f))>>>13,U&=8191;var z=P+x*f+E*h+S*l+C*c+A*u;P=z>>>13,z&=8191,P+=(z+=D*o+R*s+T*a+Z*(5*p)+I*(5*d))>>>13,z&=8191;var j=P+x*d+E*f+S*h+C*l+A*c;P=j>>>13,j&=8191,P+=(j+=D*u+R*o+T*s+Z*a+I*(5*p))>>>13,j&=8191;var H=P+x*p+E*d+S*f+C*h+A*l;P=H>>>13,H&=8191,P+=(H+=D*c+R*u+T*o+Z*s+I*a)>>>13,H&=8191,L=8191&(P=(P=(P<<2)+P|0)+(L&=8191)|0),M+=P>>>=13,n[0]=L,n[1]=M,n[2]=B,n[3]=O,n[4]=N,n[5]=F,n[6]=U,n[7]=z,n[8]=j,n[9]=H}},{key:"finalize",value:function(){var e=this.h,t=this.pad,r=new Uint16Array(10),n=e[1]>>>13;e[1]&=8191;for(var i=2;i<10;i++)e[i]+=n,n=e[i]>>>13,e[i]&=8191;e[0]+=5*n,n=e[0]>>>13,e[0]&=8191,e[1]+=n,n=e[1]>>>13,e[1]&=8191,e[2]+=n,r[0]=e[0]+5,n=r[0]>>>13,r[0]&=8191;for(var a=1;a<10;a++)r[a]=e[a]+n,n=r[a]>>>13,r[a]&=8191;r[9]-=8192;for(var s=(1^n)-1,o=0;o<10;o++)r[o]&=s;s=~s;for(var u=0;u<10;u++)e[u]=e[u]&s|r[u];e[0]=65535&(e[0]|e[1]<<13),e[1]=65535&(e[1]>>>3|e[2]<<10),e[2]=65535&(e[2]>>>6|e[3]<<7),e[3]=65535&(e[3]>>>9|e[4]<<4),e[4]=65535&(e[4]>>>12|e[5]<<1|e[6]<<14),e[5]=65535&(e[6]>>>2|e[7]<<11),e[6]=65535&(e[7]>>>5|e[8]<<8),e[7]=65535&(e[8]>>>8|e[9]<<5);var c=e[0]+t[0];e[0]=65535&c;for(var l=1;l<8;l++)c=(e[l]+t[l]|0)+(c>>>16)|0,e[l]=65535&c}},{key:"update",value:function(e){HE.exists(this);for(var t=this.buffer,r=this.blockLen,n=(e=BE(e)).length,i=0;i<n;){var a=Math.min(r-this.pos,n-i);if(a!==r)t.set(e.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===r&&(this.process(t,0,!1),this.pos=0);else for(;r<=n-i;i+=r)this.process(e,i)}return this}},{key:"destroy",value:function(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}},{key:"digestInto",value:function(e){HE.exists(this),HE.output(e,this),this.finished=!0;var t=this.buffer,r=this.h,n=this.pos;if(n){for(t[n++]=1;n<16;n++)t[n]=0;this.process(t,0,!0)}this.finalize();for(var i=0,a=0;a<8;a++)e[i++]=r[a]>>>0,e[i++]=r[a]>>>8;return e}},{key:"digest",value:function(){var e=this.buffer,t=this.outputLen;this.digestInto(e);var r=e.slice(0,t);return this.destroy(),r}}]),e}();var VE=function(e){var t=function(t,r){return e(r).update(BE(t)).digest()},r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=function(t){return e(t)},t}((function(e){return new qE(e)})),KE=ME("expand 16-byte k"),YE=ME("expand 32-byte k"),GE=LE(KE),QE=LE(YE),XE=function(e){return!(e.byteOffset%4)},JE=function(e){var t=OE({rounds:20,counterRight:!1,counterLen:8,allow128bitKeys:!0,blockLen:64},e),r=t.core,n=t.rounds,i=t.counterRight,a=t.counterLen,s=t.allow128bitKeys,o=t.extendNonceFn,u=t.blockLen;HE.number(a),HE.number(n),HE.number(u),HE.bool(i),HE.bool(s);var c=u/4;if(u%4!==0)throw new Error("Salsa/ChaCha: blockLen must be aligned to 4 bytes");return function(e,t,l,h){var f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(HE.bytes(e),HE.bytes(t),HE.bytes(l),h||(h=new Uint8Array(l.length)),HE.bytes(h),HE.number(f),f<0||f>=Math.pow(2,32)-1)throw new Error("Salsa/ChaCha: counter overflow");if(h.length<l.length)throw new Error("Salsa/ChaCha: output (".concat(h.length,") is shorter than data (").concat(l.length,")"));var d,p,v=[];if(32===e.length)XE(e)?d=e:(d=e.slice(),v.push(d)),p=QE;else{if(16!==e.length||!s)throw new Error("Salsa/ChaCha: invalid 32-byte key, got length=".concat(e.length));(d=new Uint8Array(32)).set(e),d.set(e,16),p=GE,v.push(d)}if(XE(t)||(t=t.slice(),v.push(t)),o){if(t.length<=16)throw new Error("Salsa/ChaCha: extended nonce must be bigger than 16 bytes");d=o(p,d,t.subarray(0,16),new Uint8Array(32)),v.push(d),t=t.subarray(16)}var g=16-a;if(t.length!==g)throw new Error("Salsa/ChaCha: nonce must be ".concat(g," or 16 bytes"));if(12!==g){var y=new Uint8Array(12);y.set(t,i?0:12-t.length),v.push(t=y)}var m=new Uint8Array(u),b=LE(m),_=LE(d),w=LE(t),k=XE(l)&&LE(l),x=XE(h)&&LE(h);v.push(b);for(var E=l.length,S=0,C=f;S<E;C++){if(r(p,_,w,b,C,n),C>=Math.pow(2,32)-1)throw new Error("Salsa/ChaCha: counter overflow");var A=Math.min(u,E-S);if(A===u&&x&&k){var D=S/4;if(S%4!==0)throw new Error("Salsa/ChaCha: invalid block position");for(var R=0;R<c;R++)x[D+R]=k[D+R]^b[R];S+=u}else{for(var T=0;T<A;T++)h[S+T]=l[S+T]^m[T];S+=A}}for(var Z=0;Z<v.length;Z++)v[Z].fill(0);return h}},$E=function(e,t){return e<<t|e>>>32-t};function eS(e,t,r,n,i){for(var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:20,s=e[0],o=e[1],u=e[2],c=e[3],l=t[0],h=t[1],f=t[2],d=t[3],p=t[4],v=t[5],g=t[6],y=t[7],m=i,b=r[0],_=r[1],w=r[2],k=s,x=o,E=u,S=c,C=l,A=h,D=f,R=d,T=p,Z=v,I=g,P=y,L=m,M=b,B=_,O=w,N=0;N<a;N+=2)L=$E(L^(k=k+C|0),16),C=$E(C^(T=T+L|0),12),L=$E(L^(k=k+C|0),8),C=$E(C^(T=T+L|0),7),M=$E(M^(x=x+A|0),16),A=$E(A^(Z=Z+M|0),12),M=$E(M^(x=x+A|0),8),A=$E(A^(Z=Z+M|0),7),B=$E(B^(E=E+D|0),16),D=$E(D^(I=I+B|0),12),B=$E(B^(E=E+D|0),8),D=$E(D^(I=I+B|0),7),O=$E(O^(S=S+R|0),16),R=$E(R^(P=P+O|0),12),O=$E(O^(S=S+R|0),8),R=$E(R^(P=P+O|0),7),O=$E(O^(k=k+A|0),16),A=$E(A^(I=I+O|0),12),O=$E(O^(k=k+A|0),8),A=$E(A^(I=I+O|0),7),L=$E(L^(x=x+D|0),16),D=$E(D^(P=P+L|0),12),L=$E(L^(x=x+D|0),8),D=$E(D^(P=P+L|0),7),M=$E(M^(E=E+R|0),16),R=$E(R^(T=T+M|0),12),M=$E(M^(E=E+R|0),8),R=$E(R^(T=T+M|0),7),B=$E(B^(S=S+C|0),16),C=$E(C^(Z=Z+B|0),12),B=$E(B^(S=S+C|0),8),C=$E(C^(Z=Z+B|0),7);var F=0;n[F++]=s+k|0,n[F++]=o+x|0,n[F++]=u+E|0,n[F++]=c+S|0,n[F++]=l+C|0,n[F++]=h+A|0,n[F++]=f+D|0,n[F++]=d+R|0,n[F++]=p+T|0,n[F++]=v+Z|0,n[F++]=g+I|0,n[F++]=y+P|0,n[F++]=m+L|0,n[F++]=b+M|0,n[F++]=_+B|0,n[F++]=w+O|0}var tS=JE({core:eS,counterRight:!1,counterLen:4,allow128bitKeys:!1}),rS=new Uint8Array(16),nS=function(e,t){e.update(t);var r=t.length%16;r&&e.update(rS.subarray(r))},iS=function(e,t,r,n,i){var a=e(t,r,new Uint8Array(32)),s=VE.create(a);i&&nS(s,i),nS(s,n);var o,u=new Uint8Array(16),c=(o=u,new DataView(o.buffer,o.byteOffset,o.byteLength));FE(c,0,BigInt(i?i.length:0),!0),FE(c,8,BigInt(n.length),!0),s.update(u);var l=s.digest();return a.fill(0),l},aS=function(e){return function(t,r,n){var i=16;return NE(t,32),NE(r),{tagLength:i,encrypt:function(a,s){var o=a.length,u=o+i;s?NE(s,u):s=new Uint8Array(u),e(t,r,a,s,1);var c=iS(e,t,r,s.subarray(0,-16),n);return s.set(c,o),s},decrypt:function(a,s){var o=a.length,u=o-i;if(o<i)throw new Error("encrypted data must be at least ".concat(i," bytes"));s?NE(s,u):s=new Uint8Array(u);var c=a.subarray(0,-16);if(!function(e,t){if(e.length!==t.length)throw new Error("equalBytes: Different size of Uint8Arrays");for(var r=!0,n=0;n<e.length;n++)r&&(r=e[n]===t[n]);return r}(a.subarray(-16),iS(e,t,r,c,n)))throw new Error("invalid tag");return e(t,r,c,s,1),s}}}},sS=aS(tS);function oS(e,t,r){return Pd(e),void 0===r&&(r=new Uint8Array(e.outputLen)),qg(e,zd(r),zd(t))}var uS=new Uint8Array([0]),cS=new Uint8Array;function lS(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32;if(Pd(e),Zd(n),n>255*e.outputLen)throw new Error("Length should be <= 255*HashLen");var i=Math.ceil(n/e.outputLen);void 0===r&&(r=cS);for(var a=new Uint8Array(i*e.outputLen),s=qg.create(e,t),o=s._cloneInto(),u=new Uint8Array(s.outputLen),c=0;c<i;c++)uS[0]=c+1,o.update(0===c?cS:u).update(r).update(uS).digestInto(u),a.set(u,e.outputLen*c),s._cloneInto(o);return s.destroy(),o.destroy(),u.fill(0),uS.fill(0),a.slice(0,n)}var hS={hashSHA256:function(e){return Hg(e)},getHKDF:function(e,t){var r=oS(Hg,t,e),n=lS(Hg,r,void 0,96);return[n.subarray(0,32),n.subarray(32,64),n.subarray(64,96)]},generateX25519KeyPair:function(){var e=Cv.utils.randomPrivateKey();return{publicKey:Cv.getPublicKey(e),privateKey:e}},generateX25519KeyPairFromSeed:function(e){return{publicKey:Cv.getPublicKey(e),privateKey:e}},generateX25519SharedKey:function(e,t){return Cv.getSharedSecret(e,t)},chaCha20Poly1305Encrypt:function(e,t,r,n){return sS(n,t,r).encrypt(e)},chaCha20Poly1305Decrypt:function(e,t,r,n,i){return sS(n,t,r).decrypt(e,i)}},fS=function(e){var t,r=(t=2,globalThis.Buffer?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t));return new DataView(r.buffer,r.byteOffset,r.byteLength).setUint16(0,e,!1),r};fS.bytes=2;var dS=function(e){if(e.length<2)throw RangeError("Could not decode int16BE");return e instanceof Uint8Array?new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1):e.getUint16(0)};function pS(e){return Eu([e.ne,e.ciphertext],e.ne.length+e.ciphertext.length)}function vS(e){return Eu([e.ne,e.ns,e.ciphertext],e.ne.length+e.ns.length+e.ciphertext.length)}function gS(e){return Eu([e.ns,e.ciphertext],e.ns.length+e.ciphertext.length)}function yS(e){if(e.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:e.subarray(0,32),ciphertext:e.subarray(32,e.length),ns:new Uint8Array(0)}}function mS(e){if(e.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:e.subarray(0,32),ns:e.subarray(32,80),ciphertext:e.subarray(80,e.length)}}function bS(e){if(e.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:new Uint8Array(0),ns:e.subarray(0,48),ciphertext:e.subarray(48,e.length)}}dS.bytes=2;var _S,wS;function kS(e,t){return function(){var r=ea((0,ii.Z)().mark((function r(n){var i,a,s,o,u,c,l,h,f;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:i=!1,a=!1,r.prev=2,o=ui(n);case 4:return r.next=6,Ji(o.next());case 6:if(!(i=!(u=r.sent).done)){r.next=24;break}c=u.value,l=0;case 9:if(!(l<c.length)){r.next=21;break}return(h=l+65519)>c.length&&(h=c.length),f=e.encrypt(c.subarray(l,h),e.session),null===t||void 0===t||t.encryptedPackets.increment(),r.next=16,fS(f.byteLength);case 16:return r.next=18,f;case 18:l+=65519,r.next=9;break;case 21:i=!1,r.next=4;break;case 24:r.next=30;break;case 26:r.prev=26,r.t0=r.catch(2),a=!0,s=r.t0;case 30:if(r.prev=30,r.prev=31,!i||null==o.return){r.next=35;break}return r.next=35,Ji(o.return());case 35:if(r.prev=35,!a){r.next=38;break}throw s;case 38:return r.finish(35);case 39:return r.finish(30);case 40:case"end":return r.stop()}}),r,null,[[2,26,30,40],[31,,35,39]])})));return function(e){return r.apply(this,arguments)}}()}function xS(e,t){return function(){var r=ea((0,ii.Z)().mark((function r(n){var i,a,s,o,u,c,l,h,f,d,p,v;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:i=!1,a=!1,r.prev=2,o=ui(n);case 4:return r.next=6,Ji(o.next());case 6:if(!(i=!(u=r.sent).done)){r.next=29;break}c=u.value,l=0;case 9:if(!(l<c.length)){r.next=26;break}if((h=l+ZE)>c.length&&(h=c.length),!(h-16<l)){r.next=14;break}throw new Error("Invalid chunk");case 14:if(f=c.subarray(l,h),d=c.subarray(l,h-16),p=e.decrypt(f,e.session,d),v=p.plaintext,p.valid){r.next=20;break}throw null===t||void 0===t||t.decryptErrors.increment(),new Error("Failed to validate decrypted chunk");case 20:return null===t||void 0===t||t.decryptedPackets.increment(),r.next=23,v;case 23:l+=ZE,r.next=9;break;case 26:i=!1,r.next=4;break;case 29:r.next=35;break;case 31:r.prev=31,r.t0=r.catch(2),a=!0,s=r.t0;case 35:if(r.prev=35,r.prev=36,!i||null==o.return){r.next=40;break}return r.next=40,Ji(o.return());case 40:if(r.prev=40,!a){r.next=43;break}throw s;case 43:return r.finish(40);case 44:return r.finish(35);case 45:case"end":return r.stop()}}),r,null,[[2,31,35,45],[36,,40,44]])})));return function(e){return r.apply(this,arguments)}}()}function ES(e,t,r){return SS.apply(this,arguments)}function SS(){return(SS=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,AS(t,IS(r));case 2:if(i=e.sent,null!=t.publicKey){e.next=5;break}throw new Error("PublicKey was missing from local PeerId");case 5:return e.abrupt("return",CS(t.publicKey,i,n));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function CS(e,t,r){return wS.encode({identityKey:e,identitySig:t,extensions:null!==r&&void 0!==r?r:{webtransportCerthashes:[]}}).subarray()}function AS(e,t){return DS.apply(this,arguments)}function DS(){return DS=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.privateKey){e.next=2;break}throw new Error("PrivateKey was missing from PeerId");case 2:return e.next=4,Cy(t.privateKey);case 4:return n=e.sent,e.abrupt("return",n.sign(r));case 6:case"end":return e.stop()}}),e)}))),DS.apply(this,arguments)}function RS(e){return TS.apply(this,arguments)}function TS(){return(TS=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",rm(t.identityKey));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ZS(e){return wS.decode(e)}function IS(e){var t=Hs("noise-libp2p-static-key:");return Eu([t,e],t.length+e.length)}function PS(e,t,r){return LS.apply(this,arguments)}function LS(){return(LS=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rm(r.identityKey);case 2:if((i=e.sent).equals(n)){e.next=5;break}throw new Error("Payload identity key ".concat(i.toString()," does not match expected remote peer ").concat(n.toString()));case 5:if(a=IS(t),null!=i.publicKey){e.next=8;break}throw new Error("PublicKey was missing from PeerId");case 8:if(null!=r.identitySig){e.next=10;break}throw new Error("Signature was missing from message");case 10:return s=Ey(i.publicKey),e.next=13,s.verify(a,r.identitySig);case 13:if(e.sent){e.next=16;break}throw new Error("Static key doesn't match to peer that signed payload!");case 16:return e.abrupt("return",i);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function MS(e){return e instanceof Uint8Array&&32===e.length}!function(e){var t;e.codec=function(){return null==t&&(t=Xo((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==r.lengthDelimited&&t.fork(),null!=e.webtransportCerthashes){var n,i=(0,ge.Z)(e.webtransportCerthashes);try{for(i.s();!(n=i.n()).done;){var a=n.value;t.uint32(10),t.bytes(a)}}catch(S$){i.e(S$)}finally{i.f()}}!1!==r.lengthDelimited&&t.ldelim()}),(function(e,t){for(var r={webtransportCerthashes:[]},n=null==t?e.len:e.pos+t;e.pos<n;){var i=e.uint32();if(i>>>3===1)r.webtransportCerthashes.push(e.bytes());else e.skipType(7&i)}return r}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(_S||(_S={})),function(e){var t;e.codec=function(){return null==t&&(t=Xo((function(e,t){var r,n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(!1!==i.lengthDelimited&&t.fork(),!0===i.writeDefaults||null!=e.identityKey&&e.identityKey.byteLength>0)&&(t.uint32(10),t.bytes(null!==(r=e.identityKey)&&void 0!==r?r:new Uint8Array(0)));(!0===i.writeDefaults||null!=e.identitySig&&e.identitySig.byteLength>0)&&(t.uint32(18),t.bytes(null!==(n=e.identitySig)&&void 0!==n?n:new Uint8Array(0)));null!=e.extensions&&(t.uint32(34),_S.codec().encode(e.extensions,t,{writeDefaults:!1})),!1!==i.lengthDelimited&&t.ldelim()}),(function(e,t){for(var r={identityKey:new Uint8Array(0),identitySig:new Uint8Array(0)},n=null==t?e.len:e.pos+t;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.identityKey=e.bytes();break;case 2:r.identitySig=e.bytes();break;case 4:r.extensions=_S.codec().decode(e,e.uint32());break;default:e.skipType(7&i)}}return r}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(wS||(wS={}));var BS,OS=zi("libp2p:noise");function NS(e){e?(BS("LOCAL_PUBLIC_EPHEMERAL_KEY ".concat(Ws(e.publicKey,"hex"))),BS("LOCAL_PRIVATE_EPHEMERAL_KEY ".concat(Ws(e.privateKey,"hex")))):BS("Missing local ephemeral keys.")}function FS(e){BS("REMOTE_EPHEMERAL_PUBLIC_KEY ".concat(Ws(e,"hex")))}BS=IE?OS:Object.assign((function(){}),{enabled:!1,trace:function(){},error:function(){}});var US=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(0,hi.Z)(this,e),(0,we.Z)(this,"n",void 0),(0,we.Z)(this,"bytes",void 0),(0,we.Z)(this,"view",void 0),this.n=t,this.bytes=new Uint8Array(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,t,!0)}return(0,fi.Z)(e,[{key:"increment",value:function(){this.n++,this.view.setUint32(4,this.n,!0)}},{key:"getBytes",value:function(){return this.bytes}},{key:"getUint64",value:function(){return this.n}},{key:"assertValue",value:function(){if(this.n>4294967295)throw new Error("Cipherstate has reached maximum n, a new handshake must be performed")}}]),e}(),zS=function(){function e(t){(0,hi.Z)(this,e),(0,we.Z)(this,"crypto",void 0),this.crypto=t}return(0,fi.Z)(e,[{key:"encryptWithAd",value:function(e,t,r){var n=this.encrypt(e.k,e.n,t,r);return e.n.increment(),n}},{key:"decryptWithAd",value:function(e,t,r,n){var i=this.decrypt(e.k,e.n,t,r,n),a=i.plaintext,s=i.valid;return s&&e.n.increment(),{plaintext:a,valid:s}}},{key:"hasKey",value:function(e){return!this.isEmptyKey(e.k)}},{key:"createEmptyKey",value:function(){return new Uint8Array(32)}},{key:"isEmptyKey",value:function(e){return Ao(this.createEmptyKey(),e)}},{key:"encrypt",value:function(e,t,r,n){return t.assertValue(),this.crypto.chaCha20Poly1305Encrypt(n,t.getBytes(),r,e)}},{key:"encryptAndHash",value:function(e,t){var r;return r=this.hasKey(e.cs)?this.encryptWithAd(e.cs,e.h,t):t,this.mixHash(e,r),r}},{key:"decrypt",value:function(e,t,r,n,i){t.assertValue();var a=this.crypto.chaCha20Poly1305Decrypt(n,t.getBytes(),r,e,i);return a?{plaintext:a,valid:!0}:{plaintext:new Uint8Array(0),valid:!1}}},{key:"decryptAndHash",value:function(e,t){var r,n=!0;if(this.hasKey(e.cs)){var i=this.decryptWithAd(e.cs,e.h,t);r=i.plaintext,n=i.valid}else r=t;return this.mixHash(e,t),{plaintext:r,valid:n}}},{key:"dh",value:function(e,t){try{var r=this.crypto.generateX25519SharedKey(e,t);return 32===r.length?r:r.subarray(0,32)}catch(i){var n=i;return OS.error(n),new Uint8Array(32)}}},{key:"mixHash",value:function(e,t){e.h=this.getHash(e.h,t)}},{key:"getHash",value:function(e,t){return this.crypto.hashSHA256(Eu([e,t],e.length+t.length))}},{key:"mixKey",value:function(e,t){var r=this.crypto.getHKDF(e.ck,t),n=(0,ke.Z)(r,2),i=n[0],a=n[1];e.cs=this.initializeKey(a),e.ck=i}},{key:"initializeKey",value:function(e){return{k:e,n:new US}}},{key:"initializeSymmetric",value:function(e){var t=Hs(e,"utf-8"),r=this.hashProtocolName(t),n=r,i=this.createEmptyKey();return{cs:this.initializeKey(i),ck:n,h:r}}},{key:"hashProtocolName",value:function(e){if(e.length<=32){var t=new Uint8Array(32);return t.set(e),t}return this.getHash(e,new Uint8Array(0))}},{key:"split",value:function(e){var t=this.crypto.getHKDF(e.ck,new Uint8Array(0)),r=(0,ke.Z)(t,2),n=r[0],i=r[1];return{cs1:this.initializeKey(n),cs2:this.initializeKey(i)}}},{key:"writeMessageRegular",value:function(e,t){var r=this.encryptWithAd(e,new Uint8Array(0),t);return{ne:this.createEmptyKey(),ns:new Uint8Array(0),ciphertext:r}}},{key:"readMessageRegular",value:function(e,t){return this.decryptWithAd(e,new Uint8Array(0),t.ciphertext)}}]),e}(),jS=function(e){ia(r,e);var t=ua(r);function r(){return(0,hi.Z)(this,r),t.apply(this,arguments)}return(0,fi.Z)(r,[{key:"initializeInitiator",value:function(e,t,r,n){var i=this.initializeSymmetric("Noise_XX_25519_ChaChaPoly_SHA256");return this.mixHash(i,e),{ss:i,s:t,rs:r,psk:n,re:new Uint8Array(32)}}},{key:"initializeResponder",value:function(e,t,r,n){var i=this.initializeSymmetric("Noise_XX_25519_ChaChaPoly_SHA256");return this.mixHash(i,e),{ss:i,s:t,rs:r,psk:n,re:new Uint8Array(32)}}},{key:"writeMessageA",value:function(e,t,r){var n=new Uint8Array(0);e.e=void 0!==r?r:this.crypto.generateX25519KeyPair();var i=e.e.publicKey;return this.mixHash(e.ss,i),{ne:i,ns:n,ciphertext:this.encryptAndHash(e.ss,t)}}},{key:"writeMessageB",value:function(e,t){e.e=this.crypto.generateX25519KeyPair();var r=e.e.publicKey;this.mixHash(e.ss,r),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));var n=e.s.publicKey,i=this.encryptAndHash(e.ss,n);return this.mixKey(e.ss,this.dh(e.s.privateKey,e.re)),{ne:r,ns:i,ciphertext:this.encryptAndHash(e.ss,t)}}},{key:"writeMessageC",value:function(e,t){var r=e.s.publicKey,n=this.encryptAndHash(e.ss,r);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));var i=this.encryptAndHash(e.ss,t),a={ne:this.createEmptyKey(),ns:n,ciphertext:i},s=this.split(e.ss),o=s.cs1,u=s.cs2;return{h:e.ss.h,messageBuffer:a,cs1:o,cs2:u}}},{key:"readMessageA",value:function(e,t){return MS(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,t.ciphertext)}},{key:"readMessageB",value:function(e,t){if(MS(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));var r=this.decryptAndHash(e.ss,t.ns),n=r.plaintext,i=r.valid;i&&MS(n)&&(e.rs=n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));var a=this.decryptAndHash(e.ss,t.ciphertext),s=a.plaintext,o=a.valid;return{plaintext:s,valid:i&&o}}},{key:"readMessageC",value:function(e,t){var r=this.decryptAndHash(e.ss,t.ns),n=r.plaintext,i=r.valid;if(i&&MS(n)&&(e.rs=n),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));var a=this.decryptAndHash(e.ss,t.ciphertext),s=a.plaintext,o=a.valid,u=this.split(e.ss),c=u.cs1,l=u.cs2;return{h:e.ss.h,plaintext:s,valid:i&&o,cs1:c,cs2:l}}},{key:"initSession",value:function(e,t,r){var n=this.createEmptyKey(),i=new Uint8Array(32);return{hs:e?this.initializeInitiator(t,r,i,n):this.initializeResponder(t,r,i,n),i:e,mc:0}}},{key:"sendMessage",value:function(e,t,r){var n;if(0===e.mc)n=this.writeMessageA(e.hs,t,r);else if(1===e.mc)n=this.writeMessageB(e.hs,t);else if(2===e.mc){var i=this.writeMessageC(e.hs,t),a=i.h,s=i.messageBuffer,o=i.cs1,u=i.cs2;n=s,e.h=a,e.cs1=o,e.cs2=u}else{if(!(e.mc>2))throw new Error("Session invalid.");if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");n=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");n=this.writeMessageRegular(e.cs2,t)}}return e.mc++,n}},{key:"recvMessage",value:function(e,t){var r=new Uint8Array(0),n=!1;if(0===e.mc){var i=this.readMessageA(e.hs,t);r=i.plaintext,n=i.valid}else if(1===e.mc){var a=this.readMessageB(e.hs,t);r=a.plaintext,n=a.valid}else if(2===e.mc){var s=this.readMessageC(e.hs,t),o=s.h,u=s.plaintext,c=s.valid,l=s.cs1,h=s.cs2;r=u,n=c,e.h=o,e.cs1=l,e.cs2=h}return e.mc++,{plaintext:r,valid:n}}}]),r}(zS),HS=function(){function e(t,r,n,i,a,s,o,u){(0,hi.Z)(this,e),(0,we.Z)(this,"isInitiator",void 0),(0,we.Z)(this,"session",void 0),(0,we.Z)(this,"remotePeer",void 0),(0,we.Z)(this,"remoteExtensions",{webtransportCerthashes:[]}),(0,we.Z)(this,"payload",void 0),(0,we.Z)(this,"connection",void 0),(0,we.Z)(this,"xx",void 0),(0,we.Z)(this,"staticKeypair",void 0),(0,we.Z)(this,"prologue",void 0),this.isInitiator=t,this.payload=r,this.prologue=n,this.staticKeypair=a,this.connection=s,o&&(this.remotePeer=o),this.xx=null!==u&&void 0!==u?u:new jS(i),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair)}return(0,fi.Z)(e,[{key:"propose",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.session.hs.s,BS("LOCAL_STATIC_PUBLIC_KEY ".concat(Ws(i.publicKey,"hex"))),BS("LOCAL_STATIC_PRIVATE_KEY ".concat(Ws(i.privateKey,"hex"))),!this.isInitiator){e.next=10;break}return OS.trace("Stage 0 - Initiator starting to send first message."),t=this.xx.sendMessage(this.session,new Uint8Array(0)),e.next=6,this.connection.write(pS(t));case 6:OS.trace("Stage 0 - Initiator finished sending first message."),NS(this.session.hs.e),e.next=21;break;case 10:return OS.trace("Stage 0 - Responder waiting to receive first message..."),e.t0=yS,e.next=14,this.connection.read();case 14:if(e.t1=e.sent.subarray(),r=(0,e.t0)(e.t1),n=this.xx.recvMessage(this.session,r),n.valid){e.next=19;break}throw new xo("xx handshake stage 0 validation fail");case 19:OS.trace("Stage 0 - Responder received first message."),FS(this.session.hs.re);case 21:case"end":return e.stop()}var i}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"exchange",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i,a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isInitiator){e.next=34;break}return OS.trace("Stage 1 - Initiator waiting to receive first message from responder..."),e.t0=mS,e.next=5,this.connection.read();case 5:if(e.t1=e.sent.subarray(),t=(0,e.t0)(e.t1),r=this.xx.recvMessage(this.session,t),n=r.plaintext,r.valid){e.next=10;break}throw new xo("xx handshake stage 1 validation fail");case 10:if(OS.trace("Stage 1 - Initiator received the message."),FS(this.session.hs.re),o=this.session.hs.rs,BS("REMOTE_STATIC_PUBLIC_KEY ".concat(Ws(o,"hex"))),OS.trace("Initiator going to check remote's signature..."),e.prev=14,i=ZS(n),e.t2=this.remotePeer,e.t2){e.next=21;break}return e.next=20,RS(i);case 20:e.t2=e.sent;case 21:return this.remotePeer=e.t2,e.next=24,PS(this.session.hs.rs,i,this.remotePeer);case 24:this.setRemoteNoiseExtension(i.extensions),e.next=31;break;case 27:throw e.prev=27,e.t3=e.catch(14),a=e.t3,new ko("Error occurred while verifying signed payload: ".concat(a.message));case 31:OS.trace("All good with the signature!"),e.next=40;break;case 34:return OS.trace("Stage 1 - Responder sending out first message with signed payload and static key."),s=this.xx.sendMessage(this.session,this.payload),e.next=38,this.connection.write(vS(s));case 38:OS.trace("Stage 1 - Responder sent the second handshake message with signed payload."),NS(this.session.hs.e);case 40:case"end":return e.stop()}var o}),e,this,[[14,27]])})));return function(){return e.apply(this,arguments)}}()},{key:"finish",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i,a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isInitiator){e.next=8;break}return OS.trace("Stage 2 - Initiator sending third handshake message."),t=this.xx.sendMessage(this.session,this.payload),e.next=5,this.connection.write(gS(t));case 5:OS.trace("Stage 2 - Initiator sent message with signed payload."),e.next=35;break;case 8:return OS.trace("Stage 2 - Responder waiting for third handshake message..."),e.t0=bS,e.next=12,this.connection.read();case 12:if(e.t1=e.sent.subarray(),r=(0,e.t0)(e.t1),n=this.xx.recvMessage(this.session,r),i=n.plaintext,n.valid){e.next=17;break}throw new xo("xx handshake stage 2 validation fail");case 17:if(OS.trace("Stage 2 - Responder received the message, finished handshake."),e.prev=18,a=ZS(i),e.t2=this.remotePeer,e.t2){e.next=25;break}return e.next=24,RS(a);case 24:e.t2=e.sent;case 25:return this.remotePeer=e.t2,e.next=28,PS(this.session.hs.rs,a,this.remotePeer);case 28:this.setRemoteNoiseExtension(a.extensions),e.next=35;break;case 31:throw e.prev=31,e.t3=e.catch(18),s=e.t3,new ko("Error occurred while verifying signed payload: ".concat(s.message));case 35:(o=this.session).cs1&&o.cs2?(BS("CIPHER_STATE_1 ".concat(o.cs1.n.getUint64()," ").concat(Ws(o.cs1.k,"hex"))),BS("CIPHER_STATE_2 ".concat(o.cs2.n.getUint64()," ").concat(Ws(o.cs2.k,"hex")))):BS("Missing cipher state.");case 36:case"end":return e.stop()}var o}),e,this,[[18,31]])})));return function(){return e.apply(this,arguments)}}()},{key:"encrypt",value:function(e,t){var r=this.getCS(t);return this.xx.encryptWithAd(r,new Uint8Array(0),e)}},{key:"decrypt",value:function(e,t,r){var n=this.getCS(t,!1);return this.xx.decryptWithAd(n,new Uint8Array(0),e,r)}},{key:"getRemoteStaticKey",value:function(){return this.session.hs.rs}},{key:"getCS",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e.cs1||!e.cs2)throw new xo("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}},{key:"setRemoteNoiseExtension",value:function(e){e&&(this.remoteExtensions=e)}}]),e}();var WS=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,hi.Z)(this,e),(0,we.Z)(this,"protocol","/noise"),(0,we.Z)(this,"crypto",void 0),(0,we.Z)(this,"prologue",void 0),(0,we.Z)(this,"staticKeys",void 0),(0,we.Z)(this,"extensions",void 0),(0,we.Z)(this,"metrics",void 0);var r=t.staticNoiseKey,n=t.extensions,i=t.crypto,a=t.prologueBytes,s=t.metrics;this.crypto=null!==i&&void 0!==i?i:hS,this.extensions=n,this.metrics=s?function(e){return{xxHandshakeSuccesses:e.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:e.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:e.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:e.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:e.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}(s):void 0,this.staticKeys=r?this.crypto.generateX25519KeyPairFromSeed(r):this.crypto.generateX25519KeyPair(),this.prologue=null!==a&&void 0!==a?a:new Uint8Array(0)}return(0,fi.Z)(e,[{key:"secureOutbound",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=DE(r,{lengthEncoder:fS,lengthDecoder:dS,maxDataLength:ZE}),e.next=3,this.performHandshake({connection:i,isInitiator:!0,localPeer:t,remotePeer:n});case 3:return a=e.sent,e.next=6,this.createSecureConnection(i,a);case 6:return s=e.sent,e.abrupt("return",{conn:s,remoteExtensions:a.remoteExtensions,remotePeer:a.remotePeer});case 8:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"secureInbound",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=DE(r,{lengthEncoder:fS,lengthDecoder:dS,maxDataLength:ZE}),e.next=3,this.performHandshake({connection:i,isInitiator:!1,localPeer:t,remotePeer:n});case 3:return a=e.sent,e.next=6,this.createSecureConnection(i,a);case 6:return s=e.sent,e.abrupt("return",{conn:s,remotePeer:a.remotePeer,remoteExtensions:a.remoteExtensions});case 8:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"performHandshake",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ES(t.localPeer,this.staticKeys.publicKey,this.extensions);case 2:return r=e.sent,e.abrupt("return",this.performXXHandshake(t,r));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"performXXHandshake",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.isInitiator,i=t.remotePeer,a=t.connection,s=new HS(n,r,this.prologue,this.crypto,this.staticKeys,a,i),e.prev=2,e.next=5,s.propose();case 5:return e.next=7,s.exchange();case 7:return e.next=9,s.finish();case 9:null===(o=this.metrics)||void 0===o||o.xxHandshakeSuccesses.increment(),e.next=18;break;case 12:if(e.prev=12,e.t0=e.catch(2),null===(u=this.metrics)||void 0===u||u.xxHandshakeErrors.increment(),!(e.t0 instanceof Error)){e.next=18;break}throw e.t0.message="Error occurred during XX handshake: ".concat(e.t0.message),e.t0;case 18:return e.abrupt("return",s);case 19:case"end":return e.stop()}}),e,this,[[2,12]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"createSecureConnection",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=TE(),i=(0,ke.Z)(n,2),a=i[0],s=i[1],o=t.unwrap(),e.next=4,no(a,kS(r,this.metrics),o,(function(e){return Bu(e,{lengthDecoder:dS})}),xS(r,this.metrics),a);case 4:return e.abrupt("return",s);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}();function qS(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(){return new WS(e)}}var VS,KS,YS="ERR_INVALID_FRAME",GS="ERR_UNREQUESTED_PING",QS="ERR_NOT_MATCHING_PING",XS="ERR_STREAM_ALREADY_EXISTS",JS="ERR_DECODE_INVALID_VERSION",$S="ERR_BOTH_CLIENTS",eC="ERR_RECV_WINDOW_EXCEEDED",tC=new Set([YS,GS,QS,XS,JS,$S,eC]),rC="ERR_INVALID_CONFIG",nC="ERR_MUXER_LOCAL_CLOSED",iC="ERR_MUXER_REMOTE_CLOSED",aC=262144,sC={log:zi("libp2p:yamux"),enableKeepAlive:!0,keepAliveInterval:3e4,maxInboundStreams:1e3,maxOutboundStreams:1e3,initialStreamWindowSize:aC,maxStreamWindowSize:16777216,maxMessageSize:65536};!function(e){e[e.Data=0]="Data",e[e.WindowUpdate=1]="WindowUpdate",e[e.Ping=2]="Ping",e[e.GoAway=3]="GoAway"}(VS||(VS={})),function(e){e[e.SYN=1]="SYN",e[e.ACK=2]="ACK",e[e.FIN=4]="FIN",e[e.RST=8]="RST"}(KS||(KS={}));var oC,uC=Object.values(KS).filter((function(e){return"string"!==typeof e}));!function(e){e[e.NormalTermination=0]="NormalTermination",e[e.ProtocolError=1]="ProtocolError",e[e.InternalError=2]="InternalError"}(oC||(oC={}));function cC(e){var t=uC.filter((function(t){return(e.flag&t)===t})).map((function(e){return KS[e]})).join("|");return"streamID=".concat(e.streamID," type=").concat(VS[e.type]," flag=").concat(t," length=").concat(e.length)}var lC=Math.pow(2,24);var hC=function(){function e(t){(0,hi.Z)(this,e),(0,we.Z)(this,"source",void 0),(0,we.Z)(this,"buffer",void 0),(0,we.Z)(this,"frameInProgress",void 0),this.source=function(e){if(void 0!==e[Symbol.iterator]){var t=e[Symbol.iterator]();return t.return=void 0,(0,we.Z)({},Symbol.iterator,(function(){return t}))}if(void 0!==e[Symbol.asyncIterator]){var r=e[Symbol.asyncIterator]();return r.return=void 0,(0,we.Z)({},Symbol.asyncIterator,(function(){return r}))}throw new Error("a source must be either an iterable or an async iterable")}(t),this.buffer=new Du,this.frameInProgress=!1}return(0,fi.Z)(e,[{key:"emitFrames",value:function(){var e=this;return ea((0,ii.Z)().mark((function t(){var r,n,i,a,s,o,u,c,l;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=!1,n=!1,t.prev=2,a=ui(e.source);case 4:return t.next=6,Ji(a.next());case 6:if(!(r=!(s=t.sent).done)){t.next=27;break}o=s.value,e.buffer.append(o);case 9:if(void 0!==(u=e.readHeader())){t.next=13;break}return t.abrupt("break",24);case 13:if(c=u.type,l=u.length,c!==VS.Data){t.next=20;break}return e.frameInProgress=!0,t.next=18,{header:u,readData:e.readBytes.bind(e,l)};case 18:t.next=22;break;case 20:return t.next=22,{header:u};case 22:t.next=9;break;case 24:r=!1,t.next=4;break;case 27:t.next=33;break;case 29:t.prev=29,t.t0=t.catch(2),n=!0,i=t.t0;case 33:if(t.prev=33,t.prev=34,!r||null==a.return){t.next=38;break}return t.next=38,Ji(a.return());case 38:if(t.prev=38,!n){t.next=41;break}throw i;case 41:return t.finish(38);case 42:return t.finish(33);case 43:case"end":return t.stop()}}),t,null,[[2,29,33,43],[34,,38,42]])})))()}},{key:"readHeader",value:function(){if(this.frameInProgress)throw new wo("decoding frame already in progress","ERR_DECODE_IN_PROGRESS");if(!(this.buffer.length<12)){var e=function(e){if(0!==e[0])throw new wo("Invalid frame version",JS);return{type:e[1],flag:(e[2]<<8)+e[3],streamID:e[4]*lC+(e[5]<<16)+(e[6]<<8)+e[7],length:e[8]*lC+(e[9]<<16)+(e[10]<<8)+e[11]}}(this.buffer.subarray(0,12));return this.buffer.consume(12),e}}},{key:"readBytes",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.buffer.length<t)){e.next=31;break}r=!1,n=!1,e.prev=3,a=ui(this.source);case 5:return e.next=7,a.next();case 7:if(!(r=!(s=e.sent).done)){e.next=15;break}if(o=s.value,this.buffer.append(o),!(this.buffer.length>=t)){e.next=12;break}return e.abrupt("break",15);case 12:r=!1,e.next=5;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(3),n=!0,i=e.t0;case 21:if(e.prev=21,e.prev=22,!r||null==a.return){e.next=26;break}return e.next=26,a.return();case 26:if(e.prev=26,!n){e.next=29;break}throw i;case 29:return e.finish(26);case 30:return e.finish(21);case 31:return u=this.buffer.sublist(0,t),this.buffer.consume(t),this.frameInProgress=!1,e.abrupt("return",u);case 35:case"end":return e.stop()}}),e,this,[[3,17,21,31],[22,,26,30]])})));return function(t){return e.apply(this,arguments)}}()}]),e}();function fC(e){var t=new Uint8Array(12);return t[1]=e.type,t[2]=e.flag>>>8,t[3]=e.flag,t[4]=e.streamID>>>24,t[5]=e.streamID>>>16,t[6]=e.streamID>>>8,t[7]=e.streamID,t[8]=e.length>>>24,t[9]=e.length>>>16,t[10]=e.length>>>8,t[11]=e.length,t}var dC=function(e){ia(r,e);var t=ua(r);function r(e,n){var i;return(0,hi.Z)(this,r),i=t.call(this,null!==e&&void 0!==e?e:"The operation was aborted"),(0,we.Z)(ra(i),"type",void 0),(0,we.Z)(ra(i),"code",void 0),i.type="aborted",i.code=null!==n&&void 0!==n?n:"ABORT_ERR",i}return(0,fi.Z)(r)}(es(Error));function pC(e,t,r){return vC.apply(this,arguments)}function vC(){return(vC=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=r){e.next=2;break}return e.abrupt("return",t);case 2:if(!r.aborted){e.next=4;break}return e.abrupt("return",Promise.reject(new dC(null===n||void 0===n?void 0:n.errorMessage,null===n||void 0===n?void 0:n.errorCode)));case 4:return a=new dC(null===n||void 0===n?void 0:n.errorMessage,null===n||void 0===n?void 0:n.errorCode),e.prev=5,e.next=8,Promise.race([t,new Promise((function(e,t){i=function(){t(a)},r.addEventListener("abort",i)}))]);case 8:return e.abrupt("return",e.sent);case 9:return e.prev=9,null!=i&&r.removeEventListener("abort",i),e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[5,,9,12]])})))).apply(this,arguments)}function gC(e){return null!=e&&"function"===typeof e.then}var yC,mC=function(){function e(t){var r,n,i=this;(0,hi.Z)(this,e),(0,we.Z)(this,"id",void 0),(0,we.Z)(this,"direction",void 0),(0,we.Z)(this,"timeline",void 0),(0,we.Z)(this,"protocol",void 0),(0,we.Z)(this,"metadata",void 0),(0,we.Z)(this,"source",void 0),(0,we.Z)(this,"status",void 0),(0,we.Z)(this,"readStatus",void 0),(0,we.Z)(this,"writeStatus",void 0),(0,we.Z)(this,"sinkController",void 0),(0,we.Z)(this,"sinkEnd",void 0),(0,we.Z)(this,"endErr",void 0),(0,we.Z)(this,"streamSource",void 0),(0,we.Z)(this,"onEnd",void 0),(0,we.Z)(this,"onCloseRead",void 0),(0,we.Z)(this,"onCloseWrite",void 0),(0,we.Z)(this,"onReset",void 0),(0,we.Z)(this,"onAbort",void 0),(0,we.Z)(this,"sendCloseWriteTimeout",void 0),(0,we.Z)(this,"log",void 0),this.sinkController=new AbortController,this.sinkEnd=ts(),this.log=t.log,this.status="open",this.readStatus="ready",this.writeStatus="ready",this.id=t.id,this.metadata=null!==(r=t.metadata)&&void 0!==r?r:{},this.direction=t.direction,this.timeline={open:Date.now()},this.sendCloseWriteTimeout=null!==(n=t.sendCloseWriteTimeout)&&void 0!==n?n:5e3,this.onEnd=t.onEnd,this.onCloseRead=null===t||void 0===t?void 0:t.onCloseRead,this.onCloseWrite=null===t||void 0===t?void 0:t.onCloseWrite,this.onReset=null===t||void 0===t?void 0:t.onReset,this.onAbort=null===t||void 0===t?void 0:t.onAbort,this.source=this.streamSource=as({onEnd:function(e){null!=e?i.log.trace("source ended with error",e):i.log.trace("source ended"),i.onSourceEnd(e)}}),this.sink=this.sink.bind(this)}return(0,fi.Z)(e,[{key:"sink",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c,l;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("ready"===this.writeStatus){e.next=2;break}throw new wo('writable end state is "'.concat(this.writeStatus,'" not "ready"'),"ERR_SINK_INVALID_STATE");case 2:if(e.prev=2,this.writeStatus="writing",r={signal:this.sinkController.signal},"outbound"!==this.direction){e.next=10;break}if(!gC(n=this.sendNewStream(r))){e.next=10;break}return e.next=10,n;case 10:t=Sk(t,this.sinkController.signal,{returnOnAbort:!0}),this.log.trace("sink reading from source"),i=!1,a=!1,e.prev=14,o=ui(t);case 16:return e.next=18,o.next();case 18:if(!(i=!(u=e.sent).done)){e.next=28;break}if(c=(c=u.value)instanceof Uint8Array?new Du(c):c,!gC(l=this.sendData(c,r))){e.next=25;break}return e.next=25,l;case 25:i=!1,e.next=16;break;case 28:e.next=34;break;case 30:e.prev=30,e.t0=e.catch(14),a=!0,s=e.t0;case 34:if(e.prev=34,e.prev=35,!i||null==o.return){e.next=39;break}return e.next=39,o.return();case 39:if(e.prev=39,!a){e.next=42;break}throw s;case 42:return e.finish(39);case 43:return e.finish(34);case 44:if(this.log.trace('sink finished reading from source, write status is "%s"',this.writeStatus),"writing"!==this.writeStatus){e.next=51;break}return this.writeStatus="closing",this.log.trace("send close write to remote"),e.next=50,this.sendCloseWrite({signal:AbortSignal.timeout(this.sendCloseWriteTimeout)});case 50:this.writeStatus="closed";case 51:this.onSinkEnd(),e.next=59;break;case 54:throw e.prev=54,e.t1=e.catch(2),this.log.trace("sink ended with error, calling abort with error",e.t1),this.abort(e.t1),e.t1;case 59:return e.prev=59,this.log.trace("resolve sink end"),this.sinkEnd.resolve(),e.finish(59);case 63:case"end":return e.stop()}}),e,this,[[2,54,59,63],[14,30,34,44],[35,,39,43]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onSourceEnd",value:function(e){var t;null==this.timeline.closeRead&&(this.timeline.closeRead=Date.now(),this.readStatus="closed",null!=e&&null==this.endErr&&(this.endErr=e),null===(t=this.onCloseRead)||void 0===t||t.call(this),null!=this.timeline.closeWrite?(this.log.trace("source and sink ended"),this.timeline.close=Date.now(),"aborted"!==this.status&&"reset"!==this.status&&(this.status="closed"),null!=this.onEnd&&this.onEnd(this.endErr)):this.log.trace("source ended, waiting for sink to end"))}},{key:"onSinkEnd",value:function(e){var t;null==this.timeline.closeWrite&&(this.timeline.closeWrite=Date.now(),this.writeStatus="closed",null!=e&&null==this.endErr&&(this.endErr=e),null===(t=this.onCloseWrite)||void 0===t||t.call(this),null!=this.timeline.closeRead?(this.log.trace("sink and source ended"),this.timeline.close=Date.now(),"aborted"!==this.status&&"reset"!==this.status&&(this.status="closed"),null!=this.onEnd&&this.onEnd(this.endErr)):this.log.trace("sink ended, waiting for source to end"))}},{key:"close",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.log.trace("closing gracefully"),this.status="closing",e.next=4,Promise.all([this.closeRead(t),this.closeWrite(t)]);case 4:this.status="closed",this.log.trace("closed gracefully");case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"closeRead",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:{},"closing"!==this.readStatus&&"closed"!==this.readStatus){e.next=3;break}return e.abrupt("return");case 3:if(this.log.trace('closing readable end of stream with starting read status "%s"',this.readStatus),r=this.readStatus,this.readStatus="closing","reset"===this.status||"aborted"===this.status||null!=this.timeline.closeRead){e.next=10;break}return this.log.trace("send close read to remote"),e.next=10,this.sendCloseRead(t);case 10:"ready"===r&&(this.log.trace("ending internal source queue"),this.streamSource.end()),this.log.trace("closed readable end of stream");case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"closeWrite",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r=this,n=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:{},"closing"!==this.writeStatus&&"closed"!==this.writeStatus){e.next=3;break}return e.abrupt("return");case 3:if(this.log.trace('closing writable end of stream with starting write status "%s"',this.writeStatus),"ready"!==this.writeStatus){e.next=8;break}return this.log.trace("sink was never sunk, sink an empty array"),e.next=8,pC(this.sink([]),t.signal);case 8:if("writing"!==this.writeStatus){e.next=11;break}return e.next=11,new Promise((function(e,n){queueMicrotask((function(){r.log.trace("aborting source passed to .sink"),r.sinkController.abort(),pC(r.sinkEnd.promise,t.signal).then(e,n)}))}));case 11:this.writeStatus="closed",this.log.trace("closed writable end of stream");case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"abort",value:function(e){var t,r=this;if("closed"!==this.status&&"aborted"!==this.status&&"reset"!==this.status){this.log("abort with error",e),this.log("try to send reset to remote");var n=this.sendReset();gC(n)&&n.catch((function(e){r.log.error("error sending reset message",e)})),this.status="aborted",this.timeline.abort=Date.now(),this._closeSinkAndSource(e),null===(t=this.onAbort)||void 0===t||t.call(this,e)}}},{key:"reset",value:function(){var e;if("closed"!==this.status&&"aborted"!==this.status&&"reset"!==this.status){var t=new wo("stream reset","ERR_STREAM_RESET");this.status="reset",this.timeline.reset=Date.now(),this._closeSinkAndSource(t),null===(e=this.onReset)||void 0===e||e.call(this)}}},{key:"_closeSinkAndSource",value:function(e){this._closeSink(e),this._closeSource(e)}},{key:"_closeSink",value:function(e){"writing"===this.writeStatus&&(this.log.trace("end sink source"),this.sinkController.abort()),this.onSinkEnd(e)}},{key:"_closeSource",value:function(e){"closing"!==this.readStatus&&"closed"!==this.readStatus&&(this.log.trace("ending source with %d bytes to be read by consumer",this.streamSource.readableLength),this.readStatus="closing",this.streamSource.end(e))}},{key:"remoteCloseWrite",value:function(){"closing"!==this.readStatus&&"closed"!==this.readStatus?(this.log.trace("remote close write"),this._closeSource()):this.log("received remote close write but local source is already closed")}},{key:"remoteCloseRead",value:function(){"closing"!==this.writeStatus&&"closed"!==this.writeStatus?(this.log.trace("remote close read"),this._closeSink()):this.log("received remote close read but local sink is already closed")}},{key:"destroy",value:function(){"closed"!==this.status&&"aborted"!==this.status&&"reset"!==this.status?(this.log.trace("stream destroyed"),this._closeSinkAndSource()):this.log("received destroy but we are already closed")}},{key:"sourcePush",value:function(e){this.streamSource.push(e)}},{key:"sourceReadableLength",value:function(){return this.streamSource.readableLength}}]),e}();!function(e){e[e.Init=0]="Init",e[e.SYNSent=1]="SYNSent",e[e.SYNReceived=2]="SYNReceived",e[e.Established=3]="Established",e[e.Finished=4]="Finished"}(yC||(yC={}));var bC=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),n=t.call(this,(0,_e.Z)((0,_e.Z)({},e),{},{onEnd:function(t){var r;n.state=yC.Finished,null===(r=e.onEnd)||void 0===r||r.call(e,t)}})),(0,we.Z)(ra(n),"name",void 0),(0,we.Z)(ra(n),"state",void 0),(0,we.Z)(ra(n),"config",void 0),(0,we.Z)(ra(n),"_id",void 0),(0,we.Z)(ra(n),"sendWindowCapacity",void 0),(0,we.Z)(ra(n),"sendWindowCapacityUpdate",void 0),(0,we.Z)(ra(n),"recvWindow",void 0),(0,we.Z)(ra(n),"recvWindowCapacity",void 0),(0,we.Z)(ra(n),"epochStart",void 0),(0,we.Z)(ra(n),"getRTT",void 0),(0,we.Z)(ra(n),"sendFrame",void 0),n.config=e.config,n._id=parseInt(e.id,10),n.name=e.name,n.state=e.state,n.sendWindowCapacity=aC,n.recvWindow=n.config.initialStreamWindowSize,n.recvWindowCapacity=n.recvWindow,n.epochStart=Date.now(),n.getRTT=e.getRTT,n.sendFrame=e.sendFrame,n.source=go(n.source,(function(){n.sendWindowUpdate()})),n}return(0,fi.Z)(r,[{key:"sendNewStream",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"sendData",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=a.length>1&&void 0!==a[1]?a[1]:{},t=t.sublist();case 2:if(0===t.byteLength){e.next=15;break}if(0!==this.sendWindowCapacity){e.next=6;break}return e.next=6,this.waitForSendWindowCapacity(r);case 6:if("open"===this.status){e.next=8;break}return e.abrupt("return");case 8:n=Math.min(this.sendWindowCapacity,this.config.maxMessageSize-12,t.length),i=this.getSendFlags(),this.sendFrame({type:VS.Data,flag:i,streamID:this._id,length:n},t.subarray(0,n)),this.sendWindowCapacity-=n,t.consume(n),e.next=2;break;case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendReset",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.sendFrame({type:VS.WindowUpdate,flag:KS.RST,streamID:this._id,length:0});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sendCloseWrite",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.getSendFlags()|KS.FIN,this.sendFrame({type:VS.WindowUpdate,flag:t,streamID:this._id,length:0});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sendCloseRead",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"waitForSendWindowCapacity",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i,a,s,o=this,u=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.length>0&&void 0!==u[0]?u[0]:{},!(this.sendWindowCapacity>0)){e.next=3;break}return e.abrupt("return");case 3:return a=function(){"open"===o.status?i(new wo("stream aborted","ERR_STREAM_ABORT")):n()},null===(t=r.signal)||void 0===t||t.addEventListener("abort",a),e.prev=5,e.next=8,new Promise((function(e,t){o.sendWindowCapacityUpdate=function(){e()},i=t,n=e}));case 8:return e.prev=8,null===(s=r.signal)||void 0===s||s.removeEventListener("abort",a),e.finish(8);case 11:case"end":return e.stop()}}),e,this,[[5,,8,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"handleWindowUpdate",value:function(e){var t;null===(t=this.log)||void 0===t||t.trace("stream received window update id=%s",this._id),this.processFlags(e.flag);var r,n=this.sendWindowCapacity;(this.sendWindowCapacity+=e.length,0===n&&e.length>0)&&(null===(r=this.sendWindowCapacityUpdate)||void 0===r||r.call(this))}},{key:"handleData",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=this.log)||void 0===n||n.trace("stream received data id=%s",this._id),this.processFlags(t.flag),!(this.recvWindowCapacity<t.length)){e.next=4;break}throw new wo("receive window exceeded",eC,{available:this.recvWindowCapacity,recv:t.length});case 4:return e.next=6,r();case 6:i=e.sent,this.recvWindowCapacity-=t.length,this.sourcePush(i);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"processFlags",value:function(e){(e&KS.ACK)===KS.ACK&&this.state===yC.SYNSent&&(this.state=yC.Established),(e&KS.FIN)===KS.FIN&&this.remoteCloseWrite(),(e&KS.RST)===KS.RST&&this.reset()}},{key:"getSendFlags",value:function(){switch(this.state){case yC.Init:return this.state=yC.SYNSent,KS.SYN;case yC.SYNReceived:return this.state=yC.Established,KS.ACK;default:return 0}}},{key:"sendWindowUpdate",value:function(){var e=this.getSendFlags(),t=Date.now(),r=this.getRTT();if(0===e&&r>0&&t-this.epochStart<4*r&&(this.recvWindow=Math.min(2*this.recvWindow,this.config.maxStreamWindowSize)),!(this.recvWindowCapacity>=this.recvWindow&&0===e)){var n=this.recvWindow-this.recvWindowCapacity;this.recvWindowCapacity=this.recvWindow,this.epochStart=t,this.sendFrame({type:VS.WindowUpdate,flag:e,streamID:this._id,length:n})}}}]),r}(mC),_C="/yamux/1.0.0",wC=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,hi.Z)(this,e),(0,we.Z)(this,"protocol",_C),(0,we.Z)(this,"_init",void 0),this._init=t}return(0,fi.Z)(e,[{key:"createStreamMuxer",value:function(e){return new kC((0,_e.Z)((0,_e.Z)({},this._init),e))}}]),e}(),kC=function(){function e(t){var r,n=this;(0,hi.Z)(this,e),(0,we.Z)(this,"protocol",_C),(0,we.Z)(this,"source",void 0),(0,we.Z)(this,"sink",void 0),(0,we.Z)(this,"config",void 0),(0,we.Z)(this,"log",void 0),(0,we.Z)(this,"closeController",void 0),(0,we.Z)(this,"nextStreamID",void 0),(0,we.Z)(this,"_streams",void 0),(0,we.Z)(this,"nextPingID",void 0),(0,we.Z)(this,"activePing",void 0),(0,we.Z)(this,"rtt",void 0),(0,we.Z)(this,"client",void 0),(0,we.Z)(this,"localGoAway",void 0),(0,we.Z)(this,"remoteGoAway",void 0),(0,we.Z)(this,"numInboundStreams",void 0),(0,we.Z)(this,"numOutboundStreams",void 0),(0,we.Z)(this,"onIncomingStream",void 0),(0,we.Z)(this,"onStreamEnd",void 0),this.client="outbound"===t.direction,this.config=(0,_e.Z)((0,_e.Z)({},sC),t),this.log=this.config.log,function(e){if(e.keepAliveInterval<=0)throw new wo("keep-alive interval must be positive",rC);if(e.maxInboundStreams<0)throw new wo("max inbound streams must be larger or equal 0",rC);if(e.maxOutboundStreams<0)throw new wo("max outbound streams must be larger or equal 0",rC);if(e.initialStreamWindowSize<aC)throw new wo("InitialStreamWindowSize must be larger or equal 256 kB",rC);if(e.maxStreamWindowSize<e.initialStreamWindowSize)throw new wo("MaxStreamWindowSize must be larger than the InitialStreamWindowSize",rC);if(e.maxStreamWindowSize>Math.pow(2,32)-1)throw new wo("MaxStreamWindowSize must be less than equal MAX_UINT32",rC);if(e.maxMessageSize<1024)throw new wo("MaxMessageSize must be greater than a kilobyte",rC)}(this.config),this.closeController=new AbortController,this.onIncomingStream=t.onIncomingStream,this.onStreamEnd=t.onStreamEnd,this._streams=new Map,this.source=as({onEnd:function(){var e;null===(e=n.log)||void 0===e||e.trace("muxer source ended"),n._streams.forEach((function(e){e.destroy()}))}}),this.sink=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,i,a,s,o,u,c;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Sk(t,n.closeController.signal,{returnOnAbort:!0}),e.prev=1,s=new hC(t),e.next=5,no(s.emitFrames.bind(s),function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,i,a,s,o,u,c,l;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!1,i=!1,e.prev=2,s=ui(t);case 4:return e.next=6,s.next();case 6:if(!(r=!(o=e.sent).done)){e.next=13;break}return u=o.value,c=u.header,l=u.readData,e.next=10,n.handleFrame(c,l);case 10:r=!1,e.next=4;break;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),i=!0,a=e.t0;case 19:if(e.prev=19,e.prev=20,!r||null==s.return){e.next=24;break}return e.next=24,s.return();case 24:if(e.prev=24,!i){e.next=27;break}throw a;case 27:return e.finish(24);case 28:return e.finish(19);case 29:case"end":return e.stop()}}),e,null,[[2,15,19,29],[20,,24,28]])})));return function(t){return e.apply(this,arguments)}}());case 5:i=oC.NormalTermination,e.next=13;break;case 8:e.prev=8,e.t0=e.catch(1),o=e.t0.code,tC.has(o)?(null===(u=n.log)||void 0===u||u.error("protocol error in sink",e.t0),i=oC.ProtocolError):(null===(c=n.log)||void 0===c||c.error("internal error in sink",e.t0),i=oC.InternalError),a=e.t0;case 13:if(null===(r=n.log)||void 0===r||r.trace("muxer sink ended"),null==a){e.next=18;break}n.abort(a,i),e.next=20;break;case 18:return e.next=20,n.close({reason:i});case 20:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),this.numInboundStreams=0,this.numOutboundStreams=0,this.nextStreamID=this.client?1:2,this.nextPingID=0,this.rtt=0,null===(r=this.log)||void 0===r||r.trace("muxer created"),this.config.enableKeepAlive&&this.keepAliveLoop().catch((function(e){var t;return null===(t=n.log)||void 0===t?void 0:t.error("keepalive error: %s",e)}))}return(0,fi.Z)(e,[{key:"streams",get:function(){return Array.from(this._streams.values())}},{key:"newStream",value:function(e){var t;if(void 0!==this.remoteGoAway)throw new wo("muxer closed remotely",iC);if(void 0!==this.localGoAway)throw new wo("muxer closed locally",nC);var r=this.nextStreamID;if(this.nextStreamID+=2,this.numOutboundStreams>=this.config.maxOutboundStreams)throw new wo("max outbound streams exceeded","ERROR_MAX_OUTBOUND_STREAMS_EXCEEDED");null===(t=this.log)||void 0===t||t.trace("new outgoing stream id=%s",r);var n=this._newStream(r,e,yC.Init,"outbound");return this._streams.set(r,n),this.numOutboundStreams++,n.sendWindowUpdate(),n}},{key:"ping",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.remoteGoAway){e.next=2;break}throw new wo("muxer closed remotely",iC);case 2:if(void 0===this.localGoAway){e.next=4;break}throw new wo("muxer closed locally",nC);case 4:if(void 0!==this.activePing){e.next=19;break}return t=function(){},this.activePing={id:this.nextPingID++,promise:new Promise((function(e,r){var n=function(){r(new wo("muxer closed locally",nC))};i.closeController.signal.addEventListener("abort",n,{once:!0}),t=function(){i.closeController.signal.removeEventListener("abort",n),e()}})),resolve:t},r=Date.now(),this.sendPing(this.activePing.id),e.prev=9,e.next=12,this.activePing.promise;case 12:return e.prev=12,delete this.activePing,e.finish(12);case 15:n=Date.now(),this.rtt=n-r,e.next=21;break;case 19:return e.next=21,this.activePing.promise;case 21:return e.abrupt("return",this.rtt);case 22:case"end":return e.stop()}}),e,this,[[9,,12,15]])})));return function(){return e.apply(this,arguments)}}()},{key:"getRTT",value:function(){return this.rtt}},{key:"close",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i,a,s=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=s.length>0&&void 0!==s[0]?s[0]:{},!this.closeController.signal.aborted){e.next=3;break}return e.abrupt("return");case 3:return a=null!==(t=null===i||void 0===i?void 0:i.reason)&&void 0!==t?t:oC.NormalTermination,null===(r=this.log)||void 0===r||r.trace("muxer close reason=%s",a),i.signal=null!==(n=i.signal)&&void 0!==n?n:AbortSignal.timeout(500),e.prev=6,e.next=9,Promise.all(be(this._streams.values()).map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.close(i));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 9:this.sendGoAway(a),this._closeMuxer(),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),this.abort(e.t0);case 16:case"end":return e.stop()}}),e,this,[[6,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"abort",value:function(e,t){var r,n;if(!this.closeController.signal.aborted){t=null!==(r=t)&&void 0!==r?r:oC.InternalError,null===(n=this.log)||void 0===n||n.error("muxer abort reason=%s error=%s",t,e);var i,a=(0,ge.Z)(this._streams.values());try{for(a.s();!(i=a.n()).done;){i.value.abort(e)}}catch(e){a.e(e)}finally{a.f()}this.sendGoAway(t),this._closeMuxer()}}},{key:"isClosed",value:function(){return this.closeController.signal.aborted}},{key:"_closeMuxer",value:function(){this.closeController.abort(),this.source.end()}},{key:"_newStream",value:function(e,t,r,n){var i=this;if(null!=this._streams.get(e))throw new wo("Stream already exists",XS,{id:e});var a=new bC({id:e.toString(),name:t,state:r,direction:n,sendFrame:this.sendFrame.bind(this),onEnd:function(){var t;i.closeStream(e),null===(t=i.onStreamEnd)||void 0===t||t.call(i,a)},log:zi("libp2p:yamux:".concat(n,":").concat(e)),config:this.config,getRTT:this.getRTT.bind(this)});return a}},{key:"closeStream",value:function(e){this.client===(e%2===0)?this.numInboundStreams--:this.numOutboundStreams--,this._streams.delete(e)}},{key:"keepAliveLoop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i,a=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=new Promise((function(e,t){a.closeController.signal.addEventListener("abort",t,{once:!0})})),null===(t=this.log)||void 0===t||t.trace("muxer keepalive enabled interval=%s",this.config.keepAliveInterval),n=(0,ii.Z)().mark((function e(){var t;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.race([r,new Promise((function(e){t=setTimeout(e,a.config.keepAliveInterval)}))]);case 3:a.ping().catch((function(e){var t;return null===(t=a.log)||void 0===t?void 0:t.error("ping error: %s",e)})),e.next=10;break;case 6:return e.prev=6,e.t0=e.catch(0),clearInterval(t),e.abrupt("return",{v:void 0});case 10:case"end":return e.stop()}}),e,null,[[0,6]])}));case 3:return e.delegateYield(n(),"t0",5);case 5:if(!(i=e.t0)){e.next=8;break}return e.abrupt("return",i.v);case 8:e.next=3;break;case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleFrame",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.streamID,a=t.type,s=t.length,null===(n=this.log)||void 0===n||n.trace("received frame %s",cC(t)),0!==i){e.next=13;break}e.t0=a,e.next=e.t0===VS.Ping?6:e.t0===VS.GoAway?8:10;break;case 6:return this.handlePing(t),e.abrupt("return");case 8:return this.handleGoAway(s),e.abrupt("return");case 10:case 19:throw new wo("Invalid frame type",YS,{header:t});case 11:e.next=20;break;case 13:e.t1=t.type,e.next=e.t1===VS.Data||e.t1===VS.WindowUpdate?16:19;break;case 16:return e.next=18,this.handleStreamMessage(t,r);case 18:return e.abrupt("return");case 20:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"handlePing",value:function(e){if(e.flag===KS.SYN){var t;null===(t=this.log)||void 0===t||t.trace("received ping request pingId=%s",e.length),this.sendPing(e.length,KS.ACK)}else{if(e.flag!==KS.ACK)throw new wo("Invalid frame flag",YS,{header:e});var r;null===(r=this.log)||void 0===r||r.trace("received ping response pingId=%s",e.length),this.handlePingResponse(e.length)}}},{key:"handlePingResponse",value:function(e){if(void 0===this.activePing)throw new wo("ping not requested",GS);if(this.activePing.id!==e)throw new wo("ping doesn't match our id",QS);this.activePing.resolve()}},{key:"handleGoAway",value:function(e){var t,r;null===(t=this.log)||void 0===t||t.trace("received GoAway reason=%s",null!==(r=oC[e])&&void 0!==r?r:"unknown"),this.remoteGoAway=e;var n,i=(0,ge.Z)(this._streams.values());try{for(i.s();!(n=i.n()).done;){n.value.reset()}}catch(S$){i.e(S$)}finally{i.f()}this._closeMuxer()}},{key:"handleStreamMessage",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.streamID,i=t.flag,a=t.type,(i&KS.SYN)===KS.SYN&&this.incomingStream(n),void 0!==(s=this._streams.get(n))){e.next=14;break}if(a!==VS.Data){e.next=12;break}if(null===(o=this.log)||void 0===o||o.call(this,"discarding data for stream id=%s",n),void 0!==r){e.next=8;break}throw new Error("unreachable");case 8:return e.next=10,r();case 10:e.next=13;break;case 12:null===(u=this.log)||void 0===u||u.call(this,"frame for missing stream id=%s",n);case 13:return e.abrupt("return");case 14:e.t0=a,e.next=e.t0===VS.WindowUpdate?17:e.t0===VS.Data?19:24;break;case 17:return s.handleWindowUpdate(t),e.abrupt("return");case 19:if(void 0!==r){e.next=21;break}throw new Error("unreachable");case 21:return e.next=23,s.handleData(t,r);case 23:return e.abrupt("return");case 24:throw new Error("unreachable");case 25:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"incomingStream",value:function(e){var t,r;if(this.client!==(e%2===0))throw new wo("both endpoints are clients",$S);if(!this._streams.has(e))if(null===(t=this.log)||void 0===t||t.trace("new incoming stream id=%s",e),void 0===this.localGoAway){var n;if(this.numInboundStreams>=this.config.maxInboundStreams)return null===(n=this.log)||void 0===n||n.call(this,"maxIncomingStreams exceeded, forcing stream reset"),void this.sendFrame({type:VS.WindowUpdate,flag:KS.RST,streamID:e,length:0});var i=this._newStream(e,void 0,yC.SYNReceived,"inbound");this.numInboundStreams++,this._streams.set(e,i),null===(r=this.onIncomingStream)||void 0===r||r.call(this,i)}else this.sendFrame({type:VS.WindowUpdate,flag:KS.RST,streamID:e,length:0})}},{key:"sendFrame",value:function(e,t){var r;if(null===(r=this.log)||void 0===r||r.trace("sending frame %s",cC(e)),e.type===VS.Data){if(void 0===t)throw new wo("invalid frame",YS);this.source.push(fC(e)),this.source.push(t)}else this.source.push(fC(e))}},{key:"sendPing",value:function(e){var t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:KS.SYN;n===KS.SYN?null===(t=this.log)||void 0===t||t.trace("sending ping request pingId=%s",e):null===(r=this.log)||void 0===r||r.trace("sending ping response pingId=%s",e);this.sendFrame({type:VS.Ping,flag:n,streamID:0,length:e})}},{key:"sendGoAway",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oC.NormalTermination;null===(e=this.log)||void 0===e||e.call(this,"sending GoAway reason=%s",oC[t]),this.localGoAway=t,this.sendFrame({type:VS.GoAway,flag:0,streamID:0,length:t})}}]),e}();function xC(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(){return new wC(e)}}var EC,SC=tA("dns4"),CC=tA("dns6"),AC=tA("dnsaddr"),DC=eA(tA("dns"),AC,SC,CC),RC=eA(tA("ip4"),tA("ip6")),TC=eA($C(RC,tA("tcp")),$C(DC,tA("tcp"))),ZC=$C(RC,tA("udp")),IC=$C(ZC,tA("utp")),PC=$C(ZC,tA("quic")),LC=$C(ZC,tA("quic-v1")),MC=eA($C(TC,tA("ws")),$C(DC,tA("ws"))),BC=eA($C(MC,tA("p2p")),MC),OC=eA($C(TC,tA("wss")),$C(DC,tA("wss")),$C(TC,tA("tls"),tA("ws")),$C(DC,tA("tls"),tA("ws"))),NC=eA($C(OC,tA("p2p")),OC),FC=eA($C(TC,tA("http")),$C(RC,tA("http")),$C(DC,tA("http"))),UC=eA($C(TC,tA("https")),$C(RC,tA("https")),$C(DC,tA("https"))),zC=$C(ZC,tA("webrtc-direct"),tA("certhash")),jC=eA($C(zC,tA("p2p")),zC),HC=$C(LC,tA("webtransport"),tA("certhash"),tA("certhash")),WC=eA($C(HC,tA("p2p")),HC),qC=eA($C(BC,tA("p2p-webrtc-star"),tA("p2p")),$C(NC,tA("p2p-webrtc-star"),tA("p2p")),$C(BC,tA("p2p-webrtc-star")),$C(NC,tA("p2p-webrtc-star"))),VC=(eA($C(BC,tA("p2p-websocket-star"),tA("p2p")),$C(NC,tA("p2p-websocket-star"),tA("p2p")),$C(BC,tA("p2p-websocket-star")),$C(NC,tA("p2p-websocket-star"))),eA($C(FC,tA("p2p-webrtc-direct"),tA("p2p")),$C(UC,tA("p2p-webrtc-direct"),tA("p2p")),$C(FC,tA("p2p-webrtc-direct")),$C(UC,tA("p2p-webrtc-direct")))),KC=eA(MC,OC,FC,UC,qC,VC,TC,IC,PC,DC,jC,WC),YC=(eA($C(KC,tA("p2p-stardust"),tA("p2p")),$C(KC,tA("p2p-stardust"))),eA($C(KC,tA("p2p")),qC,VC,jC,WC,tA("p2p"))),GC=eA($C(YC,tA("p2p-circuit"),YC),$C(YC,tA("p2p-circuit")),$C(tA("p2p-circuit"),YC),$C(KC,tA("p2p-circuit")),$C(tA("p2p-circuit"),KC),tA("p2p-circuit")),QC=function e(){return eA($C(GC,e),GC)}(),XC=eA($C(QC,YC,QC),$C(YC,QC),$C(QC,YC),QC,YC);eA($C(QC,tA("webrtc"),tA("p2p")),$C(QC,tA("webrtc")),$C(KC,tA("webrtc"),tA("p2p")),$C(KC,tA("webrtc")),tA("webrtc"));function JC(e){return function(t){var r;try{r=kb(t)}catch(S$){return!1}var n=e(r.protoNames());return null!==n&&(!0===n||!1===n?n:0===n.length)}}function $C(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];function n(e){if(e.length<t.length)return null;var r=e;return t.some((function(t){return r="function"===typeof t?t().partialMatch(e):t.partialMatch(e),Array.isArray(r)&&(e=r),null===r})),r}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:JC(n),partialMatch:n}}function eA(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];function n(e){var r=null;return t.some((function(t){var n="function"===typeof t?t().partialMatch(e):t.partialMatch(e);return null!=n&&(r=n,!0)})),r}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:JC(n),partialMatch:n}}function tA(e){var t=e;return{toString:function(){return t},matches:function(e){var r;try{r=kb(e)}catch(S$){return!1}var n=r.protoNames();return 1===n.length&&n[0]===t},partialMatch:function(e){return 0===e.length?null:e[0]===t?e.slice(1):null}}}var rA=zi("libp2p:bootstrap");EC=Symbol.toStringTag;var nA=function(e){ia(r,e);var t=ua(r);function r(e){var n,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{list:[]};if((0,hi.Z)(this,r),null==a.list||0===a.list.length)throw new Error("Bootstrap requires a list of peer addresses");i=t.call(this),(0,we.Z)(ra(i),"timer",void 0),(0,we.Z)(ra(i),"list",void 0),(0,we.Z)(ra(i),"timeout",void 0),(0,we.Z)(ra(i),"components",void 0),(0,we.Z)(ra(i),"_init",void 0),(0,we.Z)(ra(i),Oy,ra(i)),(0,we.Z)(ra(i),EC,"@libp2p/bootstrap"),i.components=e,i.timeout=null!==(n=a.timeout)&&void 0!==n?n:1e3,i.list=[];var s,o=(0,ge.Z)(a.list);try{for(o.s();!(s=o.n()).done;){var u=s.value;if(XC.matches(u)){var c=kb(u),l=c.getPeerId();if(null!=l){var h={id:em(l),multiaddrs:[c],protocols:[]};i.list.push(h)}else rA.error("Invalid bootstrap multiaddr without peer id")}else rA.error("Invalid multiaddr")}}catch(S$){o.e(S$)}finally{o.f()}return i._init=a,i}return(0,fi.Z)(r,[{key:"isStarted",value:function(){return Boolean(this.timer)}},{key:"start",value:function(){var e=this;this.isStarted()||(rA("Starting bootstrap node discovery, discovering peers after %s ms",this.timeout),this.timer=setTimeout((function(){e._discoverBootstrapPeers().catch((function(e){rA.error(e)}))}),this.timeout))}},{key:"_discoverBootstrapPeers",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i,a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.timer){e.next=2;break}return e.abrupt("return");case 2:t=(0,ge.Z)(this.list),e.prev=3,t.s();case 5:if((r=t.n()).done){e.next=14;break}return s=r.value,e.next=9,this.components.peerStore.merge(s.id,{tags:(0,we.Z)({},null!==(n=this._init.tagName)&&void 0!==n?n:"bootstrap",{value:null!==(i=this._init.tagValue)&&void 0!==i?i:50,ttl:null!==(a=this._init.tagTTL)&&void 0!==a?a:12e4})});case 9:if(null!=this.timer){e.next=11;break}return e.abrupt("return");case 11:this.safeDispatchEvent("peer",{detail:s});case 12:e.next=5;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(3),t.e(e.t0);case 19:return e.prev=19,t.f(),e.finish(19);case 22:case"end":return e.stop()}}),e,this,[[3,16,19,22]])})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){null!=this.timer&&clearTimeout(this.timer),this.timer=void 0}}]),r}(Ly);function iA(e){return function(t){return new nA(t,e)}}function aA(e){return sA.apply(this,arguments)}function sA(){return sA=ea((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,ii.Z)().mark((function r(){var n,i;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=e.getReader(),r.prev=1;case 2:return r.next=5,Ji(n.read());case 5:if(!(i=r.sent).done){r.next=8;break}return r.abrupt("return");case 8:return r.next=10,i.value;case 10:r.next=2;break;case 12:if(r.prev=12,!0===t.preventCancel){r.next=16;break}return r.next=16,Ji(n.cancel());case 16:return n.releaseLock(),r.finish(12);case 18:case"end":return r.stop()}}),r,null,[[1,,12,18]])}))()})),sA.apply(this,arguments)}(0,we.Z)(nA,"tag","bootstrap");var oA=__webpack_require__(3925),uA=zi("ipni-content-routing"),cA=4,lA=3e4,hA=function(){function e(t){var r,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,hi.Z)(this,e),(0,we.Z)(this,"started",void 0),(0,we.Z)(this,"httpQueue",void 0),(0,we.Z)(this,"shutDownController",void 0),(0,we.Z)(this,"clientUrl",void 0),(0,we.Z)(this,"timeout",void 0),uA("enabled IPNI routing via",t),this.started=!1,this.shutDownController=new AbortController,this.httpQueue=new Bh({concurrency:null!==(r=i.concurrentRequests)&&void 0!==r?r:cA}),this.clientUrl=t instanceof URL?t:new URL(t),this.timeout=null!==(n=i.timeout)&&void 0!==n?n:lA}return(0,fi.Z)(e,[{key:"isStarted",value:function(){return this.started}},{key:"start",value:function(){this.started=!0}},{key:"stop",value:function(){this.httpQueue.clear(),this.shutDownController.abort(),this.started=!1}},{key:"findProviders",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l,h,f,d,p,v;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return uA("findProviders starts: %c",e),i=vo([t.shutDownController.signal,r.signal,AbortSignal.timeout(t.timeout)]),a=ts(),s=ts(),t.httpQueue.add((0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.resolve(),e.abrupt("return",s.promise);case 2:case"end":return e.stop()}}),e)})))),n.prev=5,n.next=8,Ji(a.promise);case 8:return o="".concat(t.clientUrl,"cid/").concat(e.toString(),"?cascade=ipfs-dht"),u={headers:{Accept:"application/x-ndjson"},signal:i},n.next=12,Ji(fetch(o,u));case 12:if(null!=(c=n.sent).body){n.next=15;break}throw new wo("IPNI response had no body","ERR_BAD_RESPONSE");case 15:l=!1,h=!1,n.prev=17,d=ui(oA(aA(c.body)));case 19:return n.next=21,Ji(d.next());case 21:if(!(l=!(p=n.sent).done)){n.next=30;break}if("gBI="===(v=p.value).Metadata){n.next=25;break}return n.abrupt("continue",27);case 25:return n.next=27,t.mapEvent(v);case 27:l=!1,n.next=19;break;case 30:n.next=36;break;case 32:n.prev=32,n.t0=n.catch(17),h=!0,f=n.t0;case 36:if(n.prev=36,n.prev=37,!l||null==d.return){n.next=41;break}return n.next=41,Ji(d.return());case 41:if(n.prev=41,!h){n.next=44;break}throw f;case 44:return n.finish(41);case 45:return n.finish(36);case 46:n.next=51;break;case 48:n.prev=48,n.t1=n.catch(5),uA.error("findProviders errored:",n.t1);case 51:return n.prev=51,i.clear(),s.resolve(),uA("findProviders finished: %c",e),n.finish(51);case 56:case"end":return n.stop()}}),n,null,[[5,48,51,56],[17,32,36,46],[37,,41,45]])})))()}},{key:"mapEvent",value:function(e){var t,r=em(e.Provider.ID),n=[],i=(0,ge.Z)(e.Provider.Addrs);try{for(i.s();!(t=i.n()).done;){var a=kb(t.value);n.push(a)}}catch(S$){i.e(S$)}finally{i.f()}return{id:r,multiaddrs:n,protocols:[]}}},{key:"provide",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"put",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new wo("Not found","ERR_NOT_FOUND");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}();function fA(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(){return new hA(e,t)}}var dA,pA,vA=1e3,gA="/dht/provider",yA=Number(3e5),mA=Number(Number(vA)),bA=Number(5e3),_A=Number(3e5),wA=Number(3e4),kA=Number(3e4),xA=null!==(dA=globalThis.CustomEvent)&&void 0!==dA?dA:Event;function EA(e){return SA.apply(this,arguments)}function SA(){return SA=ea((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,ii.Z)().mark((function r(n){var i,a,s,o,u,c,l,h,f,d,p,v,g,y;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:y=function(){var e,t;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!v()){r.next=21;break}e=0;case 2:if(!(e<c.length)){r.next=19;break}if(!c[e].done){r.next=16;break}if(t=c[e],c.splice(e,1),e--,!t.ok){r.next=12;break}return r.next=10,t.value;case 10:r.next=15;break;case 12:throw p=!0,l.resolve(),t.err;case 15:l.resolve();case 16:e++,r.next=2;break;case 19:r.next=0;break;case 21:case"end":return r.stop()}}),a)},g=function(){var e;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(c.length>0&&c[0].done)){t.next=14;break}if(e=c[0],c.shift(),!e.ok){t.next=8;break}return t.next=6,e.value;case 6:t.next=11;break;case 8:throw p=!0,l.resolve(),e.err;case 11:l.resolve(),t.next=0;break;case 14:case"end":return t.stop()}}),i)},v=function(){var e;return o?null===(e=c[0])||void 0===e?void 0:e.done:Boolean(c.find((function(e){return e.done})))},i=(0,ii.Z)().mark(g),a=(0,ii.Z)().mark(y),(s=null!==(n=t.concurrency)&&void 0!==n?n:1/0)<1&&(s=1/0),o=null!=t.ordered&&t.ordered,u=new EventTarget,c=[],l=ts(),h=ts(),f=!1,p=!1,u.addEventListener("task-complete",(function(){h.resolve()})),Promise.resolve().then((0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i,a,o,h;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,r=!1,n=!1,t.prev=3,a=(0,ii.Z)().mark((function e(){var t,r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=h.value,c.length!==s){e.next=5;break}return l=ts(),e.next=5,l.promise;case 5:if(!p){e.next=7;break}return e.abrupt("return",1);case 7:r={done:!1},c.push(r),t().then((function(e){r.done=!0,r.ok=!0,r.value=e,u.dispatchEvent(new xA("task-complete"))}),(function(e){r.done=!0,r.err=e,u.dispatchEvent(new xA("task-complete"))}));case 10:case"end":return e.stop()}}),e)})),o=ui(e);case 6:return t.next=8,o.next();case 8:if(!(r=!(h=t.sent).done)){t.next=15;break}return t.delegateYield(a(),"t0",10);case 10:if(!t.t0){t.next=12;break}return t.abrupt("break",15);case 12:r=!1,t.next=6;break;case 15:t.next=21;break;case 17:t.prev=17,t.t1=t.catch(3),n=!0,i=t.t1;case 21:if(t.prev=21,t.prev=22,!r||null==o.return){t.next=26;break}return t.next=26,o.return();case 26:if(t.prev=26,!n){t.next=29;break}throw i;case 29:return t.finish(26);case 30:return t.finish(21);case 31:f=!0,u.dispatchEvent(new xA("task-complete")),t.next=39;break;case 35:t.prev=35,t.t2=t.catch(0),d=t.t2,u.dispatchEvent(new xA("task-complete"));case 39:case"end":return t.stop()}}),t,null,[[0,35],[3,17,21,31],[22,,26,30]])}))));case 15:if(v()){r.next=20;break}return h=ts(),r.next=20,Ji(h.promise);case 20:if(null==d){r.next=22;break}throw d;case 22:if(!o){r.next=26;break}return r.delegateYield(Xa(ui(g())),"t0",24);case 24:r.next=27;break;case 26:return r.delegateYield(Xa(ui(y())),"t1",27);case 27:if(!f||0!==c.length){r.next=29;break}return r.abrupt("break",31);case 29:r.next=15;break;case 31:case"end":return r.stop()}}),r)}))()})),SA.apply(this,arguments)}function CA(e){var t=e.getUTCFullYear(),r=String(e.getUTCMonth()+1).padStart(2,"0"),n=String(e.getUTCDate()).padStart(2,"0"),i=String(e.getUTCHours()).padStart(2,"0"),a=String(e.getUTCMinutes()).padStart(2,"0"),s=String(e.getUTCSeconds()).padStart(2,"0"),o=e.getUTCMilliseconds(),u=String(1e3*o*1e3).padStart(9,"0");return"".concat(t,"-").concat(r,"-").concat(n,"T").concat(i,":").concat(a,":").concat(s,".").concat(u,"Z")}!function(e){var t;e.codec=function(){return null==t&&(t=Xo((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&t.fork(),null!=e.key&&e.key.byteLength>0&&(t.uint32(10),t.bytes(e.key)),null!=e.value&&e.value.byteLength>0&&(t.uint32(18),t.bytes(e.value)),null!=e.timeReceived&&""!==e.timeReceived&&(t.uint32(42),t.string(e.timeReceived)),!1!==r.lengthDelimited&&t.ldelim()}),(function(e,t){for(var r={key:new Uint8Array(0),value:new Uint8Array(0),timeReceived:""},n=null==t?e.len:e.pos+t;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.key=e.bytes();break;case 2:r.value=e.bytes();break;case 5:r.timeReceived=e.string();break;default:e.skipType(7&i)}}return r}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(pA||(pA={}));var AA,DA,RA=function(){function e(t,r,n){if((0,hi.Z)(this,e),(0,we.Z)(this,"key",void 0),(0,we.Z)(this,"value",void 0),(0,we.Z)(this,"timeReceived",void 0),!(t instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(r instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=t,this.value=r,this.timeReceived=n}return(0,fi.Z)(e,[{key:"serialize",value:function(){return pA.encode(this.prepareSerialize())}},{key:"prepareSerialize",value:function(){return{key:this.key,value:this.value,timeReceived:CA(this.timeReceived)}}}],[{key:"deserialize",value:function(t){var r=pA.decode(t);return new e(r.key,r.value,new Date(r.timeReceived))}},{key:"fromDeserialized",value:function(t){var r=function(e){var t=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),r=String(e).trim().match(t);if(null==r)throw new Error("Invalid format");var n=parseInt(r[1],10),i=parseInt(r[2],10)-1,a=parseInt(r[3],10),s=parseInt(r[4],10),o=parseInt(r[5],10),u=parseInt(r[6],10),c=parseInt(r[7].slice(0,-6),10);return new Date(Date.UTC(n,i,a,s,o,u,c))}(t.timeReceived);if(null==t.key)throw new Error("key missing from deserialized object");if(null==t.value)throw new Error("value missing from deserialized object");return new e(t.key,t.value,r)}}]),e}();!function(e){var t;e.codec=function(){return null==t&&(t=Xo((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&t.fork(),null!=e.key&&(t.uint32(10),t.bytes(e.key)),null!=e.value&&(t.uint32(18),t.bytes(e.value)),null!=e.author&&(t.uint32(26),t.bytes(e.author)),null!=e.signature&&(t.uint32(34),t.bytes(e.signature)),null!=e.timeReceived&&(t.uint32(42),t.string(e.timeReceived)),!1!==r.lengthDelimited&&t.ldelim()}),(function(e,t){for(var r={},n=null==t?e.len:e.pos+t;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.key=e.bytes();break;case 2:r.value=e.bytes();break;case 3:r.author=e.bytes();break;case 4:r.signature=e.bytes();break;case 5:r.timeReceived=e.string();break;default:e.skipType(7&i)}}return r}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(AA||(AA={})),function(e){var t,r,n;!function(e){e.PUT_VALUE="PUT_VALUE",e.GET_VALUE="GET_VALUE",e.ADD_PROVIDER="ADD_PROVIDER",e.GET_PROVIDERS="GET_PROVIDERS",e.FIND_NODE="FIND_NODE",e.PING="PING"}(e.MessageType||(e.MessageType={})),function(e){e[e.PUT_VALUE=0]="PUT_VALUE",e[e.GET_VALUE=1]="GET_VALUE",e[e.ADD_PROVIDER=2]="ADD_PROVIDER",e[e.GET_PROVIDERS=3]="GET_PROVIDERS",e[e.FIND_NODE=4]="FIND_NODE",e[e.PING=5]="PING"}(t||(t={})),function(e){e.codec=function(){return Qo(t)}}(e.MessageType||(e.MessageType={})),function(e){e.NOT_CONNECTED="NOT_CONNECTED",e.CONNECTED="CONNECTED",e.CAN_CONNECT="CAN_CONNECT",e.CANNOT_CONNECT="CANNOT_CONNECT"}(e.ConnectionType||(e.ConnectionType={})),function(e){e[e.NOT_CONNECTED=0]="NOT_CONNECTED",e[e.CONNECTED=1]="CONNECTED",e[e.CAN_CONNECT=2]="CAN_CONNECT",e[e.CANNOT_CONNECT=3]="CANNOT_CONNECT"}(r||(r={})),function(e){e.codec=function(){return Qo(r)}}(e.ConnectionType||(e.ConnectionType={})),function(t){var r;t.codec=function(){return null==r&&(r=Xo((function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&r.fork(),null!=t.id&&(r.uint32(10),r.bytes(t.id)),null!=t.addrs){var i,a=(0,ge.Z)(t.addrs);try{for(a.s();!(i=a.n()).done;){var s=i.value;r.uint32(18),r.bytes(s)}}catch(S$){a.e(S$)}finally{a.f()}}null!=t.connection&&(r.uint32(24),e.ConnectionType.codec().encode(t.connection,r)),!1!==n.lengthDelimited&&r.ldelim()}),(function(t,r){for(var n={addrs:[]},i=null==r?t.len:t.pos+r;t.pos<i;){var a=t.uint32();switch(a>>>3){case 1:n.id=t.bytes();break;case 2:n.addrs.push(t.bytes());break;case 3:n.connection=e.ConnectionType.codec().decode(t);break;default:t.skipType(7&a)}}return n}))),r},t.encode=function(e){return Yo(e,t.codec())},t.decode=function(e){return Ko(e,t.codec())}}(e.Peer||(e.Peer={})),e.codec=function(){return null==n&&(n=Xo((function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&r.fork(),null!=t.type&&(r.uint32(8),e.MessageType.codec().encode(t.type,r)),null!=t.clusterLevelRaw&&(r.uint32(80),r.int32(t.clusterLevelRaw)),null!=t.key&&(r.uint32(18),r.bytes(t.key)),null!=t.record&&(r.uint32(26),r.bytes(t.record)),null!=t.closerPeers){var i,a=(0,ge.Z)(t.closerPeers);try{for(a.s();!(i=a.n()).done;){var s=i.value;r.uint32(66),e.Peer.codec().encode(s,r)}}catch(S$){a.e(S$)}finally{a.f()}}if(null!=t.providerPeers){var o,u=(0,ge.Z)(t.providerPeers);try{for(u.s();!(o=u.n()).done;){var c=o.value;r.uint32(74),e.Peer.codec().encode(c,r)}}catch(S$){u.e(S$)}finally{u.f()}}!1!==n.lengthDelimited&&r.ldelim()}),(function(t,r){for(var n={closerPeers:[],providerPeers:[]},i=null==r?t.len:t.pos+r;t.pos<i;){var a=t.uint32();switch(a>>>3){case 1:n.type=e.MessageType.codec().decode(t);break;case 10:n.clusterLevelRaw=t.int32();break;case 2:n.key=t.bytes();break;case 3:n.record=t.bytes();break;case 8:n.closerPeers.push(e.Peer.codec().decode(t,t.uint32()));break;case 9:n.providerPeers.push(e.Peer.codec().decode(t,t.uint32()));break;default:t.skipType(7&a)}}return n}))),n},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(DA||(DA={}));var TA=DA.MessageType,ZA=DA.ConnectionType,IA=Object.keys(TA),PA=function(){function e(t,r,n){if((0,hi.Z)(this,e),(0,we.Z)(this,"type",void 0),(0,we.Z)(this,"key",void 0),(0,we.Z)(this,"clusterLevelRaw",void 0),(0,we.Z)(this,"closerPeers",void 0),(0,we.Z)(this,"providerPeers",void 0),(0,we.Z)(this,"record",void 0),!(r instanceof Uint8Array))throw new Error("Key must be a Uint8Array");this.type=t,this.key=r,this.clusterLevelRaw=n,this.closerPeers=[],this.providerPeers=[],this.record=void 0}return(0,fi.Z)(e,[{key:"clusterLevel",get:function(){var e=this.clusterLevelRaw-1;return e<0?0:e},set:function(e){this.clusterLevelRaw=e}},{key:"serialize",value:function(){return DA.encode({key:this.key,type:this.type,clusterLevelRaw:this.clusterLevelRaw,closerPeers:this.closerPeers.map(LA),providerPeers:this.providerPeers.map(LA),record:null==this.record?void 0:this.record.serialize().subarray()})}}],[{key:"deserialize",value:function(t){var r,n,i,a,s=DA.decode(t),o=new e(null!==(r=s.type)&&void 0!==r?r:DA.MessageType.PUT_VALUE,null!==(n=s.key)&&void 0!==n?n:Uint8Array.from([]),null!==(i=s.clusterLevelRaw)&&void 0!==i?i:0);return o.closerPeers=s.closerPeers.map(MA),o.providerPeers=s.providerPeers.map(MA),null!=(null===(a=s.record)||void 0===a?void 0:a.length)&&(o.record=RA.deserialize(s.record)),o}}]),e}();function LA(e){var t;return{id:e.id.toBytes(),addrs:(null!==(t=e.multiaddrs)&&void 0!==t?t:[]).map((function(e){return e.bytes})),connection:ZA.CONNECTED}}function MA(e){var t;if(null==e.id)throw new Error("Invalid peer in message");return{id:tm(e.id),multiaddrs:(null!==(t=e.addrs)&&void 0!==t?t:[]).map((function(e){return kb(e)})),protocols:[]}}function BA(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,_e.Z)((0,_e.Z)({},e),{},{name:"SEND_QUERY",type:0,messageName:e.type,messageType:IA.indexOf(e.type.toString())});return null===(t=r.onProgress)||void 0===t||t.call(r,new By("kad-dht:query:send-query",{detail:n})),n}function OA(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,_e.Z)((0,_e.Z)({},e),{},{name:"PEER_RESPONSE",type:1,messageName:e.messageType,closer:null!=e.closer?e.closer:[],providers:null!=e.providers?e.providers:[]});return null===(t=r.onProgress)||void 0===t||t.call(r,new By("kad-dht:query:peer-response",{detail:n})),n}function NA(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,_e.Z)((0,_e.Z)({},e),{},{name:"FINAL_PEER",type:2});return null===(t=r.onProgress)||void 0===t||t.call(r,new By("kad-dht:query:final-peer",{detail:n})),n}function FA(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,_e.Z)((0,_e.Z)({},e),{},{name:"QUERY_ERROR",type:3});return null===(t=r.onProgress)||void 0===t||t.call(r,new By("kad-dht:query:query-error",{detail:n})),n}function UA(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,_e.Z)((0,_e.Z)({},e),{},{name:"PROVIDER",type:4});return null===(t=r.onProgress)||void 0===t||t.call(r,new By("kad-dht:query:provider",{detail:n})),n}function zA(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,_e.Z)((0,_e.Z)({},e),{},{name:"VALUE",type:5});return null===(t=r.onProgress)||void 0===t||t.call(r,new By("kad-dht:query:value",{detail:n})),n}function jA(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,_e.Z)((0,_e.Z)({},e),{},{name:"DIAL_PEER",type:7});return null===(t=r.onProgress)||void 0===t||t.call(r,new By("kad-dht:query:dial-peer",{detail:n})),n}function HA(e,t,r){if(0===r.length){throw new wo("No records given","ERR_NO_RECORDS_RECEIVED")}var n=Ws(t).split("/");if(n.length<3){throw new wo("Record key does not have a selector function","ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")}var i=e[n[1].toString()];if(null==i){var a="Unrecognized key prefix: ".concat(n[1]);throw new wo(a,"ERR_UNRECOGNIZED_KEY_PREFIX")}return 1===r.length?0:i(t,r)}var WA={pk:function(e,t){return 0}};function qA(e,t){return VA.apply(this,arguments)}function VA(){return VA=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.key,i=Ws(n),!((a=i.split("/")).length<3)){e.next=5;break}return e.abrupt("return");case 5:if(null!=(s=t[a[1].toString()])){e.next=9;break}throw"Invalid record keytype",new wo("Invalid record keytype","ERR_INVALID_RECORD_KEY_TYPE");case 9:return e.next=11,s(n,r.value);case 11:case"end":return e.stop()}}),e)}))),VA.apply(this,arguments)}var KA=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof Uint8Array){e.next=2;break}throw new wo('"key" must be a Uint8Array',"ERR_INVALID_RECORD_KEY_NOT_BUFFER");case 2:if(!(t.byteLength<5)){e.next=4;break}throw new wo("invalid public key record","ERR_INVALID_RECORD_KEY_TOO_SHORT");case 4:if("/pk/"===Ws(t.subarray(0,4))){e.next=7;break}throw new wo("key was not prefixed with /pk/","ERR_INVALID_RECORD_KEY_BAD_PREFIX");case 7:return n=t.slice(4),e.next=10,Ps.digest(r);case 10:if(i=e.sent,Ao(n,i.bytes)){e.next=13;break}throw new wo("public key does not match passed in key","ERR_INVALID_RECORD_HASH_MISMATCH");case 13:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),YA={pk:KA},GA=Hs("/pk/");function QA(e){return(0,_e.Z)((0,_e.Z)({},e),{},{multiaddrs:e.multiaddrs.filter((function(e){var t=e.stringTuples(),r=(0,ke.Z)(t,1),n=(0,ke.Z)(r[0],2),i=n[0],a=n[1];if(53===i||54===i||55===i)return"localhost"!==a;if(4!==i&&6!==i)return!1;if(null==a)return!1;var s=S_(a);return null==s||!s}))})}function XA(e){return(0,_e.Z)((0,_e.Z)({},e),{},{multiaddrs:e.multiaddrs.filter((function(e){var t=e.stringTuples(),r=(0,ke.Z)(t,1),n=(0,ke.Z)(r[0],2),i=n[0],a=n[1];if("localhost"===a)return!0;if(4!==i&&6!==i)return!1;if(null==a)return!1;var s=S_(a);return null!=s&&s}))})}function JA(e){return $A.apply(this,arguments)}function $A(){return $A=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ps.digest(t);case 2:return r=e.sent,e.abrupt("return",r.digest);case 4:case"end":return e.stop()}}),e)}))),$A.apply(this,arguments)}function eD(e){return tD.apply(this,arguments)}function tD(){return tD=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",JA(t.toBytes()));case 1:case"end":return e.stop()}}),e)}))),tD.apply(this,arguments)}function rD(e){return new Ys("".concat("/dht/record","/").concat(Ws(e,"base32")),!1)}function nD(e){return Eu([GA,e.toBytes()])}function iD(e){return"/pk/"===Ws(e.subarray(0,4))}function aD(e){return tm(e.subarray(4))}function sD(e,t){var r=new Date;return new RA(e,t,r).serialize()}var oD=function(){function e(t,r){(0,hi.Z)(this,e),(0,we.Z)(this,"log",void 0),(0,we.Z)(this,"components",void 0),(0,we.Z)(this,"validators",void 0),(0,we.Z)(this,"selectors",void 0),(0,we.Z)(this,"peerRouting",void 0),(0,we.Z)(this,"queryManager",void 0),(0,we.Z)(this,"network",void 0);var n=r.validators,i=r.selectors,a=r.peerRouting,s=r.queryManager,o=r.network,u=r.lan;this.components=t,this.log=zi("libp2p:kad-dht:".concat(u?"lan":"wan",":content-fetching")),this.validators=n,this.selectors=i,this.peerRouting=a,this.queryManager=s,this.network=o}return(0,fi.Z)(e,[{key:"putLocal",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=rD(t),e.next=3,this.components.datastore.put(n,r);case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getLocal",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.log("getLocal %b",t),r=rD(t),this.log("fetching record for key %k",r),e.next=5,this.components.datastore.get(r);case 5:return n=e.sent,this.log("found %k in local datastore",r),i=RA.deserialize(n),e.next=10,qA(this.validators,i);case 10:return e.abrupt("return",i);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendCorrectionRecord",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return ea((0,ii.Z)().mark((function a(){var s,o,u,c,l,h,f,d,p,v,g,y,m,b,_;return(0,ii.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n.log("sendCorrection for %b",e),s=sD(e,r),o=(0,ge.Z)(t),a.prev=3,o.s();case 5:if((u=o.n()).done){a.next=61;break}if(c=u.value,l=c.value,h=c.from,!Ao(l,r)){a.next=10;break}return n.log("record was ok"),a.abrupt("continue",59);case 10:if(!n.components.peerId.equals(h)){a.next=22;break}return a.prev=11,f=rD(e),n.log("Storing corrected record for key ".concat(f.toString())),a.next=16,Ji(n.components.datastore.put(f,s.subarray()));case 16:a.next=21;break;case 18:a.prev=18,a.t0=a.catch(11),n.log.error("Failed error correcting self",a.t0);case 21:return a.abrupt("continue",59);case 22:d=!1,(p=new PA(TA.PUT_VALUE,e,0)).record=RA.deserialize(s),v=!1,g=!1,a.prev=27,m=ui(n.network.sendRequest(h,p,i));case 29:return a.next=31,Ji(m.next());case 31:if(!(v=!(b=a.sent).done)){a.next=39;break}return"PEER_RESPONSE"===(_=b.value).name&&null!=_.record&&Ao(_.record.value,RA.deserialize(s).value)&&(d=!0),a.next=36,_;case 36:v=!1,a.next=29;break;case 39:a.next=45;break;case 41:a.prev=41,a.t1=a.catch(27),g=!0,y=a.t1;case 45:if(a.prev=45,a.prev=46,!v||null==m.return){a.next=50;break}return a.next=50,Ji(m.return());case 50:if(a.prev=50,!g){a.next=53;break}throw y;case 53:return a.finish(50);case 54:return a.finish(45);case 55:if(d){a.next=58;break}return a.next=58,FA({from:h,error:new wo("value not put correctly","ERR_PUT_VALUE_INVALID")},i);case 58:n.log.error("Failed error correcting entry");case 59:a.next=5;break;case 61:a.next=66;break;case 63:a.prev=63,a.t2=a.catch(3),o.e(a.t2);case 66:return a.prev=66,o.f(),a.finish(66);case 69:case"end":return a.stop()}}),a,null,[[3,63,66,69],[11,18],[27,41,45,55],[46,,50,54]])})))()}},{key:"put",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ea((0,ii.Z)().mark((function i(){var a,s;return(0,ii.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return r.log("put key %b value %b",e,t),a=sD(e,t),s=rD(e),r.log("storing record for key ".concat(s.toString())),i.next=6,Ji(r.components.datastore.put(s,a.subarray()));case 6:return i.delegateYield(Xa(ui(no(r.peerRouting.getClosestPeers(e,{signal:n.signal}),(function(t){return ro(t,(function(t){return(0,ai.Z)((0,ii.Z)().mark((function i(){var s,o,u,c,l,h,f,d;return(0,ii.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if("FINAL_PEER"===t.name){i.next=2;break}return i.abrupt("return",[t]);case 2:s=[],(o=new PA(TA.PUT_VALUE,e,0)).record=RA.deserialize(a),r.log("send put to %p",t.peer.id),u=!1,c=!1,i.prev=8,h=ui(r.network.sendRequest(t.peer.id,o,n));case 10:return i.next=12,h.next();case 12:if(!(u=!(f=i.sent).done)){i.next=21;break}if(d=f.value,s.push(d),"PEER_RESPONSE"===d.name){i.next=17;break}return i.abrupt("continue",18);case 17:null!=d.record&&Ao(d.record.value,RA.deserialize(a).value)||s.push(FA({from:t.peer.id,error:new wo("value not put correctly","ERR_PUT_VALUE_INVALID")},n));case 18:u=!1,i.next=10;break;case 21:i.next=27;break;case 23:i.prev=23,i.t0=i.catch(8),c=!0,l=i.t0;case 27:if(i.prev=27,i.prev=28,!u||null==h.return){i.next=32;break}return i.next=32,h.return();case 32:if(i.prev=32,!c){i.next=35;break}throw l;case 35:return i.finish(32);case 36:return i.finish(27);case 37:return i.abrupt("return",s);case 38:case"end":return i.stop()}}),i,null,[[8,23,27,37],[28,,32,36]])})))}))}),(function(e){return EA(e,{ordered:!1,concurrency:3})}),function(){var e=ea((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!1,n=!1,e.prev=2,a=ui(t);case 4:return e.next=6,Ji(a.next());case 6:if(!(r=!(s=e.sent).done)){e.next=12;break}return o=s.value,e.delegateYield(Xa(ui(o)),"t0",9);case 9:r=!1,e.next=4;break;case 12:e.next=18;break;case 14:e.prev=14,e.t1=e.catch(2),n=!0,i=e.t1;case 18:if(e.prev=18,e.prev=19,!r||null==a.return){e.next=23;break}return e.next=23,Ji(a.return());case 23:if(e.prev=23,!n){e.next=26;break}throw i;case 26:return e.finish(23);case 27:return e.finish(18);case 28:case"end":return e.stop()}}),e,null,[[2,14,18,28],[19,,23,27]])})));return function(t){return e.apply(this,arguments)}}()))),"t0",7);case 7:case"end":return i.stop()}}),i)})))()}},{key:"get",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l,h,f,d;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t.log("get %b",e),i=[],a=!1,s=!1,n.prev=4,u=ui(t.getMany(e,r));case 6:return n.next=8,Ji(u.next());case 8:if(!(a=!(c=n.sent).done)){n.next=16;break}return"VALUE"===(l=c.value).name&&i.push(l),n.next=13,l;case 13:a=!1,n.next=6;break;case 16:n.next=22;break;case 18:n.prev=18,n.t0=n.catch(4),s=!0,o=n.t0;case 22:if(n.prev=22,n.prev=23,!a||null==u.return){n.next=27;break}return n.next=27,Ji(u.return());case 27:if(n.prev=27,!s){n.next=30;break}throw o;case 30:return n.finish(27);case 31:return n.finish(22);case 32:if(0!==i.length){n.next=34;break}return n.abrupt("return");case 34:h=i.map((function(e){return e.value})),f=0,n.prev=36,f=HA(t.selectors,e,h),n.next=44;break;case 40:if(n.prev=40,n.t1=n.catch(36),"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY"===n.t1.code){n.next=44;break}throw n.t1;case 44:if(d=h[f],t.log("GetValue %b %b",e,d),null!=d){n.next=48;break}throw new wo("best value was not found","ERR_NOT_FOUND");case 48:return n.delegateYield(Xa(ui(t.sendCorrectionRecord(e,i,d,r))),"t2",49);case 49:return n.next=51,i[f];case 51:case"end":return n.stop()}}),n,null,[[4,18,22,32],[23,,27,31],[36,40]])})))()}},{key:"getMany",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){var i,a,s;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.log("getMany values for %b",e),n.prev=1,n.next=4,Ji(t.getLocal(e));case 4:return i=n.sent,n.next=7,zA({value:i.value,from:t.components.peerId},r);case 7:n.next=12;break;case 9:n.prev=9,n.t0=n.catch(1),t.log("error getting local value for %b",e,n.t0);case 12:return a=t,s=function(){var t=ea((function(t){var n=t.peer,i=t.signal;return(0,ii.Z)().mark((function t(){var s,o,u,c,l,h;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s=!1,o=!1,t.prev=2,c=ui(a.peerRouting.getValueOrPeers(n,e,{signal:i}));case 4:return t.next=6,Ji(c.next());case 6:if(!(s=!(l=t.sent).done)){t.next=16;break}return h=l.value,t.next=10,h;case 10:if("PEER_RESPONSE"!==h.name||null==h.record){t.next=13;break}return t.next=13,zA({from:n,value:h.record.value},r);case 13:s=!1,t.next=4;break;case 16:t.next=22;break;case 18:t.prev=18,t.t0=t.catch(2),o=!0,u=t.t0;case 22:if(t.prev=22,t.prev=23,!s||null==c.return){t.next=27;break}return t.next=27,Ji(c.return());case 27:if(t.prev=27,!o){t.next=30;break}throw u;case 30:return t.finish(27);case 31:return t.finish(22);case 32:case"end":return t.stop()}}),t,null,[[2,18,22,32],[23,,27,31]])}))()}));return function(e){return t.apply(this,arguments)}}(),n.delegateYield(Xa(ui(t.queryManager.run(e,s,r))),"t1",15);case 15:case"end":return n.stop()}}),n,null,[[1,9]])})))()}}]),e}(),uD=function(){function e(t,r){(0,hi.Z)(this,e),(0,we.Z)(this,"log",void 0),(0,we.Z)(this,"components",void 0),(0,we.Z)(this,"network",void 0),(0,we.Z)(this,"peerRouting",void 0),(0,we.Z)(this,"queryManager",void 0),(0,we.Z)(this,"routingTable",void 0),(0,we.Z)(this,"providers",void 0);var n=r.network,i=r.peerRouting,a=r.queryManager,s=r.routingTable,o=r.providers,u=r.lan;this.components=t,this.log=zi("libp2p:kad-dht:".concat(u?"lan":"wan",":content-routing")),this.network=n,this.peerRouting=i,this.queryManager=a,this.routingTable=s,this.providers=o}return(0,fi.Z)(e,[{key:"provide",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ea((0,ii.Z)().mark((function i(){var a,s,o;return(0,ii.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return r.log("provide %s",e),i.next=3,Ji(r.providers.addProvider(e,r.components.peerId));case 3:return(a=new PA(TA.ADD_PROVIDER,e.multihash.bytes,0)).providerPeers=[{id:r.components.peerId,multiaddrs:t,protocols:[]}],s=0,o=function(t){return(0,ai.Z)((0,ii.Z)().mark((function i(){var o,u,c,l,h,f,d;return(0,ii.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if("FINAL_PEER"===t.name){i.next=2;break}return i.abrupt("return",[t]);case 2:o=[],r.log("putProvider %s to %p",e,t.peer.id),i.prev=4,r.log("sending provider record for %s to %p",e,t.peer.id),u=!1,c=!1,i.prev=8,h=ui(r.network.sendMessage(t.peer.id,a,n));case 10:return i.next=12,h.next();case 12:if(!(u=!(f=i.sent).done)){i.next=19;break}"PEER_RESPONSE"===(d=f.value).name&&(r.log("sent provider record for %s to %p",e,t.peer.id),s++),o.push(d);case 16:u=!1,i.next=10;break;case 19:i.next=25;break;case 21:i.prev=21,i.t0=i.catch(8),c=!0,l=i.t0;case 25:if(i.prev=25,i.prev=26,!u||null==h.return){i.next=30;break}return i.next=30,h.return();case 30:if(i.prev=30,!c){i.next=33;break}throw l;case 33:return i.finish(30);case 34:return i.finish(25);case 35:i.next=41;break;case 37:i.prev=37,i.t1=i.catch(4),r.log.error("error sending provide record to peer %p",t.peer.id,i.t1),o.push(FA({from:t.peer.id,error:i.t1},n));case 41:return i.abrupt("return",o);case 42:case"end":return i.stop()}}),i,null,[[4,37],[8,21,25,35],[26,,30,34]])})))},i.delegateYield(Xa(ui(no(r.peerRouting.getClosestPeers(e.multihash.bytes,n),(function(e){return ro(e,(function(e){return o(e)}))}),(function(e){return EA(e,{ordered:!1,concurrency:3})}),function(){var e=ea((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!1,n=!1,e.prev=2,a=ui(t);case 4:return e.next=6,Ji(a.next());case 6:if(!(r=!(s=e.sent).done)){e.next=12;break}return o=s.value,e.delegateYield(Xa(ui(o)),"t0",9);case 9:r=!1,e.next=4;break;case 12:e.next=18;break;case 14:e.prev=14,e.t1=e.catch(2),n=!0,i=e.t1;case 18:if(e.prev=18,e.prev=19,!r||null==a.return){e.next=23;break}return e.next=23,Ji(a.return());case 23:if(e.prev=23,!n){e.next=26;break}throw i;case 26:return e.finish(23);case 27:return e.finish(18);case 28:case"end":return e.stop()}}),e,null,[[2,14,18,28],[19,,23,27]])})));return function(t){return e.apply(this,arguments)}}()))),"t0",8);case 8:r.log("sent provider records to %d peers",s);case 9:case"end":return i.stop()}}),i)})))()}},{key:"findProviders",value:function(e,t){var r=this;return ea((0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l,h,f,d,p,v,g,y,m,b,_,w,k,x,E;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=r.routingTable.kBucketSize,a=e.multihash.bytes,s=r,r.log("findProviders %c",e),n.next=6,Ji(r.providers.getProviders(e));case 6:if(!((o=n.sent).length>0)){n.next=40;break}u=[],c=(0,ge.Z)(o.slice(0,i)),n.prev=10,c.s();case 12:if((l=c.n()).done){n.next=28;break}return h=l.value,n.prev=14,n.next=17,Ji(r.components.peerStore.get(h));case 17:f=n.sent,u.push({id:h,multiaddrs:f.addresses.map((function(e){return e.multiaddr})),protocols:f.protocols}),n.next=26;break;case 21:if(n.prev=21,n.t0=n.catch(14),"ERR_NOT_FOUND"===n.t0.code){n.next=25;break}throw n.t0;case 25:r.log("no peer store entry for %p",h);case 26:n.next=12;break;case 28:n.next=33;break;case 30:n.prev=30,n.t1=n.catch(10),c.e(n.t1);case 33:return n.prev=33,c.f(),n.finish(33);case 36:return n.next=38,OA({from:r.components.peerId,messageType:TA.GET_PROVIDERS,providers:u},t);case 38:return n.next=40,UA({from:r.components.peerId,providers:u},t);case 40:if(!(o.length>=i)){n.next=42;break}return n.abrupt("return");case 42:d=function(){var e=ea((function(e){var r=e.peer,n=e.signal;return(0,ii.Z)().mark((function e(){var i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new PA(TA.GET_PROVIDERS,a,0),e.delegateYield(Xa(ui(s.network.sendRequest(r,i,(0,_e.Z)((0,_e.Z)({},t),{},{signal:n})))),"t0",2);case 2:case"end":return e.stop()}}),e)}))()}));return function(t){return e.apply(this,arguments)}}(),p=new Set(o.map((function(e){return e.toString()}))),v=!1,g=!1,n.prev=46,m=ui(r.queryManager.run(a,d,t));case 48:return n.next=50,Ji(m.next());case 50:if(!(v=!(b=n.sent).done)){n.next=84;break}return _=b.value,n.next=54,_;case 54:if("PEER_RESPONSE"!==_.name){n.next=81;break}r.log("Found %d provider entries for %c and %d closer peers",_.providers.length,e,_.closer.length),w=[],k=(0,ge.Z)(_.providers),n.prev=58,k.s();case 60:if((x=k.n()).done){n.next=68;break}if(E=x.value,!p.has(E.id.toString())){n.next=64;break}return n.abrupt("continue",66);case 64:p.add(E.id.toString()),w.push(E);case 66:n.next=60;break;case 68:n.next=73;break;case 70:n.prev=70,n.t2=n.catch(58),k.e(n.t2);case 73:return n.prev=73,k.f(),n.finish(73);case 76:if(!(w.length>0)){n.next=79;break}return n.next=79,UA({from:_.from,providers:w},t);case 79:if(p.size!==i){n.next=81;break}return n.abrupt("return");case 81:v=!1,n.next=48;break;case 84:n.next=90;break;case 86:n.prev=86,n.t3=n.catch(46),g=!0,y=n.t3;case 90:if(n.prev=90,n.prev=91,!v||null==m.return){n.next=95;break}return n.next=95,Ji(m.return());case 95:if(n.prev=95,!g){n.next=98;break}throw y;case 98:return n.finish(95);case 99:return n.finish(90);case 100:case"end":return n.stop()}}),n,null,[[10,30,33,36],[14,21],[46,86,90,100],[58,70,73,76],[91,,95,99]])})))()}}]),e}(),cD=function(e){ia(r,e);var t=ua(r);function r(e,n){var i;(0,hi.Z)(this,r),i=t.call(this),(0,we.Z)(ra(i),"log",void 0),(0,we.Z)(ra(i),"protocol",void 0),(0,we.Z)(ra(i),"running",void 0),(0,we.Z)(ra(i),"components",void 0);var a=n.protocol,s=n.lan;return i.components=e,i.log=zi("libp2p:kad-dht:".concat(s?"lan":"wan",":network")),i.running=!1,i.protocol=a,i}return(0,fi.Z)(r,[{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.running){e.next=2;break}return e.abrupt("return");case 2:this.running=!0;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.running=!1;case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isStarted",value:function(){return this.running}},{key:"sendRequest",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ea((0,ii.Z)().mark((function i(){var a,s,o;return(0,ii.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(r.running){i.next=2;break}return i.abrupt("return");case 2:return r.log("sending %s to %p",t.type,e),i.next=5,jA({peer:e},n);case 5:return i.next=7,BA({to:e,type:t.type},n);case 7:return i.prev=7,i.next=10,Ji(r.components.connectionManager.openConnection(e,n));case 10:return a=i.sent,i.next=13,Ji(a.newStream(r.protocol,n));case 13:return s=i.sent,i.next=16,Ji(r._writeReadMessage(s,t.serialize(),n));case 16:return o=i.sent,i.next=19,OA({from:e,messageType:o.type,closer:o.closerPeers,providers:o.providerPeers,record:o.record},n);case 19:i.next=25;break;case 21:return i.prev=21,i.t0=i.catch(7),i.next=25,FA({from:e,error:i.t0},n);case 25:i.prev=25,i.next=29;break;case 29:return i.finish(25);case 30:case"end":return i.stop()}}),i,null,[[7,21,25,30]])})))()}},{key:"sendMessage",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ea((0,ii.Z)().mark((function i(){var a,s;return(0,ii.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(r.running){i.next=2;break}return i.abrupt("return");case 2:return r.log("sending %s to %p",t.type,e),i.next=5,jA({peer:e},n);case 5:return i.next=7,BA({to:e,type:t.type},n);case 7:return i.prev=7,i.next=10,Ji(r.components.connectionManager.openConnection(e,n));case 10:return a=i.sent,i.next=13,Ji(a.newStream(r.protocol,n));case 13:return s=i.sent,i.next=16,Ji(r._writeMessage(s,t.serialize(),n));case 16:return i.next=18,OA({from:e,messageType:t.type},n);case 18:i.next=24;break;case 20:return i.prev=20,i.t0=i.catch(7),i.next=24,FA({from:e,error:i.t0},n);case 24:i.prev=24,i.next=28;break;case 28:return i.finish(24);case 29:case"end":return i.stop()}}),i,null,[[7,20,24,29]])})))()}},{key:"_writeMessage",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null!=n.signal&&(t=Ak(t,n.signal)),e.next=3,no([r],(function(e){return Zu(e)}),t,Qs);case 3:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_writeReadMessage",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a,s=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null!=n.signal&&(t=Ak(t,n.signal)),e.next=3,no([r],(function(e){return Zu(e)}),t,(function(e){return Bu(e)}),function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pk(t);case 2:if(null==(r=e.sent)){e.next=5;break}return e.abrupt("return",r);case 5:throw new wo("No message received","ERR_NO_MESSAGE_RECEIVED");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:return i=e.sent,(a=PA.deserialize(i)).closerPeers.forEach((function(e){s.dispatchEvent(new By("peer",{detail:e}))})),a.providerPeers.forEach((function(e){s.dispatchEvent(new By("peer",{detail:e}))})),e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),r}(Ly);function lD(e,t){for(var r=0;r<e.byteLength;r++){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0}function hD(e,t){if(e.length!==t.length)throw new Error("Inputs should have the same length");for(var r=Os(e.length),n=0;n<e.length;n++)r[n]=e[n]^t[n];return cs(r)}var fD=function(){function e(t,r){(0,hi.Z)(this,e),(0,we.Z)(this,"originDhtKey",void 0),(0,we.Z)(this,"capacity",void 0),(0,we.Z)(this,"peerDistances",void 0),this.originDhtKey=t,this.capacity=r,this.peerDistances=[]}return(0,fi.Z)(e,[{key:"length",get:function(){return this.peerDistances.length}},{key:"peers",get:function(){return this.peerDistances.map((function(e){return e.peerId}))}},{key:"add",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.peerDistances.find((function(e){return e.peerId.equals(t)}))){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,eD(t);case 4:r=e.sent,n={peerId:t,distance:hD(this.originDhtKey,r)},this.peerDistances.push(n),this.peerDistances.sort((function(e,t){return lD(e.distance,t.distance)})),this.peerDistances=this.peerDistances.slice(0,this.capacity);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"anyCloser",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",!1);case 2:if(0!==this.length){e.next=4;break}return e.abrupt("return",!0);case 4:return e.next=6,Promise.all(t.map(eD));case 6:r=e.sent,n=this.peerDistances[this.peerDistances.length-1].distance,i=(0,ge.Z)(r),e.prev=9,i.s();case 11:if((a=i.n()).done){e.next=18;break}if(s=a.value,!(lD(hD(this.originDhtKey,s),n)<0)){e.next=16;break}return e.abrupt("return",!0);case 16:e.next=11;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(9),i.e(e.t0);case 23:return e.prev=23,i.f(),e.finish(23);case 26:return e.abrupt("return",!1);case 27:case"end":return e.stop()}}),e,this,[[9,20,23,26]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),dD=function(){function e(t,r){(0,hi.Z)(this,e),(0,we.Z)(this,"components",void 0),(0,we.Z)(this,"log",void 0),(0,we.Z)(this,"routingTable",void 0),(0,we.Z)(this,"network",void 0),(0,we.Z)(this,"validators",void 0),(0,we.Z)(this,"queryManager",void 0);var n=r.routingTable,i=r.network,a=r.validators,s=r.queryManager,o=r.lan;this.components=t,this.routingTable=n,this.network=i,this.validators=a,this.queryManager=s,this.log=zi("libp2p:kad-dht:".concat(o?"lan":"wan",":peer-routing"))}return(0,fi.Z)(e,[{key:"findPeerLocal",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.routingTable.find(t);case 2:if(null==(n=e.sent)){e.next=15;break}return this.log("findPeerLocal found %p in routing table",t),e.prev=5,e.next=8,this.components.peerStore.get(n);case 8:r=e.sent,e.next=15;break;case 11:if(e.prev=11,e.t0=e.catch(5),"ERR_NOT_FOUND"===e.t0.code){e.next=15;break}throw e.t0;case 15:if(null!=r){e.next=26;break}return e.prev=16,e.next=19,this.components.peerStore.get(t);case 19:r=e.sent,e.next=26;break;case 22:if(e.prev=22,e.t1=e.catch(16),"ERR_NOT_FOUND"===e.t1.code){e.next=26;break}throw e.t1;case 26:if(null==r){e.next=29;break}return this.log("findPeerLocal found %p in peer store",t),e.abrupt("return",{id:r.id,multiaddrs:r.addresses.map((function(e){return e.multiaddr})),protocols:[]});case 29:return e.abrupt("return",void 0);case 30:case"end":return e.stop()}}),e,this,[[5,11],[16,22]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_getValueSingle",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ea((0,ii.Z)().mark((function i(){var a;return(0,ii.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return a=new PA(TA.GET_VALUE,t,0),i.delegateYield(Xa(ui(r.network.sendRequest(e,a,n))),"t0",2);case 2:case"end":return i.stop()}}),i)})))()}},{key:"getPublicKeyFromNode",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l,h;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=nD(e),a=!1,s=!1,n.prev=3,u=ui(t._getValueSingle(e,i,r));case 5:return n.next=7,Ji(u.next());case 7:if(!(a=!(c=n.sent).done)){n.next=24;break}return l=c.value,n.next=11,l;case 11:if("PEER_RESPONSE"!==l.name||null==l.record){n.next=21;break}return n.next=14,Ji(rm(Sy({bytes:l.record.value})));case 14:if((h=n.sent).equals(e)){n.next=17;break}throw new wo("public key does not match id","ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");case 17:if(null!=h.publicKey){n.next=19;break}throw new wo("public key missing","ERR_PUBLIC_KEY_MISSING");case 19:return n.next=21,zA({from:e,value:h.publicKey},r);case 21:a=!1,n.next=5;break;case 24:n.next=30;break;case 26:n.prev=26,n.t0=n.catch(3),s=!0,o=n.t0;case 30:if(n.prev=30,n.prev=31,!a||null==u.return){n.next=35;break}return n.next=35,Ji(u.return());case 35:if(n.prev=35,!s){n.next=38;break}throw o;case 38:return n.finish(35);case 39:return n.finish(30);case 40:throw new wo("Node not responding with its public key: ".concat(e.toString()),"ERR_INVALID_RECORD");case 41:case"end":return n.stop()}}),n,null,[[3,26,30,40],[31,,35,39]])})))()}},{key:"findPeer",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l,h,f,d;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.log("findPeer %p",e),n.next=3,Ji(t.findPeerLocal(e));case 3:if(null==(i=n.sent)){n.next=9;break}return t.log("found local"),n.next=8,NA({from:t.components.peerId,peer:i},r);case 8:return n.abrupt("return");case 9:a=t,s=function(){var t=ea((function(t){var n=t.peer,i=t.signal;return(0,ii.Z)().mark((function t(){var s,o,u,c,l,h,f,d;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s=new PA(TA.FIND_NODE,e.toBytes(),0),o=!1,u=!1,t.prev=3,l=ui(a.network.sendRequest(n,s,(0,_e.Z)((0,_e.Z)({},r),{},{signal:i})));case 5:return t.next=7,Ji(l.next());case 7:if(!(o=!(h=t.sent).done)){t.next=19;break}return f=h.value,t.next=11,f;case 11:if("PEER_RESPONSE"!==f.name){t.next=16;break}if(null==(d=f.closer.find((function(t){return t.id.equals(e)})))){t.next=16;break}return t.next=16,NA({from:f.from,peer:d},r);case 16:o=!1,t.next=5;break;case 19:t.next=25;break;case 21:t.prev=21,t.t0=t.catch(3),u=!0,c=t.t0;case 25:if(t.prev=25,t.prev=26,!o||null==l.return){t.next=30;break}return t.next=30,Ji(l.return());case 30:if(t.prev=30,!u){t.next=33;break}throw c;case 33:return t.finish(30);case 34:return t.finish(25);case 35:case"end":return t.stop()}}),t,null,[[3,21,25,35],[26,,30,34]])}))()}));return function(e){return t.apply(this,arguments)}}(),o=!1,u=!1,c=!1,n.prev=14,h=ui(t.queryManager.run(e.toBytes(),s,r));case 16:return n.next=18,Ji(h.next());case 18:if(!(u=!(f=n.sent).done)){n.next=26;break}return"FINAL_PEER"===(d=f.value).name&&(o=!0),n.next=23,d;case 23:u=!1,n.next=16;break;case 26:n.next=32;break;case 28:n.prev=28,n.t0=n.catch(14),c=!0,l=n.t0;case 32:if(n.prev=32,n.prev=33,!u||null==h.return){n.next=37;break}return n.next=37,Ji(h.return());case 37:if(n.prev=37,!c){n.next=40;break}throw l;case 40:return n.finish(37);case 41:return n.finish(32);case 42:if(o){n.next=45;break}return n.next=45,FA({from:t.components.peerId,error:new wo("Not found","ERR_NOT_FOUND")},r);case 45:case"end":return n.stop()}}),n,null,[[14,28,32,42],[33,,37,41]])})))()}},{key:"getClosestPeers",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l,h,f,d,p,v,g,y,m;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.log("getClosestPeers to %b",e),n.next=3,Ji(JA(e));case 3:return i=n.sent,a=t.routingTable.closestPeers(i),s=t,o=new fD(i,t.routingTable.kBucketSize),n.next=9,Ji(Promise.all(a.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.add(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())));case 9:u=function(){var t=ea((function(t){var n=t.peer,i=t.signal;return(0,ii.Z)().mark((function t(){var a;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s.log("closerPeersSingle %s from %p",Ws(e,"base32"),n),a=new PA(TA.FIND_NODE,e,0),t.delegateYield(Xa(ui(s.network.sendRequest(n,a,(0,_e.Z)((0,_e.Z)({},r),{},{signal:i})))),"t0",3);case 3:case"end":return t.stop()}}),t)}))()}));return function(e){return t.apply(this,arguments)}}(),c=!1,l=!1,n.prev=12,f=ui(t.queryManager.run(e,u,r));case 14:return n.next=16,Ji(f.next());case 16:if(!(c=!(d=n.sent).done)){n.next=26;break}return p=d.value,n.next=20,p;case 20:if("PEER_RESPONSE"!==p.name){n.next=23;break}return n.next=23,Ji(Promise.all(p.closer.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.add(t.id);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())));case 23:c=!1,n.next=14;break;case 26:n.next=32;break;case 28:n.prev=28,n.t0=n.catch(12),l=!0,h=n.t0;case 32:if(n.prev=32,n.prev=33,!c||null==f.return){n.next=37;break}return n.next=37,Ji(f.return());case 37:if(n.prev=37,!l){n.next=40;break}throw h;case 40:return n.finish(37);case 41:return n.finish(32);case 42:t.log("found %d peers close to %b",o.length,e),v=(0,ge.Z)(o.peers),n.prev=44,v.s();case 46:if((g=v.n()).done){n.next=62;break}return y=g.value,n.prev=48,n.next=51,Ji(t.components.peerStore.get(y));case 51:return m=n.sent,n.next=54,NA({from:t.components.peerId,peer:{id:y,multiaddrs:m.addresses.map((function(e){return e.multiaddr})),protocols:m.protocols}},r);case 54:n.next=60;break;case 56:if(n.prev=56,n.t1=n.catch(48),"ERR_NOT_FOUND"===n.t1.code){n.next=60;break}throw n.t1;case 60:n.next=46;break;case 62:n.next=67;break;case 64:n.prev=64,n.t2=n.catch(44),v.e(n.t2);case 67:return n.prev=67,v.f(),n.finish(67);case 70:case"end":return n.stop()}}),n,null,[[12,28,32,42],[33,,37,41],[44,64,67,70],[48,56]])})))()}},{key:"getValueOrPeers",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ea((0,ii.Z)().mark((function i(){var a,s,o,u,c,l,h;return(0,ii.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:a=!1,s=!1,i.prev=2,u=ui(r._getValueSingle(e,t,n));case 4:return i.next=6,Ji(u.next());case 6:if(!(a=!(c=i.sent).done)){i.next=27;break}if("PEER_RESPONSE"!==(l=c.value).name){i.next=22;break}if(null==l.record){i.next=22;break}return i.prev=10,i.next=13,Ji(r._verifyRecordOnline(l.record));case 13:i.next=22;break;case 15:return i.prev=15,i.t0=i.catch(10),h="invalid record received, discarded",r.log(h),i.next=21,FA({from:l.from,error:new wo(h,"ERR_INVALID_RECORD")},n);case 21:return i.abrupt("continue",24);case 22:return i.next=24,l;case 24:a=!1,i.next=4;break;case 27:i.next=33;break;case 29:i.prev=29,i.t1=i.catch(2),s=!0,o=i.t1;case 33:if(i.prev=33,i.prev=34,!a||null==u.return){i.next=38;break}return i.next=38,Ji(u.return());case 38:if(i.prev=38,!s){i.next=41;break}throw o;case 41:return i.finish(38);case 42:return i.finish(33);case 43:case"end":return i.stop()}}),i,null,[[2,29,33,43],[10,15],[34,,38,42]])})))()}},{key:"_verifyRecordOnline",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.timeReceived){e.next=2;break}throw new wo("invalid record received","ERR_INVALID_RECORD");case 2:return e.next=4,qA(this.validators,new RA(t.key,t.value,t.timeReceived));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getCloserPeersOffline",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,JA(t);case 2:n=e.sent,i=this.routingTable.closestPeers(n),a=[],s=(0,ge.Z)(i),e.prev=6,s.s();case 8:if((o=s.n()).done){e.next=25;break}if(!(u=o.value).equals(r)){e.next=12;break}return e.abrupt("continue",23);case 12:return e.prev=12,e.next=15,this.components.peerStore.get(u);case 15:c=e.sent,a.push({id:u,multiaddrs:c.addresses.map((function(e){return e.multiaddr})),protocols:c.protocols}),e.next=23;break;case 19:if(e.prev=19,e.t0=e.catch(12),"ERR_NOT_FOUND"===e.t0.code){e.next=23;break}throw e.t0;case 23:e.next=8;break;case 25:e.next=30;break;case 27:e.prev=27,e.t1=e.catch(6),s.e(e.t1);case 30:return e.prev=30,s.f(),e.finish(30);case 33:return a.length>0?this.log("getCloserPeersOffline found %d peer(s) closer to %b than %p",a.length,t,r):this.log("getCloserPeersOffline could not find peer closer to %b than %p",t,r),e.abrupt("return",a);case 35:case"end":return e.stop()}}),e,this,[[6,27,30,33],[12,19]])})));return function(t,r){return e.apply(this,arguments)}}()}]),e}(),pD=__webpack_require__(4737),vD=zi("libp2p:kad-dht:providers"),gD=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,hi.Z)(this,e),(0,we.Z)(this,"components",void 0),(0,we.Z)(this,"cache",void 0),(0,we.Z)(this,"cleanupInterval",void 0),(0,we.Z)(this,"provideValidity",void 0),(0,we.Z)(this,"syncQueue",void 0),(0,we.Z)(this,"started",void 0),(0,we.Z)(this,"cleaner",void 0);var n=r.cacheSize,i=r.cleanupInterval,a=r.provideValidity;this.components=t,this.cleanupInterval=null!==i&&void 0!==i?i:36e5,this.provideValidity=null!==a&&void 0!==a?a:864e5,this.cache=pD(null!==n&&void 0!==n?n:256),this.syncQueue=new Bh({concurrency:1}),this.started=!1}return(0,fi.Z)(e,[{key:"isStarted",value:function(){return this.started}},{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.started){e.next=2;break}return e.abrupt("return");case 2:this.started=!0,this.cleaner=setInterval((function(){t._cleanup().catch((function(e){vD.error(e)}))}),this.cleanupInterval);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.started=!1,null!=this.cleaner&&(clearInterval(this.cleaner),this.cleaner=void 0);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_cleanup",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.syncQueue.add((0,ai.Z)((0,ii.Z)().mark((function e(){var r,n,i,a,s,o,u,c,l,h,f,d,p,v,g,y,m,b,_,w,k,x,E,S,C,A,D,R,T,Z,I;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=Date.now(),n=0,i=0,a=new Map,s=t.components.datastore.batch(),o=t.components.datastore.query({prefix:gA}),u=!1,c=!1,e.prev=8,h=ui(o);case 10:return e.next=12,h.next();case 12:if(!(u=!(f=e.sent).done)){e.next=18;break}d=f.value;try{p=_D(d.key),v=p.cid,g=p.peerId,y=xD(d.value).getTime(),m=Date.now(),_=(b=m-y)>t.provideValidity,vD("comparing: %d - %d = %d > %d %s",m,y,b,t.provideValidity,_?"(expired)":""),_&&(i++,s.delete(d.key),(k=null!==(w=a.get(v))&&void 0!==w?w:new Set).add(g),a.set(v,k)),n++}catch(S$){vD.error(S$.message)}case 15:u=!1,e.next=10;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(8),c=!0,l=e.t0;case 24:if(e.prev=24,e.prev=25,!u||null==h.return){e.next=29;break}return e.next=29,h.return();case 29:if(e.prev=29,!c){e.next=32;break}throw l;case 32:return e.finish(29);case 33:return e.finish(24);case 34:if(!(a.size>0)){e.next=40;break}return vD("deleting %d / %d entries",i,n),e.next=38,s.commit();case 38:e.next=41;break;case 40:vD("nothing to delete");case 41:x=(0,ge.Z)(a);try{for(x.s();!(E=x.n()).done;)if(S=(0,ke.Z)(E.value,2),C=S[0],A=S[1],D=yD(C),null!=(R=t.cache.get(D))){T=(0,ge.Z)(A);try{for(T.s();!(Z=T.n()).done;)I=Z.value,R.delete(I)}catch(S$){T.e(S$)}finally{T.f()}0===R.size?t.cache.remove(D):t.cache.set(D,R)}}catch(S$){x.e(S$)}finally{x.f()}vD("Cleanup successful (%dms)",Date.now()-r);case 44:case"end":return e.stop()}}),e,null,[[8,20,24,34],[25,,29,33]])}))));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getProvidersMap",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=yD(t),null!=(n=this.cache.get(r))){e.next=7;break}return e.next=5,wD(this.components.datastore,t);case 5:n=e.sent,this.cache.set(r,n);case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addProvider",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.syncQueue.add((0,ai.Z)((0,ii.Z)().mark((function e(){var i,a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return vD("%p provides %s",r,t),e.next=3,n._getProvidersMap(t);case 3:return i=e.sent,vD("loaded %s provs",i.size),a=new Date,i.set(r.toString(),a),s=yD(t),n.cache.set(s,i),e.next=11,mD(n.components.datastore,t,r,a);case 11:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getProviders",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.syncQueue.add((0,ai.Z)((0,ii.Z)().mark((function e(){var n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return vD("get providers for %s",t),e.next=3,r._getProvidersMap(t);case 3:return n=e.sent,e.abrupt("return",be(n.keys()).map((function(e){return em(e)})));case 5:case"end":return e.stop()}}),e)}))),{throwOnTimeout:!0}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function yD(e){var t="string"===typeof e?e:Ws(e.multihash.bytes,"base32");return"".concat(gA,"/").concat(t)}function mD(e,t,r,n){return bD.apply(this,arguments)}function bD(){return bD=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i){var a,s,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[yD(r),"/",n.toString()].join(""),s=new Ys(a),o=ku(i.getTime()),e.next=5,t.put(s,o);case 5:case"end":return e.stop()}}),e)}))),bD.apply(this,arguments)}function _D(e){var t=e.toString().split("/");if(5!==t.length)throw new Error("incorrectly formatted provider entry key in datastore: ".concat(e.toString()));return{cid:t[3],peerId:t[4]}}function wD(e,t){return kD.apply(this,arguments)}function kD(){return kD=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c,l,h,f;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=new Map,i=t.query({prefix:yD(r)}),a=!1,s=!1,e.prev=4,u=ui(i);case 6:return e.next=8,u.next();case 8:if(!(a=!(c=e.sent).done)){e.next=15;break}l=c.value,h=_D(l.key),f=h.peerId,n.set(f,xD(l.value));case 12:a=!1,e.next=6;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(4),s=!0,o=e.t0;case 21:if(e.prev=21,e.prev=22,!a||null==u.return){e.next=26;break}return e.next=26,u.return();case 26:if(e.prev=26,!s){e.next=29;break}throw o;case 29:return e.finish(26);case 30:return e.finish(21);case 31:return e.abrupt("return",n);case 32:case"end":return e.stop()}}),e,null,[[4,17,21,31],[22,,26,30]])}))),kD.apply(this,arguments)}function xD(e){return new Date(xu(e))}var ED=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF");function SD(e){return CD.apply(this,arguments)}function CD(){return CD=ea((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c,l,h,f,d,p,v,g;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g=function(e,n){if(null!=e){d.add(e);var o=BigInt("0x"+Ws(hD(n,v),"base16"));p.add((0,ai.Z)((0,ii.Z)().mark((function n(){var l,y,m,b,_,w,k,x,E,S,C,A;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:l=[a],null!=h&&l.push(AbortSignal.timeout(h)),y=vo(l),n.prev=3,m=!1,b=!1,n.prev=6,w=ui(s({key:r,peer:e,signal:y,pathIndex:u,numPaths:c}));case 8:return n.next=10,w.next();case 10:if(!(m=!(k=n.sent).done)){n.next=49;break}if(x=k.value,!y.aborted){n.next=14;break}return n.abrupt("return");case 14:if("PEER_RESPONSE"!==x.name){n.next=45;break}E=(0,ge.Z)(x.closer),n.prev=16,E.s();case 18:if((S=E.n()).done){n.next=37;break}if(C=S.value,!d.has(C.id)){n.next=23;break}return f("already seen %p in query",C.id),n.abrupt("continue",35);case 23:if(!i.equals(C.id)){n.next=26;break}return f("not querying ourselves"),n.abrupt("continue",35);case 26:return n.next=28,eD(C.id);case 28:if(A=n.sent,!(BigInt("0x"+Ws(hD(A,v),"base16"))>o)){n.next=33;break}return f("skipping %p as they are not closer to %b than %p",C.id,r,e),n.abrupt("continue",35);case 33:f("querying closer peer %p",C.id),g(C.id,A);case 35:n.next=18;break;case 37:n.next=42;break;case 39:n.prev=39,n.t0=n.catch(16),E.e(n.t0);case 42:return n.prev=42,E.f(),n.finish(42);case 45:p.emit("completed",x);case 46:m=!1,n.next=8;break;case 49:n.next=55;break;case 51:n.prev=51,n.t1=n.catch(6),b=!0,_=n.t1;case 55:if(n.prev=55,n.prev=56,!m||null==w.return){n.next=60;break}return n.next=60,w.return();case 60:if(n.prev=60,!b){n.next=63;break}throw _;case 63:return n.finish(60);case 64:return n.finish(55);case 65:n.next=71;break;case 67:if(n.prev=67,n.t2=n.catch(3),a.aborted){n.next=71;break}return n.abrupt("return",FA({from:e,error:n.t2},t));case 71:return n.prev=71,y.clear(),n.finish(71);case 74:case"end":return n.stop()}}),n,null,[[3,67,71,74],[6,51,55,65],[16,39,42,45],[56,,60,64]])}))),{priority:ED-o}).catch((function(e){f.error(e)}))}},r=t.key,n=t.startingPeer,i=t.ourPeerId,a=t.signal,s=t.query,o=t.alpha,u=t.pathIndex,c=t.numPaths,l=t.cleanUp,h=t.queryFuncTimeout,f=t.log,d=t.peersSeen,p=new Bh({concurrency:o}),e.next=5,Ji(JA(r));case 5:return v=e.sent,e.t0=g,e.t1=n,e.next=10,Ji(eD(n));case 10:return e.t2=e.sent,(0,e.t0)(e.t1,e.t2),e.delegateYield(Xa(ui(AD(p,a,l,f))),"t3",13);case 13:case"end":return e.stop()}}),e)}))),CD.apply(this,arguments)}function AD(e,t,r,n){return DD.apply(this,arguments)}function DD(){return DD=ea((0,ii.Z)().mark((function e(t,r,n,i){var a,s,o,u,c;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=ts(),s=!0,o=[],u=function(){s&&(i("clean up queue, results %d, queue size %d, pending tasks %d",o.length,t.size,t.pending),s=!1,t.clear(),o.splice(0,o.length))},t.on("completed",(function(e){o.push(e),a.resolve()})),t.on("error",(function(e){i("queue error",e),u(),a.reject(e)})),t.on("idle",(function(){i("queue idle"),s=!1,a.resolve()})),r.addEventListener("abort",(function(){i("abort queue");var e=s;u(),e&&a.reject(new wo("Query aborted","ERR_QUERY_ABORTED"))})),n.addEventListener("cleanup",(function(){u(),a.resolve()}));case 9:if(!s){e.next=22;break}return e.next=12,Ji(a.promise);case 12:a=ts();case 13:if(!(o.length>0)){e.next=20;break}if(null==(c=o.shift())){e.next=18;break}return e.next=18,c;case 18:e.next=13;break;case 20:e.next=9;break;case 22:return e.delegateYield(Xa(ui(o)),"t0",23);case 23:case"end":return e.stop()}}),e)}))),DD.apply(this,arguments)}var RD=function(){function e(t,r){(0,hi.Z)(this,e),(0,we.Z)(this,"components",void 0),(0,we.Z)(this,"lan",void 0),(0,we.Z)(this,"disjointPaths",void 0),(0,we.Z)(this,"alpha",void 0),(0,we.Z)(this,"shutDownController",void 0),(0,we.Z)(this,"running",void 0),(0,we.Z)(this,"queries",void 0),(0,we.Z)(this,"metrics",void 0),(0,we.Z)(this,"routingTable",void 0),(0,we.Z)(this,"initialQuerySelfHasRun",void 0);var n=r.lan,i=void 0!==n&&n,a=r.disjointPaths,s=void 0===a?20:a,o=r.alpha,u=void 0===o?3:o;this.components=t,this.disjointPaths=null!==s&&void 0!==s?s:20,this.running=!1,this.alpha=null!==u&&void 0!==u?u:3,this.lan=i,this.queries=0,this.initialQuerySelfHasRun=r.initialQuerySelfHasRun,this.routingTable=r.routingTable,this.shutDownController=new AbortController;try{null!=Wu.setMaxListeners&&(0,Wu.setMaxListeners)(1/0,this.shutDownController.signal)}catch(c){}}return(0,fi.Z)(e,[{key:"isStarted",value:function(){return this.running}},{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.running=!0,null!=this.components.metrics&&null==this.metrics&&(this.metrics={runningQueries:this.components.metrics.registerMetric("libp2p_kad_dht_".concat(this.lan?"lan":"wan","_running_queries")),queryTime:this.components.metrics.registerMetric("libp2p_kad_dht_".concat(this.lan?"lan":"wan","_query_time_seconds"))});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.running=!1,this.shutDownController.abort();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ea((0,ii.Z)().mark((function i(){var a,s,o,u,c,l,h,f,d,p,v,g,y,m,b,_,w,k,x;return(0,ii.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(r.running){i.next=2;break}throw new Error("QueryManager not started");case 2:if(s=null===(a=r.metrics)||void 0===a?void 0:a.queryTime.timer(),null==n.signal){n.signal=AbortSignal.timeout(kA);try{null!=Wu.setMaxListeners&&(0,Wu.setMaxListeners)(1/0,n.signal)}catch(E){}}o=vo([r.shutDownController.signal,n.signal]);try{null!=Wu.setMaxListeners&&(0,Wu.setMaxListeners)(1/0,o)}catch(S){}if(u=zi("libp2p:kad-dht:".concat(r.lan?"lan":"wan",":query:")+Ws(e,"base58btc")),c=Date.now(),l=new Ly,i.prev=9,!0===n.isSelfQuery||null==r.initialQuerySelfHasRun){i.next=15;break}return u("waiting for initial query-self query before continuing"),i.next=14,Ji(Promise.race([new Promise((function(e,t){o.addEventListener("abort",(function(){t(new _o("Query was aborted before self-query ran"))}))})),r.initialQuerySelfHasRun.promise]));case 14:r.initialQuerySelfHasRun=void 0;case 15:return u("query:start"),r.queries++,null===(h=r.metrics)||void 0===h||h.runningQueries.update(r.queries),i.next=20,Ji(JA(e));case 20:if(f=i.sent,d=r.routingTable.closestPeers(f),p=d.slice(0,Math.min(r.disjointPaths,d.length)),0!==d.length){i.next=26;break}return u.error("Running query with no peers"),i.abrupt("return");case 26:v=new Em,g=p.map((function(i,a){return SD({key:e,startingPeer:i,ourPeerId:r.components.peerId,signal:o,query:t,pathIndex:a,numPaths:p.length,alpha:r.alpha,cleanUp:l,queryFuncTimeout:n.queryFuncTimeout,log:u,peersSeen:v,onProgress:n.onProgress})})),y=!1,m=!1,i.prev=30,_=ui(os.apply(void 0,be(g)));case 32:return i.next=34,Ji(_.next());case 34:if(!(y=!(w=i.sent).done)){i.next=42;break}return k=w.value,i.next=38,k;case 38:"QUERY_ERROR"===k.name&&u("error",k.error);case 39:y=!1,i.next=32;break;case 42:i.next=48;break;case 44:i.prev=44,i.t0=i.catch(30),m=!0,b=i.t0;case 48:if(i.prev=48,i.prev=49,!y||null==_.return){i.next=53;break}return i.next=53,Ji(_.return());case 53:if(i.prev=53,!m){i.next=56;break}throw b;case 56:return i.finish(53);case 57:return i.finish(48);case 58:i.next=66;break;case 60:if(i.prev=60,i.t1=i.catch(9),r.running||"ERR_QUERY_ABORTED"!==i.t1.code){i.next=65;break}i.next=66;break;case 65:throw i.t1;case 66:return i.prev=66,o.clear(),r.queries--,null===(x=r.metrics)||void 0===x||x.runningQueries.update(r.queries),null!=s&&s(),l.dispatchEvent(new By("cleanup")),u("query:done in %dms",Date.now()-c),i.finish(66);case 74:case"end":return i.stop()}}),i,null,[[9,60,66,74],[30,44,48,58],[49,,53,57]])})))()}}]),e}();var TD=function(e){if(null!=e[Symbol.asyncIterator])return(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i,a,s,o;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=0,n=!1,i=!1,t.prev=3,s=ui(e);case 5:return t.next=7,s.next();case 7:if(!(n=!(o=t.sent).done)){t.next=13;break}o.value,r++;case 10:n=!1,t.next=5;break;case 13:t.next=19;break;case 15:t.prev=15,t.t0=t.catch(3),i=!0,a=t.t0;case 19:if(t.prev=19,t.prev=20,!n||null==s.return){t.next=24;break}return t.next=24,s.return();case 24:if(t.prev=24,!i){t.next=27;break}throw a;case 27:return t.finish(24);case 28:return t.finish(19);case 29:return t.abrupt("return",r);case 30:case"end":return t.stop()}}),t,null,[[3,15,19,29],[20,,24,28]])})))();var t,r=0,n=(0,ge.Z)(e);try{for(n.s();!(t=n.n()).done;){t.value;r++}}catch(S$){n.e(S$)}finally{n.f()}return r},ZD=function(e){var t=e.on||e.addListener||e.addEventListener,r=e.off||e.removeListener||e.removeEventListener;if(!t||!r)throw new TypeError("Emitter is not compatible");return{addListener:t.bind(e),removeListener:r.bind(e)}};function ID(e,t,r){"function"===typeof r&&(r={filter:r});var n=function(e,t,r){var n,i=new Promise((function(i,a){var s;if(!((r=(0,_e.Z)({rejectionEvents:["error"],multiArgs:!1,resolveImmediately:!1},r)).count>=0)||r.count!==Number.POSITIVE_INFINITY&&!Number.isInteger(r.count))throw new TypeError("The `count` option should be at least 0 or more");null===(s=r.signal)||void 0===s||s.throwIfAborted();var o=[t].flat(),u=[],c=ZD(e),l=c.addListener,h=c.removeListener,f=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];var s=r.multiArgs?t:t[0];r.filter&&!r.filter(s)||(u.push(s),r.count===u.length&&(n(),i(u)))},d=function(e){n(),a(e)};n=function(){var e,t=(0,ge.Z)(o);try{for(t.s();!(e=t.n()).done;){var n=e.value;h(n,f)}}catch(S$){t.e(S$)}finally{t.f()}var i,a=(0,ge.Z)(r.rejectionEvents);try{for(a.s();!(i=a.n()).done;){var s=i.value;h(s,d)}}catch(S$){a.e(S$)}finally{a.f()}};var p,v=(0,ge.Z)(o);try{for(v.s();!(p=v.n()).done;)l(p.value,f)}catch(S$){v.e(S$)}finally{v.f()}var g,y=(0,ge.Z)(r.rejectionEvents);try{for(y.s();!(g=y.n()).done;)l(g.value,d)}catch(S$){y.e(S$)}finally{y.f()}r.signal&&r.signal.addEventListener("abort",(function(){d(r.signal.reason)}),{once:!0}),r.resolveImmediately&&i(u)}));if(i.cancel=n,"number"===typeof r.timeout){var a=rd(i,{milliseconds:r.timeout});return a.cancel=n,a}return i}(e,t,r=(0,_e.Z)((0,_e.Z)({},r),{},{count:1,resolveImmediately:!1})),i=n.then((function(e){return e[0]}));return i.cancel=n.cancel,i}var PD=function(){function e(t,r){var n;(0,hi.Z)(this,e),(0,we.Z)(this,"log",void 0),(0,we.Z)(this,"components",void 0),(0,we.Z)(this,"peerRouting",void 0),(0,we.Z)(this,"routingTable",void 0),(0,we.Z)(this,"count",void 0),(0,we.Z)(this,"interval",void 0),(0,we.Z)(this,"initialInterval",void 0),(0,we.Z)(this,"queryTimeout",void 0),(0,we.Z)(this,"started",void 0),(0,we.Z)(this,"timeoutId",void 0),(0,we.Z)(this,"controller",void 0),(0,we.Z)(this,"initialQuerySelfHasRun",void 0),(0,we.Z)(this,"querySelfPromise",void 0);var i=r.peerRouting,a=r.lan,s=r.count,o=r.interval,u=r.queryTimeout,c=r.routingTable;this.components=t,this.log=zi("libp2p:kad-dht:".concat(a?"lan":"wan",":query-self")),this.started=!1,this.peerRouting=i,this.routingTable=c,this.count=null!==s&&void 0!==s?s:20,this.interval=null!==o&&void 0!==o?o:yA,this.initialInterval=null!==(n=r.initialInterval)&&void 0!==n?n:mA,this.queryTimeout=null!==u&&void 0!==u?u:bA,this.initialQuerySelfHasRun=r.initialQuerySelfHasRun}return(0,fi.Z)(e,[{key:"isStarted",value:function(){return this.started}},{key:"start",value:function(){var e=this;this.started||(this.started=!0,clearTimeout(this.timeoutId),this.timeoutId=setTimeout((function(){e.querySelf().catch((function(t){e.log.error("error running self-query",t)}))}),this.initialInterval))}},{key:"stop",value:function(){this.started=!1,null!=this.timeoutId&&clearTimeout(this.timeoutId),null!=this.controller&&this.controller.abort()}},{key:"querySelf",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.started){e.next=3;break}return this.log("skip self-query because we are not started"),e.abrupt("return");case 3:if(null==this.querySelfPromise){e.next=6;break}return this.log("joining existing self query"),e.abrupt("return",this.querySelfPromise.promise);case 6:if(this.querySelfPromise=ts(),0!==this.routingTable.size){e.next=10;break}return e.next=10,ID(this.routingTable,"peer:add");case 10:if(!this.started){e.next=29;break}this.controller=new AbortController,t=vo([this.controller.signal,AbortSignal.timeout(this.queryTimeout)]);try{null!=Wu.setMaxListeners&&(0,Wu.setMaxListeners)(1/0,t)}catch(i){}return e.prev=14,this.log("run self-query, look for %d peers timing out after %dms",this.count,this.queryTimeout),e.next=18,no(this.peerRouting.getClosestPeers(this.components.peerId.toBytes(),{signal:t,isSelfQuery:!0}),(function(e){return $s(e,n.count)}),function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",TD(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 18:r=e.sent,this.log("self-query ran successfully - found %d peers",r),null!=this.initialQuerySelfHasRun&&(this.initialQuerySelfHasRun.resolve(),this.initialQuerySelfHasRun=void 0),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(14),this.log.error("self-query error",e.t0);case 26:return e.prev=26,t.clear(),e.finish(26);case 29:if(this.querySelfPromise.resolve(),this.querySelfPromise=void 0,this.started){e.next=33;break}return e.abrupt("return");case 33:this.timeoutId=setTimeout((function(){n.querySelf().catch((function(e){n.log.error("error running self-query",e)}))}),this.interval);case 34:case"end":return e.stop()}}),e,this,[[14,23,26,29]])})));return function(){return e.apply(this,arguments)}}()}]),e}();function LD(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(var r=0,n=e.length;r<n;++r)if(e[r]!==t[r])return!1;return!0}function MD(e,t){if(!(t instanceof Uint8Array))throw new TypeError(e+" is not a Uint8Array")}var BD,OD=function(e){ia(r,e);var t=ua(r);function r(e){var n,i,a,s,o;return(0,hi.Z)(this,r),o=t.call(this),(0,we.Z)(ra(o),"localNodeId",void 0),(0,we.Z)(ra(o),"root",void 0),(0,we.Z)(ra(o),"numberOfNodesPerKBucket",void 0),(0,we.Z)(ra(o),"numberOfNodesToPing",void 0),(0,we.Z)(ra(o),"distance",void 0),(0,we.Z)(ra(o),"arbiter",void 0),o.localNodeId=e.localNodeId,o.numberOfNodesPerKBucket=null!==(n=e.numberOfNodesPerKBucket)&&void 0!==n?n:20,o.numberOfNodesToPing=null!==(i=e.numberOfNodesToPing)&&void 0!==i?i:3,o.distance=null!==(a=e.distance)&&void 0!==a?a:r.distance,o.arbiter=null!==(s=e.arbiter)&&void 0!==s?s:r.arbiter,MD("option.localNodeId as parameter 1",o.localNodeId),o.root={contacts:[],dontSplit:!1,left:null,right:null},o}return(0,fi.Z)(r,[{key:"add",value:function(e){MD("contact.id",null===e||void 0===e?void 0:e.id);for(var t=0,r=this.root;null===r.contacts;)r=this._determineNode(r,e.id,t++);var n=this._indexOf(r,e.id);return n>=0?(this._update(r,n,e),this):r.contacts.length<this.numberOfNodesPerKBucket?(r.contacts.push(e),this.safeDispatchEvent("added",{detail:e}),this):r.dontSplit?(this.safeDispatchEvent("ping",{detail:{oldContacts:r.contacts.slice(0,this.numberOfNodesToPing),newContact:e}}),this):(this._split(r,t),this.add(e))}},{key:"closest",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;if(MD("id",e),!Number.isInteger(r)&&r!==1/0||r<=0)throw new TypeError("n is not positive number");for(var n=[],i=[this.root],a=0;i.length>0&&n.length<r;){var s=i.pop();if(null!=s)if(null===s.contacts){var o=this._determineNode(s,e,a++);i.push(s.left===o?s.right:s.left),i.push(o)}else n=n.concat(s.contacts)}return n.map((function(r){return{distance:t.distance(r.id,e),contact:r}})).sort((function(e,t){return e.distance-t.distance})).slice(0,r).map((function(e){return e.contact}))}},{key:"count",value:function(){for(var e=0,t=[this.root];t.length>0;){var r=t.pop();null!=r&&(null===r.contacts?t.push(r.right,r.left):e+=r.contacts.length)}return e}},{key:"_determineNode",value:function(e,t,r){var n=r>>3,i=r%8;return t.length<=n&&0!==i?e.left:0!==(t[n]&1<<7-i)?e.right:e.left}},{key:"get",value:function(e){MD("id",e);for(var t=0,r=this.root;null===r.contacts;)r=this._determineNode(r,e,t++);var n=this._indexOf(r,e);return n>=0?r.contacts[n]:void 0}},{key:"_indexOf",value:function(e,t){for(var r=0;r<e.contacts.length;++r)if(LD(e.contacts[r].id,t))return r;return-1}},{key:"remove",value:function(e){MD("the id as parameter 1",e);for(var t=0,r=this.root;null===r.contacts;)r=this._determineNode(r,e,t++);var n=this._indexOf(r,e);if(n>=0){var i=r.contacts.splice(n,1)[0];this.safeDispatchEvent("removed",{detail:i})}return this}},{key:"_split",value:function(e,t){e.left={contacts:[],dontSplit:!1,left:null,right:null},e.right={contacts:[],dontSplit:!1,left:null,right:null};var r,n=(0,ge.Z)(e.contacts);try{for(n.s();!(r=n.n()).done;){var i=r.value;this._determineNode(e,i.id,t).contacts.push(i)}}catch(S$){n.e(S$)}finally{n.f()}e.contacts=null;var a=this._determineNode(e,this.localNodeId,t);(e.left===a?e.right:e.left).dontSplit=!0}},{key:"toArray",value:function(){for(var e=[],t=[this.root];t.length>0;){var r=t.pop();null!=r&&(null===r.contacts?t.push(r.right,r.left):e=e.concat(r.contacts))}return e}},{key:"toIterable",value:(0,ii.Z)().mark((function e(){var t,r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[this.root];case 1:if(!(t.length>0)){e.next=12;break}if(null!=(r=t.pop())){e.next=5;break}return e.abrupt("continue",10);case 5:if(null!==r.contacts){e.next=9;break}t.push(r.right,r.left),e.next=10;break;case 9:return e.delegateYield(r.contacts,"t0",10);case 10:e.next=1;break;case 12:case"end":return e.stop()}}),e,this)}))},{key:"_update",value:function(e,t,r){if(!LD(e.contacts[t].id,r.id))throw new Error("wrong index for _update");var n=e.contacts[t],i=this.arbiter(n,r);i===n&&n!==r||(e.contacts.splice(t,1),e.contacts.push(i),this.safeDispatchEvent("updated",{detail:{incumbent:n,selection:i}}))}}],[{key:"arbiter",value:function(e,t){var r,n;return(null!==(r=e.vectorClock)&&void 0!==r?r:0)>(null!==(n=t.vectorClock)&&void 0!==n?n:0)?e:t}},{key:"distance",value:function(e,t){for(var r=0,n=0,i=Math.min(e.length,t.length),a=Math.max(e.length,t.length);n<i;++n)r=256*r+(e[n]^t[n]);for(;n<a;++n)r=256*r+255;return r}}]),r}(Ly),ND=function(e){ia(r,e);var t=ua(r);function r(e,n){var i;(0,hi.Z)(this,r),i=t.call(this),(0,we.Z)(ra(i),"kBucketSize",void 0),(0,we.Z)(ra(i),"kb",void 0),(0,we.Z)(ra(i),"pingQueue",void 0),(0,we.Z)(ra(i),"log",void 0),(0,we.Z)(ra(i),"components",void 0),(0,we.Z)(ra(i),"lan",void 0),(0,we.Z)(ra(i),"pingTimeout",void 0),(0,we.Z)(ra(i),"pingConcurrency",void 0),(0,we.Z)(ra(i),"running",void 0),(0,we.Z)(ra(i),"protocol",void 0),(0,we.Z)(ra(i),"tagName",void 0),(0,we.Z)(ra(i),"tagValue",void 0),(0,we.Z)(ra(i),"metrics",void 0);var a=n.kBucketSize,s=n.pingTimeout,o=n.lan,u=n.pingConcurrency,c=n.protocol,l=n.tagName,h=n.tagValue;i.components=e,i.log=zi("libp2p:kad-dht:".concat(o?"lan":"wan",":routing-table")),i.kBucketSize=null!==a&&void 0!==a?a:20,i.pingTimeout=null!==s&&void 0!==s?s:1e4,i.pingConcurrency=null!==u&&void 0!==u?u:10,i.lan=o,i.running=!1,i.protocol=c,i.tagName=null!==l&&void 0!==l?l:"kad-close",i.tagValue=null!==h&&void 0!==h?h:50;var f=function(){var e,t;null===(e=i.metrics)||void 0===e||e.pingQueueSize.update(i.pingQueue.size),null===(t=i.metrics)||void 0===t||t.pingRunning.update(i.pingQueue.pending)};return i.pingQueue=new Bh({concurrency:i.pingConcurrency}),i.pingQueue.addListener("add",f),i.pingQueue.addListener("next",f),i._onPing=i._onPing.bind(ra(i)),i}return(0,fi.Z)(r,[{key:"isStarted",value:function(){return this.running}},{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.running=!0,null!=this.components.metrics&&(this.metrics={routingTableSize:this.components.metrics.registerMetric("libp2p_kad_dht_".concat(this.lan?"lan":"wan","_routing_table_size")),pingQueueSize:this.components.metrics.registerMetric("libp2p_kad_dht_".concat(this.lan?"lan":"wan","_ping_queue_size")),pingRunning:this.components.metrics.registerMetric("libp2p_kad_dht_".concat(this.lan?"lan":"wan","_ping_running"))}),e.t0=OD,e.next=5,eD(this.components.peerId);case 5:e.t1=e.sent,e.t2=this.kBucketSize,e.t3={localNodeId:e.t1,numberOfNodesPerKBucket:e.t2,numberOfNodesToPing:1},t=new e.t0(e.t3),this.kb=t,t.addEventListener("ping",this._onPing),this._tagPeers(t);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.running=!1,this.pingQueue.clear(),this.kb=void 0;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_tagPeers",value:function(e){var t=this,r=new Em,n=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return function(){clearTimeout(t),t=setTimeout((function(){e()}),r)}}((function(){var n=new Em(e.closest(e.localNodeId,20).map((function(e){return e.peer}))),i=n.difference(r),a=r.difference(n);Promise.resolve().then((0,ai.Z)((0,ii.Z)().mark((function e(){var r,n,s,o,u,c;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=(0,ge.Z)(i),e.prev=1,r.s();case 3:if((n=r.n()).done){e.next=9;break}return s=n.value,e.next=7,t.components.peerStore.merge(s,{tags:(0,we.Z)({},t.tagName,{value:t.tagValue})});case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),r.e(e.t0);case 14:return e.prev=14,r.f(),e.finish(14);case 17:o=(0,ge.Z)(a),e.prev=18,o.s();case 20:if((u=o.n()).done){e.next=26;break}return c=u.value,e.next=24,t.components.peerStore.merge(c,{tags:(0,we.Z)({},t.tagName,void 0)});case 24:e.next=20;break;case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(18),o.e(e.t1);case 31:return e.prev=31,o.f(),e.finish(31);case 34:case"end":return e.stop()}}),e,null,[[1,11,14,17],[18,28,31,34]])})))).catch((function(e){t.log.error("Could not update peer tags",e)})),r=n}));e.addEventListener("added",(function(e){n(),t.safeDispatchEvent("peer:add",{detail:e.detail.peer})})),e.addEventListener("removed",(function(e){n(),t.safeDispatchEvent("peer:remove",{detail:e.detail.peer})}))}},{key:"_onPing",value:function(e){var t=this,r=e.detail,n=r.oldContacts,i=r.newContact;this.pingQueue.add((0,ai.Z)((0,ii.Z)().mark((function e(){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.running){e.next=2;break}return e.abrupt("return");case 2:return r=0,e.prev=3,e.next=6,Promise.all(n.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(n){var i,a,s,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i={signal:AbortSignal.timeout(t.pingTimeout)},t.log("pinging old contact %p",n.peer),e.next=5,t.components.connectionManager.openConnection(n.peer,i);case 5:return a=e.sent,e.next=8,a.newStream(t.protocol,i);case 8:return s=e.sent,e.next=11,s.close();case 11:r++,e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),t.running&&null!=t.kb&&(t.log.error("could not ping peer %p",n.peer,e.t0),t.log("evicting old contact after ping failed %p",n.peer),t.kb.remove(n.id));case 17:return e.prev=17,null===(o=t.metrics)||void 0===o||o.routingTableSize.update(t.size),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[0,14,17,20]])})));return function(t){return e.apply(this,arguments)}}()));case 6:t.running&&r<n.length&&null!=t.kb&&(t.log("adding new contact %p",i.peer),t.kb.add(i)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),t.log.error("could not process k-bucket ping event",e.t0);case 12:case"end":return e.stop()}}),e,null,[[3,9]])})))).catch((function(e){t.log.error("could not process k-bucket ping event",e)}))}},{key:"size",get:function(){return null==this.kb?0:this.kb.count()}},{key:"find",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,eD(t);case 2:if(r=e.sent,null==(n=this.closestPeer(r))||!t.equals(n)){e.next=6;break}return e.abrupt("return",n);case 6:return e.abrupt("return",void 0);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"closestPeer",value:function(e){var t=this.closestPeers(e,1);if(t.length>0)return t[0]}},{key:"closestPeers",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.kBucketSize;return null==this.kb?[]:this.kb.closest(e,t).map((function(e){return e.peer}))}},{key:"add",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.kb){e.next=2;break}throw new Error("RoutingTable is not started");case 2:return e.next=4,eD(t);case 4:n=e.sent,this.kb.add({id:n,peer:t}),this.log("added %p with kad id %b",t,n),null===(r=this.metrics)||void 0===r||r.routingTableSize.update(this.size);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"remove",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.kb){e.next=2;break}throw new Error("RoutingTable is not started");case 2:return e.next=4,eD(t);case 4:n=e.sent,this.kb.remove(n),null===(r=this.metrics)||void 0===r||r.routingTableSize.update(this.size);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(Ly),FD=[77591,22417,43971,28421,740,29829,71467,228973,196661,78537,27689,36431,44415,14362,19456,106025,96308,2882,49509,21149,87173,131409,75844,23676,121838,30291,17492,2953,7564,110620,129477,127283,53113,72417,165166,109690,21200,102125,24049,71504,90342,25307,72039,26812,26715,32264,133800,71161,88956,171987,51779,24425,16671,30251,186294,247761,14202,2121,8465,35024,4876,85917,169730,3638,256836,96184,943,18678,6583,52907,35807,112254,214097,18796,11595,9243,23554,887,268203,382004,24590,111335,11625,16619,29039,102425,69006,97976,92362,32552,63717,41433,128974,137630,59943,10019,13986,35430,33665,108037,43799,43280,38195,29078,58629,18265,14425,46832,235538,40830,77881,110717,58937,3463,325358,51300,47623,117252,19007,10170,20540,91237,294813,4951,79841,56232,36270,128547,69209,66275,100156,32063,73531,34439,80937,28892,44466,88595,216307,32583,49620,16605,82127,45807,21630,78726,20235,40163,111007,96926,5567,72083,21665,58844,39419,179767,48328,42662,51550,5251,37811,49608,81056,50854,55513,20922,18891,197409,164656,32593,71449,220474,58919,85682,67854,13758,35066,3565,61905,214793,119572,141419,21504,10302,27354,67003,46131,32668,15165,64871,34450,17821,2757,11452,34189,5160,12257,85523,560,53385,65887,119549,135620,312353,115979,122356,10867,193231,124537,54783,90675,120791,4715,142253,50943,17271,43358,25331,4917,120566,34580,12878,33786,160528,32523,4869,301307,104817,81491,23276,8832,97911,31265,52065,7998,49622,9715,43998,34091,84587,20664,69041,29419,53205,10838,58288,116145,6185,5154,141795,35924,21307,144738,43730,12085,8279,10002,119,133779,199668,72938,31768,39176,67875,38453,9700,44144,4121,116048,41733,12868,82669,92308,128,34262,11332,7712,90764,36141,13553,71312,77470,117314,96549,49135,23602,54468,28605,6327,62308,17171,67531,21319,14105,894,107722,46157,8503,51069,100472,45138,15246,14577,35609,191464,1757,13364,161349,32067,91705,81144,52339,5408,91066,21983,14157,100545,4372,26630,129112,1423,29676,213626,4397,88436,99190,6877,49958,26122,114348,60661,29818,293118,50042,179738,16400,163423,89627,31040,43973,36638,45952,5153,1894,109322,1898,134021,12402,112077,68309,190269,69866,31938,107383,11522,105232,11248,14868,39852,71707,186525,16530,38162,106212,11700,5130,16608,26998,59586,108399,230033,43683,48135,82179,2073,5015,196684,189293,16378,23452,8301,35640,11632,214551,29240,57644,33137,91949,55157,52384,117313,5090,17717,89668,49363,82238,241035,66216,29066,184088,97206,62820,26595,4241,135635,173672,8202,459,71355,146294,29587,3008,135385,141203,14803,6634,45094,69362,50925,546,51884,62011,83296,234584,44515,56050,89476,87751,19373,12691,149923,19794,13833,35846,87557,58339,2884,19145,25647,12224,11024,77338,64608,122297,53025,7205,36189,36294,170779,21750,7739,173883,75192,35664,224240,113121,30181,26267,27036,117827,92015,106516,55628,203549,67949,60462,60844,35911,20457,1820,920,19773,8738,73173,181993,38521,98254,76257,46008,92796,5384,26868,151566,22124,2411,15919,186872,180021,28099,152961,78811,80237,62352,102653,74259,184890,16792,123702,224945,29940,19512,75283,14059,112691,92811,233329,20411,138569,53341,109802,50600,134528,66747,5529,166531,31578,64732,67189,1596,126357,967,167999,206598,109752,119431,207825,78791,91938,10301,27311,24233,252343,28831,32812,66002,112267,90895,8786,8095,16824,22866,21813,60507,174833,19549,130985,117051,52110,6938,81923,123864,38061,919,18680,53534,46739,112893,161529,85429,26761,11900,81121,91968,15390,217947,56524,1713,6654,37089,85630,138866,61850,16491,75577,16884,98296,73523,6140,44645,6062,36366,29844,57946,37932,42472,5266,20834,19309,33753,127182,134259,35810,41805,45878,312001,14881,47757,49251,120050,44252,3708,25856,107864,120347,1228,36550,41682,34496,47025,8393,173365,246526,12894,161607,35670,90785,126572,2095,124731,157033,58694,554,12786,9642,4817,16136,47864,174698,66992,4639,69284,10625,40710,27763,51738,30404,264105,137904,109882,52487,42824,57514,2740,10479,146799,107390,16586,88038,174951,9410,16185,44158,5568,40658,46108,12763,97385,26175,108859,664,230732,67470,46663,14395,50750,141320,93140,15361,47997,55784,6791,307840,118569,107326,18056,58281,260415,54691,8790,73332,45633,7511,45674,143373,14031,11799,94491,35646,96544,14560,26049,32983,25791,83814,42094,231370,63955,139212,2359,169908,3108,183486,105867,28197,32941,124968,26402,88267,149768,23053,3078,19091,52924,25383,19209,111548,97361,3959,24880,235061,9099,24921,161254,151405,20508,7159,34381,20133,11434,74036,19974,34769,36585,1076,22454,17354,38727,235160,111547,96454,117448,156940,91330,37299,7310,26915,117060,51369,22620,61861,322264,106850,111694,15091,2624,40345,300446,177064,1707,27389,54792,327783,132669,183543,59003,17744,20603,151134,106923,53084,71803,279424,319816,11579,21946,16728,38274,72711,5085,83391,88646,40159,25027,34680,10752,12988,54126,30365,18338,100445,230674,44874,84974,143877,123253,139372,28082,91477,144002,13096,219729,46016,50029,42377,14601,6660,58244,58978,23918,88206,113611,64452,17541,41032,10942,12021,49189,10978,40175,37156,10947,71709,106894,112538,57007,137486,150608,152719,40615,7746,279716,13101,19524,28708,40578,72320,1096,182051,94527,51275,22833,45164,81917,77519,48508,5421,140302,37845,149830,5587,27579,5357,428725,248187,6326,206760,39814,32585,89923,44341,288753,284443,96368,31201,94189,119504,20359,52073,103216,179,27934,32801,96035,34111,34309,101326,18198,20704,210266,37643,27880,141873,106e3,19414,56614,167714,66483,107885,86602,4379,20796,75467,4987,5017,118857,26003,34308,114428,29198,6686,29697,73632,3739,69795,16798,41504,7207,30722,21436,36735,28067,28545,3239,11221,36031,41889,100010,19247,317673,29495,174554,6424,129725,53845,94986,7955,59676,2604,191497,19735,102214,62954,23844,11872,179525,261436,34492,428,78404,142035,16747,17246,27578,37021,33672,57944,26056,135760,2369,61674,122066,31327,19374,157065,40553,130982,69619,71290,38855,72100,92903,95940,51422,165999,65713,57873,50726,7288,20272,2081,42326,22624,81120,57914,79352,19447,1684,72302,11774,302559,161481,96396,13692,414988,3721,79066,56627,46883,21150,11747,12184,5856,113458,176117,84416,52079,27933,3354,59765,141359,2212,216309,2555,23458,196722,142463,45701,44548,28798,19418,215,29916,9396,10574,114226,84475,13520,18694,34056,4524,90302,62930,13539,19407,77209,7728,38088,9535,2263,23875,183945,17750,26274,67172,10585,28042,22199,7478,51331,66030,26774,192929,31434,25850,50197,52926,178158,4679,181256,70184,229600,9959,105594,72158,73974,2726,35085,78087,23284,35568,51713,155676,5401,27254,11966,17569,223253,71993,103357,111477,55722,30504,26034,46774,35392,36285,214814,41143,163465,1051,16094,81044,6636,76489,179102,20712,39178,35683,125177,54219,30617,52994,25324,50123,2543,87529,58995,10688,125199,12388,60158,125481,131646,7642,133350,65874,3438,97277,101450,10075,56344,116821,50778,60547,98016,106135,13859,14255,16300,77373,173521,8285,45932,37426,4054,114295,55947,7703,39114,52,51119,128135,19714,60715,9554,50492,88180,2823,118271,52993,122625,97919,23859,37895,25040,33614,32102,20431,3577,9275,15686,43031,157741,110358,1884,40291,125391,13736,5008,64881,87336,77381,70711,43032,49155,118587,70494,4318,10168,30126,12580,10524,280104,104001,145413,2862,84140,6603,106005,13566,12780,11251,42830,571,179910,82443,13146,469,42714,32591,265217,424024,92553,54721,134100,6007,15242,114681,59030,16718,85465,200214,85982,55174,165013,23493,56964,82529,109150,32706,27568,82442,5350,14976,13165,44890,60021,21343,33978,17264,4655,22328,27819,75730,16567,55483,14510,17926,45827,150609,3704,7385,272531,161543,76904,122163,52405,2039,19165,41623,14423,228354,3369,176360,85491,7122,35789,303724,4465,13628,2233,55311,118771,20713,10006,221519,45115,71021,35650,29775,7337,10864,20665,21142,1746,15080,1624,32449,10905,105743,229797,7701,3940,22997,178467,57208,389057,39683,59403,63344,63125,54847,69691,18336,56448,3362,37202,18282,29648,138224,35867,10495,5911,28814,26653,31514,176702,26550,45621,11734,4525,40543,73944,121080,27858,155561,14887,44670,30742,8796,107455,113472,56369,75581,183777,240095,133699,153299,8768,160464,26058,49078,103971,21875,71486,44888,17156,9678,89541,123019,102337,3972,83930,21245,87852,109660,287918,183019,686,10100,39177,283941,11274,24736,26793,26214,25995,77011,141580,4070,23742,46285,46632,30700,26669,19056,35951,115575,174034,56097,35463,87425,24575,44245,38701,82317,85922,281616,100333,147697,61503,7730,84330,8530,59917,61597,17173,9092,32658,90288,193136,39023,20381,56654,31132,7779,1919,1375,117128,30819,11169,40938,23935,115201,101155,151034,4835,11231,74550,89388,59951,91704,107312,167882,115062,12732,72738,88703,464019,158267,57995,60496,737,14371,123867,4174,243339,159946,7568,16025,134556,110916,38103,191,80226,88794,29688,27230,10454,76308,57647,77409,113483,66864,14745,19808,12023,46583,84805,16015,17102,2231,20611,3547,95740,250131,34559,108894,8498,15853,159169,148920,20942,2813,93160,45188,210613,45531,52587,149062,39782,28194,57849,60965,84954,89766,84453,100927,16501,27658,165311,103841,54192,207341,19558,20084,319622,5672,205467,98462,61849,36279,13609,147177,24726,165015,209489,59591,31157,6551,117580,75060,141146,277310,21072,22023,106474,63041,137443,122965,68371,5383,42146,98961,113467,30863,23794,4843,99630,30392,82679,13699,241612,33601,93146,24319,18643,32155,95669,40440,15333,34089,67799,142144,58245,38633,114531,117400,77861,188726,5507,2568,8853,10987,107222,2663,2421,11530,13345,30075,41785,118661,104786,17459,12490,16281,71936,193555,17431,5944,71758,26485,77317,20803,367167,158,7362,93430,11735,172445,46002,11532,54482,930,62911,2235,23004,179236,4764,101859,208113,22477,55163,95579,14098,67320,162556,90709,156949,3826,57492,4025,34092,87442,104565,6718,186015,28214,14209,10039,107186,233912,58877,81637,55265,39828,6194,145813,50831,105849,4974,88319,122296,10272,197216,95714,51540,72418,23324,91555,8743,140452,250249,51666,34124,7229,38592,129641,78169,174242,22464,149964,51450,14034,10026,95376,26190,120062,14401,8700,265,31386,143573,7203,229889,61567,4227,140981,2466,72052,10787,10062,30958,6099,38471,30103,23202,208101,70847,467,58934,32271,32984,36637,24107,30771,17109,73353,13650,2098,157040,67366,66904,106018,265380,107238,18535,44025,32681,144983,62505,91295,56120,3082,77508,10322,63023,36700,81885,224127,16721,45023,239261,111272,13852,7866,149243,204199,32309,22084,42029,38316,126644,104973,14406,43454,67322,61310,15789,40285,24026,181047,6301,70927,23319,115823,27248,66693,115875,278566,63007,146844,56841,59007,87368,180001,22370,42114,80605,12022,10374,308,25079,14689,12618,63368,7936,264973,212291,136713,95999,105801,18965,32075,48700,52230,35119,96912,32992,8586,16606,101333,101812,14969,39930,759,193090,27387,42914,12937,5058,62646,64528,38624,25743,37502,3716,4435,30352,178687,26461,132611,42002,138442,35833,59582,16345,8048,60319,49349,309,47800,49739,90482,26405,34470,63786,32479,85028,39866,47846,11649,23934,29466,2816,42864,31828,7410,74885,49632,47629,111801,90749,19536,18767,105764,59606,21223,10746,76298,22220,39408,7190,79654,64856,11602,82156,272765,17079,70089,245473,51813,184407,384678,1576,122249,5064,27481,6188,25790,74361,27541,318284,45430,31488,620,93579,45723,192118,22670,51913,4162,70244,35966,26397,16199,50899,209613,121702,287507,2993,36101,132229,67345,33062,76295,118628,78705,52316,34375,107083,107454,44863,127561,33964,3073,154010,190914,55967,39074,6272,31047,5550,41123,26154,98638,47110,19998,148091,50229,31329,59900,195442,19106,61347,73497,70015,682,45850,25776,38022,148951,6288,37411,232526,109277,27286,32342,9262,5220,16651,23175,46740,129438,78614,121925,66914,88710,127952,5563,21500,34521,10739,14863,191006,62956,17359,16749,67027,56284,69134,43301,35039,58883,54466,60823,404451,75743,59856,86979,7923,34273,83785,32142,7693,268986,197428,282681,17049,22346,22990,92245,107180,3357,37104,96724,49153,7683,31197,43267,82231,164276,23696,20848,188364,22309,24821,158707,1018,22514,70922,27792,45589,59709,10765,736,35218,63479,51987,24275,63588,55361,92929,81964,4658,20122,12330,44058,13065,311456,72224,8337,211229,38979,22590,138478,52757,32595,133600,8838,31549,94412,43391,90056,1585,94802,127271,6223,31889,137038,132910,2165,57616,230152,6080,10748,36737,74579,134062,50525,180532,119270,34556,76155,82394,52595,29258,31435,87820,67996,26943,183878,38007,2410,13526,180297,69856,3503,187396,167700,7838,16701,9199,56267,3661,37407,65994,23767,5708,62508,221700,67088,86978,46776,84434,32088,5612,9149,88244,21685,95151,46750,189612,2979,506311,2594,3628,40074,105039,78243,28523,6651,38058,71999,30992,12764,68261,108991,6165,26450,61961,13400,22426,7490,60890,109623,2070,12958,50355,67979,257096,7213,42578,52121,35716,65461,7516,124758,39268,302,64712,14977,1467,219452,2840,34229,11121,21602,19270,63574,8024,1532,17331,79839,78885,52029,180767,57957,6069,91265,61380,55767,8927,32881,287603,22149,35029,68876,6428,199567,46926,13412,104132,21434,366616,45060,110046,81924,128910,45886,52821,130416,29416,77342,21762,67329,121432,79924,11724,38625,81006,102033,28338,13326,3250,82056,82526,38212,21112,12382,111495,3263,7414,86274,93490,40844,30224,45212,24019,48411,71367,24941,76729,57776,3769,38114,202019,197745,31953,237533,33270,201580,255648,100798,44741,32241,98468,106931,10085,15090,170358,33154,66787,18819,69760,25061,234005,82660,6295,131975,16874,9076,4094,25005,17740,40908,19533,220019,44330,99792,50040,19619,13950,55228,24423,31253,95308,103177,184795,28590,82285,5059,3210,75525,49894,70007,56178,10580,36051,139681,21617,98736,3555,106306,164189,37352,63915,47824,24883,145530,61904,28444,11483,19837,145446,30420,112972,85939,11835,191233,2262,20705,58630,1753,148334,1197,144714,6887,11223,107667,60879,77914,4151,57417,81594,96681,169430,1784,20444,95138,254041,27038,596,7117,72808,13759,3353,126776,21074,55322,27081,36942,39547,139830,179275,4453,713,8722,71399,19204,25785,22794,23923,104114,11291,25458,102309,88396,75288,230440,206396,104551,58447,130857,37247,94734,31548,176529,226077,65159,20104,10096,66881,94191,237909,27109,37404,1520,27421,25220,113003,23423,24884,50585,6286,231877,150800,11789,3226,90004,60642,5053,202400,61442,132531,175329,57138,30116,103847,9973,75367,16452,32360,59119,21246,10191,164804,23305,61051,37348,154530,13214,5468,50403,66754,130976,50559,80515,14436,155492,84017,5472,43107,41240,2890,90431,70188,382,76234,48040,50211,281038,237007,32115,142178,1536,22761,96429,1811,31243,1679,49143,55209,17402,235054,61494,7462,77030,34925,87609,78002,9499,9027,73289,201078,101379,63544,27666,5469,10642,30029,49816,132979,95620,58086,351930,116300,2110,2043,30845,6154,11279,16727,4122,2277,27281,4971,3650,39060,61970,65951,39674,75686,38151,11370,130809,177895,32665,63725,122267,7857,39618,118483,44792,157755,178624,136994,24260,41308,22471,12404,21707,12486,30473,52781,50246,20247,39065,909,56825,103158,128603,31542,1089,41935,32744,12428,37963,84420,33134,72921,208449,42622,168151,127335,147107,46699,38216,12591,94342,85814,31423,24944,2605,87542,67473,192551,4496,56321,91819,17630,6300,256183,114569,202090,33209,35289,34897,24967,40520,43470,5344,10199,34810,14283,10381,10017,62923,49924,23233,64539,13051,35686,19698,11570,135555,120868,44924,87065,52318,52335,47586,140906,245885,109834,78668,9065,46990,25258,72022,61243,40838,4545,146387,10537,11557,17470,36930,68104,46711,24264,79401,81043,18225,120488,24746,84338,81652,28266,13776,21878,46973,1047,230465,73357,95777,24973,210160,62210,58404,110633,169651,6937,41870,9909,26822,191062,76553,27519,96256,239070,2478,205678,67955,58532,20601,50120,19148,78501,195724,110740,8249,109665,27446,30568,57631,31425,49752,32820,65504,50079,3663,102256,219898,23849,211315,14645,4359,91767,9528,12449,49366,7941,49763,107848,8930,27086,50686,9744,10447,81935,39513,46514,1670,29229,6172,22312,137280,97759,9806,14445,22976,56458,73391,34983,93760,174219,52573,33149,59747,2429,136277,75123,165263,91040,7446,57632,48633,97140,246081,84766,151684,79918,93268,120346,54059,54875,77858,32996,103590,45276,11968,19600,25849,17159,132907,42828,16817,4913,99462,103303,27395,5737,74184,20749,21160,14377,77062,131403,158735,10999,27799,77785,9320,34366,51593,61070,33746,47048,29268,36675,30262,53297,9832,82e3,20188,122292,39917,7331,18160,68301,185935,134830,15031,4935,10004,165845,185534,46923,30109,44134,122631,18874,22903,112790,26561,18549,348902,82871,140345,255565,135390,63556,103747,145055,179600,145662,296111,61661,211987,23952,52342,126343,48450,32919,44277,82185,9591,62139,205363,376969,394874,108461,18040,120885,14798,39863,16571,16794,58271,81025,55206,14640,118656,6361,44092,85970,6262,153863,108244,180200,72264,79947,38044,10050,5735,61221,80712,5471,115689,11391,11661,184257,20010,60116,30320,19327,134598,45455,27542,18004,125092,452272,1549,91523,46567,180063,156026,2608,11174,58848,37788,65907,80194,30490,5786,40775,119519,106241,11323,156297,8425,61495,2617,29675,2425,59886,112582,49142,59618,4863,50597,86710,50650,168632,27693,85641,83643,18993,25768,84284,28090,93592,36627,312804,43381,9887,9402,100931,97165,3311,173330,66805,28935,4963,184460,3201,78102,19126,21607,37496,24938,22615,16153,32862,134792,153318,61120,6067,2812,12826,12792,23825,37559,64662,202250,102694,155488,85881,149193,46233,65383,15521,106982,11358,176786,25752,39717,34208,24510,32464,77742,39371,72028,138229,60688,71386,102834,132477,2208,11548,63670,271279,28351,30338,38620,32491,99845,143885,152266,13252,2825,178663,108097,1775,78201,14897,113573,163346,62292,171129,22183,96598,38733,64971,166776,117445,9968,146393,44677,74867,20908,97328,12761,25656,26785,9148,112344,26115,99176,110121,22437,49547,6180,79320,5835,31392,43328,33377,75870,119860,69497,80273,7325,155219,43167,111173,28347,20222,3763,71752,55041,47252,14618,28088,15012,97805,194698,54636,2036,41349,6173,96604,61530,51859,43782,13361,24334,22668,24792,7070,23441,16789,3209,36211,208475,26242,32880,122181,182407,21444,31060,88459,29929,77907,12716,10934,97005,20599,31690,8403,58445,30303,22700,10336,86731,103115,337709,72556,46788,112566,47684,67089,53548,36874,56487,41387,125985,26893,40071,106683,73712,18787,40105,72992,67246,137276,50802,36790,70328,138827,22466,39263,183295,29858,50975,9322,57397,10654,24364,30383,55799,41600,23584,127295,296610,129078,143558,244131,86397,36049,1085,80677,3820,108139,5476,34767,24683,7758,13060,7239,131671,250593,59556,103392,29810,4188,252323,39404,116877,7651,43600,40338,13554,157253,39196,25978,144387,61211,234,50104,6129,10449,93777,9240,356378,274148,4439,72970,3724,147770,78680,62570,115877,40027,40547,36817,224392,64609,34795,165027,67440,2477,37206,23431,50754,164797,46018,94995,170982,27051,7957,22767,3674,27900,56419,18930,60701,41302,2692,84749,339721,61996,111094,80221,50129,1045,8153,62945,19202,8250,37208,37418,32560,79477,41106,88569,33963,36693,5892,30570,1581,66471,49647,11922,160717,29442,5643,114865,82962,95982,132098,22633,22838,94726,54556,28566,205039,162340,33216,16849,35847,221339,94851,26533,71469,1805,3804,12935,45483,71020,36310,65381,192960,34240,35165,59773,1248,46954,155332,96864,4246,388800,16129,57133,74592,44807,442014,38203,42574,80818,91592,26377,36424,65760,977,77387,22628,147610,28018,30561,98454,6969,119628,63648,18170,36854,26601,64018,22027,37279,51395,152934,21153,9430,58760,194742,5330,55115,34158,28917,174111,13171,122326,1526,43896,66094,25325,4234,148354,11450,275,18999,112191,44365,22723,68409,8733,57746,96565,75007,14196,108844,29475,88599,177563,100792,106156,86323,93726,14248,135341,194131,40126,47099,14779,8272,39597,95983,171398,65882,28052,10393,47213,40689,22120,72212,106829,34964,109146,753,648,21660,30047,17527,181025,5619,145357,4085,216883,9359,186951,24779,53931,24545,36197,223296,62628,168101,4243,107313,30321,26642,13049,51059,31027,107912,807,73550,26551,84369,122422,165872,49754,74213,234264,33151,52014,33100,87183,22365,52500,40013,23302,5652,72723,21404,26107,48434,587,94049,168493,96418,32871,70860,31709,25128,443,71597,166253,15670,70994,26341,133675,28280,75491,54756,47955,56028,26182,11952,113272,472197,64640,110753,17919,337,50642,22576,142,87371,53391,93210,126694,15285,19642,85667,14148,1506,42092,52962,33243,11970,20734,135843,57044,58880,13002,219134,22876,64754,232519,4257,43120,321573,24799,64526,124728,52579,81472,70831,276848,17403,74359,23021,182101,74597,23744,148267,12055,7976,5349,11772,67540,167347,65318,18720,127832,108238,22828,90233,9987,259080,118185,73209,79270,13775,90100,137742,90799,70569,15699,19961,9087,67475,57872,39731,8810,134897,131868,146849,19898,3334,2281,167061,91073,60356,467742,74712,188,53179,137679,92769,29241,9537,132595,80119,1041,88962,5976,40171,44911,102859,139059,104558,98987,47761,19272,71472,113864,175377,73338,10857,23402,23758,1591,139864,5644,4076,118760,16427,134198,18853,20291,100849,37423,22038,36677,19071,195521,57445,11069,31869,55718,66882,148490,44,41296,75242,49704,166810,9906,20943,122258,49112,105667,15969,10344,6408,187694,21399,72742,58970,14867,14376,81889,41856,23225,15042,56993,16074,131389,74276,72407,53875,383108,53597,37363,68993,44854,122548,430927,198279,38430,80409,12245,2981,628,2818,17760,37437,238229,7968,46892,2200,3730,34190,65983,37959,112291,87850,70827,6522,20750,73913,111621,41652,19587,2780,58668,25916,85259,18200,168962,95781,42445,102050,7776,57662,103313,47742,96358,41964,66174,100396,29069,204735,19679,27978,7479,40264,22534,61183,36081,107436,58223,14680,23002,101311,24716,124108,12908,5646,31750,40380,14215,232799,102772,14122,96775,61398,50917,12096,149880,67833,598749,124194,155871,49216,790,14677,65319,56917,7440,145744,95701,12206,49405,129269,76199,45732,9767,11058,9047,210885,11051,7392,26307,2130,8132,147526,20802,232698,115660,50060,59789,57344,107623,80343,112676,23291,9866,160971,34032,118291,15719,59730,164911,28975,2659,58046,78480,21854,66209,53863,109085,116045,29021,46481,107552,22130,18764,70254,31272,11300,52460,43933,84738,20721,53869,190840,79673,105300,7561,321817,66924,13940,33281,101046,183181,32176,71878,5678,62924,79535,56646,40303,19559,27703,93042,73368,42187,3670,37376,46440,7023,36816,109628,20680,5940,276440,275233,170848,112093,136996,14984,20226,111441,77693,112960,48577,39370,55707,50314,123404,26570,54281,61372,123391,4857,35928,246740,132507,106646,44241,7196,92258,9825,37688,51197,303141,5590,15476,132986,10955,85782,34486,26696,7991,28813,18858,39546,11703,11365,38185,5716,93555,11925,40121,60002,6985,10976,171384,3887,43394,13337,56346,6381,252336,39573,75042,53711,1028,31781,44295,95925,131713,7214,68125,43571,70954,213234,1628,8760,13391,65485,17320,56038,1710,25248,60803,57399,19839,3870,326,281556,50945,72400,21460,316244,75619,56246,98775,481,13513,55765,50427,7388,123519,32929,57908,27124,61316,101097,57467,30228,48792,10788,20402,37318,50526,155730,34456,158065,145305,17832,43733,64052,4506,35072,205355,177028,184004,187081,68616,35938,83703,10367,36892,93186,260137,51934,89970,4985,23445,26755,21558,7948,78741,23376,124405,85594,68596,57536,49351,12619,56593,132668,99924,109728,71844,71935,196018,65464,17617,14987,89701,143773,33997,8687,22701,33258,2914,4436,72108,85610,9671,49067,2327,82988,1361,1672,44033,35777,30269,24057,10605,82236,616,15793,13919,47249,112086,116698,9484,80207,90574,33304,68624,93127,56101,42210,160929,4827,38995,38095,4701,125119,5027,33680,9236,231236,14135,87837,23318,70261,78893,30151,81482,14332,1084,74256,27532,46644,79185,3148,62615,6981,55672,31668,36825,1849,14536,37446,14738,23779,43058,162749,72199,1168,21346,5592,85932,85302,9668,18351,57135,150360,2080,228015,77953,34670,119302,151751,31009,106725,84265,45214,59289,74178,113071,263206,111009,4021,44449,188119,192629,123592,392506,292847,114487,12831,205858,9852,20780,79648,75767,357014,97721,18166,21005,67950,33226,204009,16536,2987,11335,66717,144910,47950,17262,55060,15063,2934,51038,26775,178497,66008,3427,49433,128592,20036,157553,63861,3089,23015,51210,28696,35933,49942,71135,231518,99620,17248,21835,176536,20676,16944,38700,165831,233253,295625,36723,13023,52745,10907,19423,67972,125868,95473,82875,1183,108455,52685,33417,64095,21433,52438,33191,127809,44505,211823,7810,2752,95548,162031,7185,91196,47563,61721,33359,17897,23682,42806,178101,22874,49707,199897,75419,82456,8618,11171,79712,116847,18783,44190,46564,5346,59046,95032,7893,14916,3214,26800,24172,121453,34362,10250,17408,18888,4840,68696,22831,13162,36005,32512,14800,62357,41723,45046,27247,37486,5372,2564,34261,298500,66509,133920,89138,31305,117697,19097,108304,81386,84106,23802,46411,63304,946,51417,41777,41041,19501,115864,60743,294354,37955,94165,18116,1156,17937,20645,57114,90804,58042,48643,92288,9861,2557,88546,61333,101008,12853,5148,87856,4152,144503,73841,18718,9789,147565,10846,42085,12789,30223,8993,56352,67203,2448,28215,6052,23540,126319,75933,36689,80235,23231,23561,21383,38800,77548,102798,21234,31468,158608,46188,63960,191679,8051,67014,11185,170078,42186,28827,34777,41930,212079,12421,34750,24111,110344,73918,45171,70826,141949,40063,23979,24254,37309,26724,27179,24718,83648,54938,14591,17425,29525,102675,48975,48654,12316,8929,60640,41709,50168,63264,89812,50716,48632,38755,138583,160123,55579,71829,24230,233277,46322,39650,166388,34718,24108,98252,7031,106695,62498,18258,35062,217827,78731,34824,33354,19520,60852,2432,60224,8587,2836,62955,702,20227,42285,40560,95592,62486,11094,53035,143291,18842,46177,77994,1770,9657,107422,172915,32655,128716,25886,25164,156740,119928,165875,85817,11007,89110,33956,12652,65156,180266,8494,36889,19958,20955,96,1264,118288,135769,44754,86671,5632,19026,168220,289120,33569,93821,66144,70635,7687,5642,2714,55445,56636,71545,184182,93133,7332,37389,12643,52315,22729,11014,158742,17050,152889,50178,34601,41945,52136,9948,26914,63548,95721,115951,40759,8960,158258,38938,49232,48325,42234,81523,253019,66128,40978,20048,238048,38760,62928,122560,118532,43687,137472,163689,26680,9878,17448,51035,16211,60834,36749,29178,14241,59868,150086,2305,26477,42422,34342,165341,83279,33894,14257,29928,12743,13957,125571,89134,66712,10952,16507,147839,30146,7249,16565,45399,39874,114565,215780,31990,230881,171477,102,196546,44538,10880,84948,281705,86651,10617,31395,2342,453658,43569,60561,132901,21845,17727,58556,258242,22262,58728,4008,77997,11806,37431,30599,81375,109137,185787,114085,217292,97453,169085,30593,60212,11544,102056,65580,2384,91655,4855,95725,7295,157994,16228,20669,53276,141590,105246,17334,25440,76067,17967,39321,38911,11362,28559,63807,21627,26468,85816,40120,1025,15234,58319,69516,66512,124548,75845,78873,22137,46681,51242,85683,32909,76747,35555,43396,101465,1765,73094,1077,2962,39028,66777,57831,42048,15828,13962,36041,63657,52412,5242,58846,2141,5506,219012,134451,3936,182230,17558,17153,152237,22621,49377,170216,35257,68233,65374,6510,11126,212151,7184,2480,22517,3437,33073,30156,16557,3768,55067,86829,91e3,12350,148650,66017,79424,70885,49066,28250,21369,51213,34533,11510,3258,18176,18465,84413,6315,36411,163765,4346,356,107618,598,13727,285026,162695,8749,14583,7132,63521,184253,32378,25991,5604,30961,53675,4874,84693,5086,34811,26978,56564,7904,33519,51221,113942,69253,6664,125563,22055,220680,102008,742,51930,19494,176108,44424,35123,13025,75685,11759,74335,22250,181453,131147,16984,132115,154311,11991,76452,52609,85351,196,30969,9198,74919,2529,56838,71779,29187,116304,3504,62330,41190,86153,28393,254926,104228,105189,13264,84359,3574,12415,8534,57147,10175,188174,59504,60932,66318,16407,107921,17638,99103,49278,28403,39786,145865,8462,3558,43406,142271,29139,21989,36552,93955,72365,7176,13556,106185,37957,321774,17782,129017,51154,27938,24952,1935,39366,2791,33489,41582,56078,24558,9311,5449,218786,27808,190429,68013,36020,86003,29735,3404,87348,119357,115714,2324,86796,81973,40992,43376,93621,28784,16808,36367,2517,2909,191926,24978,55303,53308,205724,60068,3098,21375,64784,23949,26579,63121,12319,80145,39967,97861,6757,70143,67642,37082,34698,69140,122883,46151,62187,80934,429,19437,135071,137885,222647,13331,154065,327,61778,74257,40116,37493,14855,85079,237641,42342,102164,199965,71204,4662,29368,5042,113914,122214,8955,13149,102503,43173,5659,163787,69003,307084,63392,171080,21390,81918,86666,36622,24126,28887,5736,28054,207170,163428,79891,346467,95363,38980,111806,80828,9200,19288,294896,114468,87405,111715,141705,7015,72754,68463,48738,243147,33397,101210,37051,98801,82847,20397,4940,185559,18716,54718,83491,11725,40803,1128,12128,23060,5174,7745,67007,46701,1571,27807,180186,256996,18975,16837,7877,212758,250379,15440,87954,57755,24719,124057,83461,258,50864,8874,29038,71289,31627,15429,9005,4061,113851,107716,82819,13651,79656,117851,17539,111446,12938,39724,190787,4352,15402,21070,62708,8539,23777,73853,13552,38810,86117,16285,56400,1718,75342,142863,29033,378,110113,180321,32586,23606,26393,160984,207987,23783,8406,16904,24596,47274,11693,46539,60524,78595,48423,31718,20170,9009,146268,15183,191060,172765,1349,138436,37365,10970,40509,225817,20021,70394,152138,21541,66559,66544,89352,2725,17258,91345,7313,3815,115868,8660,40362,4071,103524,39388,118275,21950,6549,38226,32754,209574,29201,43495,18028,20296,40597,18370,47520,202450,24134,2219,8195,69545,38041,136934,46374,19041,159811,84865,58620,846,98749,13569,30714,97246,32186,4479,27355,92973,35214,151491,75963,37631,1561,27200,238083,23182,60756,12291,25766,39355,102333,87362,65741,59906,19538,201575,48772,102938,24438,292580,39964,66366,9004,61379,50548,37622,38732,28379,68180,76622,17488,69849,5963,7219,48143,43413,55358,540,58691,29506,19245,52193,48621,5518,13048,118625,44755,191081,42061,89197,2259,60665,66994,71210,51232,3585,142096,55024,7892,8345,58653,463307,65658,64319,137941,136323,53499,12746,43492,6978,95163,29925,60175,5128,7352,41463,184756,121146,20473,18426,4598,5309,54580,14277,121151,10691,56711,43880,63409,76682,11830,172218,264898,32632,66536,81062,31649,25788,92774,60222,11100,63159,9432,224657,25240,53613,152,138620,163829,2397,85345,12501,37507,64932,38575,43522,65789,80198,78796,35226,3851,108891,73311,3060,28391,93671,39663,46142,30982,66041,37281,68157,26553,71872,81142,211527,39747,118119,22695,2859,11066,20232,168911,7933,197005,17066,111071,44434,133994,120798,12766,227798,45756,132852,29917,36076,55352,65281,129800,41958,18944,84678,18580,168093,132621,39997,54092,27740,32354,3770,114118,103242,43918,15899,18574,145944,3190,123469,219903,24169,100571,62403,16776,92779,14535,17168,16475,14304,37231,1712,28218,242754,61688,28980,1318,51359,222657,99200,67989,31772,23932,35351,201251,49041,27306,19128,40135,3986,77333,19649,120683,151927,21081,7076,78375,77501,101599,8011,89585,96715,58179,5378,102138,106793,26051,217276,4197,16297,27014,46721,13322,22806,5278,29629,70632,9647,71519,58818,40603,128530,8903,36770,56900,31483,26935,43845,34265,34920,87658,6114,84767,64250,47318,50720,19264,162514,33357,13117,6705,46696,75032,71054,87004,42035,69138,11903,99854,102328,19611,34525,69312,6431,49842,101600,133178,108751,41829,89939,225664,48916,99556,9195,130387,5960,36857,116724,53518,94002,39077,53996,6945,22261,64291,8314,152785,57588,16522,9091,5048,87671,35441,39509,1945,12423,158923,178413,37549,14095,1475,73188,62878,4819,24012,68534,42606,4010,120809,57497,59564,101758,103718,32701,80116,12345,95834,46918,21468,53213,15665,31200,3867,5140,96013,250744,21016,10069,13968,35449,180829,27683,39704,59956,22893,3115,26293,32785,75934,62445,141162,62720,2018,83638,19949,114012,95006,3330,99829,130935,309272,9565,55874,121727,37017,23586,319858,40970,27602,8625,112329,61060,100088,118525,25922,16232,1907,60671,51583,44553,80993,5262,94679,8676,940,20736,11823,3020,16476,12340,152600,97416,3703,25744,66826,16245,16876,46446,84798,74227,176020,45192,61955,75496,23946,23626,40372,26036,6149,11822,30582,16541,41914,82385,232823,40921,80773,14930,3631,7517,39619,4348,36180,126106,138939,62611,1477,113512,47321,25052,14546,118881,29060,23589,128322,36795,18401,137921,104699,267929,36194,172791,18113,4766,188215,30083,332586,94089,5805,77909,22194,68234,154976,43220,40660,70001,184893,138095,11128,103010,22663,5108,212615,8485,5565,49222,54614,26530,42639,16319,55062,152662,105595,21114,22216,10294,68158,10436,86950,7206,62115,3977,3657,59874,456,118617,18156,106663,112229,80992,17442,8217,55551,5133,34344,251927,51153,39364,201321,7816,66803,23057,156724,145664,14276,95705,979,2796,6875,13429,212525,50602,26276,28284,3424,19465,52397,46963,31420,51399,206476,92317,48851,637,100820,83349,10317,60227,21972,6908,282439,32857,224767,95629,83882,42106,87338,69757,29840,68709,37665,45244,114577,49188,175943,54009,186746,106158,70168,3358,234002,50555,9221,129338,9562,20118,32923,78479,118280,65752,4977,10474,102174,60947,129006,10570,83451,8598,8078,159367,123785,80438,16742,5905,5281,181513,42402,6977,163136,93179,42191,14968,50421,112401,105440,33456,57347,121611,4221,94954,36517,24046,27796,6255,33394,72990,135408,116627,1233,57874,25654,95419,68156,401399,313338,55208,45573,93124,119251,47200,38196,11909,130667,45391,73904,64964,167846,4137,115606,52036,62214,7969,160925,7187,1132,134835,40309,73195,64494,80472,444841,61111,26500,45323,40743,53625,52797,22659,15631,29739,36706,28841,39147,102836,26794,10536,14845,87305,45874,12241,127587,83833,57183,79722,30844,41304,84655,20825,92500,3722,25655,27811,10157,81634,31362,34088,92487,70123,22190,185100,72658,139035,192523,88241,2078,230490,44528,85638,100198,22088,29982,291233,241062,13865,4445,137791,37835,107218,31726,19718,38234,72528,23046,19177,66695,5109,17251,28077,5617,21554,47839,72425,133825,1486,73065,181275,141508,21768,62971,63082,2512,34200,9904,120309,6392,91243,68416,268253,41199,116757,138551,185526,41246,28986,4093,19057,17295,4148,245766,122360,35356,112075,20301,75441,10998,7977,19769,62922,937,63547,100196,26427,157820,20983,236696,22935,8140,90315,156004,47204,140973,7726,45097,52725,22636,23436,257282,105247,522,88389,216031,202204,46812,211666,19693,68828,81691,45925,11256,30292,372,5236,167826,88328,232776,151611,5360,82104,18841,80393,25465,18285,20320,72377,31730,33160,45803,38715,27705,37379,24163,18360,103586,4015,32305,269494,91252,20080,36567,54650,7797,57073,12650,31164,42209,6375,261663,105528,81661,106002,2800,5375,17247,43151,4442,15727,194619,100855,144898,62320,78465,39929,16454,1967,28311,61363,17219,9395,8745,121445,76939,80385,162380,22009,54191,44248,16299,122830,48151,74429,78291,64755,14238,44966,2511,17712,67954,93583,829,105899,49935,84750,11591,33185,85447,42717,27409,208542,28965,62052,52525,5597,25694,65594,16343,63224,276188,12475,9331,127507,38522,57287,24128,133161,79723,105548,133695,48917,27558,43278,46520,13778,141954,110785,83366,17715,46317,105763,66298,147013,41086,94180,16478,220447,44611,730,19722,78975,117889,125643,26254,16574,18480,65006,15806,38549,246418,46052,36056,8440,34984,30170,3163,59800,4458,115442,4283,41970,33507,104078,1653,22,121158,276486,3655,6338,24048,133421,23641,2161,24422,36006,8086,10675,181474,12307,29514,59143,14729,52509,87128,122470,19446,80852,33314,24573,119864,14237,9652,57779,6612,51851,15284,98871,90581,124466,156831,21190,22015,71380,161906,87247,69201,18392,17908,108470,72962,40719,14338,17911,95260,43339,20610,78916,20710,72451,11315,31448,17263,58853,178878,48111,116002,45497,80506,82605,85880,36300,121755,25215,36118,301929,88728,405223,276136,553,34704,212438,49970,78329,922,20711,25036,257130,38295,145369,18128,15385,30829,55656,48345,8012,3561,28004,122041,192900,58338,112508,41085,29976,87040,47117,23905,4336,92061,138880,97407,42083,172121,6256,25192,172671,5,93568,1420,12677,31605,56743,40620,6015,78415,231077,31298,80026,13902,19048,24924,170586,32955,176119,87859,36731,6773,27711,24658,26475,115216,133207,93250,95820,88522,8317,5714,124047,55219,86860,19677,23961,22928,162209,8904,225992,359835,56084,96201,29392,96558,86071,93643,55114,13347,8183,95129,82012,2017,123336,34219,115554,157159,47747,101684,41008,18735,193781,104151,226906,7552,179874,124113,31159,21162,44010,14771,51268,166128,31382,73124,77438,92830,205709,12113,1292,38937,13114,1334,2118,15597,69581,14449,21934,76618,48728,67038,14967,51495,24243,87736,147249,26720,11119,46063,43749,5843,44147,152629,133428,65703,14269,45604,57982,28672,55616,45957,8438,95433,37698,220862,132034,39456,61870,4161,26501,73560,56418,9845,4654,20916,10456,88920,119358,9015,65931,96507,48029,38534,21676,109081,43078,34943,25089,6131,28766,23665,5477,10255,16695,67,45778,42443,42770,29534,23733,100513,62617,42630,48746,14191,43753,50295,26007,8792,57243,43119,54725,164253,58250,112304,131796,25165,4651,3188,24831,47748,3705,19540,13211,102095,5593,18699,23666,32005,117571,33541,60584,74573,86311,99443,25172,27222,168938,7143,11853,53560,18834,19960,86522,28217,53266,117700,72989,34323,18721,66450,34346,74056,47217,202002,46269,9429,68582,75458,37823,82843,96652,32549,145144,27958,19820,158086,31955,201406,135379,31207,192545,12950,51704,9094,248263,76147,64028,110009,79407,89345,99284,223492,47966,26848,15359,201137,2861,110507,71231,72297,31851,118777,71039,151051,240855,16333,50766,14727,7939,4149,80908,418780,88378,59276,1327,7284,38576,79814,65820,42199,84860,49574,62596,12396,70598,40117,8648,7994,16836,7630,14047,359699,106878,525,29037,28064,13380,11675,50669,74216,103539,180314,27449,56299,172344,19274,7301,246099,32043,19422,36506,129317,6806,30140,4614,46639,66926,932,86600,6322,27847,233103,10541,39025,34887,3517,12972,26220,2031,66561,115015,48658,47596,12714,33845,3893,16165,35237,89983,14769,11962,147224,47018,29977,27979,5552,82338,86023,131368,1218,24853,237840,132193,15455,40873,3668,65351,53388,15229,59889,272245,47934,11858,34347,18038,90853,86981,300602,19343,114181,29362,84921,6095,106059,79472,38015,1206,48741,6208,8e4,21916,17423,6002,108083,24479,34931,56661,9511,26995,100694,163853,35997,81254,58321,18919,171890,86877,91341,74503,70477,53412,7027,59281,39892,131302,5864,15947,61301,67466,162369,47956,27874,35624,282324,21270,111847,102548,41482,30955,116737,28264,8592,55458,22301,75090,29821,30697,51709,3041,19208,8038,24634,30467,87509,126428,19389,18814,152686,20701,83474,45832,80891,105808,11378,153223,120770,98186,150633,49838,9141,12755,30962,5260,74490,21256,31678,65062,33326,289838,187831,20595,89768,2805,58535,10844,70085,12090,2451,138068,98544,24461,4511,6754,41684,28203,3383,65355,82833,30161,83924,234361,128424,28921,222594,33975,125491,34069,11508,67464,144226,41850,98703,34371,7901,21254,38398,65651,23549,53883,213340,123269,12028,71764,177701,28758,2623,68395,11549,15232,68603,9660,63116,36079,57093,31198,20475,48467,89984,35619,186847,107469,31389,43631,73867,41949,68841,114250,1605,30564,63403,17588,27680,99533,12641,70325,50428,73426,78379,11855,91651,72081,91720,60198,15743,12065,83398,140046,6761,46598,45900,5068,886,62448,148968,37347,19405,9680,15819,43496,63370,75667,163700,37639,3633,22774,34341,183131,134335,37200,23915,7054,14194,12970,26438,13350,285521,25594,8219,104410,91039,168804,138480,149734,15907,33818,61132,60082,4622,110187,56736,13551,73571,3945,73463,65498,17758,263266,17593,2710,27585,54469,38200,45367,63754,28881,3473,12791,98287,31895,65787,4463,94536,24951,36332,59901,28803,52130,86403,7668,181822,74831,18977,9850,177206,145485,109798,7292,31421,26280,77211,58511,12507,127004,11113,147,8729,56208,43066,79926,129937,31345,83947,39915,46146,98763,42566,1337,13192,18323,105163,80570,117753,16555,72883,11077,159438,40764,70933,83329,26066,12276,72059,21655,173836,126713,69454,153482,91585,70644,102558,110483,6764,127864,190133,3961,101798,20945,71138,82402,90884,69669,44753,923,16939,59700,164258,25969,27082,31399,43846,6306,246093,51342,6153,151581,202801,182731,56475,162188,89426,141356,14355,121815,27536,28023,65257,77523,106668,127314,24947,12790,38796,169698,23555,10725,44573,183083,42088,62716,43265,105958,32050,44067,50118,1668,3874,6243,318411,16599,1691,94999,52378,28671,216728,123258,2059,34969,69225,5913,136280,171443,141515,91662,22175,135282,80020,92270,1663,4808,4482,3495,34691,5226,109830,108512,17342,107488,11606,123190,100247,29666,146527,113014,15794,30894,13224,39585,243192,22351,9903,7836,47699,11078,25468,122291,48821,26780,122679,75521,81450,630,4895,92900,55074,74293,17441,3563,111657,103102,51613,12318,52370,36191,68245,34269,40445,41354,122901,168604,182500,62012,42557,11259,24428,115113,86345,12362,3909,78430,86852,134602,20459,47853,93879,22577,7659,3688,38555,13349,17381,56715,91639,12493,10895,92438,3142,37057,28928,2004,36427,32268,34222,209974,10432,67436,41989,173518,107930,27079,62729,30908,55558,5828,45031,14902,53546,8204,144263,60255,14520,88212,86582,109589,69356,8064,47449,8505,66558,16886,4844,52817,111260,215129,12941,91118,650,20770,6273,73089,40618,62790,2873,35002,14023,97208,19386,102646,36993,143736,135457,35385,113601,17893,32627,84439,100619,56016,6581,57264,172160,45452,111710,203627,70131,24100,322787,1996,35665,70078,22358,90922,83658,4097,63200,58499,14542,99153,52159,6615,12414,63415,31986,16823,1579,65405,137809,8841,16898,48082,259,33014,42375,12260,179850,73667,91389,98882,29532,17311,326251,41092,5928,20742,44964,48019,43505,9317,49265,6643,192712,48424,163487,19861,20113,70848,31928,105333,23685,78563,14638,54755,7158,24142,44018,20774,125255,20331,24280,10163,1285,2336,39851,4299,117269,46714,63816,87779,159624,11731,9971,990,137317,108831,50994,74554,162680,23640,131597,146962,170620,34829,91205,21184,1913,63616,18427,93136,156592,17519,67565,115882,138220,78622,88535,18115,2711,33554,109492,54298,971,24914,25863,36363,45715,27099,194995,14299,178181,111488,72395,322385,157719,130787,11897,81843,83999,11369,49280,118604,40922,61332,110343,53407,75639,40582,300440,54722,25637,13694,48248,48278,194521,56203,52779,48783,72627,10953,376,16733,280238,26351,230789,15132,25168,137270,3588,63704,73376,94031,74284,19443,159557,9697,39901,13351,119050,15406,146455,3460,29556,75195,37673,102524,92329,47289,98413,15311,100684,56345,7116,95480,11590,7200,167,23610,58426,17730,136656,27944,53151,2701,8824,103124,3017,90744,113588,53216,79736,65940,26931,498,29568,80540,143543,21292,1740,59268,16561,180816,42323,50174,40890,52866,10703,57169,4700,17191,4424,93511,49698,166650,26972,48631,165169,82879,69326,202970,4007,2376,231325,139592,22119,62851,37504,68816,58345,67398,186643,43331,277416,53749,15746,23102,17432,4793,151138,48822,54265,48203,198688,14305,54287,2291,18018,113378,123260,7180,97549,87027,120085,2920,76080,8190,102005,5641,64580,14955,59802,54028,58884,19367,81779,412567,85957,97053,103637,78871,29364,27637,141728,4767,30686,112738,130146,42745,12730,105040,14844,232,210944,36581,152317,135543,29744,3129,55647,58149,46319,27265,17499,28005,59948,7170,34138,5702,293047,110892,408,91760,218674,18469,46095,81403,14389,4610,35672,73060,11006,74848,104820,118143,190357,20043,105358,141735,5115,27093,45924,123073,52599,29433,9616,238350,78610,24851,58858,26769,31969,24613,18294,4982,32735,39639,143563,112073,202205,12567,4873,88601,44897,81503,101648,81362,34662,85277,17574,48173,21435,221188,40215,39576,80786,26544,64668,81841,10731,37733,247986,149188,127703,495,18382,54388,72446,43071,30974,198723,89608,41360,190,33045,8386,31658,19992,237838,119015,137622,50890,100913,6460,116233,267230,26621,104129,65114,14190,41542,14888,85962,23342,23041,26453,43725,71809,45186,4770,46452,53894,56616,221286,18973,9038,109299,55365,19366,26863,18808,60909,69353,41738,83463,12100,68561,72860,3980,13796,49340,12332,31311,27418,4255,53430,18976,45523,510,14224,30477,26581,4530,3651,101663,139840,22709,150861,31996,63923,120623,262522,3076,10528,2929,14672,130238,18087,9816,121894,100308,25085,55111,14565,18952,53293,2042,369988,23674,61789,133529,28783,108293,35477,47119,36448,71049,40015,33055,78598,198442,1833,159937,40654,77444,189245,113153,8621,18599,38553,35223,166072,2375,11659,21786,89523,6032,12116,63046,159398,18454,3678,32521,47626,11411,103527,38896,42946,15696,26370,10185,8413,37080,165583,4331,63555,14907,72220,50056,6623,62236,36565,49783,10049,17503,100581,55951,146244,24724,9626,17969,25524,109300,173965,99994,101056,46459,43647,53737,277968,8347,123521,74858,33829,44762,77574,877,81377,222525,123532,30602,43881,53145,2973,16284,81940,61281,127044,63620,9875,14756,114829,19032,9202,52759,119141,23928,120551,19607,3599,33401,76821,73233,117430,39968,36539,7071,5446,121735,194059,15206,45283,6706,15603,65615,1207,165723,92275,34773,104447,8396,32353,205240,164323,13600,60555,79205,25532,22907,33410,57480,107111,69630,32137,47832,70913,33161,20321,2371,117348,10714,86246,1625,11763,17900,268,78457,99175,97940,101092,86660,32221,14041,128504,125080,53744,124263,31017,13897,403,31859,21964,5633,111630,5547,77329,17961,18241,84995,25984,12983,67491,62168,47262,5241,297,51191,7351,8967,147212,82060,16821,782,11033,82431,62957,5026,43459,77963,203477,53528,6247,191852,87774,74164,215654,13467,1522,219964,28589,244104,16242,117821,67725,72570,156792,17186,15979,26990,44128,193014,35276,57125,16212,166451,68017,6905,77608,16364,53777,75921,76426,37975,26203,269296,64099,84122,12077,38533,830,4407,20139,963,43028,38902,42911,37503,83343,85045,16979,1165,60835,137387,58380,86990,110066,134540,56331,193845,81238,17922,163093,38744,110641,12502,56404,34862,26865,125964,12965,111648,25547,7771,27196,136980,9555,29551,107158,57885,18831,37705,35505,101742,13970,102109,62548,124657,23328,11124,89592,146376,248050,6241,22033,18337,80685,29898,11908,216623,67721,106162,146610,21377,15085,91552,42041,62560,122532,125336,102365,121537,142559,29693,223919,11515,110495,18776,22494,5895,185059,103592,229351,51220,100102,37027,257855,29359,54123,36066,106493,12244,79258,32002,432,56205,94836,90182,6726,14762,29391,48938,26864,38083,60364,3310,60192,14766,205567,57504,110760,22649,24666,46333,21517,3430,13135,28873,27052,158809,11597,20529,6695,23138,22960,37137,45574,6545,305877,43423,26153,24769,59844,14501,10430,134352,56169,13213,103432,49523,35181,13435,12408,129475,64620,230854,77390,51990,15653,83248,33466,44571,117828,51481,2187,10559,68019,18021,54895,48247,18354,33737,4554,108595,37288,39767,116707,9175,3726,108877,21616,83684,49862,1938,8543,276466,20134,108498,48770,102254,31914,131520,185291,100559,51890,209,19526,76471,50544,71814,99351,8172,198526,28816,20419,9109,98389,136777,76479,75596,30635,165417,48216,120220,25955,211071,39314,24308,32164,2559,146280,43403,9233,17947,90585,1786,86920,125662,2457,64741,32152,32918,122882,78538,44001,31723,56426,23375,103172,88177,145697,52506,49319,68016,31664,41488,18486,110400,7030,28241,986,109199,19900,42147,56864,65287,49183,7858,24e3,30453,840,16673,25907,68916,89927,6309,158335,36407,199737,130464,13137,59603,201778,195292,21015,42466,179062,172561,89492,11075,180407,31868,72493,20998,60217,9865,19530,39274,130266,54539,21623,12535,13505,40641,73375,4087,85633,2153,3117,70680,55788,92096,47509,98493,37490,271936,151475,3032,16171,96642,34106,78425,125761,19591,3366,19316,54508,24183,50786,194248,91528,33253,34622,108355,41741,705,3814,3883,108929,13203,67831,10142,59754,68208,29128,84820,56880,38794,24972,48571,40821,40476,18137,164254,24064,236309,79181,11282,395,39169,2013,51587,28551,9645,701,109513,115899,113566,12762,62045,58322,103726,41343,40866,244102,143816,2490,70346,40973,52618,15412,30720,104315,38917,42027,93676,17513,107418,20706,123890,13399,97727,24044,87962,65606,44250,98044,65276,74790,101473,19350,91570,1326,87790,172042,7577,100813,86896,85891,41512,108130,27794,14875,71431,12835,156250,58135,3759,22476,42176,115873,34686,56523,73643,108505,51491,20838,12721,32863,45700,29496,13700,34294,55360,29206,155942,123812,7706,163234,203,132720,49358,144431,8130,175788,35818,3270,76832,25710,54095,97274,28779,94621,74396,19092,128242,58067,20885,14670,93255,15107,63291,23654,126900,129421,59294,262659,9798,3251,67344,28600,44629,50672,29072,26999,31526,23183,49175,165843,175455,17282,175411,32022,45989,30298,90690,78118,83156,23749,35636,31317,7069,80381,94561,133756,14960,97404,6138,41065,78041,32843,16601,34123,9559,146529,123377,96395,54441,42012,84257,123541,10745,22139,106459,11720,150883,172651,154996,110538,4728,53447,25704,2009,71152,119354,21166,66604,1429,216162,8637,122250,63520,27180,29172,36124,276428,107787,77184,4680,14952,104903,24418,14793,51561,52931,8371,26342,48526,7118,92066,67280,40653,8847,34597,105438,14198,50163,61188,146286,50315,41205,170829,161496,585,197359,95056,1687,365794,91349,48507,5804,49263,5146,104902,96365,117343,132222,46084,96919,16875,8073,262381,79982,52663,13928,16056,153908,15145,109256,132308,18763,24904,167644,13618,40750,18686,147124,114709,150038,52849,2938,12568,48617,8778,5459,44202,44591,74914,17183,248689,13878,7822,80060,23116,194037,18487,2067,7798,43077,33678,244028,31320,74273,2794,19466,8218,36280,183997,48124,19416,29656,19280,98734,7715,18311,30701,133602,150307,126956,7378,2933,79903,13178,12593,86571,26604,92446,13574,44205,65699,427599,21118,8245,14407,27877,47936,33542,7916,26460,117762,21596,37818,2249,127359,209394,60044,47677,308089,36791,154971,31417,6998,150042,174360,12255,43009,29335,48739,3912,101398,53340,2580,146939,151295,45360,125275,15273,45383,27456,48761,23314,8750,60801,85823,104759,27894,123685,66968,39480,26917,55290,83305,2696,98390,57569,145853,340733,4919,20024,52268,30884,7413,203685,70989,112855,4129,50536,349518,68205,332641,159581,135361,236026,37563,176404,64899,6578,122033,63871,1850,85234,82089,66124,74145,121098,107351,12687,36881,117334,13136,14698,85933,93866,18047,32620,310,15094,46e3,88451,23632,36645,27940,87618,80520,58892,20976,27702,140090,96075,67841,103292,238964,87778,107338,17019,83427,67522,7302,8261,47570,116787,8730,80484,61772,174422,56005,131193,52875,14588,28471,59817,9586,15720,158155,51307,109734,15196,11025,59331,3884,52626,102602,84797,25158,27314,4437,20488,76214,189248,35023,114952,157376,2827,62439,102878,129749,36405,10329,109339,108633,36662,1254,13267,5470,87105,58004,15397,10434,159667,21864,52022,179464,3013,32147,31496,116832,18494,105502,129227,107267,50033,13481,9954,24267,22141,16257,116154,36185,950,115685,11305,176708,2048,178671,112573,287867,162328,497663,95170,50979,193861,50987,30368,136257,31830,46549,15119,169876,23788,17462,249887,57377,1949,35448,14791,43769,210091,3783,34612,282103,88380,245190,5457,20491,98908,11402,86899,117916,16028,162584,60644,320177,156096,31065,55876,22e3,77655,9992,23397,13757,317623,63978,215255,2443,17648,93231,27388,104529,93807,55505,140477,12046,112040,70887,40152,94365,112353,25063,114679,266061,71248,119555,15589,2244,617,14129,211431,70110,100652,7777,4383,85911,89221,21010,120615,58357,86405,37554,41647,18,15143,69662,60491,14714,186134,148344,42347,5410,168175,44535,42449,343894,129417,99682,20659,27272,140483,63455,222159,17536,13722,42637,62324,11976,114691,148109,2283,32057,182393,4295,147364,33705,2075,44303,30274,28331,63740,69740,29148,10346,44862,33716,73937,153333,12930,38784,247159,2515,41053,20256,83368,256189,54639,115240,5096,24661,175419,153552,26516,141,138176,63885,34115,47222,55709,2765,28479,38875,236608,12229,22921,77291,54426,45388,2860,57787,114579,295139,105782,17826,71066,19119,54364,69385,16568,12323,28057,33346,34919,124763,155533,101386,31644,8627,49001,303600,29868,63213,9103,77280,71333,9696,138789,37059,24823,5057,21352,32368,114208,56803,19424,10445,58514,8661,209508,26187,171838,10460,63454,14016,122504,41328,21329,46618,32493,38225,7855,31763,7945,29876,8734,6438,24205,97490,139977,130740,47323,33195,85390,57194,13813,60600,21313,96251,7699,27584,170521,139271,1363,4402,336738,129223,84983,69150,13147,3590,163929,207225,155260,55916,20288,4503,8398,98490,11773,27512,37113,84976,86558,28365,11756,116005,182148,13733,115313,47644,67208,85069,9347,14995,226141,14704,101835,41159,35314,13113,63526,214039,29978,50446,83339,17440,129441,72522,118641,97816,24907,73844,15717,118884,167255,96509,162793,30847,36849,51297,78974,77793,10427,1873,2972,9999,35074,28190,64297,146836,46298,60038,163007,108919,61219,2403,75022,127339,4233,110389,69022,9833,128097,88016,79390,222936,22570,94657,28462,56956,38803,81536,30474,152794,19566,16481,147408,74574,81895,20731,1918,1366,76367,187321,54494,24366,21690,61696,33283,107477,77499,31112,414383,74362,18463,218441,120929,59848,258629,201924,69269,454,19989,13054,59894,3623,58908,20681,35723,78523,102680,38988,184112,108087,50944,132704,52966,21699,18860,96349,201411,82697,85395,95658,5093,6427,177894,44191,32755,26961,155739,6249,31310,81030,26574,84311,120155,86730,113535,7424,48888,13516,45747,98098,20077,183995,81945,43210,26704,40420,75831,45648,11180,6855,57927,65528,124096,34851,2598,156633,107572,127352,38169,123845,60142,62722,105584,232364,23211,68120,1601,22169,89299,747,258039,80572,7258,152249,11862,101204,8834,121434,33761,19175,133142,46343,40178,48723,3589,41977,30210,38868,62257,10087,82658,87827,90646,16415,47552,351723,28298,72225,91146,272760,1701,11295,1652,109651,300747,51863,198800,29446,11794,32345,37538,22356,33102,37590,113544,37970,11478,179743,25454,103417,59905,221970,105196,145604,7817,164809,102360,16974,75840,255333,56902,6659,1954,645,59400,67769,7689,18675,5215,13793,20536,27852,3387,29523,259718,16860,94625,43143,29245,15848,233581,22685,63631,78557,22836,133302,84513,1348,51826,47129,98836,58284,1830,1749,94642,10933,6145,12506,10975,13879,103781,144434,10268,28409,32346,52968,121567,107374,77268,23686,35097,10501,155275,15303,47136,21102,168741,55332,90385,15996,84817,681,137803,25054,142275,6163,38175,8056,124296,240642,65621,4934,178205,16101,62803,60964,18230,100622,76465,44689,14545,9543,47514,16852,93380,28048,12047,107106,37575,101485,77047,57326,34819,96137,76916,6469,46264,115983,75768,87668,69942,13027,165,8373,114231,26434,52844,42799,182044,23580,146254,38081,43236,33883,146220,382894,14606,46035,36481,166621,35417,95382,2957,59384,60428,36358,66343,75378,22267,22950,83528,17577,56474,25285,4619,179691,75355,95836,53295,34588,171410,4487,14679,84208,44015,18562,109133,54101,11531,86052,174479,303157,28095,9953,35642,14564,39802,16145,77606,117406,53038,121117,53624,22062,1212,7632,127157,237292,189087,10478,127345,102515,181997,86752,87623,10966,121602,68783,68681,83042,114380,138349,191305,67176,50085,39016,1427,42384,1412,67118,122616,72389,25260,2237,13576,137346,19938,20304,2191,68759,5373,61364,238507,75814,23931,69565,38993,131741,38364,12528,87762,5679,129853,5310,186831,32653,90338,260176,389531,108118,26843,43985,50175,30563,25106,56965,18130,140428,4542,165503,117991,24219,229605,1819,129663,1240,3797,76093,18398,71339,51919,93043,27175,47060,216257,6483,35051,1217,16512,80798,129064,13225,69339,8548,237079,72298,2575,34280,51379,117910,55671,53345,247552,29486,39328,140821,34681,57045,60177,5004,90269,78522,2479,322607,48474,61296,13057,31558,4678,59271,6699,27044,31988,35944,12503,83480,4389,136508,3781,114121,70279,4488,155829,42214,2898,68191,75695,305850,45041,74344,106509,30087,17429,93292,12477,290,23080,114802,35714,18751,26554,105424,17775,2144,2412,100610,65192,113975,52975,180272,135050,129815,76238,106483,21440,63186,4260,46189,9711,28249,4169,23429,23390,8324,141585,63809,67668,38457,38063,39226,59972,1189,203916,62368,14403,16949,61767,85801,1739,40147,35049,76757,33124,62102,15780,103593,103009,53484,22952,67973,114645,6566,5245,50462,7601,8288,3513,194571,80276,1908,54592,5124,58571,2513,6800,273997,193904,1119,17991,117245,2508,129156,82366,26278,71465,63341,56943,39662,106116,94966,156875,9736,2204,122308,94418,27134,1280,24539,49022,45314,3764,50904,46424,30699,28087,293839,9400,33646,40165,822,147499,50263,116179,29085,11863,31314,5578,17797,5104,12454,1604,15342,219206,10232,67800,94261,25872,13565,90339,78971,75377,26649,41184,47695,11514,35369,20767,14227,41953,309396,148270,147938,33074,14453,27499,109019,39018,25738,240196,158931,52820,8612,95853,21524,137010,84901,70869,70021,116794,48404,38771,6732,1070,70990,187297,49140,5238,576,3564,253975,16027,16483,2811,37775,19034,25259,4053,2e3,70083,95774,19713,33431,92703,91314,42381,288770,48194,95985,3991,77418,13406,241328,245086,56533,35275,62725,9246,51924,70181,95331,16163,31410,79016,39312,120878,119371,275987,80124,27712,9186,220,23598,146167,85209,68238,282190,57048,31273,30555,80913,17594,75779,59160,135002,101219,189377,29225,96735,60126,62522,104e3,27620,86814,17240,147533,11001,5425,43682,410,49460,87270,69480,46315,59448,1816,76201,9431,11788,87960,29063,65539,47347,11678,33846,7008,196704,9895,6753,8633,120892,59970,572824,115934,6646,202559,892,48351,37611,251282,57823,67263,57750,26527,34485,90747,7685,88370,6144,64182,1709,41969,21458,62327,181657,49247,225330,122600,114574,107124,85361,111833,63243,71420,15655,191178,72430,18063,51425,54002,12364,53225,86557,18193,97580,41232,138398,67821,128724,8944,233212,101353,52099,42127,14006,120107,32789,32132,3498,18123,33758,56058,5779,128760,59888,98869,18445,84702,51911,13234,218379,20093,39031,8074,70195,20708,23462,24355,131384,60189,26390,10403,41060,7140,10781,49410,42261,87202,82566,41663,43105,60276,2768,5733,74176,28329,2297,145430,131632,83615,122915,105441,655,224102,5284,136426,67763,16294,188511,32538,61049,27893,3394,13951,159099,28542,17930,145360,9492,190122,32285,78855,26440,13570,58648,73908,4239,124561,2444,74172,53131,11468,10794,73566,11623,35343,64710,30481,4163,10328,38309,29901,10538,154377,76132,92405,24839,11679,3465,13449,11637,7824,2337,57754,1260,14458,41118,19878,38661,13416,159180,37074,163164,54137,28627,52134,184900,8520,40385,29546,30502,22386,66527,107458,6850,24022,47983,30603,35083,8934,304066,39500,9,28261,33026,77251,9374,44833,116312,34990,29236,63563,125639,135405,165398,159055,55690,88141,69643,236964,31983,25572,20436,36746,60896,31850,16179,11828,5888,3043,66368,9750,31167,7915,53111,36430,1333,64344,93659,20061,60596,180191,51630,6792,30244,43509,101058,22409,420,44210,109783,43223,27030,72477,72831,32679,29235,7675,47556,12258,39907,149412,84926,118247,24692,71717,105038,86009,45941,41189,89453,29856,52543,30627,226798,67303,59230,67415,34408,1367,99685,16867,128419,52147,4111,125381,117881,16173,44093,102224,31575,23234,24870,83790,127407,239098,3200,994,1255,100903,242275,117266,55116,38205,16140,29662,11307,40414,208793,123355,56470,4862,75600,30119,58218,70828,24075,26974,7802,192353,4851,5475,78720,66596,3409,28573,64396,30381,30690,59859,88256,5406,99945,103064,34463,37727,24238,86643,60088,4057,23741,5967,162904,38240,28356,93858,25510,122879,6897,3278,7057,11971,4400,35461,211413,21395,59615,39471,87233,55795,128426,3051,22470,41950,14705,3974,180108,80476,78442,204996,91987,15634,67610,139015,142373,35611,51134,10387,4353,153456,57749,181039,14183,68447,151532,21107,36452,20551,3186,46247,46383,129666,88736,140662,146243,2066,8360,7978,64818,106963,17896,47801,10723,114821,223295,74192,3293,3393,16987,74064,11277,91622,4270,29828,27951,387869,103235,1374,61988,120083,477,145892,128378,11779,211263,61354,18221,17869,46530,83061,108538,157981,90608,67199,95080,49064,195814,12302,66307,10348,231346,160732,112859,63633,146558,21271,31037,198802,47622,12862,95710,3910,77850,73961,85585,34752,61e3,4082,24595,103679,71107,8208,79568,150019,16615,24961,139857,32664,197366,4559,54735,32696,4126,162019,75698,13916,70108,159638,19834,9349,24675,175560,49643,18206,52459,27992,10809,88865,401975,133172,29e3,34558,30915,3658,25834,42430,36562,125265,18182,10155,40149,97082,208980,19575,60853,90529,66545,9600,789,46420,2317,88593,55595,98980,115302,5742,169155,1073,177901,3472,11189,63711,78643,65472,50459,127979,93,42202,67053,21720,157650,11145,141378,42033,22824,85705,79114,35584,15974,1510,54172,28562,12451,104226,19190,97151,73024,20948,5151,81741,21499,29006,84183,198074,54003,45120,170125,26240,35177,28389,64863,79974,60778,176915,232183,45342,2038,80253,41564,40703,32689,5430,100689,5366,23007,134279,14266,26712,73993,24934,64242,52113,102887,61801,46415,201049,54251,62133,122757,164883,30815,139966,2319,30842,766,13362,10287,134518,86111,81665,82440,28333,43019,18963,8804,161944,23439,102144,101145,80029,39052,248708,30350,117340,11878,128467,974,138625,63961,5237,74778,61834,67040,43814,13690,65947,33809,232476,115258,181745,28824,94013,9510,10246,93722,81976,7217,114383,3493,16014,69045,72692,12145,80981,9507,6692,1620,60820,330444,35474,33962,4797,7053,295463,46445,27026,12491,77988,49524,35675,90947,29114,166705,101385,133782,32704,6186,84595,176031,185623,45966,151302,63069,1699,107491,947,15458,74452,196212,6046,10498,12163,10239,35191,243951,9277,9090,29539,54460,22820,26514,112549,60372,51753,48756,21812,70861,260326,41,44222,10441,16961,48148,138771,216194,5914,52153,53400,212036,56519,26245,10117,45888,15294,138019,90913,26368,43842,42111,23348,6082,194845,161089,156206,51546,11647,30759,302912,262094,8635,78876,26535,35283,54183,31183,85484,147873,12989,5197,6356,72894,65347,20150,27370,73787,1493,45918,12366,190217,20724,13858,10981,67449,81213,7553,14115,72242,271517,11842,48310,88743,143726,22177,3290,243231,58452,62937,12592,1654,40066,33477,13751,9921,128442,15868,7106,75236,83773,10775,36938,10482,170465,17368,17469,161508,32752,98340,800,19824,264456,3901,87319,2867,26782,9630,113102,185815,24197,44584,86366,40224,3636,140916,31731,267731,9567,53678,72984,29389,27963,17106,50282,284911,60170,8322,12608,23374,89652,5268,39044,229766,8869,151350,31436,177342,12269,183212,120418,116270,2843,78888,69192,7865,184099,1086,129897,18383,70508,20242,18508,229924,124569,35749,50589,55626,9884,83115,40971,30671,18135,14452,38861,17844,201826,5549,26413,17189,13561,38539,10679,143331,3314,36785,171194,49685,187713,67506,4618,104039,17060,195080,50648,33159,19238,67559,134840,28599,157523,17130,38064,117398,94355,31918,13575,34538,40326,13997,3494,348283,62481,26862,3603,104426,244363,153709,112487,304612,199674,41239,35545,54869,293005,28223,26277,26899,4533,18518,15492,38587,80488,70485,160395,263,60162,11382,222152,4696,250751,51921,182609,10707,48463,46243,1227,49111,111564,46502,33342,56846,68541,63559,858,139927,16654,229375,76759,26478,33205,95828,23399,92945,2637,35630,28470,143992,50214,14174,21456,166191,65665,1711,21594,78019,97599,111701,36,147151,110246,189022,43021,30397,40757,131935,42065,73335,48039,26596,28984,15102,2361,7421,202167,69744,43766,52826,3642,83304,33873,75140,63169,192389,36551,92748,13039,123959,233220,21738,84447,77230,20228,187852,19095,25799,92136,108774,29237,53947,2299,118106,2687,8830,42331,202924,33667,2023,73763,30704,19363,19779,16737,35629,48081,24068,101013,162338,291912,13749,24745,328289,167679,70086,48299,23306,16732,17801,43322,54589,3586,63653,43624,53474,925,109177,251316,43805,13082,19511,86565,142182,92461,17117,101033,103319,64589,4022,4351,235897,5352,82705,107142,46391,156084,5860,61365,10558,13045,7717,18357,33922,12590,33065,6928,46993,783,46937,67846,8952,26295,6107,119656,18799,17458,50747,4229,179559,112727,118080,20683,41464,125468,51560,49749,44231,7359,35339,62988,136487,67015,5208,29150,24956,105186,48858,6143,18097,6972,16404,73489,58742,97196,36357,164616,5834,32267,13746,147733,15113,132091,34127,106298,39729,106426,22294,9780,15602,36213,71502,42808,66802,599,60755,5851,39120,67363,108623,126368,72770,91263,32486,30596,151717,7951,52002,43103,11768,68942,40901,39344,24037,127500,116890,48403,16926,86750,17745,48648,159545,34460,58419,5634,114317,67865,31462,23352,24010,98185,125708,69686,68337,13610,26271,70691,2980,4768,27225,102402,75453,28106,8104,6931,1176,6274,6475,112635,22498,6176,238686,26832,28893,90319,14441,15682,15087,39517,45270,109134,104440,45965,47645,81772,7876,52683,87720,12898,4505,185665,2769,113401,15664,57592,105229,137381,97059,119268,6876,43309,33886,128363,35476,144249,67013,143587,83367,25703,91436,59347,53236,2289,16519,19844,46309,58558,99834,23313,218816,231303,36388,51333,183535,109792,139277,54306,90139,18235,8275,32710,37677,82464,86025,92204,88842,117723,37570,128723,234242,76350,73795,34896,148247,58424,11105,11744,45746,63372,17118,49772,199520,81902,38004,22911,33752,3125,1995,53792,4689,26909,108150,146062,69674,41811,161444,84855,8999,28561,16731,93937,3189,21967,24890,22943,1356,145300,51569,28802,517,118679,31703,40607,48098,108854,25003,10233,73969,177495,5248,24516,215347,146192,48712,60626,69188,40735,5866,586,101541,6509,47590,52129,5969,222045,110933,25733,24223,65339,62812,2414,155418,35819,16022,78423,43138,20995,128255,240673,46745,236093,72176,57085,97841,61248,107,36068,193177,105427,55726,215229,20446,47228,100420,87091,14429,121708,23605,21157,187721,21880,2997,203976,99166,95068,25877,7724,98925,83401,4829,13182,18229,13718,239662,38653,116505,153497,30589,89029,38962,181302,43853,78872,180301,4786,248240,7401,106136,112590,77745,19731,60880,77789,125748,135487,5975,48627,34084,12419,215770,47557,254582,10364,106495,21856,67539,88981,38805,21428,48732,42316,12149,16078,52808,25327,51322,33850,51147,12253,122354,46077,56483,254553,115417,81834,150991,94662,86668,7381,12841,100650,18218,15741,22372,68294,50705,15535,84660,61887,22553,72299,31361,24824,17743,46820,64288,31582,77006,111674,116384,30760,80920,86149,77192,51979,79691,60342,122805,103800,240873,160744,233114,78962,54920,8608,3484,316104,72548,24337,5088,230040,21926,10172,36838,26,86221,83458,102176,12062,17571,41929,41170,28428,68239,41750,103930,2634,18313,53019,34825,97837,63115,24606,73157,152474,14715,91439,37033,109806,140259,30668,174760,380,135597,95673,136073,65073,134249,13829,17279,122305,4420,46444,10237,64848,203623,70728,10349,182885,65075,24519,25783,40318,34139,22222,63394,55266,102764,41422,20126,65100,90408,53640,35128,48932,11192,38935,96839,34782,39492,19396,41332,6250,5511,19492,51304,25936,104466,54099,73771,86115,5080,7669,30891,111700,13931,25276,72289,135447,14820,258641,25265,31005,281179,75286,393,95359,14623,13584,6680,101227,80173,44933,76666,54542,13244,39348,458,25379,109451,134348,81143,6959,65554,12027,51311,8716,57589,140731,28467,23316,17272,30458,25980,55229,77197,83798,28302,114784,7428,34548,26241,14712,39336,103304,18928,54080,12870,334,87722,15208,16895,142098,114262,39820,83913,57817,28682,7721,14900,108672,11250,62246,42849,415188,1724,26555,24549,25505,26443,107450,145899,61035,43528,6901,60726,65906,267741,21338,147590,42079,18924,73017,135236,15393,5206,4026,84185,1531,5988,113890,82647,303391,7386,69844,71611,189865,76523,31877,13315,19314,198575,32821,1928,67641,25913,104475,103489,3297,70391,18406,15446,113347,19295,93790,27856,1792,167471,116449,8541,4408,41757,63233,25765,86680,64501,27034,24816,34975,6079,4486,49693,36229,16917,21581,62426,27862,11612,54284,35702,194034,355,24277,48262,87411,70504,310164,118018,12516,47559,43502,57433,107139,9290,66533,80863,14634,34312,91725,28606,21342,67241,72355,43244,375789,37402,174015,105070,8342,44167,67494,1890,16365,11723,271002,1865,47918,8350,45564,27742,25110,125803,8553,49504,81925,62211,4534,15491,19011,80373,206920,667,102405,128623,245524,5553,113309,192739,65766,19567,22832,261958,29679,21293,71134,20962,105123,24721,860,21752,33448,18372,157167,94822,35770,173224,232737,75729,28937,46828,28062,25453,5207,140366,36665,30652,6169,67920,150458,92040,23186,184604,92330,20891,176492,49427,27828,38305,42495,143982,49560,25503,90043,29747,65328,47830,12932,11068,77721,9003,25213,94205,140426,46090,89945,138173,192691,33329,112232,129905,35709,27514,1841,19957,31411,127476,53572,17497,173549,55063,175135,19841,69314,5192,237921,117660,150697,4060,273045,50414,98940,65348,153665,164423,58804,156695,48994,213928,86036,28608,8355,39574,34540,16927,135680,18374,151587,10830,53805,16878,16623,4282,48030,8537,14986,46102,13062,72897,72,33050,108227,39451,45935,651,113320,40535,95176,57450,48843,5003,19019,10407,211163,3848,1068,4988,32091,30095,41692,15099,43602,107434,50744,7627,171349,16313,150832,352665,207750,33937,38256,51091,156e3,87889,90663,84175,24908,114900,50365,31494,83829,5398,169342,47521,54818,18935,8356,43094,41212,174536,10082,92550,6678,60614,23355,69721,14796,34149,128830,58187,3179,208,40325,28399,225029,401412,51150,31580,207268,6657,10993,69818,64282,289845,23308,12961,38447,6681,52944,31855,2572,47646,120728,179148,37240,45196,218274,4816,3695,21961,50084,35209,18073,51452,27004,6100,33941,1377,84831,171214,85,141510,9078,99227,32610,6417,11718,49868,65579,87902,73018,49062,46280,61742,21512,40862,107733,15941,29168,157765,144919,14487,5767,158014,140070,7241,573,71584,16921,223566,40331,179473,35081,47926,140885,41508,52104,59180,42310,32811,29048,123517,102413,80208,10104,14746,12649,153641,126022,37965,113017,4171,83,142592,2809,6362,50416,71323,116894,260776,16204,1524,5760,30351,12658,20703,54403,36083,45408,74772,4946,14485,50759,111222,10890,2195,167147,92962,130534,16283,177256,35016,15472,210156,151187,73922,117691,43250,52051,37392,24811,24358,30830,5775,818,21969,1476,127322,151783,58392,31021,106913,65215,89407,90802,28531,11690,20234,95249,44602,37256,18707,11928,5161,4410,26571,51903,49768,22008,25252,65780,209499,68769,203726,13249,137363,48845,86823,6658,5674,31881,1083,1823,108676,34518,166752,13791,14287,91576,91429,8665,11529,26401,16191,91972,30964,5254,28486,54697,79613,66520,18447,22870,45203,194466,22822,51703,12278,76716,44595,73455,33546,12235,144843,36154,51247,11116,33040,3180,225753,60864,1972,28469,12891,28879,10338,144157,56294,353058,38302,41447,87532,110616,27065,168438,6557,1213,50804,144643,24817,2390,136531,38174,247513,16190,4059,122791,131994,137430,39506,57650,16305,5188,54309,106128,20628,88071,67394,395446,250285,66176,91254,1399,114196,43915,60230,44853,27206,106353,43013,18733,345105,226453,51202,16607,57106,117175,35492,10476,89598,127439,15187,39624,13688,61570,10615,31111,59370,6238,175252,32143,224492,41388,95408,34384,148238,78307,38959,9340,160091,61443,15737,11216,41244,170,38299,102443,113097,26382,14027,33707,3957,76300,66160,19431,18900,6952,1717,108656,82206,188021,257335,27295,43999,41210,31777,46956,57457,12657,11489,15697,48060,204748,53583,82422,284790,30503,137341,8120,19615,220311,15991,10217,63424,9808,67431,70976,98221,4491,15177,28535,144789,751,13230,2394,1504,33977,132104,30316,22230,931,97193,185240,24826,22687,174322,15307,22988,1390,188745,180325,29580,59068,74903,18994,29195,79,15436,7622,38462,11566,138710,44828,45774,37768,99236,68137,84083,19282,22698,17134,74807,126662,173497,46248,16938,119735,3212,28292,213652,49013,9975,32180,45660,86250,4801,68788,95490,77482,113751,11994,44624,94452,46839,128497,100316,5798,58588,73184,202987,65417,37790,88524,1606,43156,97964,105717,34947,11203,100060,37742,130074,93653,107799,94311,196106,41347,8035,10780,16390,27883,118236,167395,1979,25006,19375,31628,18916,144723,78502,114047,103107,86492,107686,5844,20934,206963,23556,22591,16562,146333,20167,10471,117434,33085,2863,9740,36669,41849,37271,22790,18209,28979,8231,12952,54408,21731,25130,45208,55748,138120,75826,414,29593,9925,292865,25999,683,123149,7036,92159,86055,61827,103680,23176,54918,58466,57578,13305,5709,86479,16697,31064,17660,200919,10770,49793,33423,32370,52047,16488,62555,6459,8426,83493,7763,59725,82812,18628,67760,79405,68557,9612,7673,28102,56517,69620,171797,32458,29541,15870,81109,32080,207644,71495,21202,11039,91036,61230,2810,130800,32260,4613,60590,37112,75214,33979,126402,155062,30642,63875,12810,194463,82799,47664,16725,36685,43367,61099,449,172150,102867,21691,301838,36745,7130,18671,57316,34852,38034,54182,35578,65900,99486,19771,3456,2658,16914,99866,28390,28109,8262,21147,34353,20006,4228,137085,1675,203023,283196,198286,214375,163329,290603,152574,40471,83506,30068,14730,23177,131539,34759,27668,32178,71896,104799,116305,85430,119262,42860,25160,8911,23428,49437,105322,6519,16203,6349,74711,1230,38045,8540,75165,44736,25909,51026,317034,4984,32281,91312,27060,44431,17817,45363,155937,239085,35697,59784,91993,29531,126740,213757,76560,167776,285273,24262,8237,65030,41160,74437,48804,118916,13159,37842,1031,75349,1478,11655,108777,23435,277425,101734,67469,70231,124711,43532,28514,65526,54956,1e3,21882,17728,25302,40952,52214,149632,1999,2111,3259,63362,89961,220561,39777,26335,9063,10572,12416,34551,34623,38604,24723,5947,15588,69927,66252,119177,69173,46629,28714,70715,212408,20521,406913,74380,11716,50659,50862,37009,88460,130101,7210,53853,538,65120,151950,55806,163748,52837,13153,21100,16674,64536,6091,138201,44837,58547,3723,163,2177,32288,85454,34033,8497,14282,25742,10535,10741,79559,117493,243787,49337,100718,79495,40139,42956,7551,55433,15421,31509,23034,45081,547,61176,53434,328001,8470,36263,30145,4519,74173,53935,11845,73774,60211,78025,3,4102,73782,109293,315332,48412,26683,13714,6865,20128,18490,104141,325,39470,171970,115860,15707,7268,73301,74336,31370,2368,111827,107757,136231,142844,97138,96638,84053,38691,23801,1588,10573,122098,77039,240,186135,146101,11996,18143,112963,46171,155836,348769,47795,121213,116266,132515,3344,144804,31286,99187,255838,129694,35894,48779,55235,148582,71967,65282,15174,13920,47080,6147,108242,157593,125025,7136,1286,28957,127956,28402,98813,20805,7532,109417,40610,5041,32958,15142,18408,108596,33543,50517,27748,80114,233434,91447,487,37094,100048,30541,43477,10639,89862,155868,37667,8726,60684,237903,73408,99589,12190,38739,97348,3914,13594,2680,149016,13907,30171,28343,23530,115225,61104,35821,147679,14337,4297,244282,24085,326976,56428,7851,21303,131620,71446,83253,68692,111870,5224,15813,38197,49026,45057,13660,3306,76345,40671,27905,91072,996,68527,62085,91351,122634,55109,168209,2024,27560,112707,17352,8306,167115,169921,166958,5031,46020,11844,67284,19130,76185,6920,32849,5450,14610,22451,21002,17392,31872,66682,84796,13709,40210,59898,12029,8719,53564,21462,91884,21647,88379,194428,12754,37797,132826,160016,22567,54383,53186,77611,31107,8339,4694,19185,90355,23597,17222,140675,28442,23668,55977,9128,61555,28774,155229,17658,9390,24379,69357,15752,127381,239631,62460,93181,55913,45133,140155,18676,25249,33164,29581,82837,67223,22362,29975,7317,52813,1943,29613,20012,207130,49617,49651,5636,15334,36313,29226,28084,95247,72072,19e3,224932,15811,114,32127,38097,37508,88507,37225,27359,91626,12193,69279,20608,11055,88156,92808,2152,57259,55275,72789,24475,104414,1708,9882,3818,48661,66897,1631,34806,227930,85815,87753,18321,250664,72733,25107,206797,50891,8082,196411,92596,96764,152823,65514,22819,387277,62176,51225,40329,15563,189,3659,73670,64357,51793,275136,33482,86653,74615,67058,11318,125720,15388,22388,8267,1730,102663,170910,40784,7144,85373,13040,7088,94309,583,44224,140424,77439,18496,164026,36578,4722,9151,5824,63365,26510,35199,40500,79277,32495,44614,35233,9566,203293,152144,7097,2330,183480,98629,13423,330887,44130,68600,30939,97829,31012,345465,56747,94879,4939,160027,149761,99423,46099,32251,15332,8761,96094,128555,5763,235318,222223,55729,30241,55420,201746,3987,81382,8259,49325,23287,7719,24633,251100,92311,18591,110533,64759,170260,393860,7175,21144,132887,3593,75346,101277,91109,16387,259187,11627,57459,173829,44694,55780,49797,89192,120443,62622,3904,14814,23887,1027,112258,64955,99800,11132,66353,36202,48624,18158,88481,96882,43059,11040,2455,7077,21651,181159,99126,100434,61388,68186,19161,110468,120052,8819,55324,41494,7014,37689,3618,87729,92615,207943,9823,128657,12587,15857,6379,67628,51216,71775,157617,63244,1503,3864,218754,110864,5769,21492,7243,1192,87921,85529,31512,18537,42698,35350,73510,84474,34301,8991,21013,35034,566,38832,19838,35586,37216,39413,55006,12178,59742,856,84563,6900,25632,17437,49786,30723,13847,70845,4044,7843,23944,235976,55530,48942,6518,20939,73769,192653,52936,95207,23895,132542,142982,22632,87452,48042,54018,178468,10728,26230,23559,363,81269,142012,5718,346258,31456,84333,246476,51018,66692,101804,120570,39962,30373,70593,2864,60541,19425,54209,104092,7201,31545,48018,25865,15442,46257,40443,8328,6451,111782,47527,97754,33046,470,245116,31095,39,91934,87208,73470,36708,36521,12801,70624,36272,8892,79768,12427,55454,103756,5908,52390,62962,22720,141138,94634,41689,128402,126390,6628,106394,35527,134394,82727,254651,194502,148064,89549,3202,28359,957,21954,27906,49840,142747,8307,24206,48978,1186,71728,133038,71474,91306,6333,110959,74600,70387,18983,62609,56057,22970,1147,135850,1321,28834,3578,59715,102227,32827,81415,99952,55636,257598,390,22702,35701,85872,402916,39216,189795,14929,19467,10112,144422,61514,5279,63421,134686,41436,8424,51925,10598,132295,124416,4604,194739,210929,57866,31829,51626,50007,9976,91878,61906,56168,81906,60918,61859,40017,23059,16887,40927,62064,12785,32893,32913,21782,93965,20169,44387,79084,38463,11457,93950,27127,157050,2697,337088,5116,54128,48255,33279,8821,27352,25515,124022,65710,28906,38557,33390,1722,104435,72215,38551,12094,30978,25113,6671,37355,175109,42862,98024,65406,221276,59624,118012,64637,78760,86697,21426,1639,40350,12584,67193,84144,31396,7863,143011,69629,63112,9454,28666,65798,46372,134721,6314,51402,30837,151922,2847,38676,38008,92823,136245,17540,5504,109295,205242,37606,5211,214892,1586,20670,208711,137743,19328,40652,16995,20023,14657,154919,34422,12996,13918,38221,47690,16398,2959,37680,89122,6721,198469,91876,172043,83898,101992,26084,94570,3635,76958,22853,76497,38266,176590,168403,44464,142840,79180,184594,1984,41806,83147,11985,6546,366068,59732,24533,271505,8736,39084,222992,93429,28962,58985,86665,8432,30028,14548,32439,54424,165029,55175,27458,69046,121277,46168,33732,20661,24581,135574,123110,37556,79260,72611,16957,12939,46162,58238,44907,72936,253758,41324,32518,96480,11949,124438,65280,43256,34107,53533,43531,37037,28366,45970,32741,173438,6121,194202,62969,26355,30314,58370,28455,1848,50519,82830,90393,21761,295490,10936,256940,133568,44050,20269,4089,27457,21610,219460,36743,14821,101388,52005,13124,30979,140816,167362,26054,18458,60789,34917,40447,26606,33422,9066,3452,83614,5761,20263,137238,25038,91310,101,52322,74548,42572,38084,214054,186568,31802,17665,30620,141936,37730,14420,4265,187218,49640,188208,51441,55388,96452,66659,40869,42039,60967,221027,19234,178581,29105,96050,9165,196118,157335,3738,40354,117436,2965,34136,59659,15570,50843,230035,31444,71260,43886,18316,5387,38500,168508,17406,32174,8828,103373,143806,90367,3560,18719,122310,16508,26719,2541,105429,6645,37998,73190,10591,235916,49737,87112,233941,53188,32193,79154,4544,52905,126477,7580,63501,57314,3216,31337,6541,103083,60846,49,9756,15481,1355,43840,14319,13743,27486,10222,73114,230718,418644,16706,6674,279748,23058,45273,295831,86306,2743,5535,88773,21829,35253,120938,31153,3169,16839,42847,8751,80974,33942,36867,35514,16485,26474,77775,56877,5391,48346,3882,108713,31403,27804,55248,26235,43821,136104,40118,175507,28034,203908,18732,1788,34030,106427,36958,54359,7251,44936,15356,69139,455,157915,22173,140291,50348,43275,82066,49621,54952,15216,36226,96695,66855,6936,1987,8227,196087,4631,68827,99004,47541,110265,17953,147605,110242,58520,31312,38724,329975,642,3155,34497,75937,6207,73843,6120,17249,51429,117746,3218,910,68961,319671,14938,29555,34700,1649,66673,72268,9655,76800,153087,6941,210168,27130,35398,1780,73242,3135,56689,19556,165307,8765,35967,121458,13333,70453,17350,117253,22265,13340,44265,39869,441,3742,135025,23581,33309,16543,17731,13291,157637,283005,21408,101360,63887,52312,83873,5338,233779,23759,186949,34531,177320,38069,156465,91004,19353,59852,68160,14891,1338,1072,29823,1950,28901,81407,313445,73038,84807,162348,240257,37162,138934,16111,58013,41253,102951,16457,96056,19541,56402,67217,41638,94381,89674,29481,37456,80815,151579,13937,13683,132537,19699,134545,67020,29816,222341,141235,427578,48868,129557,233342,23077,87871,16213,18728,16184,9469,37913,19680,2798,171356,178328,13216,50049,72690,71904,124644,55455,7504,29052,41036,266546,19899,30391,188755,8659,59469,16,104298,112943,53865,76203,138226,68857,139953,14125,107625,119795,173133,4398,50273,48808,54390,16466,122086,31835,67035,50971,48859,7508,46427,66477,73021,84615,39985,83076,46779,201569,53336,36443,60865,168164,143810,51393,25548,169307,32896,24485,38424,21837,29087,275813,51674,6714,64883,46169,187369,55186,76192,12852,12018,62134,31067,118303,16542,12125,10579,4928,26291,43854,7091,10946,253716,109062,39283,17261,113012,258512,47764,125126,32646,55892,80279,201623,149872,3192,385,1208,48750,5376,58738,22335,5427,82416,47811,32435,143086,38930,94128,59975,156037,37977,38224,62485,7698,50405,71027,16462,21559,136153,34131,107506,162069,63703,3101,215029,40407,4178,3774,9187,80019,17880,97926,67579,2600,18405,8351,47924,86638,70820,92206,86453,29610,42241,119200,3198,15466,67813,57863,35454,4779,99518,4649,104641,144269,33730,38073,65864,6838,109456,193298,154007,5623,45741,30846,182578,25573,157224,1543,58575,138703,146140,44971,49356,18275,59064,20300,13122,11848,24453,11973,9797,86843,2919,25530,49210,1130,161220,76788,75373,85604,34926,36014,17777,17255,51533,11676,92226,51845,119859,21525,5936,18507,28050,1140,31418,14857,34207,47859,10750,36382,32079,106909,59426,87757,38393,110042,15965,97104,33757,35344,97993,53979,33651,45407,41884,82515,173089,7177,58371,35365,47543,51927,35587,10670,23544,29306,84233,39976,76076,62097,9007,8668,28119,78281,120790,19835,143020,54968,18670,64959,20649,34469,42570,33001,136570,87796,120044,1106,58700,63951,127623,12805,83057,40212,31773,49850,7361,54336,347524,101314,23751,19569,48791,29174,49369,20467,7465,75842,38281,623,112457,60210,28849,51003,94720,6426,90047,85560,43761,3579,85105,34607,90410,118528,7224,42907,111163,18168,6960,161135,191298,5247,100584,127552,171568,20121,91173,12636,54615,20199,63730,98105,2396,40387,14438,125012,4765,33235,12865,45299,37728,82098,77872,114037,59253,19675,24838,398016,102561,11446,17069,57508,178277,65836,99941,26114,2585,271882,136866,50126,11027,155648,118367,14585,8910,123015,335383,40434,41016,53021,14439,87098,176860,201543,121888,2358,9286,5739,22666,54270,37884,169381,33984,93859,16124,89364,72207,51639,76366,99029,65812,2198,12147,174891,194289,6986,30252,88822,21284,11445,288337,160821,33034,100869,43852,25761,52882,1144,103809,1924,84458,86079,43411,13542,139276,18141,34978,41298,7276,26481,173800,33210,17951,142652,33616,33677,2210,19941,98568,2486,192414,80136,12058,235883,50963,249638,29572,27221,47034,6124,72107,63346,97620,158513,299699,40388,23235,37176,224244,198386,121323,67992,23827,63170,17838,106622,158590,26807,5345,23489,91891,55474,74834,37981,13058,5977,72552,34706,26828,145172,19904,21367,34043,960,77092,91381,4733,47446,7680,41697,5170,16960,14741,46101,13656,473,51842,37433,11103,11551,121951,13191,97536,165932,50397,51628,129028,9069,44885,6590,59195,47045,32940,225472,90345,21833,13303,29407,96615,141951,5198,6028,18395,7181,3861,14966,156358,167182,36529,55253,25942,173153,30959,27261,50691,150176,162201,38467,48462,80602,42163,118482,168,108756,26011,17166,54149,456538,22512,91374,13816,90358,131615,18132,226707,1824,28139,26860,42253,93877,77351,65575,8980,80574,22020,27948,40422,91324,76376,13528,39281,91685,82215,122541,144066,1983,193851,17283,26320,2739,194978,4790,26845,42627,61300,65815,174612,55133,4200,191130,79771,158321,52280,166796,221620,62461,11278,4067,88152,83409,31717,121367,13522,47325,37945,10406,174348,249321,154101,64912,29938,51775,17220,15776,166138,78890,84425,54121,42861,16368,24572,291647,10197,32073,22651,11677,97509,26952,35787,18424,41910,71614,94977,72318,41594,70024,275419,37702,60199,7335,39107,61315,18271,18394,33768,87884,104277,123724,7277,56288,71981,189803,49320,3352,6798,14240,8954,69220,94433,57372,28620,68863,193727,85575,42309,41667,67689,42081,22543,44824,12719,28540,114236,101553,27638,27296,4300,5353,4663,19379,94098,3758,95888,95144,80344,87320,28447,259518,12718,71391,152731,37063,24132,31911,104896,15672,103782,1521,4945,72541,23717,122632,15619,87175,206120,29428,189780,61416,28350,44457,972,1175,47233,198738,95789,41907,21953,97034,59341,22864,53713,16873,32971,20693,20954,31336,21477,16169,38370,16412,9019,3841,24599,21938,17085,6484,81198,76413,5849,72514,12320,65247,276175,37234,59796,52642,16312,57349,198507,94148,46134,18958,125552,1747,18725,151873,14901,5490,68287,29470,3689,64794,40814,26018,25692,54450,2703,88278,124886,173087,174e3,24159,179477,24276,46004,201876,209202,445,52876,31948,30206,157610,39180,18439,44124,50469,5774,96278,222758,200216,50290,45486,20435,46986,46276,140133,142326,15569,13363,47522,92583,2182,7135,16853,22998,30272,4952,63263,35623,39096,53789,44864,20053,110392,124213,4630,16087,28221,127787,25839,77481,44693,13464,113146,6983,27069,55717,50102,4760,7107,26186,66507,59145,36032,104182,71328,29425,64317,50781,47465,94298,69706,74899,22754,120756,25108,93077,56834,73286,39928,16218,41699,176763,7555,70819,50083,26895,23315,26014,16773,123079,41712,5719,31516,90427,158540,85051,183128,40864,27505,55392,9058,45224,96857,30901,136622,96557,56304,120061,11501,151448,5773,89743,7769,86069,2935,18471,41628,10114,33660,110170,49479,26745,92846,33221,26731,18795,87076,8550,2100,29972,120289,3077,72490,33784,2630,208722,50861,63483,79029,6419,39467,14302,45286,64207,9686,67513,44170,1050,77246,59266,17055,53801,7150,11111,42432,4278,94579,362117,36175,42902,41933,39002,98489,22913,74161,84773,57036,17556,162288,74485,178760,93867,73635,128860,50362,261,67455,80001,46080,35662,4368,25247,19230,74393,22588,1822,27682,235324,13798,85998,13194,235067,23514,71669,147632,23191,134748,214683,105101,1518,25489,247114,7380,54842,26922,3971,26361,20844,68642,170517,77339,123255,8963,77818,150998,48466,36806,2732,23261,11741,236162,18243,126216,28690,50546,16385,92760,197383,246558,201295,88255,67588,71687,176076,172653,169058,33906,63747,24835,157621,43338,30050,46152,132741,2770,51371,94835,6614,15112,11749,56936,1250,19027,399017,58036,100215,23388,55815,308768,124152,94803,9521,64186,8971,28,30427,62163,7616,103838,35079,29203,131235,7743,17389,10882,37420,61460,228512,85363,41581,131077,62822,119647,10130,54445,26925,19968,29016,24446,74028,24176,61448,67185,9254,8563,119129,9771,99184,37716,39514,10532,221512,258753,218630,55980,23394,32141,61924,66749,32411,3741,36475,26678,77010,44946,91203,128749,116953,20476,49625,53116,13735,102335,29376,51946,83407,67892,59212,34685,21083,1546,112982,32972,74397,1078,190545,16082,86140,58591,89611,101531,10061,105104,76319,20035,17551,52611,169061,190842,100780,23907,90413,115619,9675,34710,193435,49443,129734,11183,258877,16318,136182,126808,44635,27304,192375,2599,125648,47051,12091,23814,721,58800,40137,66726,97930,60877,74487,7942,54326,9841,41428,13762,8211,85383,6950,99177,79806,201786,296464,124087,13144,29741,41721,47634,55088,254286,106408,17041,99064,12942,64086,45233,14005,2612,55827,255,7984,13980,38574,12776,46654,73499,249951,2101,26676,25996,132326,116415,119062,50449,31033,23038,11589,179252,20007,14860,129270,21143,17796,144715,60106,70758,69842,34674,282133,44014,16774,57268,38528,24053,46373,201667,28327,471023,51889,102667,21193,114909,84132,69317,96723,67969,16134,68145,15058,28765,32035,2524,101089,98664,25045,76571,14957,86040,118506,262428,154764,81573,39681,283900,73287,127825,544,80448,52347,38512,175971,15180,45467,33086,46552,48894,81107,43213,36672,54025,76703,8053,7608,13299,56619,20752,238099,54164,105133,1444,32942,953,37564,8e3,66316,119463,106817,404,13667,149108,128597,31267,10269,49836,106150,1484,52330,76965,160486,171648,38456,31263,22424,37738,66245,67467,143369,60471,75610,20895,115528,86070,60854,40796,49347,18989,15030,11371,37578,15779,79867,10187,86462,46402,155626,93200,40229,7090,57547,108053,99598,11088,47505,41218,206017,2173,20988,30219,22919,80563,57566,42369,93141,41675,2407,182519,120495,27154,16702,29456,14349,7958,16688,117177,140375,42467,261919,74916,153569,10836,34742,49526,7621,105997,12212,2270,392377,7755,17959,25086,232152,138791,33847,13860,35316,5811,1344,71259,50452,207539,92635,50359,5821,33674,30255,2086,2587,96264,17543,42,6029,9580,43007,139248,82831,12917,29607,25786,51467,42137,85161,100698,31561,88989,121990,278500,3602,109344,37982,15279,116442,28936,30880,87894,58079,128661,126731,67392,28051,146885,4861,16216,97344,42827,147561,153948,22684,21335,47685,1853,43349,15185,59642,10229,25520,187921,108972,5579,98037,24945,6697,19193,63734,137934,75056,89740,19767,224268,56138,63643,151661,39313,70618,84031,89723,84074,13703,85626,35460,8867,64845,3439,57906,99776,63968,49270,81130,34356,16210,23547,36446,34090,140028,72439,2221,22163,57058,363492,113754,18913,95451,48663,54464,54037,176097,68425,3023,34906,29482,117389,341780,80431,58330,16753,92616,60907,94846,147486,4498,48646,7773,46801,7778,18946,464978,47558,33223,177444,7328,15626,63337,94700,11743,9351,255024,39098,16447,42647,96230,39769,58840,10068,63439,35800,65843,58823,413844,9156,51258,7434,61791,85018,6872,3692,28096,7121,33024,6009,75532,31997,192535,9661,3304,9547,14753,31987,25314,55689,15896,20430,39472,31340,99744,25398,115569,54883,28719,205423,23071,57855,64638,149867,25671,82403,37616,20668,39989,77996,74948,140555,175248,64810,36515,46595,4958,248773,24045,28728,136673,168704,20804,114833,100325,27135,21205,96151,153134,45992,7093,13992,76047,1980,19432,145001,75159,87462,17710,1013,45556,34297,144882,20648,26061,11319,129567,108555,18872,464580,33386,22717,65948,167189,5603,135042,79542,8801,202632,18114,91882,5973,5239,67315,4431,60916,47819,71693,32597,32606,18183,45072,80329,76385,24749,51305,40314,156514,14693,130345,13168,66214,18029,12858,34801,27628,14544,10823,40522,40185,33739,148694,23548,9923,61012,28859,17933,19442,34364,99849,164107,141167,30629,21054,6744,36491,8096,42474,41706,155060,30650,10600,163442,1143,96655,61390,52359,7559,51568,64256,203854,4467,22453,14504,436398,7878,6980,8293,63610,293747,16167,35763,19627,147603,15419,18032,110744,51346,33681,54571,40472,48615,39073,21604,13754,173027,92560,11083,47299,63062,11813,52007,29883,9734,139722,15953,1550,20651,13616,49306,16113,90089,92326,7584,30712,72424,164858,6831,152871,55746,197721,34167,196442,6022,112107,55215,7538,123381,4920,43539,77165,8939,50392,34192,20225,79762,22505,58667,40770,29788,97180,82835,4568,8579,13273,363569,35898,49983,436,36598,3237,131691,62418,35591,8101,4073,379438,65218,76072,33887,2968,27573,212619,288680,68278,72851,150504,217896,6913,121339,22017,35340,51072,43616,75043,31437,10833,81487,4364,22968,41454,106687,85446,19863,109625,149241,524,141850,214404,54376,657,237023,9401,108137,53800,32474,49712,53334,126876,27337,45552,177696,8269,15036,12097,42240,2328,125374,119295,99715,2500,19624,39441,27220,102691,60957,94543,39101,18566,67362,13975,78230,25017,34017,239007,90027,39351,41681,35354,43822,1043,916,58587,141983,94818,38799,75459,41114,67432,16195,36606,59568,22272,126769,31424,68659,12287,134302,257977,5756,207285,95637,47248,117689,19583,77451,22373,12200,54993,117118,34244,29386,34562,53819,71267,64172,77665,49368,7716,59301,25749,45426,194789,17297,2650,1766,32501,45198,20403,20984,6600,14171,94604,19037,5402,29896,9938,59935,109708,88081,145182,44844,39167,352626,164173,35374,45982,6122,154,73419,220487,53834,53601,17992,8609,229321,5610,68098,66815,71012,95069,140968,27396,8957,134489,24656,86659,56598,134852,17316,123838,255436,6613,41610,138033,81452,32023,32396,123687,63398,8693,29712,30407,19296,121188,3551,36099,20032,111948,56624,16547,27453,35916,15378,52039,56849,13489,22214,73177,53097,277349,2157,14029,187886,10260,141743,246460,91880,50869,3788,49486,133566,54950,33120,129337,53768,18333,9525,26902,312251,10297,9020,70759,16647,112432,59260,84609,9818,82766,73569,468,46001,75780,55028,52106,11498,43645,108069,17150,17753,29417,16705,31799,9606,289,122254,115975,8620,6133,255357,56908,14456,133464,43554,79224,11247,29630,160,12756,25464,65960,350428,62521,321796,100359,67358,35169,46172,113128,48988,88868,31094,33266,6847,60887,98188,49659,69117,92977,220228,13947,80181,35103,62170,97351,13475,2440,199768,19498,36597,46971,25234,67806,62881,84717,73648,181966,10488,94149,21550,26655,63436,48375,14405,165650,9621,24439,28043,42735,4490,29963,56674,45373,1934,262446,50855,67098,26898,5261,52696,40644,33900,9440,180286,87162,22940,19704,26936,69769,10254,101759,27406,12243,48e3,73926,113215,54935,5726,192787,4312,106216,9366,11550,52949,23457,212271,277152,133895,108374,6191,96477,29980,218916,58024,54696,40853,91124,65894,91170,65908,252552,6793,29212,15389,44516,122515,52617,35058,9017,103536,39510,49136,19242,130652,662077,74699,47024,31422,8517,73351,24399,13867,128360,4810,4434,61779,111983,61036,17798,110240,59722,102960,39688,10001,23803,23039,176498,56659,44814,134295,17188,77577,74466,226175,102472,154333,63900,111747,18062,41171,79669,32773,408933,42562,28931,30907,107388,43487,2946,240310,23938,24354,319,184983,7927,6488,1422,10790,68809,68209,64775,4361,202,17123,59634,51200,44391,18188,17843,2619,74278,3230,9540,47187,21702,36274,56894,43907,16310,34790,16866,6150,5561,13587,107545,108873,126867,86986,28640,33427,19017,5762,80637,17430,46903,2047,131055,25958,13558,5444,47152,13900,44563,122857,45348,70863,39593,54332,38068,33637,318,40310,143467,18502,24520,11377,62013,28942,27246,28269,83545,17999,59015,90707,30065,15161,34720,1263,37008,2012,6060,98575,92933,5721,299,199555,24578,29223,2985,743,115825,109523,136657,47454,26378,53586,3733,174945,93340,244456,5693,37386,28782,89767,27545,23573,18798,136425,34320,84778,20041,48453,38215,7477,71958,40621,8773,5874,187927,105965,51100,43533,18083,8443,10180,43597,2003,183999,69689,12216,129696,146188,62389,34044,68410,12765,43273,26949,266807,3345,34477,79197,5688,47539,213110,21634,22257,50092,32222,42346,39530,63668,98,134978,74022,5152,59088,174145,37220,9934,9545,118937,5724,87240,19875,15784,40143,23263,87513,181654,285152,37881,263241,4966,43934,10433,186657,6470,74416,225854,25908,142677,246262,32280,6192,75890,45546,143264,135305,29742,47013,77787,11732,126658,8763,37950,21806,57557,113464,89465,108995,164574,23894,22996,23169,15369,23117,17642,130607,40503,36239,280990,44666,9981,40427,147487,26869,168452,32886,32991,46798,240839,15111,70502,65697,88548,44145,28701,48767,31139,206777,35659,181164,166262,14554,171445,31786,66523,76607,17956,6507,31279,90476,116611,167918,6560,1243,115324,80128,41867,55897,187323,37069,32596,189444,145931,13390,105530,65709,26805,6999,55714,41300,22915,68951,22138,21120,22264,10058,19945,33635,56123,99085,10032,5818,6016,46649,57476,35264,94413,112522,262288,93686,83038,14341,23204,28807,66084,77987,6101,126673,7133,38126,5923,122091,170240,97772,46874,215746,43948,41622,3272,55596,8332,146411,251315,13533,8561,81521,115449,48616,175175,2063,186556,3036,134537,75772,29728,82360,22973,186559,86348,89100,38388,82297,45610,2613,87082,9986,177812,57884,23591,47485,42543,33582,44713,74439,257444,252451,31825,35631,38540,33066,5147,13973,4343,51830,70378,22827,26448,95560,36896,241741,48067,203953,298860,61620,20450,3220,67272,6586,107662,100160,108684,6929,57226,4762,7457,1320,40404,77204,99309,62750,208653,59977,44e3,74315,34332,5819,172217,64904,114077,18147,84012,1791,98456,90930,21446,116669,103938,7422,85140,59713,5768,326211,16239,75411,13229,29398,10758,236107,1539,112472,95979,152154,151294,306,21196,38146,10700,6891,84282,109646,56492,40539,6589,119491,51354,30685,140209,136906,29622,73617,49553,70525,51671,166869,139616,74395,37439,49595,45678,11959,33211,86560,52434,9282,62690,112155,130810,5243,108261,99970,265613,72551,80049,6391,33365,90721,66737,69872,87011,1860,9032,112544,60905,37371,89015,140351,19076,850,373531,2802,36725,218795,72062,28990,16550,24614,7815,6187,26336,33373,32162,42791,73555,32062,23386,10244,56392,49442,27076,136262,12412,14883,1134,33675,97153,199281,15608,100152,74072,47942,254301,36451,16026,10687,65067,56708,254030,30290,50490,13864,57941,259331,35588,23485,43486,24869,21620,92971,22072,88645,1048,182050,13343,32452,14825,19509,3325,216938,45740,99716,189082,53740,78245,25609,24311,176777,47340,308354,40669,66085,14102,125339,9225,128709,97207,1271,200933,78439,113451,88975,18324,46521,11819,18570,141756,72512,170020,52754,63550,118515,103073,93330,32736,50499,14722,31600,68452,398867,29316,172786,18417,104924,2606,5670,84818,16288,67106,59580,82929,607401,291,85829,359,15897,35830,50696,65630,52672,22115,356968,29895,40837,231192,34024,38957,26722,406,23335,124952,72068,68804,13268,147101,164740,276569,162596,66943,11569,26654,66358,4777,23229,102127,5848,978,2921,59666,5371,28212,90108,42938,39320,2499,4271,108792,33510,125072,71653,65239,38250,66357,38577,13964,86251,35708,50755,36010,29448,12209,3844,38222,206337,100876,67827,137088,14167,252225,84163,195270,1306,5703,54198,779,46802,22028,51124,86759,70560,113164,35685,162145,45471,34561,422,2611,6464,47486,19223,38246,9191,18331,89942,243642,212364,15893,17518,22617,6409,30046,126182,59716,36560,104428,18846,26592,19458,50793,147333,30826,1388,27647,10922,14495,33545,19269,135828,39727,41601,46931,233379,49169,131130,182112,16276,82381,118209,142445,128310,19672,28740,82907,33436,3118,102206,28723,24819,41937,38854,5157,3881,111491,1142,9776,421673,152241,29309,14961,87854,6054,15424,3796,82656,54996,2108,55367,239450,154525,9643,118103,106041,64601,68549,48707,30266,25772,18740,9462,229669,91798,112152,191327,14493,72828,8175,66636,236474,25817,87351,129027,76653,20422,22983,71240,27846,44661,12399,46158,77704,53101,35032,11072,17300,109294,33638,24408,1895,11241,760,17584,82479,125877,63150,141075,34259,23274,81698,15732,43577,48340,91584,14688,16379,24481,150280,96420,262050,48635,43727,61819,56268,72003,88178,17281,79912,13218,122519,125295,166396,11811,2171,118930,67746,17636,178278,174656,95661,173039,83845,79689,17473,98555,127696,203415,54730,22925,232239,9309,12136,175026,20740,180188,10747,39816,314017,266131,10040,175732,112550,220651,31974,37393,888,23008,86799,4303,64905,148467,75337,251,3284,370102,50264,9835,5438,23655,4481,29851,329,12855,7162,64931,78141,12804,42372,296771,83547,18624,34874,86271,3360,48665,77735,88767,11463,63527,28889,22258,29140,194315,113924,25499,6406,31334,1845,4802,49184,43455,35469,127594,92970,61038,115005,38840,87761,106838,8811,20572,55637,11162,96721,132425,108925,2948,125457,36356,3502,75270,27622,127192,2561,123095,49394,61155,16897,110064,9699,89448,53356,19628,220310,21622,83036,9885,112214,6087,26713,17901,161912,91492,3440,68594,9266,92238,8087,6866,150194,72175,80701,13459,31836,43243,239700,95846,44749,50647,21945,230538,120612,132371,244604,5193,105637,34661,41341,68775,85393,1874,8771,33718,49672,77403,595452,99507,6490,58895,128742,7704,39239,73217,43816,62824,37804,199976,22361,80005,87514,94832,14089,4574,139975,59142,75523,100268,43906,53442,15152,2547,186002,17011,19513,204282,3343,60568,128318,119250,4298,51871,41336,71759,21921,45074,98169,145889,99427,11350,1237,5520,28799,7803,53702,21026,136352,38293,128690,12158,90132,44600,10184,26957,39459,126025,78904,82999,59373,39301,150198,120529,153042,20177,50089,14764,271571,30530,123161,38975,101562,22941,5648,124654,109243,69817,71675,49162,106884,21241,107795,30258,16572,188262,141456,7688,60718,8271,11044,32440,104608,103419,236109,93156,43293,128929,42107,67180,25201,115254,185488,130954,72813,167547,20537,39969,38432,22582,184022,1139,27199,5655,17767,97412,122606,209377,27070,35871,326617,188954,42680,73512,80911,22629,3011,95021,315242,157737,383,41821,41808,19335,27950,15674,25677,110950,35375,76835,59108,57370,35262,16569,160415,37706,78086,32041,49691,137143,9782,172080,50148,77917,6323,10110,69172,17711,21795,59511,76184,135114,31046,132319,59105,157578,20549,80778,57649,158421,65143,4575,72235,21899,10797,92745,34035,106079,80159,4508,78304,25350,75457,46458,32937,25623,47,8531,104751,84953,8138,36508,187199,66310,115274,13253,32461,38536,1916,42007,187160,35055,26325,84394,35963,94216,45590,97782],UD=function(){function e(t){(0,hi.Z)(this,e),(0,we.Z)(this,"log",void 0),(0,we.Z)(this,"peerRouting",void 0),(0,we.Z)(this,"routingTable",void 0),(0,we.Z)(this,"refreshInterval",void 0),(0,we.Z)(this,"refreshQueryTimeout",void 0),(0,we.Z)(this,"commonPrefixLengthRefreshedAt",void 0),(0,we.Z)(this,"refreshTimeoutId",void 0);var r=t.peerRouting,n=t.routingTable,i=t.refreshInterval,a=t.refreshQueryTimeout,s=t.lan;this.log=zi("libp2p:kad-dht:".concat(s?"lan":"wan",":routing-table:refresh")),this.peerRouting=r,this.routingTable=n,this.refreshInterval=null!==i&&void 0!==i?i:_A,this.refreshQueryTimeout=null!==a&&void 0!==a?a:wA,this.commonPrefixLengthRefreshedAt=[],this.refreshTable=this.refreshTable.bind(this)}return(0,fi.Z)(e,[{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.log("refreshing routing table every ".concat(this.refreshInterval,"ms")),this.refreshTable(!0);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null!=this.refreshTimeoutId&&clearTimeout(this.refreshTimeoutId);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"refreshTable",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.log("refreshing routing table");var r=this._maxCommonPrefix(),n=this._getTrackedCommonPrefixLengthsForRefresh(r);this.log("max common prefix length ".concat(r)),this.log("tracked CPLs [ ".concat(n.map((function(e){return e.toISOString()})).join(", ")," ]")),Promise.all(n.map(function(){var i=(0,ai.Z)((0,ii.Z)().mark((function i(a,s){var o,u;return(0,ii.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,e._refreshCommonPrefixLength(s,a,t);case 3:if(0!==e._numPeersForCpl(r)){i.next=18;break}o=Math.min(2*(s+1),n.length-1),u=s+1;case 6:if(!(u<o+1)){i.next=18;break}return i.prev=7,i.next=10,e._refreshCommonPrefixLength(u,a,t);case 10:i.next=15;break;case 12:i.prev=12,i.t0=i.catch(7),e.log.error(i.t0);case 15:u++,i.next=6;break;case 18:i.next=23;break;case 20:i.prev=20,i.t1=i.catch(0),e.log.error(i.t1);case 23:case"end":return i.stop()}}),i,null,[[0,20],[7,12]])})));return function(e,t){return i.apply(this,arguments)}}())).catch((function(t){e.log.error(t)})).then((function(){e.refreshTimeoutId=setTimeout(e.refreshTable,e.refreshInterval),null!=e.refreshTimeoutId.unref&&e.refreshTimeoutId.unref()})).catch((function(t){e.log.error(t)}))}},{key:"_refreshCommonPrefixLength",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n||!(r.getTime()>Date.now()-this.refreshInterval)){e.next=3;break}return this.log("not running refresh for cpl %s as time since last refresh not above interval",t),e.abrupt("return");case 3:return e.next=5,this._generateRandomPeerId(t);case 5:return i=e.sent,this.log("starting refreshing cpl %s with key %p (routing table size was %s)",t,i,this.routingTable.size),e.next=9,TD(this.peerRouting.getClosestPeers(i.toBytes(),{signal:AbortSignal.timeout(this.refreshQueryTimeout)}));case 9:a=e.sent,this.log("found ".concat(a," peers that were close to imaginary peer %p"),i),this.log("finished refreshing cpl %s with key %p (routing table size is now %s)",t,i,this.routingTable.size);case 12:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_getTrackedCommonPrefixLengthsForRefresh",value:function(e){e>15&&(e=15);for(var t=[],r=0;r<=e;r++){var n;t[r]=null!==(n=this.commonPrefixLengthRefreshedAt[r])&&void 0!==n?n:new Date}return t}},{key:"_generateRandomPeerId",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.routingTable.kb){e.next=2;break}throw new Error("Routing table not started");case 2:return r=hg(2),n=(r[1]<<8)+r[0],e.next=6,this._makePeerId(this.routingTable.kb.localNodeId,n,t);case 6:return i=e.sent,e.abrupt("return",tm(i));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_makePeerId",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a,s,o,u,c;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n>15)){e.next=2;break}throw new Error("Cannot generate peer ID for common prefix length greater than ".concat(15));case 2:return i=new DataView(t.buffer,t.byteOffset,t.byteLength),a=i.getUint16(0,!1),o=FD[(a^32768>>n)&(s=65535<<16-(n+1))|r&~s],u=new ArrayBuffer(34),(c=new DataView(u,0,u.byteLength)).setUint8(0,Ps.code),c.setUint8(1,32),c.setUint32(2,o,!1),e.abrupt("return",new Uint8Array(c.buffer,c.byteOffset,c.byteLength));case 14:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_maxCommonPrefix",value:function(){var e,t=0,r=(0,ge.Z)(this._prefixLengths());try{for(r.s();!(e=r.n()).done;){var n=e.value;n>t&&(t=n)}}catch(S$){r.e(S$)}finally{r.f()}return t}},{key:"_numPeersForCpl",value:function(e){var t,r=0,n=(0,ge.Z)(this._prefixLengths());try{for(n.s();!(t=n.n()).done;){t.value===e&&r++}}catch(S$){n.e(S$)}finally{n.f()}return r}},{key:"_prefixLengths",value:(0,ii.Z)().mark((function e(){var t,r,n,i,a,s,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.routingTable.kb){e.next=2;break}return e.abrupt("return");case 2:t=(0,ge.Z)(this.routingTable.kb.toIterable()),e.prev=3,t.s();case 5:if((r=t.n()).done){e.next=33;break}n=r.value.id,i=hD(this.routingTable.kb.localNodeId,n),a=0,s=(0,ge.Z)(i),e.prev=10,s.s();case 12:if((o=s.n()).done){e.next=21;break}if(0!==o.value){e.next=18;break}a++,e.next=19;break;case 18:return e.abrupt("break",21);case 19:e.next=12;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(10),s.e(e.t0);case 26:return e.prev=26,s.f(),e.finish(26);case 29:return e.next=31,a;case 31:e.next=5;break;case 33:e.next=38;break;case 35:e.prev=35,e.t1=e.catch(3),t.e(e.t1);case 38:return e.prev=38,t.f(),e.finish(38);case 41:case"end":return e.stop()}}),e,this,[[3,35,38,41],[10,23,26,29]])}))}]),e}(),zD=zi("libp2p:kad-dht:rpc:handlers:add-provider"),jD=function(){function e(t){(0,hi.Z)(this,e),(0,we.Z)(this,"providers",void 0);var r=t.providers;this.providers=r}return(0,fi.Z)(e,[{key:"handle",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(zD("start"),null!=r.key&&0!==r.key.length){e.next=3;break}throw new wo("Missing key","ERR_MISSING_KEY");case 3:e.prev=3,n=Ba.decode(r.key),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(3),new wo("Invalid CID","ERR_INVALID_CID");case 10:return null!=r.providerPeers&&0!==r.providerPeers.length||zD.error("no providers found in message"),e.next=13,Promise.all(r.providerPeers.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(r){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.id.equals(t)){e.next=3;break}return zD("invalid provider peer %p from %p",r.id,t),e.abrupt("return");case 3:if(!(r.multiaddrs.length<1)){e.next=6;break}return zD("no valid addresses for provider %p. Ignore",t),e.abrupt("return");case 6:return zD("received provider %p for %s (addrs %s)",t,n,r.multiaddrs.map((function(e){return e.toString()}))),e.next=9,i.providers.addProvider(n,r.id);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 13:return e.abrupt("return",void 0);case 14:case"end":return e.stop()}}),e,null,[[3,7]])})));return function(t,r){return e.apply(this,arguments)}}()}]),e}(),HD=zi("libp2p:kad-dht:rpc:handlers:find-node"),WD=function(){function e(t,r){(0,hi.Z)(this,e),(0,we.Z)(this,"peerRouting",void 0),(0,we.Z)(this,"lan",void 0),(0,we.Z)(this,"components",void 0);var n=r.peerRouting,i=r.lan;this.components=t,this.peerRouting=n,this.lan=Boolean(i)}return(0,fi.Z)(e,[{key:"handle",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(HD("incoming request from %p for peers closer to %b",t,r.key),n=[],!Ao(this.components.peerId.toBytes(),r.key)){e.next=6;break}n=[{id:this.components.peerId,multiaddrs:this.components.addressManager.getAddresses().map((function(e){return e.decapsulateCode(Gm("p2p").code)})),protocols:[]}],e.next=9;break;case 6:return e.next=8,this.peerRouting.getCloserPeersOffline(r.key,t);case 8:n=e.sent;case 9:return n=n.map(this.lan?XA:QA).filter((function(e){return e.multiaddrs.length})),i=new PA(r.type,new Uint8Array(0),r.clusterLevel),n.length>0?i.closerPeers=n:HD("could not find any peers closer to %b than %p",r.key,t),e.abrupt("return",i);case 13:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}(),qD=zi("libp2p:kad-dht:rpc:handlers:get-providers"),VD=function(){function e(t,r){(0,hi.Z)(this,e),(0,we.Z)(this,"components",void 0),(0,we.Z)(this,"peerRouting",void 0),(0,we.Z)(this,"providers",void 0),(0,we.Z)(this,"lan",void 0);var n=r.peerRouting,i=r.providers,a=r.lan;this.components=t,this.peerRouting=n,this.providers=i,this.lan=Boolean(a)}return(0,fi.Z)(e,[{key:"handle",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c,l;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=Ba.decode(r.key),e.next=7;break;case 4:throw e.prev=4,e.t0=e.catch(0),new wo("Invalid CID","ERR_INVALID_CID");case 7:return qD("%p asking for providers for %s",t,n),e.next=10,Promise.all([this.providers.getProviders(n),this.peerRouting.getCloserPeersOffline(r.key,t)]);case 10:return i=e.sent,a=(0,ke.Z)(i,2),s=a[0],o=a[1],e.next=16,this._getPeers(s);case 16:return u=e.sent,e.next=19,this._getPeers(o.map((function(e){return e.id})));case 19:return c=e.sent,l=new PA(r.type,r.key,r.clusterLevel),u.length>0&&(l.providerPeers=u),c.length>0&&(l.closerPeers=c),qD("got %s providers %s closerPeers",u.length,c.length),e.abrupt("return",l);case 25:case"end":return e.stop()}}),e,this,[[0,4]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_getAddresses",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[]);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getPeers",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],n=this.lan?XA:QA,i=(0,ge.Z)(t),e.prev=3,i.s();case 5:if((a=i.n()).done){e.next=21;break}return s=a.value,e.prev=7,e.next=10,this.components.peerStore.get(s);case 10:o=e.sent,u=n({id:s,multiaddrs:o.addresses.map((function(e){return e.multiaddr})),protocols:o.protocols}),u.multiaddrs.length>0&&r.push(u),e.next=19;break;case 15:if(e.prev=15,e.t0=e.catch(7),"ERR_NOT_FOUND"===e.t0.code){e.next=19;break}throw e.t0;case 19:e.next=5;break;case 21:e.next=26;break;case 23:e.prev=23,e.t1=e.catch(3),i.e(e.t1);case 26:return e.prev=26,i.f(),e.finish(26);case 29:return e.abrupt("return",r);case 30:case"end":return e.stop()}}),e,this,[[3,23,26,29],[7,15]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),KD=zi("libp2p:kad-dht:rpc:handlers:get-value"),YD=function(){function e(t,r){(0,hi.Z)(this,e),(0,we.Z)(this,"components",void 0),(0,we.Z)(this,"peerRouting",void 0);var n=r.peerRouting;this.components=t,this.peerRouting=n}return(0,fi.Z)(e,[{key:"handle",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c,l,h;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.key,KD("%p asked for key %b",t,n),null!=n&&0!==n.length){e.next=4;break}throw new wo("Invalid key","ERR_INVALID_KEY");case 4:if(i=new PA(TA.GET_VALUE,n,r.clusterLevel),!iD(n)){e.next=25;break}return KD("is public key"),a=aD(n),e.prev=8,e.next=11,this.components.peerStore.get(a);case 11:if(null!=(o=e.sent).id.publicKey){e.next=14;break}throw new wo("No public key found in key book","ERR_NOT_FOUND");case 14:s=o.id.publicKey,e.next=21;break;case 17:if(e.prev=17,e.t0=e.catch(8),"ERR_NOT_FOUND"===e.t0.code){e.next=21;break}throw e.t0;case 21:if(null==s){e.next=25;break}return KD("returning found public key"),i.record=new RA(n,s,new Date),e.abrupt("return",i);case 25:return e.next=27,Promise.all([this._checkLocalDatastore(n),this.peerRouting.getCloserPeersOffline(r.key,t)]);case 27:return u=e.sent,c=(0,ke.Z)(u,2),l=c[0],h=c[1],null!=l&&(KD("had record for %b in local datastore",n),i.record=l),h.length>0&&(KD("had %s closer peers in routing table",h.length),i.closerPeers=h),e.abrupt("return",i);case 34:case"end":return e.stop()}}),e,this,[[8,17]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_checkLocalDatastore",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return KD("checkLocalDatastore looking for %b",t),r=rD(t),e.prev=2,e.next=5,this.components.datastore.get(r);case 5:n=e.sent,e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(2),"ERR_NOT_FOUND"!==e.t0.code){e.next=12;break}return e.abrupt("return",void 0);case 12:throw e.t0;case 13:if(null!=(i=RA.deserialize(n))){e.next=16;break}throw new wo("Invalid record","ERR_INVALID_RECORD");case 16:if(!(null==i.timeReceived||Date.now()-i.timeReceived.getTime()>1296e5)){e.next=20;break}return e.next=19,this.components.datastore.delete(r);case 19:return e.abrupt("return",void 0);case 20:return e.abrupt("return",i);case 21:case"end":return e.stop()}}),e,this,[[2,8]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),GD=zi("libp2p:kad-dht:rpc:handlers:ping"),QD=function(){function e(){(0,hi.Z)(this,e)}return(0,fi.Z)(e,[{key:"handle",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return GD("ping from %p",t),e.abrupt("return",r);case 2:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}(),XD=function(){function e(t,r){(0,hi.Z)(this,e),(0,we.Z)(this,"log",void 0),(0,we.Z)(this,"components",void 0),(0,we.Z)(this,"validators",void 0);var n=r.validators;this.components=t,this.log=zi("libp2p:kad-dht:rpc:handlers:put-value"),this.validators=n}return(0,fi.Z)(e,[{key:"handle",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.key,this.log("%p asked us to store value for key %b",t,n),null!=(i=r.record)){e.next=7;break}throw a="Empty record from: ".concat(t.toString()),this.log.error(a),new wo(a,"ERR_EMPTY_RECORD");case 7:return e.prev=7,e.next=10,qA(this.validators,i);case 10:return i.timeReceived=new Date,s=rD(i.key),e.next=14,this.components.datastore.put(s,i.serialize().subarray());case 14:this.log("put record for %b into datastore under key %k",n,s),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(7),this.log("did not put record for key %b into datastore %o",n,e.t0);case 20:return e.abrupt("return",r);case 21:case"end":return e.stop()}}),e,this,[[7,17]])})));return function(t,r){return e.apply(this,arguments)}}()}]),e}(),JD=function(){function e(t,r){var n;(0,hi.Z)(this,e),(0,we.Z)(this,"handlers",void 0),(0,we.Z)(this,"routingTable",void 0),(0,we.Z)(this,"log",void 0);var i=r.providers,a=r.peerRouting,s=r.validators,o=r.lan;this.log=zi("libp2p:kad-dht:rpc"),this.routingTable=r.routingTable,this.handlers=(n={},(0,we.Z)(n,TA.GET_VALUE,new YD(t,{peerRouting:a})),(0,we.Z)(n,TA.PUT_VALUE,new XD(t,{validators:s})),(0,we.Z)(n,TA.FIND_NODE,new WD(t,{peerRouting:a,lan:o})),(0,we.Z)(n,TA.ADD_PROVIDER,new jD({providers:i})),(0,we.Z)(n,TA.GET_PROVIDERS,new VD(t,{peerRouting:a,providers:i,lan:o})),(0,we.Z)(n,TA.PING,new QD),n)}return(0,fi.Z)(e,[{key:"handleMessage",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.routingTable.add(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),this.log.error("Failed to update the kbucket store",e.t0);case 8:if(null!=(n=this.handlers[r.type])){e.next=12;break}return this.log.error("no handler found for message type: ".concat(r.type)),e.abrupt("return");case 12:return e.abrupt("return",n.handle(t,r));case 13:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"onIncomingStream",value:function(e){var t=this;Promise.resolve().then((0,ai.Z)((0,ii.Z)().mark((function r(){var n,i,a,s;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.stream,i=e.connection,a=i.remotePeer,r.prev=2,r.next=5,t.routingTable.add(a);case 5:r.next=10;break;case 7:r.prev=7,r.t0=r.catch(2),t.log.error(r.t0);case 10:return s=t,r.next=13,no(n,(function(e){return Bu(e)}),function(){var e=ea((0,ii.Z)().mark((function e(t){var r,n,i,o,u,c,l,h;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!1,n=!1,e.prev=2,o=ui(t);case 4:return e.next=6,Ji(o.next());case 6:if(!(r=!(u=e.sent).done)){e.next=19;break}return c=u.value,l=PA.deserialize(c),s.log("incoming %s from %p",l.type,a),e.next=12,Ji(s.handleMessage(a,l));case 12:if(null==(h=e.sent)){e.next=16;break}return e.next=16,h.serialize();case 16:r=!1,e.next=4;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(2),n=!0,i=e.t0;case 25:if(e.prev=25,e.prev=26,!r||null==o.return){e.next=30;break}return e.next=30,Ji(o.return());case 30:if(e.prev=30,!n){e.next=33;break}throw i;case 33:return e.finish(30);case 34:return e.finish(25);case 35:case"end":return e.stop()}}),e,null,[[2,21,25,35],[26,,30,34]])})));return function(t){return e.apply(this,arguments)}}(),(function(e){return Zu(e)}),n);case 13:case"end":return r.stop()}}),r,null,[[2,7]])})))).catch((function(e){t.log.error(e)}))}}]),e}(),$D=function(e){ia(r,e);var t=ua(r);function r(e,n){var i;(0,hi.Z)(this,r),i=t.call(this),(0,we.Z)(ra(i),"log",void 0),(0,we.Z)(ra(i),"components",void 0),(0,we.Z)(ra(i),"protocol",void 0),(0,we.Z)(ra(i),"running",void 0),(0,we.Z)(ra(i),"registrarId",void 0);var a=n.protocol,s=n.lan;return i.components=e,i.log=zi("libp2p:kad-dht:topology-listener:".concat(s?"lan":"wan")),i.running=!1,i.protocol=a,i}return(0,fi.Z)(r,[{key:"isStarted",value:function(){return this.running}},{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.running){e.next=2;break}return e.abrupt("return");case 2:return this.running=!0,e.next=5,this.components.registrar.register(this.protocol,{onConnect:function(e){t.log("observed peer %p with protocol %s",e,t.protocol),t.dispatchEvent(new By("peer",{detail:e}))}});case 5:this.registrarId=e.sent;case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.running=!1,null!=this.registrarId&&(this.components.registrar.unregister(this.registrarId),this.registrarId=void 0);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),r}(Ly),eR=function(e){ia(r,e);var t=ua(r);function r(e,n){var i;(0,hi.Z)(this,r),i=t.call(this),(0,we.Z)(ra(i),"protocol",void 0),(0,we.Z)(ra(i),"routingTable",void 0),(0,we.Z)(ra(i),"providers",void 0),(0,we.Z)(ra(i),"network",void 0),(0,we.Z)(ra(i),"peerRouting",void 0),(0,we.Z)(ra(i),"components",void 0),(0,we.Z)(ra(i),"log",void 0),(0,we.Z)(ra(i),"running",void 0),(0,we.Z)(ra(i),"kBucketSize",void 0),(0,we.Z)(ra(i),"clientMode",void 0),(0,we.Z)(ra(i),"lan",void 0),(0,we.Z)(ra(i),"validators",void 0),(0,we.Z)(ra(i),"selectors",void 0),(0,we.Z)(ra(i),"queryManager",void 0),(0,we.Z)(ra(i),"contentFetching",void 0),(0,we.Z)(ra(i),"contentRouting",void 0),(0,we.Z)(ra(i),"routingTableRefresh",void 0),(0,we.Z)(ra(i),"rpc",void 0),(0,we.Z)(ra(i),"topologyListener",void 0),(0,we.Z)(ra(i),"querySelf",void 0),(0,we.Z)(ra(i),"maxInboundStreams",void 0),(0,we.Z)(ra(i),"maxOutboundStreams",void 0);var a=n.kBucketSize,s=n.clientMode,o=n.validators,u=n.selectors,c=n.querySelfInterval,l=n.lan,h=n.protocolPrefix,f=n.pingTimeout,d=n.pingConcurrency,p=n.maxInboundStreams,v=n.maxOutboundStreams,g=n.providers;i.running=!1,i.components=e,i.lan=Boolean(l),i.log=zi("libp2p:kad-dht:".concat(!0===l?"lan":"wan")),i.protocol="".concat(null!==h&&void 0!==h?h:"/ipfs").concat(!0===l?"/lan":"").concat("/kad/1.0.0"),i.kBucketSize=null!==a&&void 0!==a?a:20,i.clientMode=null===s||void 0===s||s,i.maxInboundStreams=null!==p&&void 0!==p?p:32,i.maxOutboundStreams=null!==v&&void 0!==v?v:64,i.routingTable=new ND(e,{kBucketSize:a,lan:i.lan,pingTimeout:f,pingConcurrency:d,protocol:i.protocol}),i.providers=new gD(e,null!==g&&void 0!==g?g:{}),i.validators=(0,_e.Z)((0,_e.Z)({},YA),o),i.selectors=(0,_e.Z)((0,_e.Z)({},WA),u),i.network=new cD(e,{protocol:i.protocol,lan:i.lan});var y=ts();return!0===n.allowQueryWithZeroPeers&&y.resolve(),i.queryManager=new RD(e,{disjointPaths:Math.ceil(i.kBucketSize/2),lan:l,initialQuerySelfHasRun:y,routingTable:i.routingTable}),i.peerRouting=new dD(e,{routingTable:i.routingTable,network:i.network,validators:i.validators,queryManager:i.queryManager,lan:i.lan}),i.contentFetching=new oD(e,{validators:i.validators,selectors:i.selectors,peerRouting:i.peerRouting,queryManager:i.queryManager,network:i.network,lan:i.lan}),i.contentRouting=new uD(e,{network:i.network,peerRouting:i.peerRouting,queryManager:i.queryManager,routingTable:i.routingTable,providers:i.providers,lan:i.lan}),i.routingTableRefresh=new UD({peerRouting:i.peerRouting,routingTable:i.routingTable,lan:i.lan}),i.rpc=new JD(e,{routingTable:i.routingTable,providers:i.providers,peerRouting:i.peerRouting,validators:i.validators,lan:i.lan}),i.topologyListener=new $D(e,{protocol:i.protocol,lan:i.lan}),i.querySelf=new PD(e,{peerRouting:i.peerRouting,interval:c,initialInterval:n.initialQuerySelfInterval,lan:i.lan,initialQuerySelfHasRun:y,routingTable:i.routingTable}),i.network.addEventListener("peer",(function(e){var t=e.detail;i.onPeerConnect(t).catch((function(e){i.log.error("could not add %p to routing table",t.id,e)})),i.dispatchEvent(new By("peer",{detail:t}))})),i.topologyListener.addEventListener("peer",(function(e){var t=e.detail;Promise.resolve().then((0,ai.Z)((0,ii.Z)().mark((function e(){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.components.peerStore.get(t);case 2:return r=e.sent,n={id:t,multiaddrs:r.addresses.map((function(e){return e.multiaddr})),protocols:r.protocols},e.next=6,i.onPeerConnect(n);case 6:case"end":return e.stop()}}),e)})))).catch((function(e){i.log.error("could not add %p to routing table",t,e)}))})),i}return(0,fi.Z)(r,[{key:"onPeerConnect",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.log("peer %p connected with protocols",t.id,t.protocols),0!==(t=this.lan?XA(t):QA(t)).multiaddrs.length){e.next=5;break}return this.log("ignoring %p as they do not have any %s addresses in %s",t.id,this.lan?"private":"public",t.multiaddrs.map((function(e){return e.toString()}))),e.abrupt("return");case 5:return e.prev=5,e.next=8,this.routingTable.add(t.id);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5),this.log.error("could not add %p to routing table",t.id,e.t0);case 13:case"end":return e.stop()}}),e,this,[[5,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"isStarted",value:function(){return this.running}},{key:"getMode",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.clientMode?"client":"server");case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setMode",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.components.registrar.unhandle(this.protocol);case 2:if("client"!==t){e.next=7;break}this.log("enabling client mode"),this.clientMode=!0,e.next=11;break;case 7:return this.log("enabling server mode"),this.clientMode=!1,e.next=11,this.components.registrar.handle(this.protocol,this.rpc.onIncomingStream.bind(this.rpc),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams});case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.running=!0,e.next=3,this.setMode(this.clientMode?"client":"server");case 3:return e.next=5,Promise.all([this.providers.start(),this.queryManager.start(),this.network.start(),this.routingTable.start(),this.topologyListener.start()]);case 5:return this.querySelf.start(),e.next=8,this.routingTableRefresh.start();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.running=!1,this.querySelf.stop(),e.next=4,Promise.all([this.providers.stop(),this.queryManager.stop(),this.network.stop(),this.routingTable.stop(),this.routingTableRefresh.stop(),this.topologyListener.stop()]);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"put",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ea((0,ii.Z)().mark((function i(){return(0,ii.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.delegateYield(Xa(ui(r.contentFetching.put(e,t,n))),"t0",1);case 1:case"end":return i.stop()}}),i)})))()}},{key:"get",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.delegateYield(Xa(ui(t.contentFetching.get(e,r))),"t0",1);case 1:case"end":return n.stop()}}),n)})))()}},{key:"provide",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.delegateYield(Xa(ui(t.contentRouting.provide(e,t.components.addressManager.getAddresses(),r))),"t0",1);case 1:case"end":return n.stop()}}),n)})))()}},{key:"findProviders",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.delegateYield(Xa(ui(t.contentRouting.findProviders(e,r))),"t0",1);case 1:case"end":return n.stop()}}),n)})))()}},{key:"findPeer",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.delegateYield(Xa(ui(t.peerRouting.findPeer(e,r))),"t0",1);case 1:case"end":return n.stop()}}),n)})))()}},{key:"getClosestPeers",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.delegateYield(Xa(ui(t.peerRouting.getClosestPeers(e,r))),"t0",1);case 1:case"end":return n.stop()}}),n)})))()}},{key:"refreshRoutingTable",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.routingTableRefresh.refreshTable(!0);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),r}(Ly),tR=zi("libp2p:kad-dht"),rR=function(){function e(t){(0,hi.Z)(this,e),(0,we.Z)(this,"dht",void 0),this.dht=t}return(0,fi.Z)(e,[{key:"provide",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:{},e.next=3,Qs(this.dht.provide(t,r));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"findProviders",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){var i,a,s,o,u,c;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=!1,a=!1,n.prev=2,o=ui(t.dht.findProviders(e,r));case 4:return n.next=6,Ji(o.next());case 6:if(!(i=!(u=n.sent).done)){n.next=13;break}if("PROVIDER"!==(c=u.value).name){n.next=10;break}return n.delegateYield(Xa(ui(c.providers)),"t0",10);case 10:i=!1,n.next=4;break;case 13:n.next=19;break;case 15:n.prev=15,n.t1=n.catch(2),a=!0,s=n.t1;case 19:if(n.prev=19,n.prev=20,!i||null==o.return){n.next=24;break}return n.next=24,Ji(o.return());case 24:if(n.prev=24,!a){n.next=27;break}throw s;case 27:return n.finish(24);case 28:return n.finish(19);case 29:case"end":return n.stop()}}),n,null,[[2,15,19,29],[20,,24,28]])})))()}},{key:"put",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qs(this.dht.put(t,r,n));case 2:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!1,i=!1,e.prev=2,s=ui(this.dht.get(t,r));case 4:return e.next=6,s.next();case 6:if(!(n=!(o=e.sent).done)){e.next=13;break}if("VALUE"!==(u=o.value).name){e.next=10;break}return e.abrupt("return",u.value);case 10:n=!1,e.next=4;break;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),i=!0,a=e.t0;case 19:if(e.prev=19,e.prev=20,!n||null==s.return){e.next=24;break}return e.next=24,s.return();case 24:if(e.prev=24,!i){e.next=27;break}throw a;case 27:return e.finish(24);case 28:return e.finish(19);case 29:throw new wo("Not found","ERR_NOT_FOUND");case 30:case"end":return e.stop()}}),e,this,[[2,15,19,29],[20,,24,28]])})));return function(t,r){return e.apply(this,arguments)}}()}]),e}(),nR=function(){function e(t){(0,hi.Z)(this,e),(0,we.Z)(this,"dht",void 0),this.dht=t}return(0,fi.Z)(e,[{key:"findPeer",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=c.length>1&&void 0!==c[1]?c[1]:{},n=!1,i=!1,e.prev=3,s=ui(this.dht.findPeer(t,r));case 5:return e.next=7,s.next();case 7:if(!(n=!(o=e.sent).done)){e.next=14;break}if("FINAL_PEER"!==(u=o.value).name){e.next=11;break}return e.abrupt("return",u.peer);case 11:n=!1,e.next=5;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(3),i=!0,a=e.t0;case 20:if(e.prev=20,e.prev=21,!n||null==s.return){e.next=25;break}return e.next=25,s.return();case 25:if(e.prev=25,!i){e.next=28;break}throw a;case 28:return e.finish(25);case 29:return e.finish(20);case 30:throw new wo("Not found","ERR_NOT_FOUND");case 31:case"end":return e.stop()}}),e,this,[[3,16,20,30],[21,,25,29]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getClosestPeers",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){var i,a,s,o,u,c;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=!1,a=!1,n.prev=2,o=ui(t.dht.getClosestPeers(e,r));case 4:return n.next=6,Ji(o.next());case 6:if(!(i=!(u=n.sent).done)){n.next=14;break}if("FINAL_PEER"!==(c=u.value).name){n.next=11;break}return n.next=11,c.peer;case 11:i=!1,n.next=4;break;case 14:n.next=20;break;case 16:n.prev=16,n.t0=n.catch(2),a=!0,s=n.t0;case 20:if(n.prev=20,n.prev=21,!i||null==o.return){n.next=25;break}return n.next=25,Ji(o.return());case 25:if(n.prev=25,!a){n.next=28;break}throw s;case 28:return n.finish(25);case 29:return n.finish(20);case 30:case"end":return n.stop()}}),n,null,[[2,16,20,30],[21,,25,29]])})))()}}]),e}();BD=Symbol.toStringTag;var iR,aR,sR,oR=function(e){ia(r,e);var t=ua(r);function r(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,hi.Z)(this,r),n=t.call(this),(0,we.Z)(ra(n),"wan",void 0),(0,we.Z)(ra(n),"lan",void 0),(0,we.Z)(ra(n),"components",void 0),(0,we.Z)(ra(n),"contentRouting",void 0),(0,we.Z)(ra(n),"peerRouting",void 0),(0,we.Z)(ra(n),BD,"@libp2p/dual-kad-dht"),n.components=e,n.wan=new eR(e,(0,_e.Z)((0,_e.Z)({protocolPrefix:"/ipfs"},i),{},{lan:!1})),n.lan=new eR(e,(0,_e.Z)((0,_e.Z)({protocolPrefix:"/ipfs"},i),{},{clientMode:!1,lan:!0})),n.contentRouting=new rR(ra(n)),n.peerRouting=new nR(ra(n)),n.wan.addEventListener("peer",(function(e){n.dispatchEvent(new By("peer",{detail:e.detail}))})),n.lan.addEventListener("peer",(function(e){n.dispatchEvent(new By("peer",{detail:e.detail}))})),null==i.clientMode&&e.events.addEventListener("self:peer:update",(function(e){tR("received update of self-peer info");var t=e.detail.peer.addresses.some((function(e){var t=e.multiaddr,r=function(e){var t,r=e.stringTuples(),n=(0,ge.Z)(r);try{for(n.s();!(t=n.n()).done;)if(290===t.value[0])return!1}catch(S$){n.e(S$)}finally{n.f()}if(54===r[0][0]||55===r[0][0]||56===r[0][0])return tR("%m is public %s",e,!0),!0;if(4===r[0][0]||41===r[0][0]){var i=S_("".concat(r[0][1])),a=null==i||!i;return tR("%m is public %s",e,a),a}return!1}(t);return tR("%m is public %s",t,r),r}));n.getMode().then(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(r){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||"client"!==r){e.next=5;break}return e.next=3,n.setMode("server");case 3:e.next=8;break;case 5:if("server"!==r||t){e.next=8;break}return e.next=8,n.setMode("client");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){tR.error("error setting dht server mode",e)}))})),n}return(0,fi.Z)(r,[{key:Iy,get:function(){return this.contentRouting}},{key:Ny,get:function(){return this.peerRouting}},{key:Oy,get:function(){return this}},{key:"isStarted",value:function(){return this.wan.isStarted()&&this.lan.isStarted()}},{key:"getMode",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.wan.getMode());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setMode",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.wan.setMode(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.lan.start(),this.wan.start()]);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.lan.stop(),this.wan.stop()]);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"put",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ea((0,ii.Z)().mark((function i(){var a,s,o,u,c,l;return(0,ii.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:a=!1,s=!1,i.prev=2,u=ui(os(r.lan.put(e,t,n),r.wan.put(e,t,n)));case 4:return i.next=6,Ji(u.next());case 6:if(!(a=!(c=i.sent).done)){i.next=13;break}return l=c.value,i.next=10,l;case 10:a=!1,i.next=4;break;case 13:i.next=19;break;case 15:i.prev=15,i.t0=i.catch(2),s=!0,o=i.t0;case 19:if(i.prev=19,i.prev=20,!a||null==u.return){i.next=24;break}return i.next=24,Ji(u.return());case 24:if(i.prev=24,!s){i.next=27;break}throw o;case 27:return i.finish(24);case 28:return i.finish(19);case 29:case"end":return i.stop()}}),i,null,[[2,15,19,29],[20,,24,28]])})))()}},{key:"get",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l,h;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=!1,a=!1,s=!1,o=!1,n.prev=4,c=ui(os(t.lan.get(e,r),t.wan.get(e,r)));case 6:return n.next=8,Ji(c.next());case 8:if(!(s=!(l=n.sent).done)){n.next=18;break}return h=l.value,n.next=12,h;case 12:"DIAL_PEER"===h.name&&(i=!0),"VALUE"===h.name&&(i=!0,null!=h.value&&(a=!0)),"SEND_QUERY"===h.name&&(i=!0);case 15:s=!1,n.next=6;break;case 18:n.next=24;break;case 20:n.prev=20,n.t0=n.catch(4),o=!0,u=n.t0;case 24:if(n.prev=24,n.prev=25,!s||null==c.return){n.next=29;break}return n.next=29,Ji(c.return());case 29:if(n.prev=29,!o){n.next=32;break}throw u;case 32:return n.finish(29);case 33:return n.finish(24);case 34:if(i){n.next=36;break}throw new wo("No peers found in routing table!","ERR_NO_PEERS_IN_ROUTING_TABLE");case 36:if(a){n.next=39;break}return n.next=39,FA({from:t.components.peerId,error:new wo("Not found","ERR_NOT_FOUND")},r);case 39:case"end":return n.stop()}}),n,null,[[4,20,24,34],[25,,29,33]])})))()}},{key:"provide",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l,h,f,d;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=0,a=0,s=[],o=[t.lan],n.next=6,Ji(t.wan.getMode());case 6:if(n.t0=n.sent,"server"!==n.t0){n.next=9;break}o.push(t.wan);case 9:u=!1,c=!1,n.prev=11,h=ui(os.apply(void 0,be(o.map((function(t){return t.provide(e,r)})))));case 13:return n.next=15,Ji(h.next());case 15:if(!(u=!(f=n.sent).done)){n.next=25;break}return d=f.value,n.next=19,d;case 19:"SEND_QUERY"===d.name&&i++,"QUERY_ERROR"===d.name&&s.push(d.error),"PEER_RESPONSE"===d.name&&"ADD_PROVIDER"===d.messageName&&(tR("sent provider record for %s to %p",e,d.from),a++);case 22:u=!1,n.next=13;break;case 25:n.next=31;break;case 27:n.prev=27,n.t1=n.catch(11),c=!0,l=n.t1;case 31:if(n.prev=31,n.prev=32,!u||null==h.return){n.next=36;break}return n.next=36,Ji(h.return());case 36:if(n.prev=36,!c){n.next=39;break}throw l;case 39:return n.finish(36);case 40:return n.finish(31);case 41:if(0!==a){n.next=45;break}if(!(s.length>0)){n.next=44;break}throw new wo("Failed to provide to ".concat(s.length," of ").concat(i," peers"),"ERR_PROVIDES_FAILED",{errors:s});case 44:throw new wo("Failed to provide - no peers found","ERR_PROVIDES_FAILED");case 45:case"end":return n.stop()}}),n,null,[[11,27,31,41],[32,,36,40]])})))()}},{key:"findProviders",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.delegateYield(Xa(ui(os(t.lan.findProviders(e,r),t.wan.findProviders(e,r)))),"t0",1);case 1:case"end":return n.stop()}}),n)})))()}},{key:"findPeer",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=!1,a=!1,s=!1,n.prev=3,u=ui(os(t.lan.findPeer(e,r),t.wan.findPeer(e,r)));case 5:return n.next=7,Ji(u.next());case 7:if(!(a=!(c=n.sent).done)){n.next=15;break}return l=c.value,n.next=11,l;case 11:"SEND_QUERY"!==l.name&&"FINAL_PEER"!==l.name||(i=!0);case 12:a=!1,n.next=5;break;case 15:n.next=21;break;case 17:n.prev=17,n.t0=n.catch(3),s=!0,o=n.t0;case 21:if(n.prev=21,n.prev=22,!a||null==u.return){n.next=26;break}return n.next=26,Ji(u.return());case 26:if(n.prev=26,!s){n.next=29;break}throw o;case 29:return n.finish(26);case 30:return n.finish(21);case 31:if(i){n.next=33;break}throw new wo("Peer lookup failed","ERR_LOOKUP_FAILED");case 33:case"end":return n.stop()}}),n,null,[[3,17,21,31],[22,,26,30]])})))()}},{key:"getClosestPeers",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.delegateYield(Xa(ui(os(t.lan.getClosestPeers(e,r),t.wan.getClosestPeers(e,r)))),"t0",1);case 1:case"end":return n.stop()}}),n)})))()}},{key:"refreshRoutingTable",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.lan.refreshRoutingTable(),this.wan.refreshRoutingTable()]);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),r}(Ly);function uR(e){return function(t){return new oR(t,e)}}!function(e){e[e.SEND_QUERY=0]="SEND_QUERY",e[e.PEER_RESPONSE=1]="PEER_RESPONSE",e[e.FINAL_PEER=2]="FINAL_PEER",e[e.QUERY_ERROR=3]="QUERY_ERROR",e[e.PROVIDER=4]="PROVIDER",e[e.VALUE=5]="VALUE",e[e.ADD_PEER=6]="ADD_PEER",e[e.DIAL_PEER=7]="DIAL_PEER"}(iR||(iR={})),function(e){e[e.PUT_VALUE=0]="PUT_VALUE",e[e.GET_VALUE=1]="GET_VALUE",e[e.ADD_PROVIDER=2]="ADD_PROVIDER",e[e.GET_PROVIDERS=3]="GET_PROVIDERS",e[e.FIND_NODE=4]="FIND_NODE",e[e.PING=5]="PING"}(aR||(aR={})),function(e){e[e.NEW_STREAM=0]="NEW_STREAM",e[e.MESSAGE_RECEIVER=1]="MESSAGE_RECEIVER",e[e.MESSAGE_INITIATOR=2]="MESSAGE_INITIATOR",e[e.CLOSE_RECEIVER=3]="CLOSE_RECEIVER",e[e.CLOSE_INITIATOR=4]="CLOSE_INITIATOR",e[e.RESET_RECEIVER=5]="RESET_RECEIVER",e[e.RESET_INITIATOR=6]="RESET_INITIATOR"}(sR||(sR={}));var cR=Object.freeze({0:"NEW_STREAM",1:"MESSAGE_RECEIVER",2:"MESSAGE_INITIATOR",3:"CLOSE_RECEIVER",4:"CLOSE_INITIATOR",5:"RESET_RECEIVER",6:"RESET_INITIATOR"}),lR=Object.freeze({NEW_STREAM:sR.NEW_STREAM,MESSAGE:sR.MESSAGE_INITIATOR,CLOSE:sR.CLOSE_INITIATOR,RESET:sR.RESET_INITIATOR}),hR=Object.freeze({MESSAGE:sR.MESSAGE_RECEIVER,CLOSE:sR.CLOSE_RECEIVER,RESET:sR.RESET_RECEIVER}),fR=1<<20,dR=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fR,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4194304;(0,hi.Z)(this,e),(0,we.Z)(this,"_buffer",void 0),(0,we.Z)(this,"_headerInfo",void 0),(0,we.Z)(this,"_maxMessageSize",void 0),(0,we.Z)(this,"_maxUnprocessedMessageQueueSize",void 0),this._buffer=new Du,this._headerInfo=null,this._maxMessageSize=t,this._maxUnprocessedMessageQueueSize=r}return(0,fi.Z)(e,[{key:"write",value:function(e){if(null==e||0===e.length)return[];if(this._buffer.append(e),this._buffer.byteLength>this._maxUnprocessedMessageQueueSize)throw Object.assign(new Error("unprocessed message queue size too large!"),{code:"ERR_MSG_QUEUE_TOO_BIG"});for(var t=[];0!==this._buffer.length;){if(null==this._headerInfo)try{this._headerInfo=this._decodeHeader(this._buffer)}catch(S$){if("ERR_MSG_TOO_BIG"===S$.code)throw S$;break}var r=this._headerInfo,n=r.id,i=r.type,a=r.length,s=r.offset;if(this._buffer.length-s<a)break;var o={id:n,type:i};i!==sR.NEW_STREAM&&i!==sR.MESSAGE_INITIATOR&&i!==sR.MESSAGE_RECEIVER||(o.data=this._buffer.sublist(s,s+a)),t.push(o),this._buffer.consume(s+a),this._headerInfo=null}return t}},{key:"_decodeHeader",value:function(e){var t=gR(e),r=t.value,n=t.offset,i=gR(e,n),a=i.value,s=i.offset,o=7&r;if(null==cR[o])throw new Error("Invalid type received: ".concat(o));if(a>this._maxMessageSize)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"});return{id:r>>3,type:o,offset:n+s,length:a}}}]),e}(),pR=128,vR=127;function gR(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0,i=0,a=r,s=e.length;do{if(a>=s||i>49)throw r=0,new RangeError("Could not decode varint");t=e.get(a++),n+=i<28?(t&vR)<<i:(t&vR)*Math.pow(2,i),i+=7}while(t>=pR);return{value:n,offset:r=a-r}}var yR=1048576,mR=function(e,t){t.append(e)};var bR=function(e,t){return null!=e[Symbol.asyncIterator]?ea((0,ii.Z)().mark((function r(){var n,i,a,s,o,u,c,l,h,f;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(s=new Du,o=!1,u=ts(),c=Number(null!==(n=null===t||void 0===t?void 0:t.size)&&void 0!==n?n:yR),(isNaN(c)||0===c||c<0)&&(c=yR),c===Math.round(c)){r.next=7;break}throw new Error("Batch size must be an integer");case 7:l=null!==(i=null===t||void 0===t?void 0:t.yieldAfter)&&void 0!==i?i:0,h=null!==(a=null===t||void 0===t?void 0:t.serialize)&&void 0!==a?a:mR,Promise.resolve().then((0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i,a,f,d,p;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,n=!1,i=!1,t.prev=3,f=ui(e);case 5:return t.next=7,f.next();case 7:if(!(n=!(d=t.sent).done)){t.next=18;break}if(p=d.value,h(p,s),!(s.byteLength>=c)){t.next=14;break}return clearTimeout(r),u.resolve(),t.abrupt("continue",15);case 14:r=setTimeout((function(){u.resolve()}),l);case 15:n=!1,t.next=5;break;case 18:t.next=24;break;case 20:t.prev=20,t.t0=t.catch(3),i=!0,a=t.t0;case 24:if(t.prev=24,t.prev=25,!n||null==f.return){t.next=29;break}return t.next=29,f.return();case 29:if(t.prev=29,!i){t.next=32;break}throw a;case 32:return t.finish(29);case 33:return t.finish(24);case 34:clearTimeout(r),u.resolve(),t.next=41;break;case 38:t.prev=38,t.t1=t.catch(0),u.reject(t.t1);case 41:return t.prev=41,o=!0,t.finish(41);case 44:case"end":return t.stop()}}),t,null,[[0,38,41,44],[3,20,24,34],[25,,29,33]])}))));case 10:if(o){r.next=21;break}return r.next=13,Ji(u.promise);case 13:if(u=ts(),!(s.byteLength>0)){r.next=19;break}return f=s,s=new Du,r.next=19,f.subarray();case 19:r.next=10;break;case 21:case"end":return r.stop()}}),r)})))():(0,ii.Z)().mark((function r(n,i){var a,s,o,u,c,l;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a=new Du,s=Number(null!==(n=null===t||void 0===t?void 0:t.size)&&void 0!==n?n:yR),(isNaN(s)||0===s||s<0)&&(s=yR),s===Math.round(s)){r.next=5;break}throw new Error("Batch size must be an integer");case 5:o=null!==(i=null===t||void 0===t?void 0:t.serialize)&&void 0!==i?i:mR,u=(0,ge.Z)(e),r.prev=7,u.s();case 9:if((c=u.n()).done){r.next=18;break}if(l=c.value,o(l,a),!(a.byteLength>=s)){r.next=16;break}return r.next=15,a.subarray(0,s);case 15:a.consume(s);case 16:r.next=9;break;case 18:r.next=23;break;case 20:r.prev=20,r.t0=r.catch(7),u.e(r.t0);case 23:return r.prev=23,u.f(),r.finish(23);case 26:if(!(a.byteLength>0)){r.next=29;break}return r.next=29,a.subarray();case 29:case"end":return r.stop()}}),r,null,[[7,20,23,26]])}))()};function _R(e){return new Uint8Array(e)}var wR=10240,kR=function(){function e(){(0,hi.Z)(this,e),(0,we.Z)(this,"_pool",void 0),(0,we.Z)(this,"_poolOffset",void 0),this._pool=_R(wR),this._poolOffset=0}return(0,fi.Z)(e,[{key:"write",value:function(e,t){var r=this._pool,n=this._poolOffset;ku(e.id<<3|e.type,r,n),n+=wu(e.id<<3|e.type),e.type!==sR.NEW_STREAM&&e.type!==sR.MESSAGE_INITIATOR&&e.type!==sR.MESSAGE_RECEIVER||null==e.data?(ku(0,r,n),n+=wu(0)):(ku(e.data.length,r,n),n+=wu(e.data.length));var i=r.subarray(this._poolOffset,n);wR-n<100?(this._pool=_R(wR),this._poolOffset=0):this._poolOffset=n,t.append(i),e.type!==sR.NEW_STREAM&&e.type!==sR.MESSAGE_INITIATOR&&e.type!==sR.MESSAGE_RECEIVER||null==e.data||t.append(e.data)}}]),e}(),xR=new kR;function ER(){return ER=ea((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(0,ii.Z)().mark((function r(){var n,i,a,s,o,u,c,l,h,f;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(null!=t&&0!==t){r.next=34;break}n=!1,i=!1,r.prev=3,s=ui(e);case 5:return r.next=7,Ji(s.next());case 7:if(!(n=!(o=r.sent).done)){r.next=17;break}u=o.value,c=new Du,l=(0,ge.Z)(u);try{for(l.s();!(h=l.n()).done;)f=h.value,xR.write(f,c)}catch(S$){l.e(S$)}finally{l.f()}return r.next=14,c.subarray();case 14:n=!1,r.next=5;break;case 17:r.next=23;break;case 19:r.prev=19,r.t0=r.catch(3),i=!0,a=r.t0;case 23:if(r.prev=23,r.prev=24,!n||null==s.return){r.next=28;break}return r.next=28,Ji(s.return());case 28:if(r.prev=28,!i){r.next=31;break}throw a;case 31:return r.finish(28);case 32:return r.finish(23);case 33:return r.abrupt("return");case 34:return r.delegateYield(Xa(ui(bR(e,{size:t,serialize:function(e,t){var r,n=(0,ge.Z)(e);try{for(n.s();!(r=n.n()).done;){var i=r.value;xR.write(i,t)}}catch(S$){n.e(S$)}finally{n.f()}}}))),"t1",35);case 35:case"end":return r.stop()}}),r,null,[[3,19,23,33],[24,,28,32]])}))()})),ER.apply(this,arguments)}var SR=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),n=t.call(this,e),(0,we.Z)(ra(n),"name",void 0),(0,we.Z)(ra(n),"streamId",void 0),(0,we.Z)(ra(n),"send",void 0),(0,we.Z)(ra(n),"types",void 0),(0,we.Z)(ra(n),"maxDataSize",void 0),n.types="outbound"===e.direction?lR:hR,n.send=e.send,n.name=e.name,n.streamId=e.streamId,n.maxDataSize=e.maxDataSize,n}return(0,fi.Z)(r,[{key:"sendNewStream",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.send({id:this.streamId,type:lR.NEW_STREAM,data:new Du(Hs(this.name))});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sendData",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=t.sublist();case 1:if(!(t.byteLength>0)){e.next=8;break}return r=Math.min(t.byteLength,this.maxDataSize),e.next=5,this.send({id:this.streamId,type:this.types.MESSAGE,data:t.sublist(0,r)});case 5:t.consume(r),e.next=1;break;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendReset",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.send({id:this.streamId,type:this.types.RESET});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sendCloseWrite",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.send({id:this.streamId,type:this.types.CLOSE});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sendCloseRead",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),r}(mC);var CR=zi("libp2p:mplex");function AR(e){var t=(0,_e.Z)((0,_e.Z)({},e),{},{type:"".concat(cR[e.type]," (").concat(e.type,")")});return e.type===sR.NEW_STREAM&&(t.data=Ws(e.data instanceof Uint8Array?e.data:e.data.subarray())),e.type!==sR.MESSAGE_INITIATOR&&e.type!==sR.MESSAGE_RECEIVER||(t.data=Ws(e.data instanceof Uint8Array?e.data:e.data.subarray(),"base16")),t}var DR,RR=function(){function e(t){var r,n,i,a=this;(0,hi.Z)(this,e),(0,we.Z)(this,"protocol","/mplex/6.7.0"),(0,we.Z)(this,"sink",void 0),(0,we.Z)(this,"source",void 0),(0,we.Z)(this,"_streamId",void 0),(0,we.Z)(this,"_streams",void 0),(0,we.Z)(this,"_init",void 0),(0,we.Z)(this,"_source",void 0),(0,we.Z)(this,"closeController",void 0),(0,we.Z)(this,"rateLimiter",void 0),(0,we.Z)(this,"closeTimeout",void 0),t=null!==(r=t)&&void 0!==r?r:{},this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._init=t,this.closeTimeout=null!==(n=t.closeTimeout)&&void 0!==n?n:500,this.sink=this._createSink(),this._source=function(){return ss((function(e){for(var t,r=[];!e.isEmpty()&&null!=(t=e.shift());){if(null!=t.error)throw t.error;!1===t.done&&r.push(t.value)}return null==t?{done:!0}:{done:!0===t.done,value:r}}),arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}({objectMode:!0,onEnd:function(){var e,t=(0,ge.Z)(a._streams.initiators.values());try{for(t.s();!(e=t.n()).done;){e.value.destroy()}}catch(S$){t.e(S$)}finally{t.f()}var r,n=(0,ge.Z)(a._streams.receivers.values());try{for(n.s();!(r=n.n()).done;){r.value.destroy()}}catch(S$){n.e(S$)}finally{n.f()}}}),this.source=no(this._source,(function(e){return function(e){return ER.apply(this,arguments)}(e,a._init.minSendBytes)})),this.closeController=new AbortController,this.rateLimiter=new Tw.RateLimiterMemory({points:null!==(i=t.disconnectThreshold)&&void 0!==i?i:5,duration:1})}return(0,fi.Z)(e,[{key:"streams",get:function(){var e,t=[],r=(0,ge.Z)(this._streams.initiators.values());try{for(r.s();!(e=r.n()).done;){var n=e.value;t.push(n)}}catch(S$){r.e(S$)}finally{r.f()}var i,a=(0,ge.Z)(this._streams.receivers.values());try{for(a.s();!(i=a.n()).done;){var s=i.value;t.push(s)}}catch(S$){a.e(S$)}finally{a.f()}return t}},{key:"newStream",value:function(e){if(this.closeController.signal.aborted)throw new Error("Muxer already closed");var t=this._streamId++;e=null==e?t.toString():e.toString();var r=this._streams.initiators;return this._newStream({id:t,name:e,type:"initiator",registry:r})}},{key:"close",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.closeController.signal.aborted){e.next=2;break}return e.abrupt("return");case 2:return n=null!==(r=null===t||void 0===t?void 0:t.signal)&&void 0!==r?r:AbortSignal.timeout(this.closeTimeout),e.prev=3,e.next=6,Promise.all(this.streams.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.close({signal:n}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:return this._source.end(),e.next=9,this._source.onEmpty({signal:n});case 9:this.closeController.abort(),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),this.abort(e.t0);case 15:case"end":return e.stop()}}),e,this,[[3,12]])})));return function(t){return e.apply(this,arguments)}}()},{key:"abort",value:function(e){this.closeController.signal.aborted||(this.streams.forEach((function(t){t.abort(e)})),this.closeController.abort(e))}},{key:"_newReceiverStream",value:function(e){var t=e.id,r=e.name,n=this._streams.receivers;return this._newStream({id:t,name:r,type:"receiver",registry:n})}},{key:"_newStream",value:function(e){var t,r=this,n=e.id,i=e.name,a=e.type,s=e.registry;if(CR("new %s stream %s",a,n),"initiator"===a&&this._streams.initiators.size===(null!==(t=this._init.maxOutboundStreams)&&void 0!==t?t:1024))throw new wo("Too many outbound streams open","ERR_TOO_MANY_OUTBOUND_STREAMS");if(s.has(n))throw new Error("".concat(a," stream ").concat(n," already exists!"));var o=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:CR.enabled&&CR.trace("%s stream %s send",a,n,AR(t)),r._source.push(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(e){var t=e.id,r=e.name,n=e.send,i=e.onEnd,a=e.type,s=void 0===a?"initiator":a,o=e.maxMsgSize,u=void 0===o?fR:o;return new SR({id:"initiator"===s?"i".concat(t):"r".concat(t),streamId:t,name:"".concat(null==r?t:r),direction:"initiator"===s?"outbound":"inbound",maxDataSize:u,onEnd:i,send:n,log:zi("libp2p:mplex:stream:".concat(s,":").concat(t))})}({id:n,name:i,send:o,type:a,onEnd:function(){CR("%s stream with id %s and protocol %s ended",a,n,u.protocol),s.delete(n),null!=r._init.onStreamEnd&&r._init.onStreamEnd(u)},maxMsgSize:this._init.maxMsgSize});return s.set(n,u),u}},{key:"_createSink",value:function(){var e=this,t=function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a,s,o,u,c,l,h,f;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,r=Sk(r,e.closeController.signal,{returnOnAbort:!0}),n=new dR(e._init.maxMsgSize,e._init.maxUnprocessedMessageQueueSize),i=!1,a=!1,t.prev=5,o=ui(r);case 7:return t.next=9,o.next();case 9:if(!(i=!(u=t.sent).done)){t.next=31;break}c=u.value,l=(0,ge.Z)(n.write(c)),t.prev=12,l.s();case 14:if((h=l.n()).done){t.next=20;break}return f=h.value,t.next=18,e._handleIncoming(f);case 18:t.next=14;break;case 20:t.next=25;break;case 22:t.prev=22,t.t0=t.catch(12),l.e(t.t0);case 25:return t.prev=25,l.f(),t.finish(25);case 28:i=!1,t.next=7;break;case 31:t.next=37;break;case 33:t.prev=33,t.t1=t.catch(5),a=!0,s=t.t1;case 37:if(t.prev=37,t.prev=38,!i||null==o.return){t.next=42;break}return t.next=42,o.return();case 42:if(t.prev=42,!a){t.next=45;break}throw s;case 45:return t.finish(42);case 46:return t.finish(37);case 47:e._source.end(),t.next=54;break;case 50:t.prev=50,t.t2=t.catch(0),CR("error in sink",t.t2),e._source.end(t.t2);case 54:case"end":return t.stop()}}),t,null,[[0,50],[5,33,37,47],[12,22,25,28],[38,,42,46]])})));return function(e){return t.apply(this,arguments)}}();return t}},{key:"_handleIncoming",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.id,i=t.type,CR.enabled&&CR.trace("incoming message",AR(t)),t.type!==sR.NEW_STREAM){e.next=20;break}if(this._streams.receivers.size!==(null!==(a=this._init.maxInboundStreams)&&void 0!==a?a:1024)){e.next=17;break}return CR("too many inbound streams open"),this._source.push({id:n,type:sR.RESET_RECEIVER}),e.prev=6,e.next=9,this.rateLimiter.consume("new-stream",1);case 9:e.next=16;break;case 11:return e.prev=11,e.t0=e.catch(6),CR("rate limit hit when opening too many new streams over the inbound stream limit - closing remote connection"),this.abort(new Error("Too many open streams")),e.abrupt("return");case 16:return e.abrupt("return");case 17:return s=this._newReceiverStream({id:n,name:Ws(t.data instanceof Uint8Array?t.data:t.data.subarray())}),null!=this._init.onIncomingStream&&this._init.onIncomingStream(s),e.abrupt("return");case 20:if(o=1===(1&i)?this._streams.initiators:this._streams.receivers,null!=(u=o.get(n))){e.next=35;break}return CR("missing stream %s for message type %s",n,cR[i]),e.prev=24,e.next=27,this.rateLimiter.consume("missing-stream",1);case 27:e.next=34;break;case 29:return e.prev=29,e.t1=e.catch(24),CR("rate limit hit when receiving messages for streams that do not exist - closing remote connection"),this.abort(new Error("Too many messages for missing streams")),e.abrupt("return");case 34:return e.abrupt("return");case 35:c=null!==(r=this._init.maxStreamBufferSize)&&void 0!==r?r:4194304,e.prev=36,e.t2=i,e.next=e.t2===sR.MESSAGE_INITIATOR||e.t2===sR.MESSAGE_RECEIVER?40:e.t2===sR.CLOSE_INITIATOR||e.t2===sR.CLOSE_RECEIVER?45:e.t2===sR.RESET_INITIATOR||e.t2===sR.RESET_RECEIVER?47:49;break;case 40:if(!(u.sourceReadableLength()>c)){e.next=43;break}throw this._source.push({id:t.id,type:i===sR.MESSAGE_INITIATOR?sR.RESET_RECEIVER:sR.RESET_INITIATOR}),new wo("Input buffer full - increase Mplex maxBufferSize to accommodate slow consumers","ERR_STREAM_INPUT_BUFFER_FULL");case 43:return u.sourcePush(t.data),e.abrupt("break",50);case 45:return u.remoteCloseWrite(),e.abrupt("break",50);case 47:return u.reset(),e.abrupt("break",50);case 49:CR("unknown message type %s",i);case 50:e.next=56;break;case 52:e.prev=52,e.t3=e.catch(36),CR.error("error while processing message",e.t3),u.abort(e.t3);case 56:case"end":return e.stop()}}),e,this,[[6,11],[24,29],[36,52]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),TR=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,hi.Z)(this,e),(0,we.Z)(this,"protocol","/mplex/6.7.0"),(0,we.Z)(this,"_init",void 0),this._init=t}return(0,fi.Z)(e,[{key:"createStreamMuxer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new RR((0,_e.Z)((0,_e.Z)({},e),this._init))}}]),e}();function ZR(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(){return new TR(e)}}!function(e){e.ERR_ALREADY_ABORTED="ERR_ALREADY_ABORTED",e.ERR_DATA_CHANNEL="ERR_DATA_CHANNEL",e.ERR_CONNECTION_CLOSED="ERR_CONNECTION_CLOSED",e.ERR_HASH_NOT_SUPPORTED="ERR_HASH_NOT_SUPPORTED",e.ERR_INVALID_MULTIADDR="ERR_INVALID_MULTIADDR",e.ERR_INVALID_FINGERPRINT="ERR_INVALID_FINGERPRINT",e.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",e.ERR_NOT_IMPLEMENTED="ERR_NOT_IMPLEMENTED",e.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS",e.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS"}(DR||(DR={}));var IR=function(e){ia(r,e);var t=ua(r);function r(e,n){var i;return(0,hi.Z)(this,r),(i=t.call(this,"WebRTC transport error: ".concat(e),null!==n&&void 0!==n?n:"")).name="WebRTCTransportError",i}return(0,fi.Z)(r)}(wo);var PR=function(e){ia(r,e);var t=ua(r);function r(e,n){var i;return(0,hi.Z)(this,r),(i=t.call(this,"[stream: ".concat(e,"] data channel error: ").concat(n),DR.ERR_DATA_CHANNEL)).name="WebRTC/DataChannelError",i}return(0,fi.Z)(r)}(IR);function LR(e,t){return new PR(e,t)}var MR=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),(n=t.call(this,"There was a problem with the Multiaddr which was passed in: ".concat(e),DR.ERR_INVALID_MULTIADDR)).name="WebRTC/InappropriateMultiaddrError",n}return(0,fi.Z)(r)}(IR);function BR(e){return new MR(e)}var OR=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),(n=t.call(this,"There was a problem with a provided argument: ".concat(e),DR.ERR_INVALID_PARAMETERS)).name="WebRTC/InvalidArgumentError",n}return(0,fi.Z)(r)}(IR);function NR(e){return new OR(e)}var FR=function(e){ia(r,e);var t=ua(r);function r(e,n){var i;return(0,hi.Z)(this,r),(i=t.call(this,'Invalid fingerprint "'.concat(e,'" within ').concat(n),DR.ERR_INVALID_FINGERPRINT)).name="WebRTC/InvalidFingerprintError",i}return(0,fi.Z)(r)}(IR);function UR(e,t){return new FR(e,t)}var zR=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),(n=t.call(this,"A method (".concat(e,") was called though it has been intentionally left unimplemented."),DR.ERR_NOT_IMPLEMENTED)).name="WebRTC/UnimplementedError",n}return(0,fi.Z)(r)}(IR);var jR=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),(n=t.call(this,"unsupported hash algorithm: ".concat(e),DR.ERR_HASH_NOT_SUPPORTED)).name="WebRTC/UnsupportedHashAlgorithmError",n}return(0,fi.Z)(r)}(IR);var HR=__webpack_require__(1426),WR=function(e,t,r){if(r||2===arguments.length)for(var n,i=0,a=t.length;i<a;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},qR=function(e,t,r){this.name=e,this.version=t,this.os=r,this.type="browser"},VR=function(e){this.version=e,this.type="node",this.name="node",this.os=HR.platform},KR=function(e,t,r,n){this.name=e,this.version=t,this.os=r,this.bot=n,this.type="bot-device"},YR=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},GR=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},QR=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,XR=3,JR=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],$R=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function eT(e){return""!==e&&JR.reduce((function(t,r){var n=r[0],i=r[1];if(t)return t;var a=i.exec(e);return!!a&&[n,a]}),!1)}function tT(e){var t=eT(e);if(!t)return null;var r=t[0],n=t[1];if("searchbot"===r)return new YR;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<XR&&(i=WR(WR([],i,!0),function(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}(XR-i.length),!0)):i=[];var a=i.join("."),s=function(e){for(var t=0,r=$R.length;t<r;t++){var n=$R[t],i=n[0];if(n[1].exec(e))return i}return null}(e),o=QR.exec(e);return o&&o[1]?new KR(r,a,s,o[1]):new qR(r,a,s)}var rT,nT=zi("libp2p:webrtc:utils"),iT=rT?tT(rT):"undefined"===typeof document&&"undefined"!==typeof navigator&&"ReactNative"===navigator.product?new GR:"undefined"!==typeof navigator?tT(navigator.userAgent):function(){var e="undefined"!==typeof HR&&HR.version;return e?new VR(HR.version.slice(1)):null}(),aT=null!=iT&&"firefox"===iT.name,sT=function(){var e=ea((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),oT=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function uT(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e4;"open"===e.readyState&&Promise.resolve().then((0,ai.Z)((0,ii.Z)().mark((function n(){var i,a,s;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(e.bufferedAmount>0)){n.next=10;break}return nT("%s drain channel with %d buffered bytes",t,e.bufferedAmount),i=ts(),a=!1,e.bufferedAmountLowThreshold=0,s=function(){a||(nT("%s drain channel closed before drain",t),i.resolve())},e.addEventListener("close",s,{once:!0}),e.addEventListener("bufferedamountlow",(function(){a=!0,e.removeEventListener("close",s),i.resolve()})),n.next=10,rd(i.promise,{milliseconds:r});case 10:case"end":return n.stop()}}),n)})))).then((0,ai.Z)((0,ii.Z)().mark((function t(){return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"open"===e.readyState&&e.close();case 1:case"end":return t.stop()}}),t)})))).catch((function(e){nT.error("error closing outbound stream",e)}))}var cT,lT=zi("libp2p:webrtc:maconn"),hT=function(){function e(t){var r=this;(0,hi.Z)(this,e),(0,we.Z)(this,"peerConnection",void 0),(0,we.Z)(this,"remoteAddr",void 0),(0,we.Z)(this,"timeline",void 0),(0,we.Z)(this,"metrics",void 0),(0,we.Z)(this,"source",sT()),(0,we.Z)(this,"sink",oT),this.remoteAddr=t.remoteAddr,this.timeline=t.timeline,this.peerConnection=t.peerConnection;var n=this.peerConnection.connectionState;this.peerConnection.onconnectionstatechange=function(){lT.trace("peer connection state change",r.peerConnection.connectionState,"initial state",n),"disconnected"!==r.peerConnection.connectionState&&"failed"!==r.peerConnection.connectionState&&"closed"!==r.peerConnection.connectionState||(r.timeline.close=Date.now())}}return(0,fi.Z)(e,[{key:"close",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:lT.trace("closing connection"),this.peerConnection.close(),this.timeline.close=Date.now(),null===(r=this.metrics)||void 0===r||r.increment({close:!0});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"abort",value:function(e){var t;lT.error("closing connection due to error",e),this.peerConnection.close(),this.timeline.close=Date.now(),null===(t=this.metrics)||void 0===t||t.increment({abort:!0})}}]),e}();!function(e){var t,r;!function(e){e.FIN="FIN",e.STOP_SENDING="STOP_SENDING",e.RESET="RESET",e.FIN_ACK="FIN_ACK"}(e.Flag||(e.Flag={})),function(e){e[e.FIN=0]="FIN",e[e.STOP_SENDING=1]="STOP_SENDING",e[e.RESET=2]="RESET",e[e.FIN_ACK=3]="FIN_ACK"}(t||(t={})),function(e){e.codec=function(){return Qo(t)}}(e.Flag||(e.Flag={})),e.codec=function(){return null==r&&(r=Xo((function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&r.fork(),null!=t.flag&&(r.uint32(8),e.Flag.codec().encode(t.flag,r)),null!=t.message&&(r.uint32(18),r.bytes(t.message)),!1!==n.lengthDelimited&&r.ldelim()}),(function(t,r){for(var n={},i=null==r?t.len:t.pos+r;t.pos<i;){var a=t.uint32();switch(a>>>3){case 1:n.flag=e.Flag.codec().decode(t);break;case 2:n.message=t.bytes();break;default:t.skipType(7&a)}}return n}))),r},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(cT||(cT={}));var fT=function(e){ia(r,e);var t=ua(r);function r(e){var n,i,a,s,o;(0,hi.Z)(this,r);var u=e.onEnd;switch(e.onEnd=function(e){o.log.trace("readable and writeable ends closed",o.status),Promise.resolve((0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==o.timeline.abort&&null===o.timeline.reset){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,rd(o.receiveFinAck.promise,{milliseconds:o.finAckTimeout});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),o.log.error("error receiving FIN_ACK",e.t0);case 10:case"end":return e.stop()}}),e,null,[[2,7]])})))).then((function(){o.incomingData.end(),null===u||void 0===u||u(e)})).catch((function(e){o.log.error("error ending stream",e)}))},o=t.call(this,e),(0,we.Z)(ra(o),"channel",void 0),(0,we.Z)(ra(o),"incomingData",void 0),(0,we.Z)(ra(o),"messageQueue",void 0),(0,we.Z)(ra(o),"maxBufferedAmount",void 0),(0,we.Z)(ra(o),"bufferedAmountLowEventTimeout",void 0),(0,we.Z)(ra(o),"maxMessageSize",void 0),(0,we.Z)(ra(o),"receiveFinAck",void 0),(0,we.Z)(ra(o),"finAckTimeout",void 0),o.channel=e.channel,o.channel.binaryType="arraybuffer",o.incomingData=as(),o.messageQueue=new Du,o.bufferedAmountLowEventTimeout=null!==(n=e.bufferedAmountLowEventTimeout)&&void 0!==n?n:3e4,o.maxBufferedAmount=null!==(i=e.maxBufferedAmount)&&void 0!==i?i:16777216,o.maxMessageSize=(null!==(a=e.maxMessageSize)&&void 0!==a?a:16384)-5-2,o.receiveFinAck=ts(),o.finAckTimeout=null!==(s=e.closeTimeout)&&void 0!==s?s:5e3,o.channel.readyState){case"open":case"connecting":break;case"closed":case"closing":void 0!==o.timeline.close&&0!==o.timeline.close||(o.timeline.close=Date.now());break;default:throw o.log.error("unknown datachannel state %s",o.channel.readyState),new wo("Unknown datachannel state","ERR_INVALID_STATE")}o.channel.onopen=function(e){o.timeline.open=(new Date).getTime(),null!=o.messageQueue&&o.messageQueue.byteLength>0&&(o.log.trace("dataChannel opened, sending queued messages",o.messageQueue.byteLength,o.channel.readyState),o._sendMessage(o.messageQueue).catch((function(e){o.log.error("error sending queued messages",e),o.abort(e)}))),o.messageQueue=void 0},o.channel.onclose=function(e){o.receiveFinAck.resolve(),o.close().catch((function(e){o.log.error("error closing stream after channel closed",e)}))},o.channel.onerror=function(e){var t=e.error;o.abort(t)},o.channel.onmessage=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(r=t.data)&&0!==r.byteLength){e.next=3;break}return e.abrupt("return");case 3:o.incomingData.push(new Uint8Array(r,0,r.byteLength));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var c=ra(o);return Promise.resolve().then((0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i,a,s,u;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!1,r=!1,e.prev=2,i=ui(Bu(o.incomingData));case 4:return e.next=6,i.next();case 6:if(!(t=!(a=e.sent).done)){e.next=13;break}s=a.value,null!=(u=c.processIncomingProtobuf(s))&&c.sourcePush(new Du(u));case 10:t=!1,e.next=4;break;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),r=!0,n=e.t0;case 19:if(e.prev=19,e.prev=20,!t||null==i.return){e.next=24;break}return e.next=24,i.return();case 24:if(e.prev=24,!r){e.next=27;break}throw n;case 27:return e.finish(24);case 28:return e.finish(19);case 29:case"end":return e.stop()}}),e,null,[[2,15,19,29],[20,,24,28]])})))).catch((function(e){o.log.error("error processing incoming data channel messages",e)})),o}return(0,fi.Z)(r,[{key:"sendNewStream",value:function(){}},{key:"_sendMessage",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((!(a.length>1&&void 0!==a[1])||a[1])&&this.channel.bufferedAmount>this.maxBufferedAmount)){e.next=12;break}return e.prev=2,e.next=5,ID(this.channel,"bufferedamountlow",{timeout:this.bufferedAmountLowEventTimeout});case 5:e.next=12;break;case 7:if(e.prev=7,e.t0=e.catch(2),!(e.t0 instanceof Jf)){e.next=11;break}throw new wo("Timed out waiting for DataChannel buffer to clear after ".concat(this.bufferedAmountLowEventTimeout,"ms"),"ERR_BUFFER_CLEAR_TIMEOUT");case 11:throw e.t0;case 12:if("closed"!==this.channel.readyState&&"closing"!==this.channel.readyState){e.next=14;break}throw new wo("Invalid datachannel state - ".concat(this.channel.readyState),"ERR_INVALID_STATE");case 14:if("open"!==this.channel.readyState){e.next=19;break}r=(0,ge.Z)(t);try{for(r.s();!(n=r.n()).done;)i=n.value,this.channel.send(i)}catch(S$){r.e(S$)}finally{r.f()}e.next=26;break;case 19:if("connecting"!==this.channel.readyState){e.next=24;break}null==this.messageQueue&&(this.messageQueue=new Du),this.messageQueue.append(t),e.next=26;break;case 24:throw this.log.error("unknown datachannel state %s",this.channel.readyState),new wo("Unknown datachannel state","ERR_INVALID_STATE");case 26:case"end":return e.stop()}}),e,this,[[2,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"sendData",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=t.sublist();case 1:if(!(t.byteLength>0)){e.next=11;break}return r=Math.min(t.byteLength,this.maxMessageSize),n=t.subarray(0,r),i=cT.encode({message:n}),a=Zu.single(i),e.next=8,this._sendMessage(a);case 8:t.consume(r),e.next=1;break;case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendReset",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._sendFlag(cT.Flag.RESET);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sendCloseWrite",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._sendFlag(cT.Flag.FIN);case 2:if(!e.sent){e.next=15;break}return this.log.trace("awaiting FIN_ACK"),e.prev=5,e.next=8,pC(this.receiveFinAck.promise,null===t||void 0===t?void 0:t.signal,{errorMessage:"sending close-write was aborted before FIN_ACK was received",errorCode:"ERR_FIN_ACK_NOT_RECEIVED"});case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5),this.log.error("failed to await FIN_ACK",e.t0);case 13:e.next=16;break;case 15:this.log.trace("sending FIN failed, not awaiting FIN_ACK");case 16:this.receiveFinAck.resolve();case 17:case"end":return e.stop()}}),e,this,[[5,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"sendCloseRead",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._sendFlag(cT.Flag.STOP_SENDING);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"processIncomingProtobuf",value:function(e){var t=this,r=cT.decode(e);if(void 0!==r.flag&&(this.log.trace('incoming flag %s, write status "%s", read status "%s"',r.flag,this.writeStatus,this.readStatus),r.flag===cT.Flag.FIN&&(this.remoteCloseWrite(),this.log.trace("sending FIN_ACK"),this._sendFlag(cT.Flag.FIN_ACK).catch((function(e){t.log.error("error sending FIN_ACK immediately",e)}))),r.flag===cT.Flag.RESET&&this.reset(),r.flag===cT.Flag.STOP_SENDING&&this.remoteCloseRead(),r.flag===cT.Flag.FIN_ACK&&(this.log.trace("received FIN_ACK"),this.receiveFinAck.resolve())),"ready"===this.readStatus)return r.message}},{key:"_sendFlag",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("open"===this.channel.readyState){e.next=3;break}return this.log.trace("not sending flag %s because channel is not open",t.toString()),e.abrupt("return",!1);case 3:return this.log.trace("sending flag %s",t.toString()),r=cT.encode({flag:t}),n=Zu.single(r),e.prev=6,e.next=9,this._sendMessage(n,!1);case 9:return e.abrupt("return",!0);case 12:e.prev=12,e.t0=e.catch(6),this.log.error("could not send flag %s",t.toString(),e.t0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,this,[[6,12]])})));return function(t){return e.apply(this,arguments)}}()}]),r}(mC);function dT(e){var t=e.channel,r=e.direction;return new fT((0,_e.Z)({id:"inbound"===r?"i".concat(t.id):"r".concat(t.id),log:zi("libp2p:webrtc:stream:".concat(r,":").concat(t.id))},e))}var pT,vT=zi("libp2p:webrtc:muxer"),gT="/webrtc",yT=function(){function e(t){var r,n,i=this;(0,hi.Z)(this,e),(0,we.Z)(this,"protocol",void 0),(0,we.Z)(this,"peerConnection",void 0),(0,we.Z)(this,"streamBuffer",[]),(0,we.Z)(this,"metrics",void 0),(0,we.Z)(this,"dataChannelOptions",void 0),this.peerConnection=t.peerConnection,this.metrics=t.metrics,this.protocol=null!==(r=t.protocol)&&void 0!==r?r:gT,this.dataChannelOptions=null!==(n=t.dataChannelOptions)&&void 0!==n?n:{},this.peerConnection.ondatachannel=function(e){var t=e.channel,r=dT((0,_e.Z)({channel:t,direction:"inbound",onEnd:function(){i.streamBuffer=i.streamBuffer.filter((function(e){return e.id!==r.id}))}},i.dataChannelOptions));i.streamBuffer.push(r)}}return(0,fi.Z)(e,[{key:"createStreamMuxer",value:function(e){return new mT((0,_e.Z)((0,_e.Z)({},e),{},{peerConnection:this.peerConnection,dataChannelOptions:this.dataChannelOptions,metrics:this.metrics,streams:this.streamBuffer,protocol:this.protocol}))}}]),e}(),mT=function(){function e(t){var r,n,i=this;(0,hi.Z)(this,e),(0,we.Z)(this,"init",void 0),(0,we.Z)(this,"streams",void 0),(0,we.Z)(this,"protocol",void 0),(0,we.Z)(this,"peerConnection",void 0),(0,we.Z)(this,"dataChannelOptions",void 0),(0,we.Z)(this,"metrics",void 0),(0,we.Z)(this,"source",sT()),(0,we.Z)(this,"sink",oT),this.init=t,this.streams=t.streams,this.peerConnection=t.peerConnection,this.protocol=null!==(r=t.protocol)&&void 0!==r?r:gT,this.metrics=t.metrics,this.dataChannelOptions=null!==(n=t.dataChannelOptions)&&void 0!==n?n:{},this.peerConnection.ondatachannel=function(e){var r,n,a=e.channel,s=dT((0,_e.Z)({channel:a,direction:"inbound",onEnd:function(){var e,r;vT.trace("stream %s %s %s onEnd",s.direction,s.id,s.protocol),uT(a,"inbound ".concat(s.id," ").concat(s.protocol),i.dataChannelOptions.drainTimeout),i.streams=i.streams.filter((function(e){return e.id!==s.id})),null===(e=i.metrics)||void 0===e||e.increment({stream_end:!0}),null===t||void 0===t||null===(r=t.onStreamEnd)||void 0===r||r.call(t,s)}},i.dataChannelOptions));i.streams.push(s),null===(r=i.metrics)||void 0===r||r.increment({incoming_stream:!0}),null===t||void 0===t||null===(n=t.onIncomingStream)||void 0===n||n.call(t,s)};var a=null===t||void 0===t?void 0:t.onIncomingStream;null!=a&&this.streams.forEach((function(e){a(e)}))}return(0,fi.Z)(e,[{key:"close",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all(this.streams.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(r){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.close(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),this.abort(e.t0);case 8:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()},{key:"abort",value:function(e){var t,r=(0,ge.Z)(this.streams);try{for(r.s();!(t=r.n()).done;){t.value.abort(e)}}catch(e){r.e(e)}finally{r.f()}}},{key:"newStream",value:function(){var e,t=this,r=this.peerConnection.createDataChannel(""),n=dT((0,_e.Z)({channel:r,direction:"outbound",onEnd:function(){var e,i,a;vT.trace("stream %s %s %s onEnd",n.direction,n.id,n.protocol),uT(r,"outbound ".concat(n.id," ").concat(n.protocol),t.dataChannelOptions.drainTimeout),t.streams=t.streams.filter((function(e){return e.id!==n.id})),null===(e=t.metrics)||void 0===e||e.increment({stream_end:!0}),null===(i=t.init)||void 0===i||null===(a=i.onStreamEnd)||void 0===a||a.call(i,n)}},this.dataChannelOptions));return this.streams.push(n),null===(e=this.metrics)||void 0===e||e.increment({outgoing_stream:!0}),n}}]),e}(),bT=globalThis.RTCPeerConnection,_T=globalThis.RTCSessionDescription,wT=globalThis.RTCIceCandidate;function kT(e,t){var r=DE(e,t),n={read:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,n){var i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.read(n);case 2:return i=e.sent,e.abrupt("return",t.decode(i));case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),write:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,n,i){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.write(n.encode(t),i);case 2:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),pb:function(e){return{read:function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(r){return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",n.read(e,r));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),write:function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(r,i){return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",n.write(r,e,i));case 1:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),unwrap:function(){return n}}},unwrap:function(){return r.unwrap()}};return n}!function(e){var t,r;!function(e){e.SDP_OFFER="SDP_OFFER",e.SDP_ANSWER="SDP_ANSWER",e.ICE_CANDIDATE="ICE_CANDIDATE"}(e.Type||(e.Type={})),function(e){e[e.SDP_OFFER=0]="SDP_OFFER",e[e.SDP_ANSWER=1]="SDP_ANSWER",e[e.ICE_CANDIDATE=2]="ICE_CANDIDATE"}(t||(t={})),function(e){e.codec=function(){return Qo(t)}}(e.Type||(e.Type={})),e.codec=function(){return null==r&&(r=Xo((function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&r.fork(),null!=t.type&&(r.uint32(8),e.Type.codec().encode(t.type,r)),null!=t.data&&(r.uint32(18),r.string(t.data)),!1!==n.lengthDelimited&&r.ldelim()}),(function(t,r){for(var n={},i=null==r?t.len:t.pos+r;t.pos<i;){var a=t.uint32();switch(a>>>3){case 1:n.type=e.Type.codec().decode(t);break;case 2:n.data=t.string();break;default:t.skipType(7&a)}}return n}))),r},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(pT||(pT={}));var xT=zi("libp2p:webrtc:peer:util"),ET=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i){var a,s,o,u,c,l,h,f,d,p,v,g,y,m;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=new AbortController,t.promise.then((function(){s.abort()}),(function(){s.abort()})),o=vo([s.signal,i.signal]),u=Sk(n.unwrap().unwrap().source,o,{returnOnAbort:!0}),e.prev=4,c=!1,l=!1,e.prev=7,f=ui(Bu(u));case 9:return e.next=11,f.next();case 11:if(!(c=!(d=e.sent).done)){e.next=32;break}if(p=d.value,(g=pT.decode(p)).type===pT.Type.ICE_CANDIDATE){e.next=16;break}throw new wo("ICE candidate message expected","ERR_NOT_ICE_CANDIDATE");case 16:return""===(y=JSON.parse(null!==(v=g.data)&&void 0!==v?v:"null"))&&(xT.trace("end-of-candidates for this generation received"),y={candidate:"",sdpMid:"0",sdpMLineIndex:0}),null===y&&(xT.trace("end-of-candidates received"),y={candidate:null,sdpMid:"0",sdpMLineIndex:0}),m=new wT(y),xT.trace("%s received new ICE candidate",i.direction,m),e.prev=21,e.next=24,r.addIceCandidate(m);case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(21),xT.error("%s bad candidate received",i.direction,e.t0);case 29:c=!1,e.next=9;break;case 32:e.next=38;break;case 34:e.prev=34,e.t1=e.catch(7),l=!0,h=e.t1;case 38:if(e.prev=38,e.prev=39,!c||null==f.return){e.next=43;break}return e.next=43,f.return();case 43:if(e.prev=43,!l){e.next=46;break}throw h;case 46:return e.finish(43);case 47:return e.finish(38);case 48:e.next=53;break;case 50:e.prev=50,e.t2=e.catch(4),xT.error("%s error parsing ICE candidate",i.direction,e.t2);case 53:return e.prev=53,o.clear(),e.finish(53);case 56:if(!0!==(null===(a=i.signal)||void 0===a?void 0:a.aborted)){e.next=58;break}throw new dC("Aborted while reading ICE candidates","ERR_ICE_CANDIDATES_READ_ABORTED");case 58:return e.next=60,pC(t.promise,i.signal,{errorMessage:"Aborted before connected",errorCode:"ERR_ABORTED_BEFORE_CONNECTED"});case 60:case"end":return e.stop()}}),e,null,[[4,50,53,56],[7,34,38,48],[21,26],[39,,43,47]])})));return function(t,r,n,i){return e.apply(this,arguments)}}();function ST(e,t){e[aT?"oniceconnectionstatechange":"onconnectionstatechange"]=function(r){switch(xT.trace("receiver peerConnectionState state change: %s",e.connectionState),aT?e.iceConnectionState:e.connectionState){case"connected":t.resolve();break;case"failed":case"disconnected":case"closed":t.reject(new wo("RTCPeerConnection was closed","ERR_CONNECTION_CLOSED_BEFORE_CONNECTED"))}}}function CT(e){var t=e.split("\r\n").filter((function(e){return e.startsWith("a=candidate")})).pop(),r=null===t||void 0===t?void 0:t.split(" ");return null==t||null==r||r.length<5?(xT("could not parse remote address from",t),"/webrtc"):"/dnsaddr/".concat(r[4],"/").concat(r[2].toLowerCase(),"/").concat(r[5],"/webrtc")}var AT=zi("libp2p:webrtc:initiate-connection");function DT(e){return RT.apply(this,arguments)}function RT(){return RT=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c,l,h,f,d,p,v,g,y,m,b,_,w,k,x,E,S;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.peerConnection,n=t.signal,i=t.metrics,a=t.multiaddr,s=t.connectionManager,o=t.transportManager,u=UT(a),c=u.baseAddr,l=u.peerId,null===i||void 0===i||i.dialerEvents.increment({open:!0}),AT.trace("dialing base address: %a",c),null!=(h=c.getPeerId())){e.next=7;break}throw new wo("Relay peer was missing","ERR_INVALID_ADDRESS");case 7:if(f=s.getConnections(em(h)),p=!1,0!==f.length){e.next=16;break}return e.next=12,o.dial(c,{signal:n});case 12:d=e.sent,p=!0,e.next=17;break;case 16:d=f[0];case 17:return e.prev=17,e.next=20,d.newStream(NT,{signal:n,runOnTransientConnection:!0});case 20:return v=e.sent,g=kT(v).pb(pT),y=ts(),m=function(){y.reject(new wo("SDP handshake aborted","ERR_SDP_HANDSHAKE_ABORTED"))},e.prev=24,ST(r,y),null===n||void 0===n||n.addEventListener("abort",m),w=r.createDataChannel("init"),r.onicecandidate=function(e){var t,r=e.candidate,i=JSON.stringify(null!==(t=null===r||void 0===r?void 0:r.toJSON())&&void 0!==t?t:null);AT.trace("initiator sending ICE candidate %s",i),g.write({type:pT.Type.ICE_CANDIDATE,data:i},{signal:n}).catch((function(e){AT.error("error sending ICE candidate",e)}))},r.onicecandidateerror=function(e){AT("initiator ICE candidate error",e)},e.next=32,r.createOffer();case 32:return k=e.sent,AT.trace("initiator send SDP offer %s",k.sdp),e.next=36,g.write({type:pT.Type.SDP_OFFER,data:k.sdp},{signal:n});case 36:return e.next=38,r.setLocalDescription(k).catch((function(e){throw AT.error("could not execute setLocalDescription",e),new wo("Failed to set localDescription","ERR_SDP_HANDSHAKE_FAILED")}));case 38:return e.next=40,g.read({signal:n});case 40:if((x=e.sent).type===pT.Type.SDP_ANSWER){e.next=43;break}throw new wo("remote should send an SDP answer","ERR_SDP_HANDSHAKE_FAILED");case 43:return AT.trace("initiator receive SDP answer %s",x.data),E=new _T({type:"answer",sdp:x.data}),e.next=47,r.setRemoteDescription(E).catch((function(e){throw AT.error("could not execute setRemoteDescription",e),new wo("Failed to set remoteDescription","ERR_SDP_HANDSHAKE_FAILED")}));case 47:return AT.trace("initiator read candidates until connected"),e.next=50,ET(y,r,g,{direction:"initiator",signal:n});case 50:return AT.trace("initiator connected, closing init channel"),w.close(),AT.trace("initiator closing signalling stream"),e.next=55,g.unwrap().unwrap().close({signal:n});case 55:return S=CT(null!==(b=null===(_=r.currentRemoteDescription)||void 0===_?void 0:_.sdp)&&void 0!==b?b:""),AT.trace("initiator connected to remote address %s",S),e.abrupt("return",{remoteAddress:kb(S).encapsulate("/p2p/".concat(l.toString()))});case 60:throw e.prev=60,e.t0=e.catch(24),r.close(),v.abort(e.t0),e.t0;case 65:return e.prev=65,null===n||void 0===n||n.removeEventListener("abort",m),r.onicecandidate=null,r.onicecandidateerror=null,e.finish(65);case 70:if(e.prev=70,!p){e.next=80;break}return e.prev=72,e.next=75,d.close({signal:n});case 75:e.next=80;break;case 77:e.prev=77,e.t1=e.catch(72),d.abort(e.t1);case 80:return e.finish(70);case 81:case"end":return e.stop()}}),e,null,[[17,,70,81],[24,60,65,70],[72,77]])}))),RT.apply(this,arguments)}var TT,ZT=function(e){ia(r,e);var t=ua(r);function r(e,n){var i;return(0,hi.Z)(this,r),i=t.call(this),(0,we.Z)(ra(i),"peerId",void 0),(0,we.Z)(ra(i),"transportManager",void 0),(0,we.Z)(ra(i),"shutdownController",void 0),i.peerId=e.peerId,i.transportManager=e.transportManager,i.shutdownController=n.shutdownController,i}return(0,fi.Z)(r,[{key:"listen",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.safeDispatchEvent("listening",{});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAddrs",value:function(){var e=this;return this.transportManager.getListeners().filter((function(t){return t!==e})).map((function(t){return t.getAddrs().filter((function(e){return QC.matches(e)})).map((function(t){return t.encapsulate("/webrtc/p2p/".concat(e.peerId))}))})).flat()}},{key:"close",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.shutdownController.abort(),this.safeDispatchEvent("close",{});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),r}(Ly),IT=zi("libp2p:webrtc:signaling-stream-handler");function PT(e){return LT.apply(this,arguments)}function LT(){return LT=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c,l,h,f,d,p,v;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.peerConnection,a=t.stream,s=t.signal,o=t.connection,IT.trace("new inbound signaling stream"),u=kT(a).pb(pT),e.prev=3,c=ts(),l=ts(),s.onabort=function(){c.reject(new wo("Timed out while trying to connect","ERR_TIMEOUT"))},i.onicecandidate=function(e){var t=e.candidate;l.promise.then((0,ai.Z)((0,ii.Z)().mark((function e(){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=JSON.stringify(null!==(r=null===t||void 0===t?void 0:t.toJSON())&&void 0!==r?r:null),IT.trace("recipient sending ICE candidate %s",n),e.next=4,u.write({type:pT.Type.ICE_CANDIDATE,data:n},{signal:s});case 4:case"end":return e.stop()}}),e)}))),(function(e){IT.error("cannot set candidate since sending answer failed",e),c.reject(e)}))},ST(i,c),e.next=11,u.read({signal:s});case 11:if((h=e.sent).type===pT.Type.SDP_OFFER){e.next=14;break}throw new wo("expected message type SDP_OFFER, received: ".concat(null!==(f=h.type)&&void 0!==f?f:"undefined"," "),"ERR_SDP_HANDSHAKE_FAILED");case 14:return IT.trace("recipient receive SDP offer %s",h.data),d=new _T({type:"offer",sdp:h.data}),e.next=18,i.setRemoteDescription(d).catch((function(e){throw IT.error("could not execute setRemoteDescription",e),new wo("Failed to set remoteDescription","ERR_SDP_HANDSHAKE_FAILED")}));case 18:return e.next=20,i.createAnswer().catch((function(e){throw IT.error("could not execute createAnswer",e),l.reject(e),new wo("Failed to create answer","ERR_SDP_HANDSHAKE_FAILED")}));case 20:return p=e.sent,IT.trace("recipient send SDP answer %s",p.sdp),e.next=24,u.write({type:pT.Type.SDP_ANSWER,data:p.sdp},{signal:s});case 24:return e.next=26,i.setLocalDescription(p).catch((function(e){throw IT.error("could not execute setLocalDescription",e),l.reject(e),new wo("Failed to set localDescription","ERR_SDP_HANDSHAKE_FAILED")}));case 26:return l.resolve(),IT.trace("recipient read candidates until connected"),e.next=30,ET(c,i,u,{direction:"recipient",signal:s});case 30:return IT.trace("recipient connected, closing signaling stream"),e.next=33,u.unwrap().unwrap().close({signal:s});case 33:e.next=44;break;case 35:if(e.prev=35,e.t0=e.catch(3),"connected"===i.connectionState){e.next=43;break}throw IT.error("error while handling signaling stream from peer %a",o.remoteAddr,e.t0),i.close(),e.t0;case 43:IT("error while handling signaling stream from peer %a, ignoring as the RTCPeerConnection is already connected",o.remoteAddr,e.t0);case 44:return v=CT(null!==(r=null===(n=i.currentRemoteDescription)||void 0===n?void 0:n.sdp)&&void 0!==r?r:""),IT.trace("recipient connected to remote address %s",v),e.abrupt("return",{remoteAddress:v});case 47:case"end":return e.stop()}}),e,null,[[3,35]])}))),LT.apply(this,arguments)}var MT=zi("libp2p:webrtc:peer"),BT="/webrtc",OT="/p2p-circuit",NT="/webrtc-signaling/0.0.1";TT=Symbol.toStringTag;var FT=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,hi.Z)(this,e),(0,we.Z)(this,"components",void 0),(0,we.Z)(this,"init",void 0),(0,we.Z)(this,"_started",!1),(0,we.Z)(this,"metrics",void 0),(0,we.Z)(this,"shutdownController",void 0),(0,we.Z)(this,TT,"@libp2p/webrtc"),(0,we.Z)(this,D_,!0),this.components=t,this.init=r,this.shutdownController=new AbortController,null!=t.metrics&&(this.metrics={dialerEvents:t.metrics.registerCounterGroup("libp2p_webrtc_dialer_events_total",{label:"event",help:"Total count of WebRTC dialer events by type"}),listenerEvents:t.metrics.registerCounterGroup("libp2p_webrtc_listener_events_total",{label:"event",help:"Total count of WebRTC listener events by type"})})}return(0,fi.Z)(e,[{key:"isStarted",value:function(){return this._started}},{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.components.registrar.handle(NT,(function(e){t._onProtocol(e).catch((function(t){MT.error("failed to handle incoming connect from %p",e.connection.remotePeer,t)}))}),{runOnTransientConnection:!0});case 2:this._started=!0;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.components.registrar.unhandle(NT);case 2:this._started=!1;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createListener",value:function(e){return new ZT(this.components,{shutdownController:this.shutdownController})}},{key:"filter",value:function(e){return e.filter(lw.exactMatch)}},{key:"dial",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return MT.trace("dialing address: %a",t),i=new bT(this.init.rtcConfiguration),a=new yT({peerConnection:i,dataChannelOptions:this.init.dataChannel}),e.next=5,DT({peerConnection:i,multiaddr:t,dataChannelOptions:this.init.dataChannel,signal:r.signal,connectionManager:this.components.connectionManager,transportManager:this.components.transportManager});case 5:return s=e.sent,o=s.remoteAddress,u=new hT({peerConnection:i,timeline:{open:Date.now()},remoteAddr:o,metrics:null===(n=this.metrics)||void 0===n?void 0:n.dialerEvents}),e.next=10,r.upgrader.upgradeOutbound(u,{skipProtection:!0,skipEncryption:!0,muxerFactory:a});case 10:return c=e.sent,this._closeOnShutdown(i,u),e.abrupt("return",c);case 13:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_onProtocol",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c,l,h;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.connection,i=t.stream,a=AbortSignal.timeout(null!==(r=this.init.inboundConnectionTimeout)&&void 0!==r?r:3e4),s=new bT(this.init.rtcConfiguration),o=new yT({peerConnection:s,dataChannelOptions:this.init.dataChannel}),e.prev=4,e.next=7,PT({peerConnection:s,connection:n,stream:i,signal:a});case 7:return c=e.sent,l=c.remoteAddress,h=new hT({peerConnection:s,timeline:{open:(new Date).getTime()},remoteAddr:kb(l).encapsulate("/p2p/".concat(n.remotePeer.toString())),metrics:null===(u=this.metrics)||void 0===u?void 0:u.listenerEvents}),this._closeOnShutdown(s,h),e.next=13,this.components.upgrader.upgradeInbound(h,{skipEncryption:!0,skipProtection:!0,muxerFactory:o});case 13:return e.next=15,i.close({signal:a});case 15:e.next=21;break;case 17:throw e.prev=17,e.t0=e.catch(4),i.abort(e.t0),e.t0;case 21:case"end":return e.stop()}}),e,this,[[4,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_closeOnShutdown",value:function(e,t){var r=this,n=function(){t.close().catch((function(e){MT.error("could not close WebRTCMultiaddrConnection",e)}))};this.shutdownController.signal.addEventListener("abort",n),e.addEventListener("close",(function(){r.shutdownController.signal.removeEventListener("abort",n)}))}}]),e}();function UT(e){var t=e.toString().split(BT+"/");if(2!==t.length)throw new wo("webrtc protocol was not present in multiaddr",DR.ERR_INVALID_MULTIADDR);if(!t[0].includes(OT))throw new wo("p2p-circuit protocol was not present in multiaddr",DR.ERR_INVALID_MULTIADDR);var r=kb(t[0]),n=kb("/"+t[1]).getPeerId();if(null==n)throw new wo("destination peer id was missing",DR.ERR_INVALID_MULTIADDR);var i=r.protos().pop();if(void 0===i)throw new wo("invalid multiaddr",DR.ERR_INVALID_MULTIADDR);return"p2p"!==i.name&&(r=r.encapsulate("/p2p/".concat(n))),{baseAddr:r,peerId:em(n)}}var zT=__webpack_require__(3765);function jT(){jT=function(e,t){return new r(e,void 0,t)};var e=RegExp.prototype,t=new WeakMap;function r(e,n,i){var a=new RegExp(e,n);return t.set(a,i||t.get(e)),na(a,r.prototype)}function n(e,r){var n=t.get(r);return Object.keys(n).reduce((function(t,r){var i=n[r];if("number"==typeof i)t[r]=e[i];else{for(var a=0;void 0===e[i[a]]&&a+1<i.length;)a++;t[r]=e[i[a]]}return t}),Object.create(null))}return ia(r,RegExp),r.prototype.exec=function(t){var r=e.exec.call(this,t);if(r){r.groups=n(r,this);var i=r.indices;i&&(i.groups=n(i,this))}return r},r.prototype[Symbol.replace]=function(r,i){if("string"==typeof i){var a=t.get(this);return e[Symbol.replace].call(this,r,i.replace(/\$<([^>]+)>/g,(function(e,t){var r=a[t];return"$"+(Array.isArray(r)?r.join("$"):r)})))}if("function"==typeof i){var s=this;return e[Symbol.replace].call(this,r,(function(){var e=arguments;return"object"!=(0,oa.Z)(e[e.length-1])&&(e=[].slice.call(e)).push(n(e,s)),i.apply(this,e)}))}return e[Symbol.replace].call(this,r,i)},jT.apply(this,arguments)}var HT=zi("libp2p:webrtc:sdp"),WT=Object.values(Ms).map((function(e){return e.decoder})).reduce((function(e,t){return e.or(t)}));function qT(e){var t,r=null===(t=e.getConfiguration().certificates)||void 0===t?void 0:t.at(0);if(null==r||null==r.getFingerprints){HT.trace("fetching fingerprint from local SDP");var n=e.localDescription;if(null==n)return;return function(e){var t,r=e.match(VT);return null===r||void 0===r||null===(t=r.groups)||void 0===t?void 0:t.fingerprint}(n.sdp)}if(HT.trace("fetching fingerprint from local certificate"),0!==r.getFingerprints().length){var i=r.getFingerprints()[0].value;if(null==i)throw UR("","no fingerprint on local certificate");return i}}var VT=jT(/^a=fingerprint:(?:\w+\x2D[0-9]+)\s((:?[0-9a-fA-F]{2})+)$/m,{fingerprint:1});function KT(e){var t=e.stringTuples().filter((function(e){return e[0]===rZ})).map((function(e){return e[1]}))[0];if(void 0===t||""===t)throw BR("Couldn't find a certhash component of multiaddr: ".concat(e.toString()));return t}function YT(e){var t=WT.decode(e);return zT.decode(t)}function GT(e){switch(e){case"sha1":return"sha-1";case"sha2-256":return"sha-256";case"sha2-512":return"sha-512";default:throw new jR(e)}}function QT(e,t){var r=e.toOptions(),n=r.host,i=r.port,a=function(e){var t,r=(0,ge.Z)(e.protoNames());try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.startsWith("ip"))return n.toUpperCase()}}catch(S$){r.e(S$)}finally{r.f()}return HT("Warning: multiaddr does not appear to contain IP4 or IP6, defaulting to IP6",e),"IP6"}(e),s=function(e){var t=YT(KT(e)),r=GT(t.name),n=t.digest.reduce((function(e,t){return e+t.toString(16).padStart(2,"0")}),""),i=n.match(/.{1,2}/g);if(null==i)throw UR(n,e.toString());return["".concat(r.toUpperCase()," ").concat(i.join(":").toUpperCase()),n]}(e),o=(0,ke.Z)(s,1)[0];return"v=0\no=- 0 0 IN ".concat(a," ").concat(n,"\ns=-\nc=IN ").concat(a," ").concat(n,"\nt=0 0\na=ice-lite\nm=application ").concat(i," UDP/DTLS/SCTP webrtc-datachannel\na=mid:0\na=setup:passive\na=ice-ufrag:").concat(t,"\na=ice-pwd:").concat(t,"\na=fingerprint:").concat(o,"\na=sctp-port:5000\na=max-message-size:16384\na=candidate:1467250027 1 UDP 1467250027 ").concat(n," ").concat(i," typ host\r\n")}function XT(e,t){return{type:"answer",sdp:QT(e,t)}}function JT(e,t){if(void 0===e.sdp)throw NR("Can't munge a missing SDP");return e.sdp=e.sdp.replace(/\na=ice-ufrag:[^\n]*\n/,"\na=ice-ufrag:"+t+"\n").replace(/\na=ice-pwd:[^\n]*\n/,"\na=ice-pwd:"+t+"\n"),e}var $T,eZ=Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),tZ=zi("libp2p:webrtc:transport"),rZ=(Gm("webrtc-direct").code,Gm("certhash").code);$T=Symbol.toStringTag;var nZ=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,hi.Z)(this,e),(0,we.Z)(this,"metrics",void 0),(0,we.Z)(this,"components",void 0),(0,we.Z)(this,"init",void 0),(0,we.Z)(this,$T,"@libp2p/webrtc-direct"),(0,we.Z)(this,D_,!0),this.components=t,this.init=r,null!=t.metrics&&(this.metrics={dialerEvents:t.metrics.registerCounterGroup("libp2p_webrtc-direct_dialer_events_total",{label:"event",help:"Total count of WebRTC-direct dial events by type"})})}return(0,fi.Z)(e,[{key:"dial",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._connect(t,r);case 2:return n=e.sent,tZ("dialing address: %a",t),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"createListener",value:function(e){throw new zR("WebRTCTransport.createListener")}},{key:"filter",value:function(e){return e.filter(aw.exactMatch)}},{key:"_connect",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c,l,h,f,d,p,v,g,y,m,b,_,w,k,x,E,S,C,A,D=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=new AbortController,i=n.signal,null!==(a=t.getPeerId())){e.next=5;break}throw BR("we need to have the remote's PeerId");case 5:return s=em(a),o=YT(KT(t)),e.next=9,bT.generateCertificate({name:"ECDSA",namedCurve:"P-256",hash:GT(o.name)});case 9:return u=e.sent,c=new bT({certificates:[u]}),e.prev=11,p=new Promise((function(e,t){var r=c.createDataChannel("",{negotiated:!0,id:0}),n=setTimeout((function(){var e,n="Data channel was never opened: state: ".concat(r.readyState);tZ.error(n),null===(e=D.metrics)||void 0===e||e.dialerEvents.increment({open_error:!0}),t(LR("data",n))}),1e4);r.onopen=function(t){clearTimeout(n),e(r)},r.onerror=function(e){var r,i,a;clearTimeout(n);var s=null!==(r=null===(i=e.target)||void 0===i?void 0:i.toString())&&void 0!==r?r:"not specified",o="Error opening a data channel for handshaking: ".concat(s);tZ.error(o),null===(a=D.metrics)||void 0===a||a.dialerEvents.increment({unknown_error:!0}),t(LR("data",o))}})),v="libp2p+webrtc+v1/"+be(Array(32)).map((function(){return eZ.at(Math.floor(Math.random()*eZ.length))})).join(""),e.next=16,c.createOffer();case 16:return g=e.sent,y=JT(g,v),e.next=20,c.setLocalDescription(y);case 20:return m=XT(t,v),e.next=23,c.setRemoteDescription(m);case 23:return e.next=25,p;case 25:return b=e.sent,_=this.components.peerId,w=this.generateNoisePrologue(c,o.code,t),k=qS({prologueBytes:w})(),x=dT((0,_e.Z)({channel:b,direction:"inbound"},null!==(l=this.init.dataChannel)&&void 0!==l?l:{})),E=(0,_e.Z)((0,_e.Z)({},x),{},{sink:x.sink.bind(x),source:ea((0,ii.Z)().mark((function e(){var t,r,n,i,a,s,o,u,c;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!1,r=!1,e.prev=2,i=ui(x.source);case 4:return e.next=6,Ji(i.next());case 6:if(!(t=!(a=e.sent).done)){e.next=28;break}s=a.value,o=(0,ge.Z)(s),e.prev=9,o.s();case 11:if((u=o.n()).done){e.next=17;break}return c=u.value,e.next=15,c;case 15:e.next=11;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(9),o.e(e.t0);case 22:return e.prev=22,o.f(),e.finish(22);case 25:t=!1,e.next=4;break;case 28:e.next=34;break;case 30:e.prev=30,e.t1=e.catch(2),r=!0,n=e.t1;case 34:if(e.prev=34,e.prev=35,!t||null==i.return){e.next=39;break}return e.next=39,Ji(i.return());case 39:if(e.prev=39,!r){e.next=42;break}throw n;case 42:return e.finish(39);case 43:return e.finish(34);case 44:case"end":return e.stop()}}),e,null,[[2,30,34,44],[9,19,22,25],[35,,39,43]])})))()}),S=new hT({peerConnection:c,remoteAddr:t,timeline:{open:Date.now()},metrics:null===(h=this.metrics)||void 0===h?void 0:h.dialerEvents}),C=aT?"iceconnectionstatechange":"connectionstatechange",c.addEventListener(C,(function(){switch(c.connectionState){case"failed":case"disconnected":case"closed":S.close().catch((function(e){tZ.error("error closing connection",e)})).finally((function(){n.abort()}))}}),{signal:i}),null===(f=this.metrics)||void 0===f||f.dialerEvents.increment({peer_connection:!0}),A=new yT({peerConnection:c,metrics:null===(d=this.metrics)||void 0===d?void 0:d.dialerEvents,dataChannelOptions:this.init.dataChannel}),e.next=38,k.secureInbound(_,E,s);case 38:return e.next=40,r.upgrader.upgradeOutbound(S,{skipProtection:!0,skipEncryption:!0,muxerFactory:A});case 40:return e.abrupt("return",e.sent);case 43:throw e.prev=43,e.t0=e.catch(11),c.close(),e.t0;case 47:case"end":return e.stop()}}),e,this,[[11,43]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"generateNoisePrologue",value:function(e,t,r){var n;if(0===(null===(n=e.getConfiguration().certificates)||void 0===n?void 0:n.length))throw NR("no local certificate");var i=qT(e);if(null==i)throw NR("no local fingerprint found");var a=Hs(i.trim().toLowerCase().replaceAll(":",""),"hex"),s=zT.encode(a,t),o=WT.decode(KT(r));return Eu([Hs("libp2p-webrtc-noise:"),s,o])}}]),e}();function iZ(e){return function(t){return new nZ(t,e)}}function aZ(e){return function(t){return new FT(t,e)}}function sZ(e){var t;try{t=Gm("sni").code}catch(o){return null}var r,n=(0,ge.Z)(e);try{for(n.s();!(r=n.n()).done;){var i=(0,ke.Z)(r.value,2),a=i[0],s=i[1];if(a===t&&void 0!==s)return s}}catch(S$){n.e(S$)}finally{n.f()}return null}function oZ(e){return e.some((function(e){var t=(0,ke.Z)(e,2),r=t[0];t[1];return r===Gm("tls").code}))}function uZ(e,t,r){var n=cZ[Gm(e).name];if(void 0===n)throw new Error("Can't interpret protocol ".concat(Gm(e).name));var i=n(t,r);return e===Gm("ip6").code?"[".concat(i,"]"):i}var cZ={ip4:function(e,t){return e},ip6:function(e,t){return 0===t.length?e:"[".concat(e,"]")},tcp:function(e,t){var r,n=t.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return"tcp://".concat(uZ(n[0],null!==(r=n[1])&&void 0!==r?r:"",t),":").concat(e)},udp:function(e,t){var r,n=t.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return"udp://".concat(uZ(n[0],null!==(r=n[1])&&void 0!==r?r:"",t),":").concat(e)},dnsaddr:function(e,t){return e},dns4:function(e,t){return e},dns6:function(e,t){return e},dns:function(e,t){return e},ipfs:function(e,t){var r,n=t.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return"".concat(uZ(n[0],null!==(r=n[1])&&void 0!==r?r:"",t),"/ipfs/").concat(e)},p2p:function(e,t){var r,n=t.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return"".concat(uZ(n[0],null!==(r=n[1])&&void 0!==r?r:"",t),"/p2p/").concat(e)},http:function(e,t){var r,n=oZ(t),i=sZ(t);if(n&&null!==i)return"https://".concat(i);var a=n?"https://":"http://",s=t.pop();if(void 0===s)throw new Error("Unexpected end of multiaddr");var o=uZ(s[0],null!==(r=s[1])&&void 0!==r?r:"",t);return o=o.replace("tcp://",""),"".concat(a).concat(o)},tls:function(e,t){var r,n=t.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return uZ(n[0],null!==(r=n[1])&&void 0!==r?r:"",t)},sni:function(e,t){var r,n=t.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return uZ(n[0],null!==(r=n[1])&&void 0!==r?r:"",t)},https:function(e,t){var r,n=t.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");var i=uZ(n[0],null!==(r=n[1])&&void 0!==r?r:"",t);return i=i.replace("tcp://",""),"https://".concat(i)},ws:function(e,t){var r,n=oZ(t),i=sZ(t);if(n&&null!==i)return"wss://".concat(i);var a=n?"wss://":"ws://",s=t.pop();if(void 0===s)throw new Error("Unexpected end of multiaddr");var o=uZ(s[0],null!==(r=s[1])&&void 0!==r?r:"",t);return o=o.replace("tcp://",""),"".concat(a).concat(o)},wss:function(e,t){var r,n=t.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");var i=uZ(n[0],null!==(r=n[1])&&void 0!==r?r:"",t);return i=i.replace("tcp://",""),"wss://".concat(i)},"p2p-websocket-star":function(e,t){var r,n=t.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return"".concat(uZ(n[0],null!==(r=n[1])&&void 0!==r?r:"",t),"/p2p-websocket-star")},"p2p-webrtc-star":function(e,t){var r,n=t.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return"".concat(uZ(n[0],null!==(r=n[1])&&void 0!==r?r:"",t),"/p2p-webrtc-star")},"p2p-webrtc-direct":function(e,t){var r,n=t.pop();if(void 0===n)throw new Error("Unexpected end of multiaddr");return"".concat(uZ(n[0],null!==(r=n[1])&&void 0!==r?r:"",t),"/p2p-webrtc-direct")}};function lZ(e,t){var r,n=kb(e).stringTuples(),i=n.pop();if(void 0===i)throw new Error("Unexpected end of multiaddr");var a=Gm(i[0]),s=cZ[a.name];if(null==s)throw new Error("No interpreter found for ".concat(a.name));var o=s(null!==(r=i[1])&&void 0!==r?r:"",n);return!1!==(null===t||void 0===t?void 0:t.assumeHttp)&&i[0]===Gm("tcp").code&&(o=o.replace("tcp://","http://"),"443"!==i[1]&&"80"!==i[1]||("443"===i[1]&&(o=o.replace("http://","https://")),o=o.substring(0,o.lastIndexOf(":")))),o}var hZ=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.readyState>=2)){e.next=2;break}throw new Error("socket closed");case 2:if(1!==t.readyState){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,new Promise((function(e,r){function n(){t.removeEventListener("open",i),t.removeEventListener("error",a)}function i(){n(),e()}function a(e){var i;n(),r(null!==(i=e.error)&&void 0!==i?i:new Error("connect ECONNREFUSED ".concat(t.url)))}t.addEventListener("open",i),t.addEventListener("error",a)}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fZ=function(e,t){var r;(t=null!==(r=t)&&void 0!==r?r:{}).closeOnEnd=!1!==t.closeOnEnd;var n=function(){var r=(0,ai.Z)((0,ii.Z)().mark((function r(n){var i,a,s,o,u,c;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:i=!1,a=!1,r.prev=2,o=ui(n);case 4:return r.next=6,o.next();case 6:if(!(i=!(u=r.sent).done)){r.next=24;break}return c=u.value,r.prev=8,r.next=11,hZ(e);case 11:r.next=18;break;case 13:if(r.prev=13,r.t0=r.catch(8),"socket closed"!==r.t0.message){r.next=17;break}return r.abrupt("break",24);case 17:throw r.t0;case 18:if(e.readyState!==e.CLOSING&&e.readyState!==e.CLOSED){r.next=20;break}return r.abrupt("break",24);case 20:e.send(c);case 21:i=!1,r.next=4;break;case 24:r.next=30;break;case 26:r.prev=26,r.t1=r.catch(2),a=!0,s=r.t1;case 30:if(r.prev=30,r.prev=31,!i||null==o.return){r.next=35;break}return r.next=35,o.return();case 35:if(r.prev=35,!a){r.next=38;break}throw s;case 38:return r.finish(35);case 39:return r.finish(30);case 40:if(!(null!=t.closeOnEnd&&e.readyState<=1)){r.next=43;break}return r.next=43,new Promise((function(t,r){e.addEventListener("close",(function(e){if(e.wasClean||1006===e.code)t();else{var n=Object.assign(new Error("ws error"),{event:e});r(n)}})),setTimeout((function(){e.close()}))}));case 43:case"end":return r.stop()}}),r,null,[[2,26,30,40],[8,13],[31,,35,39]])})));return function(e){return r.apply(this,arguments)}}();return n},dZ=__webpack_require__(3634);function pZ(e){var t;return e instanceof ArrayBuffer||"ArrayBuffer"===(null===e||void 0===e||null===(t=e.constructor)||void 0===t?void 0:t.name)&&"number"===typeof(null===e||void 0===e?void 0:e.byteLength)}var vZ=function(e,t){var r;t=null!==(r=t)&&void 0!==r?r:{};var n=function(e){e.binaryType="arraybuffer";var t,r=function(){var r=(0,ai.Z)((0,ii.Z)().mark((function r(){return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,new Promise((function(r,n){if(i)r();else if(null==t){var a=function(t){e.removeEventListener("open",s),e.removeEventListener("error",o),t()},s=function(){a(r)},o=function(t){a((function(){var r;n(null!==(r=t.error)&&void 0!==r?r:new Error("connect ECONNREFUSED ".concat(e.url)))}))};e.addEventListener("open",s),e.addEventListener("error",o)}else n(t)}));case 2:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),n=ea((0,ii.Z)().mark((function t(){var n,i,a,s,o,u,c;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new dZ.zN((function(t){var r=t.push,n=t.stop,i=t.fail,a=function(e){var t=null;"string"===typeof e.data&&(t=Hs(e.data)),pZ(e.data)&&(t=new Uint8Array(e.data)),e.data instanceof Uint8Array&&(t=e.data),null!=t&&r(t)},s=function(e){var t;i(null!==(t=e.error)&&void 0!==t?t:new Error("Socket error"))};return e.addEventListener("message",a),e.addEventListener("error",s),e.addEventListener("close",n),function(){e.removeEventListener("message",a),e.removeEventListener("error",s),e.removeEventListener("close",n)}}),{highWaterMark:1/0}),t.next=3,Ji(r());case 3:i=!1,a=!1,t.prev=5,o=ui(n);case 7:return t.next=9,Ji(o.next());case 9:if(!(i=!(u=t.sent).done)){t.next=16;break}return c=u.value,t.next=13,pZ(c)?new Uint8Array(c):c;case 13:i=!1,t.next=7;break;case 16:t.next=22;break;case 18:t.prev=18,t.t0=t.catch(5),a=!0,s=t.t0;case 22:if(t.prev=22,t.prev=23,!i||null==o.return){t.next=27;break}return t.next=27,Ji(o.return());case 27:if(t.prev=27,!a){t.next=30;break}throw s;case 30:return t.finish(27);case 31:return t.finish(22);case 32:case"end":return t.stop()}}),t,null,[[5,18,22,32],[23,,27,31]])})))(),i=1===e.readyState;return e.addEventListener("open",(function(){i=!0,t=null})),e.addEventListener("close",(function(){i=!1,t=null})),e.addEventListener("error",(function(r){var n;i||(t=null!==(n=r.error)&&void 0!==n?n:new Error("connect ECONNREFUSED ".concat(e.url)))})),Object.assign(n,{connected:r})}(e),i=t.remoteAddress,a=t.remotePort;if(null!=e.url)try{var s=new URL(e.url);i=s.hostname,a=parseInt(s.port,10)}catch(u){}if(null==i||null==a)throw new Error("Remote connection did not have address and/or port");var o={sink:fZ(e,t),source:n,connected:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.connected();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),close:function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(){return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.readyState!==e.CONNECTING&&e.readyState!==e.OPEN){t.next=3;break}return t.next=3,new Promise((function(t){e.addEventListener("close",(function(){t()})),e.close()}));case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),destroy:function(){null!=e.terminate?e.terminate():e.close()},remoteAddress:i,remotePort:a,socket:e};return o},gZ=WebSocket,yZ=__webpack_require__(6791),mZ={http:"ws",https:"wss"};function bZ(e,t){var r;t=null!==(r=t)&&void 0!==r?r:{};var n=function(e,t){return(0,yZ.relative)(e,t,mZ,"ws")}(e,("undefined"===typeof window?"":window.location).toString()),i=new gZ(n,t.websocket);return vZ(i,t)}var _Z=__webpack_require__(2193),wZ="object"===typeof window&&"object"===typeof document&&9===document.nodeType,kZ=_Z(),xZ=wZ&&!kZ,EZ=kZ&&!wZ,SZ=kZ&&wZ,CZ="undefined"!==typeof globalThis.process&&"undefined"!==typeof globalThis.process.release&&"node"===globalThis.process.release.name&&!kZ,AZ="function"===typeof importScripts&&"undefined"!==typeof self&&"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,DZ=("undefined"!==typeof globalThis.process&&"undefined"!==typeof globalThis.process.env&&globalThis.process.env.NODE_ENV,"undefined"!==typeof navigator&&"ReactNative"===navigator.product),RZ=421,TZ=290;function ZZ(e){return e.filter((function(e){if(e.protoCodes().includes(TZ))return!1;var t=e.decapsulateCode(RZ);return BC.matches(t)||NC.matches(t)}))}var IZ,PZ=zi("libp2p:websockets:socket");function LZ(e,t,r){var n,i={sink:function(t){return(0,ai.Z)((0,ii.Z)().mark((function n(){var i;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return null!=(null===(i=r)||void 0===i?void 0:i.signal)&&(t=Sk(t,r.signal)),n.prev=1,n.next=4,e.sink(t);case 4:n.next=9;break;case 6:n.prev=6,n.t0=n.catch(1),"aborted"!==n.t0.type&&PZ.error(n.t0);case 9:case"end":return n.stop()}}),n,null,[[1,6]])})))()},source:null!=(r=null!==(n=r)&&void 0!==n?n:{}).signal?Sk(e.source,r.signal):e.source,remoteAddr:t,timeline:{open:Date.now()},close:function(){var t=arguments,r=this;return(0,ai.Z)((0,ii.Z)().mark((function n(){var a,s,o,u;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=t.length>0&&void 0!==t[0]?t[0]:{},o=Date.now(),s.signal=null!==(a=s.signal)&&void 0!==a?a:AbortSignal.timeout(500),u=function(){var e=i.remoteAddr.toOptions(),t=e.host,n=e.port;PZ("timeout closing stream to %s:%s after %dms, destroying it manually",t,n,Date.now()-o),r.abort(new wo("Socket close timeout","ERR_SOCKET_CLOSE_TIMEOUT"))},s.signal.addEventListener("abort",u),n.prev=5,n.next=8,e.close();case 8:n.next=14;break;case 10:n.prev=10,n.t0=n.catch(5),PZ.error("error closing WebSocket gracefully",n.t0),r.abort(n.t0);case 14:return n.prev=14,s.signal.removeEventListener("abort",u),i.timeline.close=Date.now(),n.finish(14);case 18:case"end":return n.stop()}}),n,null,[[5,10,14,18]])})))()},abort:function(t){var r=i.remoteAddr.toOptions(),n=r.host,a=r.port;PZ("timeout closing stream to %s:%s due to error",n,a,t),e.destroy(),i.timeline.close=Date.now()}};return e.socket.addEventListener("close",(function(){null==i.timeline.close&&(i.timeline.close=Date.now())}),{once:!0}),i}var MZ=zi("libp2p:websockets");IZ=Symbol.toStringTag;var BZ=function(){function e(t){(0,hi.Z)(this,e),(0,we.Z)(this,"init",void 0),(0,we.Z)(this,IZ,"@libp2p/websockets"),(0,we.Z)(this,D_,!0),this.init=t}return(0,fi.Z)(e,[{key:"dial",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return MZ("dialing %s",t),r=null!==(n=r)&&void 0!==n?n:{},e.next=4,this._connect(t,r);case 4:return i=e.sent,a=LZ(i,t),MZ("new outbound connection %s",a.remoteAddr),e.next=9,r.upgrader.upgradeOutbound(a);case 9:return s=e.sent,MZ("outbound connection %s upgraded",a.remoteAddr),e.abrupt("return",s);case 12:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_connect",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==(null===r||void 0===r||null===(n=r.signal)||void 0===n?void 0:n.aborted)){e.next=2;break}throw new _o;case 2:if(i=t.toOptions(),MZ("dialing %s:%s",i.host,i.port),a=ts(),(s=bZ(lZ(t),this.init)).socket.addEventListener("error",(function(){var e=new wo("Could not connect to ".concat(t.toString()),"ERR_CONNECTION_FAILED");MZ.error("connection error:",e),a.reject(e)})),null!=r.signal){e.next=12;break}return e.next=10,Promise.race([s.connected(),a.promise]);case 10:case 19:return MZ("connected %s",t),e.abrupt("return",s);case 12:return u=new Promise((function(e,t){var n,i;o=function(){t(new _o),s.close().catch((function(e){MZ.error("error closing raw socket",e)}))},!0!==(null===r||void 0===r||null===(n=r.signal)||void 0===n?void 0:n.aborted)?null===r||void 0===r||null===(i=r.signal)||void 0===i||i.addEventListener("abort",o):o()})),e.prev=13,e.next=16,Promise.race([u,a.promise,s.connected()]);case 16:return e.prev=16,null!=o&&(null===r||void 0===r||null===(c=r.signal)||void 0===c||c.removeEventListener("abort",o)),e.finish(16);case 21:case"end":return e.stop()}}),e,this,[[13,,16,19]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"createListener",value:function(e){return function(){throw new Error("WebSocket Servers can not be created in the browser!")}((0,_e.Z)((0,_e.Z)({},this.init),e))}},{key:"filter",value:function(e){var t,r;return e=Array.isArray(e)?e:[e],null!=(null===(t=this.init)||void 0===t?void 0:t.filter)?null===(r=this.init)||void 0===r?void 0:r.filter(e):xZ||AZ?function(e){return e.filter((function(e){if(e.protoCodes().includes(TZ))return!1;var t=e.decapsulateCode(RZ);return NC.matches(t)}))}(e):ZZ(e)}}]),e}();function OZ(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(){return new BZ(e)}}var NZ=zi("libp2p:webtransport:stream");function FZ(e,t,r,n,i){return UZ.apply(this,arguments)}function UZ(){return UZ=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i,a){var s,o,u,c,l,h,f;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=function(){var e=i.findIndex((function(e){return e===f}));-1!==e&&(i.splice(e,1),f.timeline.close=Date.now(),null===a||void 0===a||a(f))},s=t.writable.getWriter(),o=t.readable.getReader(),e.next=5,s.ready;case 5:return c=!1,l=!1,(0,ai.Z)((0,ii.Z)().mark((function e(){var t,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.closed.catch((function(e){return e}));case 2:null!=(t=e.sent)&&((n=t.message).includes("aborted by the remote server")||n.includes("STOP_SENDING")||NZ.error("WebTransport writer closed unexpectedly: streamId=".concat(r," err=").concat(t.message))),(c=!0)&&l&&u();case 6:case"end":return e.stop()}}),e)})))().catch((function(){NZ.error("WebTransport failed to cleanup closed stream")})),(0,ai.Z)((0,ii.Z)().mark((function e(){var t;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.closed.catch((function(e){return e}));case 2:null!=(t=e.sent)&&NZ.error("WebTransport reader closed unexpectedly: streamId=".concat(r," err=").concat(t.message)),l=!0,c&&l&&u();case 6:case"end":return e.stop()}}),e)})))().catch((function(){NZ.error("WebTransport failed to cleanup closed stream")})),h=!1,f={id:r,status:"open",writeStatus:"ready",readStatus:"ready",abort:function(e){c||(s.abort(e).catch((function(e){NZ.error("could not abort stream",e)})),c=!0),l=!0,this.status="aborted",this.writeStatus="closed",this.readStatus="closed",this.timeline.reset=this.timeline.close=this.timeline.closeRead=this.timeline.closeWrite=Date.now(),u()},close:function(e){var t=this;return(0,ai.Z)((0,ii.Z)().mark((function r(){return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.status="closing",r.next=3,Promise.all([f.closeRead(e),f.closeWrite(e)]);case 3:u(),t.status="closed",t.timeline.close=Date.now();case 6:case"end":return r.stop()}}),r)})))()},closeRead:function(e){var t=this;return(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l){e.next=13;break}return t.readStatus="closing",e.prev=2,e.next=5,o.cancel();case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),!0===e.t0.toString().includes("RESET_STREAM")&&(c=!0);case 10:t.timeline.closeRead=Date.now(),t.readStatus="closed",l=!0;case 13:c&&u();case 14:case"end":return e.stop()}}),e,null,[[2,7]])})))()},closeWrite:function(e){var t=this;return(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c){e.next=13;break}return c=!0,t.writeStatus="closing",e.prev=3,e.next=6,s.close();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),!0===e.t0.toString().includes("RESET_STREAM")&&(l=!0);case 11:t.timeline.closeWrite=Date.now(),t.writeStatus="closed";case 13:l&&u();case 14:case"end":return e.stop()}}),e,null,[[3,8]])})))()},direction:n,timeline:{open:Date.now()},metadata:{},source:ea((0,ii.Z)().mark((function e(){var t;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,Ji(o.read());case 3:if(!(t=e.sent).done){e.next=8;break}return l=!0,c&&u(),e.abrupt("return");case 8:return e.next=10,new Du(t.value);case 10:e.next=0;break;case 12:case"end":return e.stop()}}),e)})))(),sink:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,o,u,c,l,d;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!h){e.next=2;break}throw new Error("sink already called on stream");case 2:h=!0,e.prev=3,this.writeStatus="writing",r=!1,n=!1,e.prev=7,a=ui(t);case 9:return e.next=11,a.next();case 11:if(!(r=!(o=e.sent).done)){e.next=38;break}if(!((u=o.value)instanceof Uint8Array)){e.next=18;break}return e.next=16,s.write(u);case 16:e.next=35;break;case 18:c=(0,ge.Z)(u),e.prev=19,c.s();case 21:if((l=c.n()).done){e.next=27;break}return d=l.value,e.next=25,s.write(d);case 25:e.next=21;break;case 27:e.next=32;break;case 29:e.prev=29,e.t0=e.catch(19),c.e(e.t0);case 32:return e.prev=32,c.f(),e.finish(32);case 35:r=!1,e.next=9;break;case 38:e.next=44;break;case 40:e.prev=40,e.t1=e.catch(7),n=!0,i=e.t1;case 44:if(e.prev=44,e.prev=45,!r||null==a.return){e.next=49;break}return e.next=49,a.return();case 49:if(e.prev=49,!n){e.next=52;break}throw i;case 52:return e.finish(49);case 53:return e.finish(44);case 54:this.writeStatus="done";case 55:return e.prev=55,this.timeline.closeWrite=Date.now(),this.writeStatus="closed",e.next=60,f.closeWrite();case 60:return e.finish(55);case 61:case"end":return e.stop()}}),e,this,[[3,,55,61],[7,40,44,54],[19,29,32,35],[45,,49,53]])})));return function(t){return e.apply(this,arguments)}}()},e.abrupt("return",f);case 12:case"end":return e.stop()}}),e)}))),UZ.apply(this,arguments)}function zZ(){return{source:(0,we.Z)({},Symbol.asyncIterator,(function(){return{next:function(){return(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(){})));case 1:case"end":return e.stop()}}),e)})))()}}})),sink:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(){})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}function jZ(e,t){return t.filter((function(t){return Boolean(e.find((function(e){return Ao(t,e)})))})).length===t.length}var HZ,WZ=Object.values(Ms).map((function(e){return e.decoder})).reduce((function(e,t){return e.or(t)}));function qZ(e){var t;if(!ow.matches(e))throw new wo("Invalid multiaddr, was not a WebTransport address","ERR_INVALID_MULTIADDR");var r=e.stringTuples(),n=r.filter((function(e){var t=(0,ke.Z)(e,2),r=t[0];t[1];return r===Gm("certhash").code})).map((function(e){var t,r=(0,ke.Z)(e,2),n=(r[0],r[1]);return t=null!==n&&void 0!==n?n:"",Za(WZ.decode(t))})),i=r.filter((function(e){var t=(0,ke.Z)(e,2),r=t[0];t[1];return r===Gm("p2p").code})).map((function(e){var t=(0,ke.Z)(e,2),r=(t[0],t[1]);return em(null!==r&&void 0!==r?r:"")}))[0],a=e.toOptions(),s=a.host;return 6===a.family&&null!==(t=s)&&void 0!==t&&t.includes(":")&&(s="[".concat(s,"]")),{url:"https://".concat(s,":").concat(a.port),certhashes:n,remotePeer:i}}var VZ=zi("libp2p:webtransport");HZ=Symbol.toStringTag;var KZ=function(){function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,hi.Z)(this,e),(0,we.Z)(this,"components",void 0),(0,we.Z)(this,"config",void 0),(0,we.Z)(this,"metrics",void 0),(0,we.Z)(this,HZ,"@libp2p/webtransport"),(0,we.Z)(this,D_,!0),this.components=t,this.config={maxInboundStreams:null!==(r=n.maxInboundStreams)&&void 0!==r?r:1e3},null!=t.metrics&&(this.metrics={dialerEvents:t.metrics.registerCounterGroup("libp2p_webtransport_dialer_events_total",{label:"event",help:"Total count of WebTransport dialer events by type"})})}return(0,fi.Z)(e,[{key:"dial",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c,l,h,f,d,p,v,g,y,m,b,_,w,k=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=r)||void 0===n||null===(n=n.signal)||void 0===n||n.throwIfAborted(),VZ("dialing %s",t),void 0!==(a=this.components.peerId)){e.next=5;break}throw new Error("Need a local peerid");case 5:if(r=null!==(i=r)&&void 0!==i?i:{},s=qZ(t),o=s.url,u=s.certhashes,null!=(c=s.remotePeer)){e.next=9;break}throw new Error("Need a target peerid");case 9:if(0!==u.length){e.next=11;break}throw new Error("Expected multiaddr to contain certhashes");case 11:return f=function(){},d=!1,p=!1,v=!1,e.prev=15,null===(g=this.metrics)||void 0===g||g.dialerEvents.increment({pending:!0}),_=new WebTransport("".concat(o,"/.well-known/libp2p-webtransport?type=noise"),{serverCertificateHashes:u.map((function(e){return{algorithm:"sha-256",value:e.digest}}))}),f=function(e){if(!d)try{var t;null===(t=k.metrics)||void 0===t||t.dialerEvents.increment((0,we.Z)({},e,!0)),_.close()}catch(S$){VZ.error("error closing wt session",S$)}finally{null!=h&&(h.timeline.close=Date.now()),d=!0}},l=function(){f(p?"noise_timeout":"ready_timeout")},null===(y=r.signal)||void 0===y||y.addEventListener("abort",l,{once:!0}),e.next=23,Promise.race([_.closed,_.ready]);case 23:return p=!0,null===(m=this.metrics)||void 0===m||m.dialerEvents.increment({ready:!0}),_.closed.catch((function(e){VZ.error("error on remote wt session close",e)})).finally((function(){f("remote_close")})),e.next=28,this.authenticateWebTransport(_,a,c,u);case 28:if(e.sent){e.next=30;break}throw new Error("Failed to authenticate webtransport");case 30:return null===(b=this.metrics)||void 0===b||b.dialerEvents.increment({open:!0}),h=(0,_e.Z)({close:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:VZ("Closing webtransport"),f("close");case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),abort:function(e){VZ("aborting webtransport due to passed err",e),f("abort")},remoteAddr:t,timeline:{open:Date.now()}},zZ()),v=!0,e.next=35,r.upgrader.upgradeOutbound(h,{skipEncryption:!0,muxerFactory:this.webtransportMuxer(_),skipProtection:!0});case 35:return e.abrupt("return",e.sent);case 38:throw e.prev=38,e.t0=e.catch(15),VZ.error("caught wt session err",e.t0),f(v?"upgrade_error":p?"noise_error":"ready_error"),e.t0;case 43:return e.prev=43,null!=l&&(null===(w=r.signal)||void 0===w||w.removeEventListener("abort",l)),e.finish(43);case 46:case"end":return e.stop()}}),e,this,[[15,38,43,46]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"authenticateWebTransport",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i){var a,s,o,u,c,l,h,f;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.createBidirectionalStream();case 2:return s=e.sent,o=s.writable.getWriter(),u=s.readable.getReader(),e.next=7,o.ready;case 7:return c={source:ea((0,ii.Z)().mark((function e(){var t;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,Ji(u.read());case 3:if(null==(t=e.sent).value){e.next=7;break}return e.next=7,t.value;case 7:if(!t.done){e.next=9;break}return e.abrupt("break",11);case 9:e.next=0;break;case 11:case"end":return e.stop()}}),e)})))(),sink:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,u;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!1,n=!1,e.prev=2,a=ui(t);case 4:return e.next=6,a.next();case 6:if(!(r=!(s=e.sent).done)){e.next=13;break}return u=s.value,e.next=10,o.write(u);case 10:r=!1,e.next=4;break;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),n=!0,i=e.t0;case 19:if(e.prev=19,e.prev=20,!r||null==a.return){e.next=24;break}return e.next=24,a.return();case 24:if(e.prev=24,!n){e.next=27;break}throw i;case 27:return e.finish(24);case 28:return e.finish(19);case 29:case"end":return e.stop()}}),e,null,[[2,15,19,29],[20,,24,28]])})));return function(t){return e.apply(this,arguments)}}()},l=qS()(),e.next=11,l.secureOutbound(r,c,n);case 11:if(h=e.sent,f=h.remoteExtensions,o.close().catch((function(e){VZ.error("Failed to close authentication stream writer: ".concat(e.message))})),u.cancel().catch((function(e){VZ.error("Failed to close authentication stream reader: ".concat(e.message))})),jZ(null!==(a=null===f||void 0===f?void 0:f.webtransportCerthashes)&&void 0!==a?a:[],i.map((function(e){return e.bytes})))){e.next=17;break}throw new Error("Our certhashes are not a subset of the remote's reported certhashes");case 17:return e.abrupt("return",!0);case 18:case"end":return e.stop()}}),e)})));return function(t,r,n,i){return e.apply(this,arguments)}}()},{key:"webtransportMuxer",value:function(e){var t=0,r=this.config;return{protocol:"webtransport",createStreamMuxer:function(n){"function"===typeof n&&(n={onIncomingStream:n});var i=[];(0,ai.Z)((0,ii.Z)().mark((function a(){var s,o,u,c,l,h,f,d,p;return(0,ii.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:s=e.incomingBidirectionalStreams.getReader();case 1:return a.next=4,s.read();case 4:if(o=a.sent,u=o.done,c=o.value,!u){a.next=9;break}return a.abrupt("break",21);case 9:if(!(i.length>=r.maxInboundStreams)){a.next=14;break}c.writable.close().catch((function(e){VZ.error("Failed to close inbound stream that crossed our maxInboundStream limit: ".concat(e.message))})),c.readable.cancel().catch((function(e){VZ.error("Failed to close inbound stream that crossed our maxInboundStream limit: ".concat(e.message))})),a.next=19;break;case 14:return a.next=16,FZ(c,String(t++),"inbound",i,null===(l=n)||void 0===l?void 0:l.onStreamEnd);case 16:p=a.sent,i.push(p),null===(h=n)||void 0===h||null===(f=(d=h).onIncomingStream)||void 0===f||f.call(d,p);case 19:a.next=1;break;case 21:case"end":return a.stop()}}),a)})))().catch((function(){VZ.error("WebTransport failed to receive incoming stream")}));var a=(0,_e.Z)({protocol:"webtransport",streams:i,newStream:function(){var r=(0,ai.Z)((0,ii.Z)().mark((function r(a){var s,o,u,c,l;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.createBidirectionalStream();case 2:return c=r.sent,r.next=5,FZ(c,String(t++),null!==(s=null===(o=n)||void 0===o?void 0:o.direction)&&void 0!==s?s:"outbound",i,null===(u=n)||void 0===u?void 0:u.onStreamEnd);case 5:return l=r.sent,i.push(l),r.abrupt("return",l);case 8:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),close:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return VZ("Closing webtransport muxer"),e.next=3,Promise.all(i.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(r){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.close(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),abort:function(e){VZ("Aborting webtransport muxer with err:",e);for(var t=0,r=i;t<r.length;t++){r[t].abort(e)}}},zZ());return a}}}},{key:"createListener",value:function(e){throw new Error("Webtransport servers are not supported in Node or the browser")}},{key:"filter",value:function(e){return e.filter(ow.exactMatch)}}]),e}();function YZ(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){return new KZ(t,e)}}var GZ,QZ=__webpack_require__(8974),XZ="ERR_UNRECOGNIZED_VALIDITY",JZ="ERR_SIGNATURE_VERIFICATION",$Z="ERR_UNRECOGNIZED_FORMAT",eI="ERR_UNDEFINED_PARAMETER",tI="ERR_RECORD_TOO_LARGE";!function(e){var t,r;!function(e){e.EOL="EOL"}(e.ValidityType||(e.ValidityType={})),function(e){e[e.EOL=0]="EOL"}(t||(t={})),function(e){e.codec=function(){return Qo(t)}}(e.ValidityType||(e.ValidityType={})),e.codec=function(){return null==r&&(r=Xo((function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&r.fork(),null!=t.value&&(r.uint32(10),r.bytes(t.value)),null!=t.signatureV1&&(r.uint32(18),r.bytes(t.signatureV1)),null!=t.validityType&&(r.uint32(24),e.ValidityType.codec().encode(t.validityType,r)),null!=t.validity&&(r.uint32(34),r.bytes(t.validity)),null!=t.sequence&&(r.uint32(40),r.uint64(t.sequence)),null!=t.ttl&&(r.uint32(48),r.uint64(t.ttl)),null!=t.pubKey&&(r.uint32(58),r.bytes(t.pubKey)),null!=t.signatureV2&&(r.uint32(66),r.bytes(t.signatureV2)),null!=t.data&&(r.uint32(74),r.bytes(t.data)),!1!==n.lengthDelimited&&r.ldelim()}),(function(t,r){for(var n={},i=null==r?t.len:t.pos+r;t.pos<i;){var a=t.uint32();switch(a>>>3){case 1:n.value=t.bytes();break;case 2:n.signatureV1=t.bytes();break;case 3:n.validityType=e.ValidityType.codec().decode(t);break;case 4:n.validity=t.bytes();break;case 5:n.sequence=t.uint64();break;case 6:n.ttl=t.uint64();break;case 7:n.pubKey=t.bytes();break;case 8:n.signatureV2=t.bytes();break;case 9:n.data=t.bytes();break;default:t.skipType(7&a)}}return n}))),r},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(GZ||(GZ={}));var rI=zi("ipns:utils"),nI=Hs("/ipns/");var iI=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=r&&null!=t){e.next=4;break}throw n=new Error("one or more of the provided parameters are not defined"),rI.error(n),ji(n,eI);case 4:if(null==r.pubKey){e.next=20;break}e.prev=5,i=Ey(r.pubKey),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(5),rI.error(e.t0),e.t0;case 13:return e.next=15,rm(r.pubKey);case 15:if(e.sent.equals(t)){e.next=18;break}throw ji(new Error("Embedded public key did not match PeerID"),"ERR_INVALID_EMBEDDED_KEY");case 18:e.next=21;break;case 20:null!=t.publicKey&&(i=Ey(t.publicKey));case 21:if(null==i){e.next=23;break}return e.abrupt("return",i);case 23:throw ji(new Error("no public key is available"),eI);case 24:case"end":return e.stop()}}),e,null,[[5,9]])})));return function(t,r){return e.apply(this,arguments)}}();function aI(e){var t=GZ.decode(e);if(null!=t.sequence&&(t.sequence=BigInt(t.sequence)),null!=t.ttl&&(t.ttl=BigInt(t.ttl)),null==t.signatureV2||null==t.data)throw ji(new Error("missing data or signatureV2"),JZ);var r,n=oI(t.data),i=uI(n.Value);try{r=QZ.fromDate(function(e){var t=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),r=String(e).trim().match(t);if(null==r)throw new Error("Invalid format");var n=parseInt(r[1],10),i=parseInt(r[2],10)-1,a=parseInt(r[3],10),s=parseInt(r[4],10),o=parseInt(r[5],10),u=parseInt(r[6],10),c=parseInt(r[7].padEnd(6,"0").slice(0,3),10);return new Date(Date.UTC(n,i,a,s,o,u,c))}(Ws(n.Validity)))}catch(a){throw rI.error("unrecognized validity format (not an rfc3339 format)"),ji(new Error("unrecognized validity format (not an rfc3339 format)"),$Z)}if(null!=t.value&&null!=t.signatureV1)return cI(t),{value:i,validityType:GZ.ValidityType.EOL,validity:r,sequence:n.Sequence,ttl:n.TTL,pubKey:t.pubKey,signatureV1:t.signatureV1,signatureV2:t.signatureV2,data:t.data};if(null!=t.signatureV2)return{value:i,validityType:GZ.ValidityType.EOL,validity:r,sequence:n.Sequence,ttl:n.TTL,pubKey:t.pubKey,signatureV2:t.signatureV2,data:t.data};throw new Error("invalid record: does not include signatureV1 or signatureV2")}var sI=function(e){return tm(e.slice(nI.length))},oI=function(e){var t=Gl(e);if(0!==t.ValidityType)throw ji(new Error("Unknown validity type"),XZ);return t.ValidityType=GZ.ValidityType.EOL,Number.isInteger(t.Sequence)&&(t.Sequence=BigInt(t.Sequence)),Number.isInteger(t.TTL)&&(t.TTL=BigInt(t.TTL)),t},uI=function(e){if(null!=e){if(Wy(e))return"/ipns/".concat(e.toCID().toString(ms));if(e instanceof Uint8Array){var t=Ws(e);t.startsWith("/")&&(e=t)}var r=e.toString().trim();if(r.startsWith("/")&&r.length>1)return r;var n=Ba.asCID(e);if(null!=n)return 114===n.code?"/ipns/".concat(n.toString(ms)):"/ipfs/".concat(n.toV1().toString());try{return e instanceof Uint8Array?"/ipfs/".concat(Ba.decode(e).toV1().toString()):"/ipfs/".concat(Ba.parse(r).toV1().toString())}catch(i){}}throw ji(new Error("Value must be a valid content path starting with /"),"ERR_INVALID_VALUE")},cI=function(e){var t,r;if(null==e.data)throw ji(new Error("Record data is missing"),"ERR_INVALID_RECORD_DATA");var n=oI(e.data);if(!Ao(n.Value,null!==(t=e.value)&&void 0!==t?t:new Uint8Array(0)))throw ji(new Error('Field "value" did not match between protobuf and CBOR'),JZ);if(!Ao(n.Validity,null!==(r=e.validity)&&void 0!==r?r:new Uint8Array(0)))throw ji(new Error('Field "validity" did not match between protobuf and CBOR'),JZ);if(n.ValidityType!==e.validityType)throw ji(new Error('Field "validityType" did not match between protobuf and CBOR'),JZ);if(n.Sequence!==e.sequence)throw ji(new Error('Field "sequence" did not match between protobuf and CBOR'),JZ);if(n.TTL!==e.ttl)throw ji(new Error('Field "ttl" did not match between protobuf and CBOR'),JZ)};function lI(e,t){var r=t.map((function(e,t){return{record:aI(e),index:t}}));return r.sort((function(e,t){var r=e.record.sequence,n=t.record.sequence;if(r>n)return-1;if(r<n)return 1;var i=e.record.validity.toDate(),a=t.record.validity.toDate();return i.getTime()>a.getTime()?-1:i.getTime()<a.getTime()?1:0})),r[0].index}var hI=zi("ipns:validator"),fI=10240,dI=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=aI(r),e.prev=1,s=n.data,a=Eu([Hs("ipns-signature:"),s]),e.next=5,t.verify(a,n.signatureV2);case 5:i=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),i=!1;case 11:if(i){e.next=14;break}throw hI.error("record signature verification failed"),ji(new Error("record signature verification failed"),JZ);case 14:if(n.validityType!==GZ.ValidityType.EOL){e.next=20;break}if(!(n.validity.toDate().getTime()<Date.now())){e.next=18;break}throw hI.error("record has expired"),ji(new Error("record has expired"),"ERR_IPNS_EXPIRED_RECORD");case 18:e.next=23;break;case 20:if(null==n.validityType){e.next=23;break}throw hI.error("unrecognized validity type"),ji(new Error("unrecognized validity type"),XZ);case 23:hI("ipns record for %b is valid",n.value);case 24:case"end":return e.stop()}var s}),e,null,[[1,8]])})));return function(t,r){return e.apply(this,arguments)}}();function pI(e,t){return vI.apply(this,arguments)}function vI(){return vI=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.byteLength>fI)){e.next=2;break}throw ji(new Error("record too large"),tI);case 2:return n=sI(t),i=aI(r),e.next=6,iI(n,i);case 6:return a=e.sent,e.next=9,dI(a,r);case 9:case"end":return e.stop()}}),e)}))),vI.apply(this,arguments)}var gI;!function(e){var t,r,n;!function(e){e.DIAL="DIAL",e.DIAL_RESPONSE="DIAL_RESPONSE"}(e.MessageType||(e.MessageType={})),function(e){e[e.DIAL=0]="DIAL",e[e.DIAL_RESPONSE=1]="DIAL_RESPONSE"}(t||(t={})),function(e){e.codec=function(){return Qo(t)}}(e.MessageType||(e.MessageType={})),function(e){e.OK="OK",e.E_DIAL_ERROR="E_DIAL_ERROR",e.E_DIAL_REFUSED="E_DIAL_REFUSED",e.E_BAD_REQUEST="E_BAD_REQUEST",e.E_INTERNAL_ERROR="E_INTERNAL_ERROR"}(e.ResponseStatus||(e.ResponseStatus={})),function(e){e[e.OK=0]="OK",e[e.E_DIAL_ERROR=100]="E_DIAL_ERROR",e[e.E_DIAL_REFUSED=101]="E_DIAL_REFUSED",e[e.E_BAD_REQUEST=200]="E_BAD_REQUEST",e[e.E_INTERNAL_ERROR=300]="E_INTERNAL_ERROR"}(r||(r={})),function(e){e.codec=function(){return Qo(r)}}(e.ResponseStatus||(e.ResponseStatus={})),function(e){var t;e.codec=function(){return null==t&&(t=Xo((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==r.lengthDelimited&&t.fork(),null!=e.id&&(t.uint32(10),t.bytes(e.id)),null!=e.addrs){var n,i=(0,ge.Z)(e.addrs);try{for(i.s();!(n=i.n()).done;){var a=n.value;t.uint32(18),t.bytes(a)}}catch(S$){i.e(S$)}finally{i.f()}}!1!==r.lengthDelimited&&t.ldelim()}),(function(e,t){for(var r={addrs:[]},n=null==t?e.len:e.pos+t;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.id=e.bytes();break;case 2:r.addrs.push(e.bytes());break;default:e.skipType(7&i)}}return r}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(e.PeerInfo||(e.PeerInfo={})),function(t){var r;t.codec=function(){return null==r&&(r=Xo((function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&r.fork(),null!=t.peer&&(r.uint32(10),e.PeerInfo.codec().encode(t.peer,r)),!1!==n.lengthDelimited&&r.ldelim()}),(function(t,r){for(var n={},i=null==r?t.len:t.pos+r;t.pos<i;){var a=t.uint32();if(a>>>3===1)n.peer=e.PeerInfo.codec().decode(t,t.uint32());else t.skipType(7&a)}return n}))),r},t.encode=function(e){return Yo(e,t.codec())},t.decode=function(e){return Ko(e,t.codec())}}(e.Dial||(e.Dial={})),function(t){var r;t.codec=function(){return null==r&&(r=Xo((function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&r.fork(),null!=t.status&&(r.uint32(8),e.ResponseStatus.codec().encode(t.status,r)),null!=t.statusText&&(r.uint32(18),r.string(t.statusText)),null!=t.addr&&(r.uint32(26),r.bytes(t.addr)),!1!==n.lengthDelimited&&r.ldelim()}),(function(t,r){for(var n={},i=null==r?t.len:t.pos+r;t.pos<i;){var a=t.uint32();switch(a>>>3){case 1:n.status=e.ResponseStatus.codec().decode(t);break;case 2:n.statusText=t.string();break;case 3:n.addr=t.bytes();break;default:t.skipType(7&a)}}return n}))),r},t.encode=function(e){return Yo(e,t.codec())},t.decode=function(e){return Ko(e,t.codec())}}(e.DialResponse||(e.DialResponse={})),e.codec=function(){return null==n&&(n=Xo((function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&r.fork(),null!=t.type&&(r.uint32(8),e.MessageType.codec().encode(t.type,r)),null!=t.dial&&(r.uint32(18),e.Dial.codec().encode(t.dial,r)),null!=t.dialResponse&&(r.uint32(26),e.DialResponse.codec().encode(t.dialResponse,r)),!1!==n.lengthDelimited&&r.ldelim()}),(function(t,r){for(var n={},i=null==r?t.len:t.pos+r;t.pos<i;){var a=t.uint32();switch(a>>>3){case 1:n.type=e.MessageType.codec().decode(t);break;case 2:n.dial=e.Dial.codec().decode(t,t.uint32());break;case 3:n.dialResponse=e.DialResponse.codec().decode(t,t.uint32());break;default:t.skipType(7&a)}}return n}))),n},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(gI||(gI={}));var yI=zi("libp2p:autonat"),mI=function(){function e(t,r){var n,i,a,s,o,u;(0,hi.Z)(this,e),(0,we.Z)(this,"components",void 0),(0,we.Z)(this,"startupDelay",void 0),(0,we.Z)(this,"refreshInterval",void 0),(0,we.Z)(this,"protocol",void 0),(0,we.Z)(this,"timeout",void 0),(0,we.Z)(this,"maxInboundStreams",void 0),(0,we.Z)(this,"maxOutboundStreams",void 0),(0,we.Z)(this,"verifyAddressTimeout",void 0),(0,we.Z)(this,"started",void 0),this.components=t,this.started=!1,this.protocol="/".concat(null!==(n=r.protocolPrefix)&&void 0!==n?n:"libp2p","/").concat("autonat","/").concat("1.0.0"),this.timeout=null!==(i=r.timeout)&&void 0!==i?i:3e4,this.maxInboundStreams=null!==(a=r.maxInboundStreams)&&void 0!==a?a:1,this.maxOutboundStreams=null!==(s=r.maxOutboundStreams)&&void 0!==s?s:1,this.startupDelay=null!==(o=r.startupDelay)&&void 0!==o?o:5e3,this.refreshInterval=null!==(u=r.refreshInterval)&&void 0!==u?u:6e4,this._verifyExternalAddresses=this._verifyExternalAddresses.bind(this)}return(0,fi.Z)(e,[{key:"isStarted",value:function(){return this.started}},{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.started){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.components.registrar.handle(this.protocol,(function(e){t.handleIncomingAutonatStream(e).catch((function(e){yI.error("error handling incoming autonat stream",e)}))}),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams});case 4:this.verifyAddressTimeout=setTimeout(this._verifyExternalAddresses,this.startupDelay),this.started=!0;case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.components.registrar.unhandle(this.protocol);case 2:clearTimeout(this.verifyAddressTimeout),this.started=!1;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleIncomingAutonatStream",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=AbortSignal.timeout(this.timeout),n=function(){t.stream.abort(new wo("handleIncomingAutonatStream timeout",ww.ERR_TIMEOUT))},r.addEventListener("abort",n,{once:!0});try{null===Wu.setMaxListeners||void 0===Wu.setMaxListeners||(0,Wu.setMaxListeners)(1/0,r)}catch(s){}return i=this.components.addressManager.getAddresses().map((function(e){return e.toOptions().host})),e.prev=5,a=this,e.next=9,no(t.stream,(function(e){return Bu(e)}),function(){var e=ea((0,ii.Z)().mark((function e(n){var s,o,u,c,l,h,f,d,p,v,g,y,m,b,_;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ji(pk(n));case 2:if(null!=(s=e.sent)){e.next=8;break}return yI("no message received"),e.next=7,gI.encode({type:gI.MessageType.DIAL_RESPONSE,dialResponse:{status:gI.ResponseStatus.E_BAD_REQUEST,statusText:"No message was sent"}});case 7:return e.abrupt("return");case 8:e.prev=8,o=gI.decode(s),e.next=18;break;case 12:return e.prev=12,e.t0=e.catch(8),yI.error("could not decode message",e.t0),e.next=17,gI.encode({type:gI.MessageType.DIAL_RESPONSE,dialResponse:{status:gI.ResponseStatus.E_BAD_REQUEST,statusText:"Could not decode message"}});case 17:return e.abrupt("return");case 18:if(null!=(u=o.dial)){e.next=24;break}return yI.error("dial was missing from message"),e.next=23,gI.encode({type:gI.MessageType.DIAL_RESPONSE,dialResponse:{status:gI.ResponseStatus.E_BAD_REQUEST,statusText:"No Dial message found in message"}});case 23:return e.abrupt("return");case 24:if(null!=(l=u.peer)&&null!=l.id){e.next=30;break}return yI.error("PeerId missing from message"),e.next=29,gI.encode({type:gI.MessageType.DIAL_RESPONSE,dialResponse:{status:gI.ResponseStatus.E_BAD_REQUEST,statusText:"missing peer info"}});case 29:return e.abrupt("return");case 30:e.prev=30,c=tm(l.id),e.next=40;break;case 34:return e.prev=34,e.t1=e.catch(30),yI.error("invalid PeerId",e.t1),e.next=39,gI.encode({type:gI.MessageType.DIAL_RESPONSE,dialResponse:{status:gI.ResponseStatus.E_BAD_REQUEST,statusText:"bad peer id"}});case 39:return e.abrupt("return");case 40:if(yI("incoming request from %p",c),t.connection.remotePeer.equals(c)){e.next=46;break}return yI("target peer %p did not equal sending peer %p",c,t.connection.remotePeer),e.next=45,gI.encode({type:gI.MessageType.DIAL_RESPONSE,dialResponse:{status:gI.ResponseStatus.E_BAD_REQUEST,statusText:"peer id mismatch"}});case 45:return e.abrupt("return");case 46:if(h=l.addrs.map((function(e){return kb(e)})).filter((function(e){var r=e.toOptions().host===t.connection.remoteAddr.toOptions().host;return yI.trace("request to dial %a was sent from %a is same host %s",e,t.connection.remoteAddr,r),r})).filter((function(e){var t,r=e.toOptions().host,n=!(null!==(t=S_(r))&&void 0!==t&&t);return yI.trace("host %s was public %s",r,n),n})).filter((function(e){var t=e.toOptions().host,r=!i.includes(t);return yI.trace("host %s was not our host %s",t,r),r})).filter((function(e){var t=Boolean(a.components.transportManager.transportForMultiaddr(e));return yI.trace("transport for %a is supported %s",e,t),t})).map((function(e){return null==e.getPeerId()&&(e=e.encapsulate("/p2p/".concat(c.toString()))),e})),0!==h.length){e.next=52;break}return yI("no valid multiaddrs for %p in message",c),e.next=51,gI.encode({type:gI.MessageType.DIAL_RESPONSE,dialResponse:{status:gI.ResponseStatus.E_DIAL_REFUSED,statusText:"no dialable addresses"}});case 51:return e.abrupt("return");case 52:yI("dial multiaddrs %s for peer %p",h.map((function(e){return e.toString()})).join(", "),c),f="",d=h[0],p=!1,v=!1,e.prev=57,y=ui(h);case 59:return e.next=61,Ji(y.next());case 61:if(!(p=!(m=e.sent).done)){e.next=90;break}return b=m.value,_=void 0,d=b,e.prev=65,e.next=68,Ji(a.components.connectionManager.openConnection(b,{signal:r}));case 68:if((_=e.sent).remoteAddr.equals(b)){e.next=72;break}throw yI.error("tried to dial %a but dialed %a",b,_.remoteAddr),new Error("Unexpected remote address");case 72:return yI("Success %p",c),e.next=75,gI.encode({type:gI.MessageType.DIAL_RESPONSE,dialResponse:{status:gI.ResponseStatus.OK,addr:_.remoteAddr.decapsulateCode(Gm("p2p").code).bytes}});case 75:return e.abrupt("return");case 78:e.prev=78,e.t2=e.catch(65),yI("could not dial %p",c,e.t2),f=e.t2.message;case 82:if(e.prev=82,null==_){e.next=86;break}return e.next=86,Ji(_.close());case 86:return e.finish(82);case 87:p=!1,e.next=59;break;case 90:e.next=96;break;case 92:e.prev=92,e.t3=e.catch(57),v=!0,g=e.t3;case 96:if(e.prev=96,e.prev=97,!p||null==y.return){e.next=101;break}return e.next=101,Ji(y.return());case 101:if(e.prev=101,!v){e.next=104;break}throw g;case 104:return e.finish(101);case 105:return e.finish(96);case 106:return e.next=108,gI.encode({type:gI.MessageType.DIAL_RESPONSE,dialResponse:{status:gI.ResponseStatus.E_DIAL_ERROR,statusText:f,addr:d.bytes}});case 108:case"end":return e.stop()}}),e,null,[[8,12],[30,34],[57,92,96,106],[65,78,82,87],[97,,101,105]])})));return function(t){return e.apply(this,arguments)}}(),(function(e){return Zu(e)}),t.stream);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(5),yI.error("error handling incoming autonat stream",e.t0);case 14:return e.prev=14,r.removeEventListener("abort",n),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[5,11,14,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_verifyExternalAddresses",value:function(){this.verifyExternalAddresses().catch((function(e){yI.error("error verifying external address",e)}))}},{key:"verifyExternalAddresses",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i,a,s,o,u,c,l,h,f,d,p,v,g,y,m=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(clearTimeout(this.verifyAddressTimeout),this.isStarted()){e.next=3;break}return e.abrupt("return");case 3:if(t=this.components.addressManager,0!==(r=t.getObservedAddrs().filter((function(e){var t,r=e.toOptions();return!(null!==(t=S_(r.host))&&void 0!==t&&t)}))).length){e.next=9;break}return yI("no public addresses found, not requesting verification"),this.verifyAddressTimeout=setTimeout(this._verifyExternalAddresses,this.refreshInterval),e.abrupt("return");case 9:n=AbortSignal.timeout(this.timeout);try{null===Wu.setMaxListeners||void 0===Wu.setMaxListeners||(0,Wu.setMaxListeners)(1/0,n)}catch(b){}return i=this,e.prev=12,yI("verify multiaddrs %s",r.map((function(e){return e.toString()})).join(", ")),a=gI.encode({type:gI.MessageType.DIAL,dial:{peer:{id:this.components.peerId.toBytes(),addrs:r.map((function(e){return e.bytes}))}}}),e.next=17,Cm();case 17:s=e.sent,o=s.toBytes(),u={},c=[],l=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,s,o,u,l,h,f,d,p;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=function(){},e.prev=1,yI("asking %p to verify multiaddr",t.id),e.next=5,i.components.connectionManager.openConnection(t.id,{signal:n});case 5:return s=e.sent,e.next=8,s.newStream(m.protocol,{signal:n});case 8:return o=e.sent,r=function(){o.abort(new wo("verifyAddress timeout",ww.ERR_TIMEOUT))},n.addEventListener("abort",r,{once:!0}),e.next=13,no([a],(function(e){return Zu(e)}),o,(function(e){return Bu(e)}),function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",pk(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 13:if(null!=(u=e.sent)){e.next=17;break}return yI("no response received from %p",s.remotePeer),e.abrupt("return",void 0);case 17:if((l=gI.decode(u)).type===gI.MessageType.DIAL_RESPONSE&&null!=l.dialResponse){e.next=21;break}return yI("invalid autonat response from %p",s.remotePeer),e.abrupt("return",void 0);case 21:if(l.dialResponse.status!==gI.ResponseStatus.OK){e.next=39;break}if(4!==(h=s.remoteAddr.toOptions()).family){e.next=28;break}d=h.host.split("."),f=d[0],e.next=35;break;case 28:if(6!==h.family){e.next=33;break}p=h.host.split(":"),f=p[0],e.next=35;break;case 33:return yI('remote address "%s" was not IP4 or IP6?',h.host),e.abrupt("return",void 0);case 35:if(!c.includes(f)){e.next=38;break}return yI("already have response from network segment %d - %s",f,h.host),e.abrupt("return",void 0);case 38:c.push(f);case 39:return e.abrupt("return",l.dialResponse);case 42:e.prev=42,e.t0=e.catch(1),yI.error("error asking remote to verify multiaddr",e.t0);case 45:return e.prev=45,n.removeEventListener("abort",r),e.finish(45);case 48:case"end":return e.stop()}}),e,null,[[1,42,45,48]])})));return function(t){return e.apply(this,arguments)}}(),h=!1,f=!1,e.prev=24,p=(0,ii.Z)().mark((function e(){var n,i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=y.value,e.prev=1,null!=n){e.next=4;break}return e.abrupt("return",0);case 4:if(i=null==n.addr?r[0]:kb(n.addr),yI("autonat response for %a is %s",i,n.status),n.status!==gI.ResponseStatus.E_BAD_REQUEST){e.next=8;break}return e.abrupt("return",0);case 8:if(n.status!==gI.ResponseStatus.E_DIAL_REFUSED){e.next=10;break}return e.abrupt("return",0);case 10:if(!(null==n.addr&&r.length>1)){e.next=12;break}return e.abrupt("return",0);case 12:if(r.some((function(e){return e.equals(i)}))){e.next=15;break}return yI("peer reported %a as %s but it was not in our observed address list",i,n.status),e.abrupt("return",0);case 15:if(a=i.toString(),null==u[a]&&(u[a]={success:0,failure:0}),n.status===gI.ResponseStatus.OK?u[a].success++:n.status===gI.ResponseStatus.E_DIAL_ERROR&&u[a].failure++,4!==u[a].success){e.next=22;break}return yI("%a is externally dialable",i),t.confirmObservedAddr(i),e.abrupt("return",{v:void 0});case 22:if(4!==u[a].failure){e.next=26;break}return yI("%a is not externally dialable",i),t.removeObservedAddr(i),e.abrupt("return",{v:void 0});case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(1),yI.error("could not verify external address",e.t0);case 31:case"end":return e.stop()}}),e,null,[[1,28]])})),g=ui(EA(ro(this.components.peerRouting.getClosestPeers(o,{signal:n}),(function(e){return(0,ai.Z)((0,ii.Z)().mark((function t(){return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",l(e));case 1:case"end":return t.stop()}}),t)})))})),{concurrency:4}));case 27:return e.next=29,g.next();case 29:if(!(h=!(y=e.sent).done)){e.next=39;break}return e.delegateYield(p(),"t0",31);case 31:if(0!==(v=e.t0)){e.next=34;break}return e.abrupt("continue",36);case 34:if(!v){e.next=36;break}return e.abrupt("return",v.v);case 36:h=!1,e.next=27;break;case 39:e.next=45;break;case 41:e.prev=41,e.t1=e.catch(24),f=!0,d=e.t1;case 45:if(e.prev=45,e.prev=46,!h||null==g.return){e.next=50;break}return e.next=50,g.return();case 50:if(e.prev=50,!f){e.next=53;break}throw d;case 53:return e.finish(50);case 54:return e.finish(45);case 55:return e.prev=55,this.verifyAddressTimeout=setTimeout(this._verifyExternalAddresses,this.refreshInterval),e.finish(55);case 58:case"end":return e.stop()}}),e,this,[[12,,55,58],[24,41,45,55],[46,,50,54]])})));return function(){return e.apply(this,arguments)}}()}]),e}();function bI(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){return new mI(t,e)}}BigInt(1<<17);var _I,wI,kI,xI,EI,SI,CI,AI,DI="/libp2p/circuit/relay/0.2.0/hop",RI="/libp2p/circuit/relay/0.2.0/stop";!function(e){var t,r;!function(e){e.RESERVE="RESERVE",e.CONNECT="CONNECT",e.STATUS="STATUS"}(e.Type||(e.Type={})),function(e){e[e.RESERVE=0]="RESERVE",e[e.CONNECT=1]="CONNECT",e[e.STATUS=2]="STATUS"}(t||(t={})),function(e){e.codec=function(){return Qo(t)}}(e.Type||(e.Type={})),e.codec=function(){return null==r&&(r=Xo((function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&r.fork(),null!=t.type&&(r.uint32(8),e.Type.codec().encode(t.type,r)),null!=t.peer&&(r.uint32(18),kI.codec().encode(t.peer,r)),null!=t.reservation&&(r.uint32(26),xI.codec().encode(t.reservation,r)),null!=t.limit&&(r.uint32(34),EI.codec().encode(t.limit,r)),null!=t.status&&(r.uint32(40),SI.codec().encode(t.status,r)),!1!==n.lengthDelimited&&r.ldelim()}),(function(t,r){for(var n={},i=null==r?t.len:t.pos+r;t.pos<i;){var a=t.uint32();switch(a>>>3){case 1:n.type=e.Type.codec().decode(t);break;case 2:n.peer=kI.codec().decode(t,t.uint32());break;case 3:n.reservation=xI.codec().decode(t,t.uint32());break;case 4:n.limit=EI.codec().decode(t,t.uint32());break;case 5:n.status=SI.codec().decode(t);break;default:t.skipType(7&a)}}return n}))),r},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(_I||(_I={})),function(e){var t,r;!function(e){e.CONNECT="CONNECT",e.STATUS="STATUS"}(e.Type||(e.Type={})),function(e){e[e.CONNECT=0]="CONNECT",e[e.STATUS=1]="STATUS"}(t||(t={})),function(e){e.codec=function(){return Qo(t)}}(e.Type||(e.Type={})),e.codec=function(){return null==r&&(r=Xo((function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&r.fork(),null!=t.type&&(r.uint32(8),e.Type.codec().encode(t.type,r)),null!=t.peer&&(r.uint32(18),kI.codec().encode(t.peer,r)),null!=t.limit&&(r.uint32(26),EI.codec().encode(t.limit,r)),null!=t.status&&(r.uint32(32),SI.codec().encode(t.status,r)),!1!==n.lengthDelimited&&r.ldelim()}),(function(t,r){for(var n={},i=null==r?t.len:t.pos+r;t.pos<i;){var a=t.uint32();switch(a>>>3){case 1:n.type=e.Type.codec().decode(t);break;case 2:n.peer=kI.codec().decode(t,t.uint32());break;case 3:n.limit=EI.codec().decode(t,t.uint32());break;case 4:n.status=SI.codec().decode(t);break;default:t.skipType(7&a)}}return n}))),r},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(wI||(wI={})),function(e){var t;e.codec=function(){return null==t&&(t=Xo((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==r.lengthDelimited&&t.fork(),null!=e.id&&e.id.byteLength>0&&(t.uint32(10),t.bytes(e.id)),null!=e.addrs){var n,i=(0,ge.Z)(e.addrs);try{for(i.s();!(n=i.n()).done;){var a=n.value;t.uint32(18),t.bytes(a)}}catch(S$){i.e(S$)}finally{i.f()}}!1!==r.lengthDelimited&&t.ldelim()}),(function(e,t){for(var r={id:new Uint8Array(0),addrs:[]},n=null==t?e.len:e.pos+t;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.id=e.bytes();break;case 2:r.addrs.push(e.bytes());break;default:e.skipType(7&i)}}return r}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(kI||(kI={})),function(e){var t;e.codec=function(){return null==t&&(t=Xo((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==r.lengthDelimited&&t.fork(),null!=e.expire&&0n!==e.expire&&(t.uint32(8),t.uint64(e.expire)),null!=e.addrs){var n,i=(0,ge.Z)(e.addrs);try{for(i.s();!(n=i.n()).done;){var a=n.value;t.uint32(18),t.bytes(a)}}catch(S$){i.e(S$)}finally{i.f()}}null!=e.voucher&&(t.uint32(26),t.bytes(e.voucher)),!1!==r.lengthDelimited&&t.ldelim()}),(function(e,t){for(var r={expire:0n,addrs:[]},n=null==t?e.len:e.pos+t;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.expire=e.uint64();break;case 2:r.addrs.push(e.bytes());break;case 3:r.voucher=e.bytes();break;default:e.skipType(7&i)}}return r}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(xI||(xI={})),function(e){var t;e.codec=function(){return null==t&&(t=Xo((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&t.fork(),null!=e.duration&&(t.uint32(8),t.uint32(e.duration)),null!=e.data&&(t.uint32(16),t.uint64(e.data)),!1!==r.lengthDelimited&&t.ldelim()}),(function(e,t){for(var r={},n=null==t?e.len:e.pos+t;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.duration=e.uint32();break;case 2:r.data=e.uint64();break;default:e.skipType(7&i)}}return r}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(EI||(EI={})),function(e){e.UNUSED="UNUSED",e.OK="OK",e.RESERVATION_REFUSED="RESERVATION_REFUSED",e.RESOURCE_LIMIT_EXCEEDED="RESOURCE_LIMIT_EXCEEDED",e.PERMISSION_DENIED="PERMISSION_DENIED",e.CONNECTION_FAILED="CONNECTION_FAILED",e.NO_RESERVATION="NO_RESERVATION",e.MALFORMED_MESSAGE="MALFORMED_MESSAGE",e.UNEXPECTED_MESSAGE="UNEXPECTED_MESSAGE"}(SI||(SI={})),function(e){e[e.UNUSED=0]="UNUSED",e[e.OK=100]="OK",e[e.RESERVATION_REFUSED=200]="RESERVATION_REFUSED",e[e.RESOURCE_LIMIT_EXCEEDED=201]="RESOURCE_LIMIT_EXCEEDED",e[e.PERMISSION_DENIED=202]="PERMISSION_DENIED",e[e.CONNECTION_FAILED=203]="CONNECTION_FAILED",e[e.NO_RESERVATION=204]="NO_RESERVATION",e[e.MALFORMED_MESSAGE=400]="MALFORMED_MESSAGE",e[e.UNEXPECTED_MESSAGE=401]="UNEXPECTED_MESSAGE"}(CI||(CI={})),function(e){e.codec=function(){return Qo(CI)}}(SI||(SI={})),function(e){var t;e.codec=function(){return null==t&&(t=Xo((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&t.fork(),null!=e.relay&&e.relay.byteLength>0&&(t.uint32(10),t.bytes(e.relay)),null!=e.peer&&e.peer.byteLength>0&&(t.uint32(18),t.bytes(e.peer)),null!=e.expiration&&0n!==e.expiration&&(t.uint32(24),t.uint64(e.expiration)),!1!==r.lengthDelimited&&t.ldelim()}),(function(e,t){for(var r={relay:new Uint8Array(0),peer:new Uint8Array(0),expiration:0n},n=null==t?e.len:e.pos+t;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.relay=e.bytes();break;case 2:r.peer=e.bytes();break;case 3:r.expiration=e.uint64();break;default:e.skipType(7&i)}}return r}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(AI||(AI={}));zi("libp2p:circuit-relay:utils");function TI(e){return ZI.apply(this,arguments)}function ZI(){return ZI=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(new TextEncoder).encode(t),e.next=3,Ps.digest(r);case 3:return n=e.sent,e.abrupt("return",Ba.createV0(n));case 5:case"end":return e.stop()}}),e)}))),ZI.apply(this,arguments)}function II(e){var t=e*BigInt(1e3),r=(new Date).getTime();return Number(t-BigInt(r))}__webpack_require__(9158),Object.prototype.toString,new Set(["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Load failed","Network request failed","fetch failed"]);zi("libp2p:circuit-relay:advert-service"),zi("libp2p:circuit-relay:server");var PI=zi("libp2p:stream:converter");function LI(e){var t=e.stream,r=e.remoteAddr,n=t.sink,i=t.source,a={sink:function(e){return(0,ai.Z)((0,ii.Z)().mark((function t(){return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n(e);case 3:s(),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),"aborted"!==t.t0.type&&PI(t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))()},source:ea((0,ii.Z)().mark((function e(){var t,r,n,a,s,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!1,r=!1,e.prev=2,a=ui(i);case 4:return e.next=6,Ji(a.next());case 6:if(!(t=!(s=e.sent).done)){e.next=17;break}if(!((o=s.value)instanceof Uint8Array)){e.next=13;break}return e.next=11,o;case 11:e.next=14;break;case 13:return e.delegateYield(Xa(ui(o)),"t0",14);case 14:t=!1,e.next=4;break;case 17:e.next=23;break;case 19:e.prev=19,e.t1=e.catch(2),r=!0,n=e.t1;case 23:if(e.prev=23,e.prev=24,!t||null==a.return){e.next=28;break}return e.next=28,Ji(a.return());case 28:if(e.prev=28,!r){e.next=31;break}throw n;case 31:return e.finish(28);case 32:return e.finish(23);case 33:case"end":return e.stop()}}),e,null,[[2,19,23,33],[24,,28,32]])})))(),remoteAddr:r,timeline:{open:Date.now(),close:void 0},close:function(e){return(0,ai.Z)((0,ii.Z)().mark((function r(){return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return s(),r.next=3,t.close(e);case 3:case"end":return r.stop()}}),r)})))()},abort:function(e){s(),t.abort(e)}};function s(){null==a.timeline.close&&(a.timeline.close=Date.now())}return a}var MI=zi("libp2p:circuit-relay:discover-relays"),BI=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),n=t.call(this),(0,we.Z)(ra(n),"peerId",void 0),(0,we.Z)(ra(n),"peerStore",void 0),(0,we.Z)(ra(n),"contentRouting",void 0),(0,we.Z)(ra(n),"registrar",void 0),(0,we.Z)(ra(n),"started",void 0),(0,we.Z)(ra(n),"topologyId",void 0),n.started=!1,n.peerId=e.peerId,n.peerStore=e.peerStore,n.contentRouting=e.contentRouting,n.registrar=e.registrar,n}return(0,fi.Z)(r,[{key:"isStarted",value:function(){return this.started}},{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.registrar.register(DI,{onConnect:function(e){t.safeDispatchEvent("relay:discover",{detail:e})}});case 2:this.topologyId=e.sent,this.discover().catch((function(e){MI.error("error listening on relays",e)})),this.started=!0;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){null!=this.topologyId&&this.registrar.unregister(this.topologyId),this.started=!1}},{key:"discover",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i,a,s,o,u,c,l,h,f,d;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return MI("searching peer store for relays"),e.next=3,this.peerStore.all({filters:[function(e){return e.protocols.includes(DI)}],orders:[function(){return Math.random()<.5?1:-1}]});case 3:t=e.sent,r=(0,ge.Z)(t);try{for(r.s();!(n=r.n()).done;)i=n.value,MI("found relay peer %p in content peer store",i.id),this.safeDispatchEvent("relay:discover",{detail:i.id})}catch(S$){r.e(S$)}finally{r.f()}return MI("found %d relay peers in peer store",t.length),e.prev=7,MI("searching content routing for relays"),e.next=11,TI("/libp2p/relay");case 11:a=e.sent,s=0,o=!1,u=!1,e.prev=15,l=ui(this.contentRouting.findProviders(a));case 17:return e.next=19,l.next();case 19:if(!(o=!(h=e.sent).done)){e.next=31;break}if(!((f=h.value).multiaddrs.length>0)||f.id.equals(this.peerId)){e.next=28;break}return d=f.id,s++,e.next=26,this.peerStore.merge(d,{multiaddrs:f.multiaddrs});case 26:MI("found relay peer %p in content routing",d),this.safeDispatchEvent("relay:discover",{detail:d});case 28:o=!1,e.next=17;break;case 31:e.next=37;break;case 33:e.prev=33,e.t0=e.catch(15),u=!0,c=e.t0;case 37:if(e.prev=37,e.prev=38,!o||null==l.return){e.next=42;break}return e.next=42,l.return();case 42:if(e.prev=42,!u){e.next=45;break}throw c;case 45:return e.finish(42);case 46:return e.finish(37);case 47:MI("found %d relay peers in content routing",s),e.next=53;break;case 50:e.prev=50,e.t1=e.catch(7),MI.error("failed when finding relays on the network",e.t1);case 53:case"end":return e.stop()}}),e,this,[[7,50],[15,33,37,47],[38,,42,46]])})));return function(){return e.apply(this,arguments)}}()}]),r}(Ly),OI=zi("libp2p:circuit-relay:transport:listener"),NI=new WeakSet,FI=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),ic(ra(n=t.call(this)),NI),(0,we.Z)(ra(n),"connectionManager",void 0),(0,we.Z)(ra(n),"relayStore",void 0),(0,we.Z)(ra(n),"listeningAddrs",void 0),n.connectionManager=e.connectionManager,n.relayStore=e.relayStore,n.listeningAddrs=new xm,n.relayStore.addEventListener("relay:removed",(function(e){ac(ra(n),NI,UI).call(ra(n),e.detail)})),n}return(0,fi.Z)(r,[{key:"listen",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(OI("listen on %a",t),null!=(r=t.getPeerId())&&(a=em(r),(s=null!==(i=this.connectionManager.getConnectionsMap().get(a))&&void 0!==i?i:[]).length>0&&(n=s[0])),null!=n){e.next=9;break}return o=t.toString().split("/p2p-circuit").find((function(e){return""!==e})),u=kb(o),e.next=8,this.connectionManager.openConnection(u);case 8:n=e.sent;case 9:if(this.relayStore.hasReservation(n.remotePeer)){e.next=13;break}return e.next=12,this.relayStore.addRelay(n.remotePeer,"configured");case 12:return e.abrupt("return");case 13:if(null!=(c=this.relayStore.getReservation(n.remotePeer))){e.next=16;break}throw new wo("Did not have reservation after making reservation","ERR_NO_RESERVATION");case 16:if(!this.listeningAddrs.has(n.remotePeer)){e.next=19;break}return OI("already listening on relay %p",n.remotePeer),e.abrupt("return");case 19:this.listeningAddrs.set(n.remotePeer,c.addrs.map((function(e){return kb(e).encapsulate("/p2p-circuit")}))),this.safeDispatchEvent("listening",{});case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAddrs",value:function(){return be(this.listeningAddrs.values()).flat()}},{key:"close",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),r}(Ly);function UI(e){var t=this.listeningAddrs.has(e);OI("relay peer removed %p - had reservation",e,t),this.listeningAddrs.delete(e),t&&this.safeDispatchEvent("close",{})}var zI,jI=zi("libp2p:circuit-relay:transport:reservation-store"),HI=new WeakSet,WI=new WeakSet,qI=function(e){ia(r,e);var t=ua(r);function r(e,n){var i,a,s,o,u;return(0,hi.Z)(this,r),ic(ra(u=t.call(this)),WI),ic(ra(u),HI),(0,we.Z)(ra(u),"peerId",void 0),(0,we.Z)(ra(u),"connectionManager",void 0),(0,we.Z)(ra(u),"transportManager",void 0),(0,we.Z)(ra(u),"peerStore",void 0),(0,we.Z)(ra(u),"events",void 0),(0,we.Z)(ra(u),"reserveQueue",void 0),(0,we.Z)(ra(u),"reservations",void 0),(0,we.Z)(ra(u),"maxDiscoveredRelays",void 0),(0,we.Z)(ra(u),"maxReservationQueueLength",void 0),(0,we.Z)(ra(u),"reservationCompletionTimeout",void 0),(0,we.Z)(ra(u),"started",void 0),u.peerId=e.peerId,u.connectionManager=e.connectionManager,u.transportManager=e.transportManager,u.peerStore=e.peerStore,u.events=e.events,u.reservations=new xm,u.maxDiscoveredRelays=null!==(i=null===n||void 0===n?void 0:n.discoverRelays)&&void 0!==i?i:0,u.maxReservationQueueLength=null!==(a=null===n||void 0===n?void 0:n.maxReservationQueueLength)&&void 0!==a?a:100,u.reservationCompletionTimeout=null!==(s=null===n||void 0===n?void 0:n.reservationCompletionTimeout)&&void 0!==s?s:1e4,u.started=!1,u.reserveQueue=new Mw({concurrency:null!==(o=null===n||void 0===n?void 0:n.reservationConcurrency)&&void 0!==o?o:1}),u.events.addEventListener("peer:disconnect",(function(e){ac(ra(u),WI,YI).call(ra(u),e.detail)})),u}return(0,fi.Z)(r,[{key:"isStarted",value:function(){return this.started}},{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.started=!0;case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.reserveQueue.clear(),this.reservations.forEach((function(e){var t=e.timeout;clearTimeout(t)})),this.reservations.clear(),this.started=!1;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addRelay",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.peerId.equals(t)){e.next=3;break}return jI("not trying to use self as relay"),e.abrupt("return");case 3:if(!(this.reserveQueue.size>this.maxReservationQueueLength)){e.next=6;break}return jI("not adding relay as the queue is full"),e.abrupt("return");case 6:if(!this.reserveQueue.hasJob(t)){e.next=9;break}return jI("relay peer is already in the reservation queue"),e.abrupt("return");case 9:return jI("add relay %p",t),e.next=12,this.reserveQueue.add((0,ai.Z)((0,ii.Z)().mark((function e(){var i,a,s,o,u,c,l,h;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,null==(i=n.reservations.get(t))){e.next=8;break}if(!(II(i.reservation.expire)>6e5)){e.next=6;break}return jI("already have reservation on relay peer %p and it expires in more than 10 minutes",t),e.abrupt("return");case 6:clearTimeout(i.timeout),n.reservations.delete(t);case 8:if(!("discovered"===r&&be(n.reservations.values()).reduce((function(e,t){return"discovered"===t.type&&e++,e}),0)>=n.maxDiscoveredRelays)){e.next=11;break}return jI("already have enough discovered relays"),e.abrupt("return");case 11:return a=AbortSignal.timeout(n.reservationCompletionTimeout),e.next=14,n.connectionManager.openConnection(t,{signal:a});case 14:if(!(s=e.sent).remoteAddr.protoNames().includes("p2p-circuit")){e.next=18;break}return jI("not creating reservation over relayed connection"),e.abrupt("return");case 18:return e.next=20,ac(n,HI,VI).call(n,s,{signal:a});case 20:return o=e.sent,jI("created reservation on relay peer %p",t),u=II(o.expire),c=Math.min(Math.max(u-3e5,3e4),Math.pow(2,31)-1),l=setTimeout((function(){n.addRelay(t,r).catch((function(e){jI.error("could not refresh reservation to relay %p",t,e)}))}),c),n.reservations.set(t,{timeout:l,reservation:o,type:r}),e.next=28,n.peerStore.merge(t,{tags:(0,we.Z)({},"circuit-relay-relay",{value:1,ttl:u})});case 28:return e.next=30,n.transportManager.listen([kb("/p2p/".concat(t.toString(),"/p2p-circuit"))]);case 30:e.next=38;break;case 32:e.prev=32,e.t0=e.catch(0),jI.error("could not reserve slot on %p",t,e.t0),null!=(h=n.reservations.get(t))&&clearTimeout(h.timeout),n.reservations.delete(t);case 38:case"end":return e.stop()}}),e,null,[[0,32]])}))),{peerId:t});case 12:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"hasReservation",value:function(e){return this.reservations.has(e)}},{key:"getReservation",value:function(e){var t;return null===(t=this.reservations.get(e))||void 0===t?void 0:t.reservation}}]),r}(Ly);function VI(e,t){return KI.apply(this,arguments)}function KI(){return(KI=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(n=r.signal)||void 0===n||n.throwIfAborted(),jI("requesting reservation from %p",t.remotePeer),e.next=4,t.newStream(DI,r);case 4:return a=e.sent,s=kT(a),o=s.pb(_I),e.next=9,o.write({type:_I.Type.RESERVE},r);case 9:return e.prev=9,e.next=12,o.read(r);case 12:u=e.sent,e.next=19;break;case 15:throw e.prev=15,e.t0=e.catch(9),jI.error("error parsing reserve message response from %p because",t.remotePeer,e.t0),e.t0;case 19:return e.prev=19,e.next=22,a.close();case 22:return e.finish(19);case 23:if(u.status!==SI.OK||null==u.reservation){e.next=25;break}return e.abrupt("return",u.reservation);case 25:throw c="reservation failed with status ".concat(null!==(i=u.status)&&void 0!==i?i:"undefined"),jI.error(c),new Error(c);case 28:case"end":return e.stop()}}),e,null,[[9,15,19,23]])})))).apply(this,arguments)}function YI(e){var t=this.reservations.get(e);null!=t&&(jI("connection to relay %p closed, removing reservation from local store",e),clearTimeout(t.timeout),this.reservations.delete(e),this.safeDispatchEvent("relay:removed",{detail:e}),this.reservations.size<this.maxDiscoveredRelays&&(jI("not enough relays %d/%d",this.reservations.size,this.maxDiscoveredRelays),this.safeDispatchEvent("relay:not-enough-relays",{})))}var GI=zi("libp2p:circuit-relay:transport"),QI=function(e){if(null==e.peer)return!1;try{e.peer.addrs.forEach(kb)}catch(t){return!1}return!0},XI=Bw,JI=Bw,$I=3e4;zI=Symbol.toStringTag;var eP=function(){function e(t,r){var n,i,a,s=this;(0,hi.Z)(this,e),(0,we.Z)(this,"discovery",void 0),(0,we.Z)(this,"registrar",void 0),(0,we.Z)(this,"peerStore",void 0),(0,we.Z)(this,"connectionManager",void 0),(0,we.Z)(this,"peerId",void 0),(0,we.Z)(this,"upgrader",void 0),(0,we.Z)(this,"addressManager",void 0),(0,we.Z)(this,"connectionGater",void 0),(0,we.Z)(this,"reservationStore",void 0),(0,we.Z)(this,"maxInboundStopStreams",void 0),(0,we.Z)(this,"maxOutboundStopStreams",void 0),(0,we.Z)(this,"stopTimeout",void 0),(0,we.Z)(this,"started",void 0),(0,we.Z)(this,D_,!0),(0,we.Z)(this,zI,"libp2p/circuit-relay-v2"),this.registrar=t.registrar,this.peerStore=t.peerStore,this.connectionManager=t.connectionManager,this.peerId=t.peerId,this.upgrader=t.upgrader,this.addressManager=t.addressManager,this.connectionGater=t.connectionGater,this.maxInboundStopStreams=null!==(n=r.maxInboundStopStreams)&&void 0!==n?n:XI,this.maxOutboundStopStreams=null!==(i=r.maxOutboundStopStreams)&&void 0!==i?i:JI,this.stopTimeout=null!==(a=r.stopTimeout)&&void 0!==a?a:$I,null!=r.discoverRelays&&r.discoverRelays>0&&(this.discovery=new BI(t),this.discovery.addEventListener("relay:discover",(function(e){s.reservationStore.addRelay(e.detail,"discovered").catch((function(t){GI.error("could not add discovered relay %p",e.detail,t)}))}))),this.reservationStore=new qI(t,r),this.reservationStore.addEventListener("relay:not-enough-relays",(function(){var e;null===(e=s.discovery)||void 0===e||e.discover().catch((function(e){GI.error("could not discover relays",e)}))})),this.started=!1}return(0,fi.Z)(e,[{key:"isStarted",value:function(){return this.started}},{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.reservationStore.start();case 2:return e.next=4,null===(t=this.discovery)||void 0===t?void 0:t.start();case 4:return e.next=6,this.registrar.handle(RI,(function(e){r.onStop(e).catch((function(t){GI.error("error while handling STOP protocol",t),e.stream.abort(t)}))}),{maxInboundStreams:this.maxInboundStopStreams,maxOutboundStreams:this.maxOutboundStopStreams,runOnTransientConnection:!0});case 6:this.started=!0;case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(t=this.discovery)||void 0===t||t.stop(),e.next=3,this.reservationStore.stop();case 3:return e.next=5,this.registrar.unhandle(RI);case 5:this.started=!1;case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dial",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c,l,h,f,d,p,v,g=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=g.length>1&&void 0!==g[1]?g[1]:{},1===t.protoCodes().filter((function(e){return 290===e})).length){e.next=5;break}throw n="Invalid circuit relay address",GI.error(n,t),new wo(n,ww.ERR_RELAYED_DIAL);case 5:if(i=t.toString().split("/p2p-circuit"),a=kb(i[0]),s=kb(i[i.length-1]),o=a.getPeerId(),u=s.getPeerId(),null!=o&&null!=u){e.next=14;break}throw c="Circuit relay dial to ".concat(t.toString()," failed as address did not have peer ids"),GI.error(c),new wo(c,ww.ERR_RELAYED_DIAL);case 14:if(l=em(o),h=em(u),f=!1,d=this.connectionManager.getConnections(l),null!=(p=d[0])){e.next=26;break}return e.next=22,this.peerStore.merge(l,{multiaddrs:[a]});case 22:return e.next=24,this.connectionManager.openConnection(l,r);case 24:p=e.sent,f=!0;case 26:return e.prev=26,e.next=29,p.newStream([DI]);case 29:return v=e.sent,e.next=32,this.connectV2({stream:v,connection:p,destinationPeer:h,destinationAddr:s,relayAddr:a,ma:t,disconnectOnFailure:f});case 32:return e.abrupt("return",e.sent);case 35:if(e.prev=35,e.t0=e.catch(26),GI.error("circuit relay dial to destination %p via relay %p failed",h,l,e.t0),null!=v&&v.abort(e.t0),e.t1=f,!e.t1){e.next=43;break}return e.next=43,p.close();case 43:throw e.t0;case 44:case"end":return e.stop()}}),e,this,[[26,35]])})));return function(t){return e.apply(this,arguments)}}()},{key:"connectV2",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c,l,h,f,d,p;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.stream,n=t.connection,i=t.destinationPeer,a=t.destinationAddr,s=t.relayAddr,o=t.ma,u=t.disconnectOnFailure,e.prev=1,c=kT(r),l=c.pb(_I),e.next=6,l.write({type:_I.Type.CONNECT,peer:{id:i.toBytes(),addrs:[kb(a).bytes]}});case 6:return e.next=8,l.read();case 8:if((h=e.sent).status===SI.OK){e.next=11;break}throw new wo("failed to connect via relay with status ".concat(null!==(f=null===h||void 0===h||null===(d=h.status)||void 0===d?void 0:d.toString())&&void 0!==f?f:"undefined"),ww.ERR_HOP_REQUEST_FAILED);case 11:return p=LI({stream:c.unwrap(),remoteAddr:o,localAddr:s.encapsulate("/p2p-circuit/p2p/".concat(this.peerId.toString()))}),GI("new outbound transient connection %a",p.remoteAddr),e.next=15,this.upgrader.upgradeOutbound(p,{transient:!0});case 15:return e.abrupt("return",e.sent);case 18:if(e.prev=18,e.t0=e.catch(1),GI.error("Circuit relay dial to destination ".concat(i.toString()," via relay ").concat(n.remotePeer.toString()," failed"),e.t0),e.t1=u,!e.t1){e.next=25;break}return e.next=25,n.close();case 25:throw e.t0;case 26:case"end":return e.stop()}}),e,this,[[1,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"createListener",value:function(e){return function(e){return new FI(e)}({connectionManager:this.connectionManager,relayStore:this.reservationStore})}},{key:"filter",value:function(e){return(e=Array.isArray(e)?e:[e]).filter((function(e){return QC.matches(e)}))}},{key:"onStop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c,l,h,f;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.connection,a=t.stream,s=AbortSignal.timeout(this.stopTimeout),o=kT(a).pb(wI),e.next=5,o.read({signal:s});case 5:if(u=e.sent,GI("new circuit relay v2 stop stream from %p with type %s",i.remotePeer,u.type),void 0!==(null===u||void 0===u?void 0:u.type)){e.next=14;break}return GI.error("type was missing from circuit v2 stop protocol request from %s",i.remotePeer),e.next=11,o.write({type:wI.Type.STATUS,status:SI.MALFORMED_MESSAGE},{signal:s});case 11:return e.next=13,a.close();case 13:return e.abrupt("return");case 14:if(u.type===wI.Type.CONNECT){e.next=21;break}return GI.error("invalid stop connect request via peer %p",i.remotePeer),e.next=18,o.write({type:wI.Type.STATUS,status:SI.UNEXPECTED_MESSAGE},{signal:s});case 18:return e.next=20,a.close();case 20:return e.abrupt("return");case 21:if(QI(u)){e.next=28;break}return GI.error("invalid stop connect request via peer %p",i.remotePeer),e.next=25,o.write({type:wI.Type.STATUS,status:SI.MALFORMED_MESSAGE},{signal:s});case 25:return e.next=27,a.close();case 27:return e.abrupt("return");case 28:return c=tm(u.peer.id),e.next=31,null===(r=(n=this.connectionGater).denyInboundRelayedConnection)||void 0===r?void 0:r.call(n,i.remotePeer,c);case 31:if(e.t0=e.sent,!0!==e.t0){e.next=39;break}return GI.error("connection gater denied inbound relayed connection from %p",i.remotePeer),e.next=36,o.write({type:wI.Type.STATUS,status:SI.PERMISSION_DENIED},{signal:s});case 36:return e.next=38,a.close();case 38:return e.abrupt("return");case 39:return GI.trace("sending success response to %p",i.remotePeer),e.next=42,o.write({type:wI.Type.STATUS,status:SI.OK},{signal:s});case 42:return l=i.remoteAddr.encapsulate("/p2p-circuit/p2p/".concat(c.toString())),h=this.addressManager.getAddresses()[0],f=LI({stream:o.unwrap().unwrap(),remoteAddr:l,localAddr:h}),GI("new inbound transient connection %a",f.remoteAddr),e.next=48,this.upgrader.upgradeInbound(f,{transient:!0});case 48:GI("%s connection %a upgraded","inbound",f.remoteAddr);case 49:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function tP(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){return new eP(t,e)}}var rP=function(){var e=new Error("Delay aborted");return e.name="AbortError",e},nP=new WeakMap;var iP,aP=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.clearTimeout,r=e.setTimeout;return function(e){var n,i,a,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=s.value,u=s.signal;if(null!==u&&void 0!==u&&u.aborted)return Promise.reject(rP());var c=null!==t&&void 0!==t?t:clearTimeout,l=function(){c(n),a(rP())},h=new Promise((function(t,s){i=function(){u&&u.removeEventListener("abort",l),t(o)},a=s,n=(null!==r&&void 0!==r?r:setTimeout)(i,e)}));return u&&u.addEventListener("abort",l,{once:!0}),nP.set(h,(function(){c(n),n=null,i()})),h}}(),sP=aP;!function(e){var t,r;!function(e){e.UNUSED="UNUSED",e.CONNECT="CONNECT",e.SYNC="SYNC"}(e.Type||(e.Type={})),function(e){e[e.UNUSED=0]="UNUSED",e[e.CONNECT=100]="CONNECT",e[e.SYNC=300]="SYNC"}(t||(t={})),function(e){e.codec=function(){return Qo(t)}}(e.Type||(e.Type={})),e.codec=function(){return null==r&&(r=Xo((function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&r.fork(),null!=t.type&&(r.uint32(8),e.Type.codec().encode(t.type,r)),null!=t.observedAddresses){var i,a=(0,ge.Z)(t.observedAddresses);try{for(a.s();!(i=a.n()).done;){var s=i.value;r.uint32(18),r.bytes(s)}}catch(S$){a.e(S$)}finally{a.f()}}!1!==n.lengthDelimited&&r.ldelim()}),(function(t,r){for(var n={observedAddresses:[]},i=null==r?t.len:t.pos+r;t.pos<i;){var a=t.uint32();switch(a>>>3){case 1:n.type=e.Type.codec().decode(t);break;case 2:n.observedAddresses.push(t.bytes());break;default:t.skipType(7&a)}}return n}))),r},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(iP||(iP={}));var oP=zi("libp2p:dcutr"),uP=5e3,cP=3,lP=1,hP=1,fP=function(){function e(t,r){var n,i,a,s;(0,hi.Z)(this,e),(0,we.Z)(this,"started",void 0),(0,we.Z)(this,"timeout",void 0),(0,we.Z)(this,"retries",void 0),(0,we.Z)(this,"maxInboundStreams",void 0),(0,we.Z)(this,"maxOutboundStreams",void 0),(0,we.Z)(this,"peerStore",void 0),(0,we.Z)(this,"registrar",void 0),(0,we.Z)(this,"connectionManager",void 0),(0,we.Z)(this,"addressManager",void 0),(0,we.Z)(this,"transportManager",void 0),(0,we.Z)(this,"topologyId",void 0),this.started=!1,this.peerStore=t.peerStore,this.registrar=t.registrar,this.addressManager=t.addressManager,this.connectionManager=t.connectionManager,this.transportManager=t.transportManager,this.timeout=null!==(n=r.timeout)&&void 0!==n?n:uP,this.retries=null!==(i=r.retries)&&void 0!==i?i:cP,this.maxInboundStreams=null!==(a=r.maxInboundStreams)&&void 0!==a?a:lP,this.maxOutboundStreams=null!==(s=r.maxOutboundStreams)&&void 0!==s?s:hP}return(0,fi.Z)(e,[{key:"isStarted",value:function(){return this.started}},{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.started){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.registrar.register(dP,{onConnect:function(e,r){r.transient&&"inbound"===r.direction&&t.upgradeInbound(r).catch((function(e){oP.error("error during outgoing DCUtR attempt",e)}))}});case 4:return this.topologyId=e.sent,e.next=7,this.registrar.handle(dP,(function(e){t.handleIncomingUpgrade(e.stream,e.connection).catch((function(t){oP.error("error during incoming DCUtR attempt",t),e.stream.abort(t)}))}),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams,runOnTransientConnection:!0});case 7:this.started=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.registrar.unhandle(dP);case 2:null!=this.topologyId&&this.registrar.unregister(this.topologyId),this.started=!1;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"upgradeInbound",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c,l,h;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.attemptUnilateralConnectionUpgrade(t);case 2:if(!e.sent){e.next=4;break}return e.abrupt("return");case 4:n=0;case 5:if(!(n<this.retries)){e.next=58;break}return i={signal:AbortSignal.timeout(this.timeout)},e.prev=7,e.next=10,t.newStream([dP],{signal:i.signal,runOnTransientConnection:!0});case 10:return r=e.sent,a=kT(r,{maxDataLength:4096}).pb(iP),oP("B sending connect to %p",t.remotePeer),s=Date.now(),e.next=16,a.write({type:iP.Type.CONNECT,observedAddresses:this.addressManager.getAddresses().map((function(e){return e.bytes}))},i);case 16:return oP("B receiving connect from %p",t.remotePeer),e.next=19,a.read(i);case 19:if((o=e.sent).type===iP.Type.CONNECT){e.next=23;break}throw oP("A sent wrong message type"),new wo("DCUtR message type was incorrect",ww.ERR_INVALID_MESSAGE);case 23:if(0!==(u=this.getDialableMultiaddrs(o.observedAddresses)).length){e.next=27;break}throw oP("A did not have any dialable multiaddrs"),new wo("DCUtR connect message had no multiaddrs",ww.ERR_INVALID_MESSAGE);case 27:return c=Date.now()-s,oP("A sending sync, rtt %dms",c),e.next=31,a.write({type:iP.Type.SYNC,observedAddresses:[]},i);case 31:return oP("A waiting for half RTT"),e.next=34,sP(c/2);case 34:return oP("B dialing",u),e.next=37,this.connectionManager.openConnection(u,{signal:i.signal,priority:100});case 37:return l=e.sent,oP("DCUtR to %p succeeded to address %a, closing relayed connection",t.remotePeer,l.remoteAddr),e.next=41,t.close(i);case 41:return e.abrupt("break",58);case 44:if(e.prev=44,e.t0=e.catch(7),oP.error("error while attempting DCUtR on attempt %d of %d",n+1,this.retries,e.t0),null===(h=r)||void 0===h||h.abort(e.t0),n!==this.retries){e.next=50;break}throw e.t0;case 50:if(e.prev=50,null==r){e.next=54;break}return e.next=54,r.close(i);case 54:return e.finish(50);case 55:n++,e.next=5;break;case 58:case"end":return e.stop()}}),e,this,[[7,44,50,55]])})));return function(t){return e.apply(this,arguments)}}()},{key:"attemptUnilateralConnectionUpgrade",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.peerStore.get(t.remotePeer);case 2:if(r=e.sent,!((n=r.addresses.map((function(e){var r=e.multiaddr;return null==r.getPeerId()?r.encapsulate("/p2p/".concat(t.remotePeer)):r})).filter((function(e){return s.isPublicAndDialable(e)}))).length>0)){e.next=24;break}return i=AbortSignal.timeout(this.timeout),e.prev=6,oP("attempting unilateral connection upgrade to %a",n),e.next=10,this.connectionManager.openConnection(n,{signal:i,force:!0});case 10:if(!(a=e.sent).transient){e.next=13;break}throw new Error("Could not open a new, non-transient, connection");case 13:return oP("unilateral connection upgrade to %p succeeded via %a, closing relayed connection",t.remotePeer,a.remoteAddr),e.next=16,t.close({signal:i});case 16:return e.abrupt("return",!0);case 19:e.prev=19,e.t0=e.catch(6),oP.error("unilateral connection upgrade to %p on addresses %a failed",t.remotePeer,n,e.t0);case 22:e.next=25;break;case 24:oP("peer %p has no public addresses, not attempting unilateral connection upgrade",t.remotePeer);case 25:return e.abrupt("return",!1);case 26:case"end":return e.stop()}}),e,this,[[6,19]])})));return function(t){return e.apply(this,arguments)}}()},{key:"handleIncomingUpgrade",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={signal:AbortSignal.timeout(this.timeout)},e.prev=1,i=kT(t,{maxDataLength:4096}).pb(iP),oP("A receiving connect"),e.next=6,i.read(n);case 6:if((a=e.sent).type===iP.Type.CONNECT){e.next=10;break}throw oP("B sent wrong message type"),new wo("DCUtR message type was incorrect",ww.ERR_INVALID_MESSAGE);case 10:if(0!==a.observedAddresses.length){e.next=13;break}throw oP("B sent no multiaddrs"),new wo("DCUtR connect message had no multiaddrs",ww.ERR_INVALID_MESSAGE);case 13:if(0!==(s=this.getDialableMultiaddrs(a.observedAddresses)).length){e.next=17;break}throw oP("B had no dialable multiaddrs"),new wo("DCUtR connect message had no dialable multiaddrs",ww.ERR_INVALID_MESSAGE);case 17:return oP("A sending connect"),e.next=20,i.write({type:iP.Type.CONNECT,observedAddresses:this.addressManager.getAddresses().map((function(e){return e.bytes}))});case 20:return oP("A receiving sync"),e.next=23,i.read(n);case 23:if(e.sent.type===iP.Type.SYNC){e.next=26;break}throw new wo("DCUtR message type was incorrect",ww.ERR_INVALID_MESSAGE);case 26:return oP("A dialing",s),e.next=29,this.connectionManager.openConnection(s,{signal:n.signal,priority:100,force:!0});case 29:return o=e.sent,oP("DCUtR to %p succeeded via %a, closing relayed connection",r.remotePeer,o.remoteAddr),e.next=33,r.close(n);case 33:e.next=39;break;case 35:e.prev=35,e.t0=e.catch(1),oP.error("incoming DCUtR from %p failed",r.remotePeer,e.t0),t.abort(e.t0);case 39:return e.prev=39,e.next=42,t.close(n);case 42:return e.finish(39);case 43:case"end":return e.stop()}}),e,this,[[1,35,39,43]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getDialableMultiaddrs",value:function(e){var t,r=[],n=(0,ge.Z)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(null!=i&&0!==i.length)try{var a=kb(i);if(!this.isPublicAndDialable(a))continue;r.push(a)}catch(s){}}}catch(S$){n.e(S$)}finally{n.f()}return r}},{key:"isPublicAndDialable",value:function(e){if(cw.matches(e))return!1;if(H_.matches(e))return!0;if(!Y_.matches(e))return!1;if(null==this.transportManager.transportForMultiaddr(e))return!1;var t=e.toOptions();return!1===S_(t.host)}}]),e}(),dP="/libp2p/dcutr";function pP(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){return new fP(t,e)}}var vP,gP="js-libp2p/".concat("0.46.14");!function(e){var t;e.codec=function(){return null==t&&(t=Xo((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==r.lengthDelimited&&t.fork(),null!=e.protocolVersion&&(t.uint32(42),t.string(e.protocolVersion)),null!=e.agentVersion&&(t.uint32(50),t.string(e.agentVersion)),null!=e.publicKey&&(t.uint32(10),t.bytes(e.publicKey)),null!=e.listenAddrs){var n,i=(0,ge.Z)(e.listenAddrs);try{for(i.s();!(n=i.n()).done;){var a=n.value;t.uint32(18),t.bytes(a)}}catch(S$){i.e(S$)}finally{i.f()}}if(null!=e.observedAddr&&(t.uint32(34),t.bytes(e.observedAddr)),null!=e.protocols){var s,o=(0,ge.Z)(e.protocols);try{for(o.s();!(s=o.n()).done;){var u=s.value;t.uint32(26),t.string(u)}}catch(S$){o.e(S$)}finally{o.f()}}null!=e.signedPeerRecord&&(t.uint32(66),t.bytes(e.signedPeerRecord)),!1!==r.lengthDelimited&&t.ldelim()}),(function(e,t){for(var r={listenAddrs:[],protocols:[]},n=null==t?e.len:e.pos+t;e.pos<n;){var i=e.uint32();switch(i>>>3){case 5:r.protocolVersion=e.string();break;case 6:r.agentVersion=e.string();break;case 1:r.publicKey=e.bytes();break;case 2:r.listenAddrs.push(e.bytes());break;case 4:r.observedAddr=e.bytes();break;case 3:r.protocols.push(e.string());break;case 8:r.signedPeerRecord=e.bytes();break;default:e.skipType(7&i)}}return r}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(vP||(vP={}));var yP=zi("libp2p:identify"),mP=8192,bP={protocolPrefix:"ipfs",agentVersion:gP,timeout:6e4,maxInboundStreams:1,maxOutboundStreams:1,maxPushIncomingStreams:1,maxPushOutgoingStreams:1,maxObservedAddresses:10,maxIdentifyMessageSize:8192,runOnConnectionOpen:!0,runOnTransientConnection:!0},_P=new WeakSet,wP=function(){function e(t,r){var n,i,a,s,o,u,c,l,h,f,d,p,v,g=this;(0,hi.Z)(this,e),ic(this,_P),(0,we.Z)(this,"identifyProtocolStr",void 0),(0,we.Z)(this,"identifyPushProtocolStr",void 0),(0,we.Z)(this,"host",void 0),(0,we.Z)(this,"started",void 0),(0,we.Z)(this,"timeout",void 0),(0,we.Z)(this,"peerId",void 0),(0,we.Z)(this,"peerStore",void 0),(0,we.Z)(this,"registrar",void 0),(0,we.Z)(this,"connectionManager",void 0),(0,we.Z)(this,"addressManager",void 0),(0,we.Z)(this,"maxInboundStreams",void 0),(0,we.Z)(this,"maxOutboundStreams",void 0),(0,we.Z)(this,"maxPushIncomingStreams",void 0),(0,we.Z)(this,"maxPushOutgoingStreams",void 0),(0,we.Z)(this,"maxIdentifyMessageSize",void 0),(0,we.Z)(this,"maxObservedAddresses",void 0),(0,we.Z)(this,"events",void 0),(0,we.Z)(this,"runOnTransientConnection",void 0),this.started=!1,this.peerId=t.peerId,this.peerStore=t.peerStore,this.registrar=t.registrar,this.addressManager=t.addressManager,this.connectionManager=t.connectionManager,this.events=t.events,this.identifyProtocolStr="/".concat(null!==(n=r.protocolPrefix)&&void 0!==n?n:bP.protocolPrefix,"/").concat("id","/").concat("1.0.0"),this.identifyPushProtocolStr="/".concat(null!==(i=r.protocolPrefix)&&void 0!==i?i:bP.protocolPrefix,"/").concat("id/push","/").concat("1.0.0"),this.timeout=null!==(a=r.timeout)&&void 0!==a?a:bP.timeout,this.maxInboundStreams=null!==(s=r.maxInboundStreams)&&void 0!==s?s:bP.maxInboundStreams,this.maxOutboundStreams=null!==(o=r.maxOutboundStreams)&&void 0!==o?o:bP.maxOutboundStreams,this.maxPushIncomingStreams=null!==(u=r.maxPushIncomingStreams)&&void 0!==u?u:bP.maxPushIncomingStreams,this.maxPushOutgoingStreams=null!==(c=r.maxPushOutgoingStreams)&&void 0!==c?c:bP.maxPushOutgoingStreams,this.maxIdentifyMessageSize=null!==(l=r.maxIdentifyMessageSize)&&void 0!==l?l:bP.maxIdentifyMessageSize,this.maxObservedAddresses=null!==(h=r.maxObservedAddresses)&&void 0!==h?h:bP.maxObservedAddresses,this.runOnTransientConnection=null!==(f=r.runOnTransientConnection)&&void 0!==f?f:bP.runOnTransientConnection,this.host={protocolVersion:"".concat(null!==(d=r.protocolPrefix)&&void 0!==d?d:bP.protocolPrefix,"/").concat("0.1.0"),agentVersion:null!==(p=r.agentVersion)&&void 0!==p?p:bP.agentVersion},(null!==(v=r.runOnConnectionOpen)&&void 0!==v?v:bP.runOnConnectionOpen)&&t.events.addEventListener("connection:open",(function(e){var t=e.detail;g.identify(t).catch((function(e){yP.error("error during identify trigged by connection:open",e)}))})),t.events.addEventListener("self:peer:update",(function(e){g.push().catch((function(e){yP.error(e)}))})),this.host.agentVersion===gP&&(CZ||EZ?this.host.agentVersion+=" UserAgent=".concat(globalThis.process.version):(xZ||AZ||SZ||DZ)&&(this.host.agentVersion+=" UserAgent=".concat(globalThis.navigator.userAgent)))}return(0,fi.Z)(e,[{key:"isStarted",value:function(){return this.started}},{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.started){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.peerStore.merge(this.peerId,{metadata:{AgentVersion:Hs(this.host.agentVersion),ProtocolVersion:Hs(this.host.protocolVersion)}});case 4:return e.next=6,this.registrar.handle(this.identifyProtocolStr,(function(e){t._handleIdentify(e).catch((function(e){yP.error(e)}))}),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams,runOnTransientConnection:this.runOnTransientConnection});case 6:return e.next=8,this.registrar.handle(this.identifyPushProtocolStr,(function(e){t._handlePush(e).catch((function(e){yP.error(e)}))}),{maxInboundStreams:this.maxPushIncomingStreams,maxOutboundStreams:this.maxPushOutgoingStreams,runOnTransientConnection:this.runOnTransientConnection});case 8:this.started=!0;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.registrar.unhandle(this.identifyProtocolStr);case 2:return e.next=4,this.registrar.unhandle(this.identifyPushProtocolStr);case 4:this.started=!1;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pushToConnections",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c,l,h,f=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.addressManager.getAddresses().map((function(e){return e.decapsulateCode(Gm("p2p").code)})),a=new Cb({peerId:this.peerId,multiaddrs:i}),e.next=4,Im.seal(a,this.peerId);case 4:return s=e.sent,o=this.registrar.getProtocols(),e.next=8,this.peerStore.get(this.peerId);case 8:return u=e.sent,c=Ws(null!==(r=u.metadata.get("AgentVersion"))&&void 0!==r?r:Hs(this.host.agentVersion)),l=Ws(null!==(n=u.metadata.get("ProtocolVersion"))&&void 0!==n?n:Hs(this.host.protocolVersion)),h=t.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,a,u,h;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=AbortSignal.timeout(f.timeout);try{null===Wu.setMaxListeners||void 0===Wu.setMaxListeners||(0,Wu.setMaxListeners)(1/0,n)}catch(d){}return e.prev=2,e.next=5,t.newStream([f.identifyPushProtocolStr],{signal:n,runOnTransientConnection:f.runOnTransientConnection});case 5:return r=e.sent,u=kT(r,{maxDataLength:null!==(a=f.maxIdentifyMessageSize)&&void 0!==a?a:mP}).pb(vP),e.next=9,u.write({listenAddrs:i.map((function(e){return e.bytes})),signedPeerRecord:s.marshal(),protocols:o,agentVersion:c,protocolVersion:l},{signal:n});case 9:return e.next=11,r.close({signal:n});case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(2),yP.error("could not push identify update to peer",e.t0),null===(h=r)||void 0===h||h.abort(e.t0);case 17:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t){return e.apply(this,arguments)}}()),e.next=14,Promise.all(h);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"push",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isStarted()){e.next=2;break}return e.abrupt("return");case 2:return t=[],e.next=5,Promise.all(this.connectionManager.getConnections().map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(n){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.peerStore.get(n.remotePeer);case 3:if(e.sent.protocols.includes(r.identifyPushProtocolStr)){e.next=6;break}return e.abrupt("return");case 6:t.push(n),e.next=13;break;case 9:if(e.prev=9,e.t0=e.catch(0),e.t0.code===ww.ERR_NOT_FOUND){e.next=13;break}throw e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()));case 5:return e.next=7,this.pushToConnections(t);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_identify",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=c.length>1&&void 0!==c[1]?c[1]:{}).signal=null!==(r=n.signal)&&void 0!==r?r:AbortSignal.timeout(this.timeout),e.prev=2,e.next=5,t.newStream([this.identifyProtocolStr],(0,_e.Z)((0,_e.Z)({},n),{},{runOnTransientConnection:this.runOnTransientConnection}));case 5:return i=e.sent,s=kT(i,{maxDataLength:null!==(a=this.maxIdentifyMessageSize)&&void 0!==a?a:mP}).pb(vP),e.next=9,s.read(n);case 9:return o=e.sent,e.next=12,i.close(n);case 12:return e.abrupt("return",o);case 15:throw e.prev=15,e.t0=e.catch(2),yP.error("error while reading identify message",e.t0),null===(u=i)||void 0===u||u.abort(e.t0),e.t0;case 20:case"end":return e.stop()}}),e,this,[[2,15]])})));return function(t){return e.apply(this,arguments)}}()},{key:"identify",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c,l,h,f=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=f.length>1&&void 0!==f[1]?f[1]:{},e.next=3,this._identify(t,n);case 3:if(i=e.sent,a=i.publicKey,s=i.protocols,o=i.observedAddr,null!=a){e.next=7;break}throw new wo("public key was missing from identify message",ww.ERR_MISSING_PUBLIC_KEY);case 7:return e.next=9,rm(a);case 9:if(u=e.sent,t.remotePeer.equals(u)){e.next=12;break}throw new wo("identified peer does not match the expected peer",ww.ERR_INVALID_PEER);case 12:if(!this.peerId.equals(u)){e.next=14;break}throw new wo("identified peer is our own peer id?",ww.ERR_INVALID_PEER);case 14:return c=EP(o),yP("identify completed for peer %p and protocols %o",u,s),yP("our observed address is %a",c),null!=c&&this.addressManager.getObservedAddrs().length<(null!==(r=this.maxObservedAddresses)&&void 0!==r?r:1/0)&&(yP("storing our observed address %a",c),this.addressManager.addObservedAddr(c)),e.next=20,ac(this,_P,kP).call(this,t.remotePeer,i);case 20:return l=e.sent,h={peerId:u,protocolVersion:i.protocolVersion,agentVersion:i.agentVersion,publicKey:i.publicKey,listenAddrs:i.listenAddrs.map((function(e){return kb(e)})),observedAddr:null==i.observedAddr?void 0:kb(i.observedAddr),protocols:i.protocols,signedPeerRecord:l},this.events.safeDispatchEvent("peer:identify",{detail:h}),e.abrupt("return",h);case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_handleIdentify",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c,l,h,f;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.connection,n=t.stream,i=AbortSignal.timeout(this.timeout);try{null===Wu.setMaxListeners||void 0===Wu.setMaxListeners||(0,Wu.setMaxListeners)(1/0,i)}catch(d){}return e.prev=3,s=null!==(a=this.peerId.publicKey)&&void 0!==a?a:new Uint8Array(0),e.next=7,this.peerStore.get(this.peerId);case 7:if(o=e.sent,u=this.addressManager.getAddresses().map((function(e){return e.decapsulateCode(Gm("p2p").code)})),c=o.peerRecordEnvelope,!(u.length>0&&null==c)){e.next=16;break}return l=new Cb({peerId:this.peerId,multiaddrs:u}),e.next=14,Im.seal(l,this.peerId);case 14:h=e.sent,c=h.marshal().subarray();case 16:return f=kT(n).pb(vP),e.next=19,f.write({protocolVersion:this.host.protocolVersion,agentVersion:this.host.agentVersion,publicKey:s,listenAddrs:u.map((function(e){return e.bytes})),signedPeerRecord:c,observedAddr:r.remoteAddr.bytes,protocols:o.protocols},{signal:i});case 19:return e.next=21,n.close({signal:i});case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(3),yP.error("could not respond to identify request",e.t0),n.abort(e.t0);case 27:case"end":return e.stop()}}),e,this,[[3,23]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_handlePush",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.connection,n=t.stream,e.prev=1,!this.peerId.equals(r.remotePeer)){e.next=4;break}throw new Error("received push from ourselves?");case 4:return a={signal:AbortSignal.timeout(this.timeout)},s=kT(n,{maxDataLength:null!==(i=this.maxIdentifyMessageSize)&&void 0!==i?i:mP}).pb(vP),e.next=8,s.read(a);case 8:return o=e.sent,e.next=11,n.close(a);case 11:return e.next=13,ac(this,_P,kP).call(this,r.remotePeer,o);case 13:e.next=20;break;case 15:return e.prev=15,e.t0=e.catch(1),yP.error("received invalid message",e.t0),n.abort(e.t0),e.abrupt("return");case 20:yP("handled push from %p",r.remotePeer);case 21:case"end":return e.stop()}}),e,this,[[1,15]])})));return function(t){return e.apply(this,arguments)}}()}]),e}();function kP(e,t){return xP.apply(this,arguments)}function xP(){return xP=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c,l;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(yP("received identify from %p",t),null!=r){e.next=3;break}throw new Error("Message was null or undefined");case 3:if(n={addresses:r.listenAddrs.map((function(e){return{isCertified:!1,multiaddr:kb(e)}})),protocols:r.protocols,metadata:new Map,peerRecordEnvelope:r.signedPeerRecord},null==r.signedPeerRecord){e.next=38;break}return yP("received signedPeerRecord in push from %p",t),a=r.signedPeerRecord,e.next=9,Im.openAndCertify(a,Cb.DOMAIN);case 9:if(s=e.sent,(o=Cb.createFromProtobuf(s.payload)).peerId.equals(s.peerId)){e.next=13;break}throw new Error("signing key does not match PeerId in the PeerRecord");case 13:if(t.equals(o.peerId)){e.next=15;break}throw new Error("signing key does not match remote PeerId");case 15:return e.prev=15,e.next=18,this.peerStore.get(o.peerId);case 18:u=e.sent,e.next=25;break;case 21:if(e.prev=21,e.t0=e.catch(15),"ERR_NOT_FOUND"===e.t0.code){e.next=25;break}throw e.t0;case 25:if(null==u){e.next=33;break}if(n.metadata=u.metadata,null==u.peerRecordEnvelope){e.next=33;break}return e.next=30,Im.createFromProtobuf(u.peerRecordEnvelope);case 30:c=e.sent,(l=Cb.createFromProtobuf(c.payload)).seqNumber>=o.seqNumber&&(yP("sequence number was lower or equal to existing sequence number - stored: %d received: %d",l.seqNumber,o.seqNumber),o=l,a=u.peerRecordEnvelope);case 33:n.peerRecordEnvelope=a,n.addresses=o.multiaddrs.map((function(e){return{isCertified:!0,multiaddr:e}})),i={seq:o.seqNumber,addresses:o.multiaddrs},e.next=39;break;case 38:yP("%p did not send a signed peer record",t);case 39:return null!=r.agentVersion&&n.metadata.set("AgentVersion",Hs(r.agentVersion)),null!=r.protocolVersion&&n.metadata.set("ProtocolVersion",Hs(r.protocolVersion)),e.next=43,this.peerStore.patch(t,n);case 43:return e.abrupt("return",i);case 44:case"end":return e.stop()}}),e,this,[[15,21]])}))),xP.apply(this,arguments)}function EP(e){if(null!=e&&e.length>0)try{return kb(e)}catch(t){}}function SP(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){return new wP(t,e)}}var CP=zi("libp2p:ping"),AP=function(){function e(t,r){var n,i,a,s,o;(0,hi.Z)(this,e),(0,we.Z)(this,"protocol",void 0),(0,we.Z)(this,"components",void 0),(0,we.Z)(this,"started",void 0),(0,we.Z)(this,"timeout",void 0),(0,we.Z)(this,"maxInboundStreams",void 0),(0,we.Z)(this,"maxOutboundStreams",void 0),(0,we.Z)(this,"runOnTransientConnection",void 0),this.components=t,this.started=!1,this.protocol="/".concat(null!==(n=r.protocolPrefix)&&void 0!==n?n:"ipfs","/").concat("ping","/").concat("1.0.0"),this.timeout=null!==(i=r.timeout)&&void 0!==i?i:1e4,this.maxInboundStreams=null!==(a=r.maxInboundStreams)&&void 0!==a?a:2,this.maxOutboundStreams=null!==(s=r.maxOutboundStreams)&&void 0!==s?s:1,this.runOnTransientConnection=null===(o=r.runOnTransientConnection)||void 0===o||o}return(0,fi.Z)(e,[{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.components.registrar.handle(this.protocol,this.handleMessage,{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams,runOnTransientConnection:this.runOnTransientConnection});case 2:this.started=!0;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.components.registrar.unhandle(this.protocol);case 2:this.started=!1;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isStarted",value:function(){return this.started}},{key:"handleMessage",value:function(e){CP("incoming ping from %p",e.connection.remotePeer);var t=e.stream,r=Date.now();no(t,t).catch((function(t){CP.error("incoming ping from %p failed with error",e.connection.remotePeer,t)})).finally((function(){var t=Date.now()-r;CP("incoming ping from %p complete in %dms",e.connection.remotePeer,t)}))}},{key:"ping",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c,l,h,f=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=f.length>1&&void 0!==f[1]?f[1]:{},CP("pinging %p",t),i=Date.now(),a=hg(32),e.next=6,this.components.connectionManager.openConnection(t,n);case 6:return s=e.sent,u=function(){},n.signal=null!==(r=n.signal)&&void 0!==r?r:AbortSignal.timeout(this.timeout),e.prev=9,e.next=12,s.newStream(this.protocol,(0,_e.Z)((0,_e.Z)({},n),{},{runOnTransientConnection:this.runOnTransientConnection}));case 12:return o=e.sent,u=function(){var e;null===(e=o)||void 0===e||e.abort(new wo("ping timeout",ww.ERR_TIMEOUT))},n.signal.addEventListener("abort",u,{once:!0}),e.next=17,no([a],o,function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",pk(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 17:if(c=e.sent,l=Date.now()-i,null!=c){e.next=21;break}throw new wo("Did not receive a ping ack after ".concat(l,"ms"),ww.ERR_WRONG_PING_ACK);case 21:if(Ao(a,c.subarray())){e.next=23;break}throw new wo("Received wrong ping ack after ".concat(l,"ms"),ww.ERR_WRONG_PING_ACK);case 23:return CP("ping %p complete in %dms",s.remotePeer,l),e.abrupt("return",l);case 27:throw e.prev=27,e.t0=e.catch(9),CP.error("error while pinging %p",s.remotePeer,e.t0),null===(h=o)||void 0===h||h.abort(e.t0),e.t0;case 32:if(e.prev=32,n.signal.removeEventListener("abort",u),null==o){e.next=37;break}return e.next=37,o.close();case 37:return e.finish(32);case 38:case"end":return e.stop()}}),e,this,[[9,27,32,38]])})));return function(t){return e.apply(this,arguments)}}()}]),e}();function DP(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){return new AP(t,e)}}var RP={list:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/ip4/104.131.131.82/tcp/4001/p2p/QmaCpDMGvV2BGHeYERUEnRQAwe3N8SzbUtfsmvsqQLuvuJ"]};function TP(e,t){return ZP.apply(this,arguments)}function ZP(){return ZP=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={addresses:{listen:["/webrtc"]},transports:[tP({discoverRelays:1}),aZ(),iZ(),YZ(),OZ()],connectionEncryption:[qS()],streamMuxers:[xC(),ZR()],peerDiscovery:[iA(RP)],contentRouters:[fA("https://cid.contact")],services:{identify:SP(),autoNAT:bI(),pubsub:kE(),dcutr:pP(),dht:uR({clientMode:!0,validators:{ipns:pI},selectors:{ipns:lI}}),ping:DP()}},r=null!==(n=r)&&void 0!==n?n:{},e.abrupt("return",ax((0,_e.Z)((0,_e.Z)((0,_e.Z)({datastore:t},i),r),{},{start:!1})));case 3:case"end":return e.stop()}}),e)}))),ZP.apply(this,arguments)}var IP="2.0.3",PP="helia",LP=zi("helia");function MP(){return BP.apply(this,arguments)}function BP(){return BP=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n,i,a,s,o,u=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null!==(t=(n=u.length>0&&void 0!==u[0]?u[0]:{}).datastore)&&void 0!==t?t:new to,a=null!==(r=n.blockstore)&&void 0!==r?r:new Ya,!OP(n.libp2p)){e.next=7;break}s=n.libp2p,e.next=10;break;case 7:return e.next=9,TP(i,n.libp2p);case 9:s=e.sent;case 10:if(o=new Rd((0,_e.Z)((0,_e.Z)({},n),{},{datastore:i,blockstore:a,libp2p:s})),!1===n.start){e.next=14;break}return e.next=14,o.start();case 14:return NP(o),e.abrupt("return",o);case 16:case"end":return e.stop()}}),e)}))),BP.apply(this,arguments)}function OP(e){if(null==e)return!1;return["dial","dialProtocol","hangUp","handle","unhandle","getMultiaddrs","getProtocols"].every((function(t){return"function"===typeof e[t]}))}function NP(e){try{if(null==e.libp2p.services.identify.host.agentVersion.match(/js-libp2p\/\d+\.\d+\.\d+\sUserAgent=/))return;e.libp2p.services.identify.host.agentVersion="".concat(PP,"/").concat(IP," ").concat(e.libp2p.services.identify.host.agentVersion)}catch(S$){LP.error("could not add Helia to agent version",S$)}}var FP,UP,zP=zi("libp2p:delegated-content-routing"),jP=3e4;!function(e){e[e.SENDING_QUERY=0]="SENDING_QUERY",e[e.PEER_RESPONSE=1]="PEER_RESPONSE",e[e.FINAL_PEER=2]="FINAL_PEER",e[e.QUERY_ERROR=3]="QUERY_ERROR",e[e.PROVIDER=4]="PROVIDER",e[e.VALUE=5]="VALUE",e[e.ADDING_PEER=6]="ADDING_PEER",e[e.DIALING_PEER=7]="DIALING_PEER"}(FP||(FP={})),function(e){e[e.PUT_VALUE=0]="PUT_VALUE",e[e.GET_VALUE=1]="GET_VALUE",e[e.ADD_PROVIDER=2]="ADD_PROVIDER",e[e.GET_PROVIDERS=3]="GET_PROVIDERS",e[e.FIND_NODE=4]="FIND_NODE",e[e.PING=5]="PING"}(UP||(UP={}));var HP=function(){function e(t){if((0,hi.Z)(this,e),(0,we.Z)(this,"client",void 0),(0,we.Z)(this,"httpQueue",void 0),(0,we.Z)(this,"httpQueueRefs",void 0),(0,we.Z)(this,"started",void 0),(0,we.Z)(this,"abortController",void 0),null==t)throw new Error("missing ipfs http client");this.client=t,this.started=!1,this.abortController=new AbortController,this.httpQueue=new Bh({concurrency:4}),this.httpQueueRefs=new Bh({concurrency:2});var r=t.getEndpointConfig(),n=r.protocol,i=r.host,a=r.port;zP("enabled DelegatedContentRouting via ".concat(n,"://").concat(i,":").concat(a))}return(0,fi.Z)(e,[{key:"isStarted",value:function(){return this.started}},{key:"start",value:function(){this.started=!0}},{key:"stop",value:function(){this.httpQueue.clear(),this.httpQueueRefs.clear(),this.abortController.abort(),this.abortController=new AbortController,this.started=!1}},{key:"findProviders",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l,h,f,d;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return zP("findProviders starts: %c",e),r.timeout=null!==(i=r.timeout)&&void 0!==i?i:jP,a=vo([t.abortController.signal,r.signal]),s=ts(),o=ts(),t.httpQueue.add((0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.resolve(),e.abrupt("return",o.promise);case 2:case"end":return e.stop()}}),e)})))),n.prev=6,n.next=9,Ji(s.promise);case 9:u=!1,c=!1,n.prev=11,h=ui(t.client.dht.findProvs(e,(0,_e.Z)((0,_e.Z)({},r),{},{signal:a})));case 13:return n.next=15,Ji(h.next());case 15:if(!(u=!(f=n.sent).done)){n.next=22;break}if("PROVIDER"!==(d=f.value).name){n.next=19;break}return n.delegateYield(Xa(ui(d.providers.map((function(e){return{id:e.id,protocols:[],multiaddrs:e.multiaddrs}})))),"t0",19);case 19:u=!1,n.next=13;break;case 22:n.next=28;break;case 24:n.prev=24,n.t1=n.catch(11),c=!0,l=n.t1;case 28:if(n.prev=28,n.prev=29,!u||null==h.return){n.next=33;break}return n.next=33,Ji(h.return());case 33:if(n.prev=33,!c){n.next=36;break}throw l;case 36:return n.finish(33);case 37:return n.finish(28);case 38:n.next=44;break;case 40:throw n.prev=40,n.t2=n.catch(6),zP.error("findProviders errored:",n.t2),n.t2;case 44:return n.prev=44,a.clear(),o.resolve(),zP("findProviders finished: %c",e),n.finish(44);case 49:case"end":return n.stop()}}),n,null,[[6,40,44,49],[11,24,28,38],[29,,33,37]])})))()}},{key:"provide",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},zP("provide starts: %c",t),n.timeout=null!==(r=n.timeout)&&void 0!==r?r:jP,i=vo([this.abortController.signal,n.signal]),a=ts(),s=ts(),this.httpQueue.add((0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.resolve(),e.abrupt("return",s.promise);case 2:case"end":return e.stop()}}),e)})))),e.prev=7,e.next=10,a.promise;case 10:return e.next=12,this.client.block.stat(t,(0,_e.Z)((0,_e.Z)({},n),{},{signal:i}));case 12:return e.next=14,Qs(this.client.dht.provide(t,(0,_e.Z)((0,_e.Z)({},n),{},{signal:i})));case 14:e.next=20;break;case 16:throw e.prev=16,e.t0=e.catch(7),zP.error("provide errored:",e.t0),e.t0;case 20:return e.prev=20,i.clear(),s.resolve(),zP("provide finished: %c",t),e.finish(20);case 25:case"end":return e.stop()}}),e,this,[[7,16,20,25]])})));return function(t){return e.apply(this,arguments)}}()},{key:"put",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=u.length>2&&void 0!==u[2]?u[2]:{},zP("put value start: %b",t),i.timeout=null!==(n=i.timeout)&&void 0!==n?n:jP,a=vo([this.abortController.signal,i.signal]),s=ts(),o=ts(),this.httpQueue.add((0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.resolve(),e.abrupt("return",o.promise);case 2:case"end":return e.stop()}}),e)})))),e.prev=7,e.next=10,s.promise;case 10:return e.next=12,Qs(this.client.dht.put(t,r,(0,_e.Z)((0,_e.Z)({},i),{},{signal:a})));case 12:e.next=18;break;case 14:throw e.prev=14,e.t0=e.catch(7),zP.error("put errored:",e.t0),e.t0;case 18:return e.prev=18,a.clear(),o.resolve(),zP("put finished: %b",t),e.finish(18);case 23:case"end":return e.stop()}}),e,this,[[7,14,18,23]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c,l,h,f,d=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=d.length>1&&void 0!==d[1]?d[1]:{},zP("get value start: %b",t),n.timeout=null!==(r=n.timeout)&&void 0!==r?r:jP,i=vo([this.abortController.signal,n.signal]),a=ts(),s=ts(),this.httpQueue.add((0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.resolve(),e.abrupt("return",s.promise);case 2:case"end":return e.stop()}}),e)})))),e.prev=7,e.next=10,a.promise;case 10:o=!1,u=!1,e.prev=12,l=ui(this.client.dht.get(t,(0,_e.Z)((0,_e.Z)({},n),{},{signal:i})));case 14:return e.next=16,l.next();case 16:if(!(o=!(h=e.sent).done)){e.next=24;break}if("VALUE"!==(f=h.value).name){e.next=21;break}return zP("get value finished: %b",t),e.abrupt("return",f.value);case 21:o=!1,e.next=14;break;case 24:e.next=30;break;case 26:e.prev=26,e.t0=e.catch(12),u=!0,c=e.t0;case 30:if(e.prev=30,e.prev=31,!o||null==l.return){e.next=35;break}return e.next=35,l.return();case 35:if(e.prev=35,!u){e.next=38;break}throw c;case 38:return e.finish(35);case 39:return e.finish(30);case 40:throw ji(new Error("Not found"),"ERR_NOT_FOUND");case 43:throw e.prev=43,e.t1=e.catch(7),zP.error("put errored:",e.t1),e.t1;case 47:return e.prev=47,i.clear(),s.resolve(),zP("put finished: %b",t),e.finish(47);case 52:case"end":return e.stop()}}),e,this,[[7,43,47,52],[12,26,30,40],[31,,35,39]])})));return function(t){return e.apply(this,arguments)}}()}]),e}();function WP(e){return function(){return new HP(e)}}var qP=function(e){return Promise.reject(new Error('No base found for "'.concat(e,'"')))},VP=function(){function e(t){(0,hi.Z)(this,e),this._basesByName={},this._basesByPrefix={},this._loadBase=t.loadBase||qP;var r,n=(0,ge.Z)(t.bases);try{for(n.s();!(r=n.n()).done;){var i=r.value;this.addBase(i)}}catch(S$){n.e(S$)}finally{n.f()}}return(0,fi.Z)(e,[{key:"addBase",value:function(e){if(this._basesByName[e.name]||this._basesByPrefix[e.prefix])throw new Error('Codec already exists for codec "'.concat(e.name,'"'));this._basesByName[e.name]=e,this._basesByPrefix[e.prefix]=e}},{key:"removeBase",value:function(e){delete this._basesByName[e.name],delete this._basesByPrefix[e.prefix]}},{key:"getBase",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._basesByName[t]){e.next=2;break}return e.abrupt("return",this._basesByName[t]);case 2:if(!this._basesByPrefix[t]){e.next=4;break}return e.abrupt("return",this._basesByPrefix[t]);case 4:return e.next=6,this._loadBase(t);case 6:return r=e.sent,null==this._basesByName[r.name]&&null==this._basesByPrefix[r.prefix]&&this.addBase(r),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"listBases",value:function(){return Object.values(this._basesByName)}}]),e}(),KP=function(e){return Promise.reject(new Error('No codec found for "'.concat(e,'"')))},YP=function(){function e(t){(0,hi.Z)(this,e),this._codecsByName={},this._codecsByCode={},this._loadCodec=t.loadCodec||KP;var r,n=(0,ge.Z)(t.codecs);try{for(n.s();!(r=n.n()).done;){var i=r.value;this.addCodec(i)}}catch(S$){n.e(S$)}finally{n.f()}}return(0,fi.Z)(e,[{key:"addCodec",value:function(e){if(this._codecsByName[e.name]||this._codecsByCode[e.code])throw new Error('Resolver already exists for codec "'.concat(e.name,'"'));this._codecsByName[e.name]=e,this._codecsByCode[e.code]=e}},{key:"removeCodec",value:function(e){delete this._codecsByName[e.name],delete this._codecsByCode[e.code]}},{key:"getCodec",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r="string"===typeof t?this._codecsByName:this._codecsByCode)[t]){e.next=3;break}return e.abrupt("return",r[t]);case 3:return e.next=5,this._loadCodec(t);case 5:return n=e.sent,null==r[t]&&this.addCodec(n),e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"listCodecs",value:function(){return Object.values(this._codecsByName)}}]),e}(),GP=function(e){return Promise.reject(new Error('No hasher found for "'.concat(e,'"')))},QP=function(){function e(t){(0,hi.Z)(this,e),this._hashersByName={},this._hashersByCode={},this._loadHasher=t.loadHasher||GP;var r,n=(0,ge.Z)(t.hashers);try{for(n.s();!(r=n.n()).done;){var i=r.value;this.addHasher(i)}}catch(S$){n.e(S$)}finally{n.f()}}return(0,fi.Z)(e,[{key:"addHasher",value:function(e){if(this._hashersByName[e.name]||this._hashersByCode[e.code])throw new Error('Resolver already exists for codec "'.concat(e.name,'"'));this._hashersByName[e.name]=e,this._hashersByCode[e.code]=e}},{key:"removeHasher",value:function(e){delete this._hashersByName[e.name],delete this._hashersByCode[e.code]}},{key:"getHasher",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r="string"===typeof t?this._hashersByName:this._hashersByCode)[t]){e.next=3;break}return e.abrupt("return",r[t]);case 3:return e.next=5,this._loadHasher(t);case 5:return n=e.sent,null==r[t]&&this.addHasher(n),e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"listHashers",value:function(){return Object.values(this._hashersByName)}}]),e}();var XP=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var a=e.charAt(i),s=a.charCodeAt(0);if(255!==r[s])throw new TypeError(a+" is ambiguous");r[s]=i}var o=e.length,u=e.charAt(0),c=Math.log(o)/Math.log(256),l=Math.log(256)/Math.log(o);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===u;)n++,t++;for(var a=(e.length-t)*c+1>>>0,s=new Uint8Array(a);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var h=0,f=a-1;(0!==l||h<i)&&-1!==f;f--,h++)l+=o*s[f]>>>0,s[f]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var d=a-i;d!==a&&0===s[d];)d++;for(var p=new Uint8Array(n+(a-d)),v=n;d!==a;)p[v++]=s[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,a=t.length;i!==a&&0===t[i];)i++,r++;for(var s=(a-i)*l+1>>>0,c=new Uint8Array(s);i!==a;){for(var h=t[i],f=0,d=s-1;(0!==h||f<n)&&-1!==d;d--,f++)h+=256*c[d]>>>0,c[d]=h%o>>>0,h=h/o>>>0;if(0!==h)throw new Error("Non-zero carry");n=f,i++}for(var p=s-n;p!==s&&0===c[p];)p++;for(var v=u.repeat(r);p<s;++p)v+=e.charAt(c[p]);return v},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error("Non-".concat(t," character"))}}},JP=XP,$P=(new Uint8Array(0),function(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}),eL=function(){function e(t,r,n){(0,hi.Z)(this,e),this.name=t,this.prefix=r,this.baseEncode=n}return(0,fi.Z)(e,[{key:"encode",value:function(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}]),e}(),tL=function(){function e(t,r,n){if((0,hi.Z)(this,e),this.name=t,this.prefix=r,void 0===r.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}return(0,fi.Z)(e,[{key:"decode",value:function(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}},{key:"or",value:function(e){return nL(this,e)}}]),e}(),rL=function(){function e(t){(0,hi.Z)(this,e),this.decoders=t}return(0,fi.Z)(e,[{key:"or",value:function(e){return nL(this,e)}},{key:"decode",value:function(e){var t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}]),e}(),nL=function(e,t){return new rL((0,_e.Z)((0,_e.Z)({},e.decoders||(0,we.Z)({},e.prefix,e)),t.decoders||(0,we.Z)({},t.prefix,t)))},iL=function(){function e(t,r,n,i){(0,hi.Z)(this,e),this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new eL(t,r,n),this.decoder=new tL(t,r,i)}return(0,fi.Z)(e,[{key:"encode",value:function(e){return this.encoder.encode(e)}},{key:"decode",value:function(e){return this.decoder.decode(e)}}]),e}(),aL=function(e){var t=e.name,r=e.prefix,n=e.encode,i=e.decode;return new iL(t,r,n,i)},sL=function(e){var t=e.prefix,r=e.name,n=e.alphabet,i=JP(n,r),a=i.encode,s=i.decode;return aL({prefix:t,name:r,encode:a,decode:function(e){return $P(s(e))}})},oL=function(e){var t=e.name,r=e.prefix,n=e.bitsPerChar,i=e.alphabet;return aL({prefix:r,name:t,encode:function(e){return function(e,t,r){for(var n="="===t[t.length-1],i=(1<<r)-1,a="",s=0,o=0,u=0;u<e.length;++u)for(o=o<<8|e[u],s+=8;s>r;)a+=t[i&o>>(s-=r)];if(s&&(a+=t[i&o<<r-s]),n)for(;a.length*r&7;)a+="=";return a}(e,i,n)},decode:function(e){return function(e,t,r,n){for(var i={},a=0;a<t.length;++a)i[t[a]]=a;for(var s=e.length;"="===e[s-1];)--s;for(var o=new Uint8Array(s*r/8|0),u=0,c=0,l=0,h=0;h<s;++h){var f=i[e[h]];if(void 0===f)throw new SyntaxError("Non-".concat(n," character"));c=c<<r|f,(u+=r)>=8&&(u-=8,o[l++]=255&c>>u)}if(u>=r||255&c<<8-u)throw new SyntaxError("Unexpected end of data");return o}(e,i,n,t)}})},uL=(oL({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),oL({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),oL({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}));oL({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function cL(e){return uL.encode(e).slice(1)}function lL(e){return uL.decode("u".concat(e))}var hL=function e(t,r,n){r=r||[];var i=n=n||0;for(;t>=pL;)r[n++]=255&t|fL,t/=128;for(;t&dL;)r[n++]=255&t|fL,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},fL=128,dL=-128,pL=Math.pow(2,31);var vL=function e(t,r){var n,i=0,a=0,s=r=r||0,o=t.length;do{if(s>=o)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],i+=a<28?(n&yL)<<a:(n&yL)*Math.pow(2,a),a+=7}while(n>=gL);return e.bytes=s-r,i},gL=128,yL=127;var mL=Math.pow(2,7),bL=Math.pow(2,14),_L=Math.pow(2,21),wL=Math.pow(2,28),kL=Math.pow(2,35),xL=Math.pow(2,42),EL=Math.pow(2,49),SL=Math.pow(2,56),CL=Math.pow(2,63),AL={encode:hL,decode:vL,encodingLength:function(e){return e<mL?1:e<bL?2:e<_L?3:e<wL?4:e<kL?5:e<xL?6:e<EL?7:e<SL?8:e<CL?9:10}},DL=AL,RL=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[DL.decode(e,t),DL.decode.bytes]},TL=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return DL.encode(e,t,r),t},ZL=function(e){return DL.encodingLength(e)},IL=(0,fi.Z)((function e(t,r,n,i){(0,hi.Z)(this,e),this.code=t,this.size=r,this.digest=n,this.bytes=i})),PL=sL({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),LL=(sL({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),oL({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),ML=(oL({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),oL({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),oL({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),oL({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),oL({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),oL({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),oL({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),oL({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),function(e,t){var r=e.bytes;return 0===e.version?UL(r,OL(e),t||PL.encoder):zL(r,OL(e),t||LL.encoder)}),BL=new WeakMap,OL=function(e){var t=BL.get(e);if(null==t){var r=new Map;return BL.set(e,r),r}return t},NL=function(e,t){function r(e,t,n,i){(0,hi.Z)(this,r),this.code=t,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}return(0,fi.Z)(r,[{key:"asCID",get:function(){return this}},{key:"byteOffset",get:function(){return this.bytes.byteOffset}},{key:"byteLength",get:function(){return this.bytes.byteLength}},{key:"toV0",value:function(){switch(this.version){case 0:return this;case 1:var e=this.code,t=this.multihash;if(e!==jL)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==HL)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return r.createV0(t);default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}},{key:"toV1",value:function(){switch(this.version){case 0:var e=this.multihash,t=function(e,t){var r=t.byteLength,n=ZL(e),i=n+ZL(r),a=new Uint8Array(i+r);return TL(e,a,0),TL(r,a,n),a.set(t,i),new IL(e,r,t,a)}(e.code,e.digest);return r.createV1(this.code,t);case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}},{key:"equals",value:function(e){return r.equals(this,e)}},{key:"toString",value:function(e){return ML(this,e)}},{key:"toJSON",value:function(){return{"/":ML(this)}}},{key:"link",value:function(){return this}},{key:e,get:function(){return"CID"}},{key:t,value:function(){return"CID(".concat(this.toString(),")")}}],[{key:"equals",value:function(e,t){var r=t;return r&&e.code===r.code&&e.version===r.version&&function(e,t){if(e===t)return!0;var r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(var r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}(e.bytes,r.bytes)}(e.multihash,r.multihash)}},{key:"asCID",value:function(e){if(null==e)return null;var t=e;if(t instanceof r)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){var n=t.version,i=t.code,a=t.multihash;return new r(n,i,a,t.bytes||WL(n,i,a.bytes))}if(!0===t[qL]){var s=t.version,o=t.multihash,u=t.code,c=function(e){var t=$P(e),r=RL(t),n=(0,ke.Z)(r,2),i=n[0],a=n[1],s=RL(t.subarray(a)),o=(0,ke.Z)(s,2),u=o[0],c=o[1],l=t.subarray(a+c);if(l.byteLength!==u)throw new Error("Incorrect length");return new IL(i,u,l,t)}(o);return r.create(s,u,c)}return null}},{key:"create",value:function(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==jL)throw new Error("Version 0 CID must use dag-pb (code: ".concat(jL,") block encoding"));return new r(e,t,n,n.bytes);case 1:return new r(e,t,n,WL(e,t,n.bytes));default:throw new Error("Invalid version")}}},{key:"createV0",value:function(e){return r.create(0,jL,e)}},{key:"createV1",value:function(e,t){return r.create(1,e,t)}},{key:"decode",value:function(e){var t=r.decodeFirst(e),n=(0,ke.Z)(t,2),i=n[0];if(n[1].length)throw new Error("Incorrect length");return i}},{key:"decodeFirst",value:function(e){var t=r.inspectBytes(e),n=t.size-t.multihashSize,i=$P(e.subarray(n,n+t.multihashSize));if(i.byteLength!==t.multihashSize)throw new Error("Incorrect length");var a=i.subarray(t.multihashSize-t.digestSize),s=new IL(t.multihashCode,t.digestSize,a,i);return[0===t.version?r.createV0(s):r.createV1(t.codec,s),e.subarray(t.size)]}},{key:"inspectBytes",value:function(e){var t=0,r=function(){var r=RL(e.subarray(t)),n=(0,ke.Z)(r,2),i=n[0],a=n[1];return t+=a,i},n=r(),i=jL;if(18===n?(n=0,t=0):i=r(),0!==n&&1!==n)throw new RangeError("Invalid CID version ".concat(n));var a=t,s=r(),o=r(),u=t+o;return{version:n,codec:i,multihashCode:s,digestSize:o,multihashSize:u-a,size:u}}},{key:"parse",value:function(e,t){var n=FL(e,t),i=(0,ke.Z)(n,2),a=i[0],s=i[1],o=r.decode(s);if(0===o.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return OL(o).set(a,e),o}}]),r}(Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom")),FL=function(e,t){switch(e[0]){case"Q":var r=t||PL;return[PL.prefix,r.decode("".concat(PL.prefix).concat(e))];case PL.prefix:var n=t||PL;return[PL.prefix,n.decode(e)];case LL.prefix:var i=t||LL;return[LL.prefix,i.decode(e)];default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},UL=function(e,t,r){var n=r.prefix;if(n!==PL.prefix)throw Error("Cannot string encode V0 in ".concat(r.name," encoding"));var i=t.get(n);if(null==i){var a=r.encode(e).slice(1);return t.set(n,a),a}return i},zL=function(e,t,r){var n=r.prefix,i=t.get(n);if(null==i){var a=r.encode(e);return t.set(n,a),a}return i},jL=112,HL=18,WL=function(e,t,r){var n=ZL(e),i=n+ZL(t),a=new Uint8Array(i+r.byteLength);return TL(e,a,0),TL(t,a,n),a.set(r,i),a},qL=Symbol.for("@ipld/js-cid/CID");function VL(e){var t={signature:lL(e.signature)};return e.header&&(t.header=e.header),e.protected&&(t.protected=lL(e.protected)),t}function KL(e){var t={signature:cL(e.signature)};return e.header&&(t.header=e.header),e.protected&&(t.protected=cL(e.protected)),t}function YL(e){var t={};return e.encrypted_key&&(t.encrypted_key=lL(e.encrypted_key)),e.header&&(t.header=e.header),t}function GL(e){var t={};return e.encrypted_key&&(t.encrypted_key=cL(e.encrypted_key)),e.header&&(t.header=e.header),t}var QL="dag-jose",XL=133;function JL(e){return"payload"in e&&"string"===typeof e.payload&&"signatures"in e&&Array.isArray(e.signatures)}function $L(e){return"ciphertext"in e&&"string"===typeof e.ciphertext&&"iv"in e&&"string"===typeof e.iv&&"protected"in e&&"string"===typeof e.protected&&"tag"in e&&"string"===typeof e.tag}function eM(e){if("string"===typeof e){var t=e.split(".");if(3===t.length)return function(e){var t=(0,ke.Z)(e,3),r=t[0],n=t[1];return{payload:n,signatures:[{protected:r,signature:t[2]}],link:NL.decode(lL(n))}}(t);if(5===t.length)return function(e){var t=(0,ke.Z)(e,5),r=t[0],n=t[1],i=t[2],a={ciphertext:t[3],iv:i,protected:r,tag:t[4]};return n&&(a.recipients=[{encrypted_key:n}]),a}(t);throw new Error("Not a valid JOSE string")}if(JL(e)||$L(e))return e;throw new Error("Not a valid unencoded JOSE object")}function tM(e){var t;if("string"===typeof e&&(e=eM(e)),JL(e))t=function(e){var t=lL(e.payload);try{NL.decode(t)}catch(r){throw new Error("Not a valid DagJWS")}return{payload:t,signatures:e.signatures.map(VL)}}(e);else{if(!$L(e))throw new Error("Not a valid JOSE object");t=function(e){var t={ciphertext:lL(e.ciphertext),protected:lL(e.protected),iv:lL(e.iv),tag:lL(e.tag)};return e.aad&&(t.aad=lL(e.aad)),e.recipients&&(t.recipients=e.recipients.map(YL)),e.unprotected&&(t.unprotected=e.unprotected),t}(e)}return new Uint8Array(zh(t))}function rM(e){var t,r;try{t=jh(e)}catch(n){throw new Error("Not a valid DAG-JOSE object")}if("payload"in(r=t)&&r.payload instanceof Uint8Array&&"signatures"in r&&Array.isArray(r.signatures))return function(e){var t={payload:cL(e.payload),signatures:e.signatures.map(KL)};return t.link=NL.decode(new Uint8Array(e.payload)),t}(t);if(function(e){return"ciphertext"in e&&e.ciphertext instanceof Uint8Array&&"iv"in e&&e.iv instanceof Uint8Array&&"protected"in e&&e.protected instanceof Uint8Array&&"tag"in e&&e.tag instanceof Uint8Array}(t))return function(e){var t={ciphertext:cL(e.ciphertext),protected:cL(e.protected),iv:cL(e.iv),tag:cL(e.tag)};return e.aad&&(t.aad=cL(e.aad)),e.recipients&&(t.recipients=e.recipients.map(GL)),e.unprotected&&(t.unprotected=e.unprotected),t}(t);throw new Error("Not a valid DAG-JOSE object")}new Uint8Array(0);var nM=function(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},iM=function e(t,r,n){r=r||[];var i=n=n||0;for(;t>=oM;)r[n++]=255&t|aM,t/=128;for(;t&sM;)r[n++]=255&t|aM,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},aM=128,sM=-128,oM=Math.pow(2,31);var uM=function e(t,r){var n,i=0,a=0,s=r=r||0,o=t.length;do{if(s>=o)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],i+=a<28?(n&lM)<<a:(n&lM)*Math.pow(2,a),a+=7}while(n>=cM);return e.bytes=s-r,i},cM=128,lM=127;var hM=Math.pow(2,7),fM=Math.pow(2,14),dM=Math.pow(2,21),pM=Math.pow(2,28),vM=Math.pow(2,35),gM=Math.pow(2,42),yM=Math.pow(2,49),mM=Math.pow(2,56),bM=Math.pow(2,63),_M={encode:iM,decode:uM,encodingLength:function(e){return e<hM?1:e<fM?2:e<dM?3:e<pM?4:e<vM?5:e<gM?6:e<yM?7:e<mM?8:e<bM?9:10}},wM=_M,kM=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[wM.decode(e,t),wM.decode.bytes]},xM=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return wM.encode(e,t,r),t},EM=function(e){return wM.encodingLength(e)},SM=function(e,t){var r=t.byteLength,n=EM(e),i=n+EM(r),a=new Uint8Array(i+r);return xM(e,a,0),xM(r,a,n),a.set(t,i),new AM(e,r,t,a)},CM=function(e){var t=nM(e),r=kM(t),n=(0,ke.Z)(r,2),i=n[0],a=n[1],s=kM(t.subarray(a)),o=(0,ke.Z)(s,2),u=o[0],c=o[1],l=t.subarray(a+c);if(l.byteLength!==u)throw new Error("Incorrect length");return new AM(i,u,l,t)},AM=(0,fi.Z)((function e(t,r,n,i){(0,hi.Z)(this,e),this.code=t,this.size=r,this.digest=n,this.bytes=i})),DM=nM,RM={code:0,name:"identity",encode:DM,digest:function(e){return SM(0,DM(e))}};var TM=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var a=e.charAt(i),s=a.charCodeAt(0);if(255!==r[s])throw new TypeError(a+" is ambiguous");r[s]=i}var o=e.length,u=e.charAt(0),c=Math.log(o)/Math.log(256),l=Math.log(256)/Math.log(o);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===u;)n++,t++;for(var a=(e.length-t)*c+1>>>0,s=new Uint8Array(a);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var h=0,f=a-1;(0!==l||h<i)&&-1!==f;f--,h++)l+=o*s[f]>>>0,s[f]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var d=a-i;d!==a&&0===s[d];)d++;for(var p=new Uint8Array(n+(a-d)),v=n;d!==a;)p[v++]=s[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,a=t.length;i!==a&&0===t[i];)i++,r++;for(var s=(a-i)*l+1>>>0,c=new Uint8Array(s);i!==a;){for(var h=t[i],f=0,d=s-1;(0!==h||f<n)&&-1!==d;d--,f++)h+=256*c[d]>>>0,c[d]=h%o>>>0,h=h/o>>>0;if(0!==h)throw new Error("Non-zero carry");n=f,i++}for(var p=s-n;p!==s&&0===c[p];)p++;for(var v=u.repeat(r);p<s;++p)v+=e.charAt(c[p]);return v},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error("Non-".concat(t," character"))}}},ZM=TM,IM=function(){function e(t,r,n){(0,hi.Z)(this,e),this.name=t,this.prefix=r,this.baseEncode=n}return(0,fi.Z)(e,[{key:"encode",value:function(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}]),e}(),PM=function(){function e(t,r,n){if((0,hi.Z)(this,e),this.name=t,this.prefix=r,void 0===r.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}return(0,fi.Z)(e,[{key:"decode",value:function(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}},{key:"or",value:function(e){return MM(this,e)}}]),e}(),LM=function(){function e(t){(0,hi.Z)(this,e),this.decoders=t}return(0,fi.Z)(e,[{key:"or",value:function(e){return MM(this,e)}},{key:"decode",value:function(e){var t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}]),e}(),MM=function(e,t){return new LM((0,_e.Z)((0,_e.Z)({},e.decoders||(0,we.Z)({},e.prefix,e)),t.decoders||(0,we.Z)({},t.prefix,t)))},BM=function(){function e(t,r,n,i){(0,hi.Z)(this,e),this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new IM(t,r,n),this.decoder=new PM(t,r,i)}return(0,fi.Z)(e,[{key:"encode",value:function(e){return this.encoder.encode(e)}},{key:"decode",value:function(e){return this.decoder.decode(e)}}]),e}(),OM=function(e){var t=e.name,r=e.prefix,n=e.encode,i=e.decode;return new BM(t,r,n,i)},NM=function(e){var t=e.prefix,r=e.name,n=e.alphabet,i=ZM(n,r),a=i.encode,s=i.decode;return OM({prefix:t,name:r,encode:a,decode:function(e){return nM(s(e))}})},FM=function(e){var t=e.name,r=e.prefix,n=e.bitsPerChar,i=e.alphabet;return OM({prefix:r,name:t,encode:function(e){return function(e,t,r){for(var n="="===t[t.length-1],i=(1<<r)-1,a="",s=0,o=0,u=0;u<e.length;++u)for(o=o<<8|e[u],s+=8;s>r;)a+=t[i&o>>(s-=r)];if(s&&(a+=t[i&o<<r-s]),n)for(;a.length*r&7;)a+="=";return a}(e,i,n)},decode:function(e){return function(e,t,r,n){for(var i={},a=0;a<t.length;++a)i[t[a]]=a;for(var s=e.length;"="===e[s-1];)--s;for(var o=new Uint8Array(s*r/8|0),u=0,c=0,l=0,h=0;h<s;++h){var f=i[e[h]];if(void 0===f)throw new SyntaxError("Non-".concat(n," character"));c=c<<r|f,(u+=r)>=8&&(u-=8,o[l++]=255&c>>u)}if(u>=r||255&c<<8-u)throw new SyntaxError("Unexpected end of data");return o}(e,i,n,t)}})},UM=OM({prefix:"\0",name:"identity",encode:function(e){return t=e,(new TextDecoder).decode(t);var t},decode:function(e){return function(e){return(new TextEncoder).encode(e)}(e)}}),zM=FM({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),jM=FM({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),HM=NM({prefix:"9",name:"base10",alphabet:"0123456789"}),WM=FM({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),qM=FM({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),VM=FM({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),KM=FM({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),YM=FM({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),GM=FM({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),QM=FM({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),XM=FM({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),JM=FM({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),$M=FM({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),eB=FM({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),tB=NM({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),rB=NM({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),nB=NM({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),iB=NM({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),aB=FM({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),sB=FM({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),oB=FM({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),uB=FM({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),cB=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),lB=cB.reduce((function(e,t,r){return e[r]=t,e}),[]),hB=cB.reduce((function(e,t,r){return e[t.codePointAt(0)]=r,e}),[]);var fB=OM({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce((function(e,t){return e+=lB[t]}),"")},decode:function(e){var t,r=[],n=(0,ge.Z)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=hB[i.codePointAt(0)];if(void 0===a)throw new Error("Non-base256emoji character: ".concat(i));r.push(a)}}catch(S$){n.e(S$)}finally{n.f()}return new Uint8Array(r)}}),dB=function(e){var t=e.name,r=e.code,n=e.encode;return new pB(t,r,n)},pB=function(){function e(t,r,n){(0,hi.Z)(this,e),this.name=t,this.code=r,this.encode=n}return(0,fi.Z)(e,[{key:"digest",value:function(e){var t=this;if(e instanceof Uint8Array){var r=this.encode(e);return r instanceof Uint8Array?SM(this.code,r):r.then((function(e){return SM(t.code,e)}))}throw Error("Unknown type, must be binary type")}}]),e}(),vB=function(e){return function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(r){return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Uint8Array,t.next=3,crypto.subtle.digest(e,r);case 3:return t.t1=t.sent,t.abrupt("return",new t.t0(t.t1));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},gB=dB({name:"sha2-256",code:18,encode:vB("SHA-256")}),yB=dB({name:"sha2-512",code:19,encode:vB("SHA-512")}),mB="raw",bB=85,_B=function(e){return nM(e)},wB=function(e){return nM(e)},kB=new TextEncoder,xB=new TextDecoder,EB="json",SB=512,CB=function(e){return kB.encode(JSON.stringify(e))},AB=function(e){return JSON.parse(xB.decode(e))},DB=function(e,t){var r=e.bytes;return 0===e.version?PB(r,TB(e),t||nB.encoder):LB(r,TB(e),t||VM.encoder)},RB=new WeakMap,TB=function(e){var t=RB.get(e);if(null==t){var r=new Map;return RB.set(e,r),r}return t},ZB=function(e,t){function r(e,t,n,i){(0,hi.Z)(this,r),this.code=t,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}return(0,fi.Z)(r,[{key:"asCID",get:function(){return this}},{key:"byteOffset",get:function(){return this.bytes.byteOffset}},{key:"byteLength",get:function(){return this.bytes.byteLength}},{key:"toV0",value:function(){switch(this.version){case 0:return this;case 1:var e=this.code,t=this.multihash;if(e!==MB)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==BB)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return r.createV0(t);default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}},{key:"toV1",value:function(){switch(this.version){case 0:var e=this.multihash,t=e.code,n=e.digest,i=SM(t,n);return r.createV1(this.code,i);case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}},{key:"equals",value:function(e){return r.equals(this,e)}},{key:"toString",value:function(e){return DB(this,e)}},{key:"toJSON",value:function(){return{"/":DB(this)}}},{key:"link",value:function(){return this}},{key:e,get:function(){return"CID"}},{key:t,value:function(){return"CID(".concat(this.toString(),")")}}],[{key:"equals",value:function(e,t){var r=t;return r&&e.code===r.code&&e.version===r.version&&function(e,t){if(e===t)return!0;var r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(var r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}(e.bytes,r.bytes)}(e.multihash,r.multihash)}},{key:"asCID",value:function(e){if(null==e)return null;var t=e;if(t instanceof r)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){var n=t.version,i=t.code,a=t.multihash;return new r(n,i,a,t.bytes||OB(n,i,a.bytes))}if(!0===t[NB]){var s=t.version,o=t.multihash,u=t.code,c=CM(o);return r.create(s,u,c)}return null}},{key:"create",value:function(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==MB)throw new Error("Version 0 CID must use dag-pb (code: ".concat(MB,") block encoding"));return new r(e,t,n,n.bytes);case 1:return new r(e,t,n,OB(e,t,n.bytes));default:throw new Error("Invalid version")}}},{key:"createV0",value:function(e){return r.create(0,MB,e)}},{key:"createV1",value:function(e,t){return r.create(1,e,t)}},{key:"decode",value:function(e){var t=r.decodeFirst(e),n=(0,ke.Z)(t,2),i=n[0];if(n[1].length)throw new Error("Incorrect length");return i}},{key:"decodeFirst",value:function(e){var t=r.inspectBytes(e),n=t.size-t.multihashSize,i=nM(e.subarray(n,n+t.multihashSize));if(i.byteLength!==t.multihashSize)throw new Error("Incorrect length");var a=i.subarray(t.multihashSize-t.digestSize),s=new AM(t.multihashCode,t.digestSize,a,i);return[0===t.version?r.createV0(s):r.createV1(t.codec,s),e.subarray(t.size)]}},{key:"inspectBytes",value:function(e){var t=0,r=function(){var r=kM(e.subarray(t)),n=(0,ke.Z)(r,2),i=n[0],a=n[1];return t+=a,i},n=r(),i=MB;if(18===n?(n=0,t=0):i=r(),0!==n&&1!==n)throw new RangeError("Invalid CID version ".concat(n));var a=t,s=r(),o=r(),u=t+o;return{version:n,codec:i,multihashCode:s,digestSize:o,multihashSize:u-a,size:u}}},{key:"parse",value:function(e,t){var n=IB(e,t),i=(0,ke.Z)(n,2),a=i[0],s=i[1],o=r.decode(s);if(0===o.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return TB(o).set(a,e),o}}]),r}(Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom")),IB=function(e,t){switch(e[0]){case"Q":var r=t||nB;return[nB.prefix,r.decode("".concat(nB.prefix).concat(e))];case nB.prefix:var n=t||nB;return[nB.prefix,n.decode(e)];case VM.prefix:var i=t||VM;return[VM.prefix,i.decode(e)];default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},PB=function(e,t,r){var n=r.prefix;if(n!==nB.prefix)throw Error("Cannot string encode V0 in ".concat(r.name," encoding"));var i=t.get(n);if(null==i){var a=r.encode(e).slice(1);return t.set(n,a),a}return i},LB=function(e,t,r){var n=r.prefix,i=t.get(n);if(null==i){var a=r.encode(e);return t.set(n,a),a}return i},MB=112,BB=18,OB=function(e,t,r){var n=EM(e),i=n+EM(t),a=new Uint8Array(i+r.byteLength);return xM(e,a,0),xM(t,a,n),a.set(r,i),a},NB=Symbol.for("@ipld/js-cid/CID"),FB=(0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)({},S),C),A),D),R),T),Z),I),P),L),UB=(0,_e.Z)((0,_e.Z)({},M),E),zB={raw:B,json:O},jB=Nm,HB=Fm,WB=function e(t){var r=0;if(t=t.toString().trim(),jB(t)){var n=new Uint8Array(r+4);return t.split(/\./g).forEach((function(e){n[r++]=255&parseInt(e,10)})),n}if(HB(t)){var i,a=t.split(":",8);for(i=0;i<a.length;i++){var s=void 0;jB(a[i])&&(s=e(a[i]),a[i]=Ws(s.slice(0,2),"base16")),null!=s&&++i<8&&a.splice(i,0,Ws(s.slice(2,4),"base16"))}if(""===a[0])for(;a.length<8;)a.unshift("0");else if(""===a[a.length-1])for(;a.length<8;)a.push("0");else if(a.length<8){for(i=0;i<a.length&&""!==a[i];i++);var o=[i,1];for(i=9-a.length;i>0;i--)o.push("0");a.splice.apply(a,o)}var u=new Uint8Array(r+16);for(i=0;i<a.length;i++){var c=parseInt(a[i],16);u[r++]=c>>8&255,u[r++]=255&c}return u}throw new Error("invalid ip address")},qB=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;r=~~r,n=null!==(t=n)&&void 0!==t?t:e.length-r;var i=new DataView(e.buffer);if(4===n){for(var a=[],s=0;s<n;s++)a.push(e[r+s]);return a.join(".")}if(16===n){for(var o=[],u=0;u<n;u+=2)o.push(i.getUint16(r+u).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},VB=-1,KB={},YB={};function GB(e,t,r,n,i){return{code:e,size:t,name:r,resolvable:Boolean(n),path:Boolean(i)}}function QB(e){if("number"===typeof e){if(null!=YB[e])return YB[e];throw new Error("no protocol with code: ".concat(e))}if("string"===typeof e){if(null!=KB[e])return KB[e];throw new Error("no protocol with name: ".concat(e))}throw new Error("invalid protocol id type: ".concat(typeof e))}function XB(e,t){switch(QB(e).code){case 4:case 41:return function(e){var t=qB(e,0,e.length);if(null==t)throw new Error("ipBuff is required");if(!Um(t))throw new Error("invalid ip address");return t}(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return aO(t);case 6:case 273:case 33:case 132:return nO(t).toString();case 421:return function(e){var t=Po.decode(e),r=e.slice(Po.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return Ws(r,"base58btc")}(t);case 444:case 445:return sO(t);case 466:return function(e){var t=Po.decode(e),r=e.slice(Po.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return"u"+Ws(r,"base64url")}(t);default:return Ws(t,"base16")}}function JB(e,t){switch(QB(e).code){case 4:case 41:return tO(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return iO(t);case 6:case 273:case 33:case 132:return rO(parseInt(t,10));case 421:return function(e){var t;t="Q"===e[0]||"1"===e[0]?CM(nB.decode("z".concat(e))).bytes:ZB.parse(e).multihash.bytes;var r=Uint8Array.from(Po.encode(t.length));return Eu([r,t],r.length+t.length)}(t);case 444:return function(e){var t=e.split(":");if(2!==t.length)throw new Error("failed to parse onion addr: [\"'".concat(t.join('", "'),"'\"]' does not contain a port number"));if(16!==t[0].length)throw new Error("failed to parse onion addr: ".concat(t[0]," not a Tor onion address."));var r=VM.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");var i=rO(n);return Eu([r,i],r.length+i.length)}(t);case 445:return function(e){var t=e.split(":");if(2!==t.length)throw new Error("failed to parse onion addr: [\"'".concat(t.join('", "'),"'\"]' does not contain a port number"));if(56!==t[0].length)throw new Error("failed to parse onion addr: ".concat(t[0]," not a Tor onion3 address."));var r=VM.decode("b".concat(t[0])),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");var i=rO(n);return Eu([r,i],r.length+i.length)}(t);case 466:return function(e){var t=eO.decode(e),r=Uint8Array.from(Po.encode(t.length));return Eu([r,t],r.length+t.length)}(t);default:return Hs(t,"base16")}}[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,VB,"ip6zone"],[43,8,"ipcidr"],[53,VB,"dns",!0],[54,VB,"dns4",!0],[55,VB,"dns6",!0],[56,VB,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[281,0,"webrtc-w3c"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,VB,"unix",!1,!0],[421,VB,"ipfs"],[421,VB,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,VB,"garlic64"],[448,0,"tls"],[449,VB,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,VB,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,VB,"memory"]].forEach((function(e){var t=GB.apply(void 0,be(e));YB[t.code]=t,KB[t.name]=t}));var $B=Object.values(FB).map((function(e){return e.decoder})),eO=function(){var e=$B[0].or($B[1]);return $B.slice(2).forEach((function(t){return e=e.or(t)})),e}();function tO(e){if(!Um(e))throw new Error("invalid ip address");return WB(e)}function rO(e){var t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function nO(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function iO(e){var t=Hs(e),r=Uint8Array.from(Po.encode(t.length));return Eu([r,t],r.length+t.length)}function aO(e){var t=Po.decode(e);if((e=e.slice(Po.decode.bytes)).length!==t)throw new Error("inconsistent lengths");return Ws(e)}function sO(e){var t=e.slice(0,e.length-2),r=e.slice(e.length-2),n=Ws(t,"base32"),i=nO(r);return"".concat(n,":").concat(i)}function oO(e){return e.map((function(e){var t=yO(e);return null!=e[1]?[t.code,XB(t.code,e[1])]:[t.code]}))}function uO(e){return dO(Eu(e.map((function(e){var t=yO(e),r=Uint8Array.from(Po.encode(t.code));return e.length>1&&null!=e[1]&&(r=Eu([r,e[1]])),r}))))}function cO(e,t){return e.size>0?e.size/8:0===e.size?0:Po.decode(t)+(null!==(r=Po.decode.bytes)&&void 0!==r?r:0);var r}function lO(e){for(var t=[],r=0;r<e.length;){var n,i=Po.decode(e,r),a=null!==(n=Po.decode.bytes)&&void 0!==n?n:0,s=cO(QB(i),e.slice(r+a));if(0!==s){var o=e.slice(r+a,r+a+s);if((r+=s+a)>e.length)throw gO("Invalid address Uint8Array: "+Ws(e,"base16"));t.push([i,o])}else t.push([i]),r+=a}return t}function hO(e){return function(e){var t=[];return e.map((function(e){var r=yO(e);return t.push(r.name),e.length>1&&null!=e[1]&&t.push(e[1]),null})),vO(t.join("/"))}(oO(lO(e)))}function fO(e){var t=function(e){var t=[],r=e.split("/").slice(1);if(1===r.length&&""===r[0])return[];for(var n=0;n<r.length;n++){var i=r[n],a=QB(i);if(0!==a.size){if(++n>=r.length)throw gO("invalid address: "+e);if(!0===a.path){t.push([i,vO(r.slice(n).join("/"))]);break}t.push([i,r[n]])}else t.push([i])}return t}(e=vO(e));return uO(t.map((function(e){Array.isArray(e)||(e=[e]);var t=yO(e);return e.length>1?[t.code,JB(t.code,e[1])]:[t.code]})))}function dO(e){var t=pO(e);if(null!=t)throw t;return Uint8Array.from(e)}function pO(e){try{lO(e)}catch(S$){return S$}}function vO(e){return"/"+e.trim().split("/").filter((function(e){return e})).join("/")}function gO(e){return new Error("Error parsing address: "+e)}function yO(e){return QB(e[0])}var mO,bO,_O,wO,kO=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},xO=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},EO=Symbol.for("nodejs.util.inspect.custom"),SO=[QB("dns").code,QB("dns4").code,QB("dns6").code,QB("dnsaddr").code],CO=new Map,AO=Symbol.for("@multiformats/js-multiaddr/multiaddr");function DO(e){return Boolean(null===e||void 0===e?void 0:e[AO])}var RO=function(e){function t(e){if((0,hi.Z)(this,t),mO.set(this,void 0),bO.set(this,void 0),_O.set(this,void 0),this[wO]=!0,null==e&&(e=""),e instanceof Uint8Array)this.bytes=dO(e);else if("string"===typeof e){if(e.length>0&&"/"!==e.charAt(0))throw new Error('multiaddr "'.concat(e,'" must start with a "/"'));this.bytes=fO(e)}else{if(!DO(e))throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=dO(e.bytes)}}return(0,fi.Z)(t,[{key:"toString",value:function(){return null==kO(this,mO,"f")&&xO(this,mO,hO(this.bytes),"f"),kO(this,mO,"f")}},{key:"toJSON",value:function(){return this.toString()}},{key:"toOptions",value:function(){var e,t,r,n,i,a="",s=QB("tcp"),o=QB("udp"),u=QB("ip4"),c=QB("ip6"),l=QB("dns6"),h=QB("ip6zone"),f=(0,ge.Z)(this.stringTuples());try{for(f.s();!(i=f.n()).done;){var d=(0,ke.Z)(i.value,2),p=d[0],v=d[1];p===h.code&&(a="%".concat(null!==v&&void 0!==v?v:"")),SO.includes(p)&&(t=s.name,n=443,r="".concat(null!==v&&void 0!==v?v:"").concat(a),e=p===l.code?6:4),p!==s.code&&p!==o.code||(t=QB(p).name,n=parseInt(null!==v&&void 0!==v?v:"")),p!==u.code&&p!==c.code||(t=QB(p).name,r="".concat(null!==v&&void 0!==v?v:"").concat(a),e=p===c.code?6:4)}}catch(S$){f.e(S$)}finally{f.f()}if(null==e||null==t||null==r||null==n)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:r,transport:t,port:n}}},{key:"protos",value:function(){return this.protoCodes().map((function(e){return Object.assign({},QB(e))}))}},{key:"protoCodes",value:function(){for(var e=[],t=this.bytes,r=0;r<t.length;){var n,i=Po.decode(t,r),a=null!==(n=Po.decode.bytes)&&void 0!==n?n:0;r+=cO(QB(i),t.slice(r+a))+a,e.push(i)}return e}},{key:"protoNames",value:function(){return this.protos().map((function(e){return e.name}))}},{key:"tuples",value:function(){return null==kO(this,bO,"f")&&xO(this,bO,lO(this.bytes),"f"),kO(this,bO,"f")}},{key:"stringTuples",value:function(){return null==kO(this,_O,"f")&&xO(this,_O,oO(this.tuples()),"f"),kO(this,_O,"f")}},{key:"encapsulate",value:function(e){return e=new t(e),new t(this.toString()+e.toString())}},{key:"decapsulate",value:function(e){var r=e.toString(),n=this.toString(),i=n.lastIndexOf(r);if(i<0)throw new Error("Address ".concat(this.toString()," does not contain subaddress: ").concat(e.toString()));return new t(n.slice(0,i))}},{key:"decapsulateCode",value:function(e){for(var r=this.tuples(),n=r.length-1;n>=0;n--)if(r[n][0]===e)return new t(uO(r.slice(0,n)));return this}},{key:"getPeerId",value:function(){try{var e=this.stringTuples().filter((function(e){return e[0]===KB.ipfs.code})),t=e.pop();if(null!=(null===t||void 0===t?void 0:t[1])){var r=t[1];return"Q"===r[0]||"1"===r[0]?Ws(nB.decode("z".concat(r)),"base58btc"):Ws(ZB.parse(r).multihash.bytes,"base58btc")}return null}catch(n){return null}}},{key:"getPath",value:function(){var e=null;try{null==(e=this.stringTuples().filter((function(e){return!0===QB(e[0]).path}))[0][1])&&(e=null)}catch(t){e=null}return e}},{key:"equals",value:function(e){return Ao(this.bytes,e.bytes)}},{key:"resolve",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(r){var n,i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(n=this.protos().find((function(e){return e.resolvable})))){e.next=3;break}return e.abrupt("return",[this]);case 3:if(null!=(i=CO.get(n.name))){e.next=6;break}throw ji(new Error("no available resolver for ".concat(n.name)),"ERR_NO_AVAILABLE_RESOLVER");case 6:return e.next=8,i(this,r);case 8:return a=e.sent,e.abrupt("return",a.map((function(e){return new t(e)})));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"nodeAddress",value:function(){var e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error('multiaddr must have a valid format - no protocol with name: "'.concat(e.transport,'". Must have a valid transport protocol: "{tcp, udp}"'));return{family:e.family,address:e.host,port:e.port}}},{key:"isThinWaistAddress",value:function(e){var t=(null!==e&&void 0!==e?e:this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))}},{key:e,value:function(){return"Multiaddr(".concat(hO(this.bytes),")")}}]),t}((mO=new WeakMap,bO=new WeakMap,_O=new WeakMap,wO=AO,EO));function TO(e){return new RO(e)}var ZO=__webpack_require__(6927),IO=/(\x2D?(?:[0-9]+\.?[0-9]*|[0-9]*\.?[0-9]+)(?:e[\+\x2D]?[0-9]+)?)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*((?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])*)/gi;function PO(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ms",r=null,n="-"===(e=(e+"").replace(/(\d)[,_](\d)/g,"$1$2"))[0];return e.replace(IO,(function(e,t,n){(n=LO(n))&&(r=(r||0)+Math.abs(parseFloat(t,10))*n)})),r&&r/(LO(t)||1)*(n?-1:1)}function LO(e){return PO[e]||PO[e.toLowerCase().replace(/s$/,"")]}PO.nanosecond=PO.ns=1e-6,PO["\xb5s"]=PO["\u03bcs"]=PO.us=PO.microsecond=.001,PO.millisecond=PO.ms=PO[""]=1,PO.second=PO.sec=PO.s=1e3*PO.ms,PO.minute=PO.min=PO.m=60*PO.s,PO.hour=PO.hr=PO.h=60*PO.m,PO.day=PO.d=24*PO.h,PO.week=PO.wk=PO.w=7*PO.d,PO.month=PO.b=30.4375*PO.d,PO.year=PO.yr=PO.y=365.25*PO.d;var MO=PO;function BO(e){var t=function(e){var t=function(){};return t.enabled=!1,t.color="",t.diff=0,t.log=function(){},t.namespace=e,t.destroy=function(){return!0},t.extend=function(){return t},t}("".concat(e,":trace"));return li.enabled("".concat(e,":trace"))&&null!=li.names.map((function(e){return e.toString()})).find((function(e){return e.includes(":trace")}))&&(t=li("".concat(e,":trace"))),Object.assign(li(e),{error:li("".concat(e,":error")),trace:t})}li.formatters.b=function(e){return null==e?"undefined":nB.baseEncode(e)},li.formatters.t=function(e){return null==e?"undefined":VM.baseEncode(e)},li.formatters.m=function(e){return null==e?"undefined":aB.baseEncode(e)},li.formatters.p=function(e){return null==e?"undefined":e.toString()},li.formatters.c=function(e){return null==e?"undefined":e.toString()},li.formatters.k=function(e){return null==e?"undefined":e.toString()},li.formatters.a=function(e){return null==e?"undefined":e.toString()};var OO=__webpack_require__(8257),NO=Nm,FO=Fm,UO=function e(t){var r=0;if(t=t.toString().trim(),NO(t)){var n=new Uint8Array(r+4);return t.split(/\./g).forEach((function(e){n[r++]=255&parseInt(e,10)})),n}if(FO(t)){var i,a=t.split(":",8);for(i=0;i<a.length;i++){var s=void 0;NO(a[i])&&(s=e(a[i]),a[i]=Ws(s.slice(0,2),"base16")),null!=s&&++i<8&&a.splice(i,0,Ws(s.slice(2,4),"base16"))}if(""===a[0])for(;a.length<8;)a.unshift("0");else if(""===a[a.length-1])for(;a.length<8;)a.push("0");else if(a.length<8){for(i=0;i<a.length&&""!==a[i];i++);var o=[i,1];for(i=9-a.length;i>0;i--)o.push("0");a.splice.apply(a,o)}var u=new Uint8Array(r+16);for(i=0;i<a.length;i++){var c=parseInt(a[i],16);u[r++]=c>>8&255,u[r++]=255&c}return u}throw new Error("invalid ip address")},zO=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;r=~~r,n=null!==(t=n)&&void 0!==t?t:e.length-r;var i=new DataView(e.buffer);if(4===n){for(var a=[],s=0;s<n;s++)a.push(e[r+s]);return a.join(".")}if(16===n){for(var o=[],u=0;u<n;u+=2)o.push(i.getUint16(r+u).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},jO=-1,HO={},WO={};function qO(e,t,r,n,i){return{code:e,size:t,name:r,resolvable:Boolean(n),path:Boolean(i)}}function VO(e){if("number"===typeof e){if(null!=WO[e])return WO[e];throw new Error("no protocol with code: ".concat(e))}if("string"===typeof e){if(null!=HO[e])return HO[e];throw new Error("no protocol with name: ".concat(e))}throw new Error("invalid protocol id type: ".concat(typeof e))}[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,jO,"ip6zone"],[43,8,"ipcidr"],[53,jO,"dns",!0],[54,jO,"dns4",!0],[55,jO,"dns6",!0],[56,jO,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[281,0,"webrtc-w3c"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,jO,"unix",!1,!0],[421,jO,"ipfs"],[421,jO,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,jO,"garlic64"],[448,0,"tls"],[449,jO,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,jO,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,jO,"memory"]].forEach((function(e){var t=qO.apply(void 0,be(e));WO[t.code]=t,HO[t.name]=t}));var KO=function e(t,r,n){r=r||[];var i=n=n||0;for(;t>=QO;)r[n++]=255&t|YO,t/=128;for(;t&GO;)r[n++]=255&t|YO,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},YO=128,GO=-128,QO=Math.pow(2,31);var XO=function e(t,r){var n,i=0,a=0,s=r=r||0,o=t.length;do{if(s>=o)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],i+=a<28?(n&$O)<<a:(n&$O)*Math.pow(2,a),a+=7}while(n>=JO);return e.bytes=s-r,i},JO=128,$O=127;var eN=Math.pow(2,7),tN=Math.pow(2,14),rN=Math.pow(2,21),nN=Math.pow(2,28),iN=Math.pow(2,35),aN=Math.pow(2,42),sN=Math.pow(2,49),oN=Math.pow(2,56),uN=Math.pow(2,63),cN={encode:KO,decode:XO,encodingLength:function(e){return e<eN?1:e<tN?2:e<rN?3:e<nN?4:e<iN?5:e<aN?6:e<sN?7:e<oN?8:e<uN?9:10}},lN=cN,hN=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[lN.decode(e,t),lN.decode.bytes]},fN=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return lN.encode(e,t,r),t},dN=function(e){return lN.encodingLength(e)},pN=(new Uint8Array(0),function(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}),vN=function(e,t){var r=t.byteLength,n=dN(e),i=n+dN(r),a=new Uint8Array(i+r);return fN(e,a,0),fN(r,a,n),a.set(t,i),new yN(e,r,t,a)},gN=function(e){var t=pN(e),r=hN(t),n=(0,ke.Z)(r,2),i=n[0],a=n[1],s=hN(t.subarray(a)),o=(0,ke.Z)(s,2),u=o[0],c=o[1],l=t.subarray(a+c);if(l.byteLength!==u)throw new Error("Incorrect length");return new yN(i,u,l,t)},yN=(0,fi.Z)((function e(t,r,n,i){(0,hi.Z)(this,e),this.code=t,this.size=r,this.digest=n,this.bytes=i}));var mN=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var a=e.charAt(i),s=a.charCodeAt(0);if(255!==r[s])throw new TypeError(a+" is ambiguous");r[s]=i}var o=e.length,u=e.charAt(0),c=Math.log(o)/Math.log(256),l=Math.log(256)/Math.log(o);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===u;)n++,t++;for(var a=(e.length-t)*c+1>>>0,s=new Uint8Array(a);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var h=0,f=a-1;(0!==l||h<i)&&-1!==f;f--,h++)l+=o*s[f]>>>0,s[f]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var d=a-i;d!==a&&0===s[d];)d++;for(var p=new Uint8Array(n+(a-d)),v=n;d!==a;)p[v++]=s[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,a=t.length;i!==a&&0===t[i];)i++,r++;for(var s=(a-i)*l+1>>>0,c=new Uint8Array(s);i!==a;){for(var h=t[i],f=0,d=s-1;(0!==h||f<n)&&-1!==d;d--,f++)h+=256*c[d]>>>0,c[d]=h%o>>>0,h=h/o>>>0;if(0!==h)throw new Error("Non-zero carry");n=f,i++}for(var p=s-n;p!==s&&0===c[p];)p++;for(var v=u.repeat(r);p<s;++p)v+=e.charAt(c[p]);return v},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error("Non-".concat(t," character"))}}},bN=mN,_N=function(){function e(t,r,n){(0,hi.Z)(this,e),this.name=t,this.prefix=r,this.baseEncode=n}return(0,fi.Z)(e,[{key:"encode",value:function(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}]),e}(),wN=function(){function e(t,r,n){if((0,hi.Z)(this,e),this.name=t,this.prefix=r,void 0===r.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}return(0,fi.Z)(e,[{key:"decode",value:function(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}},{key:"or",value:function(e){return xN(this,e)}}]),e}(),kN=function(){function e(t){(0,hi.Z)(this,e),this.decoders=t}return(0,fi.Z)(e,[{key:"or",value:function(e){return xN(this,e)}},{key:"decode",value:function(e){var t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}]),e}(),xN=function(e,t){return new kN((0,_e.Z)((0,_e.Z)({},e.decoders||(0,we.Z)({},e.prefix,e)),t.decoders||(0,we.Z)({},t.prefix,t)))},EN=function(){function e(t,r,n,i){(0,hi.Z)(this,e),this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new _N(t,r,n),this.decoder=new wN(t,r,i)}return(0,fi.Z)(e,[{key:"encode",value:function(e){return this.encoder.encode(e)}},{key:"decode",value:function(e){return this.decoder.decode(e)}}]),e}(),SN=function(e){var t=e.name,r=e.prefix,n=e.encode,i=e.decode;return new EN(t,r,n,i)},CN=function(e){var t=e.prefix,r=e.name,n=e.alphabet,i=bN(n,r),a=i.encode,s=i.decode;return SN({prefix:t,name:r,encode:a,decode:function(e){return pN(s(e))}})},AN=function(e){var t=e.name,r=e.prefix,n=e.bitsPerChar,i=e.alphabet;return SN({prefix:r,name:t,encode:function(e){return function(e,t,r){for(var n="="===t[t.length-1],i=(1<<r)-1,a="",s=0,o=0,u=0;u<e.length;++u)for(o=o<<8|e[u],s+=8;s>r;)a+=t[i&o>>(s-=r)];if(s&&(a+=t[i&o<<r-s]),n)for(;a.length*r&7;)a+="=";return a}(e,i,n)},decode:function(e){return function(e,t,r,n){for(var i={},a=0;a<t.length;++a)i[t[a]]=a;for(var s=e.length;"="===e[s-1];)--s;for(var o=new Uint8Array(s*r/8|0),u=0,c=0,l=0,h=0;h<s;++h){var f=i[e[h]];if(void 0===f)throw new SyntaxError("Non-".concat(n," character"));c=c<<r|f,(u+=r)>=8&&(u-=8,o[l++]=255&c>>u)}if(u>=r||255&c<<8-u)throw new SyntaxError("Unexpected end of data");return o}(e,i,n,t)}})},DN=CN({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),RN=CN({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),TN=AN({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ZN=AN({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),IN=AN({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),PN=AN({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),LN=AN({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),MN=AN({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),BN=AN({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),ON=AN({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),NN=AN({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),FN=function(e,t){var r=e.bytes;return 0===e.version?WN(r,zN(e),t||DN.encoder):qN(r,zN(e),t||TN.encoder)},UN=new WeakMap,zN=function(e){var t=UN.get(e);if(null==t){var r=new Map;return UN.set(e,r),r}return t},jN=function(e,t){function r(e,t,n,i){(0,hi.Z)(this,r),this.code=t,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}return(0,fi.Z)(r,[{key:"asCID",get:function(){return this}},{key:"byteOffset",get:function(){return this.bytes.byteOffset}},{key:"byteLength",get:function(){return this.bytes.byteLength}},{key:"toV0",value:function(){switch(this.version){case 0:return this;case 1:var e=this.code,t=this.multihash;if(e!==VN)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==KN)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return r.createV0(t);default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}},{key:"toV1",value:function(){switch(this.version){case 0:var e=this.multihash,t=e.code,n=e.digest,i=vN(t,n);return r.createV1(this.code,i);case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}},{key:"equals",value:function(e){return r.equals(this,e)}},{key:"toString",value:function(e){return FN(this,e)}},{key:"toJSON",value:function(){return{"/":FN(this)}}},{key:"link",value:function(){return this}},{key:e,get:function(){return"CID"}},{key:t,value:function(){return"CID(".concat(this.toString(),")")}}],[{key:"equals",value:function(e,t){var r=t;return r&&e.code===r.code&&e.version===r.version&&function(e,t){if(e===t)return!0;var r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(var r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}(e.bytes,r.bytes)}(e.multihash,r.multihash)}},{key:"asCID",value:function(e){if(null==e)return null;var t=e;if(t instanceof r)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){var n=t.version,i=t.code,a=t.multihash;return new r(n,i,a,t.bytes||YN(n,i,a.bytes))}if(!0===t[GN]){var s=t.version,o=t.multihash,u=t.code,c=gN(o);return r.create(s,u,c)}return null}},{key:"create",value:function(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==VN)throw new Error("Version 0 CID must use dag-pb (code: ".concat(VN,") block encoding"));return new r(e,t,n,n.bytes);case 1:return new r(e,t,n,YN(e,t,n.bytes));default:throw new Error("Invalid version")}}},{key:"createV0",value:function(e){return r.create(0,VN,e)}},{key:"createV1",value:function(e,t){return r.create(1,e,t)}},{key:"decode",value:function(e){var t=r.decodeFirst(e),n=(0,ke.Z)(t,2),i=n[0];if(n[1].length)throw new Error("Incorrect length");return i}},{key:"decodeFirst",value:function(e){var t=r.inspectBytes(e),n=t.size-t.multihashSize,i=pN(e.subarray(n,n+t.multihashSize));if(i.byteLength!==t.multihashSize)throw new Error("Incorrect length");var a=i.subarray(t.multihashSize-t.digestSize),s=new yN(t.multihashCode,t.digestSize,a,i);return[0===t.version?r.createV0(s):r.createV1(t.codec,s),e.subarray(t.size)]}},{key:"inspectBytes",value:function(e){var t=0,r=function(){var r=hN(e.subarray(t)),n=(0,ke.Z)(r,2),i=n[0],a=n[1];return t+=a,i},n=r(),i=VN;if(18===n?(n=0,t=0):i=r(),0!==n&&1!==n)throw new RangeError("Invalid CID version ".concat(n));var a=t,s=r(),o=r(),u=t+o;return{version:n,codec:i,multihashCode:s,digestSize:o,multihashSize:u-a,size:u}}},{key:"parse",value:function(e,t){var n=HN(e,t),i=(0,ke.Z)(n,2),a=i[0],s=i[1],o=r.decode(s);if(0===o.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return zN(o).set(a,e),o}}]),r}(Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom")),HN=function(e,t){switch(e[0]){case"Q":var r=t||DN;return[DN.prefix,r.decode("".concat(DN.prefix).concat(e))];case DN.prefix:var n=t||DN;return[DN.prefix,n.decode(e)];case TN.prefix:var i=t||TN;return[TN.prefix,i.decode(e)];default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},WN=function(e,t,r){var n=r.prefix;if(n!==DN.prefix)throw Error("Cannot string encode V0 in ".concat(r.name," encoding"));var i=t.get(n);if(null==i){var a=r.encode(e).slice(1);return t.set(n,a),a}return i},qN=function(e,t,r){var n=r.prefix,i=t.get(n);if(null==i){var a=r.encode(e);return t.set(n,a),a}return i},VN=112,KN=18,YN=function(e,t,r){var n=dN(e),i=n+dN(t),a=new Uint8Array(i+r.byteLength);return fN(e,a,0),fN(t,a,n),a.set(r,i),a},GN=Symbol.for("@ipld/js-cid/CID"),QN=SN({prefix:"\0",name:"identity",encode:function(e){return t=e,(new TextDecoder).decode(t);var t},decode:function(e){return function(e){return(new TextEncoder).encode(e)}(e)}}),XN=AN({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),JN=AN({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),$N=CN({prefix:"9",name:"base10",alphabet:"0123456789"}),eF=AN({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),tF=AN({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),rF=CN({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),nF=CN({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),iF=AN({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),aF=AN({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),sF=AN({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),oF=AN({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),uF=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),cF=uF.reduce((function(e,t,r){return e[r]=t,e}),[]),lF=uF.reduce((function(e,t,r){return e[t.codePointAt(0)]=r,e}),[]);var hF=SN({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce((function(e,t){return e+=cF[t]}),"")},decode:function(e){var t,r=[],n=(0,ge.Z)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=lF[i.codePointAt(0)];if(void 0===a)throw new Error("Non-base256emoji character: ".concat(i));r.push(a)}}catch(S$){n.e(S$)}finally{n.f()}return new Uint8Array(r)}}),fF=function(e){var t=e.name,r=e.code,n=e.encode;return new dF(t,r,n)},dF=function(){function e(t,r,n){(0,hi.Z)(this,e),this.name=t,this.code=r,this.encode=n}return(0,fi.Z)(e,[{key:"digest",value:function(e){var t=this;if(e instanceof Uint8Array){var r=this.encode(e);return r instanceof Uint8Array?vN(this.code,r):r.then((function(e){return vN(t.code,e)}))}throw Error("Unknown type, must be binary type")}}]),e}(),pF=function(e){return function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(r){return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Uint8Array,t.next=3,crypto.subtle.digest(e,r);case 3:return t.t1=t.sent,t.abrupt("return",new t.t0(t.t1));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},vF=fF({name:"sha2-256",code:18,encode:pF("SHA-256")}),gF=fF({name:"sha2-512",code:19,encode:pF("SHA-512")}),yF=pN,mF={code:0,name:"identity",encode:yF,digest:function(e){return vN(0,yF(e))}},bF="raw",_F=85,wF=function(e){return pN(e)},kF=function(e){return pN(e)},xF=new TextEncoder,EF=new TextDecoder,SF="json",CF=512,AF=function(e){return xF.encode(JSON.stringify(e))},DF=function(e){return JSON.parse(EF.decode(e))},RF=(0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)({},U),z),j),H),W),F),q),N),V),K);(0,_e.Z)((0,_e.Z)({},Y),G);function TF(e,t){switch(VO(e).code){case 4:case 41:return function(e){var t=zO(e,0,e.length);if(null==t)throw new Error("ipBuff is required");if(!Um(t))throw new Error("invalid ip address");return t}(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return NF(t);case 6:case 273:case 33:case 132:return BF(t).toString();case 421:return function(e){var t=Po.decode(e),r=e.slice(Po.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return Ws(r,"base58btc")}(t);case 444:case 445:return FF(t);case 466:return function(e){var t=Po.decode(e),r=e.slice(Po.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return"u"+Ws(r,"base64url")}(t);default:return Ws(t,"base16")}}function ZF(e,t){switch(VO(e).code){case 4:case 41:return LF(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return OF(t);case 6:case 273:case 33:case 132:return MF(parseInt(t,10));case 421:return function(e){var t;t="Q"===e[0]||"1"===e[0]?gN(DN.decode("z".concat(e))).bytes:jN.parse(e).multihash.bytes;var r=Uint8Array.from(Po.encode(t.length));return Eu([r,t],r.length+t.length)}(t);case 444:return function(e){var t=e.split(":");if(2!==t.length)throw new Error("failed to parse onion addr: [\"'".concat(t.join('", "'),"'\"]' does not contain a port number"));if(16!==t[0].length)throw new Error("failed to parse onion addr: ".concat(t[0]," not a Tor onion address."));var r=TN.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");var i=MF(n);return Eu([r,i],r.length+i.length)}(t);case 445:return function(e){var t=e.split(":");if(2!==t.length)throw new Error("failed to parse onion addr: [\"'".concat(t.join('", "'),"'\"]' does not contain a port number"));if(56!==t[0].length)throw new Error("failed to parse onion addr: ".concat(t[0]," not a Tor onion3 address."));var r=TN.decode("b".concat(t[0])),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");var i=MF(n);return Eu([r,i],r.length+i.length)}(t);case 466:return function(e){var t=PF.decode(e),r=Uint8Array.from(Po.encode(t.length));return Eu([r,t],r.length+t.length)}(t);default:return Hs(t,"base16")}}var IF=Object.values(RF).map((function(e){return e.decoder})),PF=function(){var e=IF[0].or(IF[1]);return IF.slice(2).forEach((function(t){return e=e.or(t)})),e}();function LF(e){if(!Um(e))throw new Error("invalid ip address");return UO(e)}function MF(e){var t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function BF(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function OF(e){var t=Hs(e),r=Uint8Array.from(Po.encode(t.length));return Eu([r,t],r.length+t.length)}function NF(e){var t=Po.decode(e);if((e=e.slice(Po.decode.bytes)).length!==t)throw new Error("inconsistent lengths");return Ws(e)}function FF(e){var t=e.slice(0,e.length-2),r=e.slice(e.length-2),n=Ws(t,"base32"),i=BF(r);return"".concat(n,":").concat(i)}function UF(e){return e.map((function(e){var t=QF(e);return null!=e[1]?[t.code,TF(t.code,e[1])]:[t.code]}))}function zF(e){return VF(Eu(e.map((function(e){var t=QF(e),r=Uint8Array.from(Po.encode(t.code));return e.length>1&&null!=e[1]&&(r=Eu([r,e[1]])),r}))))}function jF(e,t){return e.size>0?e.size/8:0===e.size?0:Po.decode(t)+(null!==(r=Po.decode.bytes)&&void 0!==r?r:0);var r}function HF(e){for(var t=[],r=0;r<e.length;){var n,i=Po.decode(e,r),a=null!==(n=Po.decode.bytes)&&void 0!==n?n:0,s=jF(VO(i),e.slice(r+a));if(0!==s){var o=e.slice(r+a,r+a+s);if((r+=s+a)>e.length)throw GF("Invalid address Uint8Array: "+Ws(e,"base16"));t.push([i,o])}else t.push([i]),r+=a}return t}function WF(e){return function(e){var t=[];return e.map((function(e){var r=QF(e);return t.push(r.name),e.length>1&&null!=e[1]&&t.push(e[1]),null})),YF(t.join("/"))}(UF(HF(e)))}function qF(e){var t=function(e){var t=[],r=e.split("/").slice(1);if(1===r.length&&""===r[0])return[];for(var n=0;n<r.length;n++){var i=r[n],a=VO(i);if(0!==a.size){if(++n>=r.length)throw GF("invalid address: "+e);if(!0===a.path){t.push([i,YF(r.slice(n).join("/"))]);break}t.push([i,r[n]])}else t.push([i])}return t}(e=YF(e));return zF(t.map((function(e){Array.isArray(e)||(e=[e]);var t=QF(e);return e.length>1?[t.code,ZF(t.code,e[1])]:[t.code]})))}function VF(e){var t=KF(e);if(null!=t)throw t;return Uint8Array.from(e)}function KF(e){try{HF(e)}catch(S$){return S$}}function YF(e){return"/"+e.trim().split("/").filter((function(e){return e})).join("/")}function GF(e){return new Error("Error parsing address: "+e)}function QF(e){return VO(e[0])}var XF,JF,$F,eU,tU=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},rU=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},nU=Symbol.for("nodejs.util.inspect.custom"),iU=[VO("dns").code,VO("dns4").code,VO("dns6").code,VO("dnsaddr").code],aU=new Map,sU=Symbol.for("@multiformats/js-multiaddr/multiaddr");function oU(e){return Boolean(null===e||void 0===e?void 0:e[sU])}var uU=function(e){function t(e){if((0,hi.Z)(this,t),XF.set(this,void 0),JF.set(this,void 0),$F.set(this,void 0),this[eU]=!0,null==e&&(e=""),e instanceof Uint8Array)this.bytes=VF(e);else if("string"===typeof e){if(e.length>0&&"/"!==e.charAt(0))throw new Error('multiaddr "'.concat(e,'" must start with a "/"'));this.bytes=qF(e)}else{if(!oU(e))throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=VF(e.bytes)}}return(0,fi.Z)(t,[{key:"toString",value:function(){return null==tU(this,XF,"f")&&rU(this,XF,WF(this.bytes),"f"),tU(this,XF,"f")}},{key:"toJSON",value:function(){return this.toString()}},{key:"toOptions",value:function(){var e,t,r,n,i,a="",s=VO("tcp"),o=VO("udp"),u=VO("ip4"),c=VO("ip6"),l=VO("dns6"),h=VO("ip6zone"),f=(0,ge.Z)(this.stringTuples());try{for(f.s();!(i=f.n()).done;){var d=(0,ke.Z)(i.value,2),p=d[0],v=d[1];p===h.code&&(a="%".concat(null!==v&&void 0!==v?v:"")),iU.includes(p)&&(t=s.name,n=443,r="".concat(null!==v&&void 0!==v?v:"").concat(a),e=p===l.code?6:4),p!==s.code&&p!==o.code||(t=VO(p).name,n=parseInt(null!==v&&void 0!==v?v:"")),p!==u.code&&p!==c.code||(t=VO(p).name,r="".concat(null!==v&&void 0!==v?v:"").concat(a),e=p===c.code?6:4)}}catch(S$){f.e(S$)}finally{f.f()}if(null==e||null==t||null==r||null==n)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:r,transport:t,port:n}}},{key:"protos",value:function(){return this.protoCodes().map((function(e){return Object.assign({},VO(e))}))}},{key:"protoCodes",value:function(){for(var e=[],t=this.bytes,r=0;r<t.length;){var n,i=Po.decode(t,r),a=null!==(n=Po.decode.bytes)&&void 0!==n?n:0;r+=jF(VO(i),t.slice(r+a))+a,e.push(i)}return e}},{key:"protoNames",value:function(){return this.protos().map((function(e){return e.name}))}},{key:"tuples",value:function(){return null==tU(this,JF,"f")&&rU(this,JF,HF(this.bytes),"f"),tU(this,JF,"f")}},{key:"stringTuples",value:function(){return null==tU(this,$F,"f")&&rU(this,$F,UF(this.tuples()),"f"),tU(this,$F,"f")}},{key:"encapsulate",value:function(e){return e=new t(e),new t(this.toString()+e.toString())}},{key:"decapsulate",value:function(e){var r=e.toString(),n=this.toString(),i=n.lastIndexOf(r);if(i<0)throw new Error("Address ".concat(this.toString()," does not contain subaddress: ").concat(e.toString()));return new t(n.slice(0,i))}},{key:"decapsulateCode",value:function(e){for(var r=this.tuples(),n=r.length-1;n>=0;n--)if(r[n][0]===e)return new t(zF(r.slice(0,n)));return this}},{key:"getPeerId",value:function(){try{var e=this.stringTuples().filter((function(e){return e[0]===HO.ipfs.code})),t=e.pop();if(null!=(null===t||void 0===t?void 0:t[1])){var r=t[1];return"Q"===r[0]||"1"===r[0]?Ws(DN.decode("z".concat(r)),"base58btc"):Ws(jN.parse(r).multihash.bytes,"base58btc")}return null}catch(n){return null}}},{key:"getPath",value:function(){var e=null;try{null==(e=this.stringTuples().filter((function(e){return!0===VO(e[0]).path}))[0][1])&&(e=null)}catch(t){e=null}return e}},{key:"equals",value:function(e){return Ao(this.bytes,e.bytes)}},{key:"resolve",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(r){var n,i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(n=this.protos().find((function(e){return e.resolvable})))){e.next=3;break}return e.abrupt("return",[this]);case 3:if(null!=(i=aU.get(n.name))){e.next=6;break}throw ji(new Error("no available resolver for ".concat(n.name)),"ERR_NO_AVAILABLE_RESOLVER");case 6:return e.next=8,i(this,r);case 8:return a=e.sent,e.abrupt("return",a.map((function(e){return new t(e)})));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"nodeAddress",value:function(){var e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error('multiaddr must have a valid format - no protocol with name: "'.concat(e.transport,'". Must have a valid transport protocol: "{tcp, udp}"'));return{family:e.family,address:e.host,port:e.port}}},{key:"isThinWaistAddress",value:function(e){var t=(null!==e&&void 0!==e?e:this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))}},{key:e,value:function(){return"Multiaddr(".concat(WF(this.bytes),")")}}]),t}((XF=new WeakMap,JF=new WeakMap,$F=new WeakMap,eU=sU,nU));function cU(e){try{e=lZ(new uU(e))}catch(S$){}return e=e.toString()}var lU=BO("js-kubo-rpc-client:lib:error-handler"),hU=am.bind({ignoreUndefined:!0}),fU=ZO.isBrowser||ZO.isWebWorker?location.protocol:"http",dU=ZO.isBrowser||ZO.isWebWorker?location.hostname:"localhost",pU=ZO.isBrowser||ZO.isWebWorker?location.port:"5001",vU=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(t.headers.get("Content-Type")||"").startsWith("application/json")){e.next=9;break}return e.next=4,t.json();case 4:n=e.sent,lU(n),r=n.Message||n.message,e.next=12;break;case 9:return e.next=11,t.text();case 11:r=e.sent;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),lU("Failed to parse error response",e.t0),r=e.t0.message;case 18:throw i=new OO.HTTPError(t),r&&(r.includes("deadline has elapsed")&&(i=new OO.TimeoutError),r&&r.includes("context deadline exceeded")&&(i=new OO.TimeoutError)),r&&r.includes("request timed out")&&(i=new OO.TimeoutError),r&&(i.message=r),i;case 23:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}(),gU=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,yU=function(e){return e.replace(gU,(function(e){return"-"+e.toLowerCase()}))},mU=function(e){return"string"===typeof e?MO(e):e},bU=function(e){ia(r,e);var t=ua(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,hi.Z)(this,r);var i=function(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n={};if("string"===typeof r||DO(r))e=new URL(cU(r));else if(r instanceof URL)e=r;else if("string"===typeof r.url||DO(r.url))e=new URL(cU(r.url)),n=r;else if(r.url instanceof URL)e=r.url,n=r;else{var i=((n=r||{}).protocol||fU).replace(":",""),a=(n.host||dU).split(":")[0],s=n.port||pU;e=new URL("".concat(i,"://").concat(a,":").concat(s))}if(n.apiPath?e.pathname=n.apiPath:"/"!==e.pathname&&void 0!==e.pathname||(e.pathname="api/v0"),ZO.isNode){var o=void 0;t=n.agent||new o({keepAlive:!0,maxSockets:6})}return(0,_e.Z)((0,_e.Z)({},n),{},{host:e.host,protocol:e.protocol.replace(":",""),port:Number(e.port),apiPath:e.pathname,url:e,agent:t})}(n);e=t.call(this,{timeout:mU(i.timeout||0)||void 0,headers:i.headers,base:"".concat(i.url),handleError:vU,transformSearchParams:function(e){var t,r=new URLSearchParams,n=(0,ge.Z)(e);try{for(n.s();!(t=n.n()).done;){var i=(0,ke.Z)(t.value,2),a=i[0],s=i[1];"undefined"!==s&&"null"!==s&&"signal"!==a&&r.append(yU(a),s),"timeout"!==a||isNaN(s)||r.append(yU(a),s)}}catch(S$){n.e(S$)}finally{n.f()}return r},agent:i.agent}),delete e.get,delete e.put,delete e.delete,delete e.options;var a=e.fetch;return e.fetch=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"!==typeof t||t.startsWith("/")||(t="".concat(i.url,"/").concat(t)),a.call(ra(e),t,hU(r,{method:"POST"}))},e}return(0,fi.Z)(r)}(OO),_U=(OO.HTTPError,function(e){return function(t){return e(new bU(t),t)}});function wU(e,t){if(null==e)return{};var r,n,i=xe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function kU(e){if(null!=e)return"string"===typeof e?e:e.toString(8).padStart(4,"0")}function xU(e){if(null!=e){var t;if(null!=e.secs&&(t={secs:e.secs,nsecs:e.nsecs}),null!=e.Seconds&&(t={secs:e.Seconds,nsecs:e.FractionalNanoseconds}),Array.isArray(e)&&(t={secs:e[0],nsecs:e[1]}),e instanceof Date){var r=e.getTime(),n=Math.floor(r/1e3);t={secs:n,nsecs:1e3*(r-1e3*n)}}if(Object.prototype.hasOwnProperty.call(t,"secs")){if(null!=t&&null!=t.nsecs&&(t.nsecs<0||t.nsecs>999999999))throw ji(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return t}}}var EU=["arg","searchParams","hashAlg","mtime","mode"];function SU(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.arg,r=e.searchParams,n=e.hashAlg,i=e.mtime,a=e.mode,s=wU(e,EU);r&&(s=(0,_e.Z)((0,_e.Z)({},s),r)),n&&(s.hash=n),null!=i&&(i=xU(i),s.mtime=i.secs,s.mtimeNsecs=i.nsecs),null!=a&&(s.mode=kU(a)),s.timeout&&!isNaN(s.timeout)&&(s.timeout="".concat(s.timeout,"ms")),void 0===t||null===t?t=[]:Array.isArray(t)||(t=[t]);var o=new URLSearchParams(s);return t.forEach((function(e){return o.append("arg",e)})),o}var CU=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>0&&void 0!==i[0]?i[0]:{},t.next=3,e.post("bitswap/wantlist",{signal:r.signal,searchParams:SU(r),headers:r.headers});case 3:return t.next=5,t.sent.json();case 5:return n=t.sent,t.abrupt("return",(n.Keys||[]).map((function(e){return ZB.parse(e["/"])})));case 7:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}})),AU=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:{},t.next=3,e.post("bitswap/wantlist",{signal:n.signal,searchParams:SU((0,_e.Z)((0,_e.Z)({},n),{},{peer:r.toString()})),headers:n.headers});case 3:return t.next=5,t.sent.json();case 5:return i=t.sent,t.abrupt("return",(i.Keys||[]).map((function(e){return ZB.parse(e["/"])})));case 7:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),DU=Symbol.for("@libp2p/peer-id");var RU=function(e){ia(r,e);var t=ua(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The operation was aborted";return(0,hi.Z)(this,r),e=t.call(this,n),(0,we.Z)(ra(e),"code",void 0),(0,we.Z)(ra(e),"type",void 0),e.code=r.code,e.type=r.type,e}return(0,fi.Z)(r)}(es(Error));(0,we.Z)(RU,"code","ABORT_ERR"),(0,we.Z)(RU,"type","aborted");var TU,ZU=Symbol.for("nodejs.util.inspect.custom"),IU=Object.values(FB).map((function(e){return e.decoder})).reduce((function(e,t){return e.or(t)}),FB.identity.decoder),PU=114,LU=36,MU=37;TU=Symbol.toStringTag;var BU=function(){function e(t){(0,hi.Z)(this,e),(0,we.Z)(this,"type",void 0),(0,we.Z)(this,"multihash",void 0),(0,we.Z)(this,"privateKey",void 0),(0,we.Z)(this,"publicKey",void 0),(0,we.Z)(this,"string",void 0),(0,we.Z)(this,DU,!0),this.type=t.type,this.multihash=t.multihash,this.privateKey=t.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}return(0,fi.Z)(e,[{key:TU,get:function(){return"PeerId(".concat(this.toString(),")")}},{key:"toString",value:function(){return null==this.string&&(this.string=nB.encode(this.multihash.bytes).slice(1)),this.string}},{key:"toCID",value:function(){return ZB.createV1(PU,this.multihash)}},{key:"toBytes",value:function(){return this.multihash.bytes}},{key:"toJSON",value:function(){return this.toString()}},{key:"equals",value:function(e){var t;if(e instanceof Uint8Array)return Ao(this.multihash.bytes,e);if("string"===typeof e)return UU(e).equals(this);if(null!=(null===e||void 0===e||null===(t=e.multihash)||void 0===t?void 0:t.bytes))return Ao(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}},{key:ZU,value:function(){return"PeerId(".concat(this.toString(),")")}}]),e}(),OU=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),n=t.call(this,(0,_e.Z)((0,_e.Z)({},e),{},{type:"RSA"})),(0,we.Z)(ra(n),"type","RSA"),(0,we.Z)(ra(n),"publicKey",void 0),n.publicKey=e.publicKey,n}return(0,fi.Z)(r)}(BU),NU=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),n=t.call(this,(0,_e.Z)((0,_e.Z)({},e),{},{type:"Ed25519"})),(0,we.Z)(ra(n),"type","Ed25519"),(0,we.Z)(ra(n),"publicKey",void 0),n.publicKey=e.multihash.digest,n}return(0,fi.Z)(r)}(BU),FU=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),n=t.call(this,(0,_e.Z)((0,_e.Z)({},e),{},{type:"secp256k1"})),(0,we.Z)(ra(n),"type","secp256k1"),(0,we.Z)(ra(n),"publicKey",void 0),n.publicKey=e.multihash.digest,n}return(0,fi.Z)(r)}(BU);function UU(e,t){var r;if(t=null!==(r=t)&&void 0!==r?r:IU,"1"===e.charAt(0)||"Q"===e.charAt(0)){var n=CM(nB.decode("z".concat(e)));return e.startsWith("12D")?new NU({multihash:n}):e.startsWith("16U")?new FU({multihash:n}):new OU({multihash:n})}return function(e){try{var t=CM(e);if(t.code===RM.code){if(t.digest.length===LU)return new NU({multihash:t});if(t.digest.length===MU)return new FU({multihash:t})}if(t.code===gB.code)return new OU({multihash:t})}catch(r){return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==PU)throw new Error("Supplied PeerID CID is invalid");var t=e.multihash;if(t.code===gB.code)return new OU({multihash:e.multihash});if(t.code===RM.code){if(t.digest.length===LU)return new NU({multihash:e.multihash});if(t.digest.length===MU)return new FU({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(ZB.decode(e))}throw new Error("Supplied PeerID CID is invalid")}(IU.decode(e))}var zU=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>0&&void 0!==i[0]?i[0]:{},t.next=3,e.post("bitswap/stat",{searchParams:SU(r),signal:r.signal,headers:r.headers});case 3:return n=t.sent,t.t0=jU,t.next=7,n.json();case 7:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 9:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}}));function jU(e){return{provideBufLen:e.ProvideBufLen,wantlist:(e.Wantlist||[]).map((function(e){return ZB.parse(e["/"])})),peers:(e.Peers||[]).map((function(e){return UU(e)})),blocksReceived:BigInt(e.BlocksReceived),dataReceived:BigInt(e.DataReceived),blocksSent:BigInt(e.BlocksSent),dataSent:BigInt(e.DataSent),dupBlksReceived:BigInt(e.DupBlksReceived),dupDataReceived:BigInt(e.DupDataReceived)}}var HU=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:{},t.next=3,e.post("block/get",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:r.toString()},n)),headers:n.headers});case 3:return i=t.sent,t.t0=Uint8Array,t.next=7,i.arrayBuffer();case 7:return t.t1=t.sent,t.abrupt("return",new t.t0(t.t1));case 9:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}}));function WU(e){var t=null!=e[Symbol.asyncIterator]?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],r=(0,ke.Z)(t,2),n=r[0],i=r[1],a=[];return(0,we.Z)({peek:function(){return n.next()},push:function(e){a.push(e)},next:function(){return a.length>0?{done:!1,value:a.shift()}:n.next()}},i,(function(){return this}))}function qU(e){return VU.apply(this,arguments)}function VU(){return VU=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],n=!1,i=!1,e.prev=3,s=ui(t);case 5:return e.next=7,s.next();case 7:if(!(n=!(o=e.sent).done)){e.next=13;break}u=o.value,r.push(u);case 10:n=!1,e.next=5;break;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(3),i=!0,a=e.t0;case 19:if(e.prev=19,e.prev=20,!n||null==s.return){e.next=24;break}return e.next=24,s.return();case 24:if(e.prev=24,!i){e.next=27;break}throw a;case 27:return e.finish(24);case 28:return e.finish(19);case 29:return e.abrupt("return",r);case 30:case"end":return e.stop()}}),e,null,[[3,15,19,29],[20,,24,28]])}))),VU.apply(this,arguments)}function KU(e){return ArrayBuffer.isView(e)||e instanceof ArrayBuffer}function YU(e){return e.constructor&&("Blob"===e.constructor.name||"File"===e.constructor.name)&&"function"===typeof e.stream}function GU(e){return"object"===typeof e&&(e.path||e.content)}var QU=function(e){return e&&"function"===typeof e.getReader};function XU(e){return JU.apply(this,arguments)}function JU(){return JU=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!KU(t)){e.next=2;break}return e.abrupt("return",new Blob([t]));case 2:if(!("string"===typeof t||t instanceof String)){e.next=4;break}return e.abrupt("return",new Blob([t.toString()]));case 4:if(!YU(t)){e.next=6;break}return e.abrupt("return",t);case 6:if(QU(t)&&(t=aA(t)),!(Symbol.iterator in t)&&!(Symbol.asyncIterator in t)){e.next=28;break}return r=WU(t),e.next=11,r.peek();case 11:if(n=e.sent,i=n.value,!n.done){e.next=16;break}return e.abrupt("return",$U(r));case 16:if(r.push(i),!Number.isInteger(i)){e.next=26;break}return e.t0=Blob,e.t1=Uint8Array,e.next=22,qU(r);case 22:return e.t2=e.sent,e.t3=e.t1.from.call(e.t1,e.t2),e.t4=[e.t3],e.abrupt("return",new e.t0(e.t4));case 26:if(!(KU(i)||"string"===typeof i||i instanceof String)){e.next=28;break}return e.abrupt("return",$U(r));case 28:throw ji(new Error("Unexpected input: ".concat(t)),"ERR_UNEXPECTED_INPUT");case 29:case"end":return e.stop()}}),e)}))),JU.apply(this,arguments)}function $U(e){return ez.apply(this,arguments)}function ez(){return ez=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],n=!1,i=!1,e.prev=3,s=ui(t);case 5:return e.next=7,s.next();case 7:if(!(n=!(o=e.sent).done)){e.next=13;break}u=o.value,r.push(u);case 10:n=!1,e.next=5;break;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(3),i=!0,a=e.t0;case 19:if(e.prev=19,e.prev=20,!n||null==s.return){e.next=24;break}return e.next=24,s.return();case 24:if(e.prev=24,!i){e.next=27;break}throw a;case 27:return e.finish(24);case 28:return e.finish(19);case 29:return e.abrupt("return",new Blob(r));case 30:case"end":return e.stop()}}),e,null,[[3,15,19,29],[20,,24,28]])}))),ez.apply(this,arguments)}function tz(e,t){return rz.apply(this,arguments)}function rz(){return rz=ea((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!1,i=!1,e.prev=2,s=ui(t);case 4:return e.next=6,Ji(s.next());case 6:if(!(n=!(o=e.sent).done)){e.next=13;break}return u=o.value,e.next=10,r(u);case 10:n=!1,e.next=4;break;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),i=!0,a=e.t0;case 19:if(e.prev=19,e.prev=20,!n||null==s.return){e.next=24;break}return e.next=24,Ji(s.return());case 24:if(e.prev=24,!i){e.next=27;break}throw a;case 27:return e.finish(24);case 28:return e.finish(19);case 29:case"end":return e.stop()}}),e,null,[[2,15,19,29],[20,,24,28]])}))),rz.apply(this,arguments)}var nz=cE.Reader,iz=cE.Writer,az=cE.util,sz=cE.roots["ipfs-unixfs"]||(cE.roots["ipfs-unixfs"]={});sz.Data=function(){function e(e){if(this.blocksizes=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.Type=0,e.prototype.Data=az.newBuffer([]),e.prototype.filesize=az.Long?az.Long.fromBits(0,0,!0):0,e.prototype.blocksizes=az.emptyArray,e.prototype.hashType=az.Long?az.Long.fromBits(0,0,!0):0,e.prototype.fanout=az.Long?az.Long.fromBits(0,0,!0):0,e.prototype.mode=0,e.prototype.mtime=null,e.encode=function(e,t){if(t||(t=iz.create()),t.uint32(8).int32(e.Type),null!=e.Data&&Object.hasOwnProperty.call(e,"Data")&&t.uint32(18).bytes(e.Data),null!=e.filesize&&Object.hasOwnProperty.call(e,"filesize")&&t.uint32(24).uint64(e.filesize),null!=e.blocksizes&&e.blocksizes.length)for(var r=0;r<e.blocksizes.length;++r)t.uint32(32).uint64(e.blocksizes[r]);return null!=e.hashType&&Object.hasOwnProperty.call(e,"hashType")&&t.uint32(40).uint64(e.hashType),null!=e.fanout&&Object.hasOwnProperty.call(e,"fanout")&&t.uint32(48).uint64(e.fanout),null!=e.mode&&Object.hasOwnProperty.call(e,"mode")&&t.uint32(56).uint32(e.mode),null!=e.mtime&&Object.hasOwnProperty.call(e,"mtime")&&sz.UnixTime.encode(e.mtime,t.uint32(66).fork()).ldelim(),t},e.decode=function(e,t){e instanceof nz||(e=nz.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new sz.Data;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.Type=e.int32();break;case 2:n.Data=e.bytes();break;case 3:n.filesize=e.uint64();break;case 4:if(n.blocksizes&&n.blocksizes.length||(n.blocksizes=[]),2===(7&i))for(var a=e.uint32()+e.pos;e.pos<a;)n.blocksizes.push(e.uint64());else n.blocksizes.push(e.uint64());break;case 5:n.hashType=e.uint64();break;case 6:n.fanout=e.uint64();break;case 7:n.mode=e.uint32();break;case 8:n.mtime=sz.UnixTime.decode(e,e.uint32());break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("Type"))throw az.ProtocolError("missing required 'Type'",{instance:n});return n},e.fromObject=function(e){if(e instanceof sz.Data)return e;var t=new sz.Data;switch(e.Type){case"Raw":case 0:t.Type=0;break;case"Directory":case 1:t.Type=1;break;case"File":case 2:t.Type=2;break;case"Metadata":case 3:t.Type=3;break;case"Symlink":case 4:t.Type=4;break;case"HAMTShard":case 5:t.Type=5}if(null!=e.Data&&("string"===typeof e.Data?az.base64.decode(e.Data,t.Data=az.newBuffer(az.base64.length(e.Data)),0):e.Data.length&&(t.Data=e.Data)),null!=e.filesize&&(az.Long?(t.filesize=az.Long.fromValue(e.filesize)).unsigned=!0:"string"===typeof e.filesize?t.filesize=parseInt(e.filesize,10):"number"===typeof e.filesize?t.filesize=e.filesize:"object"===typeof e.filesize&&(t.filesize=new az.LongBits(e.filesize.low>>>0,e.filesize.high>>>0).toNumber(!0))),e.blocksizes){if(!Array.isArray(e.blocksizes))throw TypeError(".Data.blocksizes: array expected");t.blocksizes=[];for(var r=0;r<e.blocksizes.length;++r)az.Long?(t.blocksizes[r]=az.Long.fromValue(e.blocksizes[r])).unsigned=!0:"string"===typeof e.blocksizes[r]?t.blocksizes[r]=parseInt(e.blocksizes[r],10):"number"===typeof e.blocksizes[r]?t.blocksizes[r]=e.blocksizes[r]:"object"===typeof e.blocksizes[r]&&(t.blocksizes[r]=new az.LongBits(e.blocksizes[r].low>>>0,e.blocksizes[r].high>>>0).toNumber(!0))}if(null!=e.hashType&&(az.Long?(t.hashType=az.Long.fromValue(e.hashType)).unsigned=!0:"string"===typeof e.hashType?t.hashType=parseInt(e.hashType,10):"number"===typeof e.hashType?t.hashType=e.hashType:"object"===typeof e.hashType&&(t.hashType=new az.LongBits(e.hashType.low>>>0,e.hashType.high>>>0).toNumber(!0))),null!=e.fanout&&(az.Long?(t.fanout=az.Long.fromValue(e.fanout)).unsigned=!0:"string"===typeof e.fanout?t.fanout=parseInt(e.fanout,10):"number"===typeof e.fanout?t.fanout=e.fanout:"object"===typeof e.fanout&&(t.fanout=new az.LongBits(e.fanout.low>>>0,e.fanout.high>>>0).toNumber(!0))),null!=e.mode&&(t.mode=e.mode>>>0),null!=e.mtime){if("object"!==typeof e.mtime)throw TypeError(".Data.mtime: object expected");t.mtime=sz.UnixTime.fromObject(e.mtime)}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.blocksizes=[]),t.defaults){if(r.Type=t.enums===String?"Raw":0,t.bytes===String?r.Data="":(r.Data=[],t.bytes!==Array&&(r.Data=az.newBuffer(r.Data))),az.Long){var n=new az.Long(0,0,!0);r.filesize=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.filesize=t.longs===String?"0":0;if(az.Long){n=new az.Long(0,0,!0);r.hashType=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.hashType=t.longs===String?"0":0;if(az.Long){n=new az.Long(0,0,!0);r.fanout=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.fanout=t.longs===String?"0":0;r.mode=0,r.mtime=null}if(null!=e.Type&&e.hasOwnProperty("Type")&&(r.Type=t.enums===String?sz.Data.DataType[e.Type]:e.Type),null!=e.Data&&e.hasOwnProperty("Data")&&(r.Data=t.bytes===String?az.base64.encode(e.Data,0,e.Data.length):t.bytes===Array?Array.prototype.slice.call(e.Data):e.Data),null!=e.filesize&&e.hasOwnProperty("filesize")&&("number"===typeof e.filesize?r.filesize=t.longs===String?String(e.filesize):e.filesize:r.filesize=t.longs===String?az.Long.prototype.toString.call(e.filesize):t.longs===Number?new az.LongBits(e.filesize.low>>>0,e.filesize.high>>>0).toNumber(!0):e.filesize),e.blocksizes&&e.blocksizes.length){r.blocksizes=[];for(var i=0;i<e.blocksizes.length;++i)"number"===typeof e.blocksizes[i]?r.blocksizes[i]=t.longs===String?String(e.blocksizes[i]):e.blocksizes[i]:r.blocksizes[i]=t.longs===String?az.Long.prototype.toString.call(e.blocksizes[i]):t.longs===Number?new az.LongBits(e.blocksizes[i].low>>>0,e.blocksizes[i].high>>>0).toNumber(!0):e.blocksizes[i]}return null!=e.hashType&&e.hasOwnProperty("hashType")&&("number"===typeof e.hashType?r.hashType=t.longs===String?String(e.hashType):e.hashType:r.hashType=t.longs===String?az.Long.prototype.toString.call(e.hashType):t.longs===Number?new az.LongBits(e.hashType.low>>>0,e.hashType.high>>>0).toNumber(!0):e.hashType),null!=e.fanout&&e.hasOwnProperty("fanout")&&("number"===typeof e.fanout?r.fanout=t.longs===String?String(e.fanout):e.fanout:r.fanout=t.longs===String?az.Long.prototype.toString.call(e.fanout):t.longs===Number?new az.LongBits(e.fanout.low>>>0,e.fanout.high>>>0).toNumber(!0):e.fanout),null!=e.mode&&e.hasOwnProperty("mode")&&(r.mode=e.mode),null!=e.mtime&&e.hasOwnProperty("mtime")&&(r.mtime=sz.UnixTime.toObject(e.mtime,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,cE.util.toJSONOptions)},e.DataType=function(){var e={},t=Object.create(e);return t[e[0]="Raw"]=0,t[e[1]="Directory"]=1,t[e[2]="File"]=2,t[e[3]="Metadata"]=3,t[e[4]="Symlink"]=4,t[e[5]="HAMTShard"]=5,t}(),e}(),sz.UnixTime=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.Seconds=az.Long?az.Long.fromBits(0,0,!1):0,e.prototype.FractionalNanoseconds=0,e.encode=function(e,t){return t||(t=iz.create()),t.uint32(8).int64(e.Seconds),null!=e.FractionalNanoseconds&&Object.hasOwnProperty.call(e,"FractionalNanoseconds")&&t.uint32(21).fixed32(e.FractionalNanoseconds),t},e.decode=function(e,t){e instanceof nz||(e=nz.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new sz.UnixTime;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.Seconds=e.int64();break;case 2:n.FractionalNanoseconds=e.fixed32();break;default:e.skipType(7&i)}}if(!n.hasOwnProperty("Seconds"))throw az.ProtocolError("missing required 'Seconds'",{instance:n});return n},e.fromObject=function(e){if(e instanceof sz.UnixTime)return e;var t=new sz.UnixTime;return null!=e.Seconds&&(az.Long?(t.Seconds=az.Long.fromValue(e.Seconds)).unsigned=!1:"string"===typeof e.Seconds?t.Seconds=parseInt(e.Seconds,10):"number"===typeof e.Seconds?t.Seconds=e.Seconds:"object"===typeof e.Seconds&&(t.Seconds=new az.LongBits(e.Seconds.low>>>0,e.Seconds.high>>>0).toNumber())),null!=e.FractionalNanoseconds&&(t.FractionalNanoseconds=e.FractionalNanoseconds>>>0),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if(az.Long){var n=new az.Long(0,0,!1);r.Seconds=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.Seconds=t.longs===String?"0":0;r.FractionalNanoseconds=0}return null!=e.Seconds&&e.hasOwnProperty("Seconds")&&("number"===typeof e.Seconds?r.Seconds=t.longs===String?String(e.Seconds):e.Seconds:r.Seconds=t.longs===String?az.Long.prototype.toString.call(e.Seconds):t.longs===Number?new az.LongBits(e.Seconds.low>>>0,e.Seconds.high>>>0).toNumber():e.Seconds),null!=e.FractionalNanoseconds&&e.hasOwnProperty("FractionalNanoseconds")&&(r.FractionalNanoseconds=e.FractionalNanoseconds),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,cE.util.toJSONOptions)},e}(),sz.Metadata=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.MimeType="",e.encode=function(e,t){return t||(t=iz.create()),null!=e.MimeType&&Object.hasOwnProperty.call(e,"MimeType")&&t.uint32(10).string(e.MimeType),t},e.decode=function(e,t){e instanceof nz||(e=nz.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new sz.Metadata;e.pos<r;){var i=e.uint32();if(i>>>3===1)n.MimeType=e.string();else e.skipType(7&i)}return n},e.fromObject=function(e){if(e instanceof sz.Metadata)return e;var t=new sz.Metadata;return null!=e.MimeType&&(t.MimeType=String(e.MimeType)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.MimeType=""),null!=e.MimeType&&e.hasOwnProperty("MimeType")&&(r.MimeType=e.MimeType),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,cE.util.toJSONOptions)},e}(),parseInt("0644",8),parseInt("0755",8);function oz(e){if(null!=e)return"number"===typeof e?4095&e:"0"===(e=e.toString()).substring(0,1)?4095&parseInt(e,8):4095&parseInt(e,10)}function uz(e){if(null!=e){var t;if(null!=e.secs&&(t={secs:e.secs,nsecs:e.nsecs}),null!=e.Seconds&&(t={secs:e.Seconds,nsecs:e.FractionalNanoseconds}),Array.isArray(e)&&(t={secs:e[0],nsecs:e[1]}),e instanceof Date){var r=e.getTime(),n=Math.floor(r/1e3);t={secs:n,nsecs:1e3*(r-1e3*n)}}if(Object.prototype.hasOwnProperty.call(t,"secs")){if(null!=t&&null!=t.nsecs&&(t.nsecs<0||t.nsecs>999999999))throw ji(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return t}}}function cz(){return cz=ea((0,ii.Z)().mark((function e(t,r){var n,i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("string"===typeof t||t instanceof String||KU(t)||YU(t)||t._readableState)){e.next=2;break}throw ji(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");case 2:if(QU(t)&&(t=aA(t)),!(Symbol.iterator in t)&&!(Symbol.asyncIterator in t)){e.next=26;break}return n=WU(t),e.next=7,Ji(n.peek());case 7:if(i=e.sent,a=i.value,!i.done){e.next=13;break}return e.delegateYield(Xa(ui([])),"t0",12);case 12:case 18:case 22:case 25:return e.abrupt("return");case 13:if(n.push(a),!Number.isInteger(a)){e.next=16;break}throw ji(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");case 16:if(!a._readableState){e.next=19;break}return e.delegateYield(Xa(ui(tz(n,(function(e){return lz({content:e},r)})))),"t1",18);case 19:if(!KU(a)){e.next=23;break}return e.next=22,lz({content:n},r);case 23:if(!(GU(a)||a[Symbol.iterator]||a[Symbol.asyncIterator]||QU(a)||YU(a))){e.next=26;break}return e.delegateYield(Xa(ui(tz(n,(function(e){return lz(e,r)})))),"t2",25);case 26:if(!GU(t)){e.next=28;break}throw ji(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");case 28:throw ji(new Error("Unexpected input: "+typeof t),"ERR_UNEXPECTED_INPUT");case 29:case"end":return e.stop()}}),e)}))),cz.apply(this,arguments)}function lz(e,t){return hz.apply(this,arguments)}function hz(){return hz=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.path,i=t.mode,a=t.mtime,s=t.content,o={path:n||"",mode:oz(i),mtime:uz(a)},!s){e.next=8;break}return e.next=5,r(s);case 5:o.content=e.sent,e.next=12;break;case 8:if(n){e.next=12;break}return e.next=11,r(t);case 11:o.content=e.sent;case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}}),e)}))),hz.apply(this,arguments)}function fz(e){return function(e,t){return cz.apply(this,arguments)}(e,XU,!0)}function dz(e){if(null!=e)return"string"===typeof e?e:e.toString(8).padStart(4,"0")}function pz(e,t){return vz.apply(this,arguments)}function vz(){return vz=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c,l,h,f,d,p,v,g,y,m,b,_,w,k,x,E,S=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=S.length>2&&void 0!==S[2]?S[2]:{},i=[],a=new FormData,s=0,o=0,u=!1,c=!1,e.prev=7,h=ui(fz(t));case 9:return e.next=11,h.next();case 11:if(!(u=!(f=e.sent).done)){e.next=37;break}if(d=f.value,p=d.content,v=d.path,g=d.mode,y=d.mtime,m="",b=p?"file":"dir",s>0&&(m="-".concat(s)),_=b+m,w=[],null!==g&&void 0!==g&&w.push("mode=".concat(dz(g))),null!=y&&(k=y.secs,x=y.nsecs,w.push("mtime=".concat(k)),null!=x&&w.push("mtime-nsecs=".concat(x))),w.length&&(_="".concat(_,"?").concat(w.join("&"))),!p){e.next=28;break}a.set(_,p,null!=v?encodeURIComponent(v):void 0),E=o+p.size,i.push({name:v,start:o,end:E}),o=E,e.next=33;break;case 28:if(null==v){e.next=32;break}a.set(_,new File([""],encodeURIComponent(v),{type:"application/x-directory"})),e.next=33;break;case 32:throw new Error("path or content or both must be set");case 33:s++;case 34:u=!1,e.next=9;break;case 37:e.next=43;break;case 39:e.prev=39,e.t0=e.catch(7),c=!0,l=e.t0;case 43:if(e.prev=43,e.prev=44,!u||null==h.return){e.next=48;break}return e.next=48,h.return();case 48:if(e.prev=48,!c){e.next=51;break}throw l;case 51:return e.finish(48);case 52:return e.finish(43);case 53:return e.abrupt("return",{total:o,parts:i,headers:n,body:a});case 54:case"end":return e.stop()}}),e,null,[[7,39,43,53],[44,,48,52]])}))),vz.apply(this,arguments)}var gz=__webpack_require__(4736);function yz(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,gz.anySignal)(function(e){return e.filter(Boolean)}(t))}var mz=_U((function(e,t){function r(e){return n.apply(this,arguments)}function n(){return n=(0,ai.Z)((0,ii.Z)().mark((function t(n){var i,a,s,o,u,c=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=c.length>1&&void 0!==c[1]?c[1]:{},a=new AbortController,s=yz(a.signal,i.signal),t.prev=3,t.t0=e,t.t1=_e.Z,t.t2={signal:s,searchParams:SU(i)},t.next=9,pz([n],a,i.headers);case 9:return t.t3=t.sent,t.t4=(0,t.t1)(t.t2,t.t3),t.next=13,t.t0.post.call(t.t0,"block/put",t.t4);case 13:return u=t.sent,t.next=16,u.json();case 16:o=t.sent,t.next=28;break;case 19:if(t.prev=19,t.t5=t.catch(3),"dag-pb"!==i.format){t.next=25;break}return t.abrupt("return",r(n,(0,_e.Z)((0,_e.Z)({},i),{},{format:"protobuf"})));case 25:if("dag-cbor"!==i.format){t.next=27;break}return t.abrupt("return",r(n,(0,_e.Z)((0,_e.Z)({},i),{},{format:"cbor"})));case 27:throw t.t5;case 28:return t.abrupt("return",ZB.parse(o.Key));case 29:case"end":return t.stop()}}),t,null,[[3,19]])}))),n.apply(this,arguments)}return r})),bz=_U((function(e){function t(){return t=ea((function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return Array.isArray(t)||(t=[t]),n.next=3,Ji(e.post("block/rm",{signal:r.signal,searchParams:SU((0,_e.Z)({arg:t.map((function(e){return e.toString()})),"stream-channels":!0},r)),headers:r.headers}));case 3:i=n.sent,a=!1,s=!1,n.prev=6,u=ui(i.ndjson());case 8:return n.next=10,Ji(u.next());case 10:if(!(a=!(c=n.sent).done)){n.next=17;break}return l=c.value,n.next=14,_z(l);case 14:a=!1,n.next=8;break;case 17:n.next=23;break;case 19:n.prev=19,n.t0=n.catch(6),s=!0,o=n.t0;case 23:if(n.prev=23,n.prev=24,!a||null==u.return){n.next=28;break}return n.next=28,Ji(u.return());case 28:if(n.prev=28,!s){n.next=31;break}throw o;case 31:return n.finish(28);case 32:return n.finish(23);case 33:case"end":return n.stop()}}),n,null,[[6,19,23,33],[24,,28,32]])}))()})),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}}));function _z(e){var t={cid:ZB.parse(e.Hash)};return e.Error&&(t.error=new Error(e.Error)),t}var wz=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a,s=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},t.next=3,e.post("block/stat",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:r.toString()},n)),headers:n.headers});case 3:return i=t.sent,t.next=6,i.json();case 6:return a=t.sent,t.abrupt("return",{cid:ZB.parse(a.Key),size:a.Size});case 8:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}}));function kz(e){return{get:HU(e),put:mz(e),rm:bz(e),stat:wz(e)}}var xz=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a,s,o=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},t.next=3,e.post("bootstrap/add",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:r},n)),headers:n.headers});case 3:return i=t.sent,t.next=6,i.json();case 6:return a=t.sent,s=a.Peers,t.abrupt("return",{Peers:s.map((function(e){return TO(e)}))});case 9:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),Ez=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i,a,s=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=s.length>0&&void 0!==s[0]?s[0]:{},t.next=3,e.post("bootstrap/list",{signal:r.signal,searchParams:SU(r),headers:r.headers});case 3:return n=t.sent,t.next=6,n.json();case 6:return i=t.sent,a=i.Peers,t.abrupt("return",{Peers:a.map((function(e){return TO(e)}))});case 9:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}})),Sz=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a,s,o=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},t.next=3,e.post("bootstrap/rm",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:r},n)),headers:n.headers});case 3:return i=t.sent,t.next=6,i.json();case 6:return a=t.sent,s=a.Peers,t.abrupt("return",{Peers:s.map((function(e){return TO(e)}))});case 9:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}}));function Cz(e){return{add:xz(e),list:Ez(e),rm:Sz(e)}}var Az=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a,s=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},t.next=3,e.post("config/profile/apply",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:r},n)),headers:n.headers});case 3:return i=t.sent,t.next=6,i.json();case 6:return a=t.sent,t.abrupt("return",{original:a.OldCfg,updated:a.NewCfg});case 8:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}}));function Dz(e){return{apply:Az(e)}}var Rz=_U((function(e){var t=function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a,s=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=s.length>1&&void 0!==s[1]?s[1]:{},r){t.next=3;break}throw new Error("key argument is required");case 3:return t.next=5,e.post("config",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:r},n)),headers:n.headers});case 5:return i=t.sent,t.next=8,i.json();case 8:return a=t.sent,t.abrupt("return",a.Value);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return t})),Tz=_U((function(e){var t=function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i,a=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.length>0&&void 0!==a[0]?a[0]:{},t.next=3,e.post("config/show",{signal:r.signal,searchParams:SU((0,_e.Z)({},r)),headers:r.headers});case 3:return n=t.sent,t.next=6,n.json();case 6:return i=t.sent,t.abrupt("return",i);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return t})),Zz=_U((function(e){var t=function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a,s,o=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},i=new AbortController,a=yz(i.signal,n.signal),t.t0=e,t.t1=_e.Z,t.t2={signal:a,searchParams:SU(n)},t.next=8,pz([Hs(JSON.stringify(r))],i,n.headers);case 8:return t.t3=t.sent,t.t4=(0,t.t1)(t.t2,t.t3),t.next=12,t.t0.post.call(t.t0,"config/replace",t.t4);case 12:return s=t.sent,t.next=15,s.text();case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return t})),Iz=_U((function(e){var t=function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(r,n){var i,a,s,o=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=o.length>2&&void 0!==o[2]?o[2]:{},"string"===typeof r){t.next=3;break}throw new Error("Invalid key type");case 3:return a=(0,_e.Z)((0,_e.Z)({},i),Pz(r,n)),t.next=6,e.post("config",{signal:i.signal,searchParams:SU(a),headers:i.headers});case 6:return s=t.sent,t.next=9,s.text();case 9:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}();return t})),Pz=function(e,t){switch(typeof t){case"boolean":return{arg:[e,t.toString()],bool:!0};case"string":return{arg:[e,t]};default:return{arg:[e,JSON.stringify(t)],json:!0}}};function Lz(e){return{getAll:Tz(e),get:Rz(e),set:Iz(e),replace:Zz(e),profiles:Dz(e)}}var Mz=_U((function(e){function t(){return t=ea((function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,ii.Z)().mark((function n(){var i;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Ji(e.post("dag/export",{signal:r.signal,searchParams:SU({arg:t.toString()}),headers:r.headers}));case 2:return i=n.sent,n.delegateYield(Xa(ui(i.iterator())),"t0",4);case 4:case"end":return n.stop()}}),n)}))()})),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}}));function Bz(e,t,r,n,i){return Oz.apply(this,arguments)}function Oz(){return Oz=ea((0,ii.Z)().mark((function e(t,r,n,i,a){var s,o,u,c,l,h;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getCodec(t.code);case 2:return r=e.sent,e.next=5,i(t,a);case 5:return s=e.sent,e.abrupt("return",r.decode(s));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o=r.split("/").filter(Boolean),e.next=4,Ji(s(t));case 4:u=e.sent,c=t;case 6:if(!o.length){e.next=25;break}if(l=o.shift()){e.next=10;break}throw ji(new Error('Could not resolve path "'.concat(r,'"')),"ERR_INVALID_PATH");case 10:if(!Object.prototype.hasOwnProperty.call(u,l)){e.next=16;break}return u=u[l],e.next=14,{value:u,remainderPath:o.join("/")};case 14:e.next=17;break;case 16:throw ji(new Error('no link named "'.concat(l,'" under ').concat(c)),"ERR_NO_LINK");case 17:if(!(h=ZB.asCID(u))){e.next=23;break}return c=h,e.next=22,Ji(s(u));case 22:u=e.sent;case 23:e.next=6;break;case 25:return e.next=27,{value:u,remainderPath:""};case 27:case"end":return e.stop()}}),e)}))),Oz.apply(this,arguments)}function Nz(e){return Fz.apply(this,arguments)}function Fz(){return Fz=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!1,n=!1,e.prev=2,a=ui(t);case 4:return e.next=6,a.next();case 6:if(!(r=!(s=e.sent).done)){e.next=12;break}return o=s.value,e.abrupt("return",o);case 9:r=!1,e.next=4;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(2),n=!0,i=e.t0;case 18:if(e.prev=18,e.prev=19,!r||null==a.return){e.next=23;break}return e.next=23,a.return();case 23:if(e.prev=23,!n){e.next=26;break}throw i;case 26:return e.finish(23);case 27:return e.finish(18);case 28:return e.abrupt("return",void 0);case 29:case"end":return e.stop()}}),e,null,[[2,14,18,28],[19,,23,27]])}))),Fz.apply(this,arguments)}function Uz(e){return zz.apply(this,arguments)}function zz(){return zz=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!1,i=!1,e.prev=2,s=ui(t);case 4:return e.next=6,s.next();case 6:if(!(n=!(o=e.sent).done)){e.next=12;break}u=o.value,r=u;case 9:n=!1,e.next=4;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(2),i=!0,a=e.t0;case 18:if(e.prev=18,e.prev=19,!n||null==s.return){e.next=23;break}return e.next=23,s.return();case 23:if(e.prev=23,!i){e.next=26;break}throw a;case 26:return e.finish(23);case 27:return e.finish(18);case 28:return e.abrupt("return",r);case 29:case"end":return e.stop()}}),e,null,[[2,14,18,28],[19,,23,27]])}))),zz.apply(this,arguments)}var jz=function(e,t){var r=_U((function(t,r){var n=HU(r),i=function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var i,a,s,o,u,c,l=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(i=l.length>1&&void 0!==l[1]?l[1]:{}).path){t.next=16;break}if(!i.localResolve){t.next=8;break}return t.next=5,Nz(Bz(r,i.path,e,n,i));case 5:t.t0=t.sent,t.next=11;break;case 8:return t.next=10,Uz(Bz(r,i.path,e,n,i));case 10:t.t0=t.sent;case 11:if(a=t.t0,s=a){t.next=15;break}throw ji(new Error("Not found"),"ERR_NOT_FOUND");case 15:return t.abrupt("return",s);case 16:return t.next=18,e.getCodec(r.code);case 18:return o=t.sent,t.next=21,n(r,i);case 21:return u=t.sent,c=o.decode(u),t.abrupt("return",{value:c,remainderPath:""});case 24:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return i}));return r(t)},Hz=_U((function(e){function t(){return t=ea((function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l,h,f,d,p,v,g,y;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=new AbortController,a=yz(i.signal,r.signal),n.next=4,Ji(pz(t,i,r.headers));case 4:return s=n.sent,o=s.headers,u=s.body,n.next=9,Ji(e.post("dag/import",{signal:a,headers:o,body:u,searchParams:SU({"pin-roots":r.pinRoots})}));case 9:c=n.sent,l=!1,h=!1,n.prev=12,d=ui(c.ndjson());case 14:return n.next=16,Ji(d.next());case 16:if(!(l=!(p=n.sent).done)){n.next=25;break}if(void 0===(v=p.value.Root)){n.next=22;break}return g=v.Cid["/"],y=v.PinErrorMsg,n.next=22,{root:{cid:ZB.parse(g),pinErrorMsg:y}};case 22:l=!1,n.next=14;break;case 25:n.next=31;break;case 27:n.prev=27,n.t0=n.catch(12),h=!0,f=n.t0;case 31:if(n.prev=31,n.prev=32,!l||null==d.return){n.next=36;break}return n.next=36,Ji(d.return());case 36:if(n.prev=36,!h){n.next=39;break}throw f;case 39:return n.finish(36);case 40:return n.finish(31);case 41:case"end":return n.stop()}}),n,null,[[12,27,31,41],[32,,36,40]])}))()})),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),Wz=function(e,t){var r=_U((function(t){var r=function(){var r=(0,ai.Z)((0,ii.Z)().mark((function r(n){var i,a,s,o,u,c,l,h,f=arguments;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=f.length>1&&void 0!==f[1]?f[1]:{},!(a=(0,_e.Z)({storeCodec:"dag-cbor",hashAlg:"sha2-256"},i)).inputCodec){r.next=8;break}if(n instanceof Uint8Array){r.next=5;break}throw new Error("Can only inputCodec on raw bytes that can be decoded");case 5:s=n,r.next=13;break;case 8:return r.next=10,e.getCodec(a.storeCodec);case 10:o=r.sent,s=o.encode(n),a.inputCodec=a.storeCodec;case 13:return u=new AbortController,c=yz(u.signal,a.signal),r.t0=t,r.t1=_e.Z,r.t2={timeout:a.timeout,signal:c,searchParams:SU(a)},r.next=20,pz([s],u,a.headers);case 20:return r.t3=r.sent,r.t4=(0,r.t1)(r.t2,r.t3),r.next=24,r.t0.post.call(r.t0,"dag/put",r.t4);case 24:return l=r.sent,r.next=27,l.json();case 27:return h=r.sent,r.abrupt("return",ZB.parse(h.Cid["/"]));case 29:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}();return r}));return r(t)},qz=_U((function(e){var t=function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a,s=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},t.next=3,e.post("dag/resolve",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:"".concat(r).concat(n.path?"/".concat(n.path).replace(/\/[/]+/g,"/"):"")},n)),headers:n.headers});case 3:return i=t.sent,t.next=6,i.json();case 6:return a=t.sent,t.abrupt("return",{cid:ZB.parse(a.Cid["/"]),remainderPath:a.RemPath});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return t}));function Vz(e,t){return{export:Mz(t),get:jz(e,t),import:Hz(t),put:Wz(e,t),resolve:qz(t)}}var Kz=function(e){if(0===e.Type)return{name:"SENDING_QUERY",type:e.Type};if(1===e.Type)return{from:UU(e.ID),name:"PEER_RESPONSE",type:e.Type,messageType:0,messageName:"PUT_VALUE",closer:(e.Responses||[]).map((function(e){var t=e.ID,r=e.Addrs;return{id:UU(t),multiaddrs:r.map((function(e){return TO(e)})),protocols:[]}})),providers:(e.Responses||[]).map((function(e){var t=e.ID,r=e.Addrs;return{id:UU(t),multiaddrs:r.map((function(e){return TO(e)})),protocols:[]}}))};if(2===e.Type){var t,r={id:null!==(t=e.ID)&&void 0!==t?t:UU(e.ID),multiaddrs:[],protocols:[]};return e.Responses&&e.Responses.length&&(r={id:UU(e.Responses[0].ID),multiaddrs:e.Responses[0].Addrs.map((function(e){return TO(e)})),protocols:[]}),{name:"FINAL_PEER",type:e.Type,peer:r}}if(3===e.Type)return{name:"QUERY_ERROR",type:e.Type,error:new Error(e.Extra)};if(4===e.Type)return{name:"PROVIDER",type:e.Type,providers:e.Responses.map((function(e){var t=e.ID,r=e.Addrs;return{id:UU(t),multiaddrs:r.map((function(e){return TO(e)})),protocols:[]}}))};if(5===e.Type)return{name:"VALUE",type:e.Type,value:Hs(e.Extra,"base64pad")};if(6===e.Type){var n=e.Responses.map((function(e){return UU(e.ID)}));if(!n.length)throw new Error("No peer found");return{name:"ADDING_PEER",type:e.Type,peer:n[0]}}if(7===e.Type)return{name:"DIALING_PEER",type:e.Type,peer:UU(e.ID)};throw new Error("Unknown DHT event type")},Yz=_U((function(e){function t(){return t=ea((function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Ji(e.post("dht/findpeer",{signal:r.signal,searchParams:SU((0,_e.Z)({arg:t},r)),headers:r.headers}));case 2:i=n.sent,a=!1,s=!1,n.prev=5,u=ui(i.ndjson());case 7:return n.next=9,Ji(u.next());case 9:if(!(a=!(c=n.sent).done)){n.next=16;break}return l=c.value,n.next=13,Kz(l);case 13:a=!1,n.next=7;break;case 16:n.next=22;break;case 18:n.prev=18,n.t0=n.catch(5),s=!0,o=n.t0;case 22:if(n.prev=22,n.prev=23,!a||null==u.return){n.next=27;break}return n.next=27,Ji(u.return());case 27:if(n.prev=27,!s){n.next=30;break}throw o;case 30:return n.finish(27);case 31:return n.finish(22);case 32:case"end":return n.stop()}}),n,null,[[5,18,22,32],[23,,27,31]])}))()})),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),Gz=_U((function(e){function t(){return t=ea((function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Ji(e.post("dht/findprovs",{signal:r.signal,searchParams:SU((0,_e.Z)({arg:t.toString()},r)),headers:r.headers}));case 2:i=n.sent,a=!1,s=!1,n.prev=5,u=ui(i.ndjson());case 7:return n.next=9,Ji(u.next());case 9:if(!(a=!(c=n.sent).done)){n.next=16;break}return l=c.value,n.next=13,Kz(l);case 13:a=!1,n.next=7;break;case 16:n.next=22;break;case 18:n.prev=18,n.t0=n.catch(5),s=!0,o=n.t0;case 22:if(n.prev=22,n.prev=23,!a||null==u.return){n.next=27;break}return n.next=27,Ji(u.return());case 27:if(n.prev=27,!s){n.next=30;break}throw o;case 30:return n.finish(27);case 31:return n.finish(22);case 32:case"end":return n.stop()}}),n,null,[[5,18,22,32],[23,,27,31]])}))()})),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),Qz=_U((function(e){function t(){return t=ea((function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Ji(e.post("dht/get",{signal:r.signal,searchParams:SU((0,_e.Z)({arg:t instanceof Uint8Array?Ws(t):t.toString()},r)),headers:r.headers}));case 2:i=n.sent,a=!1,s=!1,n.prev=5,u=ui(i.ndjson());case 7:return n.next=9,Ji(u.next());case 9:if(!(a=!(c=n.sent).done)){n.next=16;break}return l=c.value,n.next=13,Kz(l);case 13:a=!1,n.next=7;break;case 16:n.next=22;break;case 18:n.prev=18,n.t0=n.catch(5),s=!0,o=n.t0;case 22:if(n.prev=22,n.prev=23,!a||null==u.return){n.next=27;break}return n.next=27,Ji(u.return());case 27:if(n.prev=27,!s){n.next=30;break}throw o;case 30:return n.finish(27);case 31:return n.finish(22);case 32:case"end":return n.stop()}}),n,null,[[5,18,22,32],[23,,27,31]])}))()})),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),Xz=_U((function(e){function t(){return t=ea((function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{recursive:!1};return(0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l,h;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=Array.isArray(t)?t:[t],n.next=3,Ji(e.post("dht/provide",{signal:r.signal,searchParams:SU((0,_e.Z)({arg:i.map((function(e){return e.toString()}))},r)),headers:r.headers}));case 3:a=n.sent,s=!1,o=!1,n.prev=6,c=ui(a.ndjson());case 8:return n.next=10,Ji(c.next());case 10:if(!(s=!(l=n.sent).done)){n.next=17;break}return h=l.value,n.next=14,Kz(h);case 14:s=!1,n.next=8;break;case 17:n.next=23;break;case 19:n.prev=19,n.t0=n.catch(6),o=!0,u=n.t0;case 23:if(n.prev=23,n.prev=24,!s||null==c.return){n.next=28;break}return n.next=28,Ji(c.return());case 28:if(n.prev=28,!o){n.next=31;break}throw u;case 31:return n.finish(28);case 32:return n.finish(23);case 33:case"end":return n.stop()}}),n,null,[[6,19,23,33],[24,,28,32]])}))()})),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),Jz=_U((function(e){function t(){return t=ea((function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,ii.Z)().mark((function i(){var a,s,o,u,c,l,h,f,d;return(0,ii.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return a=new AbortController,s=yz(a.signal,n.signal),i.t0=Ji,i.t1=e,i.t2=_e.Z,i.t3={signal:s,searchParams:SU((0,_e.Z)({arg:t instanceof Uint8Array?Ws(t):t.toString()},n))},i.next=8,Ji(pz([r],a,n.headers));case 8:return i.t4=i.sent,i.t5=(0,i.t2)(i.t3,i.t4),i.t6=i.t1.post.call(i.t1,"dht/put",i.t5),i.next=13,(0,i.t0)(i.t6);case 13:o=i.sent,u=!1,c=!1,i.prev=16,h=ui(o.ndjson());case 18:return i.next=20,Ji(h.next());case 20:if(!(u=!(f=i.sent).done)){i.next=27;break}return d=f.value,i.next=24,Kz(d);case 24:u=!1,i.next=18;break;case 27:i.next=33;break;case 29:i.prev=29,i.t7=i.catch(16),c=!0,l=i.t7;case 33:if(i.prev=33,i.prev=34,!u||null==h.return){i.next=38;break}return i.next=38,Ji(h.return());case 38:if(i.prev=38,!c){i.next=41;break}throw l;case 41:return i.finish(38);case 42:return i.finish(33);case 43:case"end":return i.stop()}}),i,null,[[16,29,33,43],[34,,38,42]])}))()})),t.apply(this,arguments)}return function(e,r){return t.apply(this,arguments)}})),$z=_U((function(e){function t(){return t=ea((function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Ji(e.post("dht/query",{signal:r.signal,searchParams:SU((0,_e.Z)({arg:t.toString()},r)),headers:r.headers}));case 2:i=n.sent,a=!1,s=!1,n.prev=5,u=ui(i.ndjson());case 7:return n.next=9,Ji(u.next());case 9:if(!(a=!(c=n.sent).done)){n.next=16;break}return l=c.value,n.next=13,Kz(l);case 13:a=!1,n.next=7;break;case 16:n.next=22;break;case 18:n.prev=18,n.t0=n.catch(5),s=!0,o=n.t0;case 22:if(n.prev=22,n.prev=23,!a||null==u.return){n.next=27;break}return n.next=27,Ji(u.return());case 27:if(n.prev=27,!s){n.next=30;break}throw o;case 30:return n.finish(27);case 31:return n.finish(22);case 32:case"end":return n.stop()}}),n,null,[[5,18,22,32],[23,,27,31]])}))()})),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}}));function ej(e){return{findPeer:Yz(e),findProvs:Gz(e),get:Qz(e),provide:Xz(e),put:Jz(e),query:$z(e)}}var tj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>0&&void 0!==i[0]?i[0]:{},t.next=3,e.post("diag/cmds",{signal:r.signal,searchParams:SU(r),headers:r.headers});case 3:return n=t.sent,t.abrupt("return",n.json());case 5:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}})),rj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>0&&void 0!==i[0]?i[0]:{},t.next=3,e.post("diag/net",{signal:r.signal,searchParams:SU(r),headers:r.headers});case 3:return n=t.sent,t.abrupt("return",n.json());case 5:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}})),nj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>0&&void 0!==i[0]?i[0]:{},t.next=3,e.post("diag/sys",{signal:r.signal,searchParams:SU(r),headers:r.headers});case 3:return n=t.sent,t.abrupt("return",n.json());case 5:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}}));function ij(e){return{cmds:tj(e),net:rj(e),sys:nj(e)}}var aj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r,n){var i,a,s,o=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=o.length>2&&void 0!==o[2]?o[2]:{},a=Array.isArray(r)?r:[r],t.next=4,e.post("files/cp",{signal:i.signal,searchParams:SU((0,_e.Z)({arg:a.concat(n).map((function(e){return ZB.asCID(e)?"/ipfs/".concat(e):e}))},i)),headers:i.headers});case 4:return s=t.sent,t.next=7,s.text();case 7:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e,r){return t.apply(this,arguments)}})),sj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a,s=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=s.length>1&&void 0!==s[1]?s[1]:{},r&&"string"===typeof r){t.next=3;break}throw new Error("ipfs.files.flush requires a path");case 3:return t.next=5,e.post("files/flush",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:r},n)),headers:n.headers});case 5:return i=t.sent,t.next=8,i.json();case 8:return a=t.sent,t.abrupt("return",ZB.parse(a.Cid));case 10:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}}));function oj(e){if(null==e)return e;var t=/^[A-Z]+$/;return Object.keys(e).reduce((function(r,n){return t.test(n)?r[n.toLowerCase()]=e[n]:t.test(n[0])?r[n[0].toLowerCase()+n.slice(1)]=e[n]:r[n]=e[n],r}),{})}function uj(e){var t=oj(e);return Object.prototype.hasOwnProperty.call(t,"mode")&&(t.mode=parseInt(t.mode,8)),Object.prototype.hasOwnProperty.call(t,"mtime")&&(t.mtime={secs:t.mtime,nsecs:t.mtimeNsecs||0},delete t.mtimeNsecs),t}var cj=_U((function(e){function t(){return t=ea((function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l,h,f,d;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t){n.next=2;break}throw new Error("ipfs.files.ls requires a path");case 2:return n.next=4,Ji(e.post("files/ls",{signal:r.signal,searchParams:SU((0,_e.Z)((0,_e.Z)({arg:ZB.asCID(t)?"/ipfs/".concat(t):t,long:!0},r),{},{stream:!0})),headers:r.headers}));case 4:i=n.sent,a=!1,s=!1,n.prev=7,u=ui(i.ndjson());case 9:return n.next=11,Ji(u.next());case 11:if(!(a=!(c=n.sent).done)){n.next=38;break}if(!("Entries"in(l=c.value))){n.next=33;break}h=(0,ge.Z)(l.Entries||[]),n.prev=15,h.s();case 17:if((f=h.n()).done){n.next=23;break}return d=f.value,n.next=21,lj(uj(d));case 21:n.next=17;break;case 23:n.next=28;break;case 25:n.prev=25,n.t0=n.catch(15),h.e(n.t0);case 28:return n.prev=28,h.f(),n.finish(28);case 31:n.next=35;break;case 33:return n.next=35,lj(uj(l));case 35:a=!1,n.next=9;break;case 38:n.next=44;break;case 40:n.prev=40,n.t1=n.catch(7),s=!0,o=n.t1;case 44:if(n.prev=44,n.prev=45,!a||null==u.return){n.next=49;break}return n.next=49,Ji(u.return());case 49:if(n.prev=49,!s){n.next=52;break}throw o;case 52:return n.finish(49);case 53:return n.finish(44);case 54:case"end":return n.stop()}}),n,null,[[7,40,44,54],[15,25,28,31],[45,,49,53]])}))()})),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}}));function lj(e){return e.hash&&(e.cid=ZB.parse(e.hash)),delete e.hash,e.type=1===e.type?"directory":"file",e}var hj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:{},t.next=3,e.post("files/mkdir",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:r},n)),headers:n.headers});case 3:return i=t.sent,t.next=6,i.text();case 6:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),fj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r,n){var i,a,s=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=s.length>2&&void 0!==s[2]?s[2]:{},Array.isArray(r)||(r=[r]),t.next=4,e.post("files/mv",{signal:i.signal,searchParams:SU((0,_e.Z)({arg:r.concat(n)},i)),headers:i.headers});case 4:return a=t.sent,t.next=7,a.text();case 7:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e,r){return t.apply(this,arguments)}})),dj=__webpack_require__(6662),pj=_U((function(e){function t(){return t=ea((function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,ii.Z)().mark((function n(){var i;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Ji(e.post("files/read",{signal:r.signal,searchParams:SU((0,_e.Z)({arg:t,count:r.length},r)),headers:r.headers}));case 2:return i=n.sent,n.delegateYield(Xa(ui(dj(i.body))),"t0",4);case 4:case"end":return n.stop()}}),n)}))()})),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),vj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a,s,o=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},t.next=3,e.post("files/rm",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:r},n)),headers:n.headers});case 3:return i=t.sent,t.next=6,i.text();case 6:if(""===(a=t.sent)){t.next=11;break}throw(s=new OO.HTTPError(i)).message=a,s;case 11:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),gj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a,s=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},t.next=3,e.post("files/stat",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:r},n)),headers:n.headers});case 3:return i=t.sent,t.next=6,i.json();case 6:return(a=t.sent).WithLocality=a.WithLocality||!1,t.abrupt("return",yj(uj(a)));case 9:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}}));function yj(e){return e.cid=ZB.parse(e.hash),delete e.hash,e}var mj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r,n){var i,a,s,o,u=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=u.length>2&&void 0!==u[2]?u[2]:{},a=new AbortController,s=yz(a.signal,i.signal),t.t0=e,t.t1=_e.Z,t.t2={signal:s,searchParams:SU((0,_e.Z)({arg:r,streamChannels:!0,count:i.length},i))},t.next=8,pz([{content:n,path:"arg",mode:kU(i.mode),mtime:xU(i.mtime)}],a,i.headers);case 8:return t.t3=t.sent,t.t4=(0,t.t1)(t.t2,t.t3),t.next=12,t.t0.post.call(t.t0,"files/write",t.t4);case 12:return o=t.sent,t.next=15,o.text();case 15:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e,r){return t.apply(this,arguments)}}));function bj(e){return{cp:aj(e),flush:sj(e),ls:cj(e),mkdir:hj(e),mv:fj(e),read:pj(e),rm:vj(e),stat:gj(e),write:mj(e)}}var _j=_U((function(e){var t=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw n.length>2&&void 0!==n[2]?n[2]:{},ji(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED");case 2:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();return t})),wj={type:"ed25519"},kj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a,s=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:wj,t.next=3,e.post("key/gen",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:r},n)),headers:n.headers});case 3:return i=t.sent,t.next=6,i.json();case 6:return a=t.sent,t.abrupt("return",oj(a));case 8:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),xj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r,n,i){var a,s,o,u=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=u.length>3&&void 0!==u[3]?u[3]:{},t.next=3,e.post("key/import",{signal:a.signal,searchParams:SU((0,_e.Z)({arg:r,pem:n,password:i},a)),headers:a.headers});case 3:return s=t.sent,t.next=6,s.json();case 6:return o=t.sent,t.abrupt("return",oj(o));case 8:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e,r,n){return t.apply(this,arguments)}})),Ej=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i,a=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.length>0&&void 0!==a[0]?a[0]:{},t.next=3,e.post("key/list",{signal:r.signal,searchParams:SU(r),headers:r.headers});case 3:return n=t.sent,t.next=6,n.json();case 6:return i=t.sent,t.abrupt("return",(i.Keys||[]).map((function(e){return oj(e)})));case 8:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}})),Sj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r,n){var i,a,s=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=s.length>2&&void 0!==s[2]?s[2]:{},t.next=3,e.post("key/rename",{signal:i.signal,searchParams:SU((0,_e.Z)({arg:[r,n]},i)),headers:i.headers});case 3:return a=t.sent,t.t0=oj,t.next=7,a.json();case 7:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 9:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e,r){return t.apply(this,arguments)}})),Cj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a,s=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},t.next=3,e.post("key/rm",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:r},n)),headers:n.headers});case 3:return i=t.sent,t.next=6,i.json();case 6:return a=t.sent,t.abrupt("return",oj(a.Keys[0]));case 8:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}}));function Aj(e){return{export:_j(e),gen:kj(e),import:xj(e),list:Ej(e),rename:Sj(e),rm:Cj(e)}}var Dj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r,n){var i,a,s=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=s.length>2&&void 0!==s[2]?s[2]:{},t.next=3,e.post("log/level",{signal:i.signal,searchParams:SU((0,_e.Z)({arg:[r,n]},i)),headers:i.headers});case 3:return a=t.sent,t.t0=oj,t.next=7,a.json();case 7:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 9:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e,r){return t.apply(this,arguments)}})),Rj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i,a=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.length>0&&void 0!==a[0]?a[0]:{},t.next=3,e.post("log/ls",{signal:r.signal,searchParams:SU(r),headers:r.headers});case 3:return n=t.sent,t.next=6,n.json();case 6:return i=t.sent,t.abrupt("return",i.Strings);case 8:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}})),Tj=_U((function(e){function t(){return t=ea((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,ii.Z)().mark((function r(){var n;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Ji(e.post("log/tail",{signal:t.signal,searchParams:SU(t),headers:t.headers}));case 2:return n=r.sent,r.delegateYield(Xa(ui(n.ndjson())),"t0",4);case 4:case"end":return r.stop()}}),r)}))()})),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}}));function Zj(e){return{level:Dj(e),ls:Rj(e),tail:Tj(e)}}var Ij=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:{},t.next=3,e.post("name/publish",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:"".concat(r)},n)),headers:n.headers});case 3:return i=t.sent,t.t0=oj,t.next=7,i.json();case 7:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 9:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),Pj=_U((function(e){function t(){return t=ea((function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Ji(e.post("name/resolve",{signal:r.signal,searchParams:SU((0,_e.Z)({arg:t,stream:!0},r)),headers:r.headers}));case 2:i=n.sent,a=!1,s=!1,n.prev=5,u=ui(i.ndjson());case 7:return n.next=9,Ji(u.next());case 9:if(!(a=!(c=n.sent).done)){n.next=16;break}return l=c.value,n.next=13,l.Path;case 13:a=!1,n.next=7;break;case 16:n.next=22;break;case 18:n.prev=18,n.t0=n.catch(5),s=!0,o=n.t0;case 22:if(n.prev=22,n.prev=23,!a||null==u.return){n.next=27;break}return n.next=27,Ji(u.return());case 27:if(n.prev=27,!s){n.next=30;break}throw o;case 30:return n.finish(27);case 31:return n.finish(22);case 32:case"end":return n.stop()}}),n,null,[[5,18,22,32],[23,,27,31]])}))()})),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),Lj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:{},t.next=3,e.post("name/pubsub/cancel",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:r},n)),headers:n.headers});case 3:return i=t.sent,t.t0=oj,t.next=7,i.json();case 7:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 9:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),Mj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>0&&void 0!==i[0]?i[0]:{},t.next=3,e.post("name/pubsub/state",{signal:r.signal,searchParams:SU(r),headers:r.headers});case 3:return n=t.sent,t.t0=oj,t.next=7,n.json();case 7:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 9:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}})),Bj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i,a=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.length>0&&void 0!==a[0]?a[0]:{},t.next=3,e.post("name/pubsub/subs",{signal:r.signal,searchParams:SU(r),headers:r.headers});case 3:return n=t.sent,t.next=6,n.json();case 6:return i=t.sent,t.abrupt("return",i.Strings||[]);case 8:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}}));function Oj(e){return{cancel:Lj(e),state:Mj(e),subs:Bj(e)}}function Nj(e){return{publish:Ij(e),resolve:Pj(e),pubsub:Oj(e)}}var Fj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a,s=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},t.next=3,e.post("object/data",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:"".concat(r instanceof Uint8Array?ZB.decode(r):r)},n)),headers:n.headers});case 3:return i=t.sent,t.next=6,i.arrayBuffer();case 6:return a=t.sent,t.abrupt("return",new Uint8Array(a,0,a.byteLength));case 8:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),Uj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a,s=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},t.next=3,e.post("object/get",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:"".concat(r instanceof Uint8Array?ZB.decode(r):r),dataEncoding:"base64"},n)),headers:n.headers});case 3:return i=t.sent,t.next=6,i.json();case 6:return a=t.sent,t.abrupt("return",{Data:Hs(a.Data,"base64pad"),Links:(a.Links||[]).map((function(e){return{Name:e.Name,Hash:ZB.parse(e.Hash),Tsize:e.Size}}))});case 8:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),zj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a,s=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},t.next=3,e.post("object/links",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:"".concat(r instanceof Uint8Array?ZB.decode(r):r)},n)),headers:n.headers});case 3:return i=t.sent,t.next=6,i.json();case 6:return a=t.sent,t.abrupt("return",(a.Links||[]).map((function(e){return{Name:e.Name,Tsize:e.Size,Hash:ZB.parse(e.Hash)}})));case 8:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),jj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i,a,s=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=s.length>0&&void 0!==s[0]?s[0]:{},t.next=3,e.post("object/new",{signal:r.signal,searchParams:SU((0,_e.Z)({arg:r.template},r)),headers:r.headers});case 3:return n=t.sent,t.next=6,n.json();case 6:return i=t.sent,a=i.Hash,t.abrupt("return",ZB.parse(a));case 9:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}})),Hj=function(e,t){var r=_U((function(r){var n=Wz(e,t);function i(){return i=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,i=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{},e.abrupt("return",n(t,(0,_e.Z)((0,_e.Z)({},r),{},{storeCodec:"dag-pb",hashAlg:"sha2-256",version:1})));case 2:case"end":return e.stop()}}),e)}))),i.apply(this,arguments)}return function(e){return i.apply(this,arguments)}}));return r(t)},Wj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a,s=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},t.next=3,e.post("object/stat",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:"".concat(r)},n)),headers:n.headers});case 3:return i=t.sent,t.next=6,i.json();case 6:return a=t.sent,t.abrupt("return",(0,_e.Z)((0,_e.Z)({},a),{},{Hash:ZB.parse(a.Hash)}));case 8:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),qj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r,n){var i,a,s,o,u=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=u.length>2&&void 0!==u[2]?u[2]:{},t.next=3,e.post("object/patch/add-link",{signal:i.signal,searchParams:SU((0,_e.Z)({arg:["".concat(r),n.Name||n.name||"",(n.Hash||n.cid||"").toString()||null]},i)),headers:i.headers});case 3:return a=t.sent,t.next=6,a.json();case 6:return s=t.sent,o=s.Hash,t.abrupt("return",ZB.parse(o));case 9:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e,r){return t.apply(this,arguments)}})),Vj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r,n){var i,a,s,o,u,c,l=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=l.length>2&&void 0!==l[2]?l[2]:{},a=new AbortController,s=yz(a.signal,i.signal),t.t0=e,t.t1=_e.Z,t.t2={signal:s,searchParams:SU((0,_e.Z)({arg:"".concat(r)},i))},t.next=8,pz([n],a,i.headers);case 8:return t.t3=t.sent,t.t4=(0,t.t1)(t.t2,t.t3),t.next=12,t.t0.post.call(t.t0,"object/patch/append-data",t.t4);case 12:return o=t.sent,t.next=15,o.json();case 15:return u=t.sent,c=u.Hash,t.abrupt("return",ZB.parse(c));case 18:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e,r){return t.apply(this,arguments)}})),Kj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r,n){var i,a,s,o,u=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=u.length>2&&void 0!==u[2]?u[2]:{},t.next=3,e.post("object/patch/rm-link",{signal:i.signal,searchParams:SU((0,_e.Z)({arg:["".concat(r),n.Name||n.name||null]},i)),headers:i.headers});case 3:return a=t.sent,t.next=6,a.json();case 6:return s=t.sent,o=s.Hash,t.abrupt("return",ZB.parse(o));case 9:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e,r){return t.apply(this,arguments)}})),Yj=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r,n){var i,a,s,o,u,c,l=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=l.length>2&&void 0!==l[2]?l[2]:{},a=new AbortController,s=yz(a.signal,i.signal),t.t0=e,t.t1=_e.Z,t.t2={signal:s,searchParams:SU((0,_e.Z)({arg:["".concat(r)]},i))},t.next=8,pz([n],a,i.headers);case 8:return t.t3=t.sent,t.t4=(0,t.t1)(t.t2,t.t3),t.next=12,t.t0.post.call(t.t0,"object/patch/set-data",t.t4);case 12:return o=t.sent,t.next=15,o.json();case 15:return u=t.sent,c=u.Hash,t.abrupt("return",ZB.parse(c));case 18:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e,r){return t.apply(this,arguments)}}));function Gj(e){return{addLink:qj(e),appendData:Vj(e),rmLink:Kj(e),setData:Yj(e)}}function Qj(e,t){return{data:Fj(t),get:Uj(t),links:zj(t),new:jj(t),put:Hj(e,t),stat:Wj(t),patch:Gj(t)}}function Xj(e){return Symbol.asyncIterator in e}function Jj(e){return null!=jN.asCID(e)}function $j(e){return eH.apply(this,arguments)}function eH(){return eH=ea((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o,u,c,l,h,f,d,p,v,g,y,m,b,_,w,k,x,E,S,C,A,D,R,T,Z,I,P;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t&&void 0!==t){e.next=2;break}throw ji(new Error("Unexpected input: ".concat(t)),"ERR_UNEXPECTED_INPUT");case 2:if(!(r=jN.asCID(t))){e.next=7;break}return e.next=6,tH({cid:r});case 6:return e.abrupt("return");case 7:if(!(t instanceof String||"string"===typeof t)){e.next=11;break}return e.next=10,tH({path:t});case 10:return e.abrupt("return");case 11:if(null==t.cid&&null==t.path){e.next=15;break}return e.next=14,tH(t);case 14:return e.abrupt("return",e.sent);case 15:if(L=t,!(Symbol.iterator in L)){e.next=84;break}if(n=t[Symbol.iterator](),!(i=n.next()).done){e.next=20;break}return e.abrupt("return",n);case 20:if(!Jj(i.value)){e.next=41;break}return e.next=23,tH({cid:i.value});case 23:a=(0,ge.Z)(n),e.prev=24,a.s();case 26:if((s=a.n()).done){e.next=32;break}return o=s.value,e.next=30,tH({cid:o});case 30:e.next=26;break;case 32:e.next=37;break;case 34:e.prev=34,e.t0=e.catch(24),a.e(e.t0);case 37:return e.prev=37,a.f(),e.finish(37);case 40:return e.abrupt("return");case 41:if(!(i.value instanceof String||"string"===typeof i.value)){e.next=62;break}return e.next=44,tH({path:i.value});case 44:u=(0,ge.Z)(n),e.prev=45,u.s();case 47:if((c=u.n()).done){e.next=53;break}return l=c.value,e.next=51,tH({path:l});case 51:e.next=47;break;case 53:e.next=58;break;case 55:e.prev=55,e.t1=e.catch(45),u.e(e.t1);case 58:return e.prev=58,u.f(),e.finish(58);case 61:return e.abrupt("return");case 62:if(null==i.value.cid&&null==i.value.path){e.next=83;break}return e.next=65,tH(i.value);case 65:h=(0,ge.Z)(n),e.prev=66,h.s();case 68:if((f=h.n()).done){e.next=74;break}return d=f.value,e.next=72,tH(d);case 72:e.next=68;break;case 74:e.next=79;break;case 76:e.prev=76,e.t2=e.catch(66),h.e(e.t2);case 79:return e.prev=79,h.f(),e.finish(79);case 82:return e.abrupt("return");case 83:throw ji(new Error("Unexpected input: "+typeof t),"ERR_UNEXPECTED_INPUT");case 84:if(!Xj(t)){e.next=191;break}return p=t[Symbol.asyncIterator](),e.next=88,Ji(p.next());case 88:if(!(v=e.sent).done){e.next=91;break}return e.abrupt("return",p);case 91:if(!Jj(v.value)){e.next=124;break}return e.next=94,tH({cid:v.value});case 94:g=!1,y=!1,e.prev=96,b=ui(p);case 98:return e.next=100,Ji(b.next());case 100:if(!(g=!(_=e.sent).done)){e.next=107;break}return w=_.value,e.next=104,tH({cid:w});case 104:g=!1,e.next=98;break;case 107:e.next=113;break;case 109:e.prev=109,e.t3=e.catch(96),y=!0,m=e.t3;case 113:if(e.prev=113,e.prev=114,!g||null==b.return){e.next=118;break}return e.next=118,Ji(b.return());case 118:if(e.prev=118,!y){e.next=121;break}throw m;case 121:return e.finish(118);case 122:return e.finish(113);case 123:return e.abrupt("return");case 124:if(!(v.value instanceof String||"string"===typeof v.value)){e.next=157;break}return e.next=127,tH({path:v.value});case 127:k=!1,x=!1,e.prev=129,S=ui(p);case 131:return e.next=133,Ji(S.next());case 133:if(!(k=!(C=e.sent).done)){e.next=140;break}return A=C.value,e.next=137,tH({path:A});case 137:k=!1,e.next=131;break;case 140:e.next=146;break;case 142:e.prev=142,e.t4=e.catch(129),x=!0,E=e.t4;case 146:if(e.prev=146,e.prev=147,!k||null==S.return){e.next=151;break}return e.next=151,Ji(S.return());case 151:if(e.prev=151,!x){e.next=154;break}throw E;case 154:return e.finish(151);case 155:return e.finish(146);case 156:return e.abrupt("return");case 157:if(null==v.value.cid&&null==v.value.path){e.next=190;break}return e.next=160,tH(v.value);case 160:D=!1,R=!1,e.prev=162,Z=ui(p);case 164:return e.next=166,Ji(Z.next());case 166:if(!(D=!(I=e.sent).done)){e.next=173;break}return P=I.value,e.next=170,tH(P);case 170:D=!1,e.next=164;break;case 173:e.next=179;break;case 175:e.prev=175,e.t5=e.catch(162),R=!0,T=e.t5;case 179:if(e.prev=179,e.prev=180,!D||null==Z.return){e.next=184;break}return e.next=184,Ji(Z.return());case 184:if(e.prev=184,!R){e.next=187;break}throw T;case 187:return e.finish(184);case 188:return e.finish(179);case 189:return e.abrupt("return");case 190:case 191:throw ji(new Error("Unexpected input: "+typeof t),"ERR_UNEXPECTED_INPUT");case 192:case"end":return e.stop()}var L}),e,null,[[24,34,37,40],[45,55,58,61],[66,76,79,82],[96,109,113,123],[114,,118,122],[129,142,146,156],[147,,151,155],[162,175,179,189],[180,,184,188]])}))),eH.apply(this,arguments)}function tH(e){var t=e.cid||"".concat(e.path);if(!t)throw ji(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");var r={path:t,recursive:!1!==e.recursive};return null!=e.metadata&&(r.metadata=e.metadata),r}var rH=_U((function(e){function t(){return t=ea((function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l,h,f,d,p,v,g,y,m,b,_,w,k;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=!1,a=!1,n.prev=2,o=ui($j(t));case 4:return n.next=6,Ji(o.next());case 6:if(!(i=!(u=n.sent).done)){n.next=62;break}return c=u.value,l=c.path,h=c.recursive,f=c.metadata,n.next=10,Ji(e.post("pin/add",{signal:r.signal,searchParams:SU((0,_e.Z)((0,_e.Z)({},r),{},{arg:l,recursive:h,metadata:f?JSON.stringify(f):void 0,stream:!0})),headers:r.headers}));case 10:d=n.sent,p=!1,v=!1,n.prev=13,y=ui(d.ndjson());case 15:return n.next=17,Ji(y.next());case 17:if(!(p=!(m=n.sent).done)){n.next=43;break}if(!(b=m.value).Pins){n.next=38;break}_=(0,ge.Z)(b.Pins),n.prev=21,_.s();case 23:if((w=_.n()).done){n.next=29;break}return k=w.value,n.next=27,ZB.parse(k);case 27:n.next=23;break;case 29:n.next=34;break;case 31:n.prev=31,n.t0=n.catch(21),_.e(n.t0);case 34:return n.prev=34,_.f(),n.finish(34);case 37:return n.abrupt("continue",40);case 38:return n.next=40,ZB.parse(b);case 40:p=!1,n.next=15;break;case 43:n.next=49;break;case 45:n.prev=45,n.t1=n.catch(13),v=!0,g=n.t1;case 49:if(n.prev=49,n.prev=50,!p||null==y.return){n.next=54;break}return n.next=54,Ji(y.return());case 54:if(n.prev=54,!v){n.next=57;break}throw g;case 57:return n.finish(54);case 58:return n.finish(49);case 59:i=!1,n.next=4;break;case 62:n.next=68;break;case 64:n.prev=64,n.t2=n.catch(2),a=!0,s=n.t2;case 68:if(n.prev=68,n.prev=69,!i||null==o.return){n.next=73;break}return n.next=73,Ji(o.return());case 73:if(n.prev=73,!a){n.next=76;break}throw s;case 76:return n.finish(73);case 77:return n.finish(68);case 78:case"end":return n.stop()}}),n,null,[[2,64,68,78],[13,45,49,59],[21,31,34,37],[50,,54,58],[69,,73,77]])}))()})),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}}));function nH(e){var t=rH(e);return _U((function(){function e(){return e=(0,ai.Z)((0,ii.Z)().mark((function e(r){var n,i=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},e.abrupt("return",Uz(t([(0,_e.Z)({path:r},n)],n)));case 2:case"end":return e.stop()}}),e)}))),e.apply(this,arguments)}return function(t){return e.apply(this,arguments)}}))(e)}function iH(e,t,r){var n={type:e,cid:ZB.parse(t)};return r&&(n.metadata=r),n}var aH=_U((function(e){function t(){return t=ea((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,ii.Z)().mark((function r(){var n,i,a,s,o,u,c,l,h,f,d;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=[],t.paths&&(n=Array.isArray(t.paths)?t.paths:[t.paths]),r.next=4,Ji(e.post("pin/ls",{signal:t.signal,searchParams:SU((0,_e.Z)((0,_e.Z)({},t),{},{arg:n.map((function(e){return"".concat(e)})),stream:!0})),headers:t.headers}));case 4:i=r.sent,a=!1,s=!1,r.prev=7,u=ui(i.ndjson());case 9:return r.next=11,Ji(u.next());case 11:if(!(a=!(c=r.sent).done)){r.next=28;break}if(!(l=c.value).Keys){r.next=23;break}h=0,f=Object.keys(l.Keys);case 15:if(!(h<f.length)){r.next=22;break}return d=f[h],r.next=19,iH(l.Keys[d].Type,d,l.Keys[d].Metadata);case 19:h++,r.next=15;break;case 22:return r.abrupt("return");case 23:return r.next=25,iH(l.Type,l.Cid,l.Metadata);case 25:a=!1,r.next=9;break;case 28:r.next=34;break;case 30:r.prev=30,r.t0=r.catch(7),s=!0,o=r.t0;case 34:if(r.prev=34,r.prev=35,!a||null==u.return){r.next=39;break}return r.next=39,Ji(u.return());case 39:if(r.prev=39,!s){r.next=42;break}throw o;case 42:return r.finish(39);case 43:return r.finish(34);case 44:case"end":return r.stop()}}),r,null,[[7,30,34,44],[35,,39,43]])}))()})),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}})),sH=_U((function(e){function t(){return t=ea((function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l,h,f,d,p,v,g,y,m,b;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=!1,a=!1,n.prev=2,o=ui($j(t));case 4:return n.next=6,Ji(o.next());case 6:if(!(i=!(u=n.sent).done)){n.next=49;break}return c=u.value,l=c.path,h=c.recursive,(f=new URLSearchParams(r.searchParams)).append("arg","".concat(l)),null!=h&&f.set("recursive",String(h)),n.next=13,Ji(e.post("pin/rm",{signal:r.signal,headers:r.headers,searchParams:SU((0,_e.Z)((0,_e.Z)({},r),{},{arg:"".concat(l),recursive:h}))}));case 13:d=n.sent,p=!1,v=!1,n.prev=16,y=ui(d.ndjson());case 18:return n.next=20,Ji(y.next());case 20:if(!(p=!(m=n.sent).done)){n.next=30;break}if(!(b=m.value).Pins){n.next=25;break}return n.delegateYield(Xa(ui(b.Pins.map((function(e){return ZB.parse(e)})))),"t0",24);case 24:return n.abrupt("continue",27);case 25:return n.next=27,ZB.parse(b);case 27:p=!1,n.next=18;break;case 30:n.next=36;break;case 32:n.prev=32,n.t1=n.catch(16),v=!0,g=n.t1;case 36:if(n.prev=36,n.prev=37,!p||null==y.return){n.next=41;break}return n.next=41,Ji(y.return());case 41:if(n.prev=41,!v){n.next=44;break}throw g;case 44:return n.finish(41);case 45:return n.finish(36);case 46:i=!1,n.next=4;break;case 49:n.next=55;break;case 51:n.prev=51,n.t2=n.catch(2),a=!0,s=n.t2;case 55:if(n.prev=55,n.prev=56,!i||null==o.return){n.next=60;break}return n.next=60,Ji(o.return());case 60:if(n.prev=60,!a){n.next=63;break}throw s;case 63:return n.finish(60);case 64:return n.finish(55);case 65:case"end":return n.stop()}}),n,null,[[2,51,55,65],[16,32,36,46],[37,,41,45],[56,,60,64]])}))()})),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),oH=function(e){var t=sH(e);return _U((function(){function e(){return e=(0,ai.Z)((0,ii.Z)().mark((function e(r){var n,i=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},e.abrupt("return",Uz(t([(0,_e.Z)({path:r},n)],n)));case 2:case"end":return e.stop()}}),e)}))),e.apply(this,arguments)}return function(t){return e.apply(this,arguments)}}))(e)},uH=function(e){var t=e.Name,r=e.Status,n=e.Cid;return{cid:ZB.parse(n),name:t,status:r}},cH=function(e){if("string"===typeof e&&""!==e)return e;throw new TypeError("service name must be passed")},lH=function(e){if(ZB.asCID(e))return e.toString();throw new TypeError("CID instance expected instead of ".concat(typeof e))},hH=function(e){var t=e.service,r=e.cid,n=e.name,i=e.status,a=e.all,s=SU({service:cH(t),name:n,force:!!a||void 0});if(r){var o,u=(0,ge.Z)(r);try{for(u.s();!(o=u.n()).done;){var c=o.value;s.append("cid",lH(c))}}catch(S$){u.e(S$)}finally{u.f()}}if(i){var l,h=(0,ge.Z)(i);try{for(h.s();!(l=h.n()).done;){var f=l.value;s.append("status",f)}}catch(S$){h.e(S$)}finally{h.f()}}return s},fH=function(e){var t=e.cid,r=e.service,n=e.background,i=e.name,a=e.origins,s=SU({arg:lH(t),service:cH(r),name:i,background:!!n||void 0});if(a){var o,u=(0,ge.Z)(a);try{for(u.s();!(o=u.n()).done;){var c=o.value;s.append("origin",c.toString())}}catch(S$){u.e(S$)}finally{u.f()}}return s},dH=["timeout","signal","headers"];function pH(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r,n){var i,a,s,o,u;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=n.timeout,a=n.signal,s=n.headers,o=wU(n,dH),t.next=3,e.post("pin/remote/add",{timeout:i,signal:a,headers:s,searchParams:fH((0,_e.Z)({cid:r},o))});case 3:return u=t.sent,t.t0=uH,t.next=7,u.json();case 7:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 9:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e,r){return t.apply(this,arguments)}}var vH=["timeout","signal","headers"];function gH(e){function t(){return t=ea((function(t){var r=t.timeout,n=t.signal,i=t.headers,a=wU(t,vH);return(0,ii.Z)().mark((function t(){var s,o,u,c,l,h,f;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ji(e.post("pin/remote/ls",{timeout:r,signal:n,headers:i,searchParams:hH(a)}));case 2:s=t.sent,o=!1,u=!1,t.prev=5,l=ui(s.ndjson());case 7:return t.next=9,Ji(l.next());case 9:if(!(o=!(h=t.sent).done)){t.next=16;break}return f=h.value,t.next=13,uH(f);case 13:o=!1,t.next=7;break;case 16:t.next=22;break;case 18:t.prev=18,t.t0=t.catch(5),u=!0,c=t.t0;case 22:if(t.prev=22,t.prev=23,!o||null==l.return){t.next=27;break}return t.next=27,Ji(l.return());case 27:if(t.prev=27,!u){t.next=30;break}throw c;case 30:return t.finish(27);case 31:return t.finish(22);case 32:case"end":return t.stop()}}),t,null,[[5,18,22,32],[23,,27,31]])}))()})),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}}var yH=["timeout","signal","headers"];function mH(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a,s;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.timeout,i=r.signal,a=r.headers,s=wU(r,yH),t.next=3,e.post("pin/remote/rm",{timeout:n,signal:i,headers:a,searchParams:hH((0,_e.Z)((0,_e.Z)({},s),{},{all:!1}))});case 3:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}}var bH=["timeout","signal","headers"];function _H(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a,s;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.timeout,i=r.signal,a=r.headers,s=wU(r,bH),t.next=3,e.post("pin/remote/rm",{timeout:n,signal:i,headers:a,searchParams:hH((0,_e.Z)((0,_e.Z)({},s),{},{all:!0}))});case 3:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}}function wH(e){var t=String(e);if("undefined"===t)throw Error("endpoint is required");return"/"===t[t.length-1]?t.slice(0,-1):t}function kH(e){return(0,_e.Z)({service:e.Service,endpoint:new URL(e.ApiEndpoint)},e.Stat&&{stat:xH(e.Stat)})}function xH(e){switch(e.Status){case"valid":var t=e.PinCount,r=t.Pinning,n=t.Pinned;return{status:"valid",pinCount:{queued:t.Queued,pinning:r,pinned:n,failed:t.Failed}};case"invalid":return{status:"invalid"};default:return{status:e.Status}}}function EH(e){function t(){return(t=(0,ai.Z)((0,ii.Z)().mark((function t(r,n){var i,a,s,o,u;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=n.endpoint,a=n.key,s=n.headers,o=n.timeout,u=n.signal,t.next=3,e.post("pin/remote/service/add",{timeout:o,signal:u,searchParams:SU({arg:[r,wH(i),a]}),headers:s});case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return function(e,r){return t.apply(this,arguments)}}function SH(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i,a,s,o,u,c,l=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(r=l.length>0&&void 0!==l[0]?l[0]:{}).stat,i=r.headers,a=r.timeout,s=r.signal,t.next=4,e.post("pin/remote/service/ls",{timeout:a,signal:s,headers:i,searchParams:!0===n?SU({stat:n}):void 0});case 4:return o=t.sent,t.next=7,o.json();case 7:return u=t.sent,c=u.RemoteServices,t.abrupt("return",c.map(kH));case 10:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}}function CH(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},t.next=3,e.post("pin/remote/service/rm",{signal:n.signal,headers:n.headers,searchParams:SU({arg:r})});case 3:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}}function AH(e){var t=new bU(e);return{add:EH(t),ls:SH(t),rm:CH(t)}}function DH(e){var t=new bU(e);return{add:pH(t),ls:gH(t),rm:mH(t),rmAll:_H(t),service:AH(e)}}function RH(e){return{addAll:rH(e),add:nH(e),ls:aH(e),rmAll:sH(e),rm:oH(e),remote:DH(e)}}var TH=function(e){return Ws(ZH(e))},ZH=function(e){return oB.decode(e)},IH=function(e){return BigInt("0x".concat(Ws(oB.decode(e),"base16")))},PH=function(e){return oB.encode(Hs(e))},LH=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i,a=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.length>0&&void 0!==a[0]?a[0]:{},t.next=3,e.post("pubsub/ls",{signal:r.signal,searchParams:SU(r),headers:r.headers});case 3:return t.next=5,t.sent.json();case 5:return n=t.sent,i=n.Strings,t.abrupt("return",(s=i,(Array.isArray(s)?s.map(TH):s)||[]));case 8:case"end":return t.stop()}var s}),t)}))),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}})),MH=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a,s,o=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},t.next=3,e.post("pubsub/peers",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:PH(r)},n)),headers:n.headers});case 3:return i=t.sent,t.next=6,i.json();case 6:return a=t.sent,s=a.Strings,t.abrupt("return",s||[]);case 9:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),BH=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r,n){var i,a,s,o,u,c=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=c.length>2&&void 0!==c[2]?c[2]:{},a=SU((0,_e.Z)({arg:PH(r)},i)),s=new AbortController,o=yz(s.signal,i.signal),t.t0=e,t.t1=_e.Z,t.t2={signal:o,searchParams:a},t.next=9,pz([n],s,i.headers);case 9:return t.t3=t.sent,t.t4=(0,t.t1)(t.t2,t.t3),t.next=13,t.t0.post.call(t.t0,"pubsub/pub",t.t4);case 13:return u=t.sent,t.next=16,u.text();case 16:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e,r){return t.apply(this,arguments)}})),OH=BO("js-kubo-rpc-client:pubsub:subscribe"),NH=function(e,t){return _U((function(e){function r(){return r=(0,ai.Z)((0,ii.Z)().mark((function r(n,i){var a,s,o,u,c,l=arguments;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return(a=l.length>2&&void 0!==l[2]?l[2]:{}).signal=t.subscribe(n,i,a.signal),u=new Promise((function(e,t){s=e,o=t})),c=setTimeout((function(){return s()}),1e3),e.post("pubsub/sub",{signal:a.signal,searchParams:SU((0,_e.Z)({arg:PH(n)},a)),headers:a.headers}).catch((function(e){t.unsubscribe(n,i),o(e)})).then((function(e){clearTimeout(c),e&&(FH(e,{onMessage:function(e){i&&("function"!==typeof i?"function"===typeof i.handleEvent&&i.handleEvent(e):i(e))},onEnd:function(){return t.unsubscribe(n,i)},onError:a.onError}),s())})),r.abrupt("return",u);case 6:case"end":return r.stop()}}),r)}))),r.apply(this,arguments)}return function(e,t){return r.apply(this,arguments)}}))(e)};function FH(e,t){return UH.apply(this,arguments)}function UH(){return UH=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c,l,h,f,d;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=r.onMessage,i=r.onEnd,a=(a=r.onError)||OH,e.prev=2,s=!1,o=!1,e.prev=5,c=ui(t.ndjson());case 7:return e.next=9,c.next();case 9:if(!(s=!(l=e.sent).done)){e.next=24;break}if(h=l.value,e.prev=11,h.from){e.next=14;break}return e.abrupt("continue",21);case 14:null!=h.from&&null!=h.seqno?n({type:"signed",from:UU(h.from),data:ZH(h.data),sequenceNumber:IH(h.seqno),topic:TH(h.topicIDs[0]),key:ZH(null!==(f=h.key)&&void 0!==f?f:"u"),signature:ZH(null!==(d=h.signature)&&void 0!==d?d:"u")}):n({type:"unsigned",data:ZH(h.data),topic:TH(h.topicIDs[0])}),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(11),e.t0.message="Failed to parse pubsub message: ".concat(e.t0.message),a(e.t0,!1,h);case 21:s=!1,e.next=7;break;case 24:e.next=30;break;case 26:e.prev=26,e.t1=e.catch(5),o=!0,u=e.t1;case 30:if(e.prev=30,e.prev=31,!s||null==c.return){e.next=35;break}return e.next=35,c.return();case 35:if(e.prev=35,!o){e.next=38;break}throw u;case 38:return e.finish(35);case 39:return e.finish(30);case 40:e.next=45;break;case 42:e.prev=42,e.t2=e.catch(2),zH(e.t2)||a(e.t2,!0);case 45:return e.prev=45,i(),e.finish(45);case 48:case"end":return e.stop()}}),e,null,[[2,42,45,48],[5,26,30,40],[11,17],[31,,35,39]])}))),UH.apply(this,arguments)}var zH=function(e){switch(e.type){case"aborted":case"abort":return!0;default:return"AbortError"===e.name}},jH=function(e,t){function r(){return(r=(0,ai.Z)((0,ii.Z)().mark((function e(r,n){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.unsubscribe(r,n);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return function(e,t){return r.apply(this,arguments)}},HH=function(){function e(){(0,hi.Z)(this,e),this._subs=new Map}return(0,fi.Z)(e,[{key:"subscribe",value:function(e,t,r){var n=this,i=this._subs.get(e)||[];if(i.find((function(e){return e.handler===t})))throw new Error("Already subscribed to ".concat(e," with this handler"));var a=new AbortController;return this._subs.set(e,[{handler:t,controller:a}].concat(i)),r&&r.addEventListener("abort",(function(){return n.unsubscribe(e,t)})),a.signal}},{key:"unsubscribe",value:function(e,t){var r,n=this._subs.get(e)||[];t?(this._subs.set(e,n.filter((function(e){return e.handler!==t}))),r=n.filter((function(e){return e.handler===t}))):(this._subs.set(e,[]),r=n),(this._subs.get(e)||[]).length||this._subs.delete(e),r.forEach((function(e){return e.controller.abort()}))}}]),e}();function WH(e){var t=new HH;return{ls:LH(e),peers:MH(e),publish:BH(e),subscribe:NH(e,t),unsubscribe:jH(e,t)}}var qH=_U((function(e){function t(){return t=ea((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,ii.Z)().mark((function r(){var n;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Ji(e.post("refs/local",{signal:t.signal,transform:oj,searchParams:SU(t),headers:t.headers}));case 2:return n=r.sent,r.delegateYield(Xa(ui(n.ndjson())),"t0",4);case 4:case"end":return r.stop()}}),r)}))()})),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}})),VH=_U((function(e,t){var r=function(){var t=ea((function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,ii.Z)().mark((function n(){var i,a;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=Array.isArray(t)?t:[t],n.next=3,Ji(e.post("refs",{signal:r.signal,searchParams:SU((0,_e.Z)({arg:i.map((function(e){return"".concat(e instanceof Uint8Array?ZB.decode(e):e)}))},r)),headers:r.headers,transform:oj}));case 3:return a=n.sent,n.delegateYield(Xa(ui(a.ndjson())),"t0",5);case 5:case"end":return n.stop()}}),n)}))()}));return function(e){return t.apply(this,arguments)}}();return Object.assign(r,{local:qH(t)})})),KH=_U((function(e){function t(){return t=ea((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,ii.Z)().mark((function r(){var n;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Ji(e.post("repo/gc",{signal:t.signal,searchParams:SU(t),headers:t.headers,transform:function(e){return{err:e.Error?new Error(e.Error):null,cid:(e.Key||{})["/"]?ZB.parse(e.Key["/"]):null}}}));case 2:return n=r.sent,r.delegateYield(Xa(ui(n.ndjson())),"t0",4);case 4:case"end":return r.stop()}}),r)}))()})),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}})),YH=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i,a=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.length>0&&void 0!==a[0]?a[0]:{},t.next=3,e.post("repo/stat",{signal:r.signal,searchParams:SU(r),headers:r.headers});case 3:return n=t.sent,t.next=6,n.json();case 6:return i=t.sent,t.abrupt("return",{numObjects:BigInt(i.NumObjects),repoSize:BigInt(i.RepoSize),repoPath:i.RepoPath,version:i.Version,storageMax:BigInt(i.StorageMax)});case 8:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}})),GH=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>0&&void 0!==i[0]?i[0]:{},t.next=3,e.post("repo/version",{signal:r.signal,searchParams:SU(r),headers:r.headers});case 3:return t.next=5,t.sent.json();case 5:return n=t.sent,t.abrupt("return",n.Version);case 7:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}}));function QH(e){return{gc:KH(e),stat:YH(e),version:GH(e)}}var XH=_U((function(e){function t(){return t=ea((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,ii.Z)().mark((function r(){var n;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Ji(e.post("stats/bw",{signal:t.signal,searchParams:SU(t),headers:t.headers,transform:function(e){return{totalIn:BigInt(e.TotalIn),totalOut:BigInt(e.TotalOut),rateIn:parseFloat(e.RateIn),rateOut:parseFloat(e.RateOut)}}}));case 2:return n=r.sent,r.delegateYield(Xa(ui(n.ndjson())),"t0",4);case 4:case"end":return r.stop()}}),r)}))()})),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}}));function JH(e){return{bitswap:zU(e),repo:YH(e),bw:XH(e)}}var $H=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i,a,s=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=s.length>0&&void 0!==s[0]?s[0]:{},t.next=3,e.post("swarm/addrs",{signal:r.signal,searchParams:SU(r),headers:r.headers});case 3:return n=t.sent,t.next=6,n.json();case 6:return i=t.sent,a=i.Addrs,t.abrupt("return",Object.keys(a).map((function(e){return{id:UU(e),addrs:(a[e]||[]).map((function(e){return TO(e)}))}})));case 9:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}})),eW=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a,s,o=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},t.next=3,e.post("swarm/connect",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:r},n)),headers:n.headers});case 3:return i=t.sent,t.next=6,i.json();case 6:return a=t.sent,s=a.Strings,t.abrupt("return",s||[]);case 9:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),tW=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a,s,o=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},t.next=3,e.post("swarm/disconnect",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:r},n)),headers:n.headers});case 3:return i=t.sent,t.next=6,i.json();case 6:return a=t.sent,s=a.Strings,t.abrupt("return",s||[]);case 9:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),rW=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i,a,s=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=s.length>0&&void 0!==s[0]?s[0]:{},t.next=3,e.post("swarm/addrs/local",{signal:r.signal,searchParams:SU(r),headers:r.headers});case 3:return n=t.sent,t.next=6,n.json();case 6:return i=t.sent,a=i.Strings,t.abrupt("return",(a||[]).map((function(e){return TO(e)})));case 9:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}})),nW=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i,a,s=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=s.length>0&&void 0!==s[0]?s[0]:{},t.next=3,e.post("swarm/peers",{signal:r.signal,searchParams:SU(r),headers:r.headers});case 3:return n=t.sent,t.next=6,n.json();case 6:return i=t.sent,a=i.Peers,t.abrupt("return",(a||[]).map((function(e){return{addr:TO(e.Addr),peer:UU(e.Peer),muxer:e.Muxer,latency:e.Latency,streams:e.Streams,direction:null==e.Direction?void 0:0===e.Direction?"inbound":"outbound"}})));case 9:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}}));function iW(e){return{addrs:$H(e),connect:eW(e),disconnect:tW(e),localAddrs:rW(e),peers:nW(e)}}var aW=_U((function(e){function t(){return t=ea((function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l,h,f,d,p,v,g,y,m,b,_,w;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=new AbortController,a=yz(i.signal,r.signal),n.next=4,Ji(pz(t,i,r.headers));case 4:return s=n.sent,o=s.headers,u=s.body,c=s.total,l=s.parts,h="function"===typeof r.progress?sW(c,l,r.progress):[void 0,void 0],f=(0,ke.Z)(h,2),d=f[0],p=f[1],n.next=12,Ji(e.post("add",{searchParams:SU((0,_e.Z)((0,_e.Z)({"stream-channels":!0},r),{},{progress:Boolean(d)})),onUploadProgress:p,signal:a,headers:o,body:u}));case 12:v=n.sent,g=!1,y=!1,n.prev=15,b=ui(v.ndjson());case 17:return n.next=19,Ji(b.next());case 19:if(!(g=!(_=n.sent).done)){n.next=31;break}if(void 0===(w=oj(w=_.value)).hash){n.next=27;break}return n.next=25,uW(w);case 25:n.next=28;break;case 27:d&&d(w.bytes||0,w.name);case 28:g=!1,n.next=17;break;case 31:n.next=37;break;case 33:n.prev=33,n.t0=n.catch(15),y=!0,m=n.t0;case 37:if(n.prev=37,n.prev=38,!g||null==b.return){n.next=42;break}return n.next=42,Ji(b.return());case 42:if(n.prev=42,!y){n.next=45;break}throw m;case 45:return n.finish(42);case 46:return n.finish(37);case 47:case"end":return n.stop()}}),n,null,[[15,33,37,47],[38,,42,46]])}))()})),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),sW=function(e,t,r){return t?[void 0,oW(e,t,r)]:[r,void 0]},oW=function(e,t,r){var n=0,i=t.length;return function(a){for(var s=a.loaded,o=a.total,u=Math.floor(s/o*e);n<i;){var c=t[n],l=c.start,h=c.end,f=c.name;if(u<h){r(u-l,f);break}r(h-l,f),n+=1}}};function uW(e){var t=e.name,r=e.hash,n=e.size,i=e.mode,a=e.mtime,s=e.mtimeNsecs,o={path:t,cid:ZB.parse(r),size:parseInt(n)};return null!=i&&(o.mode=parseInt(i,8)),null!=a&&(o.mtime={secs:a,nsecs:s||0}),o}function cW(e){return lW.apply(this,arguments)}function lW(){return(lW=ea((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function hW(e){return fW.apply(this,arguments)}function fW(){return fW=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!KU(t)){e.next=2;break}return e.abrupt("return",cW(dW(t)));case 2:if(!("string"===typeof t||t instanceof String)){e.next=4;break}return e.abrupt("return",cW(dW(t.toString())));case 4:if(!YU(t)){e.next=6;break}return e.abrupt("return","function"===typeof(a=t).stream?aA(a.stream()):aA(new Response(a).body));case 6:if(QU(t)&&(t=aA(t)),!(Symbol.iterator in t)&&!(Symbol.asyncIterator in t)){e.next=27;break}return r=WU(t),e.next=11,r.peek();case 11:if(n=e.sent,i=n.value,!n.done){e.next=16;break}return e.abrupt("return",cW(new Uint8Array(0)));case 16:if(r.push(i),!Number.isInteger(i)){e.next=25;break}return e.t0=cW,e.t1=Uint8Array,e.next=22,qU(r);case 22:return e.t2=e.sent,e.t3=e.t1.from.call(e.t1,e.t2),e.abrupt("return",(0,e.t0)(e.t3));case 25:if(!(KU(i)||"string"===typeof i||i instanceof String)){e.next=27;break}return e.abrupt("return",tz(r,dW));case 27:throw ji(new Error("Unexpected input: ".concat(t)),"ERR_UNEXPECTED_INPUT");case 28:case"end":return e.stop()}var a}),e)}))),fW.apply(this,arguments)}function dW(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Array.isArray(e)?Uint8Array.from(e):Hs(e.toString())}function pW(){return pW=ea((0,ii.Z)().mark((function e(t,r){var n,i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t&&void 0!==t){e.next=2;break}throw ji(new Error("Unexpected input: ".concat(t)),"ERR_UNEXPECTED_INPUT");case 2:if(!("string"===typeof t||t instanceof String)){e.next=6;break}return e.next=5,vW(t.toString(),r);case 5:case 9:case 21:case 26:case 31:return e.abrupt("return");case 6:if(!KU(t)&&!YU(t)){e.next=10;break}return e.next=9,vW(t,r);case 10:if(QU(t)&&(t=aA(t)),!(Symbol.iterator in t)&&!(Symbol.asyncIterator in t)){e.next=28;break}return n=WU(t),e.next=15,Ji(n.peek());case 15:if(i=e.sent,a=i.value,!i.done){e.next=22;break}return e.next=21,{content:[]};case 22:if(n.push(a),!(Number.isInteger(a)||KU(a)||"string"===typeof a||a instanceof String)){e.next=27;break}return e.next=26,vW(n,r);case 27:throw ji(new Error("Unexpected input: multiple items passed - if you are using ipfs.add, please use ipfs.addAll instead"),"ERR_UNEXPECTED_INPUT");case 28:if(!GU(t)){e.next=32;break}return e.next=31,vW(t,r);case 32:throw ji(new Error('Unexpected input: cannot convert "'+typeof t+'" into ImportCandidate'),"ERR_UNEXPECTED_INPUT");case 33:case"end":return e.stop()}}),e)}))),pW.apply(this,arguments)}function vW(e,t){return gW.apply(this,arguments)}function gW(){return gW=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.path,i=t.mode,a=t.mtime,s=t.content,o={path:n||"",mode:oz(i),mtime:uz(a)},!s){e.next=8;break}return e.next=5,r(s);case 5:o.content=e.sent,e.next=12;break;case 8:if(n){e.next=12;break}return e.next=11,r(t);case 11:o.content=e.sent;case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}}),e)}))),gW.apply(this,arguments)}function yW(e){return function(e,t){return pW.apply(this,arguments)}(e,hW)}function mW(e){var t=aW(e);return _U((function(){function e(){return e=(0,ai.Z)((0,ii.Z)().mark((function e(r){var n,i,a,s=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},i=yW(r),a=t(i,n),e.next=5,Uz(a);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))),e.apply(this,arguments)}return function(t){return e.apply(this,arguments)}}))(e)}var bW=_U((function(e){function t(){return t=ea((function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,ii.Z)().mark((function n(){var i;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Ji(e.post("cat",{signal:r.signal,searchParams:SU((0,_e.Z)({arg:t.toString()},r)),headers:r.headers}));case 2:return i=n.sent,n.delegateYield(Xa(ui(i.iterator())),"t0",4);case 4:case"end":return n.stop()}}),n)}))()})),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),_W=_U((function(e){var t=function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>0&&void 0!==i[0]?i[0]:{},t.next=3,e.post("commands",{signal:r.signal,searchParams:SU(r),headers:r.headers});case 3:return n=t.sent,t.abrupt("return",n.json());case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return t})),wW=_U((function(e){var t=function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a,s=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},t.next=3,e.post("dns",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:r},n)),headers:n.headers});case 3:return i=t.sent,t.next=6,i.json();case 6:return a=t.sent,t.abrupt("return",a.Path);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return t})),kW=_U((function(e){return function(){var t=new URL(e.opts.base||"");return{host:t.hostname,port:t.port,protocol:t.protocol,pathname:t.pathname,"api-path":t.pathname}}})),xW=_U((function(e){function t(){return t=ea((function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,ii.Z)().mark((function n(){var i,a;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(i=(0,_e.Z)({arg:"".concat(t instanceof Uint8Array?ZB.decode(t):t)},r)).compressionLevel&&(i["compression-level"]=i.compressionLevel,delete i.compressionLevel),n.next=4,Ji(e.post("get",{signal:r.signal,searchParams:SU(i),headers:r.headers}));case 4:return a=n.sent,n.delegateYield(Xa(ui(a.iterator())),"t0",6);case 6:case"end":return n.stop()}}),n)}))()})),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),EW=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i,a,s=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=s.length>0&&void 0!==s[0]?s[0]:{},t.next=3,e.post("id",{signal:r.signal,searchParams:SU((0,_e.Z)({arg:r.peerId?r.peerId.toString():void 0},r)),headers:r.headers});case 3:return n=t.sent,t.next=6,n.json();case 6:return i=t.sent,(a=(0,_e.Z)({},oj(i))).id=UU(a.id),a.addresses&&(a.addresses=a.addresses.map((function(e){return TO(e)}))),t.abrupt("return",a);case 11:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}})),SW=function(e){var t=EW(e);function r(){return r=(0,ai.Z)((0,ii.Z)().mark((function e(){var r,n,i=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>0&&void 0!==i[0]?i[0]:{},e.next=3,t(r);case 3:return n=e.sent,e.abrupt("return",Boolean(n&&n.addresses&&n.addresses.length));case 5:case"end":return e.stop()}}),e)}))),r.apply(this,arguments)}return function(){return r.apply(this,arguments)}},CW=_U((function(e,t){function r(){return r=ea((function(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,ii.Z)().mark((function i(){var a,s,o,u,c,l,h,f,d,p,v;return(0,ii.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o=function(){return o=(0,ai.Z)((0,ii.Z)().mark((function e(r){var n,i,s,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=r.Hash).includes("/")){e.next=9;break}return i=n.startsWith("/ipfs/")?n:"/ipfs/".concat(n),e.next=5,gj(t)(i);case 5:s=e.sent,n=s.cid,e.next=10;break;case 9:n=ZB.parse(n);case 10:return o={name:r.Name,path:a+(r.Name?"/".concat(r.Name):""),size:r.Size,cid:n,type:AW(r)},r.Mode&&(o.mode=parseInt(r.Mode,8)),void 0!==r.Mtime&&null!==r.Mtime&&(o.mtime={secs:r.Mtime},void 0!==r.MtimeNsecs&&null!==r.MtimeNsecs&&(o.mtime.nsecs=r.MtimeNsecs)),e.abrupt("return",o);case 14:case"end":return e.stop()}}),e)}))),o.apply(this,arguments)},s=function(e){return o.apply(this,arguments)},a="".concat(r instanceof Uint8Array?ZB.decode(r):r),i.next=5,Ji(e.post("ls",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:a},n)),headers:n.headers}));case 5:u=i.sent,c=!1,l=!1,i.prev=8,f=ui(u.ndjson());case 10:return i.next=12,Ji(f.next());case 12:if(!(c=!(d=i.sent).done)){i.next=31;break}if(p=(p=d.value).Objects){i.next=17;break}throw new Error("expected .Objects in results");case 17:if(p=p[0]){i.next=20;break}throw new Error("expected one array in results.Objects");case 20:if(v=p.Links,Array.isArray(v)){i.next=23;break}throw new Error("expected one array in results.Objects[0].Links");case 23:if(v.length){i.next=27;break}return i.next=26,s(p);case 26:return i.abrupt("return");case 27:return i.delegateYield(Xa(ui(v.map(s))),"t0",28);case 28:c=!1,i.next=10;break;case 31:i.next=37;break;case 33:i.prev=33,i.t1=i.catch(8),l=!0,h=i.t1;case 37:if(i.prev=37,i.prev=38,!c||null==f.return){i.next=42;break}return i.next=42,Ji(f.return());case 42:if(i.prev=42,!l){i.next=45;break}throw h;case 45:return i.finish(42);case 46:return i.finish(37);case 47:case"end":return i.stop()}}),i,null,[[8,33,37,47],[38,,42,46]])}))()})),r.apply(this,arguments)}return function(e){return r.apply(this,arguments)}}));function AW(e){switch(e.Type){case 1:case 5:return"dir";default:return"file"}}var DW=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>0&&void 0!==i[0]?i[0]:{},t.next=3,e.post("dns",{signal:r.signal,searchParams:SU(r),headers:r.headers});case 3:return n=t.sent,t.t0=oj,t.next=7,n.json();case 7:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 9:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}})),RW=_U((function(e){function t(){return t=ea((function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,ii.Z)().mark((function n(){var i;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Ji(e.post("ping",{signal:r.signal,searchParams:SU((0,_e.Z)({arg:"".concat(t)},r)),headers:r.headers,transform:oj}));case 2:return i=n.sent,n.delegateYield(Xa(ui(i.ndjson())),"t0",4);case 4:case"end":return n.stop()}}),n)}))()})),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),TW=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a,s,o=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},t.next=3,e.post("resolve",{signal:n.signal,searchParams:SU((0,_e.Z)({arg:r},n)),headers:n.headers});case 3:return i=t.sent,t.next=6,i.json();case 6:return a=t.sent,s=a.Path,t.abrupt("return",s);case 9:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(e){return t.apply(this,arguments)}})),ZW=_U((function(e){var t=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw t.length>0&&void 0!==t[0]?t[0]:{},ji(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED");case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return t})),IW=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>0&&void 0!==i[0]?i[0]:{},t.next=3,e.post("shutdown",{signal:r.signal,searchParams:SU(r),headers:r.headers});case 3:return n=t.sent,t.next=6,n.text();case 6:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}})),PW=_U((function(e){function t(){return t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i=arguments;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.length>0&&void 0!==i[0]?i[0]:{},t.next=3,e.post("version",{signal:r.signal,searchParams:SU(r),headers:r.headers});case 3:return n=t.sent,t.t0=_e.Z,t.t1=_e.Z,t.t2={},t.t3=oj,t.next=10,n.json();case 10:return t.t4=t.sent,t.t5=(0,t.t3)(t.t4),t.t6=(0,t.t1)(t.t2,t.t5),t.t7={},t.t8={"ipfs-http-client":"1.0.0"},t.abrupt("return",(0,t.t0)(t.t6,t.t7,t.t8));case 16:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}}));__webpack_require__(5104),__webpack_require__(5014);function LW(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={name:RM.name,code:RM.code,encode:function(e){return e},decode:function(e){return e}},r=Object.values(FB);(e.ipld&&e.ipld.bases?e.ipld.bases:[]).forEach((function(e){return r.push(e)}));var n=new VP({bases:r,loadBase:e.ipld&&e.ipld.loadBase}),i=Object.values(zB);[m,g,y,x,t].concat(e.ipld&&e.ipld.codecs||[]).forEach((function(e){return i.push(e)}));var a=new YP({codecs:i,loadCodec:e.ipld&&e.ipld.loadCodec}),s=Object.values(UB);(e.ipld&&e.ipld.hashers?e.ipld.hashers:[]).forEach((function(e){return s.push(e)}));var o,u=new QP({hashers:s,loadHasher:e.ipld&&e.ipld.loadHasher});return{add:mW(e),addAll:aW(e),bitswap:(o=e,{wantlist:CU(o),wantlistForPeer:AU(o),stat:zU(o)}),block:kz(e),bootstrap:Cz(e),cat:bW(e),commands:_W(e),config:Lz(e),dag:Vz(a,e),dht:ej(e),diag:ij(e),dns:wW(e),files:bj(e),get:xW(e),getEndpointConfig:kW(e),id:EW(e),isOnline:SW(e),key:Aj(e),log:Zj(e),ls:CW(e),mount:DW(e),name:Nj(e),object:Qj(a,e),pin:RH(e),ping:RW(e),pubsub:WH(e),refs:VH(e),repo:QH(e),resolve:TW(e),start:ZW(e),stats:JH(e),stop:IW(e),swarm:iW(e),version:PW(e),bases:n,codecs:a,hashers:u}}var MW=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var a=e.charAt(i),s=a.charCodeAt(0);if(255!==r[s])throw new TypeError(a+" is ambiguous");r[s]=i}var o=e.length,u=e.charAt(0),c=Math.log(o)/Math.log(256),l=Math.log(256)/Math.log(o);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===u;)n++,t++;for(var a=(e.length-t)*c+1>>>0,s=new Uint8Array(a);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var h=0,f=a-1;(0!==l||h<i)&&-1!==f;f--,h++)l+=o*s[f]>>>0,s[f]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var d=a-i;d!==a&&0===s[d];)d++;for(var p=new Uint8Array(n+(a-d)),v=n;d!==a;)p[v++]=s[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,a=t.length;i!==a&&0===t[i];)i++,r++;for(var s=(a-i)*l+1>>>0,c=new Uint8Array(s);i!==a;){for(var h=t[i],f=0,d=s-1;(0!==h||f<n)&&-1!==d;d--,f++)h+=256*c[d]>>>0,c[d]=h%o>>>0,h=h/o>>>0;if(0!==h)throw new Error("Non-zero carry");n=f,i++}for(var p=s-n;p!==s&&0===c[p];)p++;for(var v=u.repeat(r);p<s;++p)v+=e.charAt(c[p]);return v},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error("Non-".concat(t," character"))}}},BW=MW,OW=(new Uint8Array(0),function(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}),NW=function(){function e(t,r,n){(0,hi.Z)(this,e),this.name=t,this.prefix=r,this.baseEncode=n}return(0,fi.Z)(e,[{key:"encode",value:function(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}]),e}(),FW=function(){function e(t,r,n){if((0,hi.Z)(this,e),this.name=t,this.prefix=r,void 0===r.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}return(0,fi.Z)(e,[{key:"decode",value:function(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}},{key:"or",value:function(e){return zW(this,e)}}]),e}(),UW=function(){function e(t){(0,hi.Z)(this,e),this.decoders=t}return(0,fi.Z)(e,[{key:"or",value:function(e){return zW(this,e)}},{key:"decode",value:function(e){var t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}]),e}(),zW=function(e,t){return new UW((0,_e.Z)((0,_e.Z)({},e.decoders||(0,we.Z)({},e.prefix,e)),t.decoders||(0,we.Z)({},t.prefix,t)))},jW=function(){function e(t,r,n,i){(0,hi.Z)(this,e),this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new NW(t,r,n),this.decoder=new FW(t,r,i)}return(0,fi.Z)(e,[{key:"encode",value:function(e){return this.encoder.encode(e)}},{key:"decode",value:function(e){return this.decoder.decode(e)}}]),e}(),HW=function(e){var t=e.name,r=e.prefix,n=e.encode,i=e.decode;return new jW(t,r,n,i)},WW=function(e){var t=e.prefix,r=e.name,n=e.alphabet,i=BW(n,r),a=i.encode,s=i.decode;return HW({prefix:t,name:r,encode:a,decode:function(e){return OW(s(e))}})},qW=function(e){var t=e.name,r=e.prefix,n=e.bitsPerChar,i=e.alphabet;return HW({prefix:r,name:t,encode:function(e){return function(e,t,r){for(var n="="===t[t.length-1],i=(1<<r)-1,a="",s=0,o=0,u=0;u<e.length;++u)for(o=o<<8|e[u],s+=8;s>r;)a+=t[i&o>>(s-=r)];if(s&&(a+=t[i&o<<r-s]),n)for(;a.length*r&7;)a+="=";return a}(e,i,n)},decode:function(e){return function(e,t,r,n){for(var i={},a=0;a<t.length;++a)i[t[a]]=a;for(var s=e.length;"="===e[s-1];)--s;for(var o=new Uint8Array(s*r/8|0),u=0,c=0,l=0,h=0;h<s;++h){var f=i[e[h]];if(void 0===f)throw new SyntaxError("Non-".concat(n," character"));c=c<<r|f,(u+=r)>=8&&(u-=8,o[l++]=255&c>>u)}if(u>=r||255&c<<8-u)throw new SyntaxError("Unexpected end of data");return o}(e,i,n,t)}})},VW=WW({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),KW=WW({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),YW=qW({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),GW=qW({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),QW=qW({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),XW=qW({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),JW=qW({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),$W=qW({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),eq=qW({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),tq=qW({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),rq=qW({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),nq=qW({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),iq=qW({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),aq=qW({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),sq=qW({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function oq(e){var t=function(e){var t=function(){};return t.enabled=!1,t.color="",t.diff=0,t.log=function(){},t.namespace=e,t.destroy=function(){return!0},t.extend=function(){return t},t}("".concat(e,":trace"));return li.enabled("".concat(e,":trace"))&&null!=li.names.map((function(e){return e.toString()})).find((function(e){return e.includes(":trace")}))&&(t=li("".concat(e,":trace"))),Object.assign(li(e),{error:li("".concat(e,":error")),trace:t})}li.formatters.b=function(e){return null==e?"undefined":VW.baseEncode(e)},li.formatters.t=function(e){return null==e?"undefined":YW.baseEncode(e)},li.formatters.m=function(e){return null==e?"undefined":nq.baseEncode(e)},li.formatters.p=function(e){return null==e?"undefined":e.toString()},li.formatters.c=function(e){return null==e?"undefined":e.toString()},li.formatters.k=function(e){return null==e?"undefined":e.toString()},li.formatters.a=function(e){return null==e?"undefined":e.toString()};var uq=Object.create(null);uq.open="0",uq.close="1",uq.ping="2",uq.pong="3",uq.message="4",uq.upgrade="5",uq.noop="6";var cq=Object.create(null);Object.keys(uq).forEach((function(e){cq[uq[e]]=e}));var lq,hq={type:"error",data:"parser error"},fq="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),dq="function"===typeof ArrayBuffer,pq=function(e){return"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer},vq=function(e,t,r){var n=e.type,i=e.data;return fq&&i instanceof Blob?t?r(i):gq(i,r):dq&&(i instanceof ArrayBuffer||pq(i))?t?r(i):gq(new Blob([i]),r):r(uq[n]+(i||""))},gq=function(e,t){var r=new FileReader;return r.onload=function(){var e=r.result.split(",")[1];t("b"+(e||""))},r.readAsDataURL(e)};function yq(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}for(var mq="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bq="undefined"===typeof Uint8Array?[]:new Uint8Array(256),_q=0;_q<64;_q++)bq[mq.charCodeAt(_q)]=_q;var wq,kq="function"===typeof ArrayBuffer,xq=function(e,t){if("string"!==typeof e)return{type:"message",data:Sq(e,t)};var r=e.charAt(0);return"b"===r?{type:"message",data:Eq(e.substring(1),t)}:cq[r]?e.length>1?{type:cq[r],data:e.substring(1)}:{type:cq[r]}:hq},Eq=function(e,t){if(kq){var r=function(e){var t,r,n,i,a,s=.75*e.length,o=e.length,u=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var c=new ArrayBuffer(s),l=new Uint8Array(c);for(t=0;t<o;t+=4)r=bq[e.charCodeAt(t)],n=bq[e.charCodeAt(t+1)],i=bq[e.charCodeAt(t+2)],a=bq[e.charCodeAt(t+3)],l[u++]=r<<2|n>>4,l[u++]=(15&n)<<4|i>>2,l[u++]=(3&i)<<6|63&a;return c}(e);return Sq(r,t)}return{base64:!0,data:e}},Sq=function(e,t){return"blob"===t?e instanceof Blob?e:new Blob([e]):e instanceof ArrayBuffer?e:e.buffer},Cq=String.fromCharCode(30);function Aq(){return new TransformStream({transform:function(e,t){!function(e,t){fq&&e.data instanceof Blob?e.data.arrayBuffer().then(yq).then(t):dq&&(e.data instanceof ArrayBuffer||pq(e.data))?t(yq(e.data)):vq(e,!1,(function(e){lq||(lq=new TextEncoder),t(lq.encode(e))}))}(e,(function(r){var n,i=r.length;if(i<126)n=new Uint8Array(1),new DataView(n.buffer).setUint8(0,i);else if(i<65536){n=new Uint8Array(3);var a=new DataView(n.buffer);a.setUint8(0,126),a.setUint16(1,i)}else{n=new Uint8Array(9);var s=new DataView(n.buffer);s.setUint8(0,127),s.setBigUint64(1,BigInt(i))}e.data&&"string"!==typeof e.data&&(n[0]|=128),t.enqueue(n),t.enqueue(r)}))}})}function Dq(e){return e.reduce((function(e,t){return e+t.length}),0)}function Rq(e,t){if(e[0].length===t)return e.shift();for(var r=new Uint8Array(t),n=0,i=0;i<t;i++)r[i]=e[0][n++],n===e[0].length&&(e.shift(),n=0);return e.length&&n<e[0].length&&(e[0]=e[0].slice(n)),r}function Tq(e){if(e)return function(e){for(var t in Tq.prototype)e[t]=Tq.prototype[t];return e}(e)}Tq.prototype.on=Tq.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},Tq.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},Tq.prototype.off=Tq.prototype.removeListener=Tq.prototype.removeAllListeners=Tq.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<n.length;i++)if((r=n[i])===t||r.fn===t){n.splice(i,1);break}return 0===n.length&&delete this._callbacks["$"+e],this},Tq.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){n=0;for(var i=(r=r.slice(0)).length;n<i;++n)r[n].apply(this,t)}return this},Tq.prototype.emitReserved=Tq.prototype.emit,Tq.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},Tq.prototype.hasListeners=function(e){return!!this.listeners(e).length};var Zq="undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")();function Iq(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return r.reduce((function(t,r){return e.hasOwnProperty(r)&&(t[r]=e[r]),t}),{})}var Pq=Zq.setTimeout,Lq=Zq.clearTimeout;function Mq(e,t){t.useNativeTimers?(e.setTimeoutFn=Pq.bind(Zq),e.clearTimeoutFn=Lq.bind(Zq)):(e.setTimeoutFn=Zq.setTimeout.bind(Zq),e.clearTimeoutFn=Zq.clearTimeout.bind(Zq))}var Bq,Oq=function(e){ia(r,e);var t=ua(r);function r(e,n,i){var a;return(0,hi.Z)(this,r),(a=t.call(this,e)).description=n,a.context=i,a.type="TransportError",a}return(0,fi.Z)(r)}(es(Error)),Nq=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),(n=t.call(this)).writable=!1,Mq(ra(n),e),n.opts=e,n.query=e.query,n.socket=e.socket,n}return(0,fi.Z)(r,[{key:"onError",value:function(e,t,n){return yo(aa(r.prototype),"emitReserved",this).call(this,"error",new Oq(e,t,n)),this}},{key:"open",value:function(){return this.readyState="opening",this.doOpen(),this}},{key:"close",value:function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}},{key:"send",value:function(e){"open"===this.readyState&&this.write(e)}},{key:"onOpen",value:function(){this.readyState="open",this.writable=!0,yo(aa(r.prototype),"emitReserved",this).call(this,"open")}},{key:"onData",value:function(e){var t=xq(e,this.socket.binaryType);this.onPacket(t)}},{key:"onPacket",value:function(e){yo(aa(r.prototype),"emitReserved",this).call(this,"packet",e)}},{key:"onClose",value:function(e){this.readyState="closed",yo(aa(r.prototype),"emitReserved",this).call(this,"close",e)}},{key:"pause",value:function(e){}},{key:"createUri",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}},{key:"_hostname",value:function(){var e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}},{key:"_port",value:function(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}},{key:"_query",value:function(e){var t=function(e){var t="";for(var r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}(e);return t.length?"?"+t:""}}]),r}(Tq),Fq="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),Uq=64,zq={},jq=0,Hq=0;function Wq(e){var t="";do{t=Fq[e%Uq]+t,e=Math.floor(e/Uq)}while(e>0);return t}function qq(){var e=Wq(+new Date);return e!==Bq?(jq=0,Bq=e):e+"."+Wq(jq++)}for(;Hq<Uq;Hq++)zq[Fq[Hq]]=Hq;var Vq=!1;try{Vq="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(S$){}var Kq=Vq;function Yq(e){var t=e.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!t||Kq))return new XMLHttpRequest}catch(r){}if(!t)try{return new(Zq[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(r){}}function Gq(){}var Qq=null!=new Yq({xdomain:!1}).responseType,Xq=function(e){ia(r,e);var t=ua(r);function r(e){var n;if((0,hi.Z)(this,r),(n=t.call(this,e)).polling=!1,"undefined"!==typeof location){var i="https:"===location.protocol,a=location.port;a||(a=i?"443":"80"),n.xd="undefined"!==typeof location&&e.hostname!==location.hostname||a!==e.port}var s=e&&e.forceBase64;return n.supportsBinary=Qq&&!s,n.opts.withCredentials&&(n.cookieJar=void 0),n}return(0,fi.Z)(r,[{key:"name",get:function(){return"polling"}},{key:"doOpen",value:function(){this.poll()}},{key:"pause",value:function(e){var t=this;this.readyState="pausing";var r=function(){t.readyState="paused",e()};if(this.polling||!this.writable){var n=0;this.polling&&(n++,this.once("pollComplete",(function(){--n||r()}))),this.writable||(n++,this.once("drain",(function(){--n||r()})))}else r()}},{key:"poll",value:function(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}},{key:"onData",value:function(e){var t=this;(function(e,t){for(var r=e.split(Cq),n=[],i=0;i<r.length;i++){var a=xq(r[i],t);if(n.push(a),"error"===a.type)break}return n})(e,this.socket.binaryType).forEach((function(e){if("opening"===t.readyState&&"open"===e.type&&t.onOpen(),"close"===e.type)return t.onClose({description:"transport closed by the server"}),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}},{key:"doClose",value:function(){var e=this,t=function(){e.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}},{key:"write",value:function(e){var t=this;this.writable=!1,function(e,t){var r=e.length,n=new Array(r),i=0;e.forEach((function(e,a){vq(e,!1,(function(e){n[a]=e,++i===r&&t(n.join(Cq))}))}))}(e,(function(e){t.doWrite(e,(function(){t.writable=!0,t.emitReserved("drain")}))}))}},{key:"uri",value:function(){var e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=qq()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}},{key:"request",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new Jq(this.uri(),e)}},{key:"doWrite",value:function(e,t){var r=this,n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",(function(e,t){r.onError("xhr post error",e,t)}))}},{key:"doPoll",value:function(){var e=this,t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(function(t,r){e.onError("xhr poll error",t,r)})),this.pollXhr=t}}]),r}(Nq),Jq=function(e){ia(r,e);var t=ua(r);function r(e,n){var i;return(0,hi.Z)(this,r),Mq(ra(i=t.call(this)),n),i.opts=n,i.method=n.method||"GET",i.uri=e,i.data=void 0!==n.data?n.data:null,i.create(),i}return(0,fi.Z)(r,[{key:"create",value:function(){var e,t=this,n=Iq(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this.opts.xd;var i=this.xhr=new Yq(n);try{i.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders)for(var a in i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0),this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(a)&&i.setRequestHeader(a,this.opts.extraHeaders[a])}catch(s){}if("POST"===this.method)try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(s){}try{i.setRequestHeader("Accept","*/*")}catch(s){}null===(e=this.opts.cookieJar)||void 0===e||e.addCookies(i),"withCredentials"in i&&(i.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(i.timeout=this.opts.requestTimeout),i.onreadystatechange=function(){var e;3===i.readyState&&(null===(e=t.opts.cookieJar)||void 0===e||e.parseCookies(i)),4===i.readyState&&(200===i.status||1223===i.status?t.onLoad():t.setTimeoutFn((function(){t.onError("number"===typeof i.status?i.status:0)}),0))},i.send(this.data)}catch(s){return void this.setTimeoutFn((function(){t.onError(s)}),0)}"undefined"!==typeof document&&(this.index=r.requestsCount++,r.requests[this.index]=this)}},{key:"onError",value:function(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}},{key:"cleanup",value:function(e){if("undefined"!==typeof this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=Gq,e)try{this.xhr.abort()}catch(t){}"undefined"!==typeof document&&delete r.requests[this.index],this.xhr=null}}},{key:"onLoad",value:function(){var e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}},{key:"abort",value:function(){this.cleanup()}}]),r}(Tq);if(Jq.requestsCount=0,Jq.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",$q);else if("function"===typeof addEventListener){addEventListener("onpagehide"in Zq?"pagehide":"unload",$q,!1)}function $q(){for(var e in Jq.requests)Jq.requests.hasOwnProperty(e)&&Jq.requests[e].abort()}var eV="function"===typeof Promise&&"function"===typeof Promise.resolve?function(e){return Promise.resolve().then(e)}:function(e,t){return t(e,0)},tV=Zq.WebSocket||Zq.MozWebSocket,rV=(__webpack_require__(9778).lW,"undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase()),nV=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),(n=t.call(this,e)).supportsBinary=!e.forceBase64,n}return(0,fi.Z)(r,[{key:"name",get:function(){return"websocket"}},{key:"doOpen",value:function(){if(this.check()){var e=this.uri(),t=this.opts.protocols,r=rV?{}:Iq(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=rV?new tV(e,t,r):t?new tV(e,t):new tV(e)}catch(S$){return this.emitReserved("error",S$)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}}},{key:"addEventListeners",value:function(){var e=this;this.ws.onopen=function(){e.opts.autoUnref&&e.ws._socket.unref(),e.onOpen()},this.ws.onclose=function(t){return e.onClose({description:"websocket connection closed",context:t})},this.ws.onmessage=function(t){return e.onData(t.data)},this.ws.onerror=function(t){return e.onError("websocket error",t)}}},{key:"write",value:function(e){var t=this;this.writable=!1;for(var r=function(){var r=e[n],i=n===e.length-1;vq(r,t.supportsBinary,(function(e){try{t.ws.send(e)}catch(r){}i&&eV((function(){t.writable=!0,t.emitReserved("drain")}),t.setTimeoutFn)}))},n=0;n<e.length;n++)r()}},{key:"doClose",value:function(){"undefined"!==typeof this.ws&&(this.ws.close(),this.ws=null)}},{key:"uri",value:function(){var e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=qq()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}},{key:"check",value:function(){return!!tV}}]),r}(Nq),iV=function(e){ia(r,e);var t=ua(r);function r(){return(0,hi.Z)(this,r),t.apply(this,arguments)}return(0,fi.Z)(r,[{key:"name",get:function(){return"webtransport"}},{key:"doOpen",value:function(){var e=this;"function"===typeof WebTransport&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then((function(){e.onClose()})).catch((function(t){e.onError("webtransport error",t)})),this.transport.ready.then((function(){e.transport.createBidirectionalStream().then((function(t){var r=function(e,t){wq||(wq=new TextDecoder);var r=[],n=0,i=-1,a=!1;return new TransformStream({transform:function(s,o){for(r.push(s);;){if(0===n){if(Dq(r)<1)break;var u=Rq(r,1);a=128===(128&u[0]),i=127&u[0],n=i<126?3:126===i?1:2}else if(1===n){if(Dq(r)<2)break;var c=Rq(r,2);i=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),n=3}else if(2===n){if(Dq(r)<8)break;var l=Rq(r,8),h=new DataView(l.buffer,l.byteOffset,l.length),f=h.getUint32(0);if(f>Math.pow(2,21)-1){o.enqueue(hq);break}i=f*Math.pow(2,32)+h.getUint32(4),n=3}else{if(Dq(r)<i)break;var d=Rq(r,i);o.enqueue(xq(a?d:wq.decode(d),t)),n=0}if(0===i||i>e){o.enqueue(hq);break}}}})}(Number.MAX_SAFE_INTEGER,e.socket.binaryType),n=t.readable.pipeThrough(r).getReader(),i=Aq();i.readable.pipeTo(t.writable),e.writer=i.writable.getWriter();!function t(){n.read().then((function(r){var n=r.done,i=r.value;n||(e.onPacket(i),t())})).catch((function(e){}))}();var a={type:"open"};e.query.sid&&(a.data='{"sid":"'.concat(e.query.sid,'"}')),e.writer.write(a).then((function(){return e.onOpen()}))}))})))}},{key:"write",value:function(e){var t=this;this.writable=!1;for(var r=function(){var r=e[n],i=n===e.length-1;t.writer.write(r).then((function(){i&&eV((function(){t.writable=!0,t.emitReserved("drain")}),t.setTimeoutFn)}))},n=0;n<e.length;n++)r()}},{key:"doClose",value:function(){var e;null===(e=this.transport)||void 0===e||e.close()}}]),r}(Nq),aV={websocket:nV,webtransport:iV,polling:Xq},sV=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,oV=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function uV(e){var t=e,r=e.indexOf("["),n=e.indexOf("]");-1!=r&&-1!=n&&(e=e.substring(0,r)+e.substring(r,n).replace(/:/g,";")+e.substring(n,e.length));for(var i=sV.exec(e||""),a={},s=14;s--;)a[oV[s]]=i[s]||"";return-1!=r&&-1!=n&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=function(e,t){var r=/\/{2,9}/g,n=t.replace(r,"/").split("/");"/"!=t.slice(0,1)&&0!==t.length||n.splice(0,1);"/"==t.slice(-1)&&n.splice(n.length-1,1);return n}(0,a.path),a.queryKey=function(e,t){var r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,n){t&&(r[t]=n)})),r}(0,a.query),a}var cV=function(e){ia(r,e);var t=ua(r);function r(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,hi.Z)(this,r),(n=t.call(this)).binaryType="arraybuffer",n.writeBuffer=[],e&&"object"===typeof e&&(i=e,e=null),e?(e=uV(e),i.hostname=e.host,i.secure="https"===e.protocol||"wss"===e.protocol,i.port=e.port,e.query&&(i.query=e.query)):i.host&&(i.hostname=uV(i.host).host),Mq(ra(n),i),n.secure=null!=i.secure?i.secure:"undefined"!==typeof location&&"https:"===location.protocol,i.hostname&&!i.port&&(i.port=n.secure?"443":"80"),n.hostname=i.hostname||("undefined"!==typeof location?location.hostname:"localhost"),n.port=i.port||("undefined"!==typeof location&&location.port?location.port:n.secure?"443":"80"),n.transports=i.transports||["polling","websocket","webtransport"],n.writeBuffer=[],n.prevBufferLen=0,n.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},i),n.opts.path=n.opts.path.replace(/\/$/,"")+(n.opts.addTrailingSlash?"/":""),"string"===typeof n.opts.query&&(n.opts.query=function(e){for(var t={},r=e.split("&"),n=0,i=r.length;n<i;n++){var a=r[n].split("=");t[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return t}(n.opts.query)),n.id=null,n.upgrades=null,n.pingInterval=null,n.pingTimeout=null,n.pingTimeoutTimer=null,"function"===typeof addEventListener&&(n.opts.closeOnBeforeunload&&(n.beforeunloadEventListener=function(){n.transport&&(n.transport.removeAllListeners(),n.transport.close())},addEventListener("beforeunload",n.beforeunloadEventListener,!1)),"localhost"!==n.hostname&&(n.offlineEventListener=function(){n.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",n.offlineEventListener,!1))),n.open(),n}return(0,fi.Z)(r,[{key:"createTransport",value:function(e){var t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);var r=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new aV[e](r)}},{key:"open",value:function(){var e,t=this;if(this.opts.rememberUpgrade&&r.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((function(){t.emitReserved("error","No transports available")}),0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(n){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}},{key:"setTransport",value:function(e){var t=this;this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(function(e){return t.onClose("transport close",e)}))}},{key:"probe",value:function(e){var t=this,n=this.createTransport(e),i=!1;r.priorWebsocketSuccess=!1;var a=function(){i||(n.send([{type:"ping",data:"probe"}]),n.once("packet",(function(e){if(!i)if("pong"===e.type&&"probe"===e.data){if(t.upgrading=!0,t.emitReserved("upgrading",n),!n)return;r.priorWebsocketSuccess="websocket"===n.name,t.transport.pause((function(){i||"closed"!==t.readyState&&(h(),t.setTransport(n),n.send([{type:"upgrade"}]),t.emitReserved("upgrade",n),n=null,t.upgrading=!1,t.flush())}))}else{var a=new Error("probe error");a.transport=n.name,t.emitReserved("upgradeError",a)}})))};function s(){i||(i=!0,h(),n.close(),n=null)}var o=function(e){var r=new Error("probe error: "+e);r.transport=n.name,s(),t.emitReserved("upgradeError",r)};function u(){o("transport closed")}function c(){o("socket closed")}function l(e){n&&e.name!==n.name&&s()}var h=function(){n.removeListener("open",a),n.removeListener("error",o),n.removeListener("close",u),t.off("close",c),t.off("upgrading",l)};n.once("open",a),n.once("error",o),n.once("close",u),this.once("close",c),this.once("upgrading",l),-1!==this.upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn((function(){i||n.open()}),200):n.open()}},{key:"onOpen",value:function(){if(this.readyState="open",r.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade)for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},{key:"onPacket",value:function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),this.resetPingTimeout(),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}},{key:"onHandshake",value:function(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}},{key:"resetPingTimeout",value:function(){var e=this;this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((function(){e.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}},{key:"onDrain",value:function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}},{key:"flush",value:function(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){var e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}},{key:"getWritablePackets",value:function(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;for(var e,t=1,r=0;r<this.writeBuffer.length;r++){var n=this.writeBuffer[r].data;if(n&&(t+="string"===typeof(e=n)?function(e){for(var t=0,r=0,n=0,i=e.length;n<i;n++)(t=e.charCodeAt(n))<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(n++,r+=4);return r}(e):Math.ceil(1.33*(e.byteLength||e.size))),r>0&&t>this.maxPayload)return this.writeBuffer.slice(0,r);t+=2}return this.writeBuffer}},{key:"write",value:function(e,t,r){return this.sendPacket("message",e,t,r),this}},{key:"send",value:function(e,t,r){return this.sendPacket("message",e,t,r),this}},{key:"sendPacket",value:function(e,t,r,n){if("function"===typeof t&&(n=t,t=void 0),"function"===typeof r&&(n=r,r=null),"closing"!==this.readyState&&"closed"!==this.readyState){(r=r||{}).compress=!1!==r.compress;var i={type:e,data:t,options:r};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),n&&this.once("flush",n),this.flush()}}},{key:"close",value:function(){var e=this,t=function(){e.onClose("forced close"),e.transport.close()},r=function r(){e.off("upgrade",r),e.off("upgradeError",r),t()},n=function(){e.once("upgrade",r),e.once("upgradeError",r)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(function(){e.upgrading?n():t()})):this.upgrading?n():t()),this}},{key:"onError",value:function(e){r.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}},{key:"onClose",value:function(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"===typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}},{key:"filterUpgrades",value:function(e){for(var t=[],r=0,n=e.length;r<n;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}}]),r}(Tq);cV.protocol=4;cV.protocol;var lV="function"===typeof ArrayBuffer,hV=function(e){return"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer},fV=Object.prototype.toString,dV="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===fV.call(Blob),pV="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===fV.call(File);function vV(e){return lV&&(e instanceof ArrayBuffer||hV(e))||dV&&e instanceof Blob||pV&&e instanceof File}function gV(e,t){if(!e||"object"!==typeof e)return!1;if(Array.isArray(e)){for(var r=0,n=e.length;r<n;r++)if(gV(e[r]))return!0;return!1}if(vV(e))return!0;if(e.toJSON&&"function"===typeof e.toJSON&&1===arguments.length)return gV(e.toJSON(),!0);for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)&&gV(e[i]))return!0;return!1}function yV(e){var t=[],r=e.data,n=e;return n.data=mV(r,t),n.attachments=t.length,{packet:n,buffers:t}}function mV(e,t){if(!e)return e;if(vV(e)){var r={_placeholder:!0,num:t.length};return t.push(e),r}if(Array.isArray(e)){for(var n=new Array(e.length),i=0;i<e.length;i++)n[i]=mV(e[i],t);return n}if("object"===typeof e&&!(e instanceof Date)){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(a[s]=mV(e[s],t));return a}return e}function bV(e,t){return e.data=_V(e.data,t),delete e.attachments,e}function _V(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"===typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(var r=0;r<e.length;r++)e[r]=_V(e[r],t);else if("object"===typeof e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=_V(e[n],t));return e}var wV,kV=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],xV=5;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(wV||(wV={}));var EV=function(){function e(t){(0,hi.Z)(this,e),this.replacer=t}return(0,fi.Z)(e,[{key:"encode",value:function(e){return e.type!==wV.EVENT&&e.type!==wV.ACK||!gV(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===wV.EVENT?wV.BINARY_EVENT:wV.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}},{key:"encodeAsString",value:function(e){var t=""+e.type;return e.type!==wV.BINARY_EVENT&&e.type!==wV.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}},{key:"encodeAsBinary",value:function(e){var t=yV(e),r=this.encodeAsString(t.packet),n=t.buffers;return n.unshift(r),n}}]),e}();function SV(e){return"[object Object]"===Object.prototype.toString.call(e)}var CV=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),(n=t.call(this)).reviver=e,n}return(0,fi.Z)(r,[{key:"add",value:function(e){var t;if("string"===typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");var n=(t=this.decodeString(e)).type===wV.BINARY_EVENT;n||t.type===wV.BINARY_ACK?(t.type=n?wV.EVENT:wV.ACK,this.reconstructor=new AV(t),0===t.attachments&&yo(aa(r.prototype),"emitReserved",this).call(this,"decoded",t)):yo(aa(r.prototype),"emitReserved",this).call(this,"decoded",t)}else{if(!vV(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,yo(aa(r.prototype),"emitReserved",this).call(this,"decoded",t))}}},{key:"decodeString",value:function(e){var t=0,n={type:Number(e.charAt(0))};if(void 0===wV[n.type])throw new Error("unknown packet type "+n.type);if(n.type===wV.BINARY_EVENT||n.type===wV.BINARY_ACK){for(var i=t+1;"-"!==e.charAt(++t)&&t!=e.length;);var a=e.substring(i,t);if(a!=Number(a)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(a)}if("/"===e.charAt(t+1)){for(var s=t+1;++t;){if(","===e.charAt(t))break;if(t===e.length)break}n.nsp=e.substring(s,t)}else n.nsp="/";var o=e.charAt(t+1);if(""!==o&&Number(o)==o){for(var u=t+1;++t;){var c=e.charAt(t);if(null==c||Number(c)!=c){--t;break}if(t===e.length)break}n.id=Number(e.substring(u,t+1))}if(e.charAt(++t)){var l=this.tryParse(e.substr(t));if(!r.isPayloadValid(n.type,l))throw new Error("invalid payload");n.data=l}return n}},{key:"tryParse",value:function(e){try{return JSON.parse(e,this.reviver)}catch(t){return!1}}},{key:"destroy",value:function(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}],[{key:"isPayloadValid",value:function(e,t){switch(e){case wV.CONNECT:return SV(t);case wV.DISCONNECT:return void 0===t;case wV.CONNECT_ERROR:return"string"===typeof t||SV(t);case wV.EVENT:case wV.BINARY_EVENT:return Array.isArray(t)&&("number"===typeof t[0]||"string"===typeof t[0]&&-1===kV.indexOf(t[0]));case wV.ACK:case wV.BINARY_ACK:return Array.isArray(t)}}}]),r}(Tq),AV=function(){function e(t){(0,hi.Z)(this,e),this.packet=t,this.buffers=[],this.reconPack=t}return(0,fi.Z)(e,[{key:"takeBinaryData",value:function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=bV(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}},{key:"finishedReconstruction",value:function(){this.reconPack=null,this.buffers=[]}}]),e}();function DV(e,t,r){return e.on(t,r),function(){e.off(t,r)}}var RV=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),TV=function(e){ia(r,e);var t=ua(r);function r(e,n,i){var a;return(0,hi.Z)(this,r),(a=t.call(this)).connected=!1,a.recovered=!1,a.receiveBuffer=[],a.sendBuffer=[],a._queue=[],a._queueSeq=0,a.ids=0,a.acks={},a.flags={},a.io=e,a.nsp=n,i&&i.auth&&(a.auth=i.auth),a._opts=Object.assign({},i),a.io._autoConnect&&a.open(),a}return(0,fi.Z)(r,[{key:"disconnected",get:function(){return!this.connected}},{key:"subEvents",value:function(){if(!this.subs){var e=this.io;this.subs=[DV(e,"open",this.onopen.bind(this)),DV(e,"packet",this.onpacket.bind(this)),DV(e,"error",this.onerror.bind(this)),DV(e,"close",this.onclose.bind(this))]}}},{key:"active",get:function(){return!!this.subs}},{key:"connect",value:function(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}},{key:"open",value:function(){return this.connect()}},{key:"send",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.unshift("message"),this.emit.apply(this,t),this}},{key:"emit",value:function(e){if(RV.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(r.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;var i={type:wV.EVENT,data:r,options:{}};if(i.options.compress=!1!==this.flags.compress,"function"===typeof r[r.length-1]){var a=this.ids++,s=r.pop();this._registerAckCallback(a,s),i.id=a}var o=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!o||!this.connected)||(this.connected?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}},{key:"_registerAckCallback",value:function(e,t){var r,n=this,i=null!==(r=this.flags.timeout)&&void 0!==r?r:this._opts.ackTimeout;if(void 0!==i){var a=this.io.setTimeoutFn((function(){delete n.acks[e];for(var r=0;r<n.sendBuffer.length;r++)n.sendBuffer[r].id===e&&n.sendBuffer.splice(r,1);t.call(n,new Error("operation has timed out"))}),i);this.acks[e]=function(){n.io.clearTimeoutFn(a);for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];t.apply(n,[null].concat(r))}}else this.acks[e]=t}},{key:"emitWithAck",value:function(e){for(var t=this,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var a=void 0!==this.flags.timeout||void 0!==this._opts.ackTimeout;return new Promise((function(r,i){n.push((function(e,t){return a?e?i(e):r(t):r(e)})),t.emit.apply(t,[e].concat(n))}))}},{key:"_addToQueue",value:function(e){var t,r=this;"function"===typeof e[e.length-1]&&(t=e.pop());var n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((function(e){if(n===r._queue[0]){if(null!==e)n.tryCount>r._opts.retries&&(r._queue.shift(),t&&t(e));else if(r._queue.shift(),t){for(var i=arguments.length,a=new Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];t.apply(void 0,[null].concat(a))}return n.pending=!1,r._drainQueue()}})),this._queue.push(n),this._drainQueue()}},{key:"_drainQueue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.connected&&0!==this._queue.length){var t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}}},{key:"packet",value:function(e){e.nsp=this.nsp,this.io._packet(e)}},{key:"onopen",value:function(){var e=this;"function"==typeof this.auth?this.auth((function(t){e._sendConnectPacket(t)})):this._sendConnectPacket(this.auth)}},{key:"_sendConnectPacket",value:function(e){this.packet({type:wV.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}},{key:"onerror",value:function(e){this.connected||this.emitReserved("connect_error",e)}},{key:"onclose",value:function(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}},{key:"onpacket",value:function(e){if(e.nsp===this.nsp)switch(e.type){case wV.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case wV.EVENT:case wV.BINARY_EVENT:this.onevent(e);break;case wV.ACK:case wV.BINARY_ACK:this.onack(e);break;case wV.DISCONNECT:this.ondisconnect();break;case wV.CONNECT_ERROR:this.destroy();var t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}},{key:"onevent",value:function(e){var t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}},{key:"emitEvent",value:function(e){if(this._anyListeners&&this._anyListeners.length){var t,n=this._anyListeners.slice(),i=(0,ge.Z)(n);try{for(i.s();!(t=i.n()).done;){t.value.apply(this,e)}}catch(S$){i.e(S$)}finally{i.f()}}yo(aa(r.prototype),"emit",this).apply(this,e),this._pid&&e.length&&"string"===typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}},{key:"ack",value:function(e){var t=this,r=!1;return function(){if(!r){r=!0;for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];t.packet({type:wV.ACK,id:e,data:i})}}}},{key:"onack",value:function(e){var t=this.acks[e.id];"function"===typeof t&&(t.apply(this,e.data),delete this.acks[e.id])}},{key:"onconnect",value:function(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}},{key:"emitBuffered",value:function(){var e=this;this.receiveBuffer.forEach((function(t){return e.emitEvent(t)})),this.receiveBuffer=[],this.sendBuffer.forEach((function(t){e.notifyOutgoingListeners(t),e.packet(t)})),this.sendBuffer=[]}},{key:"ondisconnect",value:function(){this.destroy(),this.onclose("io server disconnect")}},{key:"destroy",value:function(){this.subs&&(this.subs.forEach((function(e){return e()})),this.subs=void 0),this.io._destroy(this)}},{key:"disconnect",value:function(){return this.connected&&this.packet({type:wV.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{key:"close",value:function(){return this.disconnect()}},{key:"compress",value:function(e){return this.flags.compress=e,this}},{key:"volatile",get:function(){return this.flags.volatile=!0,this}},{key:"timeout",value:function(e){return this.flags.timeout=e,this}},{key:"onAny",value:function(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}},{key:"prependAny",value:function(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}},{key:"offAny",value:function(e){if(!this._anyListeners)return this;if(e){for(var t=this._anyListeners,r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyListeners=[];return this}},{key:"listenersAny",value:function(){return this._anyListeners||[]}},{key:"onAnyOutgoing",value:function(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}},{key:"prependAnyOutgoing",value:function(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}},{key:"offAnyOutgoing",value:function(e){if(!this._anyOutgoingListeners)return this;if(e){for(var t=this._anyOutgoingListeners,r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyOutgoingListeners=[];return this}},{key:"listenersAnyOutgoing",value:function(){return this._anyOutgoingListeners||[]}},{key:"notifyOutgoingListeners",value:function(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){var t,r=this._anyOutgoingListeners.slice(),n=(0,ge.Z)(r);try{for(n.s();!(t=n.n()).done;){t.value.apply(this,e.data)}}catch(S$){n.e(S$)}finally{n.f()}}}}]),r}(Tq);function ZV(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}ZV.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-r:e+r}return 0|Math.min(e,this.max)},ZV.prototype.reset=function(){this.attempts=0},ZV.prototype.setMin=function(e){this.ms=e},ZV.prototype.setMax=function(e){this.max=e},ZV.prototype.setJitter=function(e){this.jitter=e};var IV=function(e){ia(r,e);var t=ua(r);function r(e,n){var i,a;(0,hi.Z)(this,r),(i=t.call(this)).nsps={},i.subs=[],e&&"object"===typeof e&&(n=e,e=void 0),(n=n||{}).path=n.path||"/socket.io",i.opts=n,Mq(ra(i),n),i.reconnection(!1!==n.reconnection),i.reconnectionAttempts(n.reconnectionAttempts||1/0),i.reconnectionDelay(n.reconnectionDelay||1e3),i.reconnectionDelayMax(n.reconnectionDelayMax||5e3),i.randomizationFactor(null!==(a=n.randomizationFactor)&&void 0!==a?a:.5),i.backoff=new ZV({min:i.reconnectionDelay(),max:i.reconnectionDelayMax(),jitter:i.randomizationFactor()}),i.timeout(null==n.timeout?2e4:n.timeout),i._readyState="closed",i.uri=e;var s=n.parser||te;return i.encoder=new s.Encoder,i.decoder=new s.Decoder,i._autoConnect=!1!==n.autoConnect,i._autoConnect&&i.open(),i}return(0,fi.Z)(r,[{key:"reconnection",value:function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}},{key:"reconnectionAttempts",value:function(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}},{key:"reconnectionDelay",value:function(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}},{key:"randomizationFactor",value:function(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}},{key:"reconnectionDelayMax",value:function(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}},{key:"timeout",value:function(e){return arguments.length?(this._timeout=e,this):this._timeout}},{key:"maybeReconnectOnOpen",value:function(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}},{key:"open",value:function(e){var t=this;if(~this._readyState.indexOf("open"))return this;this.engine=new cV(this.uri,this.opts);var r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;var i=DV(r,"open",(function(){n.onopen(),e&&e()})),a=function(r){t.cleanup(),t._readyState="closed",t.emitReserved("error",r),e?e(r):t.maybeReconnectOnOpen()},s=DV(r,"error",a);if(!1!==this._timeout){var o=this._timeout,u=this.setTimeoutFn((function(){i(),a(new Error("timeout")),r.close()}),o);this.opts.autoUnref&&u.unref(),this.subs.push((function(){t.clearTimeoutFn(u)}))}return this.subs.push(i),this.subs.push(s),this}},{key:"connect",value:function(e){return this.open(e)}},{key:"onopen",value:function(){this.cleanup(),this._readyState="open",this.emitReserved("open");var e=this.engine;this.subs.push(DV(e,"ping",this.onping.bind(this)),DV(e,"data",this.ondata.bind(this)),DV(e,"error",this.onerror.bind(this)),DV(e,"close",this.onclose.bind(this)),DV(this.decoder,"decoded",this.ondecoded.bind(this)))}},{key:"onping",value:function(){this.emitReserved("ping")}},{key:"ondata",value:function(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}},{key:"ondecoded",value:function(e){var t=this;eV((function(){t.emitReserved("packet",e)}),this.setTimeoutFn)}},{key:"onerror",value:function(e){this.emitReserved("error",e)}},{key:"socket",value:function(e,t){var r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new TV(this,e,t),this.nsps[e]=r),r}},{key:"_destroy",value:function(e){for(var t=0,r=Object.keys(this.nsps);t<r.length;t++){var n=r[t];if(this.nsps[n].active)return}this._close()}},{key:"_packet",value:function(e){for(var t=this.encoder.encode(e),r=0;r<t.length;r++)this.engine.write(t[r],e.options)}},{key:"cleanup",value:function(){this.subs.forEach((function(e){return e()})),this.subs.length=0,this.decoder.destroy()}},{key:"_close",value:function(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}},{key:"disconnect",value:function(){return this._close()}},{key:"onclose",value:function(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}},{key:"reconnect",value:function(){var e=this;if(this._reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{var r=this.backoff.duration();this._reconnecting=!0;var n=this.setTimeoutFn((function(){t.skipReconnect||(e.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open((function(r){r?(t._reconnecting=!1,t.reconnect(),e.emitReserved("reconnect_error",r)):t.onreconnect()})))}),r);this.opts.autoUnref&&n.unref(),this.subs.push((function(){e.clearTimeoutFn(n)}))}}},{key:"onreconnect",value:function(){var e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}]),r}(Tq),PV={};function LV(e,t){"object"===typeof e&&(t=e,e=void 0);var r,n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0,n=e;r=r||"undefined"!==typeof location&&location,null==e&&(e=r.protocol+"//"+r.host),"string"===typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?r.protocol+e:r.host+e),/^(https?|wss?):\/\//.test(e)||(e="undefined"!==typeof r?r.protocol+"//"+e:"https://"+e),n=uV(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var i=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+i+":"+n.port+t,n.href=n.protocol+"://"+i+(r&&r.port===n.port?"":":"+n.port),n}(e,(t=t||{}).path||"/socket.io"),i=n.source,a=n.id,s=n.path,o=PV[a]&&s in PV[a].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||o?r=new IV(i,t):(PV[a]||(PV[a]=new IV(i,t)),r=PV[a]),n.query&&!t.query&&(t.query=n.queryKey),r.socket(n.path,t)}Object.assign(LV,{Manager:IV,Socket:TV,io:LV,connect:LV});var MV,BV=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var a=e.charAt(i),s=a.charCodeAt(0);if(255!==r[s])throw new TypeError(a+" is ambiguous");r[s]=i}var o=e.length,u=e.charAt(0),c=Math.log(o)/Math.log(256),l=Math.log(256)/Math.log(o);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===u;)n++,t++;for(var a=(e.length-t)*c+1>>>0,s=new Uint8Array(a);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var h=0,f=a-1;(0!==l||h<i)&&-1!==f;f--,h++)l+=o*s[f]>>>0,s[f]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var d=a-i;d!==a&&0===s[d];)d++;for(var p=new Uint8Array(n+(a-d)),v=n;d!==a;)p[v++]=s[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,a=t.length;i!==a&&0===t[i];)i++,r++;for(var s=(a-i)*l+1>>>0,c=new Uint8Array(s);i!==a;){for(var h=t[i],f=0,d=s-1;(0!==h||f<n)&&-1!==d;d--,f++)h+=256*c[d]>>>0,c[d]=h%o>>>0,h=h/o>>>0;if(0!==h)throw new Error("Non-zero carry");n=f,i++}for(var p=s-n;p!==s&&0===c[p];)p++;for(var v=u.repeat(r);p<s;++p)v+=e.charAt(c[p]);return v},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error("Non-".concat(t," character"))}}},OV=BV,NV=(new Uint8Array(0),function(){function e(t,r,n){(0,hi.Z)(this,e),this.name=t,this.prefix=r,this.baseEncode=n}return(0,fi.Z)(e,[{key:"encode",value:function(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}]),e}()),FV=function(){function e(t,r,n){if((0,hi.Z)(this,e),this.name=t,this.prefix=r,void 0===r.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}return(0,fi.Z)(e,[{key:"decode",value:function(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}},{key:"or",value:function(e){return zV(this,e)}}]),e}(),UV=function(){function e(t){(0,hi.Z)(this,e),this.decoders=t}return(0,fi.Z)(e,[{key:"or",value:function(e){return zV(this,e)}},{key:"decode",value:function(e){var t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}]),e}(),zV=function(e,t){return new UV((0,_e.Z)((0,_e.Z)({},e.decoders||(0,we.Z)({},e.prefix,e)),t.decoders||(0,we.Z)({},t.prefix,t)))},jV=function(){function e(t,r,n,i){(0,hi.Z)(this,e),this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new NV(t,r,n),this.decoder=new FV(t,r,i)}return(0,fi.Z)(e,[{key:"encode",value:function(e){return this.encoder.encode(e)}},{key:"decode",value:function(e){return this.decoder.decode(e)}}]),e}(),HV=function(e){var t=e.name,r=e.prefix,n=e.encode,i=e.decode;return new jV(t,r,n,i)},WV=function(e){var t=e.prefix,r=e.name,n=e.alphabet,i=OV(n,r),a=i.encode,s=i.decode;return HV({prefix:t,name:r,encode:a,decode:function(e){return function(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}(s(e))}})},qV=function(e){var t=e.name,r=e.prefix,n=e.bitsPerChar,i=e.alphabet;return HV({prefix:r,name:t,encode:function(e){return function(e,t,r){for(var n="="===t[t.length-1],i=(1<<r)-1,a="",s=0,o=0,u=0;u<e.length;++u)for(o=o<<8|e[u],s+=8;s>r;)a+=t[i&o>>(s-=r)];if(s&&(a+=t[i&o<<r-s]),n)for(;a.length*r&7;)a+="=";return a}(e,i,n)},decode:function(e){return function(e,t,r,n){for(var i={},a=0;a<t.length;++a)i[t[a]]=a;for(var s=e.length;"="===e[s-1];)--s;for(var o=new Uint8Array(s*r/8|0),u=0,c=0,l=0,h=0;h<s;++h){var f=i[e[h]];if(void 0===f)throw new SyntaxError("Non-".concat(n," character"));c=c<<r|f,(u+=r)>=8&&(u-=8,o[l++]=255&c>>u)}if(u>=r||255&c<<8-u)throw new SyntaxError("Unexpected end of data");return o}(e,i,n,t)}})},VV=WV({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),KV=(WV({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),qV({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5})),YV=(qV({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),qV({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),qV({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),qV({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),qV({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),qV({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),qV({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),qV({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),qV({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}));qV({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),qV({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),qV({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function GV(e){var t=function(e){var t=function(){};return t.enabled=!1,t.color="",t.diff=0,t.log=function(){},t.namespace=e,t.destroy=function(){return!0},t.extend=function(){return t},t}("".concat(e,":trace"));return li.enabled("".concat(e,":trace"))&&null!=li.names.map((function(e){return e.toString()})).find((function(e){return e.includes(":trace")}))&&(t=li("".concat(e,":trace"))),Object.assign(li(e),{error:li("".concat(e,":error")),trace:t})}li.formatters.b=function(e){return null==e?"undefined":VV.baseEncode(e)},li.formatters.t=function(e){return null==e?"undefined":KV.baseEncode(e)},li.formatters.m=function(e){return null==e?"undefined":YV.baseEncode(e)},li.formatters.p=function(e){return null==e?"undefined":e.toString()},li.formatters.c=function(e){return null==e?"undefined":e.toString()},li.formatters.k=function(e){return null==e?"undefined":e.toString()},li.formatters.a=function(e){return null==e?"undefined":e.toString()};var QV=new WeakMap,XV=function(e){ia(r,e);var t=ua(r);function r(){var e;(0,hi.Z)(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return lo(ra(e=t.call.apply(t,[this].concat(i))),QV,{writable:!0,value:new Map}),e}return(0,fi.Z)(r,[{key:"listenerCount",value:function(e){var t=fo(this,QV).get(e);return null==t?0:t.length}},{key:"addEventListener",value:function(e,t,n){var i;yo(aa(r.prototype),"addEventListener",this).call(this,e,t,n);var a=fo(this,QV).get(e);null==a&&(a=[],fo(this,QV).set(e,a)),a.push({callback:t,once:null!==(i=!0!==n&&!1!==n&&(null===n||void 0===n?void 0:n.once))&&void 0!==i&&i})}},{key:"removeEventListener",value:function(e,t,n){yo(aa(r.prototype),"removeEventListener",this).call(this,e.toString(),null!==t&&void 0!==t?t:null,n);var i=fo(this,QV).get(e);null!=i&&(i=i.filter((function(e){return e.callback!==t})),fo(this,QV).set(e,i))}},{key:"dispatchEvent",value:function(e){var t=yo(aa(r.prototype),"dispatchEvent",this).call(this,e),n=fo(this,QV).get(e.type);return null==n||(n=n.filter((function(e){return!e.once})),fo(this,QV).set(e.type,n)),t}},{key:"safeDispatchEvent",value:function(e,t){return this.dispatchEvent(new $V(e,t))}}]),r}(es(EventTarget)),JV=function(e){ia(r,e);var t=ua(r);function r(e,n){var i;return(0,hi.Z)(this,r),i=t.call(this,e,n),(0,we.Z)(ra(i),"detail",void 0),i.detail=null===n||void 0===n?void 0:n.detail,i}return(0,fi.Z)(r)}(es(Event)),$V=null!==(MV=globalThis.CustomEvent)&&void 0!==MV?MV:JV,eK=__webpack_require__(5410),tK=function(){function e(t,r){var n=this;(0,hi.Z)(this,e),this.label=t.label,this.open=ts(),this.channel=t,this.channel.binaryType="arraybuffer",this.log=r.log,"number"===typeof this.channel.bufferedAmountLowThreshold&&(this.channel.bufferedAmountLowThreshold=65536),t.addEventListener("message",(function(e){r.onMessage(e)})),t.addEventListener("bufferedamountlow",(function(){n.log("stop backpressure: bufferedAmount %d",n.channel.bufferedAmount),n.open.resolve()})),t.addEventListener("open",(function(){n.open.resolve(),r.onOpen()})),t.addEventListener("close",(function(){r.onClose()})),t.addEventListener("error",(function(e){var i,a,s,o,u;if("Transport channel closed"===(null===(i=e.error)||void 0===i?void 0:i.message))return n.close();r.log.error('channel encounter an error in state "%s" message: "%s" detail: "%s',t.readyState,null===(a=e.error)||void 0===a?void 0:a.message,null===(s=e.error)||void 0===s?void 0:s.errorDetail);var c=e.error instanceof Error?e.error:new Error("datachannel error: ".concat(null===(o=e.error)||void 0===o?void 0:o.message," ").concat(null===(u=e.error)||void 0===u?void 0:u.errorDetail));r.onError(ji(c,"ERR_DATA_CHANNEL"))}));var i=!1;this.closingInterval=setInterval((function(){"closing"===t.readyState?(i&&r.onClose(),i=!0):i=!1}),5e3)}return(0,fi.Z)(e,[{key:"send",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.open.promise;case 2:this.channel.send(t),this.channel.bufferedAmount>65536&&(this.log("start backpressure: bufferedAmount %d",this.channel.bufferedAmount),this.open=ts());case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"close",value:function(){clearInterval(this.closingInterval),this.channel.close()}},{key:"bufferedAmount",get:function(){return this.channel.bufferedAmount}}]),e}(),rK=__webpack_require__(8584),nK={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}]};var iK=function(e){ia(r,e);var t=ua(r);function r(e){var n,i,a;return(0,hi.Z)(this,r),(a=t.call(this)).id=null!==(n=e.id)&&void 0!==n?n:Ws(eK(4),"hex").slice(0,7),a.log=GV("libp2p:webrtc-peer:".concat(e.logPrefix,":").concat(a.id)),a.wrtc=null!==(i=e.wrtc)&&void 0!==i?i:function(){var e,t,r,n,i,a;if("undefined"===typeof globalThis)throw ji(new Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");var s={RTCPeerConnection:null!==(e=null!==(t=globalThis.RTCPeerConnection)&&void 0!==t?t:globalThis.mozRTCPeerConnection)&&void 0!==e?e:globalThis.webkitRTCPeerConnection,RTCSessionDescription:null!==(r=null!==(n=globalThis.RTCSessionDescription)&&void 0!==n?n:globalThis.mozRTCSessionDescription)&&void 0!==r?r:globalThis.webkitRTCSessionDescription,RTCIceCandidate:null!==(i=null!==(a=globalThis.RTCIceCandidate)&&void 0!==a?a:globalThis.mozRTCIceCandidate)&&void 0!==i?i:globalThis.webkitRTCIceCandidate};if(null==s.RTCPeerConnection)throw ji(new Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");return s}(),a.peerConnection=new a.wrtc.RTCPeerConnection(Object.assign({},nK,e.peerConnectionConfig)),a.closed=!1,a.connected=ts(),a.source=as(),a.sink=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,s,o,u;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.connected.promise;case 2:if(null!=a.channel){e.next=4;break}throw ji(new Error("Connected but no channel?!"),"ERR_DATA_CHANNEL");case 4:r=!1,n=!1,e.prev=6,s=ui(t);case 8:return e.next=10,s.next();case 10:if(!(r=!(o=e.sent).done)){e.next=17;break}return u=o.value,e.next=14,a.channel.send(u);case 14:r=!1,e.next=8;break;case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(6),n=!0,i=e.t0;case 23:if(e.prev=23,e.prev=24,!r||null==s.return){e.next=28;break}return e.next=28,s.return();case 28:if(e.prev=28,!n){e.next=31;break}throw i;case 31:return e.finish(28);case 32:return e.finish(23);case 33:return e.next=35,a.close();case 35:case"end":return e.stop()}}),e,null,[[6,19,23,33],[24,,28,32]])})));return function(t){return e.apply(this,arguments)}}(),a}return(0,fi.Z)(r,[{key:"handleDataChannelEvent",value:function(e){var t=this,r=e.channel;null!=r?this.channel=new tK(r,{log:this.log,onMessage:function(e){t.source.push(new Uint8Array(e.data))},onOpen:function(){t.connected.resolve(),t.dispatchEvent(new $V("ready"))},onClose:function(){t.close().catch((function(e){t.log("error closing connection after channel close",e)}))},onError:function(e){t.close(e).catch((function(e){t.log("error closing connection after channel error",e)}))}}):this.close(ji(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL")).catch((function(e){t.log("Error closing after event channel was found to be null",e)}))}},{key:"close",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.closed=!0,null!=t||null==this.channel){e.next=7;break}case 2:if(!(this.channel.bufferedAmount>0)){e.next=7;break}return e.next=5,rK(100);case 5:e.next=2;break;case 7:null===(r=this.channel)||void 0===r||r.close(),this.peerConnection.close(),this.source.end(t),this.dispatchEvent(new $V("close"));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(XV),aK=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),(n=t.call(this)).log=e.log,n.peerConnection=e.peerConnection,n.wrtc=e.wrtc,n.status="idle",n.peerConnection.addEventListener("negotiationneeded",(function(){n.log("peer connection negotiation needed"),n.handleRenegotiate({type:"renegotiate"}).catch((function(e){n.log.error("could not renegotiate %o",e)}))})),n}return(0,fi.Z)(r,[{key:"handleSignal",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.log('incoming signal "%s"',t.type),"offer"!==t.type){e.next=7;break}return e.next=4,this.handleOffer(t);case 4:return e.abrupt("return",e.sent);case 7:if("answer"!==t.type){e.next=13;break}return e.next=10,this.handleAnswer(t);case 10:return e.abrupt("return",e.sent);case 13:if("candidate"!==t.type){e.next=19;break}return e.next=16,this.handleCandidate(t);case 16:return e.abrupt("return",e.sent);case 19:if("renegotiate"!==t.type){e.next=25;break}return e.next=22,this.handleRenegotiate(t);case 22:return e.abrupt("return",e.sent);case 25:if("goodbye"!==t.type){e.next=31;break}return e.next=28,this.handleGoodye(t);case 28:return e.abrupt("return",e.sent);case 31:this.log("Unknown signal type ".concat(t.type));case 32:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleOffer",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleAnswer",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleRenegotiate",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleGoodye",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.peerConnection.close();case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleCandidate",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new this.wrtc.RTCIceCandidate(t.candidate),e.prev=1,e.next=4,this.peerConnection.addIceCandidate(r);case 4:e.next=13;break;case 6:if(e.prev=6,e.t0=e.catch(1),null!=r.address&&!r.address.endsWith(".local")){e.next=12;break}this.log("ignoring unsupported ICE candidate."),e.next=13;break;case 12:throw ji(e.t0,"ERR_ADD_ICE_CANDIDATE");case 13:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()}]),r}(XV),sK=GV("libp2p:webrtc-peer:receiver"),oK=function(e){ia(r,e);var t=ua(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,hi.Z)(this,r),(e=t.call(this,(0,_e.Z)((0,_e.Z)({},n),{},{logPrefix:"receiver"}))).handshake=new uK({log:e.log,peerConnection:e.peerConnection,wrtc:e.wrtc,answerOptions:n.answerOptions}),e.handshake.addEventListener("signal",(function(t){return e.dispatchEvent(new $V("signal",{detail:t.detail}))})),e.peerConnection.addEventListener("datachannel",(function(t){e.handleDataChannelEvent(t)})),e}return(0,fi.Z)(r,[{key:"handleSignal",value:function(e){var t=this;this.handshake.handleSignal(e).catch((function(r){t.log("error handling signal %o %o",e,r)}))}}]),r}(iK),uK=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),(n=t.call(this,e)).options=e,n.status="idle",n.iceCandidates=[],n}return(0,fi.Z)(r,[{key:"handleRenegotiate",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:sK.trace("renegotiate"),this.dispatchEvent(new $V("signal",{detail:{type:"renegotiate"}}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleOffer",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.peerConnection.setRemoteDescription(new this.wrtc.RTCSessionDescription(t));case 2:n=(0,ge.Z)(this.iceCandidates),e.prev=3,n.s();case 5:if((i=n.n()).done){e.next=11;break}return a=i.value,e.next=9,this.handleCandidate(a);case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),n.e(e.t0);case 16:return e.prev=16,n.f(),e.finish(16);case 19:return this.iceCandidates=[],e.next=22,this.peerConnection.createAnswer(this.options.answerOptions);case 22:return s=e.sent,e.next=25,this.peerConnection.setLocalDescription(s);case 25:sK.trace("handle offer",this.peerConnection.localDescription),this.dispatchEvent(new $V("signal",{detail:null!==(r=this.peerConnection.localDescription)&&void 0!==r?r:s}));case 27:case"end":return e.stop()}}),e,this,[[3,13,16,19]])})));return function(t){return e.apply(this,arguments)}}()},{key:"handleCandidate",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.peerConnection.remoteDescription&&null!=this.peerConnection.remoteDescription.type){e.next=3;break}return this.iceCandidates.push(t),e.abrupt("return");case 3:return e.next=5,yo(aa(r.prototype),"handleCandidate",this).call(this,t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(aK),cK=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),(n=t.call(this,e)).name="TimeoutError",n}return(0,fi.Z)(r)}(es(Error)),lK=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),(n=t.call(this)).name="AbortError",n.message=e,n}return(0,fi.Z)(r)}(es(Error)),hK=function(e){return void 0===globalThis.DOMException?new lK(e):new DOMException(e)},fK=function(e){var t=void 0===e.reason?hK("This operation was aborted."):e.reason;return t instanceof Error?t:hK(t)};var dK=function(e){var t=e.on||e.addListener||e.addEventListener,r=e.off||e.removeListener||e.removeEventListener;if(!t||!r)throw new TypeError("Emitter is not compatible");return{addListener:t.bind(e),removeListener:r.bind(e)}};function pK(e,t,r){var n,i=new Promise((function(i,a){if(!((r=(0,_e.Z)({rejectionEvents:["error"],multiArgs:!1,resolveImmediately:!1},r)).count>=0)||r.count!==Number.POSITIVE_INFINITY&&!Number.isInteger(r.count))throw new TypeError("The `count` option should be at least 0 or more");var s=[t].flat(),o=[],u=dK(e),c=u.addListener,l=u.removeListener,h=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];var s=r.multiArgs?t:t[0];r.filter&&!r.filter(s)||(o.push(s),r.count===o.length&&(n(),i(o)))},f=function(e){n(),a(e)};n=function(){var e,t=(0,ge.Z)(s);try{for(t.s();!(e=t.n()).done;){var n=e.value;l(n,h)}}catch(S$){t.e(S$)}finally{t.f()}var i,a=(0,ge.Z)(r.rejectionEvents);try{for(a.s();!(i=a.n()).done;){var o=i.value;l(o,f)}}catch(S$){a.e(S$)}finally{a.f()}};var d,p=(0,ge.Z)(s);try{for(p.s();!(d=p.n()).done;){c(d.value,h)}}catch(S$){p.e(S$)}finally{p.f()}var v,g=(0,ge.Z)(r.rejectionEvents);try{for(g.s();!(v=g.n()).done;){c(v.value,f)}}catch(S$){g.e(S$)}finally{g.f()}r.resolveImmediately&&i(o)}));if(i.cancel=n,"number"===typeof r.timeout){var a=function(e,t,r,n){var i,a=new Promise((function(a,s){if("number"!==typeof t||1!==Math.sign(t))throw new TypeError("Expected `milliseconds` to be a positive number, got `".concat(t,"`"));if(t!==Number.POSITIVE_INFINITY){if((n=(0,_e.Z)({customTimers:{setTimeout:setTimeout,clearTimeout:clearTimeout}},n)).signal){var o=n.signal;o.aborted&&s(fK(o)),o.addEventListener("abort",(function(){s(fK(o))}))}i=n.customTimers.setTimeout.call(void 0,(function(){if("function"!==typeof r){var n="string"===typeof r?r:"Promise timed out after ".concat(t," milliseconds"),i=r instanceof Error?r:new cK(n);"function"===typeof e.cancel&&e.cancel(),s(i)}else try{a(r())}catch(o){s(o)}}),t),(0,ai.Z)((0,ii.Z)().mark((function t(){return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=a,t.next=4,e;case 4:t.t1=t.sent,(0,t.t0)(t.t1),t.next=11;break;case 8:t.prev=8,t.t2=t.catch(0),s(t.t2);case 11:return t.prev=11,n.customTimers.clearTimeout.call(void 0,i),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])})))()}else a(e)}));return a.clear=function(){clearTimeout(i),i=void 0},a}(i,r.timeout);return a.cancel=n,a}return i}function vK(e,t,r){"function"===typeof r&&(r={filter:r});var n=pK(e,t,r=(0,_e.Z)((0,_e.Z)({},r),{},{count:1,resolveImmediately:!1})),i=n.then((function(e){return e[0]}));return i.cancel=n.cancel,i}var gK=GV("libp2p:webrtc-peer:initator"),yK=function(e){ia(r,e);var t=ua(r);function r(){var e,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,hi.Z)(this,r),(n=t.call(this,(0,_e.Z)((0,_e.Z)({},i),{},{logPrefix:"initiator"}))).handleDataChannelEvent({channel:n.peerConnection.createDataChannel(null!==(e=i.dataChannelLabel)&&void 0!==e?e:Ws(eK(20),"hex").slice(0,7),i.dataChannelInit)}),n.handshake=new mK({log:n.log,peerConnection:n.peerConnection,wrtc:n.wrtc,offerOptions:i.offerOptions}),n.handshake.addEventListener("signal",(function(e){n.dispatchEvent(new $V("signal",{detail:e.detail}))})),n}return(0,fi.Z)(r,[{key:"handleSignal",value:function(e){var t=this;this.handshake.handleSignal(e).catch((function(r){t.log("error handling signal %o %o",e,r)}))}}]),r}(iK),mK=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),(n=t.call(this,e)).options=e,n.status="idle",n.peerConnection.addEventListener("icecandidate",(function(e){if(null!=e.candidate){var t={type:"candidate",candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}};gK.trace("create candidate",t),n.dispatchEvent(new $V("signal",{detail:t})),n.dispatchEvent(new $V("ice-candidate"))}})),n}return(0,fi.Z)(r,[{key:"handleRenegotiate",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("negotiating"!==this.status){e.next=3;break}return this.log("already negotiating, queueing"),e.abrupt("return");case 3:return this.status="negotiating",e.next=6,this.peerConnection.createOffer(this.options.offerOptions);case 6:return r=e.sent,e.next=9,this.peerConnection.setLocalDescription(r);case 9:return e.next=11,vK(this,"ice-candidate");case 11:return e.next=13,rK(1e3);case 13:gK.trace("renegotiate",this.peerConnection.localDescription),this.dispatchEvent(new $V("signal",{detail:null!==(t=this.peerConnection.localDescription)&&void 0!==t?t:r}));case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleAnswer",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gK.trace("handle answer",t),e.next=3,this.peerConnection.setRemoteDescription(new this.wrtc.RTCSessionDescription(t));case 3:this.status="idle";case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(aK),bK=oq("libp2p:webrtc-star:socket");function _K(e,t){var r=e.sink,n=e.source,i={remoteAddr:t.remoteAddr,sink:function(e){return(0,ai.Z)((0,ii.Z)().mark((function n(){return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return null!=t.signal&&(e=Sk(e,t.signal)),n.prev=1,n.next=4,r(e);case 4:n.next=9;break;case 6:n.prev=6,n.t0=n.catch(1),"aborted"!==n.t0.type&&bK.error(n.t0);case 9:case"end":return n.stop()}}),n,null,[[1,6]])})))()},source:null!=t.signal?Sk(n,t.signal):n,timeline:{open:Date.now()},close:function(){return(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.closed){t.next=2;break}return t.abrupt("return");case 2:return r=Date.now(),n=setTimeout((function(){if(null!=i.remoteAddr){var t=i.remoteAddr.toOptions(),n=t.host,a=t.port;bK("timeout closing socket to %s:%s after %dms, destroying it manually",n,a,Date.now()-r)}e.closed||e.close().catch((function(e){bK.error("could not close socket",e)}))}),2e3),t.prev=4,t.next=7,e.close();case 7:return t.prev=7,clearTimeout(n),t.finish(7);case 10:case"end":return t.stop()}}),t,null,[[4,,7,10]])})))()}};return e.addEventListener("close",(function(){null==i.timeline.close&&(i.timeline.close=Date.now())}),{once:!0}),i}function wK(e){var t,r=e.toString().split("/"),n=e.protos()[1].name,i=e.protos()[2].name,a=e.stringTuples()[1][1];if("tcp"!==n||"ws"!==i&&"wss"!==i)throw new Error("invalid multiaddr: ".concat(e.toString()));if(!gb(t=e)||!t.protos().some((function(e){return e.resolvable})))return"http://".concat(r[2],":").concat(r[4]);if("ws"===i)return"http://".concat(r[2]).concat(null==a||"80"===a?"":":".concat(a));if("wss"===i)return"https://".concat(r[2]).concat(null==a||"443"===a?"":":".concat(a));throw new Error("invalid multiaddr: "+e.toString())}var kK=oq("libp2p:webrtc-star:listener"),xK={transports:["websocket"],path:"/socket.io-next/"},EK=function(e){ia(r,e);var t=ua(r);function r(e,n,i,a,s){var o;(0,hi.Z)(this,r),(o=t.call(this)).signallingAddr=n,o.socket=LV(e,xK),o.connections=[],o.channels=new Map,o.pendingSignals=new Map,o.upgrader=i,o.handler=a,o.channelOptions=s,o.handleWsHandshake=o.handleWsHandshake.bind(ra(o));var u=!1;return o.socket.on("connect_error",(function(e){u&&"TransportError"===e.type||o.dispatchEvent(new $V("error",{detail:e}))})),o.socket.on("error",(function(e){o.dispatchEvent(new $V("error",{detail:e}))})),o.socket.on("ws-handshake",o.handleWsHandshake),o.socket.on("ws-peer",(function(e){o.dispatchEvent(new $V("peer",{detail:e}))})),o.socket.on("connect",(function(){o.socket.emit("ss-join",o.signallingAddr.toString()),u&&o.dispatchEvent(new $V("reconnect"))})),o.socket.once("connect",(function(){u=!0,o.dispatchEvent(new $V("listening"))})),o.socket.on("disconnect",(function(){o.dispatchEvent(new $V("disconnect"))})),o}return(0,fi.Z)(r,[{key:"_createChannel",value:function(e,t,r){var n=this,i=(0,_e.Z)({},this.channelOptions),a=new oK(i),s=function(e){var t=e.detail;kK.error("incoming connection errored",t)};return a.addEventListener("error",s),a.addEventListener("close",(function(){a.removeEventListener("error",s)}),{once:!0}),a.addEventListener("signal",(function(i){var a=i.detail;n.socket.emit("ss-handshake",{intentId:e,srcMultiaddr:t,dstMultiaddr:r,answer:!0,signal:a})})),a.addEventListener("ready",(function(){var t=_K(a,{remoteAddr:n.signallingAddr});kK("new inbound connection %s",t.remoteAddr);try{n.upgrader.upgradeInbound(t).then((function(r){kK("inbound connection %s upgraded",t.remoteAddr),n.connections.push(t);a.addEventListener("close",(function(){n.connections=n.connections.filter((function(e){return e!==t})),n.channels.delete(e),n.pendingSignals.delete(e)}),{once:!0}),n.dispatchEvent(new $V("connection",{detail:r})),n.handler(r)})).catch((function(e){kK.error("inbound connection failed to upgrade",e),t.close().catch((function(e){kK.error("inbound connection failed to close after failing to upgrade",e)}))}))}catch(S$){kK.error("inbound connection failed to upgrade",S$),t.close().catch((function(e){kK.error("inbound connection failed to close after failing to upgrade",e)}))}}),{once:!0}),a}},{key:"handleWsHandshake",value:function(e){if(kK('incoming handshake. signal type "%s" is answer %s',e.signal.type,e.answer),!0!==e.answer&&null==e.err&&null!=e.intentId){var t=e.intentId,r=this.pendingSignals.get(t);null==r&&(r=[],this.pendingSignals.set(t,r)),r.push(e);var n=this.channels.get(t);if(null==n){if("offer"!==e.signal.type)return void kK("handshake is not an offer and channel does not exist, buffering until we receive an offer");kK("creating new channel to handle offer handshake"),n=this._createChannel(e.intentId,e.srcMultiaddr,e.dstMultiaddr),this.channels.set(t,n)}else kK("channel already exists, using it to handle handshake");for(;r.length>0;){var i=r.shift();null!=(null===i||void 0===i?void 0:i.signal)&&n.handleSignal(i.signal)}}}},{key:"close",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.socket.emit("ss-leave",this.signallingAddr.toString()),this.socket.removeAllListeners(),this.socket.close(),e.next=5,Promise.all([].concat(be(this.connections.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.close();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),be(Array.from(this.channels.values()).map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.close();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))));case 5:this.dispatchEvent(new $V("close"));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),r}(XV),SK=function(e){ia(r,e);var t=ua(r);function r(e,n,i,a,s){var o;return(0,hi.Z)(this,r),(o=t.call(this)).upgrader=e,o.handler=n,o.peerId=i,o.transport=a,o.options=s,o}return(0,fi.Z)(r,[{key:"listen",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s=this;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.listeningAddr){e.next=2;break}throw ji(new Error("listener already in use"),"ERR_ALREADY_LISTENING");case 2:return r=ts(),this.listeningAddr=t,n=t.protoCodes().includes(421)?t:t.encapsulate("/p2p/".concat(this.peerId.toString())),i=this.signallingUrl=wK(t),kK("connecting to signalling server on: %s",this.signallingUrl),(a=new EK(this.signallingUrl,n,this.upgrader,this.handler,this.options.channelOptions)).addEventListener("error",(function(e){var t=e.detail;kK("error connecting to signalling server %o",t),a.close().catch((function(e){kK.error("error closing server after error",e)})),r.reject(t)})),a.addEventListener("listening",(function(){kK("connected to signalling server"),s.dispatchEvent(new $V("listening")),r.resolve()})),a.addEventListener("peer",(function(e){s.transport.peerDiscovered(e.detail)})),a.addEventListener("connection",(function(e){var r=e.detail;if(null==r.remoteAddr)try{r.remoteAddr=t.decapsulateCode(421).encapsulate("/p2p/".concat(r.remotePeer.toString()))}catch(S$){kK.error("could not determine remote address",S$)}s.dispatchEvent(new $V("connection",{detail:r}))})),a.addEventListener("disconnect",(function(){s.transport.sigServers.delete(i)})),a.addEventListener("reconnect",(function(){s.transport.sigServers.set(i,a)})),this.transport.sigServers.set(this.signallingUrl,a),e.next=17,r.promise;case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"close",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.signallingUrl){e.next=6;break}if(null==(t=this.transport.sigServers.get(this.signallingUrl))){e.next=6;break}return e.next=5,t.close();case 5:this.transport.sigServers.delete(this.signallingUrl);case 6:this.dispatchEvent(new $V("close")),this.listeningAddr=void 0;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAddrs",value:function(){return null!=this.listeningAddr?[this.listeningAddr]:[]}}]),r}(XV);var CK=HW({prefix:"\0",name:"identity",encode:function(e){return t=e,(new TextDecoder).decode(t);var t},decode:function(e){return function(e){return(new TextEncoder).encode(e)}(e)}}),AK=qW({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),DK=qW({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),RK=WW({prefix:"9",name:"base10",alphabet:"0123456789"}),TK=qW({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),ZK=qW({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),IK=WW({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),PK=WW({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),LK=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),MK=LK.reduce((function(e,t,r){return e[r]=t,e}),[]),BK=LK.reduce((function(e,t,r){return e[t.codePointAt(0)]=r,e}),[]);var OK=HW({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce((function(e,t){return e+=MK[t]}),"")},decode:function(e){var t,r=[],n=(0,ge.Z)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=BK[i.codePointAt(0)];if(void 0===a)throw new Error("Non-base256emoji character: ".concat(i));r.push(a)}}catch(S$){n.e(S$)}finally{n.f()}return new Uint8Array(r)}}),NK=function e(t,r,n){r=r||[];var i=n=n||0;for(;t>=zK;)r[n++]=255&t|FK,t/=128;for(;t&UK;)r[n++]=255&t|FK,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},FK=128,UK=-128,zK=Math.pow(2,31);var jK=function e(t,r){var n,i=0,a=0,s=r=r||0,o=t.length;do{if(s>=o)throw e.bytes=0,new RangeError("Could not decode varint");n=t[s++],i+=a<28?(n&WK)<<a:(n&WK)*Math.pow(2,a),a+=7}while(n>=HK);return e.bytes=s-r,i},HK=128,WK=127;var qK,VK=Math.pow(2,7),KK=Math.pow(2,14),YK=Math.pow(2,21),GK=Math.pow(2,28),QK=Math.pow(2,35),XK=Math.pow(2,42),JK=Math.pow(2,49),$K=Math.pow(2,56),eY=Math.pow(2,63),tY={encode:NK,decode:jK,encodingLength:function(e){return e<VK?1:e<KK?2:e<YK?3:e<GK?4:e<QK?5:e<XK?6:e<JK?7:e<$K?8:e<eY?9:10}},rY=tY,nY=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[rY.decode(e,t),rY.decode.bytes]},iY=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return rY.encode(e,t,r),t},aY=function(e){return rY.encodingLength(e)},sY=function(e,t){var r=t.byteLength,n=aY(e),i=n+aY(r),a=new Uint8Array(i+r);return iY(e,a,0),iY(r,a,n),a.set(t,i),new uY(e,r,t,a)},oY=function(e){var t=OW(e),r=nY(t),n=(0,ke.Z)(r,2),i=n[0],a=n[1],s=nY(t.subarray(a)),o=(0,ke.Z)(s,2),u=o[0],c=o[1],l=t.subarray(a+c);if(l.byteLength!==u)throw new Error("Incorrect length");return new uY(i,u,l,t)},uY=(0,fi.Z)((function e(t,r,n,i){(0,hi.Z)(this,e),this.code=t,this.size=r,this.digest=n,this.bytes=i})),cY=function(e){var t=e.name,r=e.code,n=e.encode;return new lY(t,r,n)},lY=function(){function e(t,r,n){(0,hi.Z)(this,e),this.name=t,this.code=r,this.encode=n}return(0,fi.Z)(e,[{key:"digest",value:function(e){var t=this;if(e instanceof Uint8Array){var r=this.encode(e);return r instanceof Uint8Array?sY(this.code,r):r.then((function(e){return sY(t.code,e)}))}throw Error("Unknown type, must be binary type")}}]),e}(),hY=function(e){return function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(r){return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Uint8Array,t.next=3,crypto.subtle.digest(e,r);case 3:return t.t1=t.sent,t.abrupt("return",new t.t0(t.t1));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},fY=cY({name:"sha2-256",code:18,encode:hY("SHA-256")}),dY=cY({name:"sha2-512",code:19,encode:hY("SHA-512")}),pY=OW,vY={code:0,name:"identity",encode:pY,digest:function(e){return sY(0,pY(e))}},gY="raw",yY=85,mY=function(e){return OW(e)},bY=function(e){return OW(e)},_Y=new TextEncoder,wY=new TextDecoder,kY="json",xY=512,EY=function(e){return _Y.encode(JSON.stringify(e))},SY=function(e){return JSON.parse(wY.decode(e))},CY=function(e,t){var r=e.bytes;return 0===e.version?ZY(r,DY(e),t||VW.encoder):IY(r,DY(e),t||YW.encoder)},AY=new WeakMap,DY=function(e){var t=AY.get(e);if(null==t){var r=new Map;return AY.set(e,r),r}return t},RY=function(e,t){function r(e,t,n,i){(0,hi.Z)(this,r),this.code=t,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}return(0,fi.Z)(r,[{key:"asCID",get:function(){return this}},{key:"byteOffset",get:function(){return this.bytes.byteOffset}},{key:"byteLength",get:function(){return this.bytes.byteLength}},{key:"toV0",value:function(){switch(this.version){case 0:return this;case 1:var e=this.code,t=this.multihash;if(e!==PY)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==LY)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return r.createV0(t);default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}},{key:"toV1",value:function(){switch(this.version){case 0:var e=this.multihash,t=e.code,n=e.digest,i=sY(t,n);return r.createV1(this.code,i);case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}},{key:"equals",value:function(e){return r.equals(this,e)}},{key:"toString",value:function(e){return CY(this,e)}},{key:"toJSON",value:function(){return{"/":CY(this)}}},{key:"link",value:function(){return this}},{key:e,get:function(){return"CID"}},{key:t,value:function(){return"CID(".concat(this.toString(),")")}}],[{key:"equals",value:function(e,t){var r=t;return r&&e.code===r.code&&e.version===r.version&&function(e,t){if(e===t)return!0;var r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(var r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}(e.bytes,r.bytes)}(e.multihash,r.multihash)}},{key:"asCID",value:function(e){if(null==e)return null;var t=e;if(t instanceof r)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){var n=t.version,i=t.code,a=t.multihash;return new r(n,i,a,t.bytes||MY(n,i,a.bytes))}if(!0===t[BY]){var s=t.version,o=t.multihash,u=t.code,c=oY(o);return r.create(s,u,c)}return null}},{key:"create",value:function(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==PY)throw new Error("Version 0 CID must use dag-pb (code: ".concat(PY,") block encoding"));return new r(e,t,n,n.bytes);case 1:return new r(e,t,n,MY(e,t,n.bytes));default:throw new Error("Invalid version")}}},{key:"createV0",value:function(e){return r.create(0,PY,e)}},{key:"createV1",value:function(e,t){return r.create(1,e,t)}},{key:"decode",value:function(e){var t=r.decodeFirst(e),n=(0,ke.Z)(t,2),i=n[0];if(n[1].length)throw new Error("Incorrect length");return i}},{key:"decodeFirst",value:function(e){var t=r.inspectBytes(e),n=t.size-t.multihashSize,i=OW(e.subarray(n,n+t.multihashSize));if(i.byteLength!==t.multihashSize)throw new Error("Incorrect length");var a=i.subarray(t.multihashSize-t.digestSize),s=new uY(t.multihashCode,t.digestSize,a,i);return[0===t.version?r.createV0(s):r.createV1(t.codec,s),e.subarray(t.size)]}},{key:"inspectBytes",value:function(e){var t=0,r=function(){var r=nY(e.subarray(t)),n=(0,ke.Z)(r,2),i=n[0],a=n[1];return t+=a,i},n=r(),i=PY;if(18===n?(n=0,t=0):i=r(),0!==n&&1!==n)throw new RangeError("Invalid CID version ".concat(n));var a=t,s=r(),o=r(),u=t+o;return{version:n,codec:i,multihashCode:s,digestSize:o,multihashSize:u-a,size:u}}},{key:"parse",value:function(e,t){var n=TY(e,t),i=(0,ke.Z)(n,2),a=i[0],s=i[1],o=r.decode(s);if(0===o.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return DY(o).set(a,e),o}}]),r}(Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom")),TY=function(e,t){switch(e[0]){case"Q":var r=t||VW;return[VW.prefix,r.decode("".concat(VW.prefix).concat(e))];case VW.prefix:var n=t||VW;return[VW.prefix,n.decode(e)];case YW.prefix:var i=t||YW;return[YW.prefix,i.decode(e)];default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},ZY=function(e,t,r){var n=r.prefix;if(n!==VW.prefix)throw Error("Cannot string encode V0 in ".concat(r.name," encoding"));var i=t.get(n);if(null==i){var a=r.encode(e).slice(1);return t.set(n,a),a}return i},IY=function(e,t,r){var n=r.prefix,i=t.get(n);if(null==i){var a=r.encode(e);return t.set(n,a),a}return i},PY=112,LY=18,MY=function(e,t,r){var n=aY(e),i=n+aY(t),a=new Uint8Array(i+r.byteLength);return iY(e,a,0),iY(t,a,n),a.set(r,i),a},BY=Symbol.for("@ipld/js-cid/CID"),OY=(0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)((0,_e.Z)({},re),ne),ie),ae),se),$),oe),J),ee),ue),NY=((0,_e.Z)((0,_e.Z)({},ce),le),Symbol.for("nodejs.util.inspect.custom")),FY=Object.values(OY).map((function(e){return e.decoder})).reduce((function(e,t){return e.or(t)}),OY.identity.decoder),UY=114,zY=36,jY=37;qK=Symbol.toStringTag;var HY=function(){function e(t){(0,hi.Z)(this,e),(0,we.Z)(this,"type",void 0),(0,we.Z)(this,"multihash",void 0),(0,we.Z)(this,"privateKey",void 0),(0,we.Z)(this,"publicKey",void 0),(0,we.Z)(this,"string",void 0),(0,we.Z)(this,DU,!0),this.type=t.type,this.multihash=t.multihash,this.privateKey=t.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}return(0,fi.Z)(e,[{key:qK,get:function(){return"PeerId(".concat(this.toString(),")")}},{key:"toString",value:function(){return null==this.string&&(this.string=VW.encode(this.multihash.bytes).slice(1)),this.string}},{key:"toCID",value:function(){return RY.createV1(UY,this.multihash)}},{key:"toBytes",value:function(){return this.multihash.bytes}},{key:"toJSON",value:function(){return this.toString()}},{key:"equals",value:function(e){var t;if(e instanceof Uint8Array)return Ao(this.multihash.bytes,e);if("string"===typeof e)return KY(e).equals(this);if(null!=(null===e||void 0===e||null===(t=e.multihash)||void 0===t?void 0:t.bytes))return Ao(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}},{key:NY,value:function(){return"PeerId(".concat(this.toString(),")")}}]),e}(),WY=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),n=t.call(this,(0,_e.Z)((0,_e.Z)({},e),{},{type:"RSA"})),(0,we.Z)(ra(n),"type","RSA"),(0,we.Z)(ra(n),"publicKey",void 0),n.publicKey=e.publicKey,n}return(0,fi.Z)(r)}(HY),qY=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),n=t.call(this,(0,_e.Z)((0,_e.Z)({},e),{},{type:"Ed25519"})),(0,we.Z)(ra(n),"type","Ed25519"),(0,we.Z)(ra(n),"publicKey",void 0),n.publicKey=e.multihash.digest,n}return(0,fi.Z)(r)}(HY),VY=function(e){ia(r,e);var t=ua(r);function r(e){var n;return(0,hi.Z)(this,r),n=t.call(this,(0,_e.Z)((0,_e.Z)({},e),{},{type:"secp256k1"})),(0,we.Z)(ra(n),"type","secp256k1"),(0,we.Z)(ra(n),"publicKey",void 0),n.publicKey=e.multihash.digest,n}return(0,fi.Z)(r)}(HY);function KY(e,t){var r;if(t=null!==(r=t)&&void 0!==r?r:FY,"1"===e.charAt(0)||"Q"===e.charAt(0)){var n=oY(VW.decode("z".concat(e)));return e.startsWith("12D")?new qY({multihash:n}):e.startsWith("16U")?new VY({multihash:n}):new WY({multihash:n})}return function(e){try{var t=oY(e);if(t.code===vY.code){if(t.digest.length===zY)return new qY({multihash:t});if(t.digest.length===jY)return new VY({multihash:t})}if(t.code===fY.code)return new WY({multihash:t})}catch(r){return function(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==UY)throw new Error("Supplied PeerID CID is invalid");var t=e.multihash;if(t.code===fY.code)return new WY({multihash:e.multihash});if(t.code===vY.code){if(t.digest.length===zY)return new qY({multihash:e.multihash});if(t.digest.length===jY)return new VY({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}(RY.decode(e))}throw new Error("Supplied PeerID CID is invalid")}(FY.decode(e))}var YY,GY=Symbol.for("@libp2p/transport");!function(e){e[e.FATAL_ALL=0]="FATAL_ALL",e[e.NO_FATAL=1]="NO_FATAL"}(YY||(YY={}));Symbol.for("@libp2p/peer-discovery");var QY=Symbol.for("@libp2p/peer-discovery");var XY,JY="RTCPeerConnection"in globalThis,$Y=oq("libp2p:webrtc-star"),eG=function(){},tG=function(e,t){ia(n,e);var r=ua(n);function n(){var e;return(0,hi.Z)(this,n),(e=r.apply(this,arguments)).started=!1,e}return(0,fi.Z)(n,[{key:QY,get:function(){return!0}},{key:t,get:function(){return"@libp2p/webrtc-star-discovery"}},{key:"isStarted",value:function(){return this.started}},{key:"start",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.started=!0;case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.started=!1;case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispatchEvent",value:function(e){return!!this.isStarted()&&yo(aa(n.prototype),"dispatchEvent",this).call(this,e)}}]),n}(XV,Symbol.toStringTag);Symbol.toStringTag;!function(e){var t;e.codec=function(){return null==t&&(t=Xo((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==r.lengthDelimited&&t.fork(),null!=e.publicKey&&e.publicKey.byteLength>0&&(t.uint32(10),t.bytes(e.publicKey)),null!=e.addrs){var n,i=(0,ge.Z)(e.addrs);try{for(i.s();!(n=i.n()).done;){var a=n.value;t.uint32(18),t.bytes(a)}}catch(S$){i.e(S$)}finally{i.f()}}!1!==r.lengthDelimited&&t.ldelim()}),(function(e,t){for(var r={publicKey:new Uint8Array(0),addrs:[]},n=null==t?e.len:e.pos+t;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.publicKey=e.bytes();break;case 2:r.addrs.push(e.bytes());break;default:e.skipType(7&i)}}return r}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(XY||(XY={}));zi("libp2p:discovery:pubsub");Symbol.toStringTag;function rG(e){return{addresses:{listen:["/webrtc","/wss","/ws"]},transports:[OZ({filter:ZZ}),aZ(),iZ(),YZ(),tP({discoverRelays:3})],streamMuxers:[xC(),ZR()],connectionGater:{denyDialMultiaddr:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},connectionEncryption:[qS()],connectionManager:{maxConnections:15,minConnections:2},peerDiscovery:[iA({list:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dnsaddr/node-1.ingress.cloudflare-ipfs.com/p2p/QmcFf2FH3CEgTNHeMRGhN7HNHU1EXAxoEk6EFuSyXCsvRE","/dns4/hoverboard-staging.dag.haus/tcp/443/wss/p2p/Qmc5vg9zuLYvDR1wtYHCaxjBHenfCNautRwCjG3n5v5fbs",e]})],contentRouters:[fA("https://cid.contact"),WP(LW({protocol:"https",port:443,host:"node0.delegate.ipfs.io"}))],relay:{enabled:!0,hop:{enabled:!0}},services:{identify:SP(),autoNAT:bI(),pubsub:kE({enabled:!0,allowPublishToZeroPeers:!0,emitSelf:!0}),dht:uR({clientMode:!0,validators:{ipns:pI},selectors:{ipns:lI}}),ping:DP()}}}var nG=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t=Number(t),null!=e[Symbol.asyncIterator]?ea((0,ii.Z)().mark((function r(){var n,i,a,s,o,u,c;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=[],t<1&&(t=1),t===Math.round(t)){r.next=4;break}throw new Error("Batch size must be an integer");case 4:i=!1,a=!1,r.prev=6,o=ui(e);case 8:return r.next=10,Ji(o.next());case 10:if(!(i=!(u=r.sent).done)){r.next=22;break}c=u.value,n.push(c);case 13:if(!(n.length>=t)){r.next=19;break}return r.next=16,n.slice(0,t);case 16:n=n.slice(t),r.next=13;break;case 19:i=!1,r.next=8;break;case 22:r.next=28;break;case 24:r.prev=24,r.t0=r.catch(6),a=!0,s=r.t0;case 28:if(r.prev=28,r.prev=29,!i||null==o.return){r.next=33;break}return r.next=33,Ji(o.return());case 33:if(r.prev=33,!a){r.next=36;break}throw s;case 36:return r.finish(33);case 37:return r.finish(28);case 38:if(!(n.length>0)){r.next=44;break}return r.next=41,n.slice(0,t);case 41:n=n.slice(t),r.next=38;break;case 44:case"end":return r.stop()}}),r,null,[[6,24,28,38],[29,,33,37]])})))():(0,ii.Z)().mark((function r(){var n,i,a,s;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=[],t<1&&(t=1),t===Math.round(t)){r.next=4;break}throw new Error("Batch size must be an integer");case 4:i=(0,ge.Z)(e),r.prev=5,i.s();case 7:if((a=i.n()).done){r.next=18;break}s=a.value,n.push(s);case 10:if(!(n.length>=t)){r.next=16;break}return r.next=13,n.slice(0,t);case 13:n=n.slice(t),r.next=10;break;case 16:r.next=7;break;case 18:r.next=23;break;case 20:r.prev=20,r.t0=r.catch(5),i.e(r.t0);case 23:return r.prev=23,i.f(),r.finish(23);case 26:if(!(n.length>0)){r.next=32;break}return r.next=29,n.slice(0,t);case 29:n=n.slice(t),r.next=26;break;case 32:case"end":return r.stop()}}),r,null,[[5,20,23,26]])}))()};function iG(e){return aG.apply(this,arguments)}function aG(){return aG=ea((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,ii.Z)().mark((function r(){var n,i,a,s,o,u,c,l,h;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=!1,i=!1,r.prev=2,s=ui(nG(e,t));case 4:return r.next=6,Ji(s.next());case 6:if(!(n=!(o=r.sent).done)){r.next=26;break}u=o.value,c=u.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t().then((function(e){return{ok:!0,value:e}}),(function(e){return{ok:!1,err:e}})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),l=0;case 10:if(!(l<c.length)){r.next=23;break}return r.next=13,Ji(c[l]);case 13:if(!(h=r.sent).ok){r.next=19;break}return r.next=17,h.value;case 17:r.next=20;break;case 19:throw h.err;case 20:l++,r.next=10;break;case 23:n=!1,r.next=4;break;case 26:r.next=32;break;case 28:r.prev=28,r.t0=r.catch(2),i=!0,a=r.t0;case 32:if(r.prev=32,r.prev=33,!n||null==s.return){r.next=37;break}return r.next=37,Ji(s.return());case 37:if(r.prev=37,!i){r.next=40;break}throw a;case 40:return r.finish(37);case 41:return r.finish(32);case 42:case"end":return r.stop()}}),r,null,[[2,28,32,42],[33,,37,41]])}))()})),aG.apply(this,arguments)}var sG,oG,uG,cG=function(){var e,t=null!==(e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).chunkSize)&&void 0!==e?e:262144;return function(){var e=ea((0,ii.Z)().mark((function e(r){var n,i,a,s,o,u,c,l,h,f;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=new Du,i=0,a=!1,s=!1,o=!1,e.prev=5,c=ui(r);case 7:return e.next=9,Ji(c.next());case 9:if(!(s=!(l=e.sent).done)){e.next=23;break}h=l.value,n.append(h),i+=h.length;case 13:if(!(i>=t)){e.next=20;break}return e.next=16,n.slice(0,t);case 16:a=!0,t===n.length?(n=new Du,i=0):((f=new Du).append(n.sublist(t)),n=f,i-=t),e.next=13;break;case 20:s=!1,e.next=7;break;case 23:e.next=29;break;case 25:e.prev=25,e.t0=e.catch(5),o=!0,u=e.t0;case 29:if(e.prev=29,e.prev=30,!s||null==c.return){e.next=34;break}return e.next=34,Ji(c.return());case 34:if(e.prev=34,!o){e.next=37;break}throw u;case 37:return e.finish(34);case 38:return e.finish(29);case 39:if(a&&!(i>0)){e.next=42;break}return e.next=42,n.subarray(0,i);case 42:case"end":return e.stop()}}),e,null,[[5,25,29,39],[30,,34,38]])})));return function(t){return e.apply(this,arguments)}}()};!function(e){var t,r;!function(e){e.Raw="Raw",e.Directory="Directory",e.File="File",e.Metadata="Metadata",e.Symlink="Symlink",e.HAMTShard="HAMTShard"}(e.DataType||(e.DataType={})),function(e){e[e.Raw=0]="Raw",e[e.Directory=1]="Directory",e[e.File=2]="File",e[e.Metadata=3]="Metadata",e[e.Symlink=4]="Symlink",e[e.HAMTShard=5]="HAMTShard"}(t||(t={})),function(e){e.codec=function(){return Qo(t)}}(e.DataType||(e.DataType={})),e.codec=function(){return null==r&&(r=Xo((function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&r.fork(),null!=t.Type&&(r.uint32(8),e.DataType.codec().encode(t.Type,r)),null!=t.Data&&(r.uint32(18),r.bytes(t.Data)),null!=t.filesize&&(r.uint32(24),r.uint64(t.filesize)),null!=t.blocksizes){var i,a=(0,ge.Z)(t.blocksizes);try{for(a.s();!(i=a.n()).done;){var s=i.value;r.uint32(32),r.uint64(s)}}catch(S$){a.e(S$)}finally{a.f()}}null!=t.hashType&&(r.uint32(40),r.uint64(t.hashType)),null!=t.fanout&&(r.uint32(48),r.uint64(t.fanout)),null!=t.mode&&(r.uint32(56),r.uint32(t.mode)),null!=t.mtime&&(r.uint32(66),oG.codec().encode(t.mtime,r)),!1!==n.lengthDelimited&&r.ldelim()}),(function(t,r){for(var n={blocksizes:[]},i=null==r?t.len:t.pos+r;t.pos<i;){var a=t.uint32();switch(a>>>3){case 1:n.Type=e.DataType.codec().decode(t);break;case 2:n.Data=t.bytes();break;case 3:n.filesize=t.uint64();break;case 4:n.blocksizes.push(t.uint64());break;case 5:n.hashType=t.uint64();break;case 6:n.fanout=t.uint64();break;case 7:n.mode=t.uint32();break;case 8:n.mtime=oG.codec().decode(t,t.uint32());break;default:t.skipType(7&a)}}return n}))),r},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(sG||(sG={})),function(e){var t;e.codec=function(){return null==t&&(t=Xo((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&t.fork(),null!=e.Seconds&&(t.uint32(8),t.int64(e.Seconds)),null!=e.FractionalNanoseconds&&(t.uint32(21),t.fixed32(e.FractionalNanoseconds)),!1!==r.lengthDelimited&&t.ldelim()}),(function(e,t){for(var r={},n=null==t?e.len:e.pos+t;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.Seconds=e.int64();break;case 2:r.FractionalNanoseconds=e.fixed32();break;default:e.skipType(7&i)}}return r}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(oG||(oG={})),function(e){var t;e.codec=function(){return null==t&&(t=Xo((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==r.lengthDelimited&&t.fork(),null!=e.MimeType&&(t.uint32(10),t.string(e.MimeType)),!1!==r.lengthDelimited&&t.ldelim()}),(function(e,t){for(var r={},n=null==t?e.len:e.pos+t;e.pos<n;){var i=e.uint32();if(i>>>3===1)r.MimeType=e.string();else e.skipType(7&i)}return r}))),t},e.encode=function(t){return Yo(t,e.codec())},e.decode=function(t){return Ko(t,e.codec())}}(uG||(uG={}));var lG={Raw:"raw",Directory:"directory",File:"file",Metadata:"metadata",Symlink:"symlink",HAMTShard:"hamt-sharded-directory"},hG=["directory","hamt-sharded-directory"],fG=parseInt("0644",8),dG=parseInt("0755",8),pG=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"file"};(0,hi.Z)(this,e),(0,we.Z)(this,"type",void 0),(0,we.Z)(this,"data",void 0),(0,we.Z)(this,"blockSizes",void 0),(0,we.Z)(this,"hashType",void 0),(0,we.Z)(this,"fanout",void 0),(0,we.Z)(this,"mtime",void 0),(0,we.Z)(this,"_mode",void 0),(0,we.Z)(this,"_originalMode",void 0);var r=t.type,n=t.data,i=t.blockSizes,a=t.hashType,s=t.fanout,o=t.mtime,u=t.mode;if(null!=r&&!Object.values(lG).includes(r))throw ji(new Error("Type: "+r+" is not valid"),"ERR_INVALID_TYPE");this.type=null!==r&&void 0!==r?r:"file",this.data=n,this.hashType=a,this.fanout=s,this.blockSizes=null!==i&&void 0!==i?i:[],this._originalMode=0,this.mode=u,this.mtime=o}return(0,fi.Z)(e,[{key:"mode",get:function(){return this._mode},set:function(e){this._mode=null==e?this.isDirectory()?dG:fG:4095&e}},{key:"isDirectory",value:function(){return hG.includes(this.type)}},{key:"addBlockSize",value:function(e){this.blockSizes.push(e)}},{key:"removeBlockSize",value:function(e){this.blockSizes.splice(e,1)}},{key:"fileSize",value:function(){if(this.isDirectory())return 0n;var e=0n;return this.blockSizes.forEach((function(t){e+=t})),null!=this.data&&(e+=BigInt(this.data.length)),e}},{key:"marshal",value:function(){var e;switch(this.type){case"raw":e=sG.DataType.Raw;break;case"directory":e=sG.DataType.Directory;break;case"file":e=sG.DataType.File;break;case"metadata":e=sG.DataType.Metadata;break;case"symlink":e=sG.DataType.Symlink;break;case"hamt-sharded-directory":e=sG.DataType.HAMTShard;break;default:throw ji(new Error("Type: ".concat(e," is not valid")),"ERR_INVALID_TYPE")}var t,r,n,i=this.data;(null!=this.data&&0!==this.data.length||(i=void 0),null!=this.mode)&&((t=4294963200&this._originalMode|(null!==(r=this.mode)&&void 0!==r?r:0))!==fG||this.isDirectory()||(t=void 0),t===dG&&this.isDirectory()&&(t=void 0));return null!=this.mtime&&(n={Seconds:this.mtime.secs,FractionalNanoseconds:this.mtime.nsecs}),sG.encode({Type:e,Data:i,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:t,mtime:n})}}],[{key:"unmarshal",value:function(t){var r,n,i=sG.decode(t),a=new e({type:lG[null!=i.Type?i.Type.toString():"File"],data:i.Data,blockSizes:i.blocksizes,mode:i.mode,mtime:null!=i.mtime?{secs:null!==(r=i.mtime.Seconds)&&void 0!==r?r:0n,nsecs:i.mtime.FractionalNanoseconds}:void 0,fanout:i.fanout});return a._originalMode=null!==(n=i.mode)&&void 0!==n?n:0,a}}]),e}(),vG=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==n.codec&&(n.codec=m),e.next=3,Ps.digest(t);case 3:return i=e.sent,a=Ba.create(n.cidVersion,n.codec.code,i),e.next=7,r.put(a,t,n);case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}();function gG(e){return function(){var t=ea((0,ii.Z)().mark((function t(r,n){var a,s,o,u,c,l,h;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=0n,s=!1,o=!1,t.prev=3,c=(0,ii.Z)().mark((function t(){var s;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=h.value,t.next=3,(0,ai.Z)((0,ii.Z)().mark((function t(){var o,u,c,l;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c={codec:m,cidVersion:e.cidVersion,onProgress:e.onProgress},e.rawLeaves?(c.codec=i,c.cidVersion=1):(u=new pG({type:e.leafType,data:s}),s=Pf({Data:u.marshal(),Links:[]})),t.next=4,vG(s,n,c);case 4:return l=t.sent,a+=BigInt(s.byteLength),null===(o=e.onProgress)||void 0===o||o.call(e,new Ou("unixfs:importer:progress:file:write",{bytesWritten:a,cid:l,path:r.path})),t.abrupt("return",{cid:l,unixfs:u,size:BigInt(s.length),block:s});case 8:case"end":return t.stop()}}),t)})));case 3:case"end":return t.stop()}}),t)})),l=ui(r.content);case 6:return t.next=8,Ji(l.next());case 8:if(!(s=!(h=t.sent).done)){t.next=13;break}return t.delegateYield(c(),"t0",10);case 10:s=!1,t.next=6;break;case 13:t.next=19;break;case 15:t.prev=15,t.t1=t.catch(3),o=!0,u=t.t1;case 19:if(t.prev=19,t.prev=20,!s||null==l.return){t.next=24;break}return t.next=24,Ji(l.return());case 24:if(t.prev=24,!o){t.next=27;break}throw u;case 27:return t.finish(24);case 28:return t.finish(19);case 29:case"end":return t.stop()}}),t,null,[[3,15,19,29],[20,,24,28]])})));return function(e,r){return t.apply(this,arguments)}}()}var yG=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a,s,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new pG({type:"directory",mtime:t.mtime,mode:t.mode}),a=Pf(Af({Data:i.marshal()})),e.next=4,vG(a,r,n);case 4:return s=e.sent,o=t.path,e.abrupt("return",{cid:s,path:o,unixfs:i,size:BigInt(a.length),originalPath:t.originalPath,block:a});case 7:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}();function mG(e,t,r){return bG.apply(this,arguments)}function bG(){return bG=ea((0,ii.Z)().mark((function e(t,r,n){var i,a,s,o,u,c,l,h;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=-1,s=!1,o=!1,e.prev=3,c=ui(iG(n.bufferImporter(t,r),n.blockWriteConcurrency));case 5:return e.next=7,Ji(c.next());case 7:if(!(s=!(l=e.sent).done)){e.next=24;break}if(h=l.value,0!==++i){e.next=15;break}return a=(0,_e.Z)((0,_e.Z)({},h),{},{single:!0}),e.abrupt("continue",21);case 15:if(1!==i||null==a){e.next=19;break}return e.next=18,(0,_e.Z)((0,_e.Z)({},a),{},{block:void 0,single:void 0});case 18:a=void 0;case 19:return e.next=21,(0,_e.Z)((0,_e.Z)({},h),{},{block:void 0});case 21:s=!1,e.next=5;break;case 24:e.next=30;break;case 26:e.prev=26,e.t0=e.catch(3),o=!0,u=e.t0;case 30:if(e.prev=30,e.prev=31,!s||null==c.return){e.next=35;break}return e.next=35,Ji(c.return());case 35:if(e.prev=35,!o){e.next=38;break}throw u;case 38:return e.finish(35);case 39:return e.finish(30);case 40:if(null==a){e.next=43;break}return e.next=43,a;case 43:case"end":return e.stop()}}),e,null,[[3,26,30,40],[31,,35,39]])}))),bG.apply(this,arguments)}function _G(e){return!0===e.single}var wG=function(e,t,r){var n=function(){var n=(0,ai.Z)((0,ii.Z)().mark((function n(i){var a,s,o,u,c,l,h,f,d;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(1!==i.length||!_G(i[0])||!r.reduceSingleLeafToSelf){n.next=13;break}if(o=i[0],o.block,!_G(o)||void 0===e.mtime&&void 0===e.mode){n.next=11;break}return o.unixfs=new pG({type:"file",mtime:e.mtime,mode:e.mode,data:o.block}),u={Data:o.unixfs.marshal(),Links:[]},o.block=Pf(Af(u)),n.next=9,vG(o.block,t,(0,_e.Z)((0,_e.Z)({},r),{},{cidVersion:r.cidVersion}));case 9:o.cid=n.sent,o.size=BigInt(o.block.length);case 11:return null===(s=r.onProgress)||void 0===s||s.call(r,new Ou("unixfs:importer:progress:file:layout",{cid:o.cid,path:o.originalPath})),n.abrupt("return",{cid:o.cid,path:e.path,unixfs:o.unixfs,size:o.size,originalPath:o.originalPath});case 13:return c=new pG({type:"file",mtime:e.mtime,mode:e.mode}),l=i.filter((function(e){var t;return e.cid.code===qa&&e.size>0||(null!=e.unixfs&&null==e.unixfs.data&&e.unixfs.fileSize()>0n||Boolean(null===(t=e.unixfs)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.length))})).map((function(e){if(e.cid.code===qa)return c.addBlockSize(e.size),{Name:"",Tsize:Number(e.size),Hash:e.cid};var t,r;null==e.unixfs||null==e.unixfs.data?c.addBlockSize(null!==(t=null===(r=e.unixfs)||void 0===r?void 0:r.fileSize())&&void 0!==t?t:0n):c.addBlockSize(BigInt(e.unixfs.data.length));return{Name:"",Tsize:Number(e.size),Hash:e.cid}})),h={Data:c.marshal(),Links:l},f=Pf(Af(h)),n.next=19,vG(f,t,r);case 19:return d=n.sent,null===(a=r.onProgress)||void 0===a||a.call(r,new Ou("unixfs:importer:progress:file:layout",{cid:d,path:e.originalPath})),n.abrupt("return",{cid:d,path:e.path,unixfs:c,size:BigInt(f.length+h.Links.reduce((function(e,t){var r;return e+(null!==(r=t.Tsize)&&void 0!==r?r:0)}),0)),originalPath:e.originalPath,block:f});case 22:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return n},kG=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.layout(mG(t,r,n),wG(t,r,n)));case 1:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}();function xG(e){try{if(e instanceof Uint8Array)return ea((0,ii.Z)().mark((function t(){return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e;case 2:case"end":return t.stop()}}),t)})))();if(t=e,Symbol.iterator in t)return ea((0,ii.Z)().mark((function t(){return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(Xa(ui(e)),"t0",1);case 1:case"end":return t.stop()}}),t)})))();if(function(e){return Symbol.asyncIterator in e}(e))return e}catch(r){throw ji(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}var t;throw ji(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}function EG(e){return function(){var t=ea((0,ii.Z)().mark((function t(r,n){var i,a,s,o,u,c;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=!1,a=!1,t.prev=2,o=(0,ii.Z)().mark((function t(){var r,i,a,s;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(r=c.value).path&&(i=r.path,r.path=r.path.split("/").filter((function(e){return null!=e&&"."!==e})).join("/")),!SG(r)){t.next=8;break}return a={path:r.path,mtime:r.mtime,mode:r.mode,content:ea((0,ii.Z)().mark((function t(){var n,i,a,s,o,u,c,l,h;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=0n,i=!1,a=!1,t.prev=3,o=ui(e.chunker(e.chunkValidator(xG(r.content))));case 5:return t.next=7,Ji(o.next());case 7:if(!(i=!(u=t.sent).done)){t.next=17;break}return c=u.value,h=BigInt(c.byteLength),n+=h,null===(l=e.onProgress)||void 0===l||l.call(e,new Ou("unixfs:importer:progress:file:read",{bytesRead:n,chunkSize:h,path:r.path})),t.next=14,c;case 14:i=!1,t.next=5;break;case 17:t.next=23;break;case 19:t.prev=19,t.t0=t.catch(3),a=!0,s=t.t0;case 23:if(t.prev=23,t.prev=24,!i||null==o.return){t.next=28;break}return t.next=28,Ji(o.return());case 28:if(t.prev=28,!a){t.next=31;break}throw s;case 31:return t.finish(28);case 32:return t.finish(23);case 33:case"end":return t.stop()}}),t,null,[[3,19,23,33],[24,,28,32]])})))(),originalPath:i},t.next=6,(0,ai.Z)((0,ii.Z)().mark((function t(){return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",kG(a,n,e));case 1:case"end":return t.stop()}}),t)})));case 6:case 12:t.next=15;break;case 8:if(null==r.path){t.next=14;break}return s={path:r.path,mtime:r.mtime,mode:r.mode,originalPath:i},t.next=12,(0,ai.Z)((0,ii.Z)().mark((function t(){return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",yG(s,n,e));case 1:case"end":return t.stop()}}),t)})));case 14:throw new Error("Import candidate must have content or path or both");case 15:case"end":return t.stop()}}),t)})),u=ui(r);case 5:return t.next=7,Ji(u.next());case 7:if(!(i=!(c=t.sent).done)){t.next=12;break}return t.delegateYield(o(),"t0",9);case 9:i=!1,t.next=5;break;case 12:t.next=18;break;case 14:t.prev=14,t.t1=t.catch(2),a=!0,s=t.t1;case 18:if(t.prev=18,t.prev=19,!i||null==u.return){t.next=23;break}return t.next=23,Ji(u.return());case 23:if(t.prev=23,!a){t.next=26;break}throw s;case 26:return t.finish(23);case 27:return t.finish(18);case 28:case"end":return t.stop()}}),t,null,[[2,14,18,28],[19,,23,27]])})));return function(e,r){return t.apply(this,arguments)}}()}function SG(e){return null!=e.content}var CG=function(){return function(){var e=ea((0,ii.Z)().mark((function e(t){var r,n,i,a,s,o;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!1,n=!1,e.prev=2,a=ui(t);case 4:return e.next=6,Ji(a.next());case 6:if(!(r=!(s=e.sent).done)){e.next=29;break}if(void 0!==(o=s.value).length){e.next=10;break}throw ji(new Error("Content was invalid"),"ERR_INVALID_CONTENT");case 10:if(!("string"===typeof o||o instanceof String)){e.next=15;break}return e.next=13,Hs(o.toString());case 13:e.next=26;break;case 15:if(!Array.isArray(o)){e.next=20;break}return e.next=18,Uint8Array.from(o);case 18:e.next=26;break;case 20:if(!(o instanceof Uint8Array)){e.next=25;break}return e.next=23,o;case 23:e.next=26;break;case 25:throw ji(new Error("Content was invalid"),"ERR_INVALID_CONTENT");case 26:r=!1,e.next=4;break;case 29:e.next=35;break;case 31:e.prev=31,e.t0=e.catch(2),n=!0,i=e.t0;case 35:if(e.prev=35,e.prev=36,!r||null==a.return){e.next=40;break}return e.next=40,Ji(a.return());case 40:if(e.prev=40,!n){e.next=43;break}throw i;case 43:return e.finish(40);case 44:return e.finish(35);case 45:case"end":return e.stop()}}),e,null,[[2,31,35,45],[36,,40,44]])})));return function(t){return e.apply(this,arguments)}}()},AG=174;function DG(e){var t,r=null!==(t=null===e||void 0===e?void 0:e.maxChildrenPerNode)&&void 0!==t?t:AG;return function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(n,i){var a,s,o,u,c,l,h;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],s=!1,o=!1,e.prev=3,c=ui(nG(n,r));case 5:return e.next=7,c.next();case 7:if(!(s=!(l=e.sent).done)){e.next=17;break}return h=l.value,e.t0=a,e.next=12,i(h);case 12:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 14:s=!1,e.next=5;break;case 17:e.next=23;break;case 19:e.prev=19,e.t2=e.catch(3),o=!0,u=e.t2;case 23:if(e.prev=23,e.prev=24,!s||null==c.return){e.next=28;break}return e.next=28,c.return();case 28:if(e.prev=28,!o){e.next=31;break}throw u;case 31:return e.finish(28);case 32:return e.finish(23);case 33:if(!(a.length>1)){e.next=35;break}return e.abrupt("return",t(a,i));case 35:return e.abrupt("return",a[0]);case 36:case"end":return e.stop()}}),e,null,[[3,19,23,33],[24,,28,32]])})));function t(t,r){return e.apply(this,arguments)}return t}()}var RG=(0,fi.Z)((function e(t,r){(0,hi.Z)(this,e),(0,we.Z)(this,"options",void 0),(0,we.Z)(this,"root",void 0),(0,we.Z)(this,"dir",void 0),(0,we.Z)(this,"path",void 0),(0,we.Z)(this,"dirty",void 0),(0,we.Z)(this,"flat",void 0),(0,we.Z)(this,"parent",void 0),(0,we.Z)(this,"parentKey",void 0),(0,we.Z)(this,"unixfs",void 0),(0,we.Z)(this,"mode",void 0),(0,we.Z)(this,"mtime",void 0),(0,we.Z)(this,"cid",void 0),(0,we.Z)(this,"size",void 0),(0,we.Z)(this,"nodeSize",void 0),this.options=null!==r&&void 0!==r?r:{},this.root=t.root,this.dir=t.dir,this.path=t.path,this.dirty=t.dirty,this.flat=t.flat,this.parent=t.parent,this.parentKey=t.parentKey,this.unixfs=t.unixfs,this.mode=t.mode,this.mtime=t.mtime})),TG=Ba.parse("QmUNLLsPACCz1vLxQVkXqqLX5R1X345qqfHbsf67hvA3Nn"),ZG=Ba.parse("zdj7WbTaiJT1fgatdet9Ei9iDB5hdCxkbVyhyh8YTUnXMiwYi"),IG=function(e){ia(r,e);var t=ua(r);function r(e,n){var i;return(0,hi.Z)(this,r),i=t.call(this,e,n),(0,we.Z)(ra(i),"_children",void 0),i._children=new Map,i}return(0,fi.Z)(r,[{key:"put",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.cid=void 0,this.size=void 0,this.nodeSize=void 0,this._children.set(t,r);case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve(this._children.get(t)));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"childCount",value:function(){return this._children.size}},{key:"directChildrenCount",value:function(){return this.childCount()}},{key:"onlyChild",value:function(){return this._children.values().next().value}},{key:"eachChildSeries",value:function(){var e=this;return ea((0,ii.Z)().mark((function t(){var r,n,i,a,s;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=(0,ge.Z)(e._children.entries()),t.prev=1,r.s();case 3:if((n=r.n()).done){t.next=9;break}return i=(0,ke.Z)(n.value,2),a=i[0],s=i[1],t.next=7,{key:a,child:s};case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),r.e(t.t0);case 14:return t.prev=14,r.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[1,11,14,17]])})))()}},{key:"estimateNodeSize",value:function(){if(void 0!==this.nodeSize)return this.nodeSize;this.nodeSize=0;var e,t=(0,ge.Z)(this._children.entries());try{for(t.s();!(e=t.n()).done;){var r=(0,ke.Z)(e.value,2),n=r[0],i=r[1];null!=i.size&&null!=i.cid&&(this.nodeSize+=n.length+(1===this.options.cidVersion?ZG.bytes.byteLength:TG.bytes.byteLength))}}catch(S$){t.e(S$)}finally{t.f()}return this.nodeSize}},{key:"flush",value:function(e){var t=this;return ea((0,ii.Z)().mark((function r(){var n,i,a,s,o,u,c,l,h,f,d,p,v,g,y,m,b,_;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=[],i=(0,ge.Z)(t._children.entries()),r.prev=2,i.s();case 4:if((a=i.n()).done){r.next=41;break}if(s=(0,ke.Z)(a.value,2),o=s[0],u=s[1],c=u,!(u instanceof RG)){r.next=38;break}l=!1,h=!1,r.prev=10,d=ui(u.flush(e));case 12:return r.next=14,Ji(d.next());case 14:if(!(l=!(p=r.sent).done)){r.next=22;break}return v=p.value,c=v,r.next=19,v;case 19:l=!1,r.next=12;break;case 22:r.next=28;break;case 24:r.prev=24,r.t0=r.catch(10),h=!0,f=r.t0;case 28:if(r.prev=28,r.prev=29,!l||null==d.return){r.next=33;break}return r.next=33,Ji(d.return());case 33:if(r.prev=33,!h){r.next=36;break}throw f;case 36:return r.finish(33);case 37:return r.finish(28);case 38:null!=c.size&&null!=c.cid&&n.push({Name:o,Tsize:Number(c.size),Hash:c.cid});case 39:r.next=4;break;case 41:r.next=46;break;case 43:r.prev=43,r.t1=r.catch(2),i.e(r.t1);case 46:return r.prev=46,i.f(),r.finish(46);case 49:return g=new pG({type:"directory",mtime:t.mtime,mode:t.mode}),y={Data:g.marshal(),Links:n},m=Pf(Af(y)),r.next=54,Ji(vG(m,e,t.options));case 54:return b=r.sent,_=m.length+y.Links.reduce((function(e,t){return e+(null==t.Tsize?0:t.Tsize)}),0),t.cid=b,t.size=_,r.next=60,{cid:b,unixfs:g,path:t.path,size:BigInt(_)};case 60:case"end":return r.stop()}}),r,null,[[2,43,46,49],[10,24,28,38],[29,,33,37]])})))()}}]),r}(RG),PG=__webpack_require__(2165);Ts({name:"murmur3-32",code:35,encode:function(e){return function(e){for(var t=new Array(4),r=0;r<4;r++)t[r]=255&e,e>>=8;return new Uint8Array(t)}(PG.x86.hash32(e))}});var LG=Ts({name:"murmur3-128",code:34,encode:function(e){return gi(PG.x64.hash128(e))}}),MG=(Ts({name:"murmur3-x64-64",code:34,encode:function(e){return gi(PG.x64.hash128(e)).subarray(0,8)}}),__webpack_require__(1620)),BG=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,hi.Z)(this,e),this._options=t,this._popCount=0,this._parent=r,this._posAtParent=n,this._children=new MG,this.key=null}return(0,fi.Z)(e,[{key:"put",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._findNewBucketAndPos(t);case 2:return n=e.sent,e.next=5,n.bucket._putAt(n,t,r);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._findChild(t);case 2:if(null==(r=e.sent)){e.next=5;break}return e.abrupt("return",r.value);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"del",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._findPlace(t);case 2:r=e.sent,null!=(n=r.bucket._at(r.pos))&&n.key===t&&r.bucket._delAt(r.pos);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"leafCount",value:function(){return this._children.compactArray().reduce((function(t,r){return r instanceof e?t+r.leafCount():t+1}),0)}},{key:"childrenCount",value:function(){return this._children.length}},{key:"onlyChild",value:function(){return this._children.get(0)}},{key:"eachLeafSeries",value:(0,ii.Z)().mark((function t(){var r,n,i,a;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=this._children.compactArray(),n=(0,ge.Z)(r),t.prev=2,n.s();case 4:if((i=n.n()).done){t.next=14;break}if(!((a=i.value)instanceof e)){t.next=10;break}return t.delegateYield(a.eachLeafSeries(),"t0",8);case 8:t.next=12;break;case 10:return t.next=12,a;case 12:t.next=4;break;case 14:t.next=19;break;case 16:t.prev=16,t.t1=t.catch(2),n.e(t.t1);case 19:return t.prev=19,n.f(),t.finish(19);case 22:case"end":return t.stop()}}),t,this,[[2,16,19,22]])}))},{key:"serialize",value:function(t,r){return r(this._children.reduce((function(n,i,a){return null!=i&&(i instanceof e?n.push(i.serialize(t,r)):n.push(t(i,a))),n}),[]))}},{key:"asyncTransform",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,UG(this,t,r);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"toJSON",value:function(){return this.serialize(NG,FG)}},{key:"prettyPrint",value:function(){return JSON.stringify(this.toJSON(),null,"  ")}},{key:"tableSize",value:function(){return Math.pow(2,this._options.bits)}},{key:"_findChild",value:function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._findPlace(r);case 2:if(n=t.sent,!((i=n.bucket._at(n.pos))instanceof e)){t.next=6;break}return t.abrupt("return",void 0);case 6:if(null==i||i.key!==r){t.next=8;break}return t.abrupt("return",i);case 8:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"_findPlace",value:function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this._options.hash("string"===typeof r?Hs(r):r),t.next=3,n.take(this._options.bits);case 3:if(i=t.sent,!((a=this._children.get(i))instanceof e)){t.next=9;break}return t.next=8,a._findPlace(n);case 8:return t.abrupt("return",t.sent);case 9:return t.abrupt("return",{bucket:this,pos:i,hash:n,existingChild:a});case 10:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"_findNewBucketAndPos",value:function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._findPlace(r);case 2:if(null==(n=t.sent).existingChild||n.existingChild.key===r){t.next=13;break}return i=new e(this._options,n.bucket,n.pos),n.bucket._putObjectAt(n.pos,i),t.next=8,i._findPlace(n.existingChild.hash);case 8:return(a=t.sent).bucket._putAt(a,n.existingChild.key,n.existingChild.value),t.next=12,i._findNewBucketAndPos(n.hash);case 12:return t.abrupt("return",t.sent);case 13:return t.abrupt("return",n);case 14:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"_putAt",value:function(e,t,r){this._putObjectAt(e.pos,{key:t,value:r,hash:e.hash})}},{key:"_putObjectAt",value:function(e,t){null==this._children.get(e)&&this._popCount++,this._children.set(e,t)}},{key:"_delAt",value:function(e){if(-1===e)throw new Error("Invalid position");null!=this._children.get(e)&&this._popCount--,this._children.unset(e),this._level()}},{key:"_level",value:function(){if(null!=this._parent&&this._popCount<=1)if(1===this._popCount){var t=this._children.find(OG);if(null!=t&&!(t instanceof e)){var r=t.hash;r.untake(this._options.bits);var n={pos:this._posAtParent,hash:r,bucket:this._parent};this._parent._putAt(n,t.key,t.value)}}else this._parent._delAt(this._posAtParent)}},{key:"_at",value:function(e){return this._children.get(e)}}]),e}();function OG(e){return Boolean(e)}function NG(e,t){return e.key}function FG(e){return e}function UG(e,t,r){return zG.apply(this,arguments)}function zG(){return zG=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a,s,o,u;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=[],a=(0,ge.Z)(t._children.compactArray()),e.prev=2,a.s();case 4:if((s=a.n()).done){e.next=17;break}if(!((o=s.value)instanceof BG)){e.next=11;break}return e.next=9,UG(o,r,n);case 9:e.next=15;break;case 11:return e.next=13,r(o);case 13:u=e.sent,i.push({bitField:t._children.bitField(),children:u});case 15:e.next=4;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(2),a.e(e.t0);case 22:return e.prev=22,a.f(),e.finish(22);case 25:return e.next=27,n(i);case 27:return e.abrupt("return",e.sent);case 28:case"end":return e.stop()}}),e,null,[[2,19,22,25]])}))),zG.apply(this,arguments)}var jG=[255,254,252,248,240,224,192,128],HG=[1,3,7,15,31,63,127,255],WG=function(){function e(t){(0,hi.Z)(this,e),this._value=t,this._currentBytePos=t.length-1,this._currentBitPos=7}return(0,fi.Z)(e,[{key:"availableBits",value:function(){return this._currentBitPos+1+8*this._currentBytePos}},{key:"totalBits",value:function(){return 8*this._value.length}},{key:"take",value:function(e){for(var t=e,r=0;t>0&&this._haveBits();){var n=this._value[this._currentBytePos],i=this._currentBitPos+1,a=Math.min(i,t);r=(r<<a)+qG(n,i-a,a),t-=a,this._currentBitPos-=a,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return r}},{key:"untake",value:function(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}},{key:"_haveBits",value:function(){return this._currentBytePos>=0}}]),e}();function qG(e,t,r){var n=function(e,t){return jG[e]&HG[Math.min(t+e-1,7)]}(t,r);return(e&n)>>>t}function VG(e){return function(t){return t instanceof KG?t:new KG(t,e)}}var KG=function(){function e(t,r){if((0,hi.Z)(this,e),!(t instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=t,this._hashFn=r,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}return(0,fi.Z)(e,[{key:"take",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t;case 1:if(!(this._availableBits<r)){e.next=6;break}return e.next=4,this._produceMoreBits();case 4:e.next=1;break;case 6:for(n=0;r>0;)i=this._buffers[this._currentBufferIndex],a=Math.min(i.availableBits(),r),s=i.take(a),n=(n<<a)+s,r-=a,this._availableBits-=a,0===i.availableBits()&&this._currentBufferIndex++;return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"untake",value:function(e){for(var t=e;t>0;){var r=this._buffers[this._currentBufferIndex],n=Math.min(r.totalBits()-r.availableBits(),t);r.untake(n),t-=n,this._availableBits+=n,this._currentBufferIndex>0&&r.totalBits()===r.availableBits()&&(this._depth--,this._currentBufferIndex--)}}},{key:"_produceMoreBits",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._depth++,t=this._depth>0?Eu([this._value,Uint8Array.from([this._depth])]):this._value,e.next=4,this._hashFn(t);case 4:r=e.sent,n=new WG(r),this._buffers.push(n),this._availableBits+=n.availableBits();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function YG(e){var t;if(null==e||null==e.hashFn)throw new Error("please define an options.hashFn");var r={bits:null!==(t=e.bits)&&void 0!==t?t:8,hash:VG(e.hashFn)};return new BG(r)}function GG(e){return QG.apply(this,arguments)}function QG(){return QG=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,LG.encode(t);case 2:return e.abrupt("return",e.sent.slice(0,8).reverse());case 3:case"end":return e.stop()}}),e)}))),QG.apply(this,arguments)}var XG=BigInt(34),JG=function(e){ia(r,e);var t=ua(r);function r(e,n){var i,a;return(0,hi.Z)(this,r),a=t.call(this,e,n),(0,we.Z)(ra(a),"_bucket",void 0),a._bucket=YG({hashFn:GG,bits:null!==(i=n.shardFanoutBits)&&void 0!==i?i:8}),a}return(0,fi.Z)(r,[{key:"put",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.cid=void 0,this.size=void 0,this.nodeSize=void 0,e.next=5,this._bucket.put(t,r);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._bucket.get(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"childCount",value:function(){return this._bucket.leafCount()}},{key:"directChildrenCount",value:function(){return this._bucket.childrenCount()}},{key:"onlyChild",value:function(){return this._bucket.onlyChild()}},{key:"eachChildSeries",value:function(){var e=this;return ea((0,ii.Z)().mark((function t(){var r,n,i,a,s,o,u,c;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=!1,n=!1,t.prev=2,a=ui(e._bucket.eachLeafSeries());case 4:return t.next=6,Ji(a.next());case 6:if(!(r=!(s=t.sent).done)){t.next=13;break}return o=s.value,u=o.key,c=o.value,t.next=10,{key:u,child:c};case 10:r=!1,t.next=4;break;case 13:t.next=19;break;case 15:t.prev=15,t.t0=t.catch(2),n=!0,i=t.t0;case 19:if(t.prev=19,t.prev=20,!r||null==a.return){t.next=24;break}return t.next=24,Ji(a.return());case 24:if(t.prev=24,!n){t.next=27;break}throw i;case 27:return t.finish(24);case 28:return t.finish(19);case 29:case"end":return t.stop()}}),t,null,[[2,15,19,29],[20,,24,28]])})))()}},{key:"estimateNodeSize",value:function(){return void 0!==this.nodeSize||(this.nodeSize=rQ(this._bucket,this,this.options)),this.nodeSize}},{key:"flush",value:function(e){var t=this;return ea((0,ii.Z)().mark((function r(){var n,i,a,s,o,u;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=!1,i=!1,r.prev=2,s=ui(eQ(t._bucket,e,t,t.options));case 4:return r.next=6,Ji(s.next());case 6:if(!(n=!(o=r.sent).done)){r.next=13;break}return u=o.value,r.next=10,(0,_e.Z)((0,_e.Z)({},u),{},{path:t.path});case 10:n=!1,r.next=4;break;case 13:r.next=19;break;case 15:r.prev=15,r.t0=r.catch(2),i=!0,a=r.t0;case 19:if(r.prev=19,r.prev=20,!n||null==s.return){r.next=24;break}return r.next=24,Ji(s.return());case 24:if(r.prev=24,!i){r.next=27;break}throw a;case 27:return r.finish(24);case 28:return r.finish(19);case 29:case"end":return r.stop()}}),r,null,[[2,15,19,29],[20,,24,28]])})))()}}]),r}(RG),$G=JG;function eQ(e,t,r,n){return tQ.apply(this,arguments)}function tQ(){return tQ=ea((0,ii.Z)().mark((function e(t,r,n,i){var a,s,o,u,c,l,h,f,d,p,v,g,y,m,b,_,w,k,x,E,S,C,A,D,R,T,Z,I,P,L,M,B;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t._children,s=(t.tableSize()-1).toString(16).length,o=[],u=0n,c=0;case 5:if(!(c<a.length)){e.next=96;break}if(null!=(l=a.get(c))){e.next=9;break}return e.abrupt("continue",93);case 9:if(h=c.toString(16).toUpperCase().padStart(s,"0"),!(l instanceof BG)){e.next=46;break}f=void 0,d=!1,p=!1,e.prev=14,g=ui(eQ(l,r,null,i));case 16:return e.next=18,Ji(g.next());case 18:if(!(d=!(y=e.sent).done)){e.next=24;break}m=y.value,f=m;case 21:d=!1,e.next=16;break;case 24:e.next=30;break;case 26:e.prev=26,e.t0=e.catch(14),p=!0,v=e.t0;case 30:if(e.prev=30,e.prev=31,!d||null==g.return){e.next=35;break}return e.next=35,Ji(g.return());case 35:if(e.prev=35,!p){e.next=38;break}throw v;case 38:return e.finish(35);case 39:return e.finish(30);case 40:if(null!=f){e.next=42;break}throw new Error("Could not flush sharded directory, no subshard found");case 42:o.push({Name:h,Tsize:Number(f.size),Hash:f.cid}),u+=f.size,e.next=93;break;case 46:if("function"!==typeof l.value.flush){e.next=86;break}b=l.value,_=void 0,w=!1,k=!1,e.prev=51,E=ui(b.flush(r));case 53:return e.next=55,Ji(E.next());case 55:if(!(w=!(S=e.sent).done)){e.next=63;break}return C=S.value,_=C,e.next=60,_;case 60:w=!1,e.next=53;break;case 63:e.next=69;break;case 65:e.prev=65,e.t1=e.catch(51),k=!0,x=e.t1;case 69:if(e.prev=69,e.prev=70,!w||null==E.return){e.next=74;break}return e.next=74,Ji(E.return());case 74:if(e.prev=74,!k){e.next=77;break}throw x;case 77:return e.finish(74);case 78:return e.finish(69);case 79:if(null!=_){e.next=81;break}throw new Error("Did not flush dir");case 81:A=h+l.key,o.push({Name:A,Tsize:Number(_.size),Hash:_.cid}),u+=_.size,e.next=93;break;case 86:if(null!=(D=l.value).cid){e.next=89;break}return e.abrupt("continue",93);case 89:R=h+l.key,T=D.size,o.push({Name:R,Tsize:Number(T),Hash:D.cid}),u+=BigInt(null!==T&&void 0!==T?T:0);case 93:c++,e.next=5;break;case 96:return Z=Uint8Array.from(a.bitField().reverse()),I=new pG({type:"hamt-sharded-directory",data:Z,fanout:BigInt(t.tableSize()),hashType:XG,mtime:null===n||void 0===n?void 0:n.mtime,mode:null===n||void 0===n?void 0:n.mode}),P={Data:I.marshal(),Links:o},L=Pf(Af(P)),e.next=102,Ji(vG(L,r,i));case 102:return M=e.sent,B=BigInt(L.byteLength)+u,e.next=106,{cid:M,unixfs:I,size:B};case 106:case"end":return e.stop()}}),e,null,[[14,26,30,40],[31,,35,39],[51,65,69,79],[70,,74,78]])}))),tQ.apply(this,arguments)}function rQ(e,t,r){for(var n=e._children,i=(e.tableSize()-1).toString(16).length,a=[],s=0;s<n.length;s++){var o=n.get(s);if(null!=o){var u=s.toString(16).toUpperCase().padStart(i,"0");if(o instanceof BG){var c=rQ(o,null,r);a.push({Name:u,Tsize:Number(c),Hash:0===r.cidVersion?TG:ZG})}else if("function"===typeof o.value.flush){var l=o.value.nodeSize();a.push({Name:u+o.key,Tsize:Number(l),Hash:0===r.cidVersion?TG:ZG})}else{var h=o.value;if(null==h.cid)continue;var f=u+o.key,d=h.size;a.push({Name:f,Tsize:Number(d),Hash:h.cid})}}}var p=Uint8Array.from(n.bitField().reverse());return Pf(Af({Data:new pG({type:"hamt-sharded-directory",data:p,fanout:BigInt(e.tableSize()),hashType:XG,mtime:null===t||void 0===t?void 0:t.mtime,mode:null===t||void 0===t?void 0:t.mode}).marshal(),Links:a})).length}function nQ(e,t,r,n){return iQ.apply(this,arguments)}function iQ(){return(iQ=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i){var a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r,!(r instanceof IG&&r.estimateNodeSize()>n)){e.next=5;break}return e.next=4,aQ(r,i);case 4:a=e.sent;case 5:if(null==(s=a.parent)){e.next=14;break}if(a===r){e.next=13;break}if(null!=t&&(t.parent=a),null!=a.parentKey){e.next=11;break}throw new Error("No parent key found");case 11:return e.next=13,s.put(a.parentKey,a);case 13:return e.abrupt("return",nQ(a,s,n,i));case 14:return e.abrupt("return",a);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function aQ(e,t){return sQ.apply(this,arguments)}function sQ(){return(sQ=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c,l,h;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=new $G({root:t.root,dir:!0,parent:t.parent,parentKey:t.parentKey,path:t.path,dirty:t.dirty,flat:!1,mtime:t.mtime,mode:t.mode},r),i=!1,a=!1,e.prev=3,o=ui(t.eachChildSeries());case 5:return e.next=7,o.next();case 7:if(!(i=!(u=e.sent).done)){e.next=14;break}return c=u.value,l=c.key,h=c.child,e.next=11,n.put(l,h);case 11:i=!1,e.next=5;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(3),a=!0,s=e.t0;case 20:if(e.prev=20,e.prev=21,!i||null==o.return){e.next=25;break}return e.next=25,o.return();case 25:if(e.prev=25,!a){e.next=28;break}throw s;case 28:return e.finish(25);case 29:return e.finish(20);case 30:return e.abrupt("return",n);case 31:case"end":return e.stop()}}),e,null,[[3,16,20,30],[21,,25,29]])})))).apply(this,arguments)}var oQ=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split(/(?<!\\)\//).filter(Boolean)};function uQ(e,t,r){return cQ.apply(this,arguments)}function cQ(){return cQ=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a,s,o,u,c,l,h,f,d,p;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=oQ(null!==(i=t.path)&&void 0!==i?i:""),s=a.length-1,o=r,u="",c=0;case 5:if(!(c<a.length)){e.next=30;break}if(l=a[c],u+="".concat(""!==u?"/":"").concat(l),h=c===s,o.dirty=!0,o.cid=void 0,o.size=void 0,!h){e.next=20;break}return e.next=15,o.put(l,t);case 15:return e.next=17,nQ(null,o,n.shardSplitThresholdBytes,n);case 17:r=e.sent,e.next=27;break;case 20:return e.next=22,o.get(l);case 22:return null!=(f=e.sent)&&f instanceof RG||(f=new IG({root:!1,dir:!0,parent:o,parentKey:l,path:u,dirty:!0,flat:!0,mtime:null===(d=f)||void 0===d||null===(d=d.unixfs)||void 0===d?void 0:d.mtime,mode:null===(p=f)||void 0===p||null===(p=p.unixfs)||void 0===p?void 0:p.mode},n)),e.next=26,o.put(l,f);case 26:o=f;case 27:c++,e.next=5;break;case 30:return e.abrupt("return",r);case 31:case"end":return e.stop()}}),e)}))),cQ.apply(this,arguments)}function lQ(e,t){return hQ.apply(this,arguments)}function hQ(){return(hQ=ea((0,ii.Z)().mark((function e(t,r){var n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof RG){e.next=5;break}if(!0!==(null===(n=t.unixfs)||void 0===n?void 0:n.isDirectory())){e.next=4;break}return e.next=4,t;case 4:return e.abrupt("return");case 5:return e.delegateYield(Xa(ui(t.flush(r))),"t0",6);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fQ(e){return function(){var t=ea((0,ii.Z)().mark((function t(r,n){var i,a,s,o,u,c,l,h,f,d,p,v,g,y,m,b,_;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=new IG({root:!0,dir:!0,path:"",dirty:!0,flat:!0},e),s=!1,o=!1,u=!1,t.prev=4,l=ui(r);case 6:return t.next=8,Ji(l.next());case 8:if(!(o=!(h=t.sent).done)){t.next=23;break}if(null!=(f=h.value)){t.next=12;break}return t.abrupt("continue",20);case 12:return null!=(p="".concat(null!==(d=f.originalPath)&&void 0!==d?d:"").split("/")[0])&&""!==p&&(null==a?(a=p,s=!0):a!==p&&(s=!1)),t.next=16,Ji(uQ(f,i,e));case 16:if(i=t.sent,null!=f.unixfs&&f.unixfs.isDirectory()){t.next=20;break}return t.next=20,f;case 20:o=!1,t.next=6;break;case 23:t.next=29;break;case 25:t.prev=25,t.t0=t.catch(4),u=!0,c=t.t0;case 29:if(t.prev=29,t.prev=30,!o||null==l.return){t.next=34;break}return t.next=34,Ji(l.return());case 34:if(t.prev=34,!u){t.next=37;break}throw c;case 37:return t.finish(34);case 38:return t.finish(29);case 39:if(!(e.wrapWithDirectory||s&&i.childCount()>1)){t.next=43;break}return t.delegateYield(Xa(ui(lQ(i,n))),"t1",41);case 41:t.next=73;break;case 43:v=!1,g=!1,t.prev=45,m=ui(i.eachChildSeries());case 47:return t.next=49,Ji(m.next());case 49:if(!(v=!(b=t.sent).done)){t.next=57;break}if(null!=(_=b.value)){t.next=53;break}return t.abrupt("continue",54);case 53:return t.delegateYield(Xa(ui(lQ(_.child,n))),"t2",54);case 54:v=!1,t.next=47;break;case 57:t.next=63;break;case 59:t.prev=59,t.t3=t.catch(45),g=!0,y=t.t3;case 63:if(t.prev=63,t.prev=64,!v||null==m.return){t.next=68;break}return t.next=68,Ji(m.return());case 68:if(t.prev=68,!g){t.next=71;break}throw y;case 71:return t.finish(68);case 72:return t.finish(63);case 73:case"end":return t.stop()}}),t,null,[[4,25,29,39],[30,,34,38],[45,59,63,73],[64,,68,72]])})));return function(e,r){return t.apply(this,arguments)}}()}function dQ(e,t){return pQ.apply(this,arguments)}function pQ(){return pQ=ea((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,ii.Z)().mark((function n(i,a,s,o,u,c,l,h,f,d,p,v,g,y,m){var b,_,w,k,x,E,S,C,A,D,R,T,Z,I,P,L,M,B,O,N;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:b=Symbol.asyncIterator in e||Symbol.iterator in e?e:[e],_=null!==(i=r.wrapWithDirectory)&&void 0!==i&&i,w=null!==(a=r.shardSplitThresholdBytes)&&void 0!==a?a:262144,k=null!==(s=r.shardFanoutBits)&&void 0!==s?s:8,x=null!==(o=r.cidVersion)&&void 0!==o?o:1,E=null===(u=r.rawLeaves)||void 0===u||u,S=null!==(c=r.leafType)&&void 0!==c?c:"file",C=null!==(l=r.fileImportConcurrency)&&void 0!==l?l:50,A=null!==(h=r.blockWriteConcurrency)&&void 0!==h?h:10,D=null===(f=r.reduceSingleLeafToSelf)||void 0===f||f,R=null!==(d=r.chunker)&&void 0!==d?d:cG(),T=null!==(p=r.chunkValidator)&&void 0!==p?p:CG(),Z=null!==(v=r.dagBuilder)&&void 0!==v?v:EG({chunker:R,chunkValidator:T,wrapWithDirectory:_,layout:null!==(g=r.layout)&&void 0!==g?g:DG(),bufferImporter:null!==(y=r.bufferImporter)&&void 0!==y?y:gG({cidVersion:x,rawLeaves:E,leafType:S,onProgress:r.onProgress}),blockWriteConcurrency:A,reduceSingleLeafToSelf:D,cidVersion:x,onProgress:r.onProgress}),I=null!==(m=r.treeBuilder)&&void 0!==m?m:fQ({wrapWithDirectory:_,shardSplitThresholdBytes:w,shardFanoutBits:k,cidVersion:x,onProgress:r.onProgress}),P=!1,L=!1,n.prev=16,B=ui(I(iG(Z(b,t),C),t));case 18:return n.next=20,Ji(B.next());case 20:if(!(P=!(O=n.sent).done)){n.next=27;break}return N=O.value,n.next=24,{cid:N.cid,path:N.path,unixfs:N.unixfs,size:N.size};case 24:P=!1,n.next=18;break;case 27:n.next=33;break;case 29:n.prev=29,n.t0=n.catch(16),L=!0,M=n.t0;case 33:if(n.prev=33,n.prev=34,!P||null==B.return){n.next=38;break}return n.next=38,Ji(B.return());case 38:if(n.prev=38,!L){n.next=41;break}throw M;case 41:return n.finish(38);case 42:return n.finish(33);case 43:case"end":return n.stop()}}),n,null,[[16,29,33,43],[34,,38,42]])}))()})),pQ.apply(this,arguments)}function vQ(e,t){return gQ.apply(this,arguments)}function gQ(){return gQ=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>2&&void 0!==a[2]?a[2]:{},e.next=3,pk(dQ([t],r,n));case 3:if(null!=(i=e.sent)){e.next=6;break}throw ji(new Error("Nothing imported"),"ERR_INVALID_PARAMS");case 6:return e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)}))),gQ.apply(this,arguments)}function yQ(e,t){return mQ.apply(this,arguments)}function mQ(){return mQ=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>2&&void 0!==a[2]?a[2]:{},e.next=3,pk(dQ([t],r,n));case 3:if(null!=(i=e.sent)){e.next=6;break}throw ji(new Error("Nothing imported"),"ERR_INVALID_PARAMS");case 6:return e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)}))),mQ.apply(this,arguments)}function bQ(e,t){return _Q.apply(this,arguments)}function _Q(){return _Q=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>2&&void 0!==i[2]?i[2]:{},e.abrupt("return",vQ({content:t},r,n));case 2:case"end":return e.stop()}}),e)}))),_Q.apply(this,arguments)}function wQ(e,t){return kQ.apply(this,arguments)}function kQ(){return kQ=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>2&&void 0!==i[2]?i[2]:{},e.abrupt("return",vQ({content:t},r,n));case 2:case"end":return e.stop()}}),e)}))),kQ.apply(this,arguments)}__webpack_require__(8729);var xQ={cidVersion:1,rawLeaves:!0,layout:DG({maxChildrenPerNode:1024}),chunker:cG({chunkSize:1048576})};function EQ(e,t){return SQ.apply(this,arguments)}function SQ(){return SQ=ea((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,ii.Z)().mark((function n(){return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.delegateYield(Xa(ui(dQ(e,t,(0,_e.Z)((0,_e.Z)({},xQ),r)))),"t0",1);case 1:case"end":return n.stop()}}),n)}))()})),SQ.apply(this,arguments)}function CQ(e,t){return AQ.apply(this,arguments)}function AQ(){return AQ=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>2&&void 0!==s[2]?s[2]:{},e.next=3,bQ(t,r,(0,_e.Z)((0,_e.Z)({},xQ),n));case 3:return i=e.sent,a=i.cid,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)}))),AQ.apply(this,arguments)}function DQ(e,t){return RQ.apply(this,arguments)}function RQ(){return RQ=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>2&&void 0!==s[2]?s[2]:{},e.next=3,wQ(t,r,(0,_e.Z)((0,_e.Z)({},xQ),n));case 3:return i=e.sent,a=i.cid,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)}))),RQ.apply(this,arguments)}function TQ(e,t){return ZQ.apply(this,arguments)}function ZQ(){return ZQ=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>2&&void 0!==s[2]?s[2]:{},e.next=3,vQ(t,r,(0,_e.Z)((0,_e.Z)({},xQ),n));case 3:return i=e.sent,a=i.cid,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)}))),ZQ.apply(this,arguments)}function IQ(e,t){return PQ.apply(this,arguments)}function PQ(){return PQ=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=o.length>2&&void 0!==o[2]?o[2]:{},e.next=3,yQ((0,_e.Z)((0,_e.Z)({},t),{},{path:null!==(n=t.path)&&void 0!==n?n:"-"}),r,(0,_e.Z)((0,_e.Z)({},xQ),i));case 3:return a=e.sent,s=a.cid,e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)}))),PQ.apply(this,arguments)}var LQ=function(e){if(null!=e[Symbol.asyncIterator])return(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n,i,a,s,o,u;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=!1,i=!1,t.prev=2,s=ui(e);case 4:return t.next=6,s.next();case 6:if(!(n=!(o=t.sent).done)){t.next=12;break}u=o.value,r=u;case 9:n=!1,t.next=4;break;case 12:t.next=18;break;case 14:t.prev=14,t.t0=t.catch(2),i=!0,a=t.t0;case 18:if(t.prev=18,t.prev=19,!n||null==s.return){t.next=23;break}return t.next=23,s.return();case 23:if(t.prev=23,!i){t.next=26;break}throw a;case 26:return t.finish(23);case 27:return t.finish(18);case 28:return t.abrupt("return",r);case 29:case"end":return t.stop()}}),t,null,[[2,14,18,28],[19,,23,27]])})))();var t,r,n=(0,ge.Z)(e);try{for(n.s();!(r=n.n()).done;){t=r.value}}catch(S$){n.e(S$)}finally{n.f()}return t},MQ=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i,a,s,o,u){var c,l,h,f,d,p;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.get(t,u);case 2:c=e.sent,l=jh(c),h=l,f=n;case 6:if(!(i.length>0)){e.next=20;break}if(!((d=i[0])in h)){e.next=17;break}if(i.shift(),f="".concat(f,"/").concat(d),null==(p=Ba.asCID(h[d]))){e.next=14;break}return e.abrupt("return",{entry:{type:"object",name:r,path:n,cid:t,node:c,depth:s,size:BigInt(c.length),content:function(){var e=ea((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l;case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},next:{cid:p,name:d,path:f,toResolve:i}});case 14:h=h[d],e.next=18;break;case 17:throw ji(new Error("No property named ".concat(d," found in cbor node ").concat(t)),"ERR_NO_PROP");case 18:e.next=6;break;case 20:return e.abrupt("return",{entry:{type:"object",name:r,path:n,cid:t,node:c,depth:s,size:BigInt(c.length),content:function(){var e=ea((0,ii.Z)().mark((function e(){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l;case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}});case 21:case"end":return e.stop()}}),e)})));return function(t,r,n,i,a,s,o,u){return e.apply(this,arguments)}}(),BQ=MQ;var OQ=function(e,t,r,n){var i=BigInt(e.length),a=BigInt(t+i);return r>=a||n<t?new Uint8Array(0):(n>=t&&n<a&&(e=e.subarray(0,Number(n-t))),r>=t&&r<a&&(e=e.subarray(Number(r-t))),e)},NQ=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,n=BigInt(e),i=BigInt(null!==t&&void 0!==t?t:0),a=BigInt(r);if(a!==n&&(a=i+a),a>n&&(a=n),i<0n)throw ji(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(i>n)throw ji(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(a<0n)throw ji(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(a>n)throw ji(new Error("Length must be less than the file size"),"ERR_INVALID_PARAMS");return{start:i,end:a}},FQ=function(e){function t(){return t=ea((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,ii.Z)().mark((function r(n){var i,a,s,o;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=NQ(e.length,t.offset,t.length),a=i.start,s=i.end,o=OQ(e,0n,a,s),null===(n=t.onProgress)||void 0===n||n.call(t,new Ou("unixfs:exporter:progress:identity",{bytesRead:BigInt(o.byteLength),totalBytes:s-a,fileSize:BigInt(e.byteLength)})),r.next=5,o;case 5:case"end":return r.stop()}}),r)}))()})),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}},UQ=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i,a,s,o,u){var c;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i.length>0)){e.next=2;break}throw ji(new Error("No link named ".concat(n," found in raw node ").concat(t)),"ERR_NOT_FOUND");case 2:return c=Za(t.multihash.bytes),e.abrupt("return",{entry:{type:"identity",name:r,path:n,cid:t,content:FQ(c.digest),depth:s,size:BigInt(c.digest.length),node:c.digest}});case 4:case"end":return e.stop()}}),e)})));return function(t,r,n,i,a,s,o,u){return e.apply(this,arguments)}}(),zQ=UQ,jQ=function(e){function t(){return t=ea((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,ii.Z)().mark((function r(n){var i,a,s,o;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=NQ(e.length,t.offset,t.length),a=i.start,s=i.end,o=OQ(e,0n,a,s),null===(n=t.onProgress)||void 0===n||n.call(t,new Ou("unixfs:exporter:progress:raw",{bytesRead:BigInt(o.byteLength),totalBytes:s-a,fileSize:BigInt(e.byteLength)})),r.next=5,o;case 5:case"end":return r.stop()}}),r)}))()})),t.apply(this,arguments)}return function(){return t.apply(this,arguments)}},HQ=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i,a,s,o,u){var c;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i.length>0)){e.next=2;break}throw ji(new Error("No link named ".concat(n," found in raw node ").concat(t)),"ERR_NOT_FOUND");case 2:return e.next=4,o.get(t,u);case 4:return c=e.sent,e.abrupt("return",{entry:{type:"raw",name:r,path:n,cid:t,content:jQ(c),depth:s,size:BigInt(c.length),node:c}});case 6:case"end":return e.stop()}}),e)})));return function(t,r,n,i,a,s,o,u){return e.apply(this,arguments)}}(),WQ=HQ,qQ=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,LG.encode(t);case 2:return e.abrupt("return",e.sent.slice(0,8).reverse());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),VQ=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(r.tableSize()-1).toString(16).length,e.next=3,Promise.all(t.map(function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.Name){e.next=2;break}throw new Error("Unexpected Link without a Name");case 2:if(t.Name.length!==i){e.next=6;break}return a=parseInt(t.Name,16),r._putObjectAt(a,new BG({hash:n._options.hash,bits:n._options.bits},r,a)),e.abrupt("return");case 6:return e.next=8,n.put(t.Name.substring(2),!0);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),KQ=function(e,t){return e.toString(16).toUpperCase().padStart(t,"0").substring(0,t)},YQ=function(e){for(var t=e.bucket,r=[];null!=t._parent;)r.push(t),t=t._parent;return r.push(t),r.reverse()},GQ=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i,a){var s,o,u,c,l,h,f,d;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=i){e.next=16;break}if(null!=t.Data){e.next=3;break}throw ji(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");case 3:e.prev=3,s=pG.unmarshal(t.Data),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(3),ji(e.t0,"ERR_NOT_UNIXFS");case 10:if("hamt-sharded-directory"===s.type){e.next=12;break}throw ji(new Error("not a HAMT"),"ERR_NOT_UNIXFS");case 12:if(null!=s.fanout){e.next=14;break}throw ji(new Error("missing fanout"),"ERR_NOT_UNIXFS");case 14:o=YG({hashFn:qQ,bits:Math.log2(Number(s.fanout))}),i={rootBucket:o,hamtDepth:1,lastBucket:o};case 16:return u=(i.lastBucket.tableSize()-1).toString(16).length,e.next=19,VQ(t.Links,i.lastBucket,i.rootBucket);case 19:return e.next=21,i.rootBucket._findNewBucketAndPos(r);case 21:if(c=e.sent,l=KQ(c.pos,u),(h=YQ(c)).length>i.hamtDepth&&(i.lastBucket=h[i.hamtDepth],l=KQ(i.lastBucket._posAtParent,u)),null!=(f=t.Links.find((function(e){if(null==e.Name)return!1;var t=e.Name.substring(0,u),n=e.Name.substring(u);return t===l&&(""===n||n===r)})))){e.next=28;break}return e.abrupt("return");case 28:if(null==f.Name||f.Name.substring(u)!==r){e.next=30;break}return e.abrupt("return",f.Hash);case 30:return i.hamtDepth++,e.next=33,n.get(f.Hash,a);case 33:return d=e.sent,t=Lf(d),e.abrupt("return",GQ(t,r,n,i,a));case 36:case"end":return e.stop()}}),e,null,[[3,7]])})));return function(t,r,n,i,a){return e.apply(this,arguments)}}(),QQ=GQ,XQ=function(e,t,r,n,i,a,s){function o(){return o=ea((function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,ii.Z)().mark((function o(u,c,l){var h,f,d;return(0,ii.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return h=null!==(u=r.offset)&&void 0!==u?u:0,f=null!==(c=r.length)&&void 0!==c?c:t.Links.length,d=t.Links.slice(h,f),null===(l=r.onProgress)||void 0===l||l.call(r,new Ou("unixfs:exporter:walk:directory",{cid:e})),o.delegateYield(Xa(ui(no(d,(function(e){return ro(e,(function(e){return(0,ai.Z)((0,ii.Z)().mark((function t(){var o,u,c,l;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=null!==(o=e.Name)&&void 0!==o?o:"",c="".concat(n,"/").concat(u),t.next=4,i(e.Hash,u,c,[],a+1,s,r);case 4:return l=t.sent,t.abrupt("return",l.entry);case 6:case"end":return t.stop()}}),t)})))}))}),(function(e){return EA(e,{ordered:!0})}),(function(e){return Qa(e,(function(e){return null!=e}))})))),"t0",5);case 5:case"end":return o.stop()}}),o)}))()})),o.apply(this,arguments)}return function(){return o.apply(this,arguments)}};function JQ(e,t,r,n,i,a,s){return $Q.apply(this,arguments)}function $Q(){return $Q=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i,a,s,o){var u,c,l,h,f,d,p,v,g;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r instanceof Uint8Array)){e.next=4;break}return u=OQ(r,i,a,s),n.push(u),e.abrupt("return");case 4:if(null!=r.Data){e.next=6;break}throw ji(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");case 6:e.prev=6,c=pG.unmarshal(r.Data),e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(6),ji(e.t0,"ERR_NOT_UNIXFS");case 13:if(null!=c.data&&(l=c.data,h=OQ(l,i,a,s),n.push(h),i+=BigInt(h.byteLength)),f=[],r.Links.length===c.blockSizes.length){e.next=17;break}throw ji(new Error("Inconsistent block sizes and dag links"),"ERR_NOT_UNIXFS");case 17:d=0;case 18:if(!(d<r.Links.length)){e.next=29;break}if(p=r.Links[d],g=(v=i)+c.blockSizes[d],(a>=v&&a<g||s>=v&&s<=g||a<v&&s>g)&&f.push({link:p,blockStart:i}),!((i=g)>s)){e.next=26;break}return e.abrupt("break",29);case 26:d++,e.next=18;break;case 29:return e.next=31,no(f,(function(e){return ro(e,(function(e){return(0,ai.Z)((0,ii.Z)().mark((function r(){var n;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.get(e.link.Hash,o);case 2:return n=r.sent,r.abrupt("return",(0,_e.Z)((0,_e.Z)({},e),{},{block:n}));case 4:case"end":return r.stop()}}),r)})))}))}),(function(e){return EA(e,{ordered:!0})}),function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(r){var i,u,c,l,h,f,d;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=!1,u=!1,e.prev=2,l=(0,ii.Z)().mark((function e(){var r,i,u,c,l,h;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=d.value,i=r.link,u=r.block,c=r.blockStart,e.t0=i.Hash.code,e.next=e.t0===If?4:e.t0===qa?6:8;break;case 4:return l=Lf(u),e.abrupt("break",10);case 6:return l=u,e.abrupt("break",10);case 8:return n.end(ji(new Error("Unsupported codec: ".concat(i.Hash.code)),"ERR_NOT_UNIXFS")),e.abrupt("return",{v:void 0});case 10:return(h=new Bh({concurrency:1})).on("error",(function(e){n.end(e)})),h.add((0,ai.Z)((0,ii.Z)().mark((function e(){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(r=o.onProgress)||void 0===r||r.call(o,new Ou("unixfs:exporter:walk:file",{cid:i.Hash})),e.next=3,JQ(t,l,n,c,a,s,o);case 3:case"end":return e.stop()}}),e)})))),e.next=15,h.onIdle();case 15:case"end":return e.stop()}}),e)})),f=ui(r);case 5:return e.next=7,f.next();case 7:if(!(i=!(d=e.sent).done)){e.next=15;break}return e.delegateYield(l(),"t0",9);case 9:if(!(h=e.t0)){e.next=12;break}return e.abrupt("return",h.v);case 12:i=!1,e.next=5;break;case 15:e.next=21;break;case 17:e.prev=17,e.t1=e.catch(2),u=!0,c=e.t1;case 21:if(e.prev=21,e.prev=22,!i||null==f.return){e.next=26;break}return e.next=26,f.return();case 26:if(e.prev=26,!u){e.next=29;break}throw c;case 29:return e.finish(26);case 30:return e.finish(21);case 31:case"end":return e.stop()}}),e,null,[[2,17,21,31],[22,,26,30]])})));return function(t){return e.apply(this,arguments)}}());case 31:i>=s&&n.end();case 32:case"end":return e.stop()}}),e,null,[[6,10]])}))),$Q.apply(this,arguments)}var eX=function(e,t,r,n,i,a,s){function o(){return o=ea((function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,ii.Z)().mark((function i(a){var o,u,c,l,h,f,d,p,v,g,y,m,b,_;return(0,ii.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(void 0!==(o=r.fileSize())){i.next=3;break}throw new Error("File was a directory");case 3:if(u=NQ(o,n.offset,n.length),c=u.start,0n!==(l=u.end)){i.next=6;break}return i.abrupt("return");case 6:h=0n,f=l-c,d=as(),null===(a=n.onProgress)||void 0===a||a.call(n,new Ou("unixfs:exporter:walk:file",{cid:e})),JQ(s,t,d,0n,c,l,n).catch((function(e){d.end(e)})),p=!1,v=!1,i.prev=13,y=ui(d);case 15:return i.next=17,Ji(y.next());case 17:if(!(p=!(m=i.sent).done)){i.next=32;break}if(null!=(b=m.value)){i.next=21;break}return i.abrupt("continue",29);case 21:if(!((h+=BigInt(b.byteLength))>f)){i.next=25;break}throw d.end(),ji(new Error("Read too many bytes - the file size reported by the UnixFS data in the root node may be incorrect"),"ERR_OVER_READ");case 25:return h===f&&d.end(),null===(_=n.onProgress)||void 0===_||_.call(n,new Ou("unixfs:exporter:progress:unixfs:file",{bytesRead:h,totalBytes:f,fileSize:o})),i.next=29,b;case 29:p=!1,i.next=15;break;case 32:i.next=38;break;case 34:i.prev=34,i.t0=i.catch(13),v=!0,g=i.t0;case 38:if(i.prev=38,i.prev=39,!p||null==y.return){i.next=43;break}return i.next=43,Ji(y.return());case 43:if(i.prev=43,!v){i.next=46;break}throw g;case 46:return i.finish(43);case 47:return i.finish(38);case 48:if(!(h<f)){i.next=50;break}throw ji(new Error("Traversed entire DAG but did not read enough bytes"),"ERR_UNDER_READ");case 50:case"end":return i.stop()}}),i,null,[[13,34,38,48],[39,,43,47]])}))()})),o.apply(this,arguments)}return function(){return o.apply(this,arguments)}};function tX(e,t,r,n,i,a){return rX.apply(this,arguments)}function rX(){return rX=ea((0,ii.Z)().mark((function e(t,r,n,i,a,s){var o,u,c,l,h,f,d,p,v,g;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.Links,null!=t.Data){e.next=3;break}throw ji(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");case 3:e.prev=3,u=pG.unmarshal(t.Data),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(3),ji(e.t0,"ERR_NOT_UNIXFS");case 10:if(null!=u.fanout){e.next=12;break}throw ji(new Error("missing fanout"),"ERR_NOT_UNIXFS");case 12:c=(u.fanout-1n).toString(16).length,l=no(o,(function(e){return ro(e,(function(e){return(0,ai.Z)((0,ii.Z)().mark((function o(){var u,l,h,f;return(0,ii.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(null==(u=null!=e.Name?e.Name.substring(c):null)||""===u){o.next=8;break}return o.next=4,n(e.Hash,u,"".concat(r,"/").concat(u),[],i+1,a,s);case 4:return l=o.sent,o.abrupt("return",{entries:null==l.entry?[]:[l.entry]});case 8:return o.next=10,a.get(e.Hash,s);case 10:return f=o.sent,t=Lf(f),null===(h=s.onProgress)||void 0===h||h.call(s,new Ou("unixfs:exporter:walk:hamt-sharded-directory",{cid:e.Hash})),o.abrupt("return",{entries:tX(t,r,n,i,a,s)});case 14:case"end":return o.stop()}}),o)})))}))}),(function(e){return EA(e,{ordered:!0})})),h=!1,f=!1,e.prev=16,p=ui(l);case 18:return e.next=20,Ji(p.next());case 20:if(!(h=!(v=e.sent).done)){e.next=26;break}return g=v.value.entries,e.delegateYield(Xa(ui(g)),"t1",23);case 23:h=!1,e.next=18;break;case 26:e.next=32;break;case 28:e.prev=28,e.t2=e.catch(16),f=!0,d=e.t2;case 32:if(e.prev=32,e.prev=33,!h||null==p.return){e.next=37;break}return e.next=37,Ji(p.return());case 37:if(e.prev=37,!f){e.next=40;break}throw d;case 40:return e.finish(37);case 41:return e.finish(32);case 42:case"end":return e.stop()}}),e,null,[[3,7],[16,28,32,42],[33,,37,41]])}))),rX.apply(this,arguments)}var nX,iX=function(e,t,r,n,i,a,s){return function(){var r,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return null===(r=o.onProgress)||void 0===r||r.call(o,new Ou("unixfs:exporter:walk:hamt-sharded-directory",{cid:e})),tX(t,n,i,a,s,o)}},aX=function(e,t){var r=e.Links.find((function(e){return e.Name===t}));return null===r||void 0===r?void 0:r.Hash},sX={raw:eX,file:eX,directory:XQ,"hamt-sharded-directory":iX,metadata:function(e,t,r,n,i,a,s){return function(){return[]}},symlink:function(e,t,r,n,i,a,s){return function(){return[]}}},oX=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i,a,s,o,u){var c,l,h,f,d,p,v,g,y;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.get(t,u);case 2:if(c=e.sent,l=Lf(c),null==r&&(r=t.toString()),null!=l.Data){e.next=7;break}throw ji(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");case 7:e.prev=7,h=pG.unmarshal(l.Data),e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(7),ji(e.t0,"ERR_NOT_UNIXFS");case 14:if(null==n&&(n=r),!(i.length>0)){e.next=28;break}if("hamt-sharded-directory"!==(null===(d=h)||void 0===d?void 0:d.type)){e.next=22;break}return e.next=19,QQ(l,i[0],o);case 19:p=e.sent,e.next=23;break;case 22:p=aX(l,i[0]);case 23:if(null!=p){e.next=25;break}throw ji(new Error("file does not exist"),"ERR_NOT_FOUND");case 25:v=i.shift(),g="".concat(n,"/").concat(v),f={cid:p,toResolve:i,name:null!==v&&void 0!==v?v:"",path:g};case 28:if(null!=(y=sX[h.type](t,l,h,n,a,s,o))){e.next=31;break}throw ji(new Error("could not find content exporter"),"ERR_NOT_FOUND");case 31:if(!h.isDirectory()){e.next=33;break}return e.abrupt("return",{entry:{type:"directory",name:r,path:n,cid:t,content:y,unixfs:h,depth:s,node:l,size:h.fileSize()},next:f});case 33:return e.abrupt("return",{entry:{type:"file",name:r,path:n,cid:t,content:y,unixfs:h,depth:s,node:l,size:h.fileSize()},next:f});case 34:case"end":return e.stop()}}),e,null,[[7,11]])})));return function(t,r,n,i,a,s,o,u){return e.apply(this,arguments)}}(),uX=oX,cX=(nX={},(0,we.Z)(nX,If,uX),(0,we.Z)(nX,qa,WQ),(0,we.Z)(nX,Uh,BQ),(0,we.Z)(nX,Rs.code,zQ),nX),lX=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i,a,s,o){var u;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(u=cX[t.code])){e.next=3;break}throw ji(new Error("No resolver for code ".concat(t.code)),"ERR_NO_RESOLVER");case 3:return e.abrupt("return",u(t,r,n,i,lX,a,s,o));case 4:case"end":return e.stop()}}),e)})));return function(t,r,n,i,a,s,o){return e.apply(this,arguments)}}(),hX=lX,fX=function(e){if(e instanceof Uint8Array)return{cid:Ba.decode(e),toResolve:[]};var t=Ba.asCID(e);if(null!=t)return{cid:t,toResolve:[]};if("string"===typeof e){0===e.indexOf("/ipfs/")&&(e=e.substring(6));var r=function(){var e;return(null!==(e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").trim().match(/([^\\^/]|\\\/)+/g))&&void 0!==e?e:[]).filter(Boolean)}(e);return{cid:Ba.parse(r[0]),toResolve:r.slice(1)}}throw ji(new Error("Unknown path type ".concat(e)),"ERR_BAD_PATH")};function dX(e,t){return pX.apply(this,arguments)}function pX(){return pX=ea((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=fX(e),a=i.cid,s=i.toResolve,o=a.toString(),u=o,c=s.length;case 4:return n.next=7,Ji(hX(a,o,u,s,c,t,r));case 7:if(null!=(l=n.sent).entry||null!=l.next){n.next=10;break}throw ji(new Error("Could not resolve ".concat(e)),"ERR_NOT_FOUND");case 10:if(null==l.entry){n.next=13;break}return n.next=13,l.entry;case 13:if(null!=l.next){n.next=15;break}return n.abrupt("return");case 15:s=l.next.toResolve,a=l.next.cid,o=l.next.name,u=l.next.path,n.next=4;break;case 21:case"end":return n.stop()}}),n)}))()})),pX.apply(this,arguments)}function vX(e,t){return gX.apply(this,arguments)}function gX(){return gX=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>2&&void 0!==a[2]?a[2]:{},e.next=3,LQ(dX(t,r,n));case 3:if(null!=(i=e.sent)){e.next=6;break}throw ji(new Error("Could not resolve ".concat(t)),"ERR_NOT_FOUND");case 6:return e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)}))),gX.apply(this,arguments)}function yX(e,t){return mX.apply(this,arguments)}function mX(){return mX=ea((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,ii.Z)().mark((function n(){var i,a,s,o,u,c,l,h,f;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return f=function(){return f=ea((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!1,i=!1,e.prev=2,s=ui(t.content(r));case 4:return e.next=6,Ji(s.next());case 6:if(!(n=!(o=e.sent).done)){e.next=17;break}return u=o.value,e.next=10,u;case 10:if(!(u instanceof Uint8Array)){e.next=12;break}return e.abrupt("continue",14);case 12:if("directory"!==u.type){e.next=14;break}return e.delegateYield(Xa(ui(h(u,r))),"t0",14);case 14:n=!1,e.next=4;break;case 17:e.next=23;break;case 19:e.prev=19,e.t1=e.catch(2),i=!0,a=e.t1;case 23:if(e.prev=23,e.prev=24,!n||null==s.return){e.next=28;break}return e.next=28,Ji(s.return());case 28:if(e.prev=28,!i){e.next=31;break}throw a;case 31:return e.finish(28);case 32:return e.finish(23);case 33:case"end":return e.stop()}}),e,null,[[2,19,23,33],[24,,28,32]])}))),f.apply(this,arguments)},h=function(e,t){return f.apply(this,arguments)},n.next=4,Ji(vX(e,t,r));case 4:if(null!=(i=n.sent)){n.next=7;break}return n.abrupt("return");case 7:return n.next=9,i;case 9:if("directory"!==i.type){n.next=39;break}a=!1,s=!1,n.prev=12,u=ui(h(i,r));case 14:return n.next=16,Ji(u.next());case 16:if(!(a=!(c=n.sent).done)){n.next=23;break}return l=c.value,n.next=20,l;case 20:a=!1,n.next=14;break;case 23:n.next=29;break;case 25:n.prev=25,n.t0=n.catch(12),s=!0,o=n.t0;case 29:if(n.prev=29,n.prev=30,!a||null==u.return){n.next=34;break}return n.next=34,Ji(u.return());case 34:if(n.prev=34,!s){n.next=37;break}throw o;case 37:return n.finish(34);case 38:return n.finish(29);case 39:case"end":return n.stop()}}),n,null,[[12,25,29,39],[30,,34,38]])}))()})),mX.apply(this,arguments)}var bX=function(e){ia(r,e);var t=ua(r);function r(e,n,i){var a;return(0,hi.Z)(this,r),a=t.call(this,e),(0,we.Z)(ra(a),"name",void 0),(0,we.Z)(ra(a),"code",void 0),a.name=n,a.code=i,a}return(0,fi.Z)(r)}(es(Error)),_X=function(e){ia(r,e);var t=ua(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"not a Unixfs node";return(0,hi.Z)(this,r),t.call(this,e,"NotUnixFSError","ERR_NOT_UNIXFS")}return(0,fi.Z)(r)}(bX),wX=function(e){ia(r,e);var t=ua(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"invalid PBNode";return(0,hi.Z)(this,r),t.call(this,e,"InvalidPBNodeError","ERR_INVALID_PBNODE")}return(0,fi.Z)(r)}(bX),kX=function(e){ia(r,e);var t=ua(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"unknown error";return(0,hi.Z)(this,r),t.call(this,e,"InvalidPBNodeError","ERR_UNKNOWN_ERROR")}return(0,fi.Z)(r)}(bX),xX=function(e){ia(r,e);var t=ua(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"path already exists";return(0,hi.Z)(this,r),t.call(this,e,"AlreadyExistsError","ERR_ALREADY_EXISTS")}return(0,fi.Z)(r)}(bX),EX=function(e){ia(r,e);var t=ua(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"path does not exist";return(0,hi.Z)(this,r),t.call(this,e,"DoesNotExistError","ERR_DOES_NOT_EXIST")}return(0,fi.Z)(r)}(bX),SX=function(e){ia(r,e);var t=ua(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"no content";return(0,hi.Z)(this,r),t.call(this,e,"NoContentError","ERR_NO_CONTENT")}return(0,fi.Z)(r)}(bX),CX=function(e){ia(r,e);var t=ua(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"not a file";return(0,hi.Z)(this,r),t.call(this,e,"NotAFileError","ERR_NOT_A_FILE")}return(0,fi.Z)(r)}(bX),AX=function(e){ia(r,e);var t=ua(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"not a directory";return(0,hi.Z)(this,r),t.call(this,e,"NotADirectoryError","ERR_NOT_A_DIRECTORY")}return(0,fi.Z)(r)}(bX),DX=function(e){ia(r,e);var t=ua(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"invalid parameters";return(0,hi.Z)(this,r),t.call(this,e,"InvalidParametersError","ERR_INVALID_PARAMETERS")}return(0,fi.Z)(r)}(bX);function RX(e){return function(t){return t instanceof TX?t:new TX(t,e)}}var TX=function(){function e(t,r){if((0,hi.Z)(this,e),(0,we.Z)(this,"_value",void 0),(0,we.Z)(this,"_hashFn",void 0),(0,we.Z)(this,"_depth",void 0),(0,we.Z)(this,"_availableBits",void 0),(0,we.Z)(this,"_currentBufferIndex",void 0),(0,we.Z)(this,"_buffers",void 0),!(t instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=t,this._hashFn=r,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}return(0,fi.Z)(e,[{key:"take",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n,i,a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t;case 1:if(!(this._availableBits<r)){e.next=6;break}return e.next=4,this._produceMoreBits();case 4:e.next=1;break;case 6:for(n=0;r>0;)i=this._buffers[this._currentBufferIndex],a=Math.min(i.availableBits(),r),s=i.take(a),n=(n<<a)+s,r-=a,this._availableBits-=a,0===i.availableBits()&&this._currentBufferIndex++;return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"untake",value:function(e){for(var t=e;t>0;){var r=this._buffers[this._currentBufferIndex],n=Math.min(r.totalBits()-r.availableBits(),t);r.untake(n),t-=n,this._availableBits+=n,this._currentBufferIndex>0&&r.totalBits()===r.availableBits()&&(this._depth--,this._currentBufferIndex--)}}},{key:"_produceMoreBits",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._depth++,t=this._depth>0?Eu([this._value,Uint8Array.from([this._depth])]):this._value,e.next=4,this._hashFn(t);case 4:r=e.sent,n=new PX(r),this._buffers.push(n),this._availableBits+=n.availableBits();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),ZX=[255,254,252,248,240,224,192,128],IX=[1,3,7,15,31,63,127,255],PX=function(){function e(t){(0,hi.Z)(this,e),(0,we.Z)(this,"_value",void 0),(0,we.Z)(this,"_currentBytePos",void 0),(0,we.Z)(this,"_currentBitPos",void 0),this._value=t,this._currentBytePos=t.length-1,this._currentBitPos=7}return(0,fi.Z)(e,[{key:"availableBits",value:function(){return this._currentBitPos+1+8*this._currentBytePos}},{key:"totalBits",value:function(){return 8*this._value.length}},{key:"take",value:function(e){for(var t=e,r=0;t>0&&this._haveBits();){var n=this._value[this._currentBytePos],i=this._currentBitPos+1,a=Math.min(i,t);r=(r<<a)+LX(n,i-a,a),t-=a,this._currentBitPos-=a,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return r}},{key:"untake",value:function(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}},{key:"_haveBits",value:function(){return this._currentBytePos>=0}}]),e}();function LX(e,t,r){var n=function(e,t){return ZX[e]&IX[Math.min(t+e-1,7)]}(t,r);return(e&n)>>>t}var MX=BigInt(LG.code);function BX(e){return OX.apply(this,arguments)}function OX(){return OX=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,LG.encode(t);case 2:return e.abrupt("return",e.sent.subarray(0,8).reverse());case 3:case"end":return e.stop()}}),e)}))),OX.apply(this,arguments)}var NX=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==n.codec&&(n.codec=m),e.next=3,Ps.digest(t);case 3:return i=e.sent,a=Ba.create(n.cidVersion,n.codec.code,i),e.next=7,r.put(a,t,(0,_e.Z)((0,_e.Z)({},n),{},{signal:n.signal}));case 7:return e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),FX=(0,fi.Z)((function e(t,r){(0,hi.Z)(this,e),(0,we.Z)(this,"options",void 0),(0,we.Z)(this,"root",void 0),(0,we.Z)(this,"dir",void 0),(0,we.Z)(this,"path",void 0),(0,we.Z)(this,"dirty",void 0),(0,we.Z)(this,"flat",void 0),(0,we.Z)(this,"parent",void 0),(0,we.Z)(this,"parentKey",void 0),(0,we.Z)(this,"unixfs",void 0),(0,we.Z)(this,"mode",void 0),(0,we.Z)(this,"mtime",void 0),(0,we.Z)(this,"cid",void 0),(0,we.Z)(this,"size",void 0),(0,we.Z)(this,"nodeSize",void 0),this.options=null!==r&&void 0!==r?r:{},this.root=t.root,this.dir=t.dir,this.path=t.path,this.dirty=t.dirty,this.flat=t.flat,this.parent=t.parent,this.parentKey=t.parentKey,this.unixfs=t.unixfs,this.mode=t.mode,this.mtime=t.mtime})),UX=function(e){ia(r,e);var t=ua(r);function r(e,n){var i;return(0,hi.Z)(this,r),i=t.call(this,e,n),(0,we.Z)(ra(i),"_bucket",void 0),i._bucket=YG({hashFn:BX,bits:8}),i}return(0,fi.Z)(r,[{key:"put",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.cid=void 0,this.size=void 0,this.nodeSize=void 0,e.next=5,this._bucket.put(t,r);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._bucket.get(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"childCount",value:function(){return this._bucket.leafCount()}},{key:"directChildrenCount",value:function(){return this._bucket.childrenCount()}},{key:"onlyChild",value:function(){return this._bucket.onlyChild()}},{key:"eachChildSeries",value:function(){var e=this;return ea((0,ii.Z)().mark((function t(){var r,n,i,a,s,o,u,c;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=!1,n=!1,t.prev=2,a=ui(e._bucket.eachLeafSeries());case 4:return t.next=6,Ji(a.next());case 6:if(!(r=!(s=t.sent).done)){t.next=13;break}return o=s.value,u=o.key,c=o.value,t.next=10,{key:u,child:c};case 10:r=!1,t.next=4;break;case 13:t.next=19;break;case 15:t.prev=15,t.t0=t.catch(2),n=!0,i=t.t0;case 19:if(t.prev=19,t.prev=20,!r||null==a.return){t.next=24;break}return t.next=24,Ji(a.return());case 24:if(t.prev=24,!n){t.next=27;break}throw i;case 27:return t.finish(24);case 28:return t.finish(19);case 29:case"end":return t.stop()}}),t,null,[[2,15,19,29],[20,,24,28]])})))()}},{key:"estimateNodeSize",value:function(){return void 0!==this.nodeSize||(this.nodeSize=HX(this._bucket,this,this.options)),this.nodeSize}},{key:"flush",value:function(e){var t=this;return ea((0,ii.Z)().mark((function r(){var n,i,a,s,o,u;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=!1,i=!1,r.prev=2,s=ui(zX(t._bucket,e,t,t.options));case 4:return r.next=6,Ji(s.next());case 6:if(!(n=!(o=r.sent).done)){r.next=13;break}return u=o.value,r.next=10,(0,_e.Z)((0,_e.Z)({},u),{},{path:t.path});case 10:n=!1,r.next=4;break;case 13:r.next=19;break;case 15:r.prev=15,r.t0=r.catch(2),i=!0,a=r.t0;case 19:if(r.prev=19,r.prev=20,!n||null==s.return){r.next=24;break}return r.next=24,Ji(s.return());case 24:if(r.prev=24,!i){r.next=27;break}throw a;case 27:return r.finish(24);case 28:return r.finish(19);case 29:case"end":return r.stop()}}),r,null,[[2,15,19,29],[20,,24,28]])})))()}}]),r}(FX);function zX(e,t,r,n){return jX.apply(this,arguments)}function jX(){return jX=ea((0,ii.Z)().mark((function e(t,r,n,i){var a,s,o,u,c,l,h,f,d,p,v,g,y,m,b,_,w,k,x,E,S,C,A,D,R,T,Z,I,P,L,M;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t._children,s=[],o=0n,u=0;case 4:if(!(u<a.length)){e.next=95;break}if(null!=(c=a.get(u))){e.next=8;break}return e.abrupt("continue",92);case 8:if(l=u.toString(16).toUpperCase().padStart(2,"0"),!(c instanceof BG)){e.next=45;break}h=void 0,f=!1,d=!1,e.prev=13,v=ui(zX(c,r,null,i));case 15:return e.next=17,Ji(v.next());case 17:if(!(f=!(g=e.sent).done)){e.next=23;break}y=g.value,h=y;case 20:f=!1,e.next=15;break;case 23:e.next=29;break;case 25:e.prev=25,e.t0=e.catch(13),d=!0,p=e.t0;case 29:if(e.prev=29,e.prev=30,!f||null==v.return){e.next=34;break}return e.next=34,Ji(v.return());case 34:if(e.prev=34,!d){e.next=37;break}throw p;case 37:return e.finish(34);case 38:return e.finish(29);case 39:if(null!=h){e.next=41;break}throw new Error("Could not flush sharded directory, no subshard found");case 41:s.push({Name:l,Tsize:Number(h.size),Hash:h.cid}),o+=h.size,e.next=92;break;case 45:if("function"!==typeof c.value.flush){e.next=85;break}m=c.value,b=void 0,_=!1,w=!1,e.prev=50,x=ui(m.flush(r));case 52:return e.next=54,Ji(x.next());case 54:if(!(_=!(E=e.sent).done)){e.next=62;break}return S=E.value,b=S,e.next=59,b;case 59:_=!1,e.next=52;break;case 62:e.next=68;break;case 64:e.prev=64,e.t1=e.catch(50),w=!0,k=e.t1;case 68:if(e.prev=68,e.prev=69,!_||null==x.return){e.next=73;break}return e.next=73,Ji(x.return());case 73:if(e.prev=73,!w){e.next=76;break}throw k;case 76:return e.finish(73);case 77:return e.finish(68);case 78:if(null!=b){e.next=80;break}throw new Error("Did not flush dir");case 80:C=l+c.key,s.push({Name:C,Tsize:Number(b.size),Hash:b.cid}),o+=b.size,e.next=92;break;case 85:if(null!=(A=c.value).cid){e.next=88;break}return e.abrupt("continue",92);case 88:D=l+c.key,R=A.size,s.push({Name:D,Tsize:Number(R),Hash:A.cid}),o+=BigInt(null!==R&&void 0!==R?R:0);case 92:u++,e.next=4;break;case 95:return T=Uint8Array.from(a.bitField().reverse()),Z=new pG({type:"hamt-sharded-directory",data:T,fanout:BigInt(t.tableSize()),hashType:MX,mtime:null===n||void 0===n?void 0:n.mtime,mode:null===n||void 0===n?void 0:n.mode}),I={Data:Z.marshal(),Links:s},P=Pf(Af(I)),e.next=101,Ji(NX(P,r,i));case 101:return L=e.sent,M=BigInt(P.byteLength)+o,e.next=105,{cid:L,unixfs:Z,size:M};case 105:case"end":return e.stop()}}),e,null,[[13,25,29,39],[30,,34,38],[50,64,68,78],[69,,73,77]])}))),jX.apply(this,arguments)}function HX(e,t,r){for(var n=e._children,i=[],a=0;a<n.length;a++){var s=n.get(a);if(null!=s){var o=a.toString(16).toUpperCase().padStart(2,"0");if(s instanceof BG){var u=HX(s,null,r);i.push({Name:o,Tsize:Number(u),Hash:0===r.cidVersion?WX:qX})}else if("function"===typeof s.value.flush){var c=s.value.nodeSize();i.push({Name:o+s.key,Tsize:Number(c),Hash:0===r.cidVersion?WX:qX})}else{var l=s.value;if(null==l.cid)continue;var h=o+s.key,f=l.size;i.push({Name:h,Tsize:Number(f),Hash:l.cid})}}}var d=Uint8Array.from(n.bitField().reverse());return Pf(Af({Data:new pG({type:"hamt-sharded-directory",data:d,fanout:BigInt(e.tableSize()),hashType:MX,mtime:null===t||void 0===t?void 0:t.mtime,mode:null===t||void 0===t?void 0:t.mode}).marshal(),Links:i})).length}var WX=Ba.parse("QmUNLLsPACCz1vLxQVkXqqLX5R1X345qqfHbsf67hvA3Nn"),qX=Ba.parse("zdj7WbTaiJT1fgatdet9Ei9iDB5hdCxkbVyhyh8YTUnXMiwYi"),VX=zi("helia:unixfs:commands:utils:hamt-utils"),KX=function(e){return e.toString(16).toUpperCase().padStart(2,"0").substring(0,2)},YX=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=new UX({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mtime:n.mtime,mode:n.mode},n),a=0;case 2:if(!(a<r.length)){e.next=8;break}return e.next=5,i._bucket.put(r[a].name,{size:r[a].size,cid:r[a].cid});case 5:a++,e.next=2;break;case 8:return e.next=10,LQ(i.flush(t));case 10:if(null!=(s=e.sent)){e.next=13;break}throw new Error("Flushing shard yielded no result");case 13:return e.abrupt("return",s);case 14:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),GX=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a,s,o,u,c,l;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=pG.unmarshal(null!==(i=t[0].node.Data)&&void 0!==i?i:new Uint8Array(0)),s=BigInt(Math.pow(2,8)),t.reverse(),c=(0,ii.Z)().mark((function e(){var i,c,h,f,d,p;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=l===t.length-1,c=t[l],h=Uint8Array.from(c.children.bitField().reverse()),f=new pG({type:"hamt-sharded-directory",data:h,fanout:s,hashType:MX}),i&&(f.mtime=a.mtime,f.mode=a.mode),u={Data:f.marshal(),Links:c.node.Links},d=Pf(Af(u)),e.next=9,NX(d,r,n);case 9:if(o=e.sent,i){e.next=17;break}if(null!=(p=t[l+1])){e.next=14;break}throw new Error("Was not operating on shard root but also had no parent?");case 14:VX("updating link in parent sub-shard with prefix %s",p.prefix),p.node.Links=p.node.Links.filter((function(e){return e.Name!==p.prefix})),p.node.Links.push({Name:p.prefix,Hash:o,Tsize:c.node.Links.reduce((function(e,t){var r;return e+(null!==(r=t.Tsize)&&void 0!==r?r:0)}),d.byteLength)});case 17:case"end":return e.stop()}}),e)})),l=0;case 5:if(!(l<t.length)){e.next=10;break}return e.delegateYield(c(),"t0",7);case 7:l++,e.next=5;break;case 10:if(null!=o&&null!=u){e.next=12;break}throw new Error("Noting persisted");case 12:return e.abrupt("return",{cid:o,node:u});case 13:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),QX=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i){var a,s,o,u,c,l,h,f,d,p,v,g,y,m,b,_,w;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=RX(BX),s=a(Hs(r)),o=[];case 3:return e.next=6,n.get(t,i);case 6:return c=e.sent,l=Lf(c),h=new MG,e.next=11,s.take(8);case 11:f=e.sent,d=KX(f),o.push({prefix:d,children:h,node:l}),p=void 0,v=(0,ge.Z)(l.Links),e.prev=16,v.s();case 18:if((g=v.n()).done){e.next=28;break}if(m=g.value,!((b=null!==(y=m.Name)&&void 0!==y?y:"").length<2)){e.next=23;break}throw new Error("Invalid HAMT - link name was too short");case 23:_=parseInt(b.substring(0,2),16),h.set(_,!0),b.startsWith(d)&&(p=m);case 26:e.next=18;break;case 28:e.next=33;break;case 30:e.prev=30,e.t0=e.catch(16),v.e(e.t0);case 33:return e.prev=33,v.f(),e.finish(33);case 36:if(null!=p){e.next=39;break}return VX("no link found with prefix %s for %s",d,r),e.abrupt("break",49);case 39:if(!((w=null!==(u=p.Name)&&void 0!==u?u:"").length<2)){e.next=42;break}throw new Error("Invalid HAMT - link name was too short");case 42:if(2!==w.length){e.next=46;break}return t=p.Hash,VX("descend into sub-shard with prefix %s",w),e.abrupt("continue",3);case 46:return e.abrupt("break",49);case 49:return e.abrupt("return",{path:o,hash:s});case 50:case"end":return e.stop()}}),e,null,[[16,30,33,36]])})));return function(t,r,n,i){return e.apply(this,arguments)}}();function XX(e,t,r,n){return JX.apply(this,arguments)}function JX(){return JX=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i){var a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.Data){e.next=2;break}throw new Error("DagPB node had no data");case 2:if("directory"!==(a=pG.unmarshal(t.Data)).type){e.next=7;break}s=$X(t),e.next=14;break;case 7:if("hamt-sharded-directory"!==a.type){e.next=13;break}return e.next=10,eJ(t,0,n,r,i);case 10:s=e.sent,e.next=14;break;case 13:throw new Error("Can only estimate the size of directories or shards");case 14:return e.abrupt("return",s>n);case 15:case"end":return e.stop()}}),e)}))),JX.apply(this,arguments)}function $X(e){var t,r=0,n=(0,ge.Z)(e.Links);try{for(n.s();!(t=n.n()).done;){var i,a=t.value;r+=(null!==(i=a.Name)&&void 0!==i?i:"").length,r+=1===a.Hash.version?qX.bytes.byteLength:WX.bytes.byteLength}}catch(S$){n.e(S$)}finally{n.f()}return r}function eJ(e,t,r,n,i){return tJ.apply(this,arguments)}function tJ(){return tJ=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i,a){var s,o,u,c,l,h,f;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r>n)){e.next=2;break}return e.abrupt("return",n);case 2:if(null!=t.Data){e.next=4;break}return e.abrupt("return",r);case 4:if(pG.unmarshal(t.Data).isDirectory()){e.next=7;break}return e.abrupt("return",r);case 7:s=(0,ge.Z)(t.Links),e.prev=8,s.s();case 10:if((o=s.n()).done){e.next=27;break}if(c=o.value,l=(l=null!==(u=c.Name)&&void 0!==u?u:"").substring(2),r+=l.length,r+=c.Hash.bytes.byteLength,c.Hash.code!==If){e.next=25;break}return e.next=19,i.get(c.Hash,a);case 19:return h=e.sent,f=Lf(h),e.t0=r,e.next=24,eJ(f,r,n,i,a);case 24:r=e.t0+=e.sent;case 25:e.next=10;break;case 27:e.next=32;break;case 29:e.prev=29,e.t1=e.catch(8),s.e(e.t1);case 32:return e.prev=32,s.f(),e.finish(32);case 35:return e.abrupt("return",r);case 36:case"end":return e.stop()}}),e,null,[[8,29,32,35]])}))),tJ.apply(this,arguments)}var rJ=zi("helia:unixfs:components:utils:add-link");function nJ(e,t,r,n){return iJ.apply(this,arguments)}function iJ(){return(iJ=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i){var a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.node.Data){e.next=2;break}throw new DX("Invalid parent passed to addLink");case 2:if("hamt-sharded-directory"!==pG.unmarshal(t.node.Data).type){e.next=6;break}return rJ("adding link to sharded directory"),e.abrupt("return",oJ(t,r,n,i));case 6:return rJ("adding ".concat(r.Name," (").concat(r.Hash,") to regular directory")),e.next=9,sJ(t,r,n,i);case 9:return a=e.sent,e.next=12,XX(a.node,n,i.shardSplitThresholdBytes,i);case 12:if(!e.sent){e.next=23;break}return rJ("converting directory to sharded directory"),e.next=16,aJ(a,n);case 16:return s=e.sent,a.cid=s.cid,e.t0=m,e.next=21,n.get(s.cid,i);case 21:e.t1=e.sent,a.node=e.t0.decode.call(e.t0,e.t1);case 23:return e.abrupt("return",a);case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var aJ=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.node.Data){e.next=2;break}throw new DX("Invalid parent passed to convertToShardedDirectory");case 2:return n=pG.unmarshal(t.node.Data),e.next=5,YX(r,t.node.Links.map((function(e){var t,r;return{name:null!==(t=e.Name)&&void 0!==t?t:"",size:BigInt(null!==(r=e.Tsize)&&void 0!==r?r:0),cid:e.Hash}})),{mode:n.mode,mtime:n.mtime,cidVersion:t.cid.version});case 5:return i=e.sent,rJ("converted directory to sharded directory ".concat(i.cid)),e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),sJ=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i){var a,s,o,u,c,l,h,f;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=t.node.Links.filter((function(e){var t=e.Name===r.Name;if(t&&!i.allowOverwriting)throw new xX;return!t}))).push(r),null!=t.node.Data){e.next=4;break}throw new wX("Parent node with no data passed to addToDirectory");case 4:return null!=(s=pG.unmarshal(t.node.Data)).mtime?(u=Date.now(),c=Math.floor(u/1e3),s.mtime={secs:BigInt(c),nsecs:1e3*(u-1e3*c)},o=s.marshal()):o=t.node.Data,t.node=Af({Data:o,Links:a}),l=Pf(t.node),e.next=10,Ps.digest(l);case 10:return h=e.sent,f=Ba.create(t.cid.version,If,h),e.next=14,n.put(f,l);case 14:return e.abrupt("return",{node:t.node,cid:f});case 15:case"end":return e.stop()}}),e)})));return function(t,r,n,i){return e.apply(this,arguments)}}(),oJ=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i){var a,s,o,u,c,l,h,f,d,p,v,g,y,m,b,_,w,k,x,E,S,C;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,QX(t.cid,r.Name,n,i);case 2:if(a=e.sent,s=a.path,o=a.hash,null!=(u=s[s.length-1])){e.next=8;break}throw new Error("Invalid HAMT, could not generate path");case 8:if(c=u.prefix,l=parseInt(c,16),rJ("next prefix for %s is %s",r.Name,c),h="".concat(c).concat(r.Name),null==(f=u.node.Links.find((function(e){var t;return(null!==(t=e.Name)&&void 0!==t?t:"").startsWith(c)})))){e.next=64;break}if(rJ("link %s was present in shard",h),f.Name!==h){e.next=23;break}if(i.allowOverwriting){e.next=18;break}throw new xX;case 18:rJ("overwriting %s in subshard",r.Name),u.node.Links=u.node.Links.filter((function(e){return e.Name!==h})),u.node.Links.push({Name:h,Hash:r.Hash,Tsize:r.Tsize}),e.next=62;break;case 23:if(2!==(null===(d=f.Name)||void 0===d?void 0:d.length)){e.next=27;break}throw new Error("Existing link was subshard?!");case 27:rJ("prefix %s already exists, creating new subshard",c),v=u.node.Links.findIndex((function(e){var t;return null===(t=e.Name)||void 0===t?void 0:t.startsWith(c)})),g=u.node.Links.splice(v,1)[0],y=(null!==(p=g.Name)&&void 0!==p?p:"").substring(2),m=RX(BX),b=m(Hs(y)),_=0;case 34:if(!(_<s.length)){e.next=40;break}return e.next=37,b.take(8);case 37:_++,e.next=34;break;case 40:return e.next=43,b.take(8);case 43:return w=e.sent,k=KX(w),g.Name="".concat(k).concat(y),e.next=48,o.take(8);case 48:if(x=e.sent,E=KX(x),k!==E){e.next=55;break}return(S=new MG).set(x,!0),s.push({prefix:E,children:S,node:{Links:[]}}),e.abrupt("continue",40);case 55:return(C=new MG).set(x,!0),C.set(w,!0),s.push({prefix:c,children:C,node:{Links:[g,{Name:"".concat(E).concat(r.Name),Hash:r.Hash,Tsize:r.Tsize}]}}),e.abrupt("break",62);case 62:e.next=69;break;case 64:rJ("link %s was not present in sub-shard",h),r.Name=h,u.node.Links.push(r),u.children.set(l,!0),rJ("adding %s to existing sub-shard",h);case 69:return e.abrupt("return",GX(s,n,i));case 70:case"end":return e.stop()}}),e)})));return function(t,r,n,i){return e.apply(this,arguments)}}();function uJ(e,t){return cJ.apply(this,arguments)}function cJ(){return cJ=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>2&&void 0!==a[2]?a[2]:{},e.next=3,vX(t,r,n);case 3:if("directory"===(i=e.sent).type){e.next=6;break}throw new AX("".concat(t.toString()," was not a UnixFS directory"));case 6:return e.abrupt("return",{cid:t,node:i.node});case 7:case"end":return e.stop()}}),e)}))),cJ.apply(this,arguments)}function lJ(e,t,r,n){return hJ.apply(this,arguments)}function hJ(){return hJ=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i){var a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vX(t,n,i);case 2:if("directory"===(a=e.sent).type||"file"===a.type||"raw"===a.type){e.next=5;break}throw new _X("".concat(t.toString()," was not a UnixFS node"));case 5:return e.abrupt("return",{Name:r,Tsize:a.node instanceof Uint8Array?a.node.byteLength:fJ(a.node),Hash:t});case 6:case"end":return e.stop()}}),e)}))),hJ.apply(this,arguments)}function fJ(e){var t=e.Links.reduce((function(e,t){var r;return e+(null!==(r=t.Tsize)&&void 0!==r?r:0)}),0);return Pf(e).byteLength+t}var dJ=zi("helia:unixfs:components:utils:resolve");function pJ(e,t,r,n){return vJ.apply(this,arguments)}function vJ(){return vJ=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i){var a,s,o,u,c,l,h,f,d,p,v,g;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=r&&""!==r){e.next=2;break}return e.abrupt("return",{cid:t});case 2:dJ('resolve "%s" under %c',r,t),a=r.split("/").filter(Boolean),s=[{name:"",cid:t,size:0n}],o=0;case 6:if(!(o<a.length)){e.next=60;break}return u=a[o],e.next=10,vX(t,n,i);case 10:if(c=e.sent,dJ('resolving "%s"',u,c),"file"!==c.type){e.next=18;break}if(!(o<a.length-1)){e.next=15;break}throw new DX("Path was invalid");case 15:t=c.cid,e.next=57;break;case 18:if("directory"!==c.type){e.next=56;break}l=void 0,h=!1,f=!1,e.prev=22,p=ui(c.content());case 24:return e.next=26,p.next();case 26:if(!(h=!(v=e.sent).done)){e.next=34;break}if((g=v.value).name!==u){e.next=31;break}return l=g.cid,e.abrupt("break",34);case 31:h=!1,e.next=24;break;case 34:e.next=40;break;case 36:e.prev=36,e.t0=e.catch(22),f=!0,d=e.t0;case 40:if(e.prev=40,e.prev=41,!h||null==p.return){e.next=45;break}return e.next=45,p.return();case 45:if(e.prev=45,!f){e.next=48;break}throw d;case 48:return e.finish(45);case 49:return e.finish(40);case 50:if(null!=l){e.next=52;break}throw new EX("Could not find path in directory");case 52:t=l,s.push({name:u,cid:t,size:c.size}),e.next=57;break;case 56:throw new DX("Could not resolve path");case 57:o++,e.next=6;break;case 60:return dJ("resolved %s to %c",r,t),e.abrupt("return",{cid:t,path:r,segments:s});case 62:case"end":return e.stop()}}),e,null,[[22,36,40,50],[41,,45,49]])}))),vJ.apply(this,arguments)}function gJ(e,t,r,n){return yJ.apply(this,arguments)}function yJ(){return yJ=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i){var a,s,o,u,c,l,h,f,d;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=r.segments&&0!==r.segments.length){e.next=2;break}return e.abrupt("return",t);case 2:if(null!=(a=r.segments.pop())){e.next=5;break}throw new Error("Insufficient segments");case 5:a.cid=t,r.segments.reverse(),s=(0,ge.Z)(r.segments),e.prev=8,s.s();case 10:if((o=s.n()).done){e.next=26;break}return u=o.value,e.next=14,Promise.all([uJ(u.cid,n,i),lJ(a.cid,a.name,n,i)]);case 14:return c=e.sent,l=(0,ke.Z)(c,2),h=l[0],f=l[1],e.next=20,nJ(h,f,n,(0,_e.Z)((0,_e.Z)({},i),{},{allowOverwriting:!0,cidVersion:t.version}));case 20:d=e.sent,t=d.cid,u.cid=t,a=u;case 24:e.next=10;break;case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(8),s.e(e.t0);case 31:return e.prev=31,s.f(),e.finish(31);case 34:return e.abrupt("return",t);case 35:case"end":return e.stop()}}),e,null,[[8,28,31,34]])}))),yJ.apply(this,arguments)}var mJ=am.bind({ignoreUndefined:!0}),bJ={};function _J(e,t){return wJ.apply(this,arguments)}function wJ(){return wJ=ea((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,ii.Z)().mark((function n(){var i,a,s;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=mJ(bJ,r),n.next=3,Ji(pJ(e,i.path,t,i));case 3:return a=n.sent,n.next=6,Ji(vX(a.cid,t,i));case 6:if("file"===(s=n.sent).type||"raw"===s.type){n.next=9;break}throw new CX;case 9:if(null!=s.content){n.next=11;break}throw new SX;case 11:return n.delegateYield(Xa(ui(s.content(i))),"t0",12);case 12:case"end":return n.stop()}}),n)}))()})),wJ.apply(this,arguments)}var kJ=262144,xJ=am.bind({ignoreUndefined:!0}),EJ=zi("helia:unixfs:chmod"),SJ={recursive:!1,shardSplitThresholdBytes:kJ};function CJ(e,t,r){return AJ.apply(this,arguments)}function AJ(){return AJ=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a,s,o,u,c,l,h,f,d,p,v=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=xJ(SJ,i=v.length>3&&void 0!==v[3]?v[3]:{}),e.next=4,pJ(t,a.path,n,i);case 4:if(s=e.sent,EJ("chmod %c %d",s.cid,r),!a.recursive){e.next=13;break}return e.next=9,no(ea((0,ii.Z)().mark((function e(){var t,a,o,u,c,l,h,f,d;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!1,a=!1,e.prev=2,u=ui(yX(s.cid,n,i));case 4:return e.next=6,Ji(u.next());case 6:if(!(t=!(c=e.sent).done)){e.next=27;break}if(l=c.value,h=void 0,f=[],"raw"!==l.type){e.next=14;break}h=new pG({type:"file",data:l.node}),e.next=20;break;case 14:if("file"!==l.type&&"directory"!==l.type){e.next=19;break}h=l.unixfs,f=l.node.Links,e.next=20;break;case 19:throw new _X;case 20:return h.mode=r,d={Data:h.marshal(),Links:f},e.next=24,{path:l.path,content:d};case 24:t=!1,e.next=4;break;case 27:e.next=33;break;case 29:e.prev=29,e.t0=e.catch(2),a=!0,o=e.t0;case 33:if(e.prev=33,e.prev=34,!t||null==u.return){e.next=38;break}return e.next=38,Ji(u.return());case 38:if(e.prev=38,!a){e.next=41;break}throw o;case 41:return e.finish(38);case 42:return e.finish(33);case 43:case"end":return e.stop()}}),e,null,[[2,29,33,43],[34,,38,42]])}))),(function(e){return dQ(e,n,(0,_e.Z)((0,_e.Z)({},a),{},{dagBuilder:function(){var e=ea((0,ii.Z)().mark((function e(r,n){var i,s,o,u,c,l;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=!1,s=!1,e.prev=2,u=(0,ii.Z)().mark((function e(){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.value,e.next=3,(0,ai.Z)((0,ii.Z)().mark((function e(){var i,s,o,u;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.content,s=Pf(i),e.next=4,NX(s,n,(0,_e.Z)((0,_e.Z)({},a),{},{cidVersion:t.version}));case 4:if(o=e.sent,null!=i.Data){e.next=7;break}throw new wX("".concat(o," had no data"));case 7:return u=pG.unmarshal(i.Data),e.abrupt("return",{cid:o,size:BigInt(s.length),path:r.path,unixfs:u});case 9:case"end":return e.stop()}}),e)})));case 3:case"end":return e.stop()}}),e)})),c=ui(r);case 5:return e.next=7,Ji(c.next());case 7:if(!(i=!(l=e.sent).done)){e.next=12;break}return e.delegateYield(u(),"t0",9);case 9:i=!1,e.next=5;break;case 12:e.next=18;break;case 14:e.prev=14,e.t1=e.catch(2),s=!0,o=e.t1;case 18:if(e.prev=18,e.prev=19,!i||null==c.return){e.next=23;break}return e.next=23,Ji(c.return());case 23:if(e.prev=23,!s){e.next=26;break}throw o;case 26:return e.finish(23);case 27:return e.finish(18);case 28:case"end":return e.stop()}}),e,null,[[2,14,18,28],[19,,23,27]])})));return function(t,r){return e.apply(this,arguments)}}()}))}),function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",LQ(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 9:if(null!=(o=e.sent)){e.next=12;break}throw new kX("Could not chmod ".concat(s.cid.toString()));case 12:return e.abrupt("return",gJ(o.cid,s,n,a));case 13:return e.next=15,n.get(s.cid,i);case 15:if(u=e.sent,l=[],s.cid.code!==qa){e.next=21;break}c=new pG({type:"file",data:u}),e.next=26;break;case 21:if(null!=(h=Lf(u)).Data){e.next=24;break}throw new wX("".concat(s.cid.toString()," had no data"));case 24:l=h.Links,c=pG.unmarshal(h.Data);case 26:return c.mode=r,f=Pf({Data:c.marshal(),Links:l}),e.next=30,Ps.digest(f);case 30:return d=e.sent,p=Ba.create(s.cid.version,If,d),e.next=34,n.put(p,f);case 34:return e.abrupt("return",gJ(p,s,n,a));case 35:case"end":return e.stop()}}),e)}))),AJ.apply(this,arguments)}var DJ=am.bind({ignoreUndefined:!0}),RJ=zi("helia:unixfs:cp"),TJ={force:!1,shardSplitThresholdBytes:kJ};function ZJ(e,t,r,n){return IJ.apply(this,arguments)}function IJ(){return IJ=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i){var a,s,o,u,c,l,h=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=DJ(TJ,h.length>4&&void 0!==h[4]?h[4]:{}),!n.includes("/")){e.next=4;break}throw new DX("Name must not have slashes");case 4:return e.next=6,Promise.all([uJ(r,i,a),lJ(t,n,i,a)]);case 6:return s=e.sent,o=(0,ke.Z)(s,2),u=o[0],c=o[1],RJ('Adding %c as "%s" to %c',t,n,r),e.next=13,nJ(u,c,i,(0,_e.Z)({allowOverwriting:a.force,cidVersion:r.version},a));case 13:return l=e.sent,e.abrupt("return",l.cid);case 15:case"end":return e.stop()}}),e)}))),IJ.apply(this,arguments)}var PJ=am.bind({ignoreUndefined:!0}),LJ={};function MJ(e,t){return BJ.apply(this,arguments)}function BJ(){return BJ=ea((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,ii.Z)().mark((function n(){var i,a,s;return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=PJ(LJ,r),n.next=3,Ji(pJ(e,i.path,t,i));case 3:return a=n.sent,n.next=6,Ji(vX(a.cid,t));case 6:if("file"!==(s=n.sent).type&&"raw"!==s.type){n.next=11;break}return n.next=10,s;case 10:return n.abrupt("return");case 11:if(null!=s.content){n.next=13;break}throw new SX;case 13:if("directory"===s.type){n.next=15;break}throw new AX;case 15:return n.delegateYield(Xa(ui(s.content({offset:r.offset,length:r.length}))),"t0",16);case 16:case"end":return n.stop()}}),n)}))()})),BJ.apply(this,arguments)}var OJ=am.bind({ignoreUndefined:!0}),NJ=zi("helia:unixfs:mkdir"),FJ={cidVersion:1,force:!1,shardSplitThresholdBytes:kJ};function UJ(e,t,r){return zJ.apply(this,arguments)}function zJ(){return zJ=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a,s,o,u,c,l,h,f,d,p,v,g=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=OJ(FJ,i=g.length>3&&void 0!==g[3]?g[3]:{}),!r.includes("/")){e.next=4;break}throw new DX("Path must not have slashes");case 4:return e.next=6,vX(t,n,i);case 6:if("directory"===e.sent.type){e.next=9;break}throw new AX("".concat(t.toString()," was not a UnixFS directory"));case 9:return NJ("creating %s",r),s=new pG({type:"directory",mode:a.mode,mtime:a.mtime}),o={Data:s.marshal(),Links:[]},u=Pf(o),e.next=15,Ps.digest(u);case 15:return c=e.sent,l=Ba.create(a.cidVersion,If,c),e.next=19,n.put(l,u);case 19:return e.next=21,Promise.all([uJ(t,n,a),lJ(l,r,n,a)]);case 21:return h=e.sent,f=(0,ke.Z)(h,2),d=f[0],p=f[1],NJ("adding empty dir called %s to %c",r,t),e.next=28,nJ(d,p,n,(0,_e.Z)((0,_e.Z)({},a),{},{allowOverwriting:a.force}));case 28:return v=e.sent,e.abrupt("return",v.cid);case 30:case"end":return e.stop()}}),e)}))),zJ.apply(this,arguments)}var jJ=zi("helia:unixfs:utils:remove-link");function HJ(e,t,r,n){return WJ.apply(this,arguments)}function WJ(){return(WJ=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i){var a;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.node.Data){e.next=2;break}throw new wX("Parent node had no data");case 2:if("hamt-sharded-directory"!==pG.unmarshal(t.node.Data).type){e.next=14;break}return jJ("removing ".concat(r," from sharded directory")),e.next=7,VJ(t,r,n,i);case 7:return a=e.sent,e.next=10,XX(a.node,n,i.shardSplitThresholdBytes,i);case 10:if(e.sent){e.next=13;break}return jJ("converting shard to flat directory %c",t.cid),e.abrupt("return",KJ(a,n,i));case 13:return e.abrupt("return",a);case 14:return jJ("removing link ".concat(r," regular directory")),e.abrupt("return",qJ(t,r,n,i));case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var qJ=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i){var a,s;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.node.Links=t.node.Links.filter((function(e){return e.Name!==r})),a=Pf(t.node),e.next=4,NX(a,n,(0,_e.Z)((0,_e.Z)({},i),{},{cidVersion:t.cid.version}));case 4:return s=e.sent,jJ("Updated regular directory ".concat(s)),e.abrupt("return",{node:t.node,cid:s});case 7:case"end":return e.stop()}}),e)})));return function(t,r,n,i){return e.apply(this,arguments)}}(),VJ=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n,i){var a,s,o,u,c,l,h;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,QX(t.cid,r,n,i);case 2:if(a=e.sent,s=a.path,null!=(o=s[s.length-1])){e.next=7;break}throw new Error("Invalid HAMT, could not generate path");case 7:if(null!=(u=o.node.Links.filter((function(e){var t;return(null!==(t=e.Name)&&void 0!==t?t:"").substring(2)===r})).map((function(e){return e.Name})).pop())){e.next=10;break}throw new Error("File not found");case 10:if(c=u.substring(0,2),l=parseInt(c,16),o.node.Links=o.node.Links.filter((function(e){return e.Name!==u})),o.children.unset(l),1!==o.node.Links.length){e.next=23;break}h=(0,ii.Z)().mark((function e(){var t,r,n,i;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==s.length){e.next=2;break}return e.abrupt("return",0);case 2:if(!(null==(r=s[s.length-1])||r.node.Links.length>1)){e.next=5;break}return e.abrupt("return",0);case 5:if(s.pop(),null!=(n=s[s.length-1])){e.next=9;break}return e.abrupt("return",0);case 9:i=r.node.Links[0],n.node.Links=n.node.Links.filter((function(e){var t;return!(null!==(t=e.Name)&&void 0!==t?t:"").startsWith(n.prefix)})),n.node.Links.push({Hash:i.Hash,Name:"".concat(n.prefix).concat((null!==(t=i.Name)&&void 0!==t?t:"").substring(2)),Tsize:i.Tsize});case 12:case"end":return e.stop()}}),e)}));case 16:return e.delegateYield(h(),"t0",18);case 18:if(0!==e.t0){e.next=21;break}return e.abrupt("break",23);case 21:e.next=16;break;case 23:return e.abrupt("return",GX(s,n,i));case 24:case"end":return e.stop()}}),e)})));return function(t,r,n,i){return e.apply(this,arguments)}}(),KJ=function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a,s,o,u,c,l,h,f,d,p,v;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t.node.Data){e.next=2;break}throw new DX("Invalid parent passed to convertToFlatDirectory");case 2:return i={Links:[]},e.next=5,vX(t.cid,r);case 5:if("directory"===(a=e.sent).type){e.next=8;break}throw new Error("Unexpected node type");case 8:s=!1,o=!1,e.prev=10,c=ui(a.content());case 12:return e.next=14,c.next();case 14:if(!(s=!(l=e.sent).done)){e.next=22;break}h=l.value,f=0,f=h.node instanceof Uint8Array?h.node.byteLength:Pf(h.node).length,i.Links.push({Hash:h.cid,Name:h.name,Tsize:f});case 19:s=!1,e.next=12;break;case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(10),o=!0,u=e.t0;case 28:if(e.prev=28,e.prev=29,!s||null==c.return){e.next=33;break}return e.next=33,c.return();case 33:if(e.prev=33,!o){e.next=36;break}throw u;case 36:return e.finish(33);case 37:return e.finish(28);case 38:return d=pG.unmarshal(t.node.Data),i.Data=new pG({type:"directory",mode:d.mode,mtime:d.mtime}).marshal(),p=Pf(Af(i)),e.next=43,NX(p,r,{codec:m,cidVersion:t.cid.version,signal:n.signal});case 43:return v=e.sent,e.abrupt("return",{cid:v,node:i});case 45:case"end":return e.stop()}}),e,null,[[10,24,28,38],[29,,33,37]])})));return function(t,r,n){return e.apply(this,arguments)}}(),YJ=am.bind({ignoreUndefined:!0}),GJ=zi("helia:unixfs:rm"),QJ={shardSplitThresholdBytes:kJ};function XJ(e,t,r){return JJ.apply(this,arguments)}function JJ(){return JJ=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a,s,o=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=YJ(QJ,o.length>3&&void 0!==o[3]?o[3]:{}),!r.includes("/")){e.next=4;break}throw new DX("Name must not have slashes");case 4:return e.next=6,uJ(t,n,i);case 6:return a=e.sent,GJ("Removing %s from %c",r,t),e.next=10,HJ(a,r,n,(0,_e.Z)((0,_e.Z)({},i),{},{cidVersion:t.version}));case 10:return s=e.sent,e.abrupt("return",s.cid);case 12:case"end":return e.stop()}}),e)}))),JJ.apply(this,arguments)}var $J=am.bind({ignoreUndefined:!0}),e$=zi("helia:unixfs:stat"),t$={};function r$(e,t){return n$.apply(this,arguments)}function n$(){return n$=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c,l,h,f,d,p,v,g,y,m,b=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=$J(t$,n=b.length>2&&void 0!==b[2]?b[2]:{}),e.next=4,pJ(t,n.path,r,i);case 4:return a=e.sent,e$("stat %c",a.cid),e.next=8,vX(a.cid,r,i);case 8:if("file"===(s=e.sent).type||"directory"===s.type||"raw"===s.type){e.next=11;break}throw new _X;case 11:if(o=0n,u=0n,c=0n,l=0n,h=0,p=s.type,"raw"===s.type&&(o=BigInt(s.node.byteLength),u=BigInt(s.node.byteLength),c=BigInt(s.node.byteLength),l=BigInt(s.node.byteLength),h=1),"directory"===s.type&&(o=0n,u=BigInt(s.unixfs.marshal().byteLength),c=0n,l=u,h=1,f=s.unixfs.mode,d=s.unixfs.mtime,v=s.unixfs),"file"!==s.type){e.next=31;break}return e.next=22,i$(a.cid,r,i);case 22:m=e.sent,o=s.unixfs.fileSize(),u=BigInt((null!==(g=null===(y=s.node.Data)||void 0===y?void 0:y.byteLength)&&void 0!==g?g:0)+s.node.Links.reduce((function(e,t){var r;return e+(null!==(r=t.Tsize)&&void 0!==r?r:0)}),0)),c=BigInt(m.localFileSize),l=BigInt(m.localDagSize),h=m.blocks,f=s.unixfs.mode,d=s.unixfs.mtime,v=s.unixfs;case 31:return e.abrupt("return",{cid:a.cid,mode:f,mtime:d,fileSize:o,dagSize:u,localFileSize:c,localDagSize:l,blocks:h,type:p,unixfs:v});case 32:case"end":return e.stop()}}),e)}))),n$.apply(this,arguments)}function i$(e,t,r){return a$.apply(this,arguments)}function a$(){return a$=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a,s,o,u,c,l,h,f;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={localFileSize:0,localDagSize:0,blocks:0},e.next=3,r.has(t,n);case 3:if(!e.sent){e.next=48;break}return e.next=6,r.get(t,n);case 6:if(a=e.sent,i.blocks++,i.localDagSize+=a.byteLength,t.code!==qa){e.next=13;break}i.localFileSize+=a.byteLength,e.next=48;break;case 13:if(t.code!==If){e.next=47;break}if(!((s=Lf(a)).Links.length>0)){e.next=39;break}o=(0,ge.Z)(s.Links),e.prev=17,o.s();case 19:if((u=o.n()).done){e.next=29;break}return c=u.value,e.next=23,i$(c.Hash,r,n);case 23:l=e.sent,i.localFileSize+=l.localFileSize,i.localDagSize+=l.localDagSize,i.blocks+=l.blocks;case 27:e.next=19;break;case 29:e.next=34;break;case 31:e.prev=31,e.t0=e.catch(17),o.e(e.t0);case 34:return e.prev=34,o.f(),e.finish(34);case 37:e.next=45;break;case 39:if(null!=s.Data){e.next=41;break}throw new wX("PBNode ".concat(t.toString()," had no data"));case 41:if(null!=(f=pG.unmarshal(s.Data)).data){e.next=44;break}throw new wX("UnixFS node ".concat(t.toString()," had no data"));case 44:i.localFileSize+=null!==(h=f.data.byteLength)&&void 0!==h?h:0;case 45:e.next=48;break;case 47:throw new kX("".concat(t.toString()," was neither DAG_PB nor RAW"));case 48:return e.abrupt("return",i);case 49:case"end":return e.stop()}}),e,null,[[17,31,34,37]])}))),a$.apply(this,arguments)}var s$=am.bind({ignoreUndefined:!0}),o$=zi("helia:unixfs:touch"),u$={recursive:!1,shardSplitThresholdBytes:kJ};function c$(e,t){return l$.apply(this,arguments)}function l$(){return l$=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c,l,h,f,d,p,v,g=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s$(u$,i=g.length>2&&void 0!==g[2]?g[2]:{}),e.next=4,pJ(t,a.path,r,a);case 4:if(s=e.sent,o=null!==(n=a.mtime)&&void 0!==n?n:{secs:BigInt(Math.round(Date.now()/1e3)),nsecs:0},o$("touch %c %o",s.cid,o),!a.recursive){e.next=14;break}return e.next=10,no(ea((0,ii.Z)().mark((function e(){var t,n,i,a,u,c,l,h,f;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!1,n=!1,e.prev=2,a=ui(yX(s.cid,r));case 4:return e.next=6,Ji(a.next());case 6:if(!(t=!(u=e.sent).done)){e.next=28;break}if(c=u.value,l=void 0,h=void 0,"raw"!==c.type){e.next=15;break}l=new pG({data:c.node}),h=[],e.next=21;break;case 15:if("file"!==c.type&&"directory"!==c.type){e.next=20;break}l=c.unixfs,h=c.node.Links,e.next=21;break;case 20:throw new _X;case 21:return l.mtime=o,f={Data:l.marshal(),Links:h},e.next=25,{path:c.path,content:f};case 25:t=!1,e.next=4;break;case 28:e.next=34;break;case 30:e.prev=30,e.t0=e.catch(2),n=!0,i=e.t0;case 34:if(e.prev=34,e.prev=35,!t||null==a.return){e.next=39;break}return e.next=39,Ji(a.return());case 39:if(e.prev=39,!n){e.next=42;break}throw i;case 42:return e.finish(39);case 43:return e.finish(34);case 44:case"end":return e.stop()}}),e,null,[[2,30,34,44],[35,,39,43]])}))),(function(e){return dQ(e,r,(0,_e.Z)((0,_e.Z)({},a),{},{dagBuilder:function(){var e=ea((0,ii.Z)().mark((function e(r,n){var i,s,o,u,c,l;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=!1,s=!1,e.prev=2,u=(0,ii.Z)().mark((function e(){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.value,e.next=3,(0,ai.Z)((0,ii.Z)().mark((function e(){var i,s,o,u;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.content,s=Pf(i),e.next=4,NX(s,n,(0,_e.Z)((0,_e.Z)({},a),{},{cidVersion:t.version}));case 4:if(o=e.sent,null!=i.Data){e.next=7;break}throw new wX("".concat(o," had no data"));case 7:return u=pG.unmarshal(i.Data),e.abrupt("return",{cid:o,size:BigInt(s.length),path:r.path,unixfs:u});case 9:case"end":return e.stop()}}),e)})));case 3:case"end":return e.stop()}}),e)})),c=ui(r);case 5:return e.next=7,Ji(c.next());case 7:if(!(i=!(l=e.sent).done)){e.next=12;break}return e.delegateYield(u(),"t0",9);case 9:i=!1,e.next=5;break;case 12:e.next=18;break;case 14:e.prev=14,e.t1=e.catch(2),s=!0,o=e.t1;case 18:if(e.prev=18,e.prev=19,!i||null==c.return){e.next=23;break}return e.next=23,Ji(c.return());case 23:if(e.prev=23,!s){e.next=26;break}throw o;case 26:return e.finish(23);case 27:return e.finish(18);case 28:case"end":return e.stop()}}),e,null,[[2,14,18,28],[19,,23,27]])})));return function(t,r){return e.apply(this,arguments)}}()}))}),function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",LQ(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 10:if(null!=(u=e.sent)){e.next=13;break}throw new kX("Could not chmod ".concat(s.cid.toString()));case 13:return e.abrupt("return",gJ(u.cid,s,r,a));case 14:return e.next=16,r.get(s.cid,i);case 16:if(c=e.sent,h=[],s.cid.code!==qa){e.next=22;break}l=new pG({data:c}),e.next=27;break;case 22:if(f=Lf(c),h=f.Links,null!=f.Data){e.next=26;break}throw new wX("".concat(s.cid.toString()," had no data"));case 26:l=pG.unmarshal(f.Data);case 27:return l.mtime=o,d=Pf({Data:l.marshal(),Links:h}),e.next=31,Ps.digest(d);case 31:return p=e.sent,v=Ba.create(s.cid.version,If,p),e.next=35,r.put(v,d);case 35:return e.abrupt("return",gJ(v,s,r,a));case 36:case"end":return e.stop()}}),e)}))),l$.apply(this,arguments)}__webpack_require__(7064);var h$,f$,d$,p$,v$,g$=function(){function e(t){(0,hi.Z)(this,e),(0,we.Z)(this,"components",void 0),this.components=t}return(0,fi.Z)(e,[{key:"addAll",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.delegateYield(Xa(ui(EQ(e,t.components.blockstore,r))),"t0",1);case 1:case"end":return n.stop()}}),n)})))()}},{key:"addBytes",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:{},e.abrupt("return",CQ(t,this.components.blockstore,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addByteStream",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:{},e.abrupt("return",DQ(t,this.components.blockstore,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addFile",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:{},e.abrupt("return",TQ(t,this.components.blockstore,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addDirectory",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(){var t,r,n=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},r=n.length>1&&void 0!==n[1]?n[1]:{},e.abrupt("return",IQ(t,this.components.blockstore,r));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"cat",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.delegateYield(Xa(ui(_J(e,t.components.blockstore,r))),"t0",1);case 1:case"end":return n.stop()}}),n)})))()}},{key:"chmod",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>2&&void 0!==i[2]?i[2]:{},e.abrupt("return",CJ(t,r,this.components.blockstore,n));case 2:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"cp",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r,n){var i,a=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a.length>3&&void 0!==a[3]?a[3]:{},e.abrupt("return",ZJ(t,r,n,this.components.blockstore,i));case 2:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"ls",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ea((0,ii.Z)().mark((function n(){return(0,ii.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.delegateYield(Xa(ui(MJ(e,t.components.blockstore,r))),"t0",1);case 1:case"end":return n.stop()}}),n)})))()}},{key:"mkdir",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>2&&void 0!==i[2]?i[2]:{},e.abrupt("return",UJ(t,r,this.components.blockstore,n));case 2:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"rm",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>2&&void 0!==i[2]?i[2]:{},e.abrupt("return",XJ(t,r,this.components.blockstore,n));case 2:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"stat",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:{},e.abrupt("return",r$(t,this.components.blockstore,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"touch",value:function(){var e=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r,n=arguments;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:{},e.abrupt("return",c$(t,this.components.blockstore,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function y$(e){return m$.apply(this,arguments)}function m$(){return(m$=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=rG(t),e.next=3,MP({libp2p:r});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b$(e,t){var r=new g$(e),n=new TextDecoder,i={currentCID:"",looper:{waiter:!0,release:function(){},isLoop:!1}},a=new(Bx()),s=new(Bx()),o=0,u=[];function c(e){return l.apply(this,arguments)}function l(){return(l=(0,ai.Z)((0,ii.Z)().mark((function e(t){var r;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.looper.waiter;case 2:if(i.looper.isLoop=!0,!(r=a.shift())){e.next=11;break}return e.next=7,r();case 7:if(3!==++o){e.next=11;break}return t(),e.abrupt("return");case 11:a.isEmpty()&&(i.looper.isLoop=!1,i.looper.waiter=new Promise((function(e){i.looper.release=e}))),c(t);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return f.apply(this,arguments)}function f(){return(f=(0,ai.Z)((0,ii.Z)().mark((function e(t){var i,c,l,h,f,d,p,v,g,y,m,b,_,w,k,x;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i="",l=[],p=0,v=0,g=!1,y=!1,e.prev=3,b=ui(r.cat(t));case 5:return e.next=7,b.next();case 7:if(!(g=!(_=e.sent).done)){e.next=13;break}w=_.value,i+=n.decode(w,{stream:!0});case 10:g=!1,e.next=5;break;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(3),y=!0,m=e.t0;case 19:if(e.prev=19,e.prev=20,!g||null==b.return){e.next=24;break}return e.next=24,b.return();case 24:if(e.prev=24,!y){e.next=27;break}throw m;case 27:return e.finish(24);case 28:return e.finish(19);case 29:return(k=i.split("\n")).pop(),e.next=33,new Promise((function(e){h=setInterval((function(){c=k[v++].split("  "),f=oi()(c[1],"x"),d=oi()(),p+=c[3]=d.diff(f)/1e3,l.push(c.join("\t")),v>=k.length&&(clearInterval(h),e())}),4)}));case 33:x=oi()(k[k.length-1].split("  ")[1],"x").diff(oi()(k[0].split("  ")[1],"x"))/1e3,a.push((function(){return s.push(l.join("\n\r"))})),u.push([o,v,p,x]);case 36:case"end":return e.stop()}}),e,null,[[3,15,19,29],[20,,24,28]])})))).apply(this,arguments)}var d=0,p=function(){var r=(0,ai.Z)((0,ii.Z)().mark((function r(n){var a;return(0,ii.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a=(new TextDecoder).decode(n.detail.data),i.currentCID===a){r.next=11;break}return i.currentCID=a,r.next=5,h(a);case 5:if(i.looper.isLoop||i.looper.release(),3!==++d){r.next=11;break}return e.libp2p.services.pubsub.unsubscribe(t),e.libp2p.services.pubsub.removeEventListener("message",p),r.abrupt("return");case 11:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}();e.libp2p.services.pubsub.addEventListener("message",p),e.libp2p.services.pubsub.subscribe(t);var v=[];return[s,function(){return new Promise((function(e){c(e)})).then((function(){var e,t=[0,0,0],r=(0,ge.Z)(u);try{for(r.s();!(e=r.n()).done;){var n=(0,ke.Z)(e.value,4),i=n[0],a=n[1],s=n[2],o=n[3];v.push("\n\rCase".concat(i+1,":\n\r Message : ").concat(a,"\tDelayed Avg. : ").concat(s/a,"\tMPS : ").concat(a/o)),t[0]+=a,t[1]+=s,t[2]+=o}}catch(S$){r.e(S$)}finally{r.f()}v.push("\n\rTotal:\n\rMessage : ".concat(t[0],"\tDelayed Avg. : ").concat(t[1]/t[0],"\tMPS : ").concat(t[0]/t[2]))}))},v]}function _$(e,t){return w$.apply(this,arguments)}function w$(){return w$=(0,ai.Z)((0,ii.Z)().mark((function e(t,r){var n,i,a,s,o,u,c;return(0,ii.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!1,i=!1,e.prev=2,s=ui(t.libp2p.services.dht.findPeer(em(r)));case 4:return e.next=6,s.next();case 6:if(!(n=!(o=e.sent).done)){e.next=17;break}if(2!==(u=o.value).type||"FINAL_PEER"!==u.name){e.next=14;break}return c=u.peer.multiaddrs.filter((function(e){return e.getPeerId()!==r})),console.info("FIND",c),e.next=13,t.libp2p.dial(c);case 13:return e.abrupt("return",c);case 14:n=!1,e.next=4;break;case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(2),i=!0,a=e.t0;case 23:if(e.prev=23,e.prev=24,!n||null==s.return){e.next=28;break}return e.next=28,s.return();case 28:if(e.prev=28,!i){e.next=31;break}throw a;case 31:return e.finish(28);case 32:return e.finish(23);case 33:case"end":return e.stop()}}),e,null,[[2,19,23,33],[24,,28,32]])}))),w$.apply(this,arguments)}var k$=__webpack_require__(184),x$=ei("div")((0,we.Z)({},"& > .terminal",{height:"100%"}));var E$=function(){var e=(0,de.useRef)(),t=(0,de.useMemo)((function(){var e=new ti.Terminal,t=new ri.FitAddon;e.loadAddon(t);var r=new ni.WebglAddon;e.loadAddon(r),e.init=function(r){e.open(r),t.fit()};var i="";function a(){t.fit()}return e.prompt=function(){i="",e.write("\r\n$ ")},e.onData((function(t){switch(t){case"\x03":e.write("^C"),e.prompt(e);break;case"\r":n(i),i="";break;case"\x7f":e._core.buffer.x>2&&(e.write("\b \b"),i.length>0&&(i=i.substr(0,i.length-1)));break;default:(t>=String.fromCharCode(32)&&t<=String.fromCharCode(126)||t>="\xa0")&&(i+=t,e.write(t))}})),window.addEventListener("resize",a),e.disposeAll=function(){window.removeEventListener("resize",a),t.dispose(),r.dispose(),e.dispose()},e}),[]),r=(0,de.useMemo)((function(){return(0,_e.Z)({help:{f:function(e){console.log(e);t.writeln(["Welcome to xterm.js! Try some of the commands below.",""].concat(be(Object.keys(r).map((function(e){return function(e,r){for(var n=t.cols-10-3,i=r,a=[];i.length>0;)if((i=i.trimStart()).length<n)a.push(i),i="";else{var s=-1;if(" "===i[n])s=n;else for(var o=n-1;o>=0;o--)if(" "===i[o]){s=o;break}a.push(i.substring(0,s)),i=i.substring(s)}return"  \x1b[36;1m".concat(e.padEnd(10),"\x1b[0m ").concat(a[0])+a.slice(1).map((function(e){return"\r\n  ".concat(" ".repeat(10)," ").concat(e)}))}(e,r[e].description)})))).join("\n\r")),t.prompt()},description:"Prints this help message"},loadtest:{f:function(){for(var e=[],r=0,n=0;n<50;n++){var i=1+Math.floor(79*Math.random());r+=i+2;var a=new Uint8Array(i+2);a[0]=10;for(var s=1;s<i+1;s++)a[s]=97+Math.floor(25*Math.random());a[a.length-1]=13,e.push(a)}for(var o=performance.now(),u=0;u<1024;u++){var c,l=(0,ge.Z)(e);try{for(l.s();!(c=l.n()).done;){var h=c.value;t.write(h)}}catch(S$){l.e(S$)}finally{l.f()}}t.write("",(function(){var e=Math.round(performance.now()-o),n=(r/1024*(1/(e/1e3))).toFixed(2);t.write("\n\r\nWrote ".concat(r,"kB in ").concat(e,"ms (").concat(n,"MB/s) using the renderer")),t.prompt()}))},description:"Simulate a lot of data coming from a process"}},function(e){return{connect:{f:function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n,i,a;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.cid,i=r.addr,e.write("\r\nBootup IPFS Node...\r\n"),p$=i,t.next=5,y$(i);case 5:if(a=t.sent,h$=a,e.write("\r\nConnecting to ".concat(a.libp2p.peerId,"...\r\n")),!n){t.next=17;break}return console.log(n),d$=n,t.next=13,new Promise((function(e){setTimeout(e,5e3)}));case 13:return e.write("\r\nFind Node...\r\n"),t.next=16,_$(a,n);case 16:v$=t.sent;case 17:e.prompt();case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),description:"connection Test"},start:{f:function(){e.write("\r\nSubscribe Network Events...\r\n");var t,r,n=b$(h$,d$),i=(0,ke.Z)(n,3),a=i[0],s=i[1],o=i[2];r=requestAnimationFrame((function n(){(t=a.shift())&&e.write("\r\n".concat(t)),r=requestAnimationFrame(n)})),s().then((function(){cancelAnimationFrame(r),e.write("".concat(o.join("\n\r"))),e.prompt()}))},description:""},find:{f:function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(r){var n;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=r.cid)){t.next=8;break}return t.next=4,new Promise((function(e){setTimeout(e,5e3)}));case 4:return console.log(n),e.write("\r\nFind Node...\r\n"),t.next=8,_$(h$,n);case 8:e.prompt();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),description:"connection Test"},pub:{f:function(e){var t=e.m;console.log(t),h$.libp2p.services.pubsub.publish(d$,(new TextEncoder).encode("banana"))},description:"connection Test"},stop:{f:function(){cancelAnimationFrame(f$)},description:""},peers:{f:function(){console.log(h$.libp2p.getPeers(),h$.libp2p.getConnections().map((function(e){return"".concat(e.remoteAddr)})))},description:""},failover:{f:function(){var t=(0,ai.Z)((0,ii.Z)().mark((function t(){var r,n;return(0,ii.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.write("\r\nHangup Nexivil Relay Server."),t.next=3,h$.libp2p.hangUp(kb(p$));case 3:return t.next=5,h$.libp2p.hangUp(v$);case 5:return e.write('\r\nFind "'.concat(d$,'" Node')),r=oi()(),e.write("\r\nStart Time: ".concat(r.format("hh:mm:ss.sss"))),t.next=10,_$(h$,d$);case 10:v$=t.sent,n=oi()(),e.write("\r\nEnd Time: ".concat(n.format("hh:mm:ss.sss"),"\r\n")),e.write("\r\nDuration: ".concat(n.diff(r)/1e3,"\r\n")),e.prompt();case 15:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}}}(t))}),[]),n=(0,de.useCallback)((function(e){var n=e.trim().split(" ").map((function(e){var t=e.trim();if(""!==t)return t})).filter((function(e){return void 0!==e})),i=n[0],a=n.map((function(e,t){var r;if(e.startsWith("--"))return[e.replace("--",""),!!(n.length<=t+1||(null!==(r=n[t+1])&&void 0!==r?r:"").startsWith("-"))||n[t+1]]})).filter((function(e){return void 0!==e}));if(i.length>0){if(t.writeln(""),i in r)return void r[i].f(Object.fromEntries(a));t.writeln("".concat(i,": command not found"))}t.prompt()}),[]);return(0,de.useLayoutEffect)((function(){return t.init(e.current),t.prompt(),function(){t.disposeAll()}}),[]),(0,k$.jsx)(x$,{style:{width:"100%",height:"100%",overflow:"hidden"},ref:e})};ve.createRoot(document.getElementById("root")).render((0,k$.jsx)(E$,{}))}()})();
//# sourceMappingURL=main.48873986.js.map